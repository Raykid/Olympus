/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 55);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["c"] = __extends;
/* unused harmony export __assign */
/* unused harmony export __rest */
/* harmony export (immutable) */ __webpack_exports__["b"] = __decorate;
/* unused harmony export __param */
/* harmony export (immutable) */ __webpack_exports__["e"] = __metadata;
/* harmony export (immutable) */ __webpack_exports__["a"] = __awaiter;
/* harmony export (immutable) */ __webpack_exports__["d"] = __generator;
/* unused harmony export __exportStar */
/* unused harmony export __values */
/* unused harmony export __read */
/* unused harmony export __spread */
/* unused harmony export __await */
/* unused harmony export __asyncGenerator */
/* unused harmony export __asyncDelegator */
/* unused harmony export __asyncValues */
/* unused harmony export __makeTemplateObject */
/* unused harmony export __importStar */
/* unused harmony export __importDefault */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return core; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__libs_Reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__global_Patch__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__observable_Observable__ = __webpack_require__(30);




__WEBPACK_IMPORTED_MODULE_2__global_Patch__;
/**
 * 核心上下文对象，负责内核消息转发、对象注入等核心功能的实现
 *
 * @export
 * @class Core
 */
var Core = /** @class */ (function () {
    function Core() {
        /*********************** 下面是内核消息系统 ***********************/
        this._observable = new __WEBPACK_IMPORTED_MODULE_3__observable_Observable__["a" /* default */]();
        /*********************** 下面是依赖注入系统 ***********************/
        /**
         * 记录已经注入过的对象单例
         *
         * @private
         * @type {Dictionary<Function, any>}
         * @memberof Core
         */
        this._injectDict = new __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__["a" /* default */]();
        /**
         * 注入字符串类型字典，记录注入字符串和类型构造函数的映射
         *
         * @private
         * @type {Dictionary<any, IConstructor>}
         * @memberof Core
         */
        this._injectStrDict = new __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__["a" /* default */]();
        // 进行单例判断
        if (Core._instance)
            throw new Error("已生成过Core实例，不允许多次生成");
        // 赋值单例
        Core._instance = this;
        // 注入自身
        this.mapInjectValue(this);
    }
    Object.defineProperty(Core.prototype, "disposed", {
        /**
         * Core的disposed属性没有任何作用，仅为了实现接口，始终会返回false
         *
         * @readonly
         * @type {boolean}
         * @memberof Core
         */
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Core.prototype, "observable", {
        /**
         * 将IObservable暴露出来
         *
         * @readonly
         * @type {IObservable}
         * @memberof Core
         */
        get: function () {
            return this._observable;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Core.prototype, "parent", {
        /**
         * 获取到父级IObservable
         *
         * @type {IObservable}
         * @memberof Core
         */
        get: function () {
            return null;
        },
        enumerable: true,
        configurable: true
    });
    /** dispatch方法实现 */
    Core.prototype.dispatch = function () {
        var params = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            params[_i] = arguments[_i];
        }
        this._observable.dispatch.apply(this._observable, params);
    };
    /**
     * 监听内核消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Core
     */
    Core.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.listen(type, handler, thisArg, once);
    };
    /**
     * 移除内核消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Core
     */
    Core.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.unlisten(type, handler, thisArg, once);
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Core
     */
    Core.prototype.mapCommand = function (type, cmd) {
        this._observable.mapCommand(type, cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Core
     */
    Core.prototype.unmapCommand = function (type, cmd) {
        this._observable.unmapCommand(type, cmd);
    };
    /**
     * 添加一个类型注入，会立即生成一个实例并注入到框架内核中
     *
     * @param {IConstructor} target 要注入的类型（注意不是实例）
     * @param {*} [type] 如果提供该参数，则使用该类型代替注入类型的key，否则使用注入类型自身作为key
     * @memberof Core
     */
    Core.prototype.mapInject = function (target, type) {
        // 如果已经注入过了，则使用已经注入的单例再次注入
        var oriTarget = target["__ori_constructor__"] || target;
        var value = this._injectDict.get(oriTarget) || new target();
        this.mapInjectValue(value, type);
    };
    /**
     * 注入一个对象实例
     *
     * @param {*} value 要注入的对象实例
     * @param {*} [type] 如果提供该参数，则使用该类型代替注入类型的key，否则使用注入实例的构造函数作为key
     * @memberof Core
     */
    Core.prototype.mapInjectValue = function (value, type) {
        // 如果是字符串则记录类型构造函数映射
        if (!(type instanceof Function) || !type.prototype) {
            this._injectStrDict.set(type, value.constructor);
            type = value.constructor;
        }
        // 记录已注入的单例
        this._injectDict.set(value.constructor, value);
        // 开始注入
        Reflect.defineMetadata("design:type", value, type["__ori_constructor__"] || type);
    };
    /**
     * 移除类型注入
     *
     * @param {*} type 要移除注入的类型
     * @memberof Core
     */
    Core.prototype.unmapInject = function (type) {
        // 如果是字符串则记录类型构造函数映射
        if (!(type instanceof Function) || !type.prototype)
            type = this._injectStrDict.get(type);
        Reflect.deleteMetadata("design:type", type["__ori_constructor__"] || type);
    };
    /**
     * 获取注入的对象实例
     *
     * @param {*} type 注入对象的类型
     * @returns {*} 注入的对象实例
     * @memberof Core
     */
    Core.prototype.getInject = function (type) {
        if (!(type instanceof Function) || !type.prototype)
            type = this._injectStrDict.get(type);
        if (type) {
            // 需要用原始的构造函数取
            type = type["__ori_constructor__"] || type;
            return Reflect.getMetadata("design:type", type);
        }
    };
    /**
     * Core的dispose方法没有任何作用，仅为了实现接口
     *
     * @memberof Core
     */
    Core.prototype.dispose = function () {
    };
    return Core;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Core);
/** 再额外导出一个单例 */
var core = new Core();


/***/ }),
/* 2 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["Injectable"] = Injectable;
/* harmony export (immutable) */ __webpack_exports__["Inject"] = Inject;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__libs_Reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__global_Patch__ = __webpack_require__(20);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * Core模组的装饰器注入模块
*/
/** 生成类型实例并注入，可以进行类型转换注入（即注入类型可以和注册类型不一致，采用@Injectable(AnotherClass)的形式即可） */
function Injectable() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    if (this === __WEBPACK_IMPORTED_MODULE_3__global_Patch__["decorateThis"]) {
        // 不需要转换注册类型，直接注册
        __WEBPACK_IMPORTED_MODULE_2__Core__["a" /* core */].mapInject(args[0]);
    }
    else {
        // 需要转换注册类型，需要返回一个ClassDecorator
        return function (realCls) {
            for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {
                var cls = args_1[_i];
                // 注入类型
                __WEBPACK_IMPORTED_MODULE_2__Core__["a" /* core */].mapInject(realCls, cls);
            }
            // 需要转换的也要额外将自身注入一个
            __WEBPACK_IMPORTED_MODULE_2__Core__["a" /* core */].mapInject(realCls);
        };
    }
}
;
function Inject(target, key) {
    if (key) {
        var cls = Reflect.getMetadata("design:type", target, key);
        doInject(target.constructor, key, cls);
    }
    else {
        return function (prototype, propertyKey) {
            doInject(prototype.constructor, propertyKey, target);
        };
    }
}
;
function doInject(cls, key, type) {
    // 监听实例化
    var target;
    Object(__WEBPACK_IMPORTED_MODULE_1__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        Object.defineProperty(instance, key, {
            configurable: true,
            enumerable: true,
            get: function () { return target || (target = __WEBPACK_IMPORTED_MODULE_2__Core__["a" /* core */].getInject(type)); }
        });
    });
}


/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ObjectUtil__ = __webpack_require__(4);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-15
 * @modify date 2017-09-15
 *
 * 字典，支持key为任意类型的对象
*/
var Dictionary = /** @class */ (function () {
    function Dictionary() {
        this._keyDict = {};
        this._valueDict = {};
    }
    Object.defineProperty(Dictionary.prototype, "size", {
        /**
         * 获取字典内的元素数量
         *
         * @readonly
         * @type {number}
         * @memberof Dictionary
         */
        get: function () {
            var size = 0;
            for (var hash in this._keyDict)
                size++;
            return size;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Dictionary.prototype, "keys", {
        /**
         * 获取字典key的集合
         *
         * @readonly
         * @type {K[]}
         * @memberof Dictionary
         */
        get: function () {
            var keys = [];
            for (var hash in this._keyDict) {
                keys.push(this._keyDict[hash]);
            }
            return keys;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Dictionary.prototype, "values", {
        /**
         * 获取字典值的集合
         *
         * @readonly
         * @type {V[]}
         * @memberof Dictionary
         */
        get: function () {
            var values = [];
            for (var hash in this._valueDict) {
                values.push(this._valueDict[hash]);
            }
            return values;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 设置一个键值对
     *
     * @param {K} key 键
     * @param {V} value 值
     * @memberof Dictionary
     */
    Dictionary.prototype.set = function (key, value) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["e" /* getObjectHash */])(key);
        this._keyDict[hash] = key;
        this._valueDict[hash] = value;
    };
    /**
     * 获取一个值
     *
     * @param {K} key 键
     * @returns {V} 值
     * @memberof Dictionary
     */
    Dictionary.prototype.get = function (key) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["e" /* getObjectHash */])(key);
        return this._valueDict[hash];
    };
    /**
     * 删除一个键值对
     *
     * @param {K} key 键
     * @memberof Dictionary
     */
    Dictionary.prototype.delete = function (key) {
        var hash = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["e" /* getObjectHash */])(key);
        delete this._keyDict[hash];
        delete this._valueDict[hash];
    };
    /**
     * 遍历字典
     *
     * @param {(key:K, value:V)=>void} callback 每次遍历的回调
     * @memberof Dictionary
     */
    Dictionary.prototype.forEach = function (callback) {
        for (var hash in this._keyDict) {
            var key = this._keyDict[hash];
            var value = this._valueDict[hash];
            callback(key, value);
        }
    };
    return Dictionary;
}());
/* harmony default export */ __webpack_exports__["a"] = (Dictionary);


/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = extendObject;
/* harmony export (immutable) */ __webpack_exports__["a"] = cloneObject;
/* harmony export (immutable) */ __webpack_exports__["d"] = getGUID;
/* unused harmony export getAutoIncId */
/* unused harmony export isEmpty */
/* unused harmony export trimData */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return extendsClass; });
/* harmony export (immutable) */ __webpack_exports__["e"] = getObjectHash;
/* harmony export (immutable) */ __webpack_exports__["f"] = getObjectHashs;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 对象工具集
*/
/**
 * populate properties
 * @param target        目标obj
 * @param sources       来源obj
 */
function extendObject(target) {
    var sources = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        sources[_i - 1] = arguments[_i];
    }
    sources.forEach(function (source) {
        if (!source)
            return;
        for (var propName in source) {
            if (source.hasOwnProperty(propName)) {
                target[propName] = source[propName];
            }
        }
    });
    return target;
}
/**
 * 复制对象
 * @param target 要复制的对象
 * @param deep 是否深表复制，默认浅表复制
 * @returns {any} 复制后的对象
 */
function cloneObject(target, deep) {
    if (deep === void 0) { deep = false; }
    if (target == null)
        return null;
    var newObject = target instanceof Array ? [] : Object.create(Object.getPrototypeOf(target));
    var keys = Object.keys(target);
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        var value = target[key];
        if (deep && typeof value == "object") {
            // 如果是深表复制，则需要递归复制子对象
            value = cloneObject(value, true);
        }
        newObject[key] = value;
    }
    return newObject;
}
/**
 * 生成一个随机ID
 */
function getGUID() {
    var s = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
    }
    s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
    s[19] = hexDigits.substr((parseInt(s[19]) & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
    s[8] = s[13] = s[18] = s[23] = "-";
    return s.join("");
}
var _getAutoIncIdMap = {};
/**
 * 生成自增id（从0开始）
 * @param type
 */
function getAutoIncId(type) {
    var index = _getAutoIncIdMap[type] || 0;
    _getAutoIncIdMap[type] = index++;
    return type + "-" + index;
}
/**
 * 判断对象是否为null或者空对象
 * @param obj 要判断的对象
 * @returns {boolean} 是否为null或者空对象
 */
function isEmpty(obj) {
    var result = true;
    for (var key in obj) {
        result = false;
        break;
    }
    return result;
}
/**
 * 移除data中包含的空引用或未定义
 * @param data 要被移除空引用或未定义的对象
 */
function trimData(data) {
    for (var key in data) {
        if (data[key] == null) {
            delete data[key];
        }
    }
    return data;
}
/**
 * 让child类继承自parent类
 * @param child 子类
 * @param parent 父类
 */
var extendsClass = (function () {
    var extendStatics = Object["setPrototypeOf"] ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var hash = 0;
var hashTypes = ["object", "function"];
/**
 * 获取一个对象的对象哈希字符串
 *
 * @export
 * @param {*} target 任意对象，可以是基础类型或null
 * @returns {string} 哈希值
 */
function getObjectHash(target) {
    if (target == null)
        return "__object_hash_0__";
    var key = "__object_hash__";
    var value;
    // 只有当前对象上有key才算
    if (Object.prototype.hasOwnProperty.call(target, key))
        value = target[key];
    // 如果已经有哈希值则直接返回
    if (value)
        return value;
    // 如果是基础类型则直接返回对应字符串
    var type = typeof target;
    if (hashTypes.indexOf(type) < 0)
        return type + ":" + target;
    // 如果是复杂类型则返回计算的哈希值并打上标签
    var value = "__object_hash_" + (++hash) + "__";
    Object.defineProperty(target, key, {
        configurable: true,
        enumerable: false,
        writable: false,
        value: value
    });
    return value;
}
/**
 * 获取多个对象的哈希字符串，会对每个对象调用getObjectHash生成单个哈希值，并用|连接
 *
 * @export
 * @param {...any[]} targets 希望获取哈希值的对象列表
 * @returns {string} 多个对象共同作用下的哈希值
 */
function getObjectHashs() {
    var targets = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        targets[_i] = arguments[_i];
    }
    var values = targets.map(function (target) { return getObjectHash(target); });
    return values.join("|");
}


/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__ = __webpack_require__(12);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 环境参数
*/
var Environment = /** @class */ (function () {
    function Environment() {
        this._env = "dev";
        this._hostsDict = {};
        this._cdnsDict = {};
        this._curCDNIndex = 0;
    }
    Object.defineProperty(Environment.prototype, "env", {
        /**
         * 获取当前环境字符串
         *
         * @readonly
         * @type {string}
         * @memberof Environment
         */
        get: function () {
            return this._env;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Environment.prototype, "hostsDict", {
        /**
         * 获取域名字典
         *
         * @readonly
         * @type {{[env:string]:string[]}}
         * @memberof Environment
         */
        get: function () {
            return this._hostsDict;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取当前环境下某索引处的消息域名
     *
     * @param {number} [index=0] 域名字典索引，默认是0
     * @returns {string} 域名字符串，如果取不到则使用当前域名
     * @memberof Environment
     */
    Environment.prototype.getHost = function (index) {
        if (index === void 0) { index = 0; }
        var hosts = this._hostsDict[this._env];
        if (!hosts)
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])();
        return (hosts[index] || Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])());
    };
    Object.defineProperty(Environment.prototype, "cdnsDict", {
        /**
         * 获取CDN字典
         *
         * @readonly
         * @type {{[env:string]:string[]}}
         * @memberof Environment
         */
        get: function () {
            return this._cdnsDict;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Environment.prototype, "curCDNHost", {
        /**
         * 获取当前使用的CDN域名
         *
         * @readonly
         * @type {string}
         * @memberof Environment
         */
        get: function () {
            var cdns = this._cdnsDict[this._env];
            if (!cdns)
                return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])();
            return (cdns[this._curCDNIndex] || Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["a" /* getCurOrigin */])());
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 切换下一个CDN
     *
     * @returns {boolean} 是否已经到达CDN列表的终点，回到了起点
     * @memberof Environment
     */
    Environment.prototype.nextCDN = function () {
        var cdns = this._cdnsDict[this._env];
        if (!cdns)
            return true;
        this._curCDNIndex++;
        if (this._curCDNIndex >= cdns.length) {
            this._curCDNIndex = 0;
            return true;
        }
        return false;
    };
    /**
     * 初始化Environment对象，因为该对象保存的数据基本来自项目初始参数，所以必须有initialize方法
     *
     * @param {string} [env] 当前所属环境字符串
     * @param {{[env:string]:string[]}} [hostsDict] host数组字典
     * @param {{[env:string]:string[]}} [cdnsDict] cdn数组字典
     * @memberof Environment
     */
    Environment.prototype.initialize = function (env, hostsDict, cdnsDict) {
        this._env = env || "dev";
        this._hostsDict = hostsDict || {};
        this._cdnsDict = cdnsDict || {};
        this._curCDNIndex = 0;
    };
    /**
     * 让url的域名变成消息域名
     *
     * @param {string} url 要转变的url
     * @param {number} [index=0] host索引，默认0
     * @returns {string} 转变后的url
     * @memberof Environment
     */
    Environment.prototype.toHostURL = function (url, index) {
        if (index === void 0) { index = 0; }
        // 加上domain
        url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.getHost(index));
        // 返回url
        return url;
    };
    /**
     * 让url的域名变成CDN域名
     *
     * @param {string} url 要转变的url
     * @param {boolean} [forced=false] 是否强制替换host
     * @param {boolean} [infix=true] 是否加入路径中缀，即host之后，index.html之前的部分，默认加入
     * @returns {string} 转变后的url
     * @memberof Environment
     */
    Environment.prototype.toCDNHostURL = function (url, forced, infix) {
        if (forced === void 0) { forced = false; }
        if (infix === void 0) { infix = true; }
        if (infix) {
            // 组织中缀
            var midnameIndex = window.location.pathname.lastIndexOf("/");
            var midname = window.location.pathname.substring(0, midnameIndex + 1);
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.curCDNHost + "/" + midname, forced);
        }
        else {
            // 只替换域名
            return Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["g" /* wrapHost */])(url, this.curCDNHost, forced);
        }
    };
    Environment = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Environment);
    return Environment;
}());
/* harmony default export */ __webpack_exports__["default"] = (Environment);
/** 再额外导出一个单例 */
var environment = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Environment);


/***/ }),
/* 6 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["e"] = wrapConstruct;
/* harmony export (immutable) */ __webpack_exports__["a"] = getConstructor;
/* harmony export (immutable) */ __webpack_exports__["c"] = listenConstruct;
/* unused harmony export unlistenConstruct */
/* harmony export (immutable) */ __webpack_exports__["d"] = listenDispose;
/* harmony export (immutable) */ __webpack_exports__["b"] = listenApply;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__libs_Reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ObjectUtil__ = __webpack_require__(4);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-13
 * @modify date 2017-09-13
 *
 * 装饰器工具集
*/
// 用来判断是否支持Proxy
var hasProxy = false;
(window["Proxy"] && Proxy.revocable instanceof Function);
var instanceDict = new __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__["a" /* default */]();
function handleInstance(instance) {
    var cls = instance.constructor;
    cls = cls["__ori_constructor__"] || cls;
    var funcs = instanceDict.get(cls);
    if (funcs)
        for (var _i = 0, funcs_1 = funcs; _i < funcs_1.length; _i++) {
            var func = funcs_1[_i];
            func(instance);
        }
}
/**
 * 包装一个类型，监听类型的实例化操作
 *
 * @export
 * @param {IConstructor} cls 要监听构造的类型构造器
 * @returns {IConstructor} 新的构造函数
 */
function wrapConstruct(cls) {
    if (hasProxy) {
        // 使用Proxy监听类型构建
        return new Proxy(cls, {
            construct: function (target, args, newTarget) {
                var result = Reflect["construct"](target, args, newTarget);
                if (newTarget)
                    result.constructor = newTarget;
                handleInstance(result);
                return result;
            }
        });
    }
    else {
        // 创建一个新的构造函数
        var func;
        try {
            // 尝试保持原始类型的名称
            eval('func = function ' + cls["name"] + '(){onConstruct.call(this, arguments)}');
        }
        catch (err) {
            // 尝试失败，使用无名类型
            func = onConstruct;
        }
        // 动态设置继承
        Object(__WEBPACK_IMPORTED_MODULE_2__utils_ObjectUtil__["c" /* extendsClass */])(func, cls);
        // 为新的构造函数打一个标签，用以记录原始的构造函数
        func["__ori_constructor__"] = cls;
        // 为原始构造函数也打一个标签，用以记录新构造函数
        cls["__wrap_constructor__"] = func;
        // 返回新的构造函数
        return func;
    }
    function onConstruct(args) {
        // 恢复__proto__
        Object.defineProperty(this, "__proto__", {
            configurable: true,
            enumerable: false,
            writable: true,
            value: cls.prototype
        });
        // 调用父类构造函数构造实例
        cls.apply(this, args);
        // 调用回调
        handleInstance(this);
    }
}
/**
 * 如果传入的类有包装类，则返回包装类，否则返回其本身
 *
 * @export
 * @param {IConstructor} cls 要获取包装类的类构造函数
 * @returns {IConstructor}
 */
function getConstructor(cls) {
    return (cls["__wrap_constructor__"] || cls);
}
/**
 * 监听类型的实例化
 *
 * @export
 * @param {IConstructor} cls 要监听实例化的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function listenConstruct(cls, handler) {
    cls = cls["__ori_constructor__"] || cls;
    var list = instanceDict.get(cls);
    if (!list)
        instanceDict.set(cls, list = []);
    if (list.indexOf(handler) < 0)
        list.push(handler);
}
/**
 * 移除实例化监听
 *
 * @export
 * @param {IConstructor} cls 要移除监听实例化的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function unlistenConstruct(cls, handler) {
    cls = cls["__ori_constructor__"] || cls;
    var list = instanceDict.get(cls);
    if (list) {
        var index = list.indexOf(handler);
        if (index >= 0)
            list.splice(index, 1);
    }
}
/**
 * 监听类型销毁（如果能够销毁的话，需要类型具有dispose方法），该监听不需要移除
 *
 * @export
 * @param {IConstructor} cls 要监听销毁的类
 * @param {(instance?:any)=>void} handler 处理函数
 */
function listenDispose(cls, handler) {
    var dispose = cls.prototype.dispose;
    // 判断类型是否具有dispose方法
    if (dispose) {
        // 替换dispose方法
        cls.prototype.dispose = function () {
            // 调用回调
            handler(this);
            // 调用原始dispose方法执行销毁
            return dispose.apply(this, arguments);
        };
    }
}
/**
 * 监听某个实例的某个方法调用，并插入逻辑
 *
 * @export
 * @param {IConstructor|any} target 要监听的对象类型或实例
 * @param {string} name 要监听调用的方法名
 * @param {(instance:any, args?:any[])=>any[]|void} [before] 执行前调用的回调，如果有返回值则替换掉正式方法执行时的参数
 * @param {(instance:any, args?:any[], result?:any)=>any} [after] 执行后调用的回调，可以接收正式方法的返回值，如果after有返回值则替换掉正式方法的返回值
 * @param {boolean} [once=true] 是否是一次性监听，默认是true
 */
function listenApply(target, name, before, after, once) {
    if (once === void 0) { once = true; }
    if (target instanceof Function)
        // 是个类型，监听构建后再执行处理
        listenConstruct(target, onGetInstance);
    else
        // 是个实例，直接执行处理
        onGetInstance(target);
    function onGetInstance(instance) {
        // 篡改指定方法
        var oriFunc = instance.hasOwnProperty(name) ? instance[name] : null;
        instance[name] = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // 调用回调
            var tempArgs = before && before(instance, args);
            // 替换参数
            if (tempArgs)
                args = tempArgs;
            // 如果是一次性监听，则恢复原始方法
            if (once) {
                if (oriFunc)
                    instance[name] = oriFunc;
                else
                    delete instance[name];
            }
            // 调用原始方法
            var result = instance[name].apply(this, args);
            // 调用回调
            var tempResult = after && after(instance, args, result);
            // 替换结果
            if (tempResult)
                result = tempResult;
            // 返回结果
            return result;
        };
    }
}


/***/ }),
/* 7 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["registerModule"] = registerModule;
/* harmony export (immutable) */ __webpack_exports__["getModule"] = getModule;
/* harmony export (immutable) */ __webpack_exports__["getModuleName"] = getModuleName;
/* harmony export (immutable) */ __webpack_exports__["isMediator"] = isMediator;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_observable_Observable__ = __webpack_require__(30);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ArrayUtil__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__bind_BindManager__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__bind_Mutator__ = __webpack_require__(66);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__mask_MaskManager__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__net_NetManager__ = __webpack_require__(14);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__system_System__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__MediatorMessage__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__ = __webpack_require__(18);
















var moduleDict = {};
var moduleNameDict = new __WEBPACK_IMPORTED_MODULE_5__utils_Dictionary__["a" /* default */]();
/**
 * 注册模块
 *
 * @export
 * @param {string} moduleName 模块名
 * @param {IMediatorConstructor} cls 模块类型
 */
function registerModule(moduleName, cls) {
    moduleDict[moduleName] = cls;
    moduleNameDict.set(cls, moduleName);
}
/**
 * 获取模块类型
 *
 * @export
 * @param {string} moduleName 模块名
 * @returns {IMediatorConstructor}
 */
function getModule(moduleName) {
    return moduleDict[moduleName];
}
/**
 * 获取模块名
 *
 * @export
 * @param {ModuleType} type 模块实例或模块类型
 * @returns {string} 模块名
 */
function getModuleName(type) {
    var cls = Object(__WEBPACK_IMPORTED_MODULE_4__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
    return moduleNameDict.get(cls);
}
function isMediator(target) {
    return (target.delegateMediator instanceof Function && target.undelegateMediator instanceof Function);
}
/**
 * 中介者基类
 *
 * @author Raykid
 * @date 2019-03-04
 * @export
 * @class Mediator
 * @implements {IMediator<S, OD, CD>}
 * @template S 皮肤类型
 * @template OD 开启参数类型
 * @template CD 关闭参数类型
 */
var Mediator = /** @class */ (function () {
    function Mediator(skin) {
        this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].UNOPEN;
        /**
         * 绑定目标数组，第一层key是调用层级，第二层是该层级需要编译的对象数组
         *
         * @type {Dictionary<S, S>[]}
         * @memberof Mediator
         */
        this.bindTargets = [];
        this._openMask = true;
        this._closeCache = [];
        this._listeners = [];
        this._disposeDict = new __WEBPACK_IMPORTED_MODULE_5__utils_Dictionary__["a" /* default */]();
        /**
         * 父中介者
         *
         * @type {IMediator}
         * @memberof Mediator
         */
        this.parent = null;
        this._children = [];
        /*********************** 下面是模块消息系统 ***********************/
        this._observable = new __WEBPACK_IMPORTED_MODULE_2__core_observable_Observable__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */]);
        // 赋值模块名称
        this._moduleName = getModuleName(this);
        // 赋值皮肤
        if (skin) {
            this.skin = skin;
            // 赋值桥
            this.bridge = __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__["a" /* bridgeManager */].getBridgeBySkin(skin);
        }
        this.oriSkin = skin;
        // 初始化绑定
        __WEBPACK_IMPORTED_MODULE_7__bind_BindManager__["a" /* bindManager */].bind(this);
    }
    Object.defineProperty(Mediator.prototype, "status", {
        /**
         * 获取中介者状态
         *
         * @readonly
         * @type {MediatorStatus}
         * @memberof Mediator
         */
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "viewModel", {
        /**
         * 获取或设置ViewModel
         *
         * @type {*}
         * @memberof Mediator
         */
        get: function () {
            return this._viewModel;
        },
        set: function (value) {
            // 设置的时候进行一次变异
            this._viewModel = Object(__WEBPACK_IMPORTED_MODULE_8__bind_Mutator__["a" /* mutate */])(value);
            // 更新绑定
            __WEBPACK_IMPORTED_MODULE_7__bind_BindManager__["a" /* bindManager */].bind(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "disposed", {
        /**
         * 获取中介者是否已被销毁
         *
         * @readonly
         * @type {boolean}
         * @memberof Mediator
         */
        get: function () {
            return (this._status === __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].DISPOSED);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "openMask", {
        /**
         * 开启时是否触发全屏遮罩，防止用户操作，设置操作会影响所有子孙中介者。默认是true
         *
         * @type {boolean}
         * @memberof Mediator
         */
        get: function () {
            return this._openMask;
        },
        set: function (value) {
            this._openMask = value;
            // 递归设置所有子中介者的openMask
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var child = _a[_i];
                child.openMask = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "responses", {
        /**
         * 模块初始消息的返回数据
         *
         * @type {ResponseData[]}
         * @memberof Mediator
         */
        get: function () {
            return this._responses;
        },
        set: function (value) {
            this._responses = value;
            // 递归设置子中介者的data
            for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
                var mediator = _a[_i];
                mediator.responses = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "moduleName", {
        /**
         * 获取模块名
         *
         * @readonly
         * @type {string}
         * @memberof Mediator
         */
        get: function () {
            return this._moduleName;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载从listAssets中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @returns {void}
     * @memberof Mediator
     */
    Mediator.prototype.loadAssets = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadAssets接口
                _this.onLoadAssets(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的资源
                var mediator = mediators.shift();
                mediator.loadAssets(temp);
            }
        };
        // 加载自身资源
        var assets = this.listAssets();
        if (assets && assets.length > 0) {
            // 去重
            assets = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ArrayUtil__["a" /* unique */])(assets);
            // 开始加载
            this.bridge.loadAssets(assets, this, temp);
        }
        else {
            // 没有资源，直接调用回调
            handler();
        }
    };
    /**
     * 加载从listStyleFiles中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.loadStyleFiles = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadStyleFiles接口
                _this.onLoadStyleFiles(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的资源
                var mediator = mediators.shift();
                mediator.loadStyleFiles(temp);
            }
        };
        // 开始加载css文件
        var cssFiles = this.listStyleFiles();
        // 去重
        cssFiles = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ArrayUtil__["a" /* unique */])(cssFiles);
        // 加载
        __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["a" /* assetsManager */].loadStyleFiles(cssFiles, temp);
    };
    /**
     * 加载从listJsFiles中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.loadJsFiles = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (err) {
            if (err || mediators.length <= 0) {
                // 调用onLoadJsFiles接口
                _this.onLoadJsFiles(err);
                // 调用回调
                handler(err);
            }
            else {
                // 加载一个子中介者的js
                var mediator = mediators.shift();
                mediator.loadJsFiles(temp);
            }
        };
        // 开始加载js文件
        var jsFiles = this.listJsFiles();
        // 去重
        jsFiles = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ArrayUtil__["a" /* unique */])(jsFiles);
        // 加载
        __WEBPACK_IMPORTED_MODULE_6__assets_AssetsManager__["a" /* assetsManager */].loadJsFiles(jsFiles, temp);
    };
    /**
     * 发送从listInitRequests中获取到的所有资源
     *
     * @param {(err?:Error)=>void} handler 加载完毕后的回调，如果出错则会给出err参数
     * @memberof IMediator
     */
    Mediator.prototype.sendInitRequests = function (handler) {
        var _this = this;
        var mediators = this._children.concat();
        var temp = function (responses) {
            if (responses instanceof Error) {
                var err = responses instanceof Error ? responses : undefined;
                // 调用onSendInitRequests接口
                _this.onSendInitRequests(err);
                // 调用回调
                handler(err);
            }
            else {
                if (isMine) {
                    isMine = false;
                    // 赋值返回值
                    _this.responses = responses;
                    // 调用回调
                    var stop = _this.onGetResponses(responses);
                    if (stop) {
                        var err = new Error("用户中止打开模块操作");
                        // 调用onSendInitRequests接口
                        _this.onSendInitRequests(err);
                        // 调用回调
                        handler(err);
                        return;
                    }
                }
                if (mediators.length <= 0) {
                    // 调用onSendInitRequests接口
                    _this.onSendInitRequests();
                    // 调用回调
                    handler();
                }
                else {
                    // 发送一个子中介者的初始化消息
                    var mediator = mediators.shift();
                    mediator.sendInitRequests(temp);
                }
            }
        };
        // 发送所有模块消息，模块消息默认发送全局内核
        var isMine = true;
        __WEBPACK_IMPORTED_MODULE_11__net_NetManager__["netManager"].sendMultiRequests(this.listInitRequests(), temp, this, this.observable);
    };
    /**
     * 当所需资源加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadAssets = function (err) {
    };
    /**
     * 当所需CSS加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadStyleFiles = function (err) {
    };
    /**
     * 当所需js加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onLoadJsFiles = function (err) {
    };
    /**
     * 当所需资源加载完毕后调用
     *
     * @param {Error} [err] 加载出错会给出错误对象，没错则不给
     * @memberof Mediator
     */
    Mediator.prototype.onSendInitRequests = function (err) {
    };
    /**
     * 当获取到所有初始化请求返回时调用，可以通过返回一个true来阻止模块的打开
     *
     * @param {ResponseData[]} responses 返回结构数组
     * @returns {boolean} 返回true则表示停止模块打开
     * @memberof Mediator
     */
    Mediator.prototype.onGetResponses = function (responses) {
        return false;
    };
    /**
     * 打开，为了实现IOpenClose接口
     *
     * @param {OD} [data] 开启数据
     * @param {...any[]} args 其他数据
     * @returns {Promise<any>} 异步返回onOpen时返回的参数
     * @memberof Mediator
     */
    Mediator.prototype.open = function (data) {
        var _this = this;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        return new Promise(function (resolve, reject) {
            // 判断状态
            if (_this._status === __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].UNOPEN) {
                // 修改状态
                _this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].OPENING;
                // 赋值参数
                _this.data = data;
                // 记一个是否需要遮罩的flag
                var maskFlag = _this.openMask;
                // 发送初始化消息
                _this.sendInitRequests(function (err) {
                    if (err) {
                        // 移除遮罩
                        hideMask();
                        // 调用回调
                        _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                        // 调用reject
                        reject(err);
                    }
                    else {
                        // 加载所有已托管中介者的资源
                        _this.loadAssets(function (err) {
                            if (err) {
                                // 移除遮罩
                                hideMask();
                                // 调用回调
                                _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                                // 调用reject
                                reject(err);
                            }
                            else {
                                // 加载css文件
                                _this.loadStyleFiles(function (err) {
                                    if (err) {
                                        // 移除遮罩
                                        hideMask();
                                        // 调用回调
                                        _this.moduleOpenHandler && _this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                                        // 调用reject
                                        reject(err);
                                    }
                                    else {
                                        // 加载js文件
                                        _this.loadJsFiles(function (err) { return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](_this, void 0, void 0, function () {
                                            var result, subCount, _i, _a, mediator, err_1;
                                            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_b) {
                                                switch (_b.label) {
                                                    case 0:
                                                        // 移除遮罩
                                                        hideMask();
                                                        if (!err) return [3 /*break*/, 1];
                                                        // 调用回调
                                                        this.moduleOpenHandler && this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop, err);
                                                        // 调用reject
                                                        reject(err);
                                                        return [3 /*break*/, 6];
                                                    case 1:
                                                        _b.trys.push([1, 5, , 6]);
                                                        // 要先开启自身，再开启子中介者
                                                        // 调用回调
                                                        this.moduleOpenHandler && this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].BeforeOpen);
                                                        // 调用模板方法
                                                        return [4 /*yield*/, this.__beforeOnOpen.apply(this, [data].concat(args))];
                                                    case 2:
                                                        // 调用模板方法
                                                        _b.sent();
                                                        return [4 /*yield*/, this.onOpen.apply(this, [data].concat(args))];
                                                    case 3:
                                                        result = _b.sent();
                                                        if (result !== undefined)
                                                            this.data = data = result;
                                                        // 初始化绑定，如果子类并没有在onOpen中设置viewModel，则给一个默认值以启动绑定功能
                                                        if (!this._viewModel)
                                                            this.viewModel = {};
                                                        subCount = this._children.length;
                                                        if (subCount > 0) {
                                                            // 调用所有已托管中介者的open方法
                                                            for (_i = 0, _a = this._children; _i < _a.length; _i++) {
                                                                mediator = _a[_i];
                                                                mediator.open(data);
                                                            }
                                                        }
                                                        // 修改状态
                                                        this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].OPENED;
                                                        // 调用模板方法
                                                        return [4 /*yield*/, this.__afterOnOpen.apply(this, [data].concat(args))];
                                                    case 4:
                                                        // 调用模板方法
                                                        _b.sent();
                                                        // 调用回调
                                                        this.moduleOpenHandler && this.moduleOpenHandler(__WEBPACK_IMPORTED_MODULE_13__IMediatorModulePart__["a" /* ModuleOpenStatus */].AfterOpen);
                                                        // 派发事件
                                                        this.dispatch(__WEBPACK_IMPORTED_MODULE_14__MediatorMessage__["a" /* default */].MEDIATOR_OPENED, this);
                                                        // 调用resolve
                                                        resolve(this.data);
                                                        return [3 /*break*/, 6];
                                                    case 5:
                                                        err_1 = _b.sent();
                                                        reject(err_1);
                                                        return [3 /*break*/, 6];
                                                    case 6: return [2 /*return*/];
                                                }
                                            });
                                        }); });
                                    }
                                });
                            }
                        });
                    }
                });
                // 显示Loading
                if (maskFlag) {
                    __WEBPACK_IMPORTED_MODULE_10__mask_MaskManager__["a" /* maskManager */].showLoading(null, "mediatorOpen");
                    maskFlag = false;
                }
            }
            function hideMask() {
                // 隐藏Loading
                if (!maskFlag)
                    __WEBPACK_IMPORTED_MODULE_10__mask_MaskManager__["a" /* maskManager */].hideLoading("mediatorOpen");
                maskFlag = false;
            }
        });
    };
    Mediator.prototype.__beforeOnOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    Mediator.prototype.__afterOnOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    Object.defineProperty(Mediator.prototype, "closeData", {
        /**
         * 异步获取关闭参数
         *
         * @readonly
         * @type {Promise<CD>}
         * @memberof Mediator
         */
        get: function () {
            var _this = this;
            return new Promise(function (resolve, reject) {
                if (_this.status < __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].CLOSED) {
                    // 没有关闭完成，等待完成
                    _this._closeCache.push([resolve, reject]);
                }
                else {
                    // 已经关闭完成，直接resolve
                    resolve(_this._closeData);
                }
            });
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 关闭，为了实现IOpenClose接口
     *
     * @param {CD} [data] 关闭数据
     * @param {...any[]} args 其他参数
     * @returns {Promise<any>} 异步返回onClose时返回的参数
     * @memberof Mediator
     */
    Mediator.prototype.close = function (data) {
        var _this = this;
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        return new Promise(function (resolve, reject) { return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](_this, void 0, void 0, function () {
            var children, result, err_2;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this._status === __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].OPENED)) return [3 /*break*/, 6];
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 4, , 5]);
                        this._closeData = data;
                        children = this._children.concat();
                        return [4 /*yield*/, Promise.all(children.map(function (child) { return child.close(); }))];
                    case 2:
                        _a.sent();
                        // 关闭自身
                        // 调用模板方法
                        this.__beforeOnClose.apply(this, [data].concat(args));
                        // 修改状态
                        this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].CLOSING;
                        return [4 /*yield*/, this.onClose.apply(this, [data].concat(args))];
                    case 3:
                        result = _a.sent();
                        if (result) {
                            this._closeData = result;
                        }
                        // 修改状态
                        this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].CLOSED;
                        // 调用模板方法
                        this.__afterOnClose.apply(this, [data].concat(args));
                        // 调用resolve
                        resolve(this._closeData);
                        // 调用所有cache中的resolve
                        while (this._closeCache.length > 0) {
                            this._closeCache.shift()[0](this._closeData);
                        }
                        return [3 /*break*/, 5];
                    case 4:
                        err_2 = _a.sent();
                        reject(err_2);
                        // 调用所有cache中的reject
                        while (this._closeCache.length > 0) {
                            this._closeCache.shift()[1](this._closeData);
                        }
                        return [3 /*break*/, 5];
                    case 5: return [3 /*break*/, 7];
                    case 6:
                        if (this._status < __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].CLOSED) {
                            // 还没开启呢，放入缓存
                            this._closeCache.push([resolve, reject]);
                        }
                        else {
                            // 已经关闭过了，直接resolve
                            resolve(this._closeData);
                        }
                        _a.label = 7;
                    case 7: return [2 /*return*/];
                }
            });
        }); });
    };
    Mediator.prototype.__beforeOnClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 给子类用的模板方法
    };
    Mediator.prototype.__afterOnClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 派发关闭事件
        this.dispatch(__WEBPACK_IMPORTED_MODULE_14__MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, this);
    };
    /**
     * 当打开时调用
     *
     * @param {OD} [data] 可能的打开参数
     * @param {...any[]} args 其他参数
     * @returns {any|Promise<any>} 若返回对象则使用该对象替换传入的data进行后续开启操作
     * @memberof Mediator
     */
    Mediator.prototype.onOpen = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 可重写
    };
    /**
     * 当关闭时调用
     *
     * @param {CD} [data] 可能的关闭参数
     * @param {...any[]} args 其他参数
     * @returns {any|Promise<any>} 若返回对象则使用该对象当做close操作的返回值
     * @memberof Mediator
     */
    Mediator.prototype.onClose = function (data) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        // 可重写
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {S} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof Mediator
     */
    Mediator.prototype.mapListener = function (target, type, handler, thisArg) {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners[i];
            if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                // 已经存在一样的监听，不再监听
                return;
            }
        }
        // 记录监听
        this._listeners.push({ target: target, type: type, handler: handler, thisArg: thisArg });
        // 调用桥接口
        this.bridge.mapListener(target, type, handler, thisArg);
    };
    /**
     * 注销监听事件
     *
     * @param {S} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof Mediator
     */
    Mediator.prototype.unmapListener = function (target, type, handler, thisArg) {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners[i];
            if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                // 调用桥接口
                this.bridge.unmapListener(target, type, handler, thisArg);
                // 移除记录
                this._listeners.splice(i, 1);
                break;
            }
        }
    };
    /**
     * 注销所有注册在当前中介者上的事件监听
     *
     * @memberof Mediator
     */
    Mediator.prototype.unmapAllListeners = function () {
        for (var i = 0, len = this._listeners.length; i < len; i++) {
            var data = this._listeners.pop();
            // 调用桥接口
            this.bridge.unmapListener(data.target, data.type, data.handler, data.thisArg);
        }
    };
    Mediator.prototype.disposeChild = function (mediator, oriDispose) {
        // 调用原始销毁方法
        oriDispose.call(mediator);
        // 取消托管
        this.undelegateMediator(mediator);
    };
    ;
    Object.defineProperty(Mediator.prototype, "root", {
        /**
         * 获取根级中介者（当做模块直接被打开的中介者）
         *
         * @type {IMediator}
         * @memberof IMediator
         */
        get: function () {
            return (this.parent ? this.parent.root : this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Mediator.prototype, "children", {
        /**
         * 获取所有子中介者
         *
         * @type {IMediator[]}
         * @memberof Mediator
         */
        get: function () {
            return this._children;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 托管子中介者
     *
     * @param {IMediator} mediator 要托管的中介者
     * @memberof Mediator
     */
    Mediator.prototype.delegateMediator = function (mediator) {
        if (this._children.indexOf(mediator) < 0) {
            // 托管新的中介者
            this._children.push(mediator);
            // 设置关系
            mediator.parent = this;
            // 设置observable关系
            mediator.observable.parent = this._observable;
            // 篡改dispose方法，以监听其dispose
            if (mediator.hasOwnProperty("dispose"))
                this._disposeDict.set(mediator, mediator.dispose);
            mediator.dispose = this.disposeChild.bind(this, mediator, mediator.dispose);
        }
    };
    /**
     * 取消托管子中介者
     *
     * @param {IMediator} mediator 要取消托管的中介者
     * @memberof Mediator
     */
    Mediator.prototype.undelegateMediator = function (mediator) {
        var index = this._children.indexOf(mediator);
        if (index >= 0) {
            // 取消托管中介者
            this._children.splice(index, 1);
            // 移除关系
            mediator.parent = null;
            // 移除observable关系
            if (mediator.observable)
                mediator.observable.parent = null;
            // 恢复dispose方法，取消监听dispose
            var oriDispose = this._disposeDict.get(mediator);
            if (oriDispose)
                mediator.dispose = oriDispose;
            else
                delete mediator.dispose;
            this._disposeDict.delete(mediator);
        }
    };
    /**
     * 判断指定中介者是否包含在该中介者里（判断范围包括当前中介者和子孙级中介者）
     *
     * @param {IMediator} mediator 要判断的中介者
     * @returns {boolean}
     * @memberof Mediator
     */
    Mediator.prototype.containsMediator = function (mediator) {
        // 首先判断自身
        if (mediator === this)
            return true;
        // 判断子中介者
        var contains = false;
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var child = _a[_i];
            if (child.containsMediator(mediator)) {
                contains = true;
                break;
            }
        }
        return contains;
    };
    /**
     * 其他模块被关闭回到当前模块时调用
     *
     * @param {(IMediator|undefined)} from 从哪个模块回到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.wakeUp = function (from, data) {
        // 调用自身方法
        this.onWakeUp(from, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onWakeUp(from, data);
        }
    };
    /**
     * 模块切换到前台时调用（与wakeUp的区别是open时activate会触发，但wakeUp不会）
     *
     * @param {(IMediator|undefined)} from 从哪个模块来到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.activate = function (from, data) {
        // 调用自身方法
        this.onActivate(from, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onActivate(from, data);
        }
    };
    /**
     * 模块切换到后台时调用（close之后或者其他模块打开时）
     *
     * @param {(IMediator|undefined)} to 将要去往哪个模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.deactivate = function (to, data) {
        // 调用自身方法
        this.onDeactivate(to, data);
        // 递归调用子中介者方法
        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {
            var mediator = _a[_i];
            mediator.onDeactivate(to, data);
        }
    };
    /**
     * 列出中介者所需的资源数组，可重写
     *
     * @returns {string[]}
     * @memberof Mediator
     */
    Mediator.prototype.listAssets = function () {
        return null;
    };
    /**
     * 列出所需CSS资源URL，可重写
     *
     * @returns {string[]}
     * @memberof Mediator
     */
    Mediator.prototype.listStyleFiles = function () {
        return null;
    };
    /**
     * 列出所需JS资源URL，可重写
     *
     * @returns {JSFile[]}
     * @memberof Mediator
     */
    Mediator.prototype.listJsFiles = function () {
        return null;
    };
    /**
     * 列出模块初始化请求，可重写
     *
     * @returns {RequestData[]}
     * @memberof Mediator
     */
    Mediator.prototype.listInitRequests = function () {
        return null;
    };
    /**
     * 其他模块被关闭回到当前模块时调用
     *
     * @param {(IMediator|undefined)} from 从哪个模块回到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onWakeUp = function (from, data) {
        // 可重写
    };
    /**
     * 模块切换到前台时调用（与onWakeUp的区别是open时onActivate会触发，但onWakeUp不会）
     *
     * @param {(IMediator|undefined)} from 从哪个模块来到当前模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onActivate = function (from, data) {
        // 可重写
    };
    /**
     * 模块切换到后台时调用（close之后或者其他模块打开时）
     *
     * @param {(IMediator|undefined)} to 将要去往哪个模块
     * @param {*} [data] 可能的参数传递
     * @memberof Mediator
     */
    Mediator.prototype.onDeactivate = function (to, data) {
        // 可重写
    };
    Object.defineProperty(Mediator.prototype, "observable", {
        /**
         * 暴露IObservable
         *
         * @readonly
         * @type {IObservable}
         * @memberof Mediator
         */
        get: function () {
            return this._observable;
        },
        enumerable: true,
        configurable: true
    });
    /** dispatch方法实现 */
    Mediator.prototype.dispatch = function () {
        var params = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            params[_i] = arguments[_i];
        }
        this._observable.dispatch.apply(this._observable, params);
    };
    /**
     * 监听消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Mediator
     */
    Mediator.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.listen(type, handler, thisArg, once);
    };
    /**
     * 移除消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否是一次性监听
     * @memberof Mediator
     */
    Mediator.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        this._observable.unlisten(type, handler, thisArg, once);
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Mediator
     */
    Mediator.prototype.mapCommand = function (type, cmd) {
        this._observable.mapCommand(type, cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Mediator
     */
    Mediator.prototype.unmapCommand = function (type, cmd) {
        this._observable.unmapCommand(type, cmd);
    };
    /**
     * 销毁中介者
     *
     * @memberof Mediator
     */
    Mediator.prototype.dispose = function () {
        var _this = this;
        // 判断状态
        if (this.status >= __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].DISPOSING)
            return;
        // 修改状态
        this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].DISPOSING;
        // 移除绑定
        __WEBPACK_IMPORTED_MODULE_7__bind_BindManager__["a" /* bindManager */].unbind(this);
        // 注销事件监听
        this.unmapAllListeners();
        // 调用模板方法
        this.onDispose();
        // 移除显示，只移除没有原始皮肤的，因为如果有原始皮肤，其原始parent可能不希望子节点被移除
        if (!this.oriSkin) {
            if (this.skin && this.bridge) {
                var parent = this.bridge.getParent(this.skin);
                if (parent)
                    this.bridge.removeChild(parent, this.skin);
            }
        }
        // 移除表现层桥
        this.bridge = null;
        // 移除ViewModel
        Object(__WEBPACK_IMPORTED_MODULE_8__bind_Mutator__["b" /* unmutate */])(this._viewModel);
        this._viewModel = null;
        // 移除绑定目标数组
        this.bindTargets = null;
        // 移除数据
        this.data = null;
        // 移除皮肤
        this.skin = null;
        this.oriSkin = null;
        // 移除父引用
        this.parent = null;
        // 移除其他无用对象
        this.moduleOpenHandler = null;
        // 将所有子中介者销毁
        var children = this._children.concat();
        for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {
            var child = children_1[_i];
            child.dispose();
        }
        // 将observable的销毁拖延到下一帧，因为虽然执行了销毁，但有可能这之后还会使用observable发送消息
        __WEBPACK_IMPORTED_MODULE_12__system_System__["a" /* system */].nextFrame(function () {
            // 移除observable
            _this._observable.dispose();
            _this._observable = null;
            // 修改状态
            _this._status = __WEBPACK_IMPORTED_MODULE_15__MediatorStatus__["a" /* default */].DISPOSED;
        });
    };
    /**
     * 当销毁时调用
     *
     * @memberof Mediator
     */
    Mediator.prototype.onDispose = function () {
        // 可重写
    };
    return Mediator;
}());
/* harmony default export */ __webpack_exports__["default"] = (Mediator);


/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return bridgeManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__mask_MaskManager__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__module_ModuleManager__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__panel_PanelManager__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__scene_SceneManager__ = __webpack_require__(39);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__BridgeMessage__ = __webpack_require__(41);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 用来管理所有表现层对象
*/
var BridgeManager = /** @class */ (function () {
    function BridgeManager() {
        this._bridgeDict = {};
        this._bridgeList = [];
    }
    Object.defineProperty(BridgeManager.prototype, "currentBridge", {
        /**
         * 获取当前的表现层桥实例（规则是取当前模块的第一个拥有bridge属性的Mediator的bridge）
         *
         * @readonly
         * @type {IBridge}
         * @memberof BridgeManager
         */
        get: function () {
            // 找出当前的场景或模块
            var curHasBridge = __WEBPACK_IMPORTED_MODULE_7__scene_SceneManager__["a" /* sceneManager */].currentScene || __WEBPACK_IMPORTED_MODULE_5__module_ModuleManager__["moduleManager"].currentModuleInstance;
            // 先用当前首个IHasBridge的bridge
            if (curHasBridge) {
                var hasBridges = this.getAllHasBridges(curHasBridge);
                for (var _i = 0, hasBridges_1 = hasBridges; _i < hasBridges_1.length; _i++) {
                    var hasBridge = hasBridges_1[_i];
                    if (hasBridge.bridge)
                        return hasBridge.bridge;
                }
            }
            // 没找到，再用第一个桥代替
            return (this._bridgeList[0] && this._bridgeList[0][0]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BridgeManager.prototype, "bridges", {
        /**
         * 获取所有表现层桥
         *
         * @readonly
         * @type {IBridge[]}
         * @memberof BridgeManager
         */
        get: function () {
            return this._bridgeList.map(function (bridgeData) { return bridgeData[0]; });
        },
        enumerable: true,
        configurable: true
    });
    BridgeManager.prototype.getAllHasBridges = function (hasBridge) {
        var result = [hasBridge];
        // 如果是中介者，则额外提供子中介者
        if (hasBridge instanceof __WEBPACK_IMPORTED_MODULE_4__mediator_Mediator__["default"]) {
            for (var _i = 0, _a = hasBridge.children; _i < _a.length; _i++) {
                var temp = _a[_i];
                result = result.concat(this.getAllHasBridges(temp));
            }
        }
        return result;
    };
    /**
     * 获取表现层桥实例
     *
     * @param {string} type 表现层类型
     * @returns {IBridge} 表现层桥实例
     * @memberof BridgeManager
     */
    BridgeManager.prototype.getBridge = function (type) {
        var data = this._bridgeDict[type];
        return (data && data[0]);
    };
    /**
     * 通过给出一个显示对象皮肤实例来获取合适的表现层桥实例
     *
     * @param {*} skin 皮肤实例
     * @returns {IBridge|null} 皮肤所属表现层桥实例
     * @memberof BridgeManager
     */
    BridgeManager.prototype.getBridgeBySkin = function (skin) {
        if (skin) {
            // 遍历所有已注册的表现层桥进行判断
            for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
                var data = _a[_i];
                var bridge = data[0];
                if (bridge.isMySkin(skin))
                    return bridge;
            }
        }
        return null;
    };
    /**
     * 注册一个表现层桥实例到框架中
     *
     * @param {...IBridge[]} bridges 要注册的所有表现层桥
     * @memberof BridgeManager
     */
    BridgeManager.prototype.registerBridge = function () {
        var _this = this;
        var bridges = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            bridges[_i] = arguments[_i];
        }
        // 进行DOM初始化判断
        if (!document.body) {
            var onLoad = function (evt) {
                window.removeEventListener("load", onLoad);
                // 重新调用注册方法
                _this.registerBridge.apply(_this, bridges);
            };
            window.addEventListener("load", onLoad);
            return;
        }
        // 进行初始化
        if (bridges.length > 0) {
            var self = this;
            // 记录
            for (var _a = 0, bridges_1 = bridges; _a < bridges_1.length; _a++) {
                var bridge = bridges_1[_a];
                var type = bridge.type;
                if (!this._bridgeDict[type]) {
                    var data = [bridge, false];
                    this._bridgeDict[type] = data;
                    this._bridgeList.push(data);
                }
            }
            // 开始初始化
            for (var _b = 0, bridges_2 = bridges; _b < bridges_2.length; _b++) {
                var bridge = bridges_2[_b];
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__BridgeMessage__["a" /* default */].BRIDGE_BEFORE_INIT, bridge);
                // 初始化Mask
                __WEBPACK_IMPORTED_MODULE_3__mask_MaskManager__["a" /* maskManager */].registerMask(bridge.type, bridge.maskEntity);
                // 注册通用提示框
                __WEBPACK_IMPORTED_MODULE_6__panel_PanelManager__["a" /* panelManager */].registerPrompt(bridge.type, bridge.promptClass);
                // 初始化该表现层实例
                if (bridge.init)
                    bridge.init(afterInitBridge);
                else
                    afterInitBridge(bridge);
            }
        }
        else {
            this.testAllInit();
        }
        function afterInitBridge(bridge) {
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__BridgeMessage__["a" /* default */].BRIDGE_AFTER_INIT, bridge);
            // 设置初始化完毕属性
            var data = self._bridgeDict[bridge.type];
            data[1] = true;
            // 先隐藏表现层桥的htmlWrapper
            bridge.htmlWrapper.style.display = "none";
            // 测试是否全部初始化完毕
            self.testAllInit();
        }
    };
    BridgeManager.prototype.testAllInit = function () {
        var allInited = true;
        for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
            var data = _a[_i];
            allInited = allInited && data[1];
        }
        if (allInited)
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT);
    };
    BridgeManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], BridgeManager);
    return BridgeManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (BridgeManager);
/** 再额外导出一个单例 */
var bridgeManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(BridgeManager);


/***/ }),
/* 9 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["ModelClass"] = ModelClass;
/* harmony export (immutable) */ __webpack_exports__["MediatorClass"] = MediatorClass;
/* harmony export (immutable) */ __webpack_exports__["MessageHandler"] = MessageHandler;
/* harmony export (immutable) */ __webpack_exports__["GlobalMessageHandler"] = GlobalMessageHandler;
/* harmony export (immutable) */ __webpack_exports__["ResponseHandler"] = ResponseHandler;
/* harmony export (immutable) */ __webpack_exports__["ResponseErrorHandler"] = ResponseErrorHandler;
/* harmony export (immutable) */ __webpack_exports__["GlobalResponseHandler"] = GlobalResponseHandler;
/* harmony export (immutable) */ __webpack_exports__["GlobalResponseErrorHandler"] = GlobalResponseErrorHandler;
/* harmony export (immutable) */ __webpack_exports__["SubMediator"] = SubMediator;
/* harmony export (immutable) */ __webpack_exports__["BindValue"] = BindValue;
/* harmony export (immutable) */ __webpack_exports__["BindExp"] = BindExp;
/* harmony export (immutable) */ __webpack_exports__["BindFunc"] = BindFunc;
/* harmony export (immutable) */ __webpack_exports__["BindOn"] = BindOn;
/* harmony export (immutable) */ __webpack_exports__["BindIf"] = BindIf;
/* harmony export (immutable) */ __webpack_exports__["BindFor"] = BindFor;
/* harmony export (immutable) */ __webpack_exports__["BindMessage"] = BindMessage;
/* harmony export (immutable) */ __webpack_exports__["BindGlobalMessage"] = BindGlobalMessage;
/* harmony export (immutable) */ __webpack_exports__["BindResponse"] = BindResponse;
/* harmony export (immutable) */ __webpack_exports__["BindGlobalResponse"] = BindGlobalResponse;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_global_Patch__ = __webpack_require__(20);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_message_Message__ = __webpack_require__(31);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__libs_Reflect__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__libs_Reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4__libs_Reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_DisplayUtil__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__bind_Utils__ = __webpack_require__(23);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__ = __webpack_require__(18);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__net_NetManager__ = __webpack_require__(14);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__ = __webpack_require__(44);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__BindUtil__ = __webpack_require__(68);















/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * 负责注入的模块
*/
/** 定义数据模型，支持实例注入，并且自身也会被注入 */
function ModelClass() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    // 转调Injectable方法
    if (this === __WEBPACK_IMPORTED_MODULE_1__core_global_Patch__["decorateThis"]) {
        var cls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(args[0]);
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"].call(this, cls);
        return cls;
    }
    else {
        var result = __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"].apply(this, args);
        return function (realCls) {
            realCls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(realCls);
            result.call(this, realCls);
            return realCls;
        };
    }
}
/** 定义界面中介者，支持实例注入，并可根据所赋显示对象自动调整所使用的表现层桥 */
function MediatorClass(moduleName) {
    return function (cls) {
        // 判断一下Mediator是否有dispose方法，没有的话弹一个警告
        if (!cls.prototype.dispose)
            console.warn("Mediator[" + cls["name"] + "]不具有dispose方法，可能会造成内存问题，请让该Mediator实现IDisposable接口");
        // 监听实例化
        Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
            // 替换skin属性
            var $skin;
            var oriSkin = instance.skin;
            Object.defineProperty(instance, "skin", {
                configurable: true,
                enumerable: true,
                get: function () {
                    return $skin;
                },
                set: function (value) {
                    if (value === $skin)
                        return;
                    var lastBridge = this.bridge;
                    // 根据skin类型选取表现层桥
                    this.bridge = __WEBPACK_IMPORTED_MODULE_9__bridge_BridgeManager__["a" /* bridgeManager */].getBridgeBySkin(value);
                    // 记录值
                    if (this.bridge) {
                        if (this.bridge === lastBridge && $skin) {
                            // 需要判断桥的类型是否相同，且之前有皮肤，则替换皮肤
                            $skin = this.bridge.replaceSkin(this, $skin, value);
                        }
                        else {
                            // 否则直接包装一下皮肤
                            $skin = this.bridge.wrapSkin(this, value);
                        }
                    }
                    else {
                        // 不认识的皮肤类型，直接赋值
                        $skin = value;
                    }
                }
            });
            // 如果本来就有皮肤，则赋值皮肤
            if (oriSkin)
                instance.skin = oriSkin;
        });
        // 包装类
        var wrapperCls = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["e" /* wrapConstruct */])(cls);
        // 注册模块，每一个Mediator都有成为独立Module的能力
        Object(__WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["registerModule"])(moduleName, wrapperCls);
        // 返回包装类
        return wrapperCls;
    };
}
function MessageHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_3__core_message_Message__["a" /* default */]))
            throw new Error("@MessageHandler装饰器装饰的方法的首个参数必须是Message");
        doMessageHandler(target.constructor, key, resClass, true);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doMessageHandler(prototype.constructor, propertyKey, target, true);
        };
    }
}
;
function GlobalMessageHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_3__core_message_Message__["a" /* default */]))
            throw new Error("@GlobalMessageHandler装饰器装饰的方法的首个参数必须是Message");
        doMessageHandler(target.constructor, key, resClass, false);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doMessageHandler(prototype.constructor, propertyKey, target, false);
        };
    }
}
;
function doMessageHandler(cls, key, type, inModule) {
    // 监听实例化
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        if (instance instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"] && instance.parent) {
            // 如果是被托管的Mediator，则需要等到被托管后再执行注册
            addSubHandler(instance, function () {
                var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable;
                observable.listen(type, instance[key], instance);
            });
        }
        else {
            var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable;
            observable.listen(type, instance[key], instance);
        }
    });
    // 监听销毁
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(cls, function (instance) {
        var observable = inModule ? instance.observable || __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable : __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].observable;
        observable.unlisten(type, instance[key], instance);
    });
}
function ResponseHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__["default"]))
            throw new Error("无参数@ResponseHandler装饰器装饰的方法的首个参数必须是ResponseData");
        doResponseHandler(target.constructor, key, defs[0], true, false);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doResponseHandler(prototype.constructor, propertyKey, target, true, false);
        };
    }
}
/** 处理通讯消息错误 */
function ResponseErrorHandler(cls) {
    return function (prototype, propertyKey, descriptor) {
        doResponseHandler(prototype.constructor, propertyKey, cls, true, true);
    };
}
function GlobalResponseHandler(target, key) {
    if (key) {
        var defs = Reflect.getMetadata("design:paramtypes", target, key);
        var resClass = defs[0];
        if (!(resClass.prototype instanceof __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__["default"]))
            throw new Error("无参数@GlobalResponseHandler装饰器装饰的方法的首个参数必须是ResponseData");
        doResponseHandler(target.constructor, key, defs[0], false, false);
    }
    else {
        return function (prototype, propertyKey, descriptor) {
            doResponseHandler(prototype.constructor, propertyKey, target, false, false);
        };
    }
}
/** 处理全局通讯消息错误 */
function GlobalResponseErrorHandler(cls) {
    return function (prototype, propertyKey, descriptor) {
        doResponseHandler(prototype.constructor, propertyKey, cls, false, true);
    };
}
function doResponseHandler(cls, key, type, inModule, listenError) {
    var curInstance;
    // 监听实例化
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (instance) {
        // 记录赋值
        curInstance = instance;
        // 判断是否中介者
        if (instance instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"] && instance.parent) {
            // 如果是被托管的Mediator，则需要等到被托管后再执行注册
            addSubHandler(instance, function () {
                __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].listenResponse(type, handler, instance, false, (inModule ? instance.observable : undefined));
            });
        }
        else {
            __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].listenResponse(type, handler, instance, false, (inModule ? instance.observable : undefined));
        }
    });
    // 监听销毁
    Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(cls, function (instance) {
        __WEBPACK_IMPORTED_MODULE_12__net_NetManager__["netManager"].unlistenResponse(type, handler, instance, false, (inModule ? instance.observable : undefined));
    });
    function handler(response, request) {
        if (listenError) {
            // 监听的是错误
            if (response instanceof Error) {
                curInstance[key].call(this, response, request);
            }
        }
        else {
            // 监听的是正确的返回
            if (response instanceof __WEBPACK_IMPORTED_MODULE_13__net_ResponseData__["default"]) {
                curInstance[key].call(this, response, request);
            }
        }
    }
}
var subHandlerDict = new __WEBPACK_IMPORTED_MODULE_6__utils_Dictionary__["a" /* default */]();
function addSubHandler(instance, handler) {
    if (!instance)
        return;
    var handlers = subHandlerDict.get(instance);
    if (!handlers)
        subHandlerDict.set(instance, handlers = []);
    if (handlers.indexOf(handler) < 0)
        handlers.push(handler);
}
function SubMediator(arg1, arg2, arg3) {
    var oriSkin;
    var mediatorCls;
    var dataExp;
    // 判断是否是参数化装饰
    if (this === __WEBPACK_IMPORTED_MODULE_1__core_global_Patch__["decorateThis"]) {
        // 无参数
        doSubMediator(arg1, arg2);
    }
    else {
        // 有参数，分配参数
        if (!arg2 && !arg3) {
            // 一个参数，需要判断该参数是否是Mediator类型
            if (arg1 instanceof Function && Object(__WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["getModuleName"])(arg1) != null) {
                // 是Mediator类型
                mediatorCls = arg1;
            }
            else {
                // 不是Mediator类型，认为是表达式
                dataExp = arg1;
            }
        }
        else if (arg1 instanceof Function) {
            mediatorCls = arg1;
            dataExp = arg2;
        }
        else {
            oriSkin = arg1;
            mediatorCls = arg2;
            dataExp = arg3;
        }
        // 返回装饰器方法
        return doSubMediator;
    }
    function doSubMediator(prototype, propertyKey) {
        if (Object(__WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["isMediator"])(prototype)) {
            // 监听实例化
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["c" /* listenConstruct */])(prototype.constructor, function (instance) {
                var skin = oriSkin;
                var declaredCls = Reflect.getMetadata("design:type", prototype, propertyKey);
                var declaredMediatorCls;
                if (Object(__WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["isMediator"])(declaredCls.prototype))
                    declaredMediatorCls = declaredCls;
                var mediator;
                var temp = instance[propertyKey];
                // 篡改属性
                Object.defineProperty(instance, propertyKey, {
                    configurable: true,
                    enumerable: true,
                    get: function () {
                        // 如果类型声明为Mediator，则返回Mediator，否则返回皮肤本身
                        return (declaredMediatorCls ? mediator : skin);
                    },
                    set: function (value) {
                        var _this = this;
                        if (value instanceof __WEBPACK_IMPORTED_MODULE_10__mediator_Mediator__["default"]) {
                            // 取消托管中介者
                            if (mediator) {
                                this.undelegateMediator(mediator);
                            }
                            // 设置中介者
                            mediator = value;
                            // 托管新的中介者
                            if (mediator) {
                                // 如果当前中介者没有皮肤就用装饰器皮肤
                                if (skin && !mediator.skin)
                                    mediator.skin = skin;
                            }
                        }
                        else if (value) {
                            // 赋值皮肤
                            skin = value;
                            // 如果存在中介者，则额外赋值中介者皮肤
                            if (mediator) {
                                if (mediator.skin && mediator.status < __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED) {
                                    // 当前有皮肤且中介者尚未打开完毕，说明是现在是皮肤转发阶段，要用老皮肤替换新皮肤的位置
                                    Object(__WEBPACK_IMPORTED_MODULE_7__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, value, mediator.skin);
                                    // 同步位置
                                    mediator.bridge.syncSkin(value, mediator.skin);
                                }
                                else {
                                    // 当前没皮肤，或者中介者已经打开完毕了，说明新皮肤就是要替换老皮肤
                                    mediator.skin = value;
                                }
                            }
                        }
                        else {
                            // mediator和skin都赋值为空
                            skin = value;
                            if (mediator) {
                                mediator.skin = value;
                            }
                            mediator = value;
                        }
                        // 如果当前中介者已经为正在打开或已打开状态，则额外调用open
                        if (mediator) {
                            // 托管中介者
                            this.delegateMediator(mediator);
                            // 如果当前中介者已经为正在打开或已打开状态，则额外调用open
                            if (mediator.skin) {
                                if (mediator.status === __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].UNOPEN) {
                                    var getCommonScope = function () {
                                        return {
                                            $this: _this,
                                            $data: _this.viewModel,
                                            $bridge: _this.bridge,
                                            $currentTarget: mediator,
                                            $target: mediator
                                        };
                                    };
                                    // 子Mediator还没有open，open之
                                    if (this.status === __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED) {
                                        // 父Mediator已经open了，直接open之
                                        var data = dataExp ? Object(__WEBPACK_IMPORTED_MODULE_8__bind_Utils__["c" /* evalExp */])(dataExp, this.viewModel, this.viewModel, this.data, getCommonScope()) : this.data;
                                        if (!data)
                                            data = this.data;
                                        // 执行open方法
                                        mediator.open(data);
                                    }
                                    else if (this.status < __WEBPACK_IMPORTED_MODULE_11__mediator_MediatorStatus__["a" /* default */].OPENED && dataExp) {
                                        // 父Mediator也没有open，监听子Mediator的open，篡改参数
                                        Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["b" /* listenApply */])(mediator, "open", function () {
                                            var data = Object(__WEBPACK_IMPORTED_MODULE_8__bind_Utils__["c" /* evalExp */])(dataExp, _this.viewModel, _this.viewModel, _this.data, getCommonScope());
                                            if (data)
                                                return [data];
                                        });
                                    }
                                }
                            }
                        }
                    }
                });
                // 实例化
                if (temp) {
                    instance[propertyKey] = temp;
                }
                else if (temp === undefined) {
                    // 优先使用是中介者类的元数据类型，其次使用装饰器提供的中介者类型
                    var cls = declaredMediatorCls || mediatorCls;
                    if (!cls)
                        throw new Error("必须在类型声明或装饰器中至少一处提供Mediator的类型");
                    instance[propertyKey] = temp = new cls(skin);
                }
                // 执行回调
                var handlers = subHandlerDict.get(mediator);
                if (handlers) {
                    for (var _i = 0, handlers_1 = handlers; _i < handlers_1.length; _i++) {
                        var handler = handlers_1[_i];
                        handler(mediator);
                    }
                    // 移除记录
                    subHandlerDict.delete(mediator);
                }
            });
            // 监听销毁
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_ConstructUtil__["d" /* listenDispose */])(prototype.constructor, function (instance) {
                var mediator = instance[propertyKey];
                if (mediator) {
                    // 移除实例
                    delete instance[propertyKey];
                }
            });
        }
    }
}
/**
 * @private
 */
function BindValue(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            // 组织参数字典
            var uiDict;
            if (typeof arg1 == "string") {
                uiDict = {};
                uiDict[arg1] = arg2;
            }
            else {
                uiDict = arg1;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, name, exp) {
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileValue"], name, exp);
            });
        });
    };
}
/**
 * @private
 */
function BindExp(exp) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            // 组织参数字典
            var uiDict = {};
            if (exp instanceof Array) {
                for (var key in exp) {
                    uiDict[key] = exp[key];
                }
            }
            else {
                uiDict[""] = exp;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, name, exp) {
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileExp"], exp);
            });
        });
    };
}
/**
 * @private
 */
function BindFunc(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            // 组织参数字典
            var funcDict;
            if (typeof arg1 == "string") {
                funcDict = {};
                funcDict[arg1] = arg2;
            }
            else {
                funcDict = arg1;
            }
            // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
            var target = mediator[propertyKey];
            __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](funcDict, mediator, target, function (currentTarget, target, name, argExps) {
                // 统一参数类型为字符串数组
                if (!(argExps instanceof Array))
                    argExps = [argExps];
                // 添加编译指令
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"].apply(__WEBPACK_IMPORTED_MODULE_14__BindUtil__, [currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFunc"], name].concat(argExps));
            });
        });
    };
}
/**
 * @private
 */
function BindOn(arg1, arg2, arg3) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            // 获取编译启动目标
            var target = mediator[propertyKey];
            // 组织参数字典
            if (typeof arg1 == "string") {
                if (arg3) {
                    // 指定了UI对象，先去寻找
                    var nameDict = {};
                    nameDict[arg1] = "";
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](nameDict, mediator, target, function (currentTarget, target, type, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], arg2, arg3);
                    }, true);
                }
                else {
                    var evtDict = {};
                    evtDict[arg1] = arg2;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](evtDict, mediator, target, function (currentTarget, target, type, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], type, exp);
                    });
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](arg1, mediator, target, function (currentTarget, target, type, exp) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileOn"], type, exp);
                });
            }
        });
    };
}
/**
 * @private
 */
function BindIf(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 === "string" || arg1 instanceof Function) {
                if (!arg2) {
                    // 没有指定寻址路径，就是要操作当前对象，但也要经过一次searchUIDepth操作
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"]({ r: 13 }, mediator, target, function (currentTarget, target, name, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], arg1);
                    });
                }
                else {
                    // 指定了寻址路径，需要寻址
                    var uiDict = {};
                    uiDict[arg1] = arg2;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, name, exp) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], exp);
                    }, true);
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](arg1, mediator, target, function (currentTarget, target, name, exp) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileIf"], exp);
                }, true);
            }
        });
    };
}
/**
 * @private
 */
function BindFor(arg1, arg2, arg3, arg4) {
    // 组织参数
    var uiDict;
    var name;
    var exp;
    var mediatorCls;
    var dataExp;
    if (typeof arg1 === "string" && (typeof arg2 === "string" || arg2 instanceof Array)) {
        // 是寻址方式，需要记录name
        name = arg1;
        exp = arg2;
        mediatorCls = arg3;
        dataExp = arg4;
    }
    else if (typeof arg1 === "string" || arg1 instanceof Array) {
        // 是无寻址方式，直接从exp开始记录
        exp = arg1;
        mediatorCls = arg2;
        dataExp = arg3;
    }
    else {
        // 是寻址集合方式
        uiDict = arg1;
    }
    return function (prototype, propertyKey) {
        var declaredCls = Reflect.getMetadata("design:type", prototype, propertyKey);
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            // 取到编译目标对象
            var target = mediator[propertyKey];
            // 开始赋值指令
            if (!uiDict) {
                if (!name) {
                    // 没有指定寻址路径，就是要操作当前对象，但也要经过一次searchUIDepth操作
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"]({ r: 13 }, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], propertyKey, exp, mediatorCls, declaredCls, dataExp);
                        // 设置中断编译
                        target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                    });
                }
                else {
                    // 指定了寻址路径，需要寻址
                    uiDict = {};
                    uiDict[name] = exp;
                    // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                        // 添加编译指令
                        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], propertyKey, _exp, mediatorCls, declaredCls, dataExp);
                        // 设置中断编译
                        target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                    }, true);
                }
            }
            else {
                // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
                __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, _name, _exp, leftHandlers, index) {
                    // 添加编译指令
                    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileFor"], propertyKey, _exp, mediatorCls, declaredCls, dataExp);
                    // 设置中断编译
                    target.__stop_left_handlers__ = leftHandlers ? leftHandlers.splice(index + 1, leftHandlers.length - index - 1) : [];
                }, true);
            }
        });
    };
}
function doBindMessage(mediator, target, type, uiDict, observable) {
    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, name, exp) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileMessage"], type, name, exp, observable);
    });
}
/**
 * @private
 */
function BindMessage(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindMessage(mediator, target, arg1, arg2, mediator.observable);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindMessage(mediator, target, type, arg1[type], mediator.observable);
                }
            }
        });
    };
}
/**
 * @private
 */
function BindGlobalMessage(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindMessage(mediator, target, arg1, arg2);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindMessage(mediator, target, type, arg1[type]);
                }
            }
        });
    };
}
function doBindResponse(mediator, target, type, uiDict, observable) {
    __WEBPACK_IMPORTED_MODULE_14__BindUtil__["searchUIDepth"](uiDict, mediator, target, function (currentTarget, target, name, exp) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["pushCompileCommand"](currentTarget, target, __WEBPACK_IMPORTED_MODULE_14__BindUtil__["compileResponse"], type, name, exp, observable);
    });
}
/**
 * @private
 */
function BindResponse(arg1, arg2) {
    return function (prototype, propertyKey) {
        // Response需要在onOpen之后执行，因为可能有初始化消息需要绑定，要在onOpen后有了viewModel再首次更新显示
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindResponse(mediator, target, arg1, arg2, mediator.observable);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindResponse(mediator, target, type, arg1[type], mediator.observable);
                }
            }
        });
    };
}
/**
 * @private
 */
function BindGlobalResponse(arg1, arg2) {
    return function (prototype, propertyKey) {
        __WEBPACK_IMPORTED_MODULE_14__BindUtil__["listenOnOpen"](prototype, function (mediator) {
            var target = mediator[propertyKey];
            if (typeof arg1 == "string" || arg1 instanceof Function) {
                // 是类型方式
                doBindResponse(mediator, target, arg1, arg2);
            }
            else {
                // 是字典方式
                for (var type in arg1) {
                    doBindResponse(mediator, target, type, arg1[type]);
                }
            }
        });
    };
}


/***/ }),
/* 10 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "moduleManager", function() { return moduleManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__mediator_IMediatorModulePart__ = __webpack_require__(38);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__ModuleMessage__ = __webpack_require__(17);







/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-14
 * @modify date 2017-09-15
 *
 * 模块管理器，管理模块相关的所有操作。模块具有唯一性，同一时间不可以打开两个相同模块，如果打开则会退回到先前的模块处
*/
var ModuleManager = /** @class */ (function () {
    function ModuleManager() {
        this._moduleStack = [];
        this._openCache = [];
        this._opening = null;
        this._busy = false;
    }
    Object.defineProperty(ModuleManager.prototype, "currentModule", {
        /**
         * 获取当前模块
         *
         * @readonly
         * @type {IMediatorConstructor|undefined}
         * @memberof ModuleManager
         */
        get: function () {
            var curData = this.getCurrent();
            return (curData && curData[0]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ModuleManager.prototype, "currentModuleInstance", {
        /**
         * 获取当前模块的实例
         *
         * @readonly
         * @type {(IMediator|undefined)}
         * @memberof ModuleManager
         */
        get: function () {
            var curData = this.getCurrent();
            return (curData && curData[1]);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ModuleManager.prototype, "activeCount", {
        /**
         * 获取活动模块数量
         *
         * @readonly
         * @type {number}
         * @memberof ModuleManager
         */
        get: function () {
            return this._moduleStack.length;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取模块在栈中的索引
     *
     * @param {IMediatorConstructor} cls 模块类型
     * @returns {number} 索引值
     * @memberof ModuleManager
     */
    ModuleManager.prototype.getIndex = function (cls) {
        for (var i = 0, len = this._moduleStack.length; i < len; i++) {
            if (this._moduleStack[i][0] == cls)
                return i;
        }
        return -1;
    };
    /**
     * 获取索引处模块类型
     *
     * @param {number} index 模块索引值
     * @returns {IMediatorConstructor} 模块类型
     * @memberof ModuleManager
     */
    ModuleManager.prototype.getModule = function (index) {
        var data = this._moduleStack[index];
        return data && data[0];
    };
    ModuleManager.prototype.getAfter = function (cls) {
        var result = [];
        for (var _i = 0, _a = this._moduleStack; _i < _a.length; _i++) {
            var module = _a[_i];
            if (module[0] == cls)
                return result;
            result.push(module);
        }
        return null;
    };
    ModuleManager.prototype.getCurrent = function () {
        // 按顺序遍历模块，取出最新的没有在开启中的模块
        var target;
        for (var _i = 0, _a = this._moduleStack; _i < _a.length; _i++) {
            var temp = _a[_i];
            if (temp[0] !== this._opening) {
                target = temp;
                break;
            }
        }
        return target;
    };
    /**
     * 获取模块是否开启中
     *
     * @param {IMediatorConstructor} cls 要判断的模块类型
     * @returns {boolean} 是否开启
     * @memberof ModuleManager
     */
    ModuleManager.prototype.isOpened = function (cls) {
        return (this._moduleStack.filter(function (temp) { return temp[0] == cls; }).length > 0);
    };
    ModuleManager.prototype.activateModule = function (module, from, data) {
        if (module) {
            // 调用activate接口
            module.activate(from, data);
        }
    };
    ModuleManager.prototype.deactivateModule = function (module, to, data) {
        if (module) {
            // 调用deactivate接口
            module.deactivate(to, data);
        }
    };
    /**
     * 打开模块
     *
     * @param {ModuleType|string} clsOrName 模块类型或名称
     * @param {*} [data] 参数
     * @param {boolean} [replace=false] 是否替换当前模块
     * @memberof ModuleManager
     */
    ModuleManager.prototype.open = function (module, data, replace) {
        var _this = this;
        if (replace === void 0) { replace = false; }
        return new Promise(function (resolve) { return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](_this, void 0, void 0, function () {
            var type, cls, after, target, from, fromModule, moduleData, openData, i, len, closeData;
            var _this = this;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        type = (typeof module == "string" ? Object(__WEBPACK_IMPORTED_MODULE_5__mediator_Mediator__["getModule"])(module) : module);
                        // 非空判断
                        if (!type)
                            return [2 /*return*/];
                        // 判断是否正在打开模块
                        if (this._busy) {
                            this._openCache.push([type, data, replace, resolve]);
                            return [2 /*return*/];
                        }
                        this._busy = true;
                        cls = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
                        after = this.getAfter(cls);
                        if (!!after) return [3 /*break*/, 2];
                        // 记录正在打开的模块类型
                        this._opening = type;
                        target = type instanceof Function ? new cls() : type;
                        // 赋值打开参数
                        target.data = data;
                        from = this.getCurrent();
                        fromModule = from && from[1];
                        moduleData = [cls, target, null];
                        this._moduleStack.unshift(moduleData);
                        // 设置回调
                        target.moduleOpenHandler = function (status, err) { return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](_this, void 0, void 0, function () {
                            var _a, tempData;
                            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_b) {
                                switch (_b.label) {
                                    case 0:
                                        _a = status;
                                        switch (_a) {
                                            case __WEBPACK_IMPORTED_MODULE_4__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].Stop: return [3 /*break*/, 1];
                                            case __WEBPACK_IMPORTED_MODULE_4__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].BeforeOpen: return [3 /*break*/, 3];
                                            case __WEBPACK_IMPORTED_MODULE_4__mediator_IMediatorModulePart__["a" /* ModuleOpenStatus */].AfterOpen: return [3 /*break*/, 4];
                                        }
                                        return [3 /*break*/, 6];
                                    case 1:
                                        // 需要判断是否是最后一个模块，最后一个模块不允许被销毁
                                        if (this._moduleStack.length > 1) {
                                            tempData = this._moduleStack.shift();
                                            // 销毁模块
                                            tempData[1].dispose();
                                        }
                                        // 派发失败消息
                                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_6__ModuleMessage__["default"].MODULE_CHANGE_FAILED, cls, from && from[0], err);
                                        // 结束一次模块开启
                                        return [4 /*yield*/, this.onFinishOpen()];
                                    case 2:
                                        // 结束一次模块开启
                                        _b.sent();
                                        return [3 /*break*/, 6];
                                    case 3:
                                        // 这里要优先关闭标识符，否则在开启的模块的onOpen方法里如果有操作Mask的动作就会被这个标识阻塞住
                                        this._opening = null;
                                        // 篡改target的close方法，使其改为触发ModuleManager的close
                                        moduleData[2] = target.hasOwnProperty("close") ? target.close : null;
                                        target.close = function (data) {
                                            return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](this, void 0, void 0, function () {
                                                return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
                                                    switch (_a.label) {
                                                        case 0: return [4 /*yield*/, moduleManager.close(target, data)];
                                                        case 1: return [2 /*return*/, _a.sent()];
                                                    }
                                                });
                                            });
                                        };
                                        return [3 /*break*/, 6];
                                    case 4:
                                        // 调用onDeactivate接口
                                        this.deactivateModule(fromModule, target, data);
                                        // 调用onActivate接口
                                        this.activateModule(target, fromModule, data);
                                        // 如果replace是true，则关掉上一个模块
                                        if (replace)
                                            this.close(from && from[0], data);
                                        // 派发消息
                                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_6__ModuleMessage__["default"].MODULE_CHANGE, cls, fromModule);
                                        // 结束一次模块开启
                                        return [4 /*yield*/, this.onFinishOpen()];
                                    case 5:
                                        // 结束一次模块开启
                                        _b.sent();
                                        return [3 /*break*/, 6];
                                    case 6: return [2 /*return*/];
                                }
                            });
                        }); };
                        return [4 /*yield*/, target.open(data)];
                    case 1:
                        openData = _a.sent();
                        // 调用resolve
                        resolve(openData);
                        return [3 /*break*/, 7];
                    case 2:
                        if (!(after.length > 0)) return [3 /*break*/, 5];
                        // 已经打开且不是当前模块，先关闭当前模块到目标模块之间的所有模块
                        for (i = 1, len = after.length; i < len; i++) {
                            this.close(after[i][0], data);
                        }
                        return [4 /*yield*/, this.close(after[0][0], data)];
                    case 3:
                        closeData = _a.sent();
                        // 结束一次模块开启
                        return [4 /*yield*/, this.onFinishOpen()];
                    case 4:
                        // 结束一次模块开启
                        _a.sent();
                        // 调用resolve
                        resolve(closeData);
                        return [3 /*break*/, 7];
                    case 5: 
                    // 结束一次模块开启
                    return [4 /*yield*/, this.onFinishOpen()];
                    case 6:
                        // 结束一次模块开启
                        _a.sent();
                        // 调用resolve
                        resolve();
                        _a.label = 7;
                    case 7: return [2 /*return*/];
                }
            });
        }); });
    };
    ModuleManager.prototype.onFinishOpen = function () {
        return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](this, void 0, void 0, function () {
            var openCache, openData;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // 关闭标识符
                        this._opening = null;
                        this._busy = false;
                        if (!(this._openCache.length > 0)) return [3 /*break*/, 2];
                        openCache = this._openCache.shift();
                        return [4 /*yield*/, this.open.apply(this, openCache.slice(0, 3))];
                    case 1:
                        openData = _a.sent();
                        openCache[3](openData);
                        _a.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * 关闭模块，只有关闭的是当前模块时才会触发onDeactivate和onActivate，否则只会触发close
     *
     * @param {ModuleType|string} clsOrName 模块类型或名称
     * @param {*} [data] 参数
     * @memberof ModuleManager
     */
    ModuleManager.prototype.close = function (module, data) {
        var _this = this;
        return new Promise(function (resolve) { return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](_this, void 0, void 0, function () {
            var type, cls, index, moduleData, target, oriClose, closeData, to, toModule;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
                switch (_a.label) {
                    case 0:
                        type = (typeof module == "string" ? Object(__WEBPACK_IMPORTED_MODULE_5__mediator_Mediator__["getModule"])(module) : module);
                        // 非空判断
                        if (!type)
                            return [2 /*return*/];
                        // 数量判断，不足一个模块时不关闭
                        if (this.activeCount <= 1)
                            return [2 /*return*/];
                        cls = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ConstructUtil__["a" /* getConstructor */])(type instanceof Function ? type : type.constructor);
                        index = this.getIndex(cls);
                        if (index < 0)
                            return [2 /*return*/];
                        moduleData = this._moduleStack[index];
                        target = moduleData[1];
                        oriClose = moduleData[2];
                        if (oriClose)
                            target.close = oriClose;
                        else
                            delete target.close;
                        if (!(index == 0)) return [3 /*break*/, 2];
                        // 数据先行
                        this._moduleStack.shift();
                        to = this._moduleStack[0];
                        toModule = to && to[1];
                        // 调用onDeactivate接口
                        this.deactivateModule(target, toModule, data);
                        return [4 /*yield*/, target.close(data)];
                    case 1:
                        // 调用close接口
                        closeData = _a.sent();
                        // 调用onActivate接口
                        this.activateModule(toModule, target, data);
                        // 调用onWakeUp接口
                        toModule.wakeUp(target, data);
                        // 派发消息
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_6__ModuleMessage__["default"].MODULE_CHANGE, to && to[0], cls);
                        return [3 /*break*/, 4];
                    case 2:
                        // 数据先行
                        this._moduleStack.splice(index, 1);
                        return [4 /*yield*/, target.close(data)];
                    case 3:
                        // 调用close接口
                        closeData = _a.sent();
                        _a.label = 4;
                    case 4:
                        resolve(closeData);
                        return [2 /*return*/];
                }
            });
        }); });
    };
    ModuleManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], ModuleManager);
    return ModuleManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (ModuleManager);
/** 再额外导出一个单例 */
var moduleManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(ModuleManager);


/***/ }),
/* 11 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return assetsManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ArrayUtil__ = __webpack_require__(33);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_HTTPUtil__ = __webpack_require__(35);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_URLUtil__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__version_Version__ = __webpack_require__(21);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-26
 * @modify date 2017-10-26
 *
 * 资源管理器
*/
var AssetsManager = /** @class */ (function () {
    function AssetsManager() {
        this._keyDict = {};
        this._assetsDict = {};
    }
    /**
     * @private
     */
    AssetsManager.prototype.configPath = function (arg1, arg2) {
        if (typeof arg1 == "string") {
            this._keyDict[arg1] = arg2;
        }
        else {
            for (var key in arg1) {
                this._keyDict[key] = arg1[key];
            }
        }
    };
    /**
     * 获取资源，同步的，且如果找不到资源并不会触发加载
     *
     * @param {string} keyOrPath 资源的短名称或路径
     * @returns {*}
     * @memberof AssetsManager
     */
    AssetsManager.prototype.getAssets = function (keyOrPath) {
        var path = this._keyDict[keyOrPath] || keyOrPath;
        var result = this._assetsDict[path];
        // 如果是个数组则表示正在加载中，返回undefined
        if (result instanceof Array)
            return undefined;
        else
            return result;
    };
    /**
     * 加载资源，如果已加载过则同步回调，如果未加载则加载后异步回调
     *
     * @param {string|string[]} keyOrPath 资源短名称或资源路径
     * @param {(assets?:any|any[])=>void} complete 完成回调，如果加载失败则参数是个Error对象
     * @param {XMLHttpRequestResponseType} [responseType] 加载类型
     * @param {(keyOrPath?:string, assets?:any)=>void} [oneComplete] 一个资源加载完毕会调用这个回调，如果有的话。仅在keyOrPath是数组情况下生效
     * @returns {void}
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadAssets = function (keyOrPath, complete, responseType, oneComplete) {
        var _this = this;
        // 非空判断
        if (!keyOrPath) {
            complete && complete(value);
            return;
        }
        // 获取路径
        if (keyOrPath instanceof Array) {
            // 数组去重
            keyOrPath = Object(__WEBPACK_IMPORTED_MODULE_4__utils_ArrayUtil__["a" /* unique */])(keyOrPath);
            // 是个数组，转换成单一名称或对象
            var count = keyOrPath.length;
            var results = [];
            // 判断数量
            if (count > 0) {
                // 声明回调
                var handler = function (path, assets) {
                    // 调用回调
                    oneComplete && oneComplete(path, assets);
                    // 填充数组
                    var index = keyOrPath.indexOf(path);
                    results[index] = assets;
                    // 判断完成
                    if (--count === 0)
                        complete && complete(results);
                };
                // 并行加载资源
                for (var i = 0, len = count; i < len; i++) {
                    var path = keyOrPath[i];
                    this.loadAssets(path, null, null, handler);
                }
            }
            else {
                // 直接完成
                complete && complete(results);
            }
        }
        else {
            // 是单一名称或对象
            var path = this._keyDict[keyOrPath] || keyOrPath;
            // 获取值
            var value = this._assetsDict[path];
            if (value instanceof Array) {
                // 正在加载中，等待之
                value.push(complete);
            }
            else if (value) {
                // 已经加载过了，直接返回
                oneComplete && oneComplete(keyOrPath, value);
                complete && complete(value);
            }
            else {
                // 没有就去加载
                this._assetsDict[path] = value = [function (result) {
                        oneComplete && oneComplete(keyOrPath, result);
                        complete && complete(result);
                    }];
                Object(__WEBPACK_IMPORTED_MODULE_5__utils_HTTPUtil__["a" /* load */])({
                    url: __WEBPACK_IMPORTED_MODULE_8__version_Version__["a" /* version */].wrapHashUrl(path),
                    useCDN: true,
                    responseType: responseType,
                    onResponse: function (result) {
                        // 记录结果
                        _this._assetsDict[path] = result;
                        // 通知各个回调
                        for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {
                            var handler = value_1[_i];
                            handler(result);
                        }
                    },
                    onError: function (err) {
                        // 移除结果
                        delete _this._assetsDict[path];
                        // 通知各个回调
                        for (var _i = 0, value_2 = value; _i < value_2.length; _i++) {
                            var handler = value_2[_i];
                            handler(err);
                        }
                    }
                });
            }
        }
    };
    /**
     * 加载CSS样式文件
     *
     * @param {string[]} cssFiles 样式文件URL列表
     * @param {(err?:Error)=>void} handler 完成回调
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadStyleFiles = function (cssFiles, handler) {
        if (!cssFiles || cssFiles.length === 0) {
            handler();
            return;
        }
        var count = cssFiles.length;
        var stop = false;
        for (var _i = 0, cssFiles_1 = cssFiles; _i < cssFiles_1.length; _i++) {
            var cssFile = cssFiles_1[_i];
            var cssNode = document.createElement("link");
            cssNode.rel = "stylesheet";
            cssNode.type = "text/css";
            cssNode.href = __WEBPACK_IMPORTED_MODULE_7__env_Environment__["environment"].toCDNHostURL(__WEBPACK_IMPORTED_MODULE_8__version_Version__["a" /* version */].wrapHashUrl(cssFile));
            cssNode.onload = onLoadOne;
            cssNode.onerror = onErrorOne;
            document.body.appendChild(cssNode);
        }
        function onLoadOne() {
            // 如果全部加载完毕则调用回调
            if (!stop && --count === 0)
                handler();
        }
        function onErrorOne(evt) {
            if (!stop) {
                stop = true;
                handler(new Error("CSS加载失败"));
            }
        }
    };
    /**
     * 加载JS文件
     *
     * @param {JSFile[]} jsFiles js文件列表
     * @param {(err?:Error)=>void} handler 完成回调
     * @param {boolean} [ordered=false] 是否保证标签形式js的执行顺序，保证执行顺序会降低标签形式js的加载速度，因为必须串行加载。该参数不会影响JSONP形式的加载速度和执行顺序，JSONP形式脚本总是并行加载且顺序执行的。默认是true
     * @memberof AssetsManager
     */
    AssetsManager.prototype.loadJsFiles = function (jsFiles, handler, ordered) {
        if (ordered === void 0) { ordered = true; }
        if (!jsFiles || jsFiles.length === 0) {
            handler();
            return;
        }
        jsFiles = jsFiles.concat();
        var count = jsFiles.length;
        var jsonpCount = 0;
        var stop = false;
        var nodes = [];
        // 遍历加载js
        for (var i in jsFiles) {
            var jsFile = jsFiles[i];
            // 统一类型
            if (typeof jsFile === "string") {
                // 是简单路径，变成JSFileData
                jsFiles[i] = jsFile = {
                    url: jsFile,
                    mode: __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__["a" /* JSLoadMode */].AUTO
                };
            }
            // 创建一个空的script标签
            var jsNode = document.createElement("script");
            jsNode.type = "text/javascript";
            nodes.push(jsNode);
            // 开始加载
            if (jsFile.mode === __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__["a" /* JSLoadMode */].JSONP || (jsFile.mode === __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__["a" /* JSLoadMode */].AUTO && !Object(__WEBPACK_IMPORTED_MODULE_6__utils_URLUtil__["b" /* isAbsolutePath */])(jsFile.url))) {
                this.loadAssets(jsFile.url, null, null, onCompleteOne);
                // 递增数量
                jsonpCount++;
            }
            else {
                // 使用script标签方式加载，不用在意顺序
                jsNode.onload = onLoadOne;
                jsNode.onerror = onErrorOne;
                jsNode.src = __WEBPACK_IMPORTED_MODULE_7__env_Environment__["environment"].toCDNHostURL(__WEBPACK_IMPORTED_MODULE_8__version_Version__["a" /* version */].wrapHashUrl(jsFile.url));
            }
        }
        // 判断一次
        var appendIndex = 0;
        judgeAppend();
        function judgeAppend() {
            if (jsonpCount === 0) {
                // 这里统一将所有script标签添加到DOM中，以此保持顺序
                for (var i = appendIndex, len = nodes.length; i < len;) {
                    var node = nodes[i];
                    document.body.appendChild(node);
                    // 记录添加索引
                    appendIndex = ++i;
                    // 如果需要保持顺序且当前是标签形式js，则停止添加，等待加载完毕再继续
                    if (ordered && node.src)
                        break;
                }
            }
        }
        function onCompleteOne(url, result) {
            if (result instanceof Error) {
                // 调用失败
                onErrorOne();
            }
            else {
                // 取到索引
                var index = -1;
                for (var i = 0, len = jsFiles.length; i < len; i++) {
                    var jsFile = jsFiles[i];
                    if (jsFile.url === url) {
                        index = i;
                        break;
                    }
                }
                // 填充script标签内容
                if (index >= 0) {
                    var jsNode = nodes[index];
                    jsNode.innerHTML = result;
                }
                // 递减jsonp数量
                jsonpCount--;
                // 调用成功
                onLoadOne();
            }
        }
        function onLoadOne() {
            // 添加标签
            judgeAppend();
            // 如果全部加载完毕则调用回调
            if (!stop && --count === 0)
                handler();
        }
        function onErrorOne() {
            if (!stop) {
                stop = true;
                handler(new Error("JS加载失败"));
            }
        }
    };
    AssetsManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], AssetsManager);
    return AssetsManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (AssetsManager);
/** 再额外导出一个单例 */
var assetsManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(AssetsManager);


/***/ }),
/* 12 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = getCurOrigin;
/* harmony export (immutable) */ __webpack_exports__["d"] = trimURL;
/* harmony export (immutable) */ __webpack_exports__["b"] = isAbsolutePath;
/* harmony export (immutable) */ __webpack_exports__["e"] = validateProtocol;
/* harmony export (immutable) */ __webpack_exports__["g"] = wrapHost;
/* harmony export (immutable) */ __webpack_exports__["f"] = wrapAbsolutePath;
/* unused harmony export getHostAndPathname */
/* unused harmony export getPath */
/* unused harmony export getName */
/* unused harmony export parseUrl */
/* unused harmony export getQueryParams */
/* harmony export (immutable) */ __webpack_exports__["c"] = joinQueryParams;
/* unused harmony export joinHashParams */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__ObjectUtil__ = __webpack_require__(4);

/**
 * 获取当前页面的origin，会兼容IE10以下
 *
 * @export
 * @returns {string}
 */
function getCurOrigin() {
    if (window.location.origin)
        return window.location.origin;
    return (window.location.protocol + "//" + window.location.host);
}
/**
 * 规整url
 * @param url
 */
function trimURL(url) {
    // 去除多余的"/"
    url = url.replace(/([^:\/]|(:\/))\/+/g, "$1/");
    if (url.charAt(0) == "/")
        url = url.substr(1);
    // 处理非紧贴域名的"/xx/../"
    var reg = /(?!:\/{2,}[^\/]+\/)([^\/\.]+)\/[^\/\.]+?\/\.\.\//;
    while (reg.test(url)) {
        url = url.replace(reg, "/$1");
    }
    // 处理"/./"和剩余的"/../"，直接丢弃之
    var reg = /\/\.{1,2}\//;
    while (reg.test(url)) {
        url = url.replace(reg, "/");
    }
    return url;
}
/**
 * 检查URL是否是绝对路径（具有协议头）
 * @param url 要判断的URL
 * @returns {any} 是否是绝对路径
 */
function isAbsolutePath(url) {
    if (url == null)
        return false;
    return (url.indexOf("://") >= 0);
}
/**
 * 如果url有protocol，使其与当前域名的protocol统一，否则会跨域
 * @param url 要统一protocol的url
 * @param {string} [protocol] 要统一成的protocol，不传则根据当前页面的protocol使用。根据标准，protocol是要携带:的，比如“http:”
 */
function validateProtocol(url, protocol) {
    if (url == null)
        return null;
    var index = url.indexOf("://");
    if (index < 0)
        return url;
    // 因为protocol是要携带:的，所以index自加1
    index++;
    if (protocol) {
        // 直接使用传递的protocol
        return protocol + url.substr(index);
    }
    else {
        protocol = url.substring(0, index);
        // 调整http和https
        if (protocol == "http:" || protocol == "https:") {
            return window.location.protocol + url.substr(index);
        }
        // 调整ws和wss
        if (protocol == "ws:" || protocol == "wss:") {
            if (window.location.protocol == "https:")
                protocol = "wss:";
            else
                protocol = "ws:";
            return protocol + url.substr(index);
        }
        // 不需要调整
        return url;
    }
}
/**
 * 替换url中的host，如果传入的是绝对路径且forced为false，则不会合法化protocol
 * @param url       url
 * @param host      要替换的host
 * @param forced    是否强制替换（默认false）
 */
function wrapHost(url, host, forced) {
    if (forced === void 0) { forced = false; }
    if (url == null)
        return url;
    host = host || getCurOrigin();
    var re = /^(?:[^\/]+):\/{2,}(?:[^\/]+)\//;
    var arr = url.match(re);
    if (arr && arr.length > 0) {
        if (forced) {
            url = url.substr(arr[0].length);
            url = host + "/" + url;
            // 合法化一下protocol
            url = validateProtocol(url);
        }
    }
    else {
        url = host + "/" + url;
        // 合法化一下protocol
        url = validateProtocol(url);
    }
    // 最后规整一下url
    url = trimURL(url);
    return url;
}
/**
 * 将相对于当前页面的相对路径包装成绝对路径
 * @param relativePath 相对于当前页面的相对路径
 * @param host 传递该参数会用该host替换当前host
 */
function wrapAbsolutePath(relativePath, host) {
    // 获取当前页面的url
    var curPath = getPath(window.location.href);
    var url = trimURL(curPath + "/" + relativePath);
    if (host != null) {
        url = wrapHost(url, host, true);
    }
    return url;
}
/**
 * 获取URL的host+pathname部分，即问号(?)以前的部分
 *
 */
function getHostAndPathname(url) {
    if (url == null)
        throw new Error("url不能为空");
    // 去掉get参数和hash
    url = url.split("#")[0].split("?")[0];
    // 去掉多余的/
    url = trimURL(url);
    return url;
}
/**
 * 获取URL路径（文件名前的部分）
 * @param url 要分析的URL
 */
function getPath(url) {
    // 首先去掉多余的/
    url = getHostAndPathname(url);
    // 然后获取到路径
    var urlArr = url.split("/");
    urlArr.pop();
    return urlArr.join("/") + "/";
}
/**
 * 获取URL的文件名
 * @param url 要分析的URL
 */
function getName(url) {
    // 先去掉get参数和hash
    url = url.split("#")[0].split("?")[0];
    // 然后获取到文件名
    var urlArr = url.split("/");
    var fileName = urlArr[urlArr.length - 1];
    return fileName;
}
/**
 * 解析URL
 * @param url 要被解析的URL字符串
 * @returns {any} 解析后的URLLocation结构体
 */
function parseUrl(url) {
    var regExp = /(([^:]+:)\/{2,}(([^:\/\?#]+)(:(\d+))?))?(\/[^?#]*)?(\?[^#]*)?(#.*)?/;
    var match = regExp.exec(url);
    if (match) {
        return {
            href: match[0] || "",
            origin: match[1] || "",
            protocol: match[2] || "",
            host: match[3] || "",
            hostname: match[4] || "",
            port: match[6] || "",
            pathname: match[7] || "",
            search: match[8] || "",
            hash: (match[9] == "#" ? "" : match[9]) || ""
        };
    }
    else {
        throw new Error("传入parseUrl方法的参数不是一个完整的URL：" + url);
    }
}
/**
 * 解析url查询参数
 * @TODO 添加对jquery编码方式的支持
 * @param url url
 */
function getQueryParams(url) {
    var index = url.indexOf("#");
    if (index >= 0) {
        url = url.substring(0, index);
    }
    index = url.indexOf("?");
    if (index < 0)
        return {};
    var queryString = url.substring(index + 1);
    var params = {};
    var kvs = queryString.split("&");
    for (var _i = 0, kvs_1 = kvs; _i < kvs_1.length; _i++) {
        var kv = kvs_1[_i];
        var pair = kv.split("=", 2);
        if (pair.length !== 2 || !pair[0]) {
            console.log("[URLUtil] invalid query params: " + kv);
            continue;
        }
        var name = decodeURIComponent(pair[0]);
        var value = decodeURIComponent(pair[1]);
        params[name] = value;
    }
    return params;
}
/**
 * 将参数连接到指定URL后面
 * @param url url
 * @param params 一个map，包含要连接的参数
 * @return string 连接后的URL地址
 */
function joinQueryParams(url, params) {
    if (url == null)
        throw new Error("url不能为空");
    var oriParams = getQueryParams(url);
    var targetParams = Object(__WEBPACK_IMPORTED_MODULE_0__ObjectUtil__["b" /* extendObject */])(oriParams, params);
    var hash = parseUrl(url).hash;
    url = getHostAndPathname(url);
    var isFirst = true;
    for (var key in targetParams) {
        if (isFirst) {
            url += "?" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
            isFirst = false;
        }
        else {
            url += "&" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
        }
    }
    // 加上hash
    url += hash;
    return url;
}
/**
 * 将参数链接到URL的hash后面
 * @param url 如果传入的url没有注明hash模块，则不会进行操作
 * @param params 一个map，包含要连接的参数
 */
function joinHashParams(url, params) {
    if (url == null)
        throw new Error("url不能为空");
    var hash = parseUrl(url).hash;
    if (hash == null || hash == "")
        return url;
    for (var key in params) {
        var value = params[key];
        if (value && typeof value != "string")
            value = value.toString();
        hash += ((hash.indexOf("?") < 0 ? "?" : "&") + encodeURIComponent(key) + "=" + encodeURIComponent(value));
    }
    return (url.split("#")[0] + hash);
}


/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process, global) {/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var _Reflect;
(function (Reflect) {
    // Metadata Proposal
    // https://rbuckton.github.io/reflect-metadata/
    (function (factory) {
        var root = typeof global === "object" ? global :
            typeof self === "object" ? self :
                typeof this === "object" ? this :
                    Function("return this;")();
        var exporter = makeExporter(Reflect);
        if (typeof root.Reflect === "undefined") {
            root.Reflect = Reflect;
        }
        else {
            exporter = makeExporter(root.Reflect, exporter);
        }
        factory(exporter);
        function makeExporter(target, previous) {
            return function (key, value) {
                if (typeof target[key] !== "function") {
                    Object.defineProperty(target, key, { configurable: true, writable: true, value: value });
                }
                if (previous)
                    previous(key, value);
            };
        }
    })(function (exporter) {
        var hasOwn = Object.prototype.hasOwnProperty;
        // feature test for Symbol support
        var supportsSymbol = typeof Symbol === "function";
        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== "undefined" ? Symbol.toPrimitive : "@@toPrimitive";
        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== "undefined" ? Symbol.iterator : "@@iterator";
        var supportsCreate = typeof Object.create === "function"; // feature test for Object.create support
        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support
        var downLevel = !supportsCreate && !supportsProto;
        var HashMap = {
            // create an object in dictionary mode (a.k.a. "slow" mode in v8)
            create: supportsCreate
                ? function () { return MakeDictionary(Object.create(null)); }
                : supportsProto
                    ? function () { return MakeDictionary({ __proto__: null }); }
                    : function () { return MakeDictionary({}); },
            has: downLevel
                ? function (map, key) { return hasOwn.call(map, key); }
                : function (map, key) { return key in map; },
            get: downLevel
                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }
                : function (map, key) { return map[key]; },
        };
        // Load global or shim versions of Map, Set, and WeakMap
        var functionPrototype = Object.getPrototypeOf(Function);
        var usePolyfill = typeof process === "object" && process.env && process.env["REFLECT_METADATA_USE_MAP_POLYFILL"] === "true";
        var _Map = !usePolyfill && typeof Map === "function" && typeof Map.prototype.entries === "function" ? Map : CreateMapPolyfill();
        var _Set = !usePolyfill && typeof Set === "function" && typeof Set.prototype.entries === "function" ? Set : CreateSetPolyfill();
        var _WeakMap = !usePolyfill && typeof WeakMap === "function" ? WeakMap : CreateWeakMapPolyfill();
        // [[Metadata]] internal slot
        // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots
        var Metadata = new _WeakMap();
        /**
         * Applies a set of decorators to a property of a target object.
         * @param decorators An array of decorators.
         * @param target The target object.
         * @param propertyKey (Optional) The property key to decorate.
         * @param attributes (Optional) The property descriptor for the target key.
         * @remarks Decorators are applied in reverse order.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Example = Reflect.decorate(decoratorsArray, Example);
         *
         *     // property (on constructor)
         *     Reflect.decorate(decoratorsArray, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.decorate(decoratorsArray, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Object.defineProperty(Example, "staticMethod",
         *         Reflect.decorate(decoratorsArray, Example, "staticMethod",
         *             Object.getOwnPropertyDescriptor(Example, "staticMethod")));
         *
         *     // method (on prototype)
         *     Object.defineProperty(Example.prototype, "method",
         *         Reflect.decorate(decoratorsArray, Example.prototype, "method",
         *             Object.getOwnPropertyDescriptor(Example.prototype, "method")));
         *
         */
        function decorate(decorators, target, propertyKey, attributes) {
            if (!IsUndefined(propertyKey)) {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))
                    throw new TypeError();
                if (IsNull(attributes))
                    attributes = undefined;
                propertyKey = ToPropertyKey(propertyKey);
                return DecorateProperty(decorators, target, propertyKey, attributes);
            }
            else {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsConstructor(target))
                    throw new TypeError();
                return DecorateConstructor(decorators, target);
            }
        }
        exporter("decorate", decorate);
        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)
        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata
        /**
         * A default metadata decorator factory that can be used on a class, class member, or parameter.
         * @param metadataKey The key for the metadata entry.
         * @param metadataValue The value for the metadata entry.
         * @returns A decorator function.
         * @remarks
         * If `metadataKey` is already defined for the target and target key, the
         * metadataValue for that key will be overwritten.
         * @example
         *
         *     // constructor
         *     @Reflect.metadata(key, value)
         *     class Example {
         *     }
         *
         *     // property (on constructor, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticProperty;
         *     }
         *
         *     // property (on prototype, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         property;
         *     }
         *
         *     // method (on constructor)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticMethod() { }
         *     }
         *
         *     // method (on prototype)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         method() { }
         *     }
         *
         */
        function metadata(metadataKey, metadataValue) {
            function decorator(target, propertyKey) {
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))
                    throw new TypeError();
                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
            }
            return decorator;
        }
        exporter("metadata", metadata);
        /**
         * Define a unique metadata entry on the target.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param metadataValue A value that contains attached metadata.
         * @param target The target object on which to define metadata.
         * @param propertyKey (Optional) The property key for the target.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Reflect.defineMetadata("custom:annotation", options, Example);
         *
         *     // property (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticMethod");
         *
         *     // method (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "method");
         *
         *     // decorator factory as metadata-producing annotation.
         *     function MyAnnotation(options): Decorator {
         *         return (target, key?) => Reflect.defineMetadata("custom:annotation", options, target, key);
         *     }
         *
         */
        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
        }
        exporter("defineMetadata", defineMetadata);
        /**
         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasMetadata", hasMetadata);
        /**
         * Gets a value indicating whether the target object has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasOwnMetadata", hasOwnMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetMetadata(metadataKey, target, propertyKey);
        }
        exporter("getMetadata", getMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("getOwnMetadata", getOwnMetadata);
        /**
         * Gets the metadata keys defined on the target object or its prototype chain.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "method");
         *
         */
        function getMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryMetadataKeys(target, propertyKey);
        }
        exporter("getMetadataKeys", getMetadataKeys);
        /**
         * Gets the unique metadata keys defined on the target object.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "method");
         *
         */
        function getOwnMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryOwnMetadataKeys(target, propertyKey);
        }
        exporter("getOwnMetadataKeys", getOwnMetadataKeys);
        /**
         * Deletes the metadata entry from the target object with the provided key.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata entry was found and deleted; otherwise, false.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.deleteMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function deleteMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return false;
            if (!metadataMap.delete(metadataKey))
                return false;
            if (metadataMap.size > 0)
                return true;
            var targetMetadata = Metadata.get(target);
            targetMetadata.delete(propertyKey);
            if (targetMetadata.size > 0)
                return true;
            Metadata.delete(target);
            return true;
        }
        exporter("deleteMetadata", deleteMetadata);
        function DecorateConstructor(decorators, target) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsConstructor(decorated))
                        throw new TypeError();
                    target = decorated;
                }
            }
            return target;
        }
        function DecorateProperty(decorators, target, propertyKey, descriptor) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target, propertyKey, descriptor);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsObject(decorated))
                        throw new TypeError();
                    descriptor = decorated;
                }
            }
            return descriptor;
        }
        function GetOrCreateMetadataMap(O, P, Create) {
            var targetMetadata = Metadata.get(O);
            if (IsUndefined(targetMetadata)) {
                if (!Create)
                    return undefined;
                targetMetadata = new _Map();
                Metadata.set(O, targetMetadata);
            }
            var metadataMap = targetMetadata.get(P);
            if (IsUndefined(metadataMap)) {
                if (!Create)
                    return undefined;
                metadataMap = new _Map();
                targetMetadata.set(P, metadataMap);
            }
            return metadataMap;
        }
        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata
        function OrdinaryHasMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return true;
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryHasMetadata(MetadataKey, parent, P);
            return false;
        }
        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata
        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return false;
            return ToBoolean(metadataMap.has(MetadataKey));
        }
        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata
        function OrdinaryGetMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return OrdinaryGetOwnMetadata(MetadataKey, O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryGetMetadata(MetadataKey, parent, P);
            return undefined;
        }
        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata
        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return undefined;
            return metadataMap.get(MetadataKey);
        }
        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata
        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);
            metadataMap.set(MetadataKey, MetadataValue);
        }
        // 3.1.6.1 OrdinaryMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys
        function OrdinaryMetadataKeys(O, P) {
            var ownKeys = OrdinaryOwnMetadataKeys(O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (parent === null)
                return ownKeys;
            var parentKeys = OrdinaryMetadataKeys(parent, P);
            if (parentKeys.length <= 0)
                return ownKeys;
            if (ownKeys.length <= 0)
                return parentKeys;
            var set = new _Set();
            var keys = [];
            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {
                var key = ownKeys_1[_i];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {
                var key = parentKeys_1[_a];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            return keys;
        }
        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys
        function OrdinaryOwnMetadataKeys(O, P) {
            var keys = [];
            var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
            if (IsUndefined(metadataMap))
                return keys;
            var keysObj = metadataMap.keys();
            var iterator = GetIterator(keysObj);
            var k = 0;
            while (true) {
                var next = IteratorStep(iterator);
                if (!next) {
                    keys.length = k;
                    return keys;
                }
                var nextValue = IteratorValue(next);
                try {
                    keys[k] = nextValue;
                }
                catch (e) {
                    try {
                        IteratorClose(iterator);
                    }
                    finally {
                        throw e;
                    }
                }
                k++;
            }
        }
        // 6 ECMAScript Data Typ0es and Values
        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values
        function Type(x) {
            if (x === null)
                return 1 /* Null */;
            switch (typeof x) {
                case "undefined": return 0 /* Undefined */;
                case "boolean": return 2 /* Boolean */;
                case "string": return 3 /* String */;
                case "symbol": return 4 /* Symbol */;
                case "number": return 5 /* Number */;
                case "object": return x === null ? 1 /* Null */ : 6 /* Object */;
                default: return 6 /* Object */;
            }
        }
        // 6.1.1 The Undefined Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type
        function IsUndefined(x) {
            return x === undefined;
        }
        // 6.1.2 The Null Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type
        function IsNull(x) {
            return x === null;
        }
        // 6.1.5 The Symbol Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type
        function IsSymbol(x) {
            return typeof x === "symbol";
        }
        // 6.1.7 The Object Type
        // https://tc39.github.io/ecma262/#sec-object-type
        function IsObject(x) {
            return typeof x === "object" ? x !== null : typeof x === "function";
        }
        // 7.1 Type Conversion
        // https://tc39.github.io/ecma262/#sec-type-conversion
        // 7.1.1 ToPrimitive(input [, PreferredType])
        // https://tc39.github.io/ecma262/#sec-toprimitive
        function ToPrimitive(input, PreferredType) {
            switch (Type(input)) {
                case 0 /* Undefined */: return input;
                case 1 /* Null */: return input;
                case 2 /* Boolean */: return input;
                case 3 /* String */: return input;
                case 4 /* Symbol */: return input;
                case 5 /* Number */: return input;
            }
            var hint = PreferredType === 3 /* String */ ? "string" : PreferredType === 5 /* Number */ ? "number" : "default";
            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);
            if (exoticToPrim !== undefined) {
                var result = exoticToPrim.call(input, hint);
                if (IsObject(result))
                    throw new TypeError();
                return result;
            }
            return OrdinaryToPrimitive(input, hint === "default" ? "number" : hint);
        }
        // 7.1.1.1 OrdinaryToPrimitive(O, hint)
        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive
        function OrdinaryToPrimitive(O, hint) {
            if (hint === "string") {
                var toString_1 = O.toString;
                if (IsCallable(toString_1)) {
                    var result = toString_1.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            else {
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var toString_2 = O.toString;
                if (IsCallable(toString_2)) {
                    var result = toString_2.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            throw new TypeError();
        }
        // 7.1.2 ToBoolean(argument)
        // https://tc39.github.io/ecma262/2016/#sec-toboolean
        function ToBoolean(argument) {
            return !!argument;
        }
        // 7.1.12 ToString(argument)
        // https://tc39.github.io/ecma262/#sec-tostring
        function ToString(argument) {
            return "" + argument;
        }
        // 7.1.14 ToPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-topropertykey
        function ToPropertyKey(argument) {
            var key = ToPrimitive(argument, 3 /* String */);
            if (IsSymbol(key))
                return key;
            return ToString(key);
        }
        // 7.2 Testing and Comparison Operations
        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations
        // 7.2.2 IsArray(argument)
        // https://tc39.github.io/ecma262/#sec-isarray
        function IsArray(argument) {
            return Array.isArray
                ? Array.isArray(argument)
                : argument instanceof Object
                    ? argument instanceof Array
                    : Object.prototype.toString.call(argument) === "[object Array]";
        }
        // 7.2.3 IsCallable(argument)
        // https://tc39.github.io/ecma262/#sec-iscallable
        function IsCallable(argument) {
            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.
            return typeof argument === "function";
        }
        // 7.2.4 IsConstructor(argument)
        // https://tc39.github.io/ecma262/#sec-isconstructor
        function IsConstructor(argument) {
            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.
            return typeof argument === "function";
        }
        // 7.2.7 IsPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-ispropertykey
        function IsPropertyKey(argument) {
            switch (Type(argument)) {
                case 3 /* String */: return true;
                case 4 /* Symbol */: return true;
                default: return false;
            }
        }
        // 7.3 Operations on Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-objects
        // 7.3.9 GetMethod(V, P)
        // https://tc39.github.io/ecma262/#sec-getmethod
        function GetMethod(V, P) {
            var func = V[P];
            if (func === undefined || func === null)
                return undefined;
            if (!IsCallable(func))
                throw new TypeError();
            return func;
        }
        // 7.4 Operations on Iterator Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects
        function GetIterator(obj) {
            var method = GetMethod(obj, iteratorSymbol);
            if (!IsCallable(method))
                throw new TypeError(); // from Call
            var iterator = method.call(obj);
            if (!IsObject(iterator))
                throw new TypeError();
            return iterator;
        }
        // 7.4.4 IteratorValue(iterResult)
        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue
        function IteratorValue(iterResult) {
            return iterResult.value;
        }
        // 7.4.5 IteratorStep(iterator)
        // https://tc39.github.io/ecma262/#sec-iteratorstep
        function IteratorStep(iterator) {
            var result = iterator.next();
            return result.done ? false : result;
        }
        // 7.4.6 IteratorClose(iterator, completion)
        // https://tc39.github.io/ecma262/#sec-iteratorclose
        function IteratorClose(iterator) {
            var f = iterator["return"];
            if (f)
                f.call(iterator);
        }
        // 9.1 Ordinary Object Internal Methods and Internal Slots
        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots
        // 9.1.1.1 OrdinaryGetPrototypeOf(O)
        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof
        function OrdinaryGetPrototypeOf(O) {
            var proto = Object.getPrototypeOf(O);
            if (typeof O !== "function" || O === functionPrototype)
                return proto;
            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.
            // Try to determine the superclass constructor. Compatible implementations
            // must either set __proto__ on a subclass constructor to the superclass constructor,
            // or ensure each class has a valid `constructor` property on its prototype that
            // points back to the constructor.
            // If this is not the same as Function.[[Prototype]], then this is definately inherited.
            // This is the case when in ES6 or when using __proto__ in a compatible browser.
            if (proto !== functionPrototype)
                return proto;
            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.
            var prototype = O.prototype;
            var prototypeProto = prototype && Object.getPrototypeOf(prototype);
            if (prototypeProto == null || prototypeProto === Object.prototype)
                return proto;
            // If the constructor was not a function, then we cannot determine the heritage.
            var constructor = prototypeProto.constructor;
            if (typeof constructor !== "function")
                return proto;
            // If we have some kind of self-reference, then we cannot determine the heritage.
            if (constructor === O)
                return proto;
            // we have a pretty good guess at the heritage.
            return constructor;
        }
        // naive Map shim
        function CreateMapPolyfill() {
            var cacheSentinel = {};
            var arraySentinel = [];
            var MapIterator = (function () {
                function MapIterator(keys, values, selector) {
                    this._index = 0;
                    this._keys = keys;
                    this._values = values;
                    this._selector = selector;
                }
                MapIterator.prototype["@@iterator"] = function () { return this; };
                MapIterator.prototype[iteratorSymbol] = function () { return this; };
                MapIterator.prototype.next = function () {
                    var index = this._index;
                    if (index >= 0 && index < this._keys.length) {
                        var result = this._selector(this._keys[index], this._values[index]);
                        if (index + 1 >= this._keys.length) {
                            this._index = -1;
                            this._keys = arraySentinel;
                            this._values = arraySentinel;
                        }
                        else {
                            this._index++;
                        }
                        return { value: result, done: false };
                    }
                    return { value: undefined, done: true };
                };
                MapIterator.prototype.throw = function (error) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    throw error;
                };
                MapIterator.prototype.return = function (value) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    return { value: value, done: true };
                };
                return MapIterator;
            }());
            return (function () {
                function Map() {
                    this._keys = [];
                    this._values = [];
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                }
                Object.defineProperty(Map.prototype, "size", {
                    get: function () { return this._keys.length; },
                    enumerable: true,
                    configurable: true
                });
                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };
                Map.prototype.get = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    return index >= 0 ? this._values[index] : undefined;
                };
                Map.prototype.set = function (key, value) {
                    var index = this._find(key, /*insert*/ true);
                    this._values[index] = value;
                    return this;
                };
                Map.prototype.delete = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    if (index >= 0) {
                        var size = this._keys.length;
                        for (var i = index + 1; i < size; i++) {
                            this._keys[i - 1] = this._keys[i];
                            this._values[i - 1] = this._values[i];
                        }
                        this._keys.length--;
                        this._values.length--;
                        if (key === this._cacheKey) {
                            this._cacheKey = cacheSentinel;
                            this._cacheIndex = -2;
                        }
                        return true;
                    }
                    return false;
                };
                Map.prototype.clear = function () {
                    this._keys.length = 0;
                    this._values.length = 0;
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                };
                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };
                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };
                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };
                Map.prototype["@@iterator"] = function () { return this.entries(); };
                Map.prototype[iteratorSymbol] = function () { return this.entries(); };
                Map.prototype._find = function (key, insert) {
                    if (this._cacheKey !== key) {
                        this._cacheIndex = this._keys.indexOf(this._cacheKey = key);
                    }
                    if (this._cacheIndex < 0 && insert) {
                        this._cacheIndex = this._keys.length;
                        this._keys.push(key);
                        this._values.push(undefined);
                    }
                    return this._cacheIndex;
                };
                return Map;
            }());
            function getKey(key, _) {
                return key;
            }
            function getValue(_, value) {
                return value;
            }
            function getEntry(key, value) {
                return [key, value];
            }
        }
        // naive Set shim
        function CreateSetPolyfill() {
            return (function () {
                function Set() {
                    this._map = new _Map();
                }
                Object.defineProperty(Set.prototype, "size", {
                    get: function () { return this._map.size; },
                    enumerable: true,
                    configurable: true
                });
                Set.prototype.has = function (value) { return this._map.has(value); };
                Set.prototype.add = function (value) { return this._map.set(value, value), this; };
                Set.prototype.delete = function (value) { return this._map.delete(value); };
                Set.prototype.clear = function () { this._map.clear(); };
                Set.prototype.keys = function () { return this._map.keys(); };
                Set.prototype.values = function () { return this._map.values(); };
                Set.prototype.entries = function () { return this._map.entries(); };
                Set.prototype["@@iterator"] = function () { return this.keys(); };
                Set.prototype[iteratorSymbol] = function () { return this.keys(); };
                return Set;
            }());
        }
        // naive WeakMap shim
        function CreateWeakMapPolyfill() {
            var UUID_SIZE = 16;
            var keys = HashMap.create();
            var rootKey = CreateUniqueKey();
            return (function () {
                function WeakMap() {
                    this._key = CreateUniqueKey();
                }
                WeakMap.prototype.has = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.has(table, this._key) : false;
                };
                WeakMap.prototype.get = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.get(table, this._key) : undefined;
                };
                WeakMap.prototype.set = function (target, value) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);
                    table[this._key] = value;
                    return this;
                };
                WeakMap.prototype.delete = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? delete table[this._key] : false;
                };
                WeakMap.prototype.clear = function () {
                    // NOTE: not a real clear, just makes the previous data unreachable
                    this._key = CreateUniqueKey();
                };
                return WeakMap;
            }());
            function CreateUniqueKey() {
                var key;
                do
                    key = "@@WeakMap@@" + CreateUUID();
                while (HashMap.has(keys, key));
                keys[key] = true;
                return key;
            }
            function GetOrCreateWeakMapTable(target, create) {
                if (!hasOwn.call(target, rootKey)) {
                    if (!create)
                        return undefined;
                    Object.defineProperty(target, rootKey, { value: HashMap.create() });
                }
                return target[rootKey];
            }
            function FillRandomBytes(buffer, size) {
                for (var i = 0; i < size; ++i)
                    buffer[i] = Math.random() * 0xff | 0;
                return buffer;
            }
            function GenRandomBytes(size) {
                if (typeof Uint8Array === "function") {
                    if (typeof crypto !== "undefined")
                        return crypto.getRandomValues(new Uint8Array(size));
                    if (typeof msCrypto !== "undefined")
                        return msCrypto.getRandomValues(new Uint8Array(size));
                    return FillRandomBytes(new Uint8Array(size), size);
                }
                return FillRandomBytes(new Array(size), size);
            }
            function CreateUUID() {
                var data = GenRandomBytes(UUID_SIZE);
                // mark as random - RFC 4122 § 4.4
                data[6] = data[6] & 0x4f | 0x40;
                data[8] = data[8] & 0xbf | 0x80;
                var result = "";
                for (var offset = 0; offset < UUID_SIZE; ++offset) {
                    var byte = data[offset];
                    if (offset === 4 || offset === 6 || offset === 8)
                        result += "-";
                    if (byte < 16)
                        result += "0";
                    result += byte.toString(16).toLowerCase();
                }
                return result;
            }
        }
        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.
        function MakeDictionary(obj) {
            obj.__ = undefined;
            delete obj.__;
            return obj;
        }
    });
})(_Reflect || (_Reflect = {}));
// Hack for wx miniprogram
try
{
    if(Reflect !== _Reflect) rootage();
}
catch(err)
{
    rootage();
}

function rootage()
{
    var root = window || global;
    if(root) root.Reflect = _Reflect;
}
//# sourceMappingURL=Reflect.js.map
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(29), __webpack_require__(57)))

/***/ }),
/* 14 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "netManager", function() { return netManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_message_CoreMessage__ = __webpack_require__(32);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mask_MaskManager__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__NetMessage__ = __webpack_require__(64);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__RequestData__ = __webpack_require__(42);









var NetManager = /** @class */ (function () {
    function NetManager() {
        this._responseDict = {};
        this._responseListeners = new __WEBPACK_IMPORTED_MODULE_4__utils_Dictionary__["a" /* default */]();
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_3__core_message_CoreMessage__["a" /* default */].MESSAGE_DISPATCHED, this.onMsgDispatched, __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */]);
    }
    NetManager.prototype.onMsgDispatched = function (msg) {
        var observable = this.observable;
        // 如果消息是通讯消息则做处理
        if (msg instanceof __WEBPACK_IMPORTED_MODULE_8__RequestData__["default"]) {
            // 添加遮罩
            if (msg.__useMask)
                __WEBPACK_IMPORTED_MODULE_6__mask_MaskManager__["a" /* maskManager */].showLoading(null, "net");
            // 指定消息参数连接上公共参数作为参数
            Object(__WEBPACK_IMPORTED_MODULE_5__utils_ObjectUtil__["b" /* extendObject */])(msg.__params.data, __WEBPACK_IMPORTED_MODULE_8__RequestData__["commonData"]);
            // 发送消息
            msg.__policy.sendRequest(msg);
            // 派发系统消息
            observable.dispatch(__WEBPACK_IMPORTED_MODULE_7__NetMessage__["a" /* default */].NET_REQUEST, msg);
        }
    };
    /**
     * 注册一个返回结构体
     *
     * @param {IResponseDataConstructor} cls 返回结构体构造器
     * @memberof NetManager
     */
    NetManager.prototype.registerResponse = function (cls) {
        this._responseDict[cls.type] = cls;
    };
    /**
     * 添加一个通讯返回监听
     *
     * @param {(IResponseDataConstructor|string)} clsOrType 要监听的返回结构构造器或者类型字符串
     * @param {ResponseHandler} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.listenResponse = function (clsOrType, handler, thisArg, once, observable) {
        if (once === void 0) { once = false; }
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var cls = (typeof clsOrType == "string" ? this._responseDict[clsOrType] : clsOrType);
        var listeners = this._responseListeners.get(cls);
        if (!listeners)
            this._responseListeners.set(cls, listeners = []);
        for (var _i = 0, listeners_1 = listeners; _i < listeners_1.length; _i++) {
            var listener = listeners_1[_i];
            if (handler == listener[0] && thisArg == listener[1] && once == listener[2])
                return;
        }
        listeners.push([handler, thisArg, once, observable]);
    };
    /**
     * 移除一个通讯返回监听
     *
     * @param {(IResponseDataConstructor|string)} clsOrType 要移除监听的返回结构构造器或者类型字符串
     * @param {ResponseHandler} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.unlistenResponse = function (clsOrType, handler, thisArg, once, observable) {
        if (once === void 0) { once = false; }
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var cls = (typeof clsOrType == "string" ? this._responseDict[clsOrType] : clsOrType);
        var listeners = this._responseListeners.get(cls);
        if (listeners) {
            for (var i = 0, len = listeners.length; i < len; i++) {
                var listener = listeners[i];
                if (handler == listener[0] && thisArg == listener[1] && once == listener[2] && observable == listener[3]) {
                    listeners.splice(i, 1);
                    break;
                }
            }
        }
    };
    /**
     * 发送多条请求，并且等待返回结果（如果有的话），调用回调
     *
     * @param {RequestData[]} [requests] 要发送的请求列表
     * @param {(responses?:ResponseData[]|Error)=>void} [handler] 收到返回结果或错误后的回调函数
     * @param {*} [thisArg] this指向
     * @param {IObservable} [observable] 要发送到的内核
     * @memberof NetManager
     */
    NetManager.prototype.sendMultiRequests = function (requests, handler, thisArg, observable) {
        var self = this;
        var responses = [];
        var leftResCount = 0;
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        for (var _i = 0, _a = requests || []; _i < _a.length; _i++) {
            var request = _a[_i];
            var response = request.__params.response;
            if (response) {
                // 监听一次性返回
                this.listenResponse(response, onResponse, request);
                // 记录返回监听
                responses.push(response);
                // 记录数量
                leftResCount++;
            }
            // 发送请求
            observable.dispatch(request);
        }
        // 测试回调
        testCallback();
        function onResponse(response) {
            if (response instanceof Error) {
                // 出错了，直接调用回调
                handler && handler.call(thisArg, response);
            }
            else {
                // 成功了
                for (var key in responses) {
                    var temp = responses[key];
                    if (temp == response.constructor && this === response.__params.request) {
                        self.unlistenResponse(temp, onResponse, this);
                        responses[key] = response;
                        leftResCount--;
                        // 测试回调
                        testCallback();
                        break;
                    }
                }
            }
        }
        function testCallback() {
            // 判断是否全部替换完毕
            if (leftResCount <= 0) {
                handler && handler.call(thisArg, responses);
            }
        }
    };
    /**
     * 异步版本的sendMultiRequests
     *
     * @author Raykid
     * @date 2019-03-08
     * @param {RequestData[]} [requests] 要发送的请求列表
     * @param {IObservable} [observable] 要发送到的内核
     * @param {boolean} [canReject=false] 是否允许reject，默认false，即允许重试
     * @returns {Promise<ResponseData[]>} 返回一个Promise用于异步监听回调
     * @memberof NetManager
     */
    NetManager.prototype.sendMultiRequestsAsync = function (requests, observable, canReject) {
        var _this = this;
        if (canReject === void 0) { canReject = false; }
        return new Promise(function (resolve, reject) {
            _this.sendMultiRequests(requests, function (responses) {
                if (responses instanceof Error) {
                    // 错误
                    canReject && reject(responses);
                }
                else {
                    // 正确
                    resolve(responses);
                }
            }, _this, observable);
        });
    };
    /** 这里导出不希望用户使用的方法，供框架内使用 */
    NetManager.prototype.__onResponse = function (responseCls, result, request) {
        // 移除遮罩
        if (request && request.__useMask)
            __WEBPACK_IMPORTED_MODULE_6__mask_MaskManager__["a" /* maskManager */].hideLoading("net");
        // 解析结果
        if (responseCls) {
            var response = new responseCls();
            // 执行解析
            response.parse(result);
            // 设置配对请求和发送内核
            var observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
            if (request) {
                response.__params.request = request;
                // 由上至下找到最远的一个有效内核
                for (var i = request.__observables.length - 1; i >= 0; i--) {
                    var temp = request.__observables[i];
                    if (!temp || temp.disposed)
                        break;
                    else
                        observable = temp;
                }
            }
            // 派发事件
            observable.dispatch(__WEBPACK_IMPORTED_MODULE_7__NetMessage__["a" /* default */].NET_RESPONSE, response, request);
            // 递归处理事件监听
            this.recurseResponse(responseCls, response, request, observable);
        }
        else {
            console.warn("没有找到返回结构体定义：" + responseCls.type);
        }
    };
    NetManager.prototype.__onError = function (responseCls, err, request) {
        // 移除遮罩
        if (request && request.__useMask)
            __WEBPACK_IMPORTED_MODULE_6__mask_MaskManager__["a" /* maskManager */].hideLoading("net");
        // 如果有配对请求，则将返回值发送到请求所在的原始内核里
        var observable = request && request.__oriObservable;
        // 派发事件
        observable.dispatch(__WEBPACK_IMPORTED_MODULE_7__NetMessage__["a" /* default */].NET_ERROR, err, request);
        // 递归处理事件监听
        this.recurseResponse(responseCls, err, request, observable);
    };
    NetManager.prototype.recurseResponse = function (responseCls, response, request, observable) {
        // 先递归父级，与消息发送时顺序相反
        if (observable.parent) {
            this.recurseResponse(responseCls, response, request, observable.parent);
        }
        // 触发事件形式监听
        var listeners = this._responseListeners.get(responseCls);
        if (listeners) {
            listeners = listeners.concat();
            for (var _i = 0, listeners_2 = listeners; _i < listeners_2.length; _i++) {
                var listener = listeners_2[_i];
                if (listener[3] == observable) {
                    // 必须是同核消息才能触发回调
                    listener[0].call(listener[1], response, request);
                    // 如果是一次性监听则移除之
                    if (listener[2])
                        this.unlistenResponse(responseCls, listener[0], listener[1], listener[2], listener[3]);
                }
            }
        }
    };
    NetManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["e" /* __metadata */]("design:paramtypes", [])
    ], NetManager);
    return NetManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (NetManager);
/** 再额外导出一个单例 */
var netManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(NetManager);


/***/ }),
/* 15 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mediator_MediatorMessage__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__SceneManager__ = __webpack_require__(39);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 实现了IScene接口的场景中介者基类
*/
var SceneMediator = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](SceneMediator, _super);
    function SceneMediator(skin, policy) {
        var _this = _super.call(this, skin) || this;
        _this.policy = policy;
        return _this;
    }
    SceneMediator.prototype.__afterOnOpen = function (data) {
        __WEBPACK_IMPORTED_MODULE_3__SceneManager__["a" /* sceneManager */].push(this, data);
    };
    SceneMediator.prototype.__afterOnClose = function (data) {
        var _this = this;
        // 篡改onAfterOut，等待关闭动画结束后再执行
        var oriOnAfterOut = this.onAfterOut;
        this.onAfterOut = function (toScene, data) {
            oriOnAfterOut.call(_this, toScene, data);
            // 派发关闭事件
            _this.dispatch(__WEBPACK_IMPORTED_MODULE_2__mediator_MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, _this);
            // 调用销毁
            _this.dispose();
        };
        __WEBPACK_IMPORTED_MODULE_3__SceneManager__["a" /* sceneManager */].pop(this, data);
    };
    /**
     * 切入场景开始前调用
     * @param fromScene 从哪个场景切入
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onBeforeIn = function (fromScene, data) {
        // 可重写
    };
    /**
     * 切入场景开始后调用
     * @param fromScene 从哪个场景切入
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onAfterIn = function (fromScene, data) {
        // 可重写
    };
    /**
     * 切出场景开始前调用
     * @param toScene 要切入到哪个场景
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onBeforeOut = function (toScene, data) {
        // 可重写
    };
    /**
     * 切出场景开始后调用
     * @param toScene 要切入到哪个场景
     * @param data 切场景时可能的参数
     */
    SceneMediator.prototype.onAfterOut = function (toScene, data) {
        // 可重写
    };
    return SceneMediator;
}(__WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (SceneMediator);


/***/ }),
/* 16 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return maskManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__ = __webpack_require__(8);





/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * 遮罩管理器
*/
var MaskManager = /** @class */ (function () {
    function MaskManager() {
        this._entityDict = {};
        this._loadingMaskDict = {};
        this._isShowingMask = false;
        this._modalMaskDict = new __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__["a" /* default */]();
    }
    MaskManager.prototype.getLoadingMaskCount = function () {
        var count = 0;
        for (var key in this._loadingMaskDict) {
            var temp = this._loadingMaskDict[key];
            if (temp > 0)
                count += temp;
        }
        return count;
    };
    MaskManager.prototype.plusLoadingMaskCount = function (key) {
        var count = this._loadingMaskDict[key] || 0;
        if (count < 0)
            count = 0;
        this._loadingMaskDict[key] = ++count;
        return count;
    };
    MaskManager.prototype.minusLoadingMaskCount = function (key) {
        var count = this._loadingMaskDict[key] || 0;
        count--;
        if (count < 0)
            count = 0;
        this._loadingMaskDict[key] = count;
        if (count == 0)
            delete this._loadingMaskDict[key];
        return count;
    };
    /**
     * 初始化MaskUtil
     * @param type 所属表现层桥
     * @param entity 遮罩实体
     */
    MaskManager.prototype.registerMask = function (type, entity) {
        this._entityDict[type] = entity;
    };
    /**
     * 显示遮罩
     */
    MaskManager.prototype.showMask = function (alpha) {
        // 判断是否已经开启了
        if (this._isShowingMask)
            return;
        this._isShowingMask = true;
        // 每个已注册的表现层都显示遮罩
        for (var _i = 0, _a = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].bridges; _i < _a.length; _i++) {
            var bridge = _a[_i];
            var entity = this._entityDict[bridge.type];
            if (entity != null) {
                // 显示遮罩
                entity.showMask(alpha);
                // 调用回调
                entity.maskData.onShowMask && entity.maskData.onShowMask();
            }
        }
    };
    /**
     * 隐藏遮罩
     */
    MaskManager.prototype.hideMask = function () {
        // 判断是否已经开启了
        if (!this._isShowingMask)
            return;
        this._isShowingMask = false;
        // 每个已注册的表现层都移除遮罩
        for (var _i = 0, _a = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].bridges; _i < _a.length; _i++) {
            var bridge = _a[_i];
            var entity = this._entityDict[bridge.type];
            if (entity != null) {
                // 调用回调
                entity.maskData.onHideMask && entity.maskData.onHideMask();
                // 隐藏遮罩
                entity.hideMask();
            }
        }
    };
    /**当前是否在显示遮罩*/
    MaskManager.prototype.isShowingMask = function () {
        return this._isShowingMask;
    };
    /**
     * 显示加载图
     */
    MaskManager.prototype.showLoading = function (alpha, key) {
        if (key === void 0) { key = null; }
        // 若当前你没有loading则显示loading
        if (this.getLoadingMaskCount() == 0) {
            for (var _i = 0, _a = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].bridges; _i < _a.length; _i++) {
                var bridge = _a[_i];
                var entity = this._entityDict[bridge.type];
                if (entity != null) {
                    // 显示遮罩
                    entity.showLoading(alpha);
                    // 调用回调
                    entity.maskData.onShowLoading && entity.maskData.onShowLoading(entity.loadingSkin);
                }
            }
        }
        // 增计数
        this.plusLoadingMaskCount(key);
    };
    /**
     * 隐藏加载图
     */
    MaskManager.prototype.hideLoading = function (key) {
        if (key === void 0) { key = null; }
        // 减计数
        this.minusLoadingMaskCount(key);
        if (this.getLoadingMaskCount() == 0) {
            // 移除loading
            for (var _i = 0, _a = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].bridges; _i < _a.length; _i++) {
                var bridge = _a[_i];
                var entity = this._entityDict[bridge.type];
                if (entity != null) {
                    // 调用回调
                    entity.maskData.onHideLoading && entity.maskData.onHideLoading(entity.loadingSkin);
                    // 隐藏遮罩
                    entity.hideLoading();
                }
            }
        }
    };
    /**当前是否在显示loading*/
    MaskManager.prototype.isShowingLoading = function () {
        return (this.getLoadingMaskCount() > 0);
    };
    /** 显示模态窗口遮罩 */
    MaskManager.prototype.showModalMask = function (popup, alpha) {
        // 判断是否已经在打开了
        if (this.isShowingModalMask(popup))
            return;
        // 开启遮罩
        var bridge = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].getBridgeBySkin(popup.skin);
        if (bridge) {
            var entity = this._entityDict[bridge.type];
            if (entity != null) {
                // 记录
                this._modalMaskDict.set(popup, popup);
                // 显示遮罩
                entity.showModalMask(popup, alpha);
                // 调用回调
                entity.maskData.onShowModalMask && entity.maskData.onShowModalMask(popup);
            }
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskManager.prototype.hideModalMask = function (popup) {
        // 判断是否已经开启了
        if (!this.isShowingModalMask(popup))
            return;
        // 开始关闭遮罩
        var bridge = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].getBridgeBySkin(popup.skin);
        if (bridge) {
            var entity = this._entityDict[bridge.type];
            if (entity != null) {
                // 记录
                this._modalMaskDict.delete(popup);
                // 调用回调
                entity.maskData.onHideModalMask && entity.maskData.onHideModalMask(popup);
                // 隐藏遮罩
                entity.hideModalMask(popup);
            }
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskManager.prototype.isShowingModalMask = function (popup) {
        return (this._modalMaskDict.get(popup) != null);
    };
    MaskManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], MaskManager);
    return MaskManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (MaskManager);
/** 再额外导出一个单例 */
var maskManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(MaskManager);


/***/ }),
/* 17 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 模块消息
*/
var ModuleMessage = /** @class */ (function () {
    function ModuleMessage() {
    }
    /**
     * 切换模块消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_CHANGE = "moduleChange";
    /**
     * 切换模块失败消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_CHANGE_FAILED = "moduleChangeFailed";
    /**
     * 加载模块失败消息
     *
     * @static
     * @type {string}
     * @memberof ModuleMessage
     */
    ModuleMessage.MODULE_LOAD_ASSETS_ERROR = "moduleLoadAssetsError";
    return ModuleMessage;
}());
/* harmony default export */ __webpack_exports__["default"] = (ModuleMessage);


/***/ }),
/* 18 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-02-24
 * @modify date 2018-02-24
 *
 * 中介者状态枚举
*/
var MediatorStatus;
(function (MediatorStatus) {
    MediatorStatus[MediatorStatus["UNOPEN"] = 0] = "UNOPEN";
    MediatorStatus[MediatorStatus["OPENING"] = 1] = "OPENING";
    MediatorStatus[MediatorStatus["OPENED"] = 2] = "OPENED";
    MediatorStatus[MediatorStatus["CLOSING"] = 3] = "CLOSING";
    MediatorStatus[MediatorStatus["CLOSED"] = 4] = "CLOSED";
    MediatorStatus[MediatorStatus["DISPOSING"] = 5] = "DISPOSING";
    MediatorStatus[MediatorStatus["DISPOSED"] = 6] = "DISPOSED";
})(MediatorStatus || (MediatorStatus = {}));
/* harmony default export */ __webpack_exports__["a"] = (MediatorStatus);


/***/ }),
/* 19 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["DOMMediatorClass"] = DOMMediatorClass;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__ = __webpack_require__(9);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__DOMBridge__ = __webpack_require__(26);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * 负责注入的模块
*/
function DOMMediatorClass(moduleName, skin) {
    var skins = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        skins[_i - 2] = arguments[_i];
    }
    return function (cls) {
        // 调用MediatorClass方法
        cls = Object(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__["MediatorClass"])(moduleName)(cls);
        // 监听类型实例化，转换皮肤格式
        var finalSkin;
        if (skins.length === 0) {
            finalSkin = skin;
        }
        else {
            skins.unshift(skin);
            finalSkin = skins;
        }
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) {
            // 先赋值桥
            mediator.bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_3__DOMBridge__["default"].TYPE);
            // 然后监听onOpen，在onOpen中设置皮肤
            Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", function (mediator) {
                mediator.skin = finalSkin;
            });
        });
        // 返回结果类型
        return cls;
    };
}


/***/ }),
/* 20 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "decorateThis", function() { return decorateThis; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect__ = __webpack_require__(13);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__libs_Reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__libs_Reflect__);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 这个文件的存在是为了对现有js功能打补丁修bug等
*/
/** 修复Array.findIndex会被遍历到的问题 */
if (Array.prototype.hasOwnProperty("findIndex")) {
    var desc = Object.getOwnPropertyDescriptor(Array.prototype, "findIndex");
    if (desc.enumerable) {
        desc.enumerable = false;
        Object.defineProperty(Array.prototype, "findIndex", desc);
    }
}
/** 为某些不支持ErrorEvent的浏览器添加ErrorEvent支持 */
try {
    new ErrorEvent("");
}
catch (err) {
    window["ErrorEvent"] = function ErrorEvent(type, errorEventInitDict) {
        if (!errorEventInitDict)
            errorEventInitDict = {};
        if (Event instanceof Function) {
            Event.call(this, type, errorEventInitDict);
            this.initErrorEvent(type, errorEventInitDict.bubbles, errorEventInitDict.cancelable, errorEventInitDict.message, errorEventInitDict.filename, errorEventInitDict.lineno);
            this.error = errorEventInitDict.error;
            return this;
        }
        else {
            var evt = document.createEvent("ErrorEvent");
            evt.initErrorEvent(type, errorEventInitDict.bubbles, errorEventInitDict.cancelable, errorEventInitDict.message, errorEventInitDict.filename, errorEventInitDict.lineno);
            return evt;
        }
    };
    window["ErrorEvent"].prototype.initErrorEvent = function initErrorEvent(typeArg, canBubbleArg, cancelableArg, messageArg, filenameArg, linenoArg) {
        this.type = typeArg;
        this.bubbles = canBubbleArg;
        this.cancelable = cancelableArg;
        this.message = messageArg;
        this.filename = filenameArg;
        this.lineno = linenoArg;
    };
}
/** 篡改Reflect.decorate方法，用于为装饰器方法打个flag，标记装饰器是否为参数化装饰 */
var decorateThis = {};
if (Reflect && Reflect.decorate) {
    var oriDecorate = Reflect.decorate;
    Reflect.decorate = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // 篡改args[0][0]（装饰器方法引用），在调用时为其提供一个this指向，指向window
        var oriRef = args[0][0];
        args[0][0] = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return oriRef.apply(decorateThis, args);
        };
        // 调用原始方法
        var result = oriDecorate.apply(this, args);
        // 还原篡改项
        args[0][0] = oriRef;
        // 返回结果
        return result;
    };
}


/***/ }),
/* 21 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return version; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__ = __webpack_require__(12);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 管理文件哈希版本号
*/
var Version = /** @class */ (function () {
    function Version() {
        this._hashDict = {};
    }
    /**
     * 初始化哈希版本工具
     *
     * @param {()=>void} handler 回调
     * @param {string} [host] version.cfg文件加载域名，不传则使用当前域名
     * @param {string} [version] 加载version.cfg文件的版本号，不传则使用随机时间戳作为版本号
     * @memberof Version
     */
    Version.prototype.initialize = function (handler, host, version) {
        var self = this;
        if (window["__Olympus_Version_hashDict__"]) {
            // 之前在哪加载过，无需再次加载，直接使用
            this._hashDict = window["__Olympus_Version_hashDict__"];
            handler();
        }
        else {
            // 去加载version.cfg
            var request = null;
            if (window["XDomainRequest"] && navigator.userAgent.indexOf("MSIE 10.") < 0) {
                // code for IE7 - IE9
                request = new window["XDomainRequest"]();
            }
            else if (window["XMLHttpRequest"]) {
                // code for IE10, Firefox, Chrome, Opera, Safari
                request = new XMLHttpRequest();
            }
            else if (window["ActiveXObject"]) {
                // code for IE6, IE5
                request = new ActiveXObject("Microsoft.XMLHTTP");
            }
            // 注册回调函数
            request.onload = function (evt) {
                if (request.status === undefined) {
                    // 说明是不支持XMLHttpRequest的情况，查看其responseText是否为""
                    if (request.responseText === "") {
                        // 失败
                        request.onerror(new ErrorEvent("RequestError", { filename: url }));
                    }
                    else {
                        // 成功
                        onLoad(evt);
                        handler();
                    }
                }
                else {
                    // 即使是onLoad也要判断下状态码
                    var statusHead = Math.floor(request.status * 0.01);
                    switch (statusHead) {
                        case 2:
                        case 3:
                            // 2xx和3xx的状态码认为是成功
                            onLoad(evt);
                            handler();
                            break;
                        case 4:
                        case 5:
                            // 4xx和5xx的状态码认为是错误，转调错误回调
                            request.onerror(new ErrorEvent("RequestError", { filename: url, message: request.status + " " + request.statusText }));
                            break;
                    }
                }
            };
            var url;
            if (version) {
                request.onerror = function () {
                    // 使用-r_方式加载失败了，再试一次用query参数加载版本号
                    var url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg?v=" + version, host);
                    request.abort();
                    request.onerror = handler;
                    request.open("GET", url, true);
                    request.send();
                };
                // 设置连接信息
                url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg", host);
                // 添加-r_方式版本号
                url = this.joinVersion(url, version);
            }
            else {
                // 没有版本号，直接使用当前时间戳加载
                request.onerror = handler;
                url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["f" /* wrapAbsolutePath */])("version.cfg?v=" + Date.now(), host);
            }
            request.open("GET", url, true);
            // 发送数据，开始和服务器进行交互
            request.send();
        }
        function onLoad(evt) {
            var request = evt.target;
            var responseText = request.responseText;
            var lines = responseText.split("\n");
            for (var i in lines) {
                var line = lines[i];
                var arr = line.split("  ");
                if (arr.length == 2) {
                    var key = arr[1].substr(2);
                    var value = arr[0];
                    self._hashDict[key] = value;
                }
            }
            // 在window上挂一份
            window["__Olympus_Version_hashDict__"] = self._hashDict;
        }
    };
    /**
     * 获取文件哈希值，如果没有文件哈希值则返回null
     *
     * @param {string} url 文件的URL
     * @returns {string} 文件的哈希值，或者null
     * @memberof Version
     */
    Version.prototype.getHash = function (url) {
        url = Object(__WEBPACK_IMPORTED_MODULE_3__utils_URLUtil__["d" /* trimURL */])(url);
        var result = null;
        for (var path in this._hashDict) {
            if (url.indexOf(path) >= 0) {
                result = this._hashDict[path];
                break;
            }
        }
        return result;
    };
    /**
     * 将url转换为哈希版本url
     *
     * @param {string} url 原始url
     * @returns {string} 哈希版本url
     * @memberof Version
     */
    Version.prototype.wrapHashUrl = function (url) {
        var hash = this.getHash(url);
        if (hash != null) {
            url = this.joinVersion(url, hash);
        }
        return url;
    };
    /**
     * 添加-r_XXX形式版本号
     *
     * @param {string} url
     * @param {string} version 版本号，以数字和小写字母组成
     * @returns {string} 加版本号后的url，如果没有查到版本号则返回原始url
     * @memberof Version
     */
    Version.prototype.joinVersion = function (url, version) {
        if (version == null)
            return url;
        // 去掉version中的非法字符
        version = version.replace(/[^0-9a-z]+/ig, "");
        // 插入版本号
        var reg = /(([a-zA-Z]+:\/+[^\/\?#]+\/)?[^\?#]+)\.([^\?]+)(\?.+)?/;
        var result = reg.exec(url);
        if (result != null) {
            url = result[1] + "-r_" + version + "." + result[3] + (result[4] || "");
        }
        return url;
    };
    /**
     * 移除-r_XXX形式版本号
     *
     * @param {string} url url
     * @returns {string} 移除版本号后的url
     * @memberof Version
     */
    Version.prototype.removeVersion = function (url) {
        // 去掉-r_XXX版本号，如果有
        url = url.replace(/\-r_[a-z0-9]+\./ig, ".");
        return url;
    };
    Version = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Version);
    return Version;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Version);
/** 再额外导出一个单例 */
var version = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Version);


/***/ }),
/* 22 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return panelManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__ = __webpack_require__(16);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__IPromptPanel__ = __webpack_require__(59);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__NonePanelPolicy__ = __webpack_require__(60);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__PanelMessage__ = __webpack_require__(61);









/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 弹窗管理器，包含弹出弹窗、关闭弹窗、弹窗管理等功能
*/
var PanelManager = /** @class */ (function () {
    function PanelManager() {
        this._panels = [];
        this._priorities = new __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__["a" /* default */]();
        this._modalDict = new __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__["a" /* default */]();
        /************************ 下面是通用弹窗的逻辑 ************************/
        this._promptDict = {};
    }
    PanelManager_1 = PanelManager;
    /**
     * 获取当前显示的弹窗数组（副本）
     *
     * @param {IConstructor} [cls] 弹窗类型，如果传递该参数则只返回该类型的已打开弹窗，否则将返回所有已打开的弹窗
     * @returns {IPanel[]} 已打开弹窗数组
     * @memberof PanelManager
     */
    PanelManager.prototype.getOpened = function (cls) {
        if (!cls)
            return this._panels.concat();
        else
            return this._panels.filter(function (panel) { return panel.constructor == cls; });
    };
    /**
     * 获取弹窗是否已开启
     *
     * @param {IPanel} panel 弹窗对象
     * @returns {boolean} 是否已经开启
     * @memberof PanelManager
     */
    PanelManager.prototype.isOpened = function (panel) {
        return (this._panels.indexOf(panel) >= 0);
    };
    PanelManager.prototype.updateModalMask = function (panel) {
        // 首先将传入的panel的模态遮罩去除
        __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].hideModalMask(panel);
        // 然后为最上层的模态弹窗添加遮罩
        for (var i = this._panels.length - 1; i >= 0; i--) {
            panel = this._panels[i];
            if (this._modalDict.get(panel)) {
                // 如果已经有遮罩了，先移除之
                if (__WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].isShowingModalMask(panel))
                    __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].hideModalMask(panel);
                // 添加遮罩
                __WEBPACK_IMPORTED_MODULE_5__mask_MaskManager__["a" /* maskManager */].showModalMask(panel, panel.maskAlpha);
                break;
            }
        }
    };
    /**
     * 打开一个弹窗
     *
     * @param {IPanel} panel 要打开的弹窗
     * @param {*} [data] 数据
     * @param {boolean} [isModal=true] 是否模态弹出
     * @param {{x:number, y:number}} [from] 弹出起点位置
     * @returns {IPanel} 返回弹窗对象
     * @memberof PanelManager
     */
    PanelManager.prototype.pop = function (panel, data, isModal, from) {
        var _this = this;
        if (isModal === void 0) { isModal = true; }
        if (this._panels.indexOf(panel) < 0) {
            // 数据先行
            this._panels.push(panel);
            // 弹窗所在的表现层必须要显示
            panel.bridge.htmlWrapper.style.display = "";
            // 获取策略
            var policy = panel.policy || panel.bridge.defaultPanelPolicy || __WEBPACK_IMPORTED_MODULE_7__NonePanelPolicy__["a" /* default */];
            // 调用回调
            panel.onBeforePop(data, isModal, from);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__PanelMessage__["a" /* default */].PANEL_BEFORE_POP, panel, isModal, from);
            // 调用准备接口
            policy.prepare && policy.prepare(panel);
            // 添加显示
            var bridge = panel.bridge;
            bridge.addChild(panel.bridge.panelLayer, panel.skin);
            // 根据优先级进行排序
            this._panels.sort(function (a, b) {
                var priA = _this._priorities.get(a) || 0;
                var priB = _this._priorities.get(b) || 0;
                return priA - priB;
            });
            // 根据排序后的顺序调整显示顺序
            for (var _i = 0, _a = this._panels; _i < _a.length; _i++) {
                var temp = _a[_i];
                temp.bridge.addChild(temp.bridge.panelLayer, temp.skin);
            }
            // 调用策略接口
            policy.pop(panel, function () {
                // 调用回调
                panel.onAfterPop(data, isModal, from);
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__PanelMessage__["a" /* default */].PANEL_AFTER_POP, panel, isModal, from);
            }, from);
            // 记录模态数据
            this._modalDict.set(panel, isModal);
            // 更新模态遮罩
            this.updateModalMask(panel);
        }
        return panel;
    };
    /**
     * 关闭一个弹窗
     *
     * @param {IPanel} panel 要关闭的弹窗
     * @param {*} [data] 数据
     * @param {{x:number, y:number}} [to] 关闭终点位置
     * @returns {IPanel} 返回弹窗对象
     * @memberof PanelManager
     */
    PanelManager.prototype.drop = function (panel, data, to) {
        var index = this._panels.indexOf(panel);
        if (index >= 0) {
            // 数据先行
            this._panels.splice(index, 1);
            // 获取策略
            var policy = panel.policy || panel.bridge.defaultPanelPolicy || __WEBPACK_IMPORTED_MODULE_7__NonePanelPolicy__["a" /* default */];
            // 调用回调
            panel.onBeforeDrop(data, to);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__PanelMessage__["a" /* default */].PANEL_BEFORE_DROP, panel, to);
            // 调用策略接口
            policy.drop(panel, function () {
                // 调用回调
                panel.onAfterDrop(data, to);
                // 派发消息
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__PanelMessage__["a" /* default */].PANEL_AFTER_DROP, panel, to);
            }, to);
            // 移除优先级数据
            this._priorities.delete(panel);
            // 移除模态数据
            this._modalDict.delete(panel);
            // 更新模态遮罩
            this.updateModalMask(panel);
        }
        return panel;
    };
    /**
     * 注册通用弹窗
     *
     * @param {string} type 通用弹窗要注册到的表现层类型
     * @param {IPromptPanelConstructor} prompt 通用弹窗类型
     * @memberof PanelManager
     */
    PanelManager.prototype.registerPrompt = function (type, prompt) {
        this._promptDict[type] = prompt;
    };
    /**
     * 取消注册通用弹窗
     *
     * @param {string} type 要取消注册通用弹窗的表现层类型
     * @memberof PanelManager
     */
    PanelManager.prototype.unregisterPrompt = function (type) {
        delete this._promptDict[type];
    };
    /**
     * @private
     */
    PanelManager.prototype.prompt = function (msgOrParams) {
        var handlers = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            handlers[_i - 1] = arguments[_i];
        }
        var params;
        if (typeof msgOrParams == "string") {
            params = {
                msg: msgOrParams,
                handlers: handlers
            };
        }
        else {
            params = msgOrParams;
        }
        // 取到当前场景的类型
        var curBridge = __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].currentBridge;
        var type = curBridge && curBridge.type;
        // 用场景类型取到弹窗对象
        var promptCls = this._promptDict[type];
        if (promptCls == null) {
            // 没有找到当前模块类型关联的通用弹窗类型，改用系统弹窗凑合一下
            alert(params.msg);
            return;
        }
        // 增加默认值
        for (var i in params.handlers) {
            var handler = params.handlers[i];
            if (handler.text == null)
                handler.text = handler.data;
            if (handler.buttonType == null)
                handler.buttonType = __WEBPACK_IMPORTED_MODULE_6__IPromptPanel__["a" /* ButtonType */].normal;
        }
        // 实例化
        var prompt = new promptCls();
        // 设置优先级
        this._priorities.set(prompt, PanelManager_1.PRIORITY_PROMPT);
        // 显示弹窗
        prompt.open(params);
        // 更新弹窗
        prompt.update(params);
        // 返回弹窗
        return prompt;
    };
    /**
     * 显示警告窗口（只有一个确定按钮）
     *
     * @param {(string|IPromptParams)} msgOrParams 要显示的文本，或者弹窗数据
     * @param {()=>void} [okHandler] 确定按钮点击回调
     * @returns {IPromptPanel} 返回弹窗实体
     * @memberof PanelManager
     */
    PanelManager.prototype.alert = function (msgOrParams, okHandler) {
        var params;
        if (typeof msgOrParams == "string") {
            params = { msg: msgOrParams };
        }
        else {
            params = msgOrParams;
        }
        params.handlers = [
            { data: "确定", handler: okHandler, buttonType: __WEBPACK_IMPORTED_MODULE_6__IPromptPanel__["a" /* ButtonType */].important }
        ];
        return this.prompt(params);
    };
    /**
     * 显示确认窗口（有一个确定按钮和一个取消按钮）
     *
     * @param {(string|IPromptParams)} msgOrParams 要显示的文本，或者弹窗数据
     * @param {()=>void} [okHandler] 确定按钮点击回调
     * @param {()=>void} [cancelHandler] 取消按钮点击回调
     * @returns {IPromptPanel} 返回弹窗实体
     * @memberof PanelManager
     */
    PanelManager.prototype.confirm = function (msgOrParams, okHandler, cancelHandler) {
        var params;
        if (typeof msgOrParams == "string") {
            params = { msg: msgOrParams };
        }
        else {
            params = msgOrParams;
        }
        params.handlers = [
            { data: "取消", handler: cancelHandler, buttonType: __WEBPACK_IMPORTED_MODULE_6__IPromptPanel__["a" /* ButtonType */].normal },
            { data: "确定", handler: okHandler, buttonType: __WEBPACK_IMPORTED_MODULE_6__IPromptPanel__["a" /* ButtonType */].important }
        ];
        return this.prompt(params);
    };
    var PanelManager_1;
    PanelManager.PRIORITY_NORMAL = 0;
    PanelManager.PRIORITY_PROMPT = 1;
    PanelManager = PanelManager_1 = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], PanelManager);
    return PanelManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (PanelManager);
/** 再额外导出一个单例 */
var panelManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(PanelManager);


/***/ }),
/* 23 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = createRunFunc;
/* unused harmony export runExp */
/* harmony export (immutable) */ __webpack_exports__["a"] = createEvalFunc;
/* harmony export (immutable) */ __webpack_exports__["c"] = evalExp;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(4);

function wrapEvalFunc(exp) {
    // 这个方法的功能主要是将多个scope合并成为一个scope
    return function () {
        var scopes = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            scopes[_i] = arguments[_i];
        }
        var scope = __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["b" /* extendObject */].apply(void 0, [{}].concat(scopes.reverse()));
        return exp.call(this, scope);
    };
}
/**
 * 将表达式包装成为方法
 *
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} scopeCount 参数个数，仅在exp为表达式时有效
 * @returns {EvalFunc} 包装方法
 */
function wrapEvalFuncExp(exp, scopeCount) {
    if (typeof exp === "string") {
        var argList = [];
        var expStr = exp;
        for (var i = 0; i < scopeCount; i++) {
            argList.push("s" + i);
            expStr = "with(s" + i + "||{}){" + expStr + "}";
        }
        return Function(argList.join(","), expStr);
    }
    else {
        return wrapEvalFunc(exp);
    }
}
/**
 * 创建一个执行方法，用于未来执行
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} [scopeCount=0] 所需的域的数量
 * @returns {EvalFunc} 创建的方法
 */
function createRunFunc(exp, scopeCount) {
    if (scopeCount === void 0) { scopeCount = 0; }
    if (typeof exp === "string") {
        var func;
        try {
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        catch (err) {
            // 可能是某些版本的解释器不认识模板字符串，将模板字符串变成普通字符串
            var sepStr = (exp.indexOf('"') < 0 ? '"' : "'");
            // 将exp中的·替换为'
            var reg = /([^\\]?)`/g;
            exp = exp.replace(reg, "$1" + sepStr);
            // 将exp中${...}替换为" + ... + "的形式
            reg = /\$\{(.*?)\}/g;
            exp = exp.replace(reg, sepStr + "+($1)+" + sepStr);
            // 重新生成方法并返回
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        return func;
    }
    else {
        return wrapEvalFunc(exp);
    }
}
/**
 * 直接执行表达式，不求值。该方法可以执行多条语句
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {*} [thisArg] this指向
 * @param {...any[]} scopes 表达式的作用域列表
 */
function runExp(exp, thisArg) {
    var scopes = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        scopes[_i - 2] = arguments[_i];
    }
    createRunFunc(exp, scopes.length).apply(thisArg, scopes);
}
/**
 * 创建一个表达式求值方法，用于未来执行
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {number} [scopeCount=0] 所需的域的数量
 * @returns {EvalFunc} 创建的方法
 */
function createEvalFunc(exp, scopeCount) {
    if (scopeCount === void 0) { scopeCount = 0; }
    if (typeof exp === "string")
        return createRunFunc("return " + exp, scopeCount);
    else
        return wrapEvalFunc(exp);
}
/**
 * 表达式求值，无法执行多条语句
 *
 * @export
 * @param {(EvalExp)} exp 表达式或方法
 * @param {*} [thisArg] this指向
 * @param {...any[]} scopes 表达式的作用域列表
 * @returns {*} 返回值
 */
function evalExp(exp, thisArg) {
    var scopes = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        scopes[_i - 2] = arguments[_i];
    }
    return createEvalFunc(exp, scopes.length).apply(thisArg, scopes);
}


/***/ }),
/* 24 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return system; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 用来记录程序运行时间，并且提供延迟回调或频率回调功能
*/
var System = /** @class */ (function () {
    function System() {
        // 这里尝试一下TS的Tuple类型——Raykid
        this._nextFrameList = [];
        this._timer = 0;
        var self = this;
        if (window.requestAnimationFrame instanceof Function) {
            requestAnimationFrame(onRequestAnimationFrame);
        }
        else {
            // 如果不支持requestAnimationFrame则改用setTimeout计时，延迟时间1000/60毫秒
            var startTime = Date.now();
            setInterval(function () {
                var curTime = Date.now();
                // 赋值timer
                self._timer = curTime - startTime;
                // 调用tick方法
                self.tick();
            }, 1000 / 60);
        }
        function onRequestAnimationFrame(timer) {
            // 赋值timer，这个方法里无法获取this，因此需要通过注入的静态属性取到自身实例
            self._timer = timer;
            // 调用tick方法
            self.tick();
            // 计划下一次执行
            requestAnimationFrame(onRequestAnimationFrame);
        }
    }
    /**
     * 获取从程序运行到当前所经过的毫秒数
     *
     * @returns {number} 毫秒数
     * @memberof System
     */
    System.prototype.getTimer = function () {
        return this._timer;
    };
    System.prototype.tick = function () {
        // 调用下一帧回调
        for (var i = 0, len = this._nextFrameList.length; i < len; i++) {
            var data = this._nextFrameList.shift();
            data[0].apply(data[1], data[2]);
        }
    };
    /**
     * 在下一帧执行某个方法
     *
     * @param {Function} handler 希望在下一帧执行的某个方法
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 方法参数列表
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.nextFrame = function (handler, thisArg) {
        var _this = this;
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        var data = [handler, thisArg, args];
        this._nextFrameList.push(data);
        return {
            cancel: function () {
                var index = _this._nextFrameList.indexOf(data);
                if (index >= 0)
                    _this._nextFrameList.splice(index, 1);
            }
        };
    };
    /**
     * 每帧执行某个方法，直到取消为止
     *
     * @param {Function} handler 每帧执行的某个方法
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 方法参数列表
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.enterFrame = function (handler, thisArg) {
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        var self = this;
        var cancelable = this.nextFrame.apply(this, [onNextFrame, thisArg].concat(args));
        var canceled = false;
        return {
            cancel: function () {
                cancelable.cancel();
                canceled = true;
            }
        };
        function onNextFrame() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // 调用回调
            handler.apply(this, args);
            // 如果没被取消，则执行下一帧
            if (!canceled)
                cancelable = self.nextFrame.apply(self, [onNextFrame, this].concat(args));
        }
    };
    /**
     * 设置延迟回调
     *
     * @param {number} duration 延迟毫秒值
     * @param {Function} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 要传递的参数
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.setTimeout = function (duration, handler, thisArg) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var startTimer = this._timer;
        // 启动计时器
        var nextFrame = this.nextFrame(tick, this);
        function tick() {
            var delta = this._timer - startTimer;
            if (delta >= duration) {
                nextFrame = null;
                handler.apply(thisArg, args);
            }
            else {
                nextFrame = this.nextFrame(tick, this);
            }
        }
        return {
            cancel: function () {
                nextFrame && nextFrame.cancel();
                nextFrame = null;
            }
        };
    };
    /**
     * 设置延时间隔
     *
     * @param {number} duration 延迟毫秒值
     * @param {Function} handler 回调函数
     * @param {*} [thisArg] this指向
     * @param {...any[]} args 要传递的参数
     * @returns {ICancelable} 可取消的句柄
     * @memberof System
     */
    System.prototype.setInterval = function (duration, handler, thisArg) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var timeout = this.setTimeout(duration, onTimeout, this);
        var canceled = false;
        return {
            cancel: function () {
                timeout && timeout.cancel();
                timeout = null;
                canceled = true;
            }
        };
        function onTimeout() {
            // 触发回调
            handler.apply(thisArg, args);
            // 继续下一次
            if (!canceled)
                timeout = this.setTimeout(duration, onTimeout, this);
        }
    };
    System = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["e" /* __metadata */]("design:paramtypes", [])
    ], System);
    return System;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (System);
/** 再额外导出一个单例 */
var system = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(System);


/***/ }),
/* 25 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-03-05
 * @modify date 2018-03-05
 *
 * 中介者消息
*/
var MediatorMessage = /** @class */ (function () {
    function MediatorMessage() {
    }
    /**
     * 中介者开启完毕事件
     *
     * @static
     * @type {string}
     * @memberof MediatorMessage
     */
    MediatorMessage.MEDIATOR_OPENED = "mediatorOpened";
    /**
     * 中介者关闭完毕事件
     *
     * @static
     * @type {string}
     * @memberof MediatorMessage
     */
    MediatorMessage.MEDIATOR_CLOSED = "mediatorClosed";
    return MediatorMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (MediatorMessage);


/***/ }),
/* 26 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__dom_mask_MaskEntity__ = __webpack_require__(69);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__ = __webpack_require__(70);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__dom_panel_BackPanelPolicy__ = __webpack_require__(71);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__dom_scene_FadeScenePolicy__ = __webpack_require__(72);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__);
/// <amd-module name="DOMBridge"/>
/// <reference types="tween.js"/>








/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 基于DOM的表现层桥实现
*/
var DOMBridge = /** @class */ (function () {
    function DOMBridge(params) {
        /**
         * 获取默认弹窗策略
         *
         * @type {IPanelPolicy}
         * @memberof DOMBridge
         */
        this.defaultPanelPolicy = new __WEBPACK_IMPORTED_MODULE_5__dom_panel_BackPanelPolicy__["a" /* default */]();
        /**
         * 获取默认场景切换策略
         *
         * @type {IScenePolicy}
         * @memberof DOMBridge
         */
        this.defaultScenePolicy = new __WEBPACK_IMPORTED_MODULE_6__dom_scene_FadeScenePolicy__["a" /* default */]();
        this._listenerDict = {};
        this._initParams = params;
    }
    Object.defineProperty(DOMBridge.prototype, "type", {
        /**
         * 获取表现层类型名称
         *
         * @readonly
         * @type {string}
         * @memberof DOMBridge
         */
        get: function () {
            return DOMBridge.TYPE;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "htmlWrapper", {
        /**
         * 获取表现层HTML包装器，可以对其样式进行自定义调整
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "root", {
        /**
         * 获取根显示节点
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "stage", {
        /**
         * 获取舞台引用，DOM的舞台指向根节点
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "bgLayer", {
        /**
         * 获取背景容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._bgLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "sceneLayer", {
        /**
         * 获取场景容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._sceneLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "frameLayer", {
        /**
         * 获取框架容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._frameLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "panelLayer", {
        /**
         * 获取弹窗容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._panelLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "maskLayer", {
        /**
         * 获取遮罩容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._maskLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "topLayer", {
        /**
         * 获取顶级容器
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof DOMBridge
         */
        get: function () {
            return this._topLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "promptClass", {
        /**
         * 获取通用提示框
         *
         * @readonly
         * @type {IPromptPanelConstructor}
         * @memberof DOMBridge
         */
        get: function () {
            return this._initParams.promptClass;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DOMBridge.prototype, "maskEntity", {
        /**
         * 获取遮罩实体
         *
         * @readonly
         * @type {IMaskEntity}
         * @memberof DOMBridge
         */
        get: function () {
            return new __WEBPACK_IMPORTED_MODULE_3__dom_mask_MaskEntity__["a" /* default */](this._initParams.maskData);
        },
        enumerable: true,
        configurable: true
    });
    DOMBridge.prototype.createLayer = function () {
        // 生成一个父容器，不响应点击事件，但会撑起全屏幕范围
        var layer = document.createElement("div");
        layer.style.position = "fixed";
        layer.style.top = "0%";
        layer.style.left = "0%";
        layer.style.width = "100%";
        layer.style.height = "100%";
        layer.style.pointerEvents = "none";
        this.root.appendChild(layer);
        // 生成一个子容器，实际用来放置子对象，目的是响应点击事件
        var subLayer = document.createElement("div");
        subLayer.style.pointerEvents = "auto";
        layer.appendChild(subLayer);
        // 返回子容器
        return subLayer;
    };
    /**
     * 初始化表现层桥，可以没有该方法，没有该方法则表示该表现层无需初始化
     * @param {()=>void} complete 初始化完毕后的回调
     * @memberof DOMBridge
     */
    DOMBridge.prototype.init = function (complete) {
        // 如果是名称，则转变成引用
        if (typeof this._initParams.container == "string") {
            this._initParams.container = document.querySelector(this._initParams.container);
        }
        // 如果是空，则生成一个
        if (!this._initParams.container) {
            this._initParams.container = document.createElement("div");
            document.body.appendChild(this._initParams.container);
        }
        // 创建背景显示层
        this._bgLayer = this.createLayer();
        // 创建场景显示层
        this._sceneLayer = this.createLayer();
        // 创建框架显示层
        this._frameLayer = this.createLayer();
        // 创建弹出层
        this._panelLayer = this.createLayer();
        // 创建遮罩层
        this._maskLayer = this.createLayer();
        // 创建顶级显示层
        this._topLayer = this.createLayer();
        // 添加Tween.js驱动
        __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__["a" /* system */].enterFrame(function () {
            // 每次使用最新的当前运行毫秒数更新Tween.js
            __WEBPACK_IMPORTED_MODULE_7__tweenjs_tween_js__["update"](__WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_system_System__["a" /* system */].getTimer());
        });
        // 调用回调
        complete(this);
    };
    /**
     * 判断皮肤是否是DOM显示节点
     *
     * @param {HTMLElement|string|string[]} skin 皮肤对象
     * @returns {boolean} 是否是DOM显示节点
     * @memberof DOMBridge
     */
    DOMBridge.prototype.isMySkin = function (skin) {
        if (skin instanceof HTMLElement)
            return true;
        if (typeof skin === "string" && (Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["b" /* isDOMPath */])(skin) || Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["c" /* isDOMStr */])(skin)))
            return true;
        if (skin instanceof Array) {
            // 数组里每一个元素都必须是皮肤
            var result = true;
            for (var _i = 0, skin_1 = skin; _i < skin_1.length; _i++) {
                var temp = skin_1[_i];
                if (!(typeof temp === "string" && (Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["b" /* isDOMPath */])(temp) || Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["c" /* isDOMStr */])(temp)))) {
                    result = false;
                    break;
                }
            }
            return result;
        }
        return false;
    };
    /**
     * 包装HTMLElement节点
     *
     * @param {IMediator} mediator 中介者
     * @param {HTMLElement|string|string[]} skin 原始HTMLElement节点
     * @returns {HTMLElement} 包装后的HTMLElement节点
     * @memberof DOMBridge
     */
    DOMBridge.prototype.wrapSkin = function (mediator, skin) {
        return Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["e" /* wrapSkin */])(mediator, skin);
    };
    /**
     * 替换皮肤，用于组件变身时不同表现层桥的处理
     *
     * @param {IMediator} mediator 中介者
     * @param {*} current 当前皮肤
     * @param {HTMLElement|string|string[]} target 要替换的皮肤
     * @returns {*} 替换完毕的皮肤
     * @memberof DOMBridge
     */
    DOMBridge.prototype.replaceSkin = function (mediator, current, target) {
        target = Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["d" /* toHTMLElement */])(target);
        // 如果有父节点，则用目标节点替换当前节点位置
        var parent = current.parentElement;
        if (parent) {
            parent.insertBefore(target, current);
            parent.removeChild(current);
        }
        // 重新包装节点
        this.wrapSkin(mediator, target);
        // 返回皮肤
        return target;
    };
    /**
     * 同步皮肤，用于组件变身后的重新定位
     *
     * @param {HTMLElement} current 当前皮肤
     * @param {HTMLElement} target 替换的皮肤
     * @memberof DOMBridge
     */
    DOMBridge.prototype.syncSkin = function (current, target) {
        if (!current || !target)
            return;
        // DOM无需特意同步，因为其样式都可以以css样式方式在外部表示，而仅有当前节点的style属性是需要同步的
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["b" /* extendObject */])(target.style, current.style);
    };
    /**
     * 创建一个空的显示对象
     *
     * @returns {HTMLElement}
     * @memberof DOMBridge
     */
    DOMBridge.prototype.createEmptyDisplay = function () {
        return document.createElement("div");
    };
    /**
     * 添加显示
     *
     * @param {Element} parent 要添加到的父容器
     * @param {Element} target 被添加的显示对象
     * @return {Element} 返回被添加的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.addChild = function (parent, target) {
        return parent.appendChild(target);
    };
    /**
     * 按索引添加显示
     *
     * @param {Element} parent 要添加到的父容器
     * @param {Element} target 被添加的显示对象
     * @param {number} index 要添加到的父级索引
     * @return {Element} 返回被添加的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.addChildAt = function (parent, target, index) {
        return parent.insertBefore(target, this.getChildAt(parent, index));
    };
    /**
     * 移除显示对象
     *
     * @param {Element} parent 父容器
     * @param {Element} target 被移除的显示对象
     * @return {Element} 返回被移除的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChild = function (parent, target) {
        if (parent && target && target.parentElement === parent)
            return parent.removeChild(target);
        else
            return target;
    };
    /**
     * 按索引移除显示
     *
     * @param {Element} parent 父容器
     * @param {number} index 索引
     * @return {Element} 返回被移除的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChildAt = function (parent, index) {
        return this.removeChild(parent, this.getChildAt(parent, index));
    };
    /**
     * 移除所有显示对象
     *
     * @param {Element} parent 父容器
     * @memberof DOMBridge
     */
    DOMBridge.prototype.removeChildren = function (parent) {
        for (var i = 0, len = parent.children.length; i < len; i++) {
            parent.removeChild(parent.children.item(i));
        }
    };
    /**
     * 获取父容器
     *
     * @param {Element} target 目标对象
     * @returns {Element} 父容器
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getParent = function (target) {
        return target.parentElement;
    };
    /**
     * 获取指定索引处的显示对象
     *
     * @param {Element} parent 父容器
     * @param {number} index 指定父级索引
     * @return {Element} 索引处的显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildAt = function (parent, index) {
        return parent.children.item(index);
    };
    /**
     * 获取显示索引
     *
     * @param {Element} parent 父容器
     * @param {Element} target 子显示对象
     * @return {number} target在parent中的索引
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildIndex = function (parent, target) {
        for (var i = 0, len = parent.children.length; i < len; i++) {
            if (target === parent.children.item(i))
                return i;
        }
        return -1;
    };
    /**
     * 通过名称获取显示对象
     *
     * @param {Element} parent 父容器
     * @param {string} name 对象名称
     * @return {Element} 显示对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildByName = function (parent, name) {
        return parent.children.namedItem(name);
    };
    /**
     * 获取子显示对象数量
     *
     * @param {Element} parent 父容器
     * @return {number} 子显示对象数量
     * @memberof DOMBridge
     */
    DOMBridge.prototype.getChildCount = function (parent) {
        return parent.childElementCount;
    };
    /**
     * 加载资源
     *
     * @param {string[]} assets 资源数组
     * @param {IMediator} mediator 资源列表
     * @param {(err?:Error)=>void} handler 回调函数
     * @memberof DOMBridge
     */
    DOMBridge.prototype.loadAssets = function (assets, mediator, handler) {
        // 开始加载皮肤列表
        if (assets)
            assets = assets.concat();
        loadNext();
        function loadNext() {
            if (!assets || assets.length <= 0) {
                // 调用回调
                handler();
            }
            else {
                var skin = assets.shift();
                __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_assets_AssetsManager__["a" /* assetsManager */].loadAssets(skin, function (result) {
                    if (result instanceof Error)
                        handler(result);
                    else
                        loadNext();
                });
            }
        }
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {EventTarget} target 事件目标对象
     * @param {string} type 事件类型
     * @param {(evt:Event)=>void} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.mapListener = function (target, type, handler, thisArg) {
        var key = Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["f" /* getObjectHashs */])(target, type, handler, thisArg);
        // 判断是否已经存在该监听，如果存在则不再监听
        if (this._listenerDict[key])
            return;
        // 监听
        var listener = function (evt) {
            // 调用回调
            handler.call(thisArg || this, evt);
        };
        target.addEventListener(type, listener);
        // 记录监听
        this._listenerDict[key] = listener;
    };
    /**
     * 注销监听事件
     *
     * @param {EventTarget} target 事件目标对象
     * @param {string} type 事件类型
     * @param {(evt:Event)=>void} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof DOMBridge
     */
    DOMBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
        var key = Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ObjectUtil__["f" /* getObjectHashs */])(target, type, handler, thisArg);
        // 判断是否已经存在该监听，如果存在则移除监听
        var listener = this._listenerDict[key];
        if (listener) {
            target.removeEventListener(type, listener);
            // 移除记录
            delete this._listenerDict[key];
        }
    };
    /**
     * 为绑定的列表显示对象包装一个渲染器创建回调
     *
     * @param {HTMLElement} target BindFor指令指向的显示对象
     * @param {(key?:any, value?:any, renderer?:HTMLElement)=>void} handler 渲染器创建回调
     * @returns {*} 返回一个备忘录对象，会在赋值时提供
     * @memberof IBridge
     */
    DOMBridge.prototype.wrapBindFor = function (target, handler) {
        var parent = target.parentElement;
        // 生成一个from节点和一个to节点，用来占位
        var from = document.createElement("div");
        var to = document.createElement("div");
        parent && parent.insertBefore(from, target);
        parent && parent.insertBefore(to, target);
        // 移除显示
        parent && parent.removeChild(target);
        // 返回备忘录
        return { parent: parent, from: from, to: to, handler: handler };
    };
    /**
     * 为列表显示对象赋值
     *
     * @param {HTMLElement} target BindFor指令指向的显示对象
     * @param {*} datas 数据集合
     * @param {*} memento wrapBindFor返回的备忘录对象
     * @memberof IBridge
     */
    DOMBridge.prototype.valuateBindFor = function (target, datas, memento) {
        // 移除已有的列表项显示
        var parent = memento.parent;
        if (parent) {
            var fromIndex = this.getChildIndex(parent, memento.from);
            var toIndex = this.getChildIndex(parent, memento.to);
            for (var i = fromIndex + 1; i < toIndex; i++) {
                this.removeChildAt(parent, fromIndex + 1);
            }
        }
        // 添加新的渲染器
        for (var key in datas) {
            var newElement = target.cloneNode(true);
            // 拷贝子孙对象引用
            Object(__WEBPACK_IMPORTED_MODULE_4__dom_utils_SkinUtil__["a" /* copyRef */])(newElement, newElement);
            // 添加显示
            parent && parent.insertBefore(newElement, memento.to);
            // 使用cloneNode方法复制渲染器
            memento.handler(key, datas[key], newElement);
        }
    };
    /** 提供静态类型常量 */
    DOMBridge.TYPE = "DOM";
    return DOMBridge;
}());
/* harmony default export */ __webpack_exports__["default"] = (DOMBridge);


/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(process) {var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
 * Tween.js - Licensed under the MIT license
 * https://github.com/tweenjs/tween.js
 * ----------------------------------------------
 *
 * See https://github.com/tweenjs/tween.js/graphs/contributors for the full list of contributors.
 * Thank you all, you're awesome!
 */


var _Group = function () {
	this._tweens = {};
	this._tweensAddedDuringUpdate = {};
};

_Group.prototype = {
	getAll: function () {

		return Object.keys(this._tweens).map(function (tweenId) {
			return this._tweens[tweenId];
		}.bind(this));

	},

	removeAll: function () {

		this._tweens = {};

	},

	add: function (tween) {

		this._tweens[tween.getId()] = tween;
		this._tweensAddedDuringUpdate[tween.getId()] = tween;

	},

	remove: function (tween) {

		delete this._tweens[tween.getId()];
		delete this._tweensAddedDuringUpdate[tween.getId()];

	},

	update: function (time, preserve) {

		var tweenIds = Object.keys(this._tweens);

		if (tweenIds.length === 0) {
			return false;
		}

		time = time !== undefined ? time : TWEEN.now();

		// Tweens are updated in "batches". If you add a new tween during an update, then the
		// new tween will be updated in the next batch.
		// If you remove a tween during an update, it may or may not be updated. However,
		// if the removed tween was added during the current batch, then it will not be updated.
		while (tweenIds.length > 0) {
			this._tweensAddedDuringUpdate = {};

			for (var i = 0; i < tweenIds.length; i++) {

				var tween = this._tweens[tweenIds[i]];

				if (tween && tween.update(time) === false) {
					tween._isPlaying = false;

					if (!preserve) {
						delete this._tweens[tweenIds[i]];
					}
				}
			}

			tweenIds = Object.keys(this._tweensAddedDuringUpdate);
		}

		return true;

	}
};

var TWEEN = new _Group();

TWEEN.Group = _Group;
TWEEN._nextId = 0;
TWEEN.nextId = function () {
	return TWEEN._nextId++;
};


// Include a performance.now polyfill.
// In node.js, use process.hrtime.
if (typeof (window) === 'undefined' && typeof (process) !== 'undefined') {
	TWEEN.now = function () {
		var time = process.hrtime();

		// Convert [seconds, nanoseconds] to milliseconds.
		return time[0] * 1000 + time[1] / 1000000;
	};
}
// In a browser, use window.performance.now if it is available.
else if (typeof (window) !== 'undefined' &&
         window.performance !== undefined &&
		 window.performance.now !== undefined) {
	// This must be bound, because directly assigning this function
	// leads to an invocation exception in Chrome.
	TWEEN.now = window.performance.now.bind(window.performance);
}
// Use Date.now if it is available.
else if (Date.now !== undefined) {
	TWEEN.now = Date.now;
}
// Otherwise, use 'new Date().getTime()'.
else {
	TWEEN.now = function () {
		return new Date().getTime();
	};
}


TWEEN.Tween = function (object, group) {
	this._object = object;
	this._valuesStart = {};
	this._valuesEnd = {};
	this._valuesStartRepeat = {};
	this._duration = 1000;
	this._repeat = 0;
	this._repeatDelayTime = undefined;
	this._yoyo = false;
	this._isPlaying = false;
	this._reversed = false;
	this._delayTime = 0;
	this._startTime = null;
	this._easingFunction = TWEEN.Easing.Linear.None;
	this._interpolationFunction = TWEEN.Interpolation.Linear;
	this._chainedTweens = [];
	this._onStartCallback = null;
	this._onStartCallbackFired = false;
	this._onUpdateCallback = null;
	this._onCompleteCallback = null;
	this._onStopCallback = null;
	this._group = group || TWEEN;
	this._id = TWEEN.nextId();

};

TWEEN.Tween.prototype = {
	getId: function getId() {
		return this._id;
	},

	isPlaying: function isPlaying() {
		return this._isPlaying;
	},

	to: function to(properties, duration) {

		this._valuesEnd = properties;

		if (duration !== undefined) {
			this._duration = duration;
		}

		return this;

	},

	start: function start(time) {

		this._group.add(this);

		this._isPlaying = true;

		this._onStartCallbackFired = false;

		this._startTime = time !== undefined ? typeof time === 'string' ? TWEEN.now() + parseFloat(time) : time : TWEEN.now();
		this._startTime += this._delayTime;

		for (var property in this._valuesEnd) {

			// Check if an Array was provided as property value
			if (this._valuesEnd[property] instanceof Array) {

				if (this._valuesEnd[property].length === 0) {
					continue;
				}

				// Create a local copy of the Array with the start value at the front
				this._valuesEnd[property] = [this._object[property]].concat(this._valuesEnd[property]);

			}

			// If `to()` specifies a property that doesn't exist in the source object,
			// we should not set that property in the object
			if (this._object[property] === undefined) {
				continue;
			}

			// Save the starting value.
			this._valuesStart[property] = this._object[property];

			if ((this._valuesStart[property] instanceof Array) === false) {
				this._valuesStart[property] *= 1.0; // Ensures we're using numbers, not strings
			}

			this._valuesStartRepeat[property] = this._valuesStart[property] || 0;

		}

		return this;

	},

	stop: function stop() {

		if (!this._isPlaying) {
			return this;
		}

		this._group.remove(this);
		this._isPlaying = false;

		if (this._onStopCallback !== null) {
			this._onStopCallback(this._object);
		}

		this.stopChainedTweens();
		return this;

	},

	end: function end() {

		this.update(this._startTime + this._duration);
		return this;

	},

	stopChainedTweens: function stopChainedTweens() {

		for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {
			this._chainedTweens[i].stop();
		}

	},

	group: function group(group) {
		this._group = group;
		return this;
	},

	delay: function delay(amount) {

		this._delayTime = amount;
		return this;

	},

	repeat: function repeat(times) {

		this._repeat = times;
		return this;

	},

	repeatDelay: function repeatDelay(amount) {

		this._repeatDelayTime = amount;
		return this;

	},

	yoyo: function yoyo(yy) {

		this._yoyo = yy;
		return this;

	},

	easing: function easing(eas) {

		this._easingFunction = eas;
		return this;

	},

	interpolation: function interpolation(inter) {

		this._interpolationFunction = inter;
		return this;

	},

	chain: function chain() {

		this._chainedTweens = arguments;
		return this;

	},

	onStart: function onStart(callback) {

		this._onStartCallback = callback;
		return this;

	},

	onUpdate: function onUpdate(callback) {

		this._onUpdateCallback = callback;
		return this;

	},

	onComplete: function onComplete(callback) {

		this._onCompleteCallback = callback;
		return this;

	},

	onStop: function onStop(callback) {

		this._onStopCallback = callback;
		return this;

	},

	update: function update(time) {

		var property;
		var elapsed;
		var value;

		if (time < this._startTime) {
			return true;
		}

		if (this._onStartCallbackFired === false) {

			if (this._onStartCallback !== null) {
				this._onStartCallback(this._object);
			}

			this._onStartCallbackFired = true;
		}

		elapsed = (time - this._startTime) / this._duration;
		elapsed = (this._duration === 0 || elapsed > 1) ? 1 : elapsed;

		value = this._easingFunction(elapsed);

		for (property in this._valuesEnd) {

			// Don't update properties that do not exist in the source object
			if (this._valuesStart[property] === undefined) {
				continue;
			}

			var start = this._valuesStart[property] || 0;
			var end = this._valuesEnd[property];

			if (end instanceof Array) {

				this._object[property] = this._interpolationFunction(end, value);

			} else {

				// Parses relative end values with start as base (e.g.: +10, -3)
				if (typeof (end) === 'string') {

					if (end.charAt(0) === '+' || end.charAt(0) === '-') {
						end = start + parseFloat(end);
					} else {
						end = parseFloat(end);
					}
				}

				// Protect against non numeric properties.
				if (typeof (end) === 'number') {
					this._object[property] = start + (end - start) * value;
				}

			}

		}

		if (this._onUpdateCallback !== null) {
			this._onUpdateCallback(this._object);
		}

		if (elapsed === 1) {

			if (this._repeat > 0) {

				if (isFinite(this._repeat)) {
					this._repeat--;
				}

				// Reassign starting values, restart by making startTime = now
				for (property in this._valuesStartRepeat) {

					if (typeof (this._valuesEnd[property]) === 'string') {
						this._valuesStartRepeat[property] = this._valuesStartRepeat[property] + parseFloat(this._valuesEnd[property]);
					}

					if (this._yoyo) {
						var tmp = this._valuesStartRepeat[property];

						this._valuesStartRepeat[property] = this._valuesEnd[property];
						this._valuesEnd[property] = tmp;
					}

					this._valuesStart[property] = this._valuesStartRepeat[property];

				}

				if (this._yoyo) {
					this._reversed = !this._reversed;
				}

				if (this._repeatDelayTime !== undefined) {
					this._startTime = time + this._repeatDelayTime;
				} else {
					this._startTime = time + this._delayTime;
				}

				return true;

			} else {

				if (this._onCompleteCallback !== null) {

					this._onCompleteCallback(this._object);
				}

				for (var i = 0, numChainedTweens = this._chainedTweens.length; i < numChainedTweens; i++) {
					// Make the chained tweens start exactly at the time they should,
					// even if the `update()` method was called way past the duration of the tween
					this._chainedTweens[i].start(this._startTime + this._duration);
				}

				return false;

			}

		}

		return true;

	}
};


TWEEN.Easing = {

	Linear: {

		None: function (k) {

			return k;

		}

	},

	Quadratic: {

		In: function (k) {

			return k * k;

		},

		Out: function (k) {

			return k * (2 - k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k;
			}

			return - 0.5 * (--k * (k - 2) - 1);

		}

	},

	Cubic: {

		In: function (k) {

			return k * k * k;

		},

		Out: function (k) {

			return --k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k + 2);

		}

	},

	Quartic: {

		In: function (k) {

			return k * k * k * k;

		},

		Out: function (k) {

			return 1 - (--k * k * k * k);

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k;
			}

			return - 0.5 * ((k -= 2) * k * k * k - 2);

		}

	},

	Quintic: {

		In: function (k) {

			return k * k * k * k * k;

		},

		Out: function (k) {

			return --k * k * k * k * k + 1;

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return 0.5 * k * k * k * k * k;
			}

			return 0.5 * ((k -= 2) * k * k * k * k + 2);

		}

	},

	Sinusoidal: {

		In: function (k) {

			return 1 - Math.cos(k * Math.PI / 2);

		},

		Out: function (k) {

			return Math.sin(k * Math.PI / 2);

		},

		InOut: function (k) {

			return 0.5 * (1 - Math.cos(Math.PI * k));

		}

	},

	Exponential: {

		In: function (k) {

			return k === 0 ? 0 : Math.pow(1024, k - 1);

		},

		Out: function (k) {

			return k === 1 ? 1 : 1 - Math.pow(2, - 10 * k);

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			if ((k *= 2) < 1) {
				return 0.5 * Math.pow(1024, k - 1);
			}

			return 0.5 * (- Math.pow(2, - 10 * (k - 1)) + 2);

		}

	},

	Circular: {

		In: function (k) {

			return 1 - Math.sqrt(1 - k * k);

		},

		Out: function (k) {

			return Math.sqrt(1 - (--k * k));

		},

		InOut: function (k) {

			if ((k *= 2) < 1) {
				return - 0.5 * (Math.sqrt(1 - k * k) - 1);
			}

			return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);

		}

	},

	Elastic: {

		In: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);

		},

		Out: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;

		},

		InOut: function (k) {

			if (k === 0) {
				return 0;
			}

			if (k === 1) {
				return 1;
			}

			k *= 2;

			if (k < 1) {
				return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);
			}

			return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;

		}

	},

	Back: {

		In: function (k) {

			var s = 1.70158;

			return k * k * ((s + 1) * k - s);

		},

		Out: function (k) {

			var s = 1.70158;

			return --k * k * ((s + 1) * k + s) + 1;

		},

		InOut: function (k) {

			var s = 1.70158 * 1.525;

			if ((k *= 2) < 1) {
				return 0.5 * (k * k * ((s + 1) * k - s));
			}

			return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);

		}

	},

	Bounce: {

		In: function (k) {

			return 1 - TWEEN.Easing.Bounce.Out(1 - k);

		},

		Out: function (k) {

			if (k < (1 / 2.75)) {
				return 7.5625 * k * k;
			} else if (k < (2 / 2.75)) {
				return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;
			} else if (k < (2.5 / 2.75)) {
				return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;
			} else {
				return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;
			}

		},

		InOut: function (k) {

			if (k < 0.5) {
				return TWEEN.Easing.Bounce.In(k * 2) * 0.5;
			}

			return TWEEN.Easing.Bounce.Out(k * 2 - 1) * 0.5 + 0.5;

		}

	}

};

TWEEN.Interpolation = {

	Linear: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.Linear;

		if (k < 0) {
			return fn(v[0], v[1], f);
		}

		if (k > 1) {
			return fn(v[m], v[m - 1], m - f);
		}

		return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);

	},

	Bezier: function (v, k) {

		var b = 0;
		var n = v.length - 1;
		var pw = Math.pow;
		var bn = TWEEN.Interpolation.Utils.Bernstein;

		for (var i = 0; i <= n; i++) {
			b += pw(1 - k, n - i) * pw(k, i) * v[i] * bn(n, i);
		}

		return b;

	},

	CatmullRom: function (v, k) {

		var m = v.length - 1;
		var f = m * k;
		var i = Math.floor(f);
		var fn = TWEEN.Interpolation.Utils.CatmullRom;

		if (v[0] === v[m]) {

			if (k < 0) {
				i = Math.floor(f = m * (1 + k));
			}

			return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);

		} else {

			if (k < 0) {
				return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);
			}

			if (k > 1) {
				return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);
			}

			return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);

		}

	},

	Utils: {

		Linear: function (p0, p1, t) {

			return (p1 - p0) * t + p0;

		},

		Bernstein: function (n, i) {

			var fc = TWEEN.Interpolation.Utils.Factorial;

			return fc(n) / fc(i) / fc(n - i);

		},

		Factorial: (function () {

			var a = [1];

			return function (n) {

				var s = 1;

				if (a[n]) {
					return a[n];
				}

				for (var i = n; i > 1; i--) {
					s *= i;
				}

				a[n] = s;
				return s;

			};

		})(),

		CatmullRom: function (p0, p1, p2, p3, t) {

			var v0 = (p2 - p0) * 0.5;
			var v1 = (p3 - p1) * 0.5;
			var t2 = t * t;
			var t3 = t * t2;

			return (2 * p1 - 2 * p2 + v0 + v1) * t3 + (- 3 * p1 + 3 * p2 - 2 * v0 - v1) * t2 + v0 * t + p1;

		}

	}

};

// UMD (Universal Module Definition)
(function (root) {

	if (true) {

		// AMD
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_RESULT__ = (function () {
			return TWEEN;
		}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));

	} else if (typeof module !== 'undefined' && typeof exports === 'object') {

		// Node.js
		module.exports = TWEEN;

	} else if (root !== undefined) {

		// Global variable
		root.TWEEN = TWEEN;

	}

})(this);

/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(29)))

/***/ }),
/* 28 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_module_ModuleMessage__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_scene_SceneMessage__ = __webpack_require__(40);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__ = __webpack_require__(85);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__egret_AssetsLoader__ = __webpack_require__(86);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__egret_panel_BackPanelPolicy__ = __webpack_require__(89);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__egret_scene_FadeScenePolicy__ = __webpack_require__(91);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__egret_mask_MaskEntity__ = __webpack_require__(92);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__egret_utils_UIUtil__ = __webpack_require__(93);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__egret_command_UpdateScreenSizeCommand__ = __webpack_require__(94);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__egret_utils_SkinUtil__ = __webpack_require__(96);
/// <amd-module name="EgretBridge"/>













/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * Egret的表现层桥实现，当前Egret版本：5.0.7
*/
var EgretBridge = /** @class */ (function () {
    function EgretBridge(params) {
        /**
         * 默认弹窗策略
         *
         * @type {IPanelPolicy}
         * @memberof EgretBridge
         */
        this.defaultPanelPolicy = new __WEBPACK_IMPORTED_MODULE_7__egret_panel_BackPanelPolicy__["a" /* default */]();
        /**
         * 默认场景切换策略
         *
         * @type {IScenePolicy}
         * @memberof EgretBridge
         */
        this.defaultScenePolicy = new __WEBPACK_IMPORTED_MODULE_8__egret_scene_FadeScenePolicy__["a" /* default */]();
        this._initParams = params;
    }
    Object.defineProperty(EgretBridge.prototype, "type", {
        /**
         * 获取表现层类型名称
         *
         * @readonly
         * @type {string}
         * @memberof EgretBridge
         */
        get: function () {
            return EgretBridge.TYPE;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "htmlWrapper", {
        /**
         * 获取表现层HTML包装器，可以对其样式进行自定义调整
         *
         * @readonly
         * @type {HTMLElement}
         * @memberof EgretBridge
         */
        get: function () {
            return this._initParams.container;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "root", {
        /**
         * 获取根显示节点
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._root;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "stage", {
        /**
         * 获取舞台引用
         *
         * @readonly
         * @type {egret.Stage}
         * @memberof EgretBridge
         */
        get: function () {
            return this._stage;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "bgLayer", {
        /**
         * 获取背景容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._bgLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "sceneLayer", {
        /**
         * 获取场景容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._sceneLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "frameLayer", {
        /**
         * 获取框架容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._frameLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "panelLayer", {
        /**
         * 获取弹窗容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._panelLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "maskLayer", {
        /**
         * 获取遮罩容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._maskLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "topLayer", {
        /**
         * 获取顶级容器
         *
         * @readonly
         * @type {egret.DisplayObjectContainer}
         * @memberof EgretBridge
         */
        get: function () {
            return this._topLayer;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "promptClass", {
        /**
         * 获取通用提示框
         *
         * @readonly
         * @type {IPromptPanelConstructor}
         * @memberof EgretBridge
         */
        get: function () {
            return this._initParams.promptClass;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EgretBridge.prototype, "maskEntity", {
        /**
         * 获取遮罩实体
         *
         * @readonly
         * @type {IMaskEntity}
         * @memberof EgretBridge
         */
        get: function () {
            return new __WEBPACK_IMPORTED_MODULE_9__egret_mask_MaskEntity__["a" /* default */](this._initParams.maskData);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 初始化表现层桥
     * @param {()=>void} complete 初始化完毕后的回调
     * @memberof EgretBridge
     */
    EgretBridge.prototype.init = function (complete) {
        // 生成html和body的样式节点
        var style = document.createElement("style");
        style.textContent = "\n            html, body {\n                -ms-touch-action: none;\n                background: " + egret.toColorString(this._initParams.backgroundColor || 0) + ";\n                padding: 0;\n                border: 0;\n                margin: 0;\n                height: 100%;\n            }\n        ";
        document.head.appendChild(style);
        // 统一容器
        if (typeof this._initParams.container == "string") {
            this._initParams.container = document.querySelector(this._initParams.container);
        }
        if (!this._initParams.container) {
            this._initParams.container = document.createElement("div");
            document.body.appendChild(this._initParams.container);
        }
        var container = this._initParams.container;
        // 构建容器参数
        container.style.margin = "auto";
        container.style.width = "100%";
        container.style.height = "100%";
        container.style.position = "fixed";
        container.style.top = "0%";
        container.style.left = "0%";
        container.className = "egret-player";
        container.setAttribute("data-entry-class", "__EgretRoot__");
        container.setAttribute("data-orientation", "auto");
        container.setAttribute("data-scale-mode", this._initParams.scaleMode || egret.StageScaleMode.FIXED_NARROW);
        container.setAttribute("data-frame-rate", (this._initParams.frameRate || 60) + "");
        container.setAttribute("data-content-width", this._initParams.width + "");
        container.setAttribute("data-content-height", this._initParams.height + "");
        container.setAttribute("data-show-paint-rect", (this._initParams.showPaintRect || false) + "");
        container.setAttribute("data-multi-fingered", (this._initParams.multiFingered || 2) + "");
        container.setAttribute("data-show-fps", (this._initParams.showFPS || false) + "");
        container.setAttribute("data-show-fps-style", this._initParams.showFPSStyle || "x:0,y:0,size:12,textColor:0xffffff,bgAlpha:0.9");
        container.setAttribute("data-show-log", (this._initParams.showLog || false) + "");
        // 构建__EgretRoot__类，使得Egret引擎可以通过window寻址的方式找到该类，同时又可以让其将控制权转交给Application
        var self = this;
        window["__EgretRoot__"] = function () {
            eui.UILayer.call(this);
            this.touchEnabled = false;
        };
        window["__EgretRoot__"].prototype = new eui.UILayer();
        window["__EgretRoot__"].prototype.$onAddToStage = function (stage, nestLevel) {
            // 调用父类方法
            eui.UILayer.prototype.$onAddToStage.call(this, stage, nestLevel);
            // 移除引用
            delete window["__EgretRoot__"];
            // 将控制权移交给Application对象
            onRootInitialized(this);
        };
        // 根据渲染模式初始化Egret引擎
        switch (this._initParams.renderMode) {
            case __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__["a" /* default */].WEBGL:
                initEgret("webgl");
                break;
            case __WEBPACK_IMPORTED_MODULE_5__egret_RenderMode__["a" /* default */].CANVAS:
            default:
                initEgret("canvas");
                break;
        }
        function initEgret(renderMode) {
            if (window["eui"]) {
                // 篡改eui.DataGroup.commitProperties和getVirtualElementAt方法，为renderer添加一个标签以修复列表首项渲染多次的bug
                var oriCommitProperties = eui.DataGroup.prototype["commitProperties"];
                eui.DataGroup.prototype["commitProperties"] = function () {
                    this.__egret_datagroup_state__ = 1;
                    var result = oriCommitProperties.apply(this, arguments);
                    return result;
                };
                var oriGetVirtualElementAt = eui.DataGroup.prototype["getVirtualElementAt"];
                eui.DataGroup.prototype["getVirtualElementAt"] = function () {
                    this.__egret_datagroup_state__ = 2;
                    var result = oriGetVirtualElementAt.apply(this, arguments);
                    return result;
                };
                // 篡改eui.registerBindable方法，把__bindables__赋值变为不可遍历的属性
                var oriRegisterBindable = eui.registerBindable;
                eui.registerBindable = function (instance, property) {
                    var result = oriRegisterBindable.call(this, instance, property);
                    // 改变可遍历性
                    var desc = Object.getOwnPropertyDescriptor(instance, "__bindables__");
                    if (desc && desc.enumerable) {
                        desc.enumerable = false;
                        Object.defineProperty(instance, "__bindables__", desc);
                    }
                    // 返回结果
                    return result;
                };
                // 篡改Watcher.checkBindable方法，把__listeners__赋值变为不可遍历
                var oriCheckBindable = eui.Watcher["checkBindable"];
                eui.Watcher["checkBindable"] = function (host, property) {
                    var result = oriCheckBindable.call(this, host, property);
                    // 改变可遍历性
                    var desc = Object.getOwnPropertyDescriptor(host, "__listeners__");
                    if (desc && desc.enumerable) {
                        desc.enumerable = false;
                        Object.defineProperty(host, "__listeners__", desc);
                    }
                };
            }
            // 启动Egret引擎
            egret.runEgret({
                renderMode: renderMode,
                audioType: 0
            });
        }
        function onRootInitialized(root) {
            self._root = root;
            self._stage = root.stage;
            // 创建背景显示层
            self._bgLayer = new eui.UILayer();
            self._bgLayer.touchEnabled = false;
            root.addChild(self._bgLayer);
            // 创建场景显示层
            self._sceneLayer = new eui.UILayer();
            self._sceneLayer.touchEnabled = false;
            root.addChild(self._sceneLayer);
            // 创建框架显示层
            self._frameLayer = new eui.UILayer();
            self._frameLayer.touchEnabled = false;
            root.addChild(self._frameLayer);
            // 创建弹出层
            self._panelLayer = new eui.UILayer();
            self._panelLayer.touchEnabled = false;
            root.addChild(self._panelLayer);
            // 创建遮罩层
            self._maskLayer = new eui.UILayer();
            self._maskLayer.touchEnabled = false;
            root.addChild(self._maskLayer);
            // 创建顶级显示层
            self._topLayer = new eui.UILayer();
            self._topLayer.touchEnabled = false;
            root.addChild(self._topLayer);
            // 插入更新屏幕命令
            __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__["a" /* core */].mapCommand(__WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_scene_SceneMessage__["a" /* default */].SCENE_BEFORE_CHANGE, __WEBPACK_IMPORTED_MODULE_11__egret_command_UpdateScreenSizeCommand__["a" /* default */]);
            // 设置资源和主题适配器
            egret.registerImplementation("eui.IAssetAdapter", new AssetAdapter());
            egret.registerImplementation("eui.IThemeAdapter", new ThemeAdapter(self._initParams));
            // 加载资源配置
            RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
            var url = Object(__WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__["f" /* wrapAbsolutePath */])(self._initParams.pathPrefix + "resource/default.res.json", __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__["environment"].curCDNHost);
            RES.loadConfig(url, self._initParams.pathPrefix + "resource/");
        }
        function onConfigComplete(evt) {
            RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
            // 加载主题配置
            var url = Object(__WEBPACK_IMPORTED_MODULE_4_olympus_r_utils_URLUtil__["f" /* wrapAbsolutePath */])(this._initParams.pathPrefix + "resource/default.thm.json", __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_env_Environment__["environment"].curCDNHost);
            var theme = new eui.Theme(url, self._root.stage);
            theme.addEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
        }
        function onThemeLoadComplete(evt) {
            evt.target.removeEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
            // 加载预加载资源组
            var preloadGroups = this._initParams.preloadGroups;
            self.loadAssets(preloadGroups, null, function (err) { return complete(self); });
        }
    };
    /**
     * 判断皮肤是否是Egret显示对象
     *
     * @param {*} skin 皮肤对象
     * @returns {boolean} 是否是Egret显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.isMySkin = function (skin) {
        if (skin instanceof egret.DisplayObject)
            return true;
        if (skin instanceof Function)
            return (skin.prototype instanceof egret.DisplayObject);
        if (typeof skin === "string")
            return (egret.getDefinitionByName(skin) != null);
    };
    /**
     * 包装HTMLElement节点
     *
     * @param {IMediator} mediator 中介者
     * @param {*} skin 原始皮肤
     * @returns {egret.DisplayObject} 包装后的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.wrapSkin = function (mediator, skin) {
        return Object(__WEBPACK_IMPORTED_MODULE_12__egret_utils_SkinUtil__["a" /* wrapSkin */])(mediator, skin);
    };
    /**
     * 替换皮肤，用于组件变身时不同表现层桥的处理
     *
     * @param {IMediator} mediator 中介者
     * @param {*} current 当前皮肤
     * @param {*} target 要替换的皮肤
     * @returns {*} 替换完毕的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.replaceSkin = function (mediator, current, target) {
        // Egret皮肤需要判断类型，进行不同处理
        if (current instanceof eui.Component) {
            if (target instanceof eui.Component) {
                // 两边都是eui组件，直接将右手皮肤赋值给左手
                current.skinName = target.skin;
            }
            else if (target instanceof egret.DisplayObject) {
                // 右手是普通显示对象，移除左手皮肤，添加右手显示到其中
                current.skinName = null;
                current.addChild(target);
            }
            else {
                // 其他情况都认为右手是皮肤数据
                current.skinName = target;
            }
            // 返回左手
            return current;
        }
        else {
            if (!(target instanceof egret.DisplayObject)) {
                // 右手不是显示对象，认为是皮肤数据，生成一个eui.Component包裹它
                var temp = new eui.Component();
                temp.skinName = target;
                target = temp;
            }
            // 右手替换左手位置
            var parent = current.parent;
            parent.addChildAt(target, parent.getChildIndex(current));
            parent.removeChild(current);
            // 返回右手
            return target;
        }
    };
    /**
     * 同步皮肤，用于组件变身后的重新定位
     *
     * @param {egret.DisplayObject} current 当前皮肤
     * @param {egret.DisplayObject} target 替换的皮肤
     * @memberof EgretBridge
     */
    EgretBridge.prototype.syncSkin = function (current, target) {
        if (!current || !target)
            return;
        // 设置属性
        // 下面是egret级别属性
        var props = [
            "matrix", "anchorOffsetX", "anchorOffsetY", "alpha", "visible"
        ];
        // 如果当前宽高不为0则同样设置宽高
        if (current.width > 0)
            props.push("width");
        if (current.height > 0)
            props.push("height");
        // 下面是eui级别属性
        if (current instanceof eui.Component && target instanceof eui.Component) {
            props.push.apply(props, [
                "horizontalCenter", "verticalCenter", "left", "right", "top", "bottom"
            ]);
        }
        // 全部赋值
        for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {
            var prop = props_1[_i];
            target[prop] = current[prop];
        }
    };
    /**
     * 创建一个空的显示对象
     *
     * @returns {egret.Sprite}
     * @memberof EgretBridge
     */
    EgretBridge.prototype.createEmptyDisplay = function () {
        return new egret.Sprite();
    };
    /**
     * 添加显示
     *
     * @param {egret.DisplayObjectContainer} parent 要添加到的父容器
     * @param {egret.DisplayObject} target 被添加的显示对象
     * @return {egret.DisplayObject} 返回被添加的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.addChild = function (parent, target) {
        if (parent && target)
            return parent.addChild(target);
        else
            return target;
    };
    /**
     * 按索引添加显示
     *
     * @param {egret.DisplayObjectContainer} parent 要添加到的父容器
     * @param {egret.DisplayObject} target 被添加的显示对象
     * @param {number} index 要添加到的父级索引
     * @return {egret.DisplayObject} 返回被添加的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.addChildAt = function (parent, target, index) {
        if (parent && target)
            return parent.addChildAt(target, index);
        else
            return target;
    };
    /**
     * 移除显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {egret.DisplayObject} target 被移除的显示对象
     * @return {egret.DisplayObject} 返回被移除的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChild = function (parent, target) {
        if (parent && target && target.parent === parent)
            return parent.removeChild(target);
        else
            return target;
    };
    /**
     * 按索引移除显示
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {number} index 索引
     * @return {egret.DisplayObject} 返回被移除的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChildAt = function (parent, index) {
        if (parent && index >= 0)
            return parent.removeChildAt(index);
        else
            return null;
    };
    /**
     * 移除所有显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @memberof EgretBridge
     */
    EgretBridge.prototype.removeChildren = function (parent) {
        if (parent)
            parent.removeChildren();
    };
    /**
     * 获取父容器
     *
     * @param {egret.DisplayObject} target 目标对象
     * @returns {egret.DisplayObjectContainer} 父容器
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getParent = function (target) {
        return target.parent;
    };
    /**
     * 获取指定索引处的显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {number} index 指定父级索引
     * @return {egret.DisplayObject} 索引处的显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildAt = function (parent, index) {
        return parent.getChildAt(index);
    };
    /**
     * 获取显示索引
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {egret.DisplayObject} target 子显示对象
     * @return {number} target在parent中的索引
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildIndex = function (parent, target) {
        return parent.getChildIndex(target);
    };
    /**
     * 通过名称获取显示对象
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @param {string} name 对象名称
     * @return {egret.DisplayObject} 显示对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildByName = function (parent, name) {
        return parent.getChildByName(name);
    };
    /**
     * 获取子显示对象数量
     *
     * @param {egret.DisplayObjectContainer} parent 父容器
     * @return {number} 子显示对象数量
     * @memberof EgretBridge
     */
    EgretBridge.prototype.getChildCount = function (parent) {
        return parent.numChildren;
    };
    /**
     * 加载资源
     *
     * @param {string[]} assets 资源数组
     * @param {IMediator} mediator 资源列表
     * @param {(err?:Error)=>void} handler 回调函数
     * @memberof EgretBridge
     */
    EgretBridge.prototype.loadAssets = function (assets, mediator, handler) {
        var loader = new __WEBPACK_IMPORTED_MODULE_6__egret_AssetsLoader__["a" /* default */]({
            oneError: function (evt) {
                // 调用回调
                handler(new Error("资源加载失败"));
                // 派发加载错误事件
                __WEBPACK_IMPORTED_MODULE_0_olympus_r_core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_module_ModuleMessage__["default"].MODULE_LOAD_ASSETS_ERROR, evt);
            },
            complete: function (dict) {
                // 调用回调
                handler();
            }
        });
        loader.loadGroups(assets);
    };
    /**
     * 监听事件，从这个方法监听的事件会在中介者销毁时被自动移除监听
     *
     * @param {egret.EventDispatcher} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.mapListener = function (target, type, handler, thisArg) {
        target.addEventListener(type, handler, thisArg);
    };
    /**
     * 注销监听事件
     *
     * @param {egret.EventDispatcher} target 事件目标对象
     * @param {string} type 事件类型
     * @param {Function} handler 事件处理函数
     * @param {*} [thisArg] this指向对象
     * @memberof EgretBridge
     */
    EgretBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
        target.removeEventListener(type, handler, thisArg);
    };
    /**
     * 为绑定的列表显示对象包装一个渲染器创建回调
     *
     * @param {eui.DataGroup} target BindFor指令指向的显示对象
     * @param {(key?:any, value?:any, renderer?:eui.IItemRenderer)=>void} rendererHandler 渲染器创建回调
     * @returns {*} 返回一个备忘录对象，会在赋值时提供
     * @memberof IBridge
     */
    EgretBridge.prototype.wrapBindFor = function (target, rendererHandler) {
        var memento = {};
        Object(__WEBPACK_IMPORTED_MODULE_10__egret_utils_UIUtil__["a" /* wrapEUIList */])(target, function (data, renderer) {
            // 取出key
            var key;
            var datas = memento.datas;
            // 遍历memento的datas属性（在valuateBindFor时被赋值）
            if (datas instanceof Array) {
                key = renderer.itemIndex;
            }
            else {
                for (var i in datas) {
                    if (datas[i] === data) {
                        // 这就是我们要找的key
                        key = i;
                        break;
                    }
                }
            }
            // 调用回调
            if (key != null) {
                if (memento.syncDict) {
                    if (!memento.syncDict[key]) {
                        if (target["__egret_datagroup_state__"] === 1 || target["__egret_datagroup_state__"] === 2) {
                            memento.syncDict[key] = data;
                            rendererHandler(key, data, renderer);
                        }
                    }
                }
                else {
                    rendererHandler(key, data, renderer);
                }
            }
        });
        return memento;
    };
    /**
     * 为列表显示对象赋值
     *
     * @param {eui.DataGroup} target BindFor指令指向的显示对象
     * @param {*} datas 数据集合
     * @param {*} memento wrapBindFor返回的备忘录对象
     * @memberof IBridge
     */
    EgretBridge.prototype.valuateBindFor = function (target, datas, memento) {
        var provider;
        // 初始化列表状态
        target["__egret_datagroup_state__"] = 0;
        // 设置memento
        memento.datas = datas;
        memento.syncDict = {};
        setTimeout(function () {
            // 一次渲染后解锁
            delete memento.syncDict;
        }, 0);
        // 复制datas
        if (datas instanceof Array) {
            provider = new eui.ArrayCollection(datas);
        }
        else {
            // 是字典，将其变为数组
            var list = [];
            for (var key in datas) {
                list.push(datas[key]);
            }
            provider = new eui.ArrayCollection(list);
        }
        // 赋值
        target.dataProvider = provider;
    };
    /** 提供静态类型常量 */
    EgretBridge.TYPE = "Egret";
    return EgretBridge;
}());
/* harmony default export */ __webpack_exports__["default"] = (EgretBridge);
var AssetAdapter = /** @class */ (function () {
    function AssetAdapter() {
    }
    /**
     * @language zh_CN
     * 解析素材
     * @param source 待解析的新素材标识符
     * @param compFunc 解析完成回调函数，示例：callBack(content:any,source:string):void;
     * @param thisObject callBack的 this 引用
     */
    AssetAdapter.prototype.getAsset = function (source, compFunc, thisObject) {
        if (RES.hasRes(source)) {
            var data = RES.getRes(source);
            if (data)
                onGetRes(data);
            else
                RES.getResAsync(source, onGetRes, this);
        }
        else {
            RES.getResByUrl(source, onGetRes, this, RES.ResourceItem.TYPE_IMAGE);
        }
        function onGetRes(data) {
            compFunc.call(thisObject, data, source);
        }
    };
    return AssetAdapter;
}());
var ThemeAdapter = /** @class */ (function () {
    function ThemeAdapter(initParams) {
        this._initParams = initParams;
    }
    /**
     * 解析主题
     * @param url 待解析的主题url
     * @param compFunc 解析完成回调函数，示例：compFunc(e:egret.Event):void;
     * @param errorFunc 解析失败回调函数，示例：errorFunc():void;
     * @param thisObject 回调的this引用
     */
    ThemeAdapter.prototype.getTheme = function (url, compFunc, errorFunc, thisObject) {
        RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
        RES.getResByUrl(url, onGetRes, this, RES.ResourceItem.TYPE_TEXT);
        function onGetRes(e) {
            try {
                // 需要为所有主题资源添加路径前缀
                var data = JSON.parse(e);
                for (var key in data.skins)
                    data.skins[key] = this._initParams.pathPrefix + data.skins[key];
                for (var key in data.exmls) {
                    // 如果只是URL则直接添加前缀，否则是内容集成方式，需要单独修改path属性
                    var exml = data.exmls[key];
                    if (typeof exml == "string")
                        data.exmls[key] = this._initParams.pathPrefix + exml;
                    else
                        exml.path = this._initParams.pathPrefix + exml.path;
                }
                e = JSON.stringify(data);
            }
            catch (err) { }
            compFunc.call(thisObject, e);
        }
        function onError(e) {
            if (e.resItem.url == url) {
                RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
                errorFunc.call(thisObject);
            }
        }
    };
    return ThemeAdapter;
}());


/***/ }),
/* 29 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 30 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__ = __webpack_require__(58);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__message_CoreMessage__ = __webpack_require__(32);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-31
 * @modify date 2017-10-31
 *
 * 可观察接口的默认实现对象，会将收到的消息通知给注册的回调
*/
var Observable = /** @class */ (function () {
    function Observable(parent) {
        this._listenerDict = {};
        this._commandDict = {};
        this._disposed = false;
        this.parent = parent && parent.observable;
    }
    Object.defineProperty(Observable.prototype, "observable", {
        /**
         * 获取到IObservable实体，若本身就是IObservable实体则返回本身
         *
         * @type {IObservable}
         * @memberof Observable
         */
        get: function () {
            return this;
        },
        enumerable: true,
        configurable: true
    });
    Observable.prototype.handleMessages = function (msg) {
        var _a;
        var listeners1 = this._listenerDict[msg.__type];
        var listeners2 = this._listenerDict[msg.constructor.toString()];
        var listeners = (listeners1 && listeners2 ? listeners1.concat(listeners2) : listeners1 || listeners2);
        if (listeners) {
            listeners = listeners.concat();
            for (var _i = 0, listeners_1 = listeners; _i < listeners_1.length; _i++) {
                var temp = listeners_1[_i];
                // 调用处理函数
                if (msg instanceof __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */])
                    // 如果是通用消息，则将参数结构后调用回调
                    (_a = temp.handler).call.apply(_a, [temp.thisArg].concat(msg.params));
                else
                    // 如果是其他消息，则直接将消息体传给回调
                    temp.handler.call(temp.thisArg, msg);
                // 如果是一次性监听则移除之
                if (temp.once) {
                    this.unlisten(msg.__type, temp.handler, temp.thisArg, temp.once);
                    this.unlisten(msg.constructor.toString(), temp.handler, temp.thisArg, temp.once);
                }
            }
        }
    };
    Observable.prototype.doDispatch = function (msg) {
        // 记录流转内核
        msg.__observables.push(this);
        // 触发命令
        this.handleCommands(msg);
        // 触发用listen形式监听的消息
        this.handleMessages(msg);
    };
    /** dispatch方法实现 */
    Observable.prototype.dispatch = function (typeOrMsg) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        // 销毁判断
        if (this._disposed)
            return;
        // 统一消息对象
        var msg = typeOrMsg;
        if (typeof typeOrMsg == "string") {
            msg = new __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */](typeOrMsg);
            msg.params = params;
        }
        // 派发消息
        this.doDispatch(msg);
        // 额外派发一个通用事件
        this.doDispatch(new __WEBPACK_IMPORTED_MODULE_0__message_CommonMessage__["a" /* default */](__WEBPACK_IMPORTED_MODULE_1__message_CoreMessage__["a" /* default */].MESSAGE_DISPATCHED, msg));
        // 将事件转发到上一层
        this.parent && this.parent.dispatch(msg);
    };
    /**
     * 监听内核消息
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @memberof Observable
     */
    Observable.prototype.listen = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        // 销毁判断
        if (this._disposed)
            return;
        type = (typeof type == "string" ? type : type.toString());
        var listeners = this._listenerDict[type];
        if (!listeners)
            this._listenerDict[type] = listeners = [];
        // 检查存在性
        for (var i = 0, len = listeners.length; i < len; i++) {
            var temp = listeners[i];
            // 如果已经存在监听则直接返回
            if (temp.handler == handler && temp.thisArg == thisArg)
                return;
        }
        // 添加监听
        listeners.push({ handler: handler, thisArg: thisArg, once: once });
    };
    /**
     * 移除内核消息监听
     *
     * @param {string} type 消息类型
     * @param {Function} handler 消息处理函数
     * @param {*} [thisArg] 消息this指向
     * @param {boolean} [once=false] 是否一次性监听
     * @memberof Observable
     */
    Observable.prototype.unlisten = function (type, handler, thisArg, once) {
        if (once === void 0) { once = false; }
        // 销毁判断
        if (this._disposed)
            return;
        type = (typeof type == "string" ? type : type.toString());
        var listeners = this._listenerDict[type];
        // 检查存在性
        if (listeners) {
            for (var i = 0, len = listeners.length; i < len; i++) {
                var temp = listeners[i];
                // 如果已经存在监听则直接返回
                if (temp.handler == handler && temp.thisArg == thisArg && temp.once == once) {
                    listeners.splice(i, 1);
                    break;
                }
            }
        }
    };
    Observable.prototype.handleCommands = function (msg) {
        var commands = this._commandDict[msg.__type];
        if (commands) {
            commands = commands.concat();
            for (var _i = 0, commands_1 = commands; _i < commands_1.length; _i++) {
                var cls = commands_1[_i];
                // 执行命令
                new cls(msg).exec();
            }
        }
    };
    /**
     * 注册命令到特定消息类型上，当这个类型的消息派发到框架内核时会触发Command运行
     *
     * @param {string} type 要注册的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器，可以是方法形式，也可以使类形式
     * @memberof Observable
     */
    Observable.prototype.mapCommand = function (type, cmd) {
        // 销毁判断
        if (this._disposed)
            return;
        var commands = this._commandDict[type];
        if (!commands)
            this._commandDict[type] = commands = [];
        if (commands.indexOf(cmd) < 0)
            commands.push(cmd);
    };
    /**
     * 注销命令
     *
     * @param {string} type 要注销的消息类型
     * @param {(ICommandConstructor)} cmd 命令处理器
     * @returns {void}
     * @memberof Observable
     */
    Observable.prototype.unmapCommand = function (type, cmd) {
        // 销毁判断
        if (this._disposed)
            return;
        var commands = this._commandDict[type];
        if (!commands)
            return;
        var index = commands.indexOf(cmd);
        if (index < 0)
            return;
        commands.splice(index, 1);
    };
    Object.defineProperty(Observable.prototype, "disposed", {
        /** 是否已经被销毁 */
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    /** 销毁 */
    Observable.prototype.dispose = function () {
        // 销毁判断
        if (this._disposed)
            return;
        // 移除上一层观察者引用
        this.parent = null;
        // 清空所有消息监听
        this._listenerDict = null;
        // 清空所有命令
        this._commandDict = null;
        // 标记销毁
        this._disposed = true;
    };
    return Observable;
}());
/* harmony default export */ __webpack_exports__["a"] = (Observable);


/***/ }),
/* 31 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * 消息基类
*/
var Message = /** @class */ (function () {
    function Message(type) {
        /**
         * 消息派发内核列表
         *
         * @type {IObservable}
         * @memberof Message
         */
        this.__observables = [];
        this._type = type;
    }
    Object.defineProperty(Message.prototype, "__type", {
        /**
         * 获取消息类型字符串
         *
         * @readonly
         * @type {string}
         * @memberof Message
         */
        get: function () {
            return this._type;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Message.prototype, "__observable", {
        /**
         * 消息当前所属内核
         *
         * @type {IObservable}
         * @memberof Message
         */
        get: function () {
            return this.__observables[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Message.prototype, "__oriObservable", {
        /**
         * 消息所属的原始内核（第一个派发到的内核）
         *
         * @type {IObservable}
         * @memberof Message
         */
        get: function () {
            return this.__observables[this.__observables.length - 1];
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 再次发送消息，会使用首个内核重新发送该消息
     *
     * @memberof Message
     */
    Message.prototype.redispatch = function () {
        this.__oriObservable.dispatch(this);
    };
    return Message;
}());
/* harmony default export */ __webpack_exports__["a"] = (Message);


/***/ }),
/* 32 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-13
 * @modify date 2017-09-13
 *
 * 核心事件类型
*/
var CoreMessage = /** @class */ (function () {
    function CoreMessage() {
    }
    /**
     * 任何消息派发到框架后都会派发这个消息
     *
     * @static
     * @type {string}
     * @memberof CoreMessage
     */
    CoreMessage.MESSAGE_DISPATCHED = "messageDispatched";
    return CoreMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (CoreMessage);


/***/ }),
/* 33 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export shuffle */
/* unused harmony export randomize */
/* unused harmony export randomizeWeight */
/* harmony export (immutable) */ __webpack_exports__["a"] = unique;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Dictionary__ = __webpack_require__(3);

/**
 * 简单数组乱序
 *
 * @export
 * @template T
 * @param {T} a
 * @returns {T}
 */
function shuffle(a) {
    var len = a.length;
    for (var i = 1; i < len; i++) {
        var end = len - i;
        var index = (Math.random() * (end + 1)) >> 0;
        var t = a[end];
        a[end] = a[index];
        a[index] = t;
    }
    return a;
}
/**
 * 从数组指定范围内随机取出指定数量的不重复元素
 * ArrayUtils.randomize([0,1,2,3,4,5,6,7,8,9], 3, 2, 7);
 * //返回[6,2,3]
 *
 * @param arr 		原始数组
 * @param count	    数量，默认为范围内全部元素
 * @param begin 	起始位置，默认为0
 * @param end		结束位置，默认为数组长度
 */
function randomize(arr, count, begin, end) {
    if (!arr || begin < 0)
        throw new Error("invalid argument");
    arr = arr.concat();
    var len = arr.length;
    end = end >> 0;
    if (!(end >= 0 && end <= len)) {
        end = len;
    }
    begin = begin >> 0;
    if (!(begin > 0)) {
        begin = 0;
    }
    count = count >> 0;
    if (!(count >= 0 && count < end - begin)) {
        count = end - begin;
    }
    var arr2 = [];
    var end2 = begin + count;
    for (var i = begin; i < end2; i++) {
        var index = (Math.random() * (end - i) + i) >> 0;
        arr2[i - begin] = arr[index];
        arr[index] = arr[i];
    }
    return arr2;
}
/**
 * 进行权重随机
 *
 * @export
 * @template T
 * @param {T[]} arr 原始数组
 * @param {number[]} weight 权重数组，应保证权重数组的元素数量不小于原始数组的元素数量
 * @returns {T} 选取的结果
 */
function randomizeWeight(arr, weight) {
    if (!arr || !weight)
        throw new Error("invalid argument");
    if (weight.length < arr.length)
        throw new Error("权重数组的元素数量不应小于原始数组的元素数量");
    // 根据权重数组建立一个区间数组
    var regions = [];
    var sum = 0;
    for (var i in arr) {
        sum += weight[i];
        regions.push(sum);
    }
    // 随机一个位置
    var ran = Math.random() * sum;
    // 搜索该位置所属区间索引
    var index;
    for (var i = 0, len = regions.length; i < len; i++) {
        if (ran < regions[i]) {
            index = i;
            break;
        }
    }
    // 返回索引处的原始数组元素
    return arr[index];
}
/**
 * 数组去重，不会修改原数组
 *
 * @export
 * @param {any[]} list
 * @returns {any[]}
 */
function unique(list) {
    if (!list)
        return list;
    // 初始化
    var hash = new __WEBPACK_IMPORTED_MODULE_0__Dictionary__["a" /* default */](), result = [];
    // 遍历当前数组
    for (var i = 0, len = list.length; i < len; i++) {
        // 如果hash表中没有当前项
        if (!hash.get(list[i])) {
            // 存入hash表
            hash.set(list[i], true);
            // 把当前数组的当前项push到临时数组里面
            result.push(list[i]);
        }
    }
    return result;
}


/***/ }),
/* 34 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return JSLoadMode; });
var JSLoadMode;
(function (JSLoadMode) {
    JSLoadMode[JSLoadMode["AUTO"] = 0] = "AUTO";
    JSLoadMode[JSLoadMode["JSONP"] = 1] = "JSONP";
    JSLoadMode[JSLoadMode["TAG"] = 2] = "TAG";
})(JSLoadMode || (JSLoadMode = {}));


/***/ }),
/* 35 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = load;
/* unused harmony export asyncLoad */
/* unused harmony export toFormParams */
/* unused harmony export XHRError */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__URLUtil__ = __webpack_require__(12);




/**
 * 发送一个或多个HTTP请求
 *
 * @export
 * @param {IHTTPRequestParams} params 请求参数
 */
function load(params) {
    // 非空判断
    if (!params.url) {
        // 成功回调
        params.onResponse && params.onResponse();
        return;
    }
    // 数组判断
    if (params.url instanceof Array) {
        // 一次请求多个地址，需要做一个队列加载，然后一次性回调
        var urls = params.url;
        var results = [];
        var newParams = Object(__WEBPACK_IMPORTED_MODULE_2__ObjectUtil__["a" /* cloneObject */])(params);
        newParams.onResponse = function (result) {
            results.push(result);
            loadNext();
        };
        var loadNext = function () {
            if (urls.length <= 0) {
                // 成功回调
                params.onResponse && params.onResponse(results);
                return;
            }
            newParams.url = urls.shift();
            load(newParams);
        };
        loadNext();
        return;
    }
    // 一次请求一个地址
    var retryTimes = params.retryTimes || 2;
    var timeout = params.timeout || 10000;
    var method = params.method || "GET";
    var timeoutId = 0;
    var data = params.data || {};
    // 取到url
    var url = params.url;
    if (params.useCDN) {
        // 如果使用CDN则改用cdn域名
        url = __WEBPACK_IMPORTED_MODULE_1__engine_env_Environment__["environment"].toCDNHostURL(url);
    }
    else {
        // 合法化protocol
        url = Object(__WEBPACK_IMPORTED_MODULE_3__URLUtil__["e" /* validateProtocol */])(url, params.forceHTTPS ? "https:" : null);
        // 规整一下url
        url = Object(__WEBPACK_IMPORTED_MODULE_3__URLUtil__["d" /* trimURL */])(url);
    }
    // 生成xhr
    var xhr = (window["XDomainRequest"] && navigator.userAgent.indexOf("MSIE 10.") < 0 ? new window["XDomainRequest"]() : window["XMLHttpRequest"] ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"));
    // 发送
    send();
    function send() {
        var sendData = null;
        // 根据发送方式组织数据格式
        switch (method) {
            case "POST":
                switch (params.headerDict && params.headerDict["Content-Type"]) {
                    case "application/x-www-form-urlencoded":
                        // 使用webform格式（即query结构）字符串
                        sendData = toFormParams(data);
                        break;
                    case "multipart/form-data":
                        // 使用FormData对数据进行包装
                        sendData = new FormData();
                        for (var key_1 in data) {
                            sendData.append(key_1, data[key_1]);
                        }
                        break;
                    default:
                        // 其他都使用json包装为字符串
                        sendData = JSON.stringify(data);
                        break;
                }
                break;
            case "GET":
                // 将数据添加到url上
                url = Object(__WEBPACK_IMPORTED_MODULE_3__URLUtil__["c" /* joinQueryParams */])(url, data);
                break;
            default:
                throw new Error("暂不支持的HTTP Method：" + method);
        }
        // 打开XHR
        xhr.open(method, url, true);
        // 初始化，responseType必须在open之后设置，否则IE10和IE11会报错
        if (params.responseType)
            xhr.responseType = params.responseType;
        // 如果需要withCredentials，则设置之
        if (params.withCredentials)
            xhr.withCredentials = true;
        xhr.onload = onLoad;
        xhr.onerror = onError;
        // 添加自定义请求头，如果可以的话
        if (xhr.setRequestHeader) {
            for (var key in params.headerDict) {
                xhr.setRequestHeader(key, params.headerDict[key]);
            }
        }
        // 开始发送
        xhr.send(sendData);
        // 开始计时
        timeoutId = window.setTimeout(onError, timeout);
    }
    function onLoad(evt) {
        // 即使是onLoad也要判断下状态码，但如果没有状态码，比如说XDomainRequest就直接认为成功了
        var statusHead = xhr.status ? Math.floor(xhr.status * 0.01) : 2;
        switch (statusHead) {
            case 2:
            case 3:
                // 2xx和3xx的状态码认为是成功
                timeoutId && clearTimeout(timeoutId);
                timeoutId = 0;
                // 成功回调
                params.onResponse && params.onResponse(xhr.response || xhr.responseText);
                break;
            case 4:
            case 5:
                // 4xx和5xx的状态码认为是错误，转调错误回调
                onError();
                break;
        }
    }
    function onError() {
        // 停止计时
        timeoutId && clearTimeout(timeoutId);
        timeoutId = 0;
        // 失败重试
        if (retryTimes > 0) {
            // 没有超过重试上限则重试
            abortAndRetry();
        }
        else {
            // 出错，如果使用CDN功能则尝试切换
            if (params.useCDN && !__WEBPACK_IMPORTED_MODULE_1__engine_env_Environment__["environment"].nextCDN()) {
                // 还没切换完，重新加载
                load(params);
            }
            else {
                // 切换完了还失败，则汇报错误
                params.onError && params.onError(new XHRError(xhr));
            }
        }
    }
    function abortAndRetry() {
        // 重试次数递减
        retryTimes--;
        // 中止xhr
        xhr.abort();
        // 添加时间戳作为随机版本号
        url = Object(__WEBPACK_IMPORTED_MODULE_3__URLUtil__["c" /* joinQueryParams */])(url, { _r: Date.now() });
        // 重新发送
        send();
    }
}
/**
 * 异步加载，用于异步编程，参数中的onResponse和onError将会失效
 *
 * @export
 * @param {IHTTPRequestParams} params 请求参数
 * @returns {(Promise<any|any[]>)}
 */
function asyncLoad(params) {
    return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](this, void 0, void 0, function () {
        return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_a) {
            return [2 /*return*/, new Promise(function (resolve, reject) {
                    params.onResponse = resolve;
                    params.onError = reject;
                    load(params);
                })];
        });
    });
}
/**
 * 将数据转换为form形式
 *
 * @export
 * @param {*} data 要转换的数据
 * @returns {string} 转换结果字符串
 */
function toFormParams(data) {
    var keys = Object.keys(data);
    var params = keys.map(function (key) {
        return encodeURIComponent(key) + "=" + encodeURIComponent(data[key]);
    });
    return params.join("&");
}
var XHRError = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](XHRError, _super);
    function XHRError(xhr) {
        var _this = _super.call(this, xhr.status ? xhr.status + " " + xhr.statusText : "请求错误，且无法获取错误信息") || this;
        _this._xhr = xhr;
        return _this;
    }
    Object.defineProperty(XHRError.prototype, "xhr", {
        /**
         * 获取错误对应的XMLHttpRequest对象
         *
         * @readonly
         * @type {XMLHttpRequest}
         * @memberof XHRError
         */
        get: function () {
            return this._xhr;
        },
        enumerable: true,
        configurable: true
    });
    return XHRError;
}(Error));



/***/ }),
/* 36 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return bindManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_DisplayUtil__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__net_NetManager__ = __webpack_require__(14);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__Bind__ = __webpack_require__(65);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__Utils__ = __webpack_require__(23);










/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 绑定管理器，可以将数据和显示对象绑定到一起，MVVM书写界面
*/
var BindManager = /** @class */ (function () {
    function BindManager() {
        this._bindDict = new __WEBPACK_IMPORTED_MODULE_3__utils_Dictionary__["a" /* default */]();
        this._regExp = /^\s*(\w+)\s+((in)|(of))\s+(.+?)\s*$/;
    }
    /**
     * 获取mediator对应的BindData
     *
     * @param {IMediator} mediator
     * @returns {BindData}
     * @memberof BindManager
     */
    BindManager.prototype.getBindData = function (mediator) {
        return this._bindDict.get(mediator);
    };
    /**
     * 绑定数据到UI上
     *
     * @param {IMediator} mediator 中介者
     * @returns {Bind} 返回绑定实例
     * @memberof BindManager
     */
    BindManager.prototype.bind = function (mediator) {
        var bindData = this._bindDict.get(mediator);
        if (!bindData) {
            this._bindDict.set(mediator, bindData = {
                bind: new __WEBPACK_IMPORTED_MODULE_8__Bind__["a" /* default */](mediator),
                callbacks: []
            });
        }
        // 重新绑定所有
        for (var _i = 0, _a = bindData.callbacks; _i < _a.length; _i++) {
            var callback = _a[_i];
            callback();
        }
        // 返回Bind对象
        return bindData.bind;
    };
    /**
     * 移除绑定
     *
     * @param {IMediator} mediator
     * @returns {Bind}
     * @memberof BindManager
     */
    BindManager.prototype.unbind = function (mediator) {
        var bindData = this._bindDict.get(mediator);
        if (bindData) {
            bindData.bind.dispose();
            this._bindDict.delete(mediator);
        }
        return bindData && bindData.bind;
    };
    BindManager.prototype.addBindHandler = function (mediator, callback) {
        var handler = function () {
            // 判断数据是否合法
            if (!mediator.viewModel)
                return;
            // 开始绑定
            callback();
        };
        // 添加绑定数据
        var bindData = this._bindDict.get(mediator);
        if (bindData.callbacks.indexOf(handler) < 0)
            bindData.callbacks.push(handler);
        // 立即调用一次
        handler();
    };
    BindManager.prototype.getNearestAncestor = function (bridge, target, propName) {
        if (!target || target[propName])
            return target;
        else
            return this.getNearestAncestor(bridge, bridge.getParent(target), propName);
    };
    /**
     * 绑定属性值
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} name 绑定的属性名
     * @param {(EvalExp)} exp 绑定的表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindValue = function (mediator, currentTarget, target, envModels, name, exp) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            var _a;
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定新的订阅者
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    currentTarget[name] = value;
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
        });
    };
    /**
     * 绑定一个表达式，与bindValue类似，但不会给属性赋值
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {(EvalExp)} exp 绑定的表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindExp = function (mediator, currentTarget, target, envModels, exp) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            var _a;
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定新的订阅者
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    // 不干任何事情
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
        });
    };
    /**
     * 绑定方法执行
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} name 绑定的方法名
     * @param {...(EvalExp)[]} argExps 执行方法的参数表达式或方法列表
     * @memberof BindManager
     */
    BindManager.prototype.bindFunc = function (mediator, currentTarget, target, envModels, name) {
        var _this = this;
        var argExps = [];
        for (var _i = 5; _i < arguments.length; _i++) {
            argExps[_i - 5] = arguments[_i];
        }
        var watchers = [];
        var bindData = this._bindDict.get(mediator);
        this.addBindHandler(mediator, function () {
            var _a;
            // 判断参数数量，无参数方法一次性执行即可，无需绑定，有参数的方法则需要每次参数改变就执行一次
            if (argExps.length > 0) {
                // 将表达式中所有undefined和null变为内部值
                var undefinedValue = Date.now() * Math.random() + "_undefined";
                var nullValue = Date.now() * Math.random() + "_null";
                argExps = argExps.map(function (exp) {
                    if (exp === undefined)
                        return "'" + undefinedValue + "'";
                    else if (exp === null)
                        return "'" + nullValue + "'";
                    else
                        return exp;
                });
                // 绑定表达式参数数组
                var initValue = {};
                var args = [];
                var argsInited = false;
                var handler = function (index, value) {
                    // 将value中的undefined和null恢复回去
                    if (value === undefinedValue)
                        value = undefined;
                    else if (value == nullValue)
                        value = null;
                    // 设置参数值
                    args[index] = value;
                    // 判断参数是否齐全
                    if (!argsInited) {
                        for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {
                            var arg = args_1[_i];
                            // 如果列表里存在初始值，表示没有赋值完毕，直接返回
                            if (arg === initValue)
                                return;
                        }
                        // 设置初始化完毕状态
                        argsInited = true;
                    }
                    // 赋值已经完毕了，调用方法，this指向ui本身
                    currentTarget[name].apply(currentTarget, args);
                };
                // 清理旧的订阅者
                for (var i = 0, len = watchers.length; i < len; i++) {
                    watchers.shift().dispose();
                }
                // 循环绑定表达式到handler
                for (var i = 0, len = argExps.length; i < len; i++) {
                    // 记录一个初始值，用于判断参数列表是否已赋值完毕
                    args.push(initValue);
                }
                for (var i = 0, len = argExps.length; i < len; i++) {
                    // 绑定表达式
                    var watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, argExps[i], handler.bind(_this, i), mediator.viewModel].concat(envModels, [mediator.viewModel]));
                    // 记录订阅者
                    watchers.push(watcher);
                }
            }
            else {
                // 无参数执行，无需绑定，一次性执行即可
                target[name]();
            }
        });
    };
    /**
     * 绑定事件
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} type 绑定的事件类型
     * @param {EvalExp} exp 绑定的事件回调表达式或方法
     * @memberof BindManager
     */
    BindManager.prototype.bindOn = function (mediator, currentTarget, target, envModels, type, exp) {
        var _this = this;
        this.addBindHandler(mediator, function () {
            var commonScope = {
                $this: mediator,
                $data: mediator.viewModel,
                $bridge: mediator.bridge,
                $currentTarget: currentTarget,
                $target: target
            };
            // 计算事件hash
            var onHash = Object(__WEBPACK_IMPORTED_MODULE_5__utils_ObjectUtil__["f" /* getObjectHashs */])(currentTarget, type, exp);
            // 如果之前添加过监听，则先移除之
            var handler = currentTarget[onHash];
            if (handler) {
                mediator.unmapListener(currentTarget, type, handler, mediator.viewModel);
                handler = null;
            }
            // 先尝试用exp当做方法名去viewModel里寻找，如果找不到则把exp当做一个执行表达式处理，外面包一层方法
            if (typeof exp === "string")
                handler = mediator.viewModel[exp];
            if (!(handler instanceof Function)) {
                var func = Object(__WEBPACK_IMPORTED_MODULE_9__Utils__["b" /* createRunFunc */])(exp, 3 + envModels.length);
                // 这里要转一手，记到闭包里一个副本，否则因为bindOn是延迟操作，到时envModel可能已被修改
                handler = function (event) {
                    func.call.apply(func, [this, commonScope].concat(envModels, [mediator.viewModel, { $event: event }]));
                };
            }
            mediator.mapListener(currentTarget, type, handler, mediator.viewModel);
            // 将事件回调记录到显示对象上
            currentTarget[onHash] = handler;
            // 如果__bind_sub_events__列表存在，则将事件记录到其上
            var nearestAncestor = _this.getNearestAncestor(mediator.bridge, target, "__bind_sub_events__");
            var events = (nearestAncestor || target).__bind_sub_events__;
            if (events) {
                events.push({
                    target: currentTarget,
                    type: type,
                    handler: handler,
                    thisArg: mediator.viewModel
                });
            }
        });
    };
    /**
     * 绑定显示
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {EvalExp} exp 绑定表达式或方法
     * @param {(value:boolean)=>void} [callback] 判断条件改变时会触发这个回调
     * @memberof BindManager
     */
    BindManager.prototype.bindIf = function (mediator, currentTarget, target, envModels, exp, callback) {
        var watcher;
        var bindData = this._bindDict.get(mediator);
        var replacer = mediator.bridge.createEmptyDisplay();
        this.addBindHandler(mediator, function () {
            var _a;
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 绑定表达式
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, exp, function (value) {
                    // 如果表达式为true则显示ui，否则移除ui
                    if (value)
                        Object(__WEBPACK_IMPORTED_MODULE_4__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, replacer, currentTarget);
                    else
                        Object(__WEBPACK_IMPORTED_MODULE_4__utils_DisplayUtil__["a" /* replaceDisplay */])(mediator.bridge, currentTarget, replacer);
                    // 触发回调
                    callback && callback(value);
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
        });
    };
    /**
     * 绑定循环
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {string} name 绑定本来所在的对象在Mediator中的名字
     * @param {BindForExpType} exp 循环表达式，形如："a in b"（表示a遍历b中的key）或"a of b"（表示a遍历b中的值）。b可以是个表达式。或者以三元组形式提供，如["a", "in", "b"]，其中b可以是表达式，也可以是求值方法
     * @param {IMediatorConstructor} [mediatorCls] 提供该参数将使用提供的中介者包装每一个渲染器
     * @param {IConstructor} [declaredCls] 声明的类型
     * @param {EvalExp} [dataExp] 提供给中介者包装器的数据表达式
     * @param {(data:any, renderer:any, envModels:any[])=>void} [callback] 每次生成新的renderer实例时调用这个回调
     * @memberof BindManager
     */
    BindManager.prototype.bindFor = function (mediator, currentTarget, target, envModels, name, exp, mediatorCls, declaredCls, dataExp, callback) {
        var _this = this;
        var watcher;
        var bindData = this._bindDict.get(mediator);
        var subTargetCache = [];
        var subMediatorCache = [];
        this.addBindHandler(mediator, function () {
            var _a;
            var expTuple;
            if (typeof exp === "string") {
                // 字符串形式，解析表达式
                var res = _this._regExp.exec(exp);
                if (!res)
                    return;
                expTuple = [res[1], res[2], res[5]];
            }
            else {
                // 元组形式，直接赋值
                expTuple = exp;
            }
            // 如果给出了声明的Mediator类型，则生成一个声明Mediator，替换掉mediator当前的皮肤
            var declaredMediator;
            if (Object(__WEBPACK_IMPORTED_MODULE_6__mediator_Mediator__["isMediator"])(declaredCls.prototype)) {
                declaredMediator = new declaredCls(target);
                mediator.delegateMediator(declaredMediator);
                mediator[name] = declaredMediator;
            }
            else if (declaredCls === Array) {
                if (mediatorCls) {
                    // 如果规定了变身中介者，则将该属性变成中介者列表
                    mediator[name] = subMediatorCache;
                }
                else {
                    // 否则变成渲染器对象列表
                    mediator[name] = subTargetCache;
                }
            }
            // 包装渲染器创建回调
            var memento = mediator.bridge.wrapBindFor(currentTarget, function (key, value, renderer) {
                // 设置环境变量
                var subScope = {
                    $key: key,
                    $value: value,
                    $parent: envModels[0] || mediator.viewModel
                };
                // 填入用户声明的属性
                subScope[expTuple[0]] = (expTuple[1] == "in" ? key : value);
                // 生成一个环境变量的副本
                var subEnvModels = envModels.concat();
                // 插入环境变量
                subEnvModels.unshift(subScope);
                // 如果renderer已经有事件列表了，说明renderer是被重用的，删除所有事件
                var events = renderer.__bind_sub_events__;
                for (var i in events) {
                    var data = events.pop();
                    mediator.unmapListener(data.target, data.type, data.handler, data.thisArg);
                }
                // 为renderer设置子对象事件列表
                if (!events)
                    renderer.__bind_sub_events__ = [];
                // 为renderer套一个Mediator外壳
                if (mediatorCls) {
                    var subMediator = new mediatorCls(renderer);
                    // 更新渲染器
                    if (subMediator.skin && subMediator.bridge === mediator.bridge)
                        renderer = subMediator.skin;
                    // 托管子中介者，优先托管在声明出来的中间中介者上
                    (declaredMediator || mediator).delegateMediator(subMediator);
                    // 设置通用属性
                    var commonScope = {
                        $this: mediator,
                        $data: mediator.viewModel,
                        $bridge: mediator.bridge,
                        $currentTarget: currentTarget,
                        $target: target
                    };
                    // 开启该中介者，优先使用dataExp，如果没有则使用当前所有的数据
                    var data_1;
                    if (dataExp) {
                        // 有数据表达式，求出数据表达式的值来
                        data_1 = __WEBPACK_IMPORTED_MODULE_9__Utils__["c" /* evalExp */].apply(void 0, [dataExp, mediator.viewModel].concat(subEnvModels.concat().reverse(), [mediator.viewModel, commonScope]));
                    }
                    else {
                        // 没有数据表达式，套用当前所在变量域，且要打平做成一个data
                        data_1 = __WEBPACK_IMPORTED_MODULE_5__utils_ObjectUtil__["b" /* extendObject */].apply(void 0, [{}, commonScope, mediator.viewModel].concat(subEnvModels));
                    }
                    subMediator.open(data_1);
                    // 缓存子中介者
                    subMediatorCache.push(subMediator);
                }
                else {
                    // 缓存渲染器对象
                    subTargetCache.push(renderer);
                }
                // 触发回调，进行内部编译
                callback && callback(value, renderer, subEnvModels);
            });
            // 如果之前绑定过，则要先销毁之
            if (watcher)
                watcher.dispose();
            // 获得要遍历的数据集合
            watcher = (_a = bindData.bind).createWatcher.apply(_a, [currentTarget, target, expTuple[2], function (datas) {
                    // 如果遍历的对象是个数字，则伪造一个临时数组供使用
                    if (typeof datas === "number") {
                        var tempArr = [];
                        for (var i = 0; i < datas; i++) {
                            tempArr.push(i);
                        }
                        datas = tempArr;
                    }
                    // 清空已有的子中介者
                    for (var i = 0, len = subMediatorCache.length; i < len; i++) {
                        var subMediator = subMediatorCache.shift();
                        mediator.undelegateMediator(subMediator);
                        subMediator.dispose();
                    }
                    // 赋值
                    mediator.bridge.valuateBindFor(currentTarget, datas, memento);
                }, mediator.viewModel].concat(envModels, [mediator.viewModel]));
        });
    };
    /**
     * 绑定Message
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {IConstructor|string} type 绑定的消息类型字符串
     * @param {string} name 绑定的属性名
     * @param {EvalExp} exp 绑定的表达式或方法
     * @param {IObservable} [observable] 绑定的消息内核，默认是core
     * @memberof BindManager
     */
    BindManager.prototype.bindMessage = function (mediator, currentTarget, target, envModels, type, name, exp, observable) {
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var handler = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (mediator.disposed) {
                // mediator已销毁，取消监听
                observable.unlisten(type, handler);
            }
            else {
                var msg;
                if (args.length == 1 && typeof args[0] == "object" && args[0].type)
                    msg = args[0];
                else
                    msg = { $arguments: args };
                // 设置通用属性
                var commonScope = {
                    $this: mediator,
                    $data: mediator.viewModel,
                    $bridge: mediator.bridge,
                    $currentTarget: currentTarget,
                    $target: target
                };
                currentTarget[name] = __WEBPACK_IMPORTED_MODULE_9__Utils__["c" /* evalExp */].apply(void 0, [exp, mediator.viewModel, msg].concat(envModels, [mediator.viewModel, commonScope]));
            }
        };
        // 添加监听
        observable.listen(type, handler);
    };
    /**
     * 绑定Response
     *
     * @param {IMediator} mediator 中介者
     * @param {*} currentTarget 绑定到的target实体对象
     * @param {*} target 绑定命令本来所在的对象
     * @param {any[]} envModels 环境变量数组
     * @param {IResponseDataConstructor|string} type 绑定的通讯消息类型
     * @param {string} name 绑定的属性名
     * @param {EvalExp} exp 绑定的表达式或方法
     * @param {IObservable} [observable] 绑定的消息内核，默认是core
     * @memberof BindManager
     */
    BindManager.prototype.bindResponse = function (mediator, currentTarget, target, envModels, type, name, exp, observable) {
        if (!observable)
            observable = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].observable;
        var handler = function (response) {
            if (mediator.disposed) {
                // mediator已销毁，取消监听
                __WEBPACK_IMPORTED_MODULE_7__net_NetManager__["netManager"].unlistenResponse(type, handler, null, null, observable);
            }
            else {
                // 设置通用属性
                var commonScope = {
                    $this: mediator,
                    $data: mediator.viewModel,
                    $bridge: mediator.bridge,
                    $currentTarget: currentTarget,
                    $target: target
                };
                currentTarget[name] = __WEBPACK_IMPORTED_MODULE_9__Utils__["c" /* evalExp */].apply(void 0, [exp, mediator.viewModel, response].concat(envModels, [mediator.viewModel, commonScope]));
            }
        };
        // 添加监听
        __WEBPACK_IMPORTED_MODULE_7__net_NetManager__["netManager"].listenResponse(type, handler, null, null, observable);
        // 如果mediator所依赖的模块有初始化消息，则要额外触发初始化消息的绑定
        if (mediator["dependModuleInstance"]) {
            for (var _i = 0, _a = mediator["dependModuleInstance"].responses; _i < _a.length; _i++) {
                var response = _a[_i];
                handler(response);
            }
        }
    };
    BindManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], BindManager);
    return BindManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (BindManager);
/** 再额外导出一个单例 */
var bindManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(BindManager);


/***/ }),
/* 37 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = replaceDisplay;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-03-22
 * @modify date 2018-03-22
 *
 * 显示工具
*/
/**
 * 替换显示
 *
 * @export
 * @param {IBridge} bridge 要使用的桥
 * @param {*} current 被替换的显示
 * @param {*} target 替换成为的显示
 */
function replaceDisplay(bridge, current, target) {
    // 两个皮肤必须都是隶属桥的皮肤
    if (bridge.isMySkin(target) && bridge.isMySkin(current)) {
        var parent = bridge.getParent(current);
        if (parent) {
            var index = bridge.getChildIndex(parent, current);
            bridge.addChildAt(parent, target, index);
            bridge.removeChild(parent, current);
        }
    }
}


/***/ }),
/* 38 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ModuleOpenStatus; });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-01-30
 * @modify date 2018-01-30
 *
 * 该接口规定了中介者具有的模块部分功能
*/
var ModuleOpenStatus;
(function (ModuleOpenStatus) {
    ModuleOpenStatus[ModuleOpenStatus["Stop"] = 0] = "Stop";
    ModuleOpenStatus[ModuleOpenStatus["BeforeOpen"] = 1] = "BeforeOpen";
    ModuleOpenStatus[ModuleOpenStatus["AfterOpen"] = 2] = "AfterOpen";
})(ModuleOpenStatus || (ModuleOpenStatus = {}));


/***/ }),
/* 39 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return sceneManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__ = __webpack_require__(62);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__ = __webpack_require__(63);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__SceneMessage__ = __webpack_require__(40);






/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 弹窗管理器，包含切换场景、push场景、pop场景功能
*/
var SYNC_NAME = "SceneManager_sync";
var ChangeType;
(function (ChangeType) {
    ChangeType[ChangeType["Switch"] = 0] = "Switch";
    ChangeType[ChangeType["Push"] = 1] = "Push";
    ChangeType[ChangeType["Pop"] = 2] = "Pop";
})(ChangeType || (ChangeType = {}));
var SceneManager = /** @class */ (function () {
    function SceneManager() {
        this._sceneStack = [];
    }
    Object.defineProperty(SceneManager.prototype, "currentScene", {
        /**
         * 获取当前场景
         *
         * @readonly
         * @type {IScene}
         * @memberof SceneManager
         */
        get: function () {
            return this._sceneStack[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SceneManager.prototype, "activeCount", {
        /**
         * 获取活动场景个数
         *
         * @readonly
         * @type {number}
         * @memberof SceneManager
         */
        get: function () {
            return this._sceneStack.length;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取场景是否已经开启
     *
     * @param {IScene} scene 场景对象
     * @returns {boolean} 是否已经开启
     * @memberof SceneManager
     */
    SceneManager.prototype.isOpened = function (scene) {
        return (this._sceneStack.indexOf(scene) >= 0);
    };
    /**
     * 切换场景，替换当前场景，当前场景会被销毁
     *
     * @param {IScene} scene 要切换到的场景
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.switch = function (scene, data) {
        var _this = this;
        // 非空判断
        if (scene == null)
            return;
        // 如果切入的是第一个场景，则改用push操作
        if (this.activeCount == 0)
            return this.push(scene, data);
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */], ChangeType.Switch, function () {
            // 数据先行
            _this._sceneStack[0] = scene;
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_5__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
        });
        return scene;
    };
    /**
     * 推入场景，当前场景不会销毁，而是进入场景栈保存，以后可以通过popScene重新展现
     *
     * @param {IScene} scene 要推入的场景
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.push = function (scene, data) {
        var _this = this;
        // 非空判断
        if (scene == null)
            return scene;
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */], ChangeType.Push, function () {
            // 数据先行
            _this._sceneStack.unshift(scene);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_5__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
        });
        return scene;
    };
    /**
     * 弹出场景，当前场景会被销毁，当前位于栈顶的场景会重新显示
     *
     * @param {IScene} scene 要切换出的场景，如果传入的场景不是当前场景则仅移除指定场景，不会进行切换操作
     * @param {*} [data] 要携带给下一个场景的数据
     * @returns {IScene} 场景本体
     * @memberof SceneManager
     */
    SceneManager.prototype.pop = function (scene, data) {
        // 非空判断
        if (scene == null)
            return scene;
        // 同步执行
        Object(__WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__["b" /* wait */])(SYNC_NAME, this.doPop, this, scene, data);
        return scene;
    };
    SceneManager.prototype.doPop = function (scene, data) {
        var _this = this;
        // 如果没有足够的场景储备则什么都不做
        if (this.activeCount <= 1) {
            console.log("场景栈中的场景数量不足，无法执行pop操作");
            // 完成步骤
            Object(__WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__["a" /* notify */])(SYNC_NAME);
            return;
        }
        // 验证是否是当前场景，不是则直接移除，不使用Policy
        var to = this._sceneStack[1];
        var policy = scene.policy || scene.bridge.defaultScenePolicy || __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */];
        if (this._sceneStack.indexOf(scene) != 0) {
            to = null;
            policy = __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */];
        }
        // 执行切换
        this.doChange(scene, to, data, policy, ChangeType.Pop, function () {
            // 数据先行
            _this._sceneStack.splice(_this._sceneStack.indexOf(scene), 1);
            // 派发消息
            __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_5__SceneMessage__["a" /* default */].SCENE_STACK_CHANGE);
        });
    };
    SceneManager.prototype.doChange = function (from, to, data, policy, type, begin, complete) {
        // 如果from和to有一个为null则policy为none
        if (!from || !to)
            policy = __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */];
        // to指定的场景必须要显示
        if (to)
            to.bridge.htmlWrapper.style.display = "";
        // 如果要交替的两个场景不是同一个类型的场景，则切换HTMLWrapper显示，且Policy也采用无切换策略
        if (from && to && to.bridge.type != from.bridge.type) {
            from.bridge.htmlWrapper.style.display = "none";
            policy = __WEBPACK_IMPORTED_MODULE_4__NoneScenePolicy__["a" /* default */];
        }
        // 调用回调
        begin && begin();
        // 获取接口引用
        var prepareFunc;
        var doFunc;
        switch (type) {
            case ChangeType.Switch:
                prepareFunc = policy.prepareSwitch;
                doFunc = policy.switch;
                break;
            case ChangeType.Push:
                prepareFunc = policy.preparePush || policy.prepareSwitch;
                doFunc = policy.push || policy.switch;
                break;
            case ChangeType.Pop:
                prepareFunc = policy.preparePop || policy.prepareSwitch;
                doFunc = policy.pop || policy.switch;
                break;
        }
        // 前置处理
        to && from && from.onBeforeOut(to, data);
        to && to.onBeforeIn(from, data);
        // 派发事件
        to && __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_5__SceneMessage__["a" /* default */].SCENE_BEFORE_CHANGE, to, from);
        // 调用准备接口
        prepareFunc && prepareFunc.call(policy, from, to);
        // 添加显示
        to && to.bridge.addChild(to.bridge.sceneLayer, to.skin);
        // 调用切换接口
        doFunc.call(policy, from, to, function () {
            // 完成步骤
            Object(__WEBPACK_IMPORTED_MODULE_3__utils_SyncUtil__["a" /* notify */])(SYNC_NAME);
            // 移除显示
            to && from && from.bridge.removeChild(from.bridge.sceneLayer, from.skin);
            // 后置处理
            to && from && from.onAfterOut(to, data);
            to && to.onAfterIn(from, data);
            // 派发事件
            to && __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_5__SceneMessage__["a" /* default */].SCENE_AFTER_CHANGE, to, from);
            // 调用回调
            complete && complete();
        });
    };
    SceneManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], SceneManager);
    return SceneManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (SceneManager);
/** 再额外导出一个单例 */
var sceneManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(SceneManager);


/***/ }),
/* 40 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 场景相关的消息
*/
var SceneMessage = /** @class */ (function () {
    function SceneMessage() {
    }
    /**
     * 切换场景前的消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_BEFORE_CHANGE = "sceneBeforeChange";
    /**
     * 切换场景后的消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_AFTER_CHANGE = "sceneAfterChange";
    /**
     * 场景栈数据变化消息
     *
     * @static
     * @type {string}
     * @memberof SceneMessage
     */
    SceneMessage.SCENE_STACK_CHANGE = "sceneStackChange";
    return SceneMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (SceneMessage);


/***/ }),
/* 41 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 表现层消息
*/
var BridgeMessage = /** @class */ (function () {
    function BridgeMessage() {
    }
    /**
     * 初始化表现层实例前的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_BEFORE_INIT = "bridgeBeforeInit";
    /**
     * 初始化表现层实例后的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_AFTER_INIT = "bridgeAfterInit";
    /**
     * 所有表现层实例都初始化完毕的消息
     *
     * @static
     * @type {string}
     * @memberof ViewMessage
     */
    BridgeMessage.BRIDGE_ALL_INIT = "bridgeAllInit";
    return BridgeMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (BridgeMessage);


/***/ }),
/* 42 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "commonData", function() { return commonData; });
var RequestData = /** @class */ (function () {
    function RequestData() {
        /**
         * 用户参数，可以保存任意参数到Message中，该参数中的数据不会被发送
         *
         * @type {*}
         * @memberof RequestData
         */
        this.__userData = {};
        /**
         * 是否在接到返回前使用loading类型遮罩覆盖全屏，防止用户操作，默认是true
         *
         * @type {boolean}
         * @memberof RequestData
         */
        this.__useMask = true;
        /**
         * 消息派发内核列表
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        this.__observables = [];
        // 禁掉部分本地变量的可遍历性
        Object.defineProperties(this, {
            __userData: {
                configurable: true,
                enumerable: false,
                writable: true,
                value: this.__userData
            },
            __observables: {
                configurable: true,
                enumerable: false,
                writable: true,
                value: this.__observables
            }
        });
    }
    Object.defineProperty(RequestData.prototype, "__observable", {
        /**
         * 消息当前所属内核
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        get: function () {
            return this.__observables[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RequestData.prototype, "__oriObservable", {
        /**
         * 消息所属的原始内核（第一个派发到的内核）
         *
         * @type {IObservable}
         * @memberof RequestData
         */
        get: function () {
            return this.__observables[this.__observables.length - 1];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RequestData.prototype, "__type", {
        /**
         * 获取请求消息类型字符串
         *
         * @readonly
         * @type {string}
         * @memberof RequestData
         */
        get: function () {
            return this.__params.type;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 再次发送消息，会使用首个内核重新发送该消息
     *
     * @memberof RequestData
     */
    RequestData.prototype.redispatch = function () {
        this.__oriObservable.dispatch(this);
    };
    return RequestData;
}());
/* harmony default export */ __webpack_exports__["default"] = (RequestData);
/** 导出公共消息参数对象 */
var commonData = {};


/***/ }),
/* 43 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Utils__ = __webpack_require__(23);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 数据更新订阅者，当依赖的数据有更新时会触发callback通知外面
*/
var Watcher = /** @class */ (function () {
    function Watcher(bind, currentTarget, target, exp, callback, thisArg) {
        var scopes = [];
        for (var _i = 6; _i < arguments.length; _i++) {
            scopes[_i - 6] = arguments[_i];
        }
        this._disposed = false;
        // 记录Bind实例
        this._bind = bind;
        // 记录作用目标、表达式和作用域
        this._currentTarget = currentTarget;
        this._target = target;
        this._exp = exp;
        this._thisArg = thisArg;
        this._scopes = scopes;
        // 将表达式和作用域解析为一个Function
        this._expFunc = Object(__WEBPACK_IMPORTED_MODULE_0__Utils__["a" /* createEvalFunc */])(exp, 1 + scopes.length);
        // 记录回调函数
        this._callback = callback;
        // 进行首次更新
        this.update();
    }
    Object.defineProperty(Watcher.prototype, "disposed", {
        /**
         * 获取该观察者是否已经被销毁
         *
         * @readonly
         * @type {boolean}
         * @memberof Watcher
         */
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取到表达式当前最新值
     * @returns {any} 最新值
     */
    Watcher.prototype.getValue = function () {
        var _a;
        if (this._disposed)
            return null;
        var value;
        // 记录自身
        Watcher.updating = this;
        // 设置通用属性
        var commonScope = {
            $this: this._bind.mediator,
            $data: this._bind.mediator.viewModel,
            $bridge: this._bind.mediator.bridge,
            $currentTarget: this._currentTarget,
            $target: this._target
        };
        // 表达式求值
        value = (_a = this._expFunc).call.apply(_a, [this._thisArg].concat(this._scopes, [commonScope]));
        // 移除自身记录
        Watcher.updating = null;
        return value;
    };
    /**
     * 当依赖的数据有更新时调用该方法
     * @param extra 可能的额外数据
     */
    Watcher.prototype.update = function (extra) {
        if (this._disposed)
            return;
        var value = this.getValue();
        if (!Watcher.isEqual(value, this._value)) {
            this._callback && this._callback(value, this._value, extra);
            this._value = Watcher.deepCopy(value);
        }
    };
    /** 销毁订阅者 */
    Watcher.prototype.dispose = function () {
        if (this._disposed)
            return;
        this._value = null;
        this._bind = null;
        this._currentTarget = null;
        this._target = null;
        this._thisArg = null;
        this._exp = null;
        this._scopes = null;
        this._expFunc = null;
        this._callback = null;
        this._disposed = true;
    };
    /**
     * 是否相等，包括基础类型和对象/数组的对比
     */
    Watcher.isEqual = function (a, b) {
        return (a == b || (Watcher.isObject(a) && Watcher.isObject(b)
            ? JSON.stringify(a) == JSON.stringify(b)
            : false));
    };
    /**
     * 是否为对象(包括数组、正则等)
     */
    Watcher.isObject = function (obj) {
        return (obj && typeof obj == "object");
    };
    /**
     * 复制对象，若为对象则深度复制
     */
    Watcher.deepCopy = function (from) {
        if (Watcher.isObject(from)) {
            try {
                // 复杂类型对象，先字符串化，再对象化
                return JSON.parse(JSON.stringify(from));
            }
            catch (err) { }
        }
        // 基本类型对象和无法复制的对象，直接返回之
        return from;
    };
    /** 记录当前正在执行update方法的Watcher引用 */
    Watcher.updating = null;
    Watcher._uid = 0;
    return Watcher;
}());
/* harmony default export */ __webpack_exports__["a"] = (Watcher);


/***/ }),
/* 44 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__DataType__ = __webpack_require__(45);


var ResponseData = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](ResponseData, _super);
    function ResponseData() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return ResponseData;
}(__WEBPACK_IMPORTED_MODULE_1__DataType__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (ResponseData);


/***/ }),
/* 45 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 请求或返回数据结构体
*/
var DataType = /** @class */ (function () {
    function DataType() {
    }
    /**
     * 解析后端返回的JSON对象，生成结构体
     *
     * @param {any} data 后端返回的JSON对象
     * @returns {DataType} 结构体对象
     * @memberof DataType
     */
    DataType.prototype.parse = function (data) {
        this.__rawData = this.doParse(data);
        return this;
    };
    return DataType;
}());
/* harmony default export */ __webpack_exports__["default"] = (DataType);


/***/ }),
/* 46 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__AudioMessage__ = __webpack_require__(47);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 使用Audio标签实现IAudio接口的实现类
*/
var AudioTagImpl = /** @class */ (function () {
    function AudioTagImpl() {
        this._disposed = false;
        this._mute = false;
        this._playingDict = {};
        this._audioCache = {};
    }
    Object.defineProperty(AudioTagImpl.prototype, "disposed", {
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioTagImpl.prototype, "mute", {
        /**
         * 静音状态
         *
         * @type {boolean}
         * @memberof AudioTagImpl
         */
        get: function () {
            return this._mute;
        },
        set: function (value) {
            this._mute = value;
            // 静音，暂停所有声音
            for (var url in this._playingDict) {
                if (value) {
                    // 静音，停止音频，不可调用stop方法，因为要保持播放中的音频状态
                    this._doStop(url);
                }
                else {
                    // 非静音，播放音频
                    var params = this._playingDict[url];
                    this.play(params);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    AudioTagImpl.prototype.listenProgress = function (data) {
        data.node.ontimeupdate = function (evt) {
            // 只有播放状态可以派发PROGRESS事件
            if (data.status == AudioStatus.PLAYING) {
                // 我们规定使用毫秒值作为单位
                var curTime = data.node.currentTime * 1000;
                var totalTime = data.node.duration * 1000;
                // 派发播放进度事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_PROGRESS, data.playParams.url, curTime, totalTime);
            }
        };
    };
    /**
     * 加载音频
     *
     * @param {string} url 音频地址
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.load = function (url) {
        var _this = this;
        var toUrl = __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toCDNHostURL(url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        // 如果没有缓存才去加载
        if (!data) {
            // 派发加载开始事件
            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_LOAD_STARTED, url);
            // 使用Audio标签加载
            var node = document.createElement("audio");
            // 这里强制使用autoplay，因为在IOS的safari上如果没这个参数，则根本不会触发onloadeddata事件
            node.autoplay = true;
            node.src = toUrl;
            // 保存数据
            this._audioCache[toUrl] = data = { node: node, status: AudioStatus.LOADING, playParams: null };
            // 监听加载
            node.onloadeddata = function () {
                // 记录加载完毕
                data.status = AudioStatus.PAUSED;
                // 派发加载完毕事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_LOAD_ENDED, url);
                // 如果不自动播放则暂停
                if (!data.playParams) {
                    node.pause();
                }
                else {
                    var params = data.playParams;
                    // 设置状态
                    data.status = AudioStatus.PLAYING;
                    // 记录播放中
                    _this._playingDict[toUrl] = params;
                    // 派发播放开始事件
                    __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_STARTED, params.url);
                    // 监听播放进度
                    _this.listenProgress(data);
                }
            };
            node.onended = function () {
                // 设置状态
                data.status = AudioStatus.PAUSED;
                // 派发播放完毕事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_ENDED, url);
                // 如果循环则再开
                if (data.playParams.loop)
                    _this.play(data.playParams);
            };
            node.onerror = function (evt) {
                //派发错误事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_ERROR, url, evt);
            };
        }
    };
    /**
     * 播放音频，如果音频没有加载则先加载再播放
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @returns {void}
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.play = function (params) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toCDNHostURL(params.url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        if (!data) {
            // 没有加载过，开始加载音频
            this.load(params.url);
            // 设置播放参数
            this._audioCache[toUrl].playParams = params;
        }
        else {
            switch (data.status) {
                case AudioStatus.LOADING:
                    // 正在加载中，替换自动播放参数
                    data.playParams = params;
                    break;
                case AudioStatus.PLAYING:
                    // 正在播放，关闭后再播放
                    this.stop(params.url);
                    this.play(params);
                    break;
                case AudioStatus.PAUSED:
                    // 已经加载完毕，暂停中，直接播放
                    data.playParams = params;
                    if (params.stopOthers)
                        this.stopAll();
                    if (params.loop != null)
                        data.node.loop = params.loop;
                    if (params.time != null)
                        data.node.currentTime = params.time * 0.001;
                    // 监听播放进度
                    this.listenProgress(data);
                    // 开始播放，safari不支持直接play(WTF?)所以要用autoplay加load进行播放
                    data.node.autoplay = true;
                    data.node.load();
                    // 设置状态
                    data.status = AudioStatus.PLAYING;
                    // 记录播放中
                    this._playingDict[toUrl] = params;
                    // 派发播放开始事件
                    __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_STARTED, params.url);
                    break;
            }
        }
    };
    AudioTagImpl.prototype._doStop = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            data.node.autoplay = false;
            data.node.pause();
            // 设置停止时间
            if (time != null)
                data.node.currentTime = time * 0.001;
            // 设置状态
            data.status = AudioStatus.PAUSED;
            // 派发播放停止事件
            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_2__AudioMessage__["a" /* default */].AUDIO_PLAY_STOPPED, url);
        }
    };
    /**
     * 暂停音频（不会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.pause = function (url) {
        this._doStop(url);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止音频（会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.stop = function (url) {
        this._doStop(url, 0);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止所有音频
     *
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.stopAll = function () {
        for (var url in this._audioCache) {
            this.stop(url);
        }
    };
    /**
     * 跳转音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioTagImpl
     */
    AudioTagImpl.prototype.seek = function (url, time) {
        var data = this._audioCache[url];
        if (data)
            data.node.currentTime = time * 0.001;
    };
    AudioTagImpl.prototype.dispose = function () {
        if (!this._disposed) {
            this.stopAll();
            this._disposed = true;
        }
    };
    return AudioTagImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioTagImpl);
var AudioStatus;
(function (AudioStatus) {
    /**
     * 加载中
     */
    AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
    /**
     * 已暂停
     */
    AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
    /**
     * 播放中
     */
    AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
})(AudioStatus || (AudioStatus = {}));


/***/ }),
/* 47 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 音频消息
*/
var AudioMessage = /** @class */ (function () {
    function AudioMessage() {
    }
    /**
     * 音频加载开始事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_LOAD_STARTED = "audioLoadStarted";
    /**
     * 音频加载完毕事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_LOAD_ENDED = "audioLoadEnded";
    /**
     * 音频播放开始事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_STARTED = "audioPlayStarted";
    /**
     * 音频播放停止事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_STOPPED = "audioPlayStopped";
    /**
     * 音频播放完毕事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_ENDED = "audioPlayEnded";
    /**
     * 音频播放进度事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_PLAY_PROGRESS = "audioPlayProgress";
    /**
     * 音频错误事件
     *
     * @static
     * @type {string}
     * @memberof AudioMessage
     */
    AudioMessage.AUDIO_ERROR = "audioError";
    return AudioMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioMessage);


/***/ }),
/* 48 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-01-08
 * @modify date 2018-01-08
 *
 * 引擎消息类型
*/
var EngineMessage = /** @class */ (function () {
    function EngineMessage() {
    }
    /**
     * 引擎初始化完毕消息
     *
     * @static
     * @type {string}
     * @memberof EngineMessage
     */
    EngineMessage.INITIALIZED = "initialized";
    return EngineMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (EngineMessage);


/***/ }),
/* 49 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(50), __webpack_require__(9)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Hash_1, Injector_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var IFuckModel = /** @class */ (function () {
        function IFuckModel() {
        }
        Object.defineProperty(IFuckModel.prototype, "fuck", {
            get: function () {
                return null;
            },
            enumerable: true,
            configurable: true
        });
        return IFuckModel;
    }());
    exports.IFuckModel = IFuckModel;
    var FuckModel = /** @class */ (function () {
        function FuckModel() {
            this._fuck = "Fuck";
            this.shit = "Shit";
            console.log("Fuck Model Constructed!");
        }
        Object.defineProperty(FuckModel.prototype, "fuck", {
            get: function () {
                return this._fuck;
            },
            set: function (value) {
                this._fuck = value;
            },
            enumerable: true,
            configurable: true
        });
        FuckModel.prototype.fuckYou = function () {
            return "Oye!";
        };
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", Hash_1.default)
        ], FuckModel.prototype, "hash", void 0);
        FuckModel = __decorate([
            Injector_2.ModelClass(1, IFuckModel),
            __metadata("design:paramtypes", [])
        ], FuckModel);
        return FuckModel;
    }());
    exports.default = FuckModel;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRnVja01vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiRnVja01vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztJQUlBO1FBQUE7UUFNQSxDQUFDO1FBSkcsc0JBQVcsNEJBQUk7aUJBQWY7Z0JBRUksT0FBTyxJQUFJLENBQUM7WUFDaEIsQ0FBQzs7O1dBQUE7UUFDTCxpQkFBQztJQUFELENBQUMsQUFORCxJQU1DO0lBTlksZ0NBQVU7SUFTdkI7UUFpQkk7WUFaUSxVQUFLLEdBQVUsTUFBTSxDQUFDO1lBVXZCLFNBQUksR0FBVSxNQUFNLENBQUM7WUFJeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1FBQzNDLENBQUM7UUFkRCxzQkFBVywyQkFBSTtpQkFBZjtnQkFFSSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDdEIsQ0FBQztpQkFDRCxVQUFnQixLQUFZO2dCQUV4QixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztZQUN2QixDQUFDOzs7V0FKQTtRQWFNLDJCQUFPLEdBQWQ7WUFFSSxPQUFPLE1BQU0sQ0FBQztRQUNsQixDQUFDO1FBdEJEO1lBREMsaUJBQU07c0NBQ00sY0FBSTsrQ0FBQztRQUhELFNBQVM7WUFEN0IscUJBQVUsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDOztXQUNMLFNBQVMsQ0EwQjdCO1FBQUQsZ0JBQUM7S0FBQSxBQTFCRCxJQTBCQztzQkExQm9CLFNBQVMifQ==

/***/ }),
/* 50 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "hash", function() { return hash; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * Hash类是地址路由（网页哈希）管理器，规定哈希格式为：#[模块名]?[参数名]=[参数值]&[参数名]=[参数值]&...
*/
var Hash = /** @class */ (function () {
    function Hash() {
        this._keepHash = false;
        this._hash = window.location.hash;
        this._moduleDataDict = {};
        this._moduleDatas = [];
        var reg = /#([^\?&#]+)?(\?([^\?&=#]+=[^\?&=#]+)(&([^\?&=#]+=[^\?&=#]+))*)?/g;
        var result;
        while (result = reg.exec(this._hash)) {
            var data = {
                name: result[1],
                params: {},
                direct: false
            };
            // 解析模块参数
            var paramsStr = result[2];
            if (paramsStr != null) {
                paramsStr = paramsStr.substr(1);
                var params = paramsStr.split("&");
                for (var i = 0, len = params.length; i < len; i++) {
                    var pair = params[i];
                    if (pair != null) {
                        var temp = pair.split("=");
                        // 键和值都要做一次URL解码
                        var key = decodeURIComponent(temp[0]);
                        var value = decodeURIComponent(temp[1]);
                        data.params[key] = value;
                    }
                }
            }
            // 处理direct参数
            data.direct = (data.params.direct == "true");
            delete data.params.direct;
            // 处理keepHash参数
            this._keepHash = this._keepHash || (data.params.keepHash == "true");
            delete data.params.keepHash;
            // 记录模块跳转数据
            this._moduleDataDict[data.name] = data;
            this._moduleDatas.push(data);
        }
        // 如果keepHash不是true，则移除哈希值
        if (!this._keepHash) {
            // 要使用window.location.replace方法，不能直接设置hash属性，否则会产生历史记录
            var url = window.location.href;
            var index = url.indexOf("#");
            if (index >= 0)
                window.location.replace(url.substr(0, index + 1));
        }
    }
    Object.defineProperty(Hash.prototype, "hash", {
        /**
         * 获取原始的哈希字符串
         *
         * @readonly
         * @type {string}
         * @memberof Hash
         */
        get: function () {
            return this._hash;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "moduleDatas", {
        /**
         * 获取模块跳转数据数组
         *
         * @readonly
         * @type {IHashModuleData[]}
         * @memberof Hash
         */
        get: function () {
            return this._moduleDatas;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "firstModuleParams", {
        /**
         * 获取传递给首模块的参数，首模块数据的传递方式为位于第一个#后且不填写模块名
         *
         * @readonly
         * @type {*}
         * @memberof Hash
         */
        get: function () {
            var data = this._moduleDatas[0];
            if (!data)
                return undefined;
            // 如果传递的第一个模块有名字，则不认为是传递给首模块的
            return (data.name ? undefined : data.params);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Hash.prototype, "keepHash", {
        /**
         * 获取是否保持哈希值
         *
         * @readonly
         * @type {boolean}
         * @memberof Hash
         */
        get: function () {
            return this._keepHash;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 获取指定哈希参数
     *
     * @param {string} key 参数名
     * @param {string} [moduleName] 参数所属模块名，不传则获取第一个模块的参数
     * @returns {string} 参数值
     * @memberof Hash
     */
    Hash.prototype.getParam = function (key, moduleName) {
        var data = (moduleName ? this._moduleDataDict[moduleName] : this._moduleDatas[0]);
        return (data && data.params[key]);
    };
    Hash = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["e" /* __metadata */]("design:paramtypes", [])
    ], Hash);
    return Hash;
}());
/* harmony default export */ __webpack_exports__["default"] = (Hash);
/** 再额外导出一个单例 */
var hash = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Hash);


/***/ }),
/* 51 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(77), __webpack_require__(44), __webpack_require__(14)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Test_1, ResponseData_1, NetManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var TestResponse = /** @class */ (function (_super) {
        __extends(TestResponse, _super);
        function TestResponse() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Object.defineProperty(TestResponse.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    protocol: "http",
                    method: "GET"
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        TestResponse.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.__params.success = data.success;
            this.test = new Test_1.default().parse(data.test);
        };
        TestResponse.prototype.pack = function () {
            return {
                test: this.test.pack()
            };
        };
        TestResponse.type = "Test";
        return TestResponse;
    }(ResponseData_1.default));
    exports.default = TestResponse;
    /** 注册返回体 */
    NetManager_1.netManager.registerResponse(TestResponse);
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJlc3BvbnNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdFJlc3BvbnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7SUFJQTs7Ozs7O01BTUU7SUFDRjtRQUEwQyxnQ0FBWTtRQUF0RDs7UUFrQ0EsQ0FBQztRQXhCRyxzQkFBVyxrQ0FBUTtpQkFBbkI7Z0JBRUksT0FBTztvQkFDSCxJQUFJLEVBQUUsTUFBTTtvQkFDWixRQUFRLEVBQUUsTUFBTTtvQkFDaEIsTUFBTSxFQUFFLEtBQUs7aUJBQ2hCLENBQUM7WUFDTixDQUFDOzs7V0FBQTtRQUFBLENBQUM7UUFJUSw4QkFBTyxHQUFqQixVQUFrQixJQUFRO1lBRXRCLElBQUcsSUFBSSxJQUFJLElBQUk7Z0JBQUUsT0FBTztZQUN4QixJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ3JDLElBQUksQ0FBQyxJQUFJLEdBQVMsSUFBSSxjQUFJLEVBQUUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2xELENBQUM7UUFFTSwyQkFBSSxHQUFYO1lBRUksT0FBTztnQkFDSCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7YUFDekIsQ0FBQztRQUNOLENBQUM7UUFkYSxpQkFBSSxHQUFVLE1BQU0sQ0FBQztRQWV2QyxtQkFBQztLQUFBLEFBbENELENBQTBDLHNCQUFZLEdBa0NyRDtzQkFsQ29CLFlBQVk7SUFvQ2pDLFlBQVk7SUFDWix1QkFBVSxDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxDQUFDIn0=

/***/ }),
/* 52 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(15), __webpack_require__(9), __webpack_require__(53), __webpack_require__(79), __webpack_require__(10)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, SceneMediator_1, Injector_1, Injector_2, TestComp_1, ModuleManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试第二个模块
    */
    var Second = /** @class */ (function (_super) {
        __extends(Second, _super);
        function Second() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Second.prototype.listAssets = function () {
            return ["preload"];
        };
        Second.prototype.onOpen = function () {
            var _this = this;
            this.mapListener(this.btn, egret.TouchEvent.TOUCH_TAP, function () {
                // moduleManager.close(Second);
                _this.dispatch("FuckMsg", "Shit!!!");
            });
            this.viewModel = {
                onMsg: function (msg) {
                    // 表达式里使用函数可以在函数里执行复杂逻辑，并且具有代码提示
                    console.log(msg);
                    ModuleManager_1.moduleManager.close(_this);
                    return msg + " - 1";
                },
                fuck: "you",
                fuckList: ["fuck", "shit", "you", "!!!"]
            };
            // 测试消息
            this.dispatch("fuck", 123);
        };
        Second.prototype.onFuck = function (a) {
            console.log("message at Second: " + a);
        };
        Second.prototype.onTestCompMsg = function () {
            console.log("TestCompMsg Received");
        };
        Second.prototype.onTestCompMsgGlobal = function () {
            console.log("TestCompMsg Received Global");
        };
        Second.moduleName = "Second";
        __decorate([
            Injector_1.SubMediator,
            __metadata("design:type", TestComp_1.default)
        ], Second.prototype, "_testComp", void 0);
        __decorate([
            Injector_1.BindMessage("FuckMsg", { label: "onMsg($arguments[0])" }),
            Injector_1.BindFunc("getCurrentState", ["fuck", "onMsg", undefined]),
            __metadata("design:type", eui.Button)
        ], Second.prototype, "btn", void 0);
        __decorate([
            Injector_1.BindFor("i of fuckList.concat(fuckList).concat(fuckList).concat(fuckList)"),
            Injector_1.BindValue("txt.text", function (scope) {
                return scope.i;
            }),
            Injector_1.BindFor("lst", "j of fuckList"),
            Injector_1.BindValue({
                txt: {
                    text: "'i=' + i + ' & ' + 'j=' + j"
                }
            }),
            __metadata("design:type", eui.DataGroup)
        ], Second.prototype, "lst", void 0);
        __decorate([
            Injector_1.MessageHandler("fuck"),
            Injector_1.GlobalMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onFuck", null);
        __decorate([
            Injector_1.MessageHandler("TestCompMsg"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", []),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onTestCompMsg", null);
        __decorate([
            Injector_1.GlobalMessageHandler("TestCompMsg"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", []),
            __metadata("design:returntype", void 0)
        ], Second.prototype, "onTestCompMsgGlobal", null);
        Second = __decorate([
            Injector_2.EgretMediatorClass("Second", "Fuck2Skin")
        ], Second);
        return Second;
    }(SceneMediator_1.default));
    exports.default = Second;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2Vjb25kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiU2Vjb25kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFNQTs7Ozs7OztNQU9FO0lBR0Y7UUFBb0MsMEJBQWE7UUFBakQ7O1FBa0VBLENBQUM7UUE1Q1UsMkJBQVUsR0FBakI7WUFFSSxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdkIsQ0FBQztRQUVNLHVCQUFNLEdBQWI7WUFBQSxpQkFtQkM7WUFqQkcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxVQUFVLENBQUMsU0FBUyxFQUFFO2dCQUNuRCwrQkFBK0I7Z0JBRS9CLEtBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ3hDLENBQUMsQ0FBQyxDQUFDO1lBQ0gsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDYixLQUFLLEVBQUUsVUFBQSxHQUFHO29CQUNOLGdDQUFnQztvQkFDaEMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztvQkFDakIsNkJBQWEsQ0FBQyxLQUFLLENBQUMsS0FBSSxDQUFDLENBQUM7b0JBQzFCLE9BQU8sR0FBRyxHQUFHLE1BQU0sQ0FBQztnQkFDeEIsQ0FBQztnQkFDRCxJQUFJLEVBQUUsS0FBSztnQkFDWCxRQUFRLEVBQUUsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUM7YUFDM0MsQ0FBQztZQUNGLE9BQU87WUFDUCxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztRQUMvQixDQUFDO1FBSU8sdUJBQU0sR0FBZCxVQUFlLENBQUM7WUFFWixPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzNDLENBQUM7UUFHTyw4QkFBYSxHQUFyQjtZQUVJLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUN4QyxDQUFDO1FBR08sb0NBQW1CLEdBQTNCO1lBRUksT0FBTyxDQUFDLEdBQUcsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1FBQy9DLENBQUM7UUEvRGEsaUJBQVUsR0FBVSxRQUFRLENBQUM7UUFHM0M7WUFEQyxzQkFBVztzQ0FDTSxrQkFBUTtpREFBQztRQUkzQjtZQUZDLHNCQUFXLENBQUMsU0FBUyxFQUFFLEVBQUMsS0FBSyxFQUFFLHNCQUFzQixFQUFDLENBQUM7WUFDdkQsbUJBQVEsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7c0NBQy9DLEdBQUcsQ0FBQyxNQUFNOzJDQUFDO1FBV3RCO1lBVkMsa0JBQU8sQ0FBQyxrRUFBa0UsQ0FBQztZQUMzRSxvQkFBUyxDQUFDLFVBQVUsRUFBRSxVQUFTLEtBQVM7Z0JBQ3JDLE9BQU8sS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNuQixDQUFDLENBQUM7WUFDRCxrQkFBTyxDQUFDLEtBQUssRUFBRSxlQUFlLENBQUM7WUFDL0Isb0JBQVMsQ0FBQztnQkFDUCxHQUFHLEVBQUU7b0JBQ0QsSUFBSSxFQUFFLDZCQUE2QjtpQkFDdEM7YUFDSixDQUFDO3NDQUNTLEdBQUcsQ0FBQyxTQUFTOzJDQUFDO1FBOEJ6QjtZQUZDLHlCQUFjLENBQUMsTUFBTSxDQUFDO1lBQ3RCLCtCQUFvQixDQUFDLE1BQU0sQ0FBQzs7Ozs0Q0FJNUI7UUFHRDtZQURDLHlCQUFjLENBQUMsYUFBYSxDQUFDOzs7O21EQUk3QjtRQUdEO1lBREMsK0JBQW9CLENBQUMsYUFBYSxDQUFDOzs7O3lEQUluQztRQWpFZ0IsTUFBTTtZQUQxQiw2QkFBa0IsQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDO1dBQ3JCLE1BQU0sQ0FrRTFCO1FBQUQsYUFBQztLQUFBLEFBbEVELENBQW9DLHVCQUFhLEdBa0VoRDtzQkFsRW9CLE1BQU0ifQ==

/***/ }),
/* 53 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["EgretSkin"] = EgretSkin;
/* harmony export (immutable) */ __webpack_exports__["EgretMediatorClass"] = EgretMediatorClass;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__ = __webpack_require__(9);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * 负责注入的模块
*/
function EgretSkin(skin) {
    return function (cls) {
        // 监听类型实例化，转换皮肤格式
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) { return mediator.skin = skin; });
    };
}
function EgretMediatorClass(moduleName, skin) {
    return function (cls) {
        // 调用MediatorClass方法
        cls = Object(__WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_injector_Injector__["MediatorClass"])(moduleName)(cls);
        // 监听类型实例化，转换皮肤格式
        Object(__WEBPACK_IMPORTED_MODULE_0_olympus_r_utils_ConstructUtil__["c" /* listenConstruct */])(cls, function (mediator) { return mediator.skin = skin; });
        // 返回结果类型
        return cls;
    };
}


/***/ }),
/* 54 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(9), __webpack_require__(81), __webpack_require__(19), __webpack_require__(10)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, PanelMediator_1, Injector_2, ModuleManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestPanel = /** @class */ (function (_super) {
        __extends(TestPanel, _super);
        function TestPanel() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TestPanel_1 = TestPanel;
        TestPanel.prototype.onOpen = function () {
            this.viewModel = {
                onClick: function () {
                    ModuleManager_1.moduleManager.close(TestPanel_1);
                }
            };
        };
        var TestPanel_1;
        TestPanel.moduleName = "TestPanel";
        __decorate([
            Injector_1.BindOn("click", "onClick"),
            __metadata("design:type", HTMLElement)
        ], TestPanel.prototype, "skin", void 0);
        TestPanel = TestPanel_1 = __decorate([
            Injector_2.DOMMediatorClass("TestPanel", "\n    <div style=\"background:#ffffff; width:400px; height: 250px;\">\n        jlk124kl1j2\n    </div>\n")
        ], TestPanel);
        return TestPanel;
    }(PanelMediator_1.default));
    exports.default = TestPanel;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFBhbmVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdFBhbmVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFVQTtRQUF1Qyw2QkFBYTtRQUFwRDs7UUFlQSxDQUFDO3NCQWZvQixTQUFTO1FBT25CLDBCQUFNLEdBQWI7WUFFSSxJQUFJLENBQUMsU0FBUyxHQUFHO2dCQUNiLE9BQU8sRUFBRTtvQkFDTCw2QkFBYSxDQUFDLEtBQUssQ0FBQyxXQUFTLENBQUMsQ0FBQztnQkFDbkMsQ0FBQzthQUNKLENBQUM7UUFDTixDQUFDOztRQVphLG9CQUFVLEdBQVUsV0FBVyxDQUFDO1FBRzlDO1lBREMsaUJBQU0sQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDO3NDQUNmLFdBQVc7K0NBQUM7UUFMUCxTQUFTO1lBTDdCLDJCQUFnQixDQUFDLFdBQVcsRUFBRSwwR0FJOUIsQ0FBQztXQUNtQixTQUFTLENBZTdCO1FBQUQsZ0JBQUM7S0FBQSxBQWZELENBQXVDLHVCQUFhLEdBZW5EO3NCQWZvQixTQUFTIn0=

/***/ }),
/* 55 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/// <reference types="olympus-r"/>
/// <reference types="olympus-r-dom"/>
/// <reference types="olympus-r-egret"/>
/// <reference path="./egret/libs/modules/egret/egret.d.ts"/>
/// <reference path="./egret/libs/modules/res/res.d.ts"/>
/// <reference path="./egret/libs/modules/eui/eui.d.ts"/>
/// <reference path="./egret/libs/modules/tween/tween.d.ts"/>
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(56), __webpack_require__(83), __webpack_require__(5), __webpack_require__(26), __webpack_require__(28)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, First_1, Olympus_1, Environment_1, DOMBridge_1, EgretBridge_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-08-31
     * @modify date 2017-09-01
     *
     * 测试项目
    */
    Olympus_1.default.startup({
        bridges: [
            new DOMBridge_1.default({
                container: "#rootDOM"
            }),
            new EgretBridge_1.default({
                width: 720,
                height: 1280,
                pathPrefix: "egret/",
                container: "#rootEgret",
                backgroundColor: 0,
            })
        ],
        firstModule: First_1.default,
        loadElement: "#loading",
        hostsDict: {
            dev: ["http://www.test.17zuoye.net/"],
            test: ["https://www.test.17zuoye.net/"],
            staging: ["https://www.staging.17zuoye.net/"],
            prod: ["https://www.17zuoye.com/"]
        },
        cdnsDict: {
            test: ["https://cdn-cnc.test.17zuoye.net/"],
            staging: ["https://cdn-cnc.staging.17zuoye.net/"],
            prod: ["https://cdn-cnc.17zuoye.com/"]
        },
        pathDict: {
            a: "test1.js",
            b: "test2.js"
        },
        preloads: ["a", "b"],
        onInited: function () {
            // bridgeManager.getBridge("Egret").defaultScenePolicy = none;
            console.log(Environment_1.environment.env, Environment_1.environment.getHost(), Environment_1.environment.curCDNHost);
        },
        onInitProgress: function (prg, step) {
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            console.log.apply(console, [prg, step].concat(args));
        }
    });
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm1haW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsa0NBQWtDO0FBQ2xDLHNDQUFzQztBQUN0Qyx3Q0FBd0M7QUFDeEMsNkRBQTZEO0FBQzdELHlEQUF5RDtBQUN6RCx5REFBeUQ7QUFDekQsNkRBQTZEOzs7O0lBVzdEOzs7Ozs7O01BT0U7SUFDRixpQkFBTyxDQUFDLE9BQU8sQ0FBQztRQUNaLE9BQU8sRUFBRTtZQUNMLElBQUksbUJBQVMsQ0FBQztnQkFDVixTQUFTLEVBQUUsVUFBVTthQUN4QixDQUFDO1lBQ0YsSUFBSSxxQkFBVyxDQUFDO2dCQUNaLEtBQUssRUFBRSxHQUFHO2dCQUNWLE1BQU0sRUFBRSxJQUFJO2dCQUNaLFVBQVUsRUFBRSxRQUFRO2dCQUNwQixTQUFTLEVBQUUsWUFBWTtnQkFDdkIsZUFBZSxFQUFFLENBQUM7YUFFckIsQ0FBQztTQUNMO1FBQ0QsV0FBVyxFQUFFLGVBQUs7UUFDbEIsV0FBVyxFQUFFLFVBQVU7UUFDdkIsU0FBUyxFQUFFO1lBQ1AsR0FBRyxFQUFFLENBQUMsOEJBQThCLENBQUM7WUFDckMsSUFBSSxFQUFFLENBQUMsK0JBQStCLENBQUM7WUFDdkMsT0FBTyxFQUFFLENBQUMsa0NBQWtDLENBQUM7WUFDN0MsSUFBSSxFQUFFLENBQUMsMEJBQTBCLENBQUM7U0FDckM7UUFDRCxRQUFRLEVBQUU7WUFDTixJQUFJLEVBQUUsQ0FBQyxtQ0FBbUMsQ0FBQztZQUMzQyxPQUFPLEVBQUUsQ0FBQyxzQ0FBc0MsQ0FBQztZQUNqRCxJQUFJLEVBQUUsQ0FBQyw4QkFBOEIsQ0FBQztTQUN6QztRQUNELFFBQVEsRUFBRTtZQUNOLENBQUMsRUFBRSxVQUFVO1lBQ2IsQ0FBQyxFQUFFLFVBQVU7U0FDaEI7UUFDRCxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ3BCLFFBQVEsRUFBRTtZQUVOLDhEQUE4RDtZQUM5RCxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUFXLENBQUMsR0FBRyxFQUFFLHlCQUFXLENBQUMsT0FBTyxFQUFFLEVBQUUseUJBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNoRixDQUFDO1FBQ0QsY0FBYyxFQUFFLFVBQUMsR0FBVSxFQUFFLElBQWE7WUFBRSxjQUFPO2lCQUFQLFVBQU8sRUFBUCxxQkFBTyxFQUFQLElBQU87Z0JBQVAsNkJBQU87O1lBQy9DLE9BQU8sQ0FBQyxHQUFHLE9BQVgsT0FBTyxHQUFLLEdBQUcsRUFBRSxJQUFJLFNBQUssSUFBSSxHQUFFO1FBQ3BDLENBQUM7S0FDSixDQUFDLENBQUMifQ==

/***/ }),
/* 56 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(19), __webpack_require__(2), __webpack_require__(73), __webpack_require__(9), __webpack_require__(10), __webpack_require__(17), __webpack_require__(15), __webpack_require__(49), __webpack_require__(76), __webpack_require__(51), __webpack_require__(52), __webpack_require__(80), __webpack_require__(82)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Injector_2, AudioManager_1, Injector_3, ModuleManager_1, ModuleMessage_1, SceneMediator_1, FuckModel_1, TestRequest_1, TestResponse_1, Second_1, TestForMediator_1, Third_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试首个模块
    */
    var First = /** @class */ (function (_super) {
        __extends(First, _super);
        function First() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        First_1 = First;
        First.prototype.listAssets = function () {
            return ["./modules/test.html"];
        };
        First.prototype.listJsFiles = function () {
            return ["test1.js", "./test2.js"];
        };
        First.prototype.onOpen = function () {
            var _this = this;
            // this.mapListener(this.btn, "click", function():void
            // {
            //     this.txt.textContent = "Fuck you!!!";
            //     this.moduleManager.open(Second);
            // }, this);
            console.log(this.fuckModel1.fuck, this.fuckModel1 === this.fuckModel2, this.fuckModel1 === this.fuckModel3);
            this.viewModel = {
                fuckList: [1, 2, "shit", "you"],
                fuckText: "fuck you",
                onClickBtn: function () {
                    _this.viewModel.fuckText = "clicked";
                    // this.moduleManager.open(Second);
                    new Second_1.default().open();
                },
                onClickFuck: function () {
                    _this.moduleManager.open(Third_1.default);
                },
                fuckModel: this.fuckModel1
            };
            AudioManager_1.audioManager.playMusic({
                url: "./test.mp3"
            });
            setTimeout(function () {
                _this.viewModel.fuckText = "1234";
                // this.viewModel.fuckList = ["hello", "world"];
                _this.viewModel.fuckList.push("jfksdjlf");
                _this.fuckModel1.fuck = "You!!!";
            }, 3000);
            this.dispatch(new TestRequest_1.default());
        };
        First.prototype.onModuleChange = function (to, from) {
            if (to == First_1)
                console.log("change to first module!");
            else if (to == Second_1.default)
                console.log("change to second module!");
        };
        First.prototype.onResponse = function (res, req) {
            alert("123");
        };
        First.prototype.onFuck = function (a) {
            console.log("message at FirstModule: " + a);
        };
        var First_1;
        First.moduleName = "First";
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", ModuleManager_1.default)
        ], First.prototype, "moduleManager", void 0);
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", FuckModel_1.default)
        ], First.prototype, "fuckModel1", void 0);
        __decorate([
            Injector_2.Inject,
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], First.prototype, "fuckModel2", void 0);
        __decorate([
            Injector_2.Inject(1),
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], First.prototype, "fuckModel3", void 0);
        __decorate([
            Injector_3.BindOn({ click: "onClickBtn" }),
            Injector_3.BindIf("fuckText == '1234'"),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "btn", void 0);
        __decorate([
            Injector_3.BindFor("fuck of fuckList", TestForMediator_1.default),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "txt", void 0);
        __decorate([
            Injector_3.BindOn("click", "onClickFuck"),
            Injector_3.BindValue("textContent", "fuckModel.fuck"),
            __metadata("design:type", HTMLElement)
        ], First.prototype, "fuck", void 0);
        __decorate([
            Injector_3.MessageHandler(ModuleMessage_1.default.MODULE_CHANGE),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object, Object]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onModuleChange", null);
        __decorate([
            Injector_3.ResponseHandler,
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [TestResponse_1.default, TestRequest_1.default]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onResponse", null);
        __decorate([
            Injector_3.MessageHandler("fuck"),
            Injector_3.GlobalMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], First.prototype, "onFuck", null);
        First = First_1 = __decorate([
            Injector_1.DOMMediatorClass("First", "./modules/test.html")
        ], First);
        return First;
    }(SceneMediator_1.default));
    exports.default = First;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRmlyc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJGaXJzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBY0E7Ozs7Ozs7TUFPRTtJQUdGO1FBQW1DLHlCQUFhO1FBQWhEOztRQXdGQSxDQUFDO2tCQXhGb0IsS0FBSztRQXNCZiwwQkFBVSxHQUFqQjtZQUVJLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFFTSwyQkFBVyxHQUFsQjtZQUVJLE9BQU8sQ0FBQyxVQUFVLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDdEMsQ0FBQztRQUVNLHNCQUFNLEdBQWI7WUFBQSxpQkFtQ0M7WUFqQ0csc0RBQXNEO1lBQ3RELElBQUk7WUFDSiw0Q0FBNEM7WUFDNUMsdUNBQXVDO1lBQ3ZDLFlBQVk7WUFDWixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxVQUFVLEtBQUssSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsVUFBVSxLQUFLLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUU1RyxJQUFJLENBQUMsU0FBUyxHQUFHO2dCQUNiLFFBQVEsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQztnQkFDL0IsUUFBUSxFQUFFLFVBQVU7Z0JBQ3BCLFVBQVUsRUFBRTtvQkFDUixLQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsR0FBRyxTQUFTLENBQUM7b0JBQ3BDLG1DQUFtQztvQkFDbkMsSUFBSSxnQkFBTSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ3hCLENBQUM7Z0JBQ0QsV0FBVyxFQUFFO29CQUNULEtBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLGVBQUssQ0FBQyxDQUFDO2dCQUNuQyxDQUFDO2dCQUNELFNBQVMsRUFBRSxJQUFJLENBQUMsVUFBVTthQUM3QixDQUFDO1lBRUYsMkJBQVksQ0FBQyxTQUFTLENBQUM7Z0JBQ25CLEdBQUcsRUFBRSxZQUFZO2FBQ3BCLENBQUMsQ0FBQztZQUVILFVBQVUsQ0FBQztnQkFDUCxLQUFJLENBQUMsU0FBUyxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUM7Z0JBQ2pDLGdEQUFnRDtnQkFDaEQsS0FBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO2dCQUN6QyxLQUFJLENBQUMsVUFBVSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUM7WUFDcEMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO1lBRVQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLHFCQUFXLEVBQUUsQ0FBQyxDQUFDO1FBQ3JDLENBQUM7UUFHTyw4QkFBYyxHQUF0QixVQUF1QixFQUFNLEVBQUUsSUFBUTtZQUVuQyxJQUFHLEVBQUUsSUFBSSxPQUFLO2dCQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUMsQ0FBQztpQkFDbEQsSUFBRyxFQUFFLElBQUksZ0JBQU07Z0JBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQ2xFLENBQUM7UUFHTywwQkFBVSxHQUFsQixVQUFtQixHQUFnQixFQUFFLEdBQWU7WUFFaEQsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2pCLENBQUM7UUFJTyxzQkFBTSxHQUFkLFVBQWUsQ0FBQztZQUVaLE9BQU8sQ0FBQyxHQUFHLENBQUMsMEJBQTBCLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDaEQsQ0FBQzs7UUFyRmEsZ0JBQVUsR0FBVSxPQUFPLENBQUM7UUFHMUM7WUFEQyxpQkFBTTtzQ0FDZSx1QkFBYTtvREFBQztRQUVwQztZQURDLGlCQUFNO3NDQUNZLG1CQUFTO2lEQUFDO1FBRTdCO1lBREMsaUJBQU07c0NBQ1ksc0JBQVU7aURBQUM7UUFFOUI7WUFEQyxpQkFBTSxDQUFDLENBQUMsQ0FBQztzQ0FDUyxzQkFBVTtpREFBQztRQUk5QjtZQUZDLGlCQUFNLENBQUMsRUFBQyxLQUFLLEVBQUUsWUFBWSxFQUFDLENBQUM7WUFDN0IsaUJBQU0sQ0FBQyxvQkFBb0IsQ0FBQztzQ0FDbEIsV0FBVzswQ0FBQTtRQUV0QjtZQURDLGtCQUFPLENBQUMsa0JBQWtCLEVBQUUseUJBQWUsQ0FBQztzQ0FDbEMsV0FBVzswQ0FBQztRQUd2QjtZQUZDLGlCQUFNLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQztZQUM5QixvQkFBUyxDQUFDLGFBQWEsRUFBRSxnQkFBZ0IsQ0FBQztzQ0FDL0IsV0FBVzsyQ0FBQztRQWtEeEI7WUFEQyx5QkFBYyxDQUFDLHVCQUFhLENBQUMsYUFBYSxDQUFDOzs7O21EQUszQztRQUdEO1lBREMsMEJBQWU7OzZDQUNPLHNCQUFZLEVBQU0scUJBQVc7OytDQUduRDtRQUlEO1lBRkMseUJBQWMsQ0FBQyxNQUFNLENBQUM7WUFDdEIsK0JBQW9CLENBQUMsTUFBTSxDQUFDOzs7OzJDQUk1QjtRQXZGZ0IsS0FBSztZQUR6QiwyQkFBZ0IsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUM7V0FDNUIsS0FBSyxDQXdGekI7UUFBRCxZQUFDO0tBQUEsQUF4RkQsQ0FBbUMsdUJBQWEsR0F3Ri9DO3NCQXhGb0IsS0FBSyJ9

/***/ }),
/* 57 */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || Function("return this")() || (1,eval)("this");
} catch(e) {
	// This works if the window reference is available
	if(typeof window === "object")
		g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),
/* 58 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Message__ = __webpack_require__(31);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-01
 * @modify date 2017-09-01
 *
 * 框架内核通用消息
*/
var CommonMessage = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](CommonMessage, _super);
    /**
     * Creates an instance of Message.
     * @param {string} type 消息类型
     * @param {...any[]} params 可能的消息参数列表
     * @memberof Message
     */
    function CommonMessage(type) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        var _this = _super.call(this, type) || this;
        _this.params = params;
        return _this;
    }
    return CommonMessage;
}(__WEBPACK_IMPORTED_MODULE_1__Message__["a" /* default */]));
/* harmony default export */ __webpack_exports__["a"] = (CommonMessage);


/***/ }),
/* 59 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ButtonType; });
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 通用弹窗的各种接口
*/
var ButtonType;
(function (ButtonType) {
    ButtonType[ButtonType["normal"] = 0] = "normal";
    ButtonType[ButtonType["important"] = 1] = "important";
})(ButtonType || (ButtonType = {}));


/***/ }),
/* 60 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export NonePanelPolicy */
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 无任何动画的弹出策略，可应用于任何显示层实现
*/
var NonePanelPolicy = /** @class */ (function () {
    function NonePanelPolicy() {
    }
    NonePanelPolicy.prototype.pop = function (panel, callback, from) {
        setTimeout(callback, 0);
    };
    NonePanelPolicy.prototype.drop = function (panel, callback, from) {
        setTimeout(callback, 0);
    };
    return NonePanelPolicy;
}());

/** 默认导出实例 */
/* harmony default export */ __webpack_exports__["a"] = (new NonePanelPolicy());


/***/ }),
/* 61 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * 弹窗相关的消息
*/
var PanelMessage = /** @class */ (function () {
    function PanelMessage() {
    }
    /**
     * 打开弹窗前的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_BEFORE_POP = "panelBeforePop";
    /**
     * 打开弹窗后的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_AFTER_POP = "panelAfterPop";
    /**
     * 关闭弹窗前的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_BEFORE_DROP = "panelBeforeDrop";
    /**
     * 关闭弹窗后的消息
     *
     * @static
     * @type {string}
     * @memberof PanelMessage
     */
    PanelMessage.PANEL_AFTER_DROP = "panelAfterDrop";
    return PanelMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (PanelMessage);


/***/ }),
/* 62 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export isOperating */
/* harmony export (immutable) */ __webpack_exports__["b"] = wait;
/* harmony export (immutable) */ __webpack_exports__["a"] = notify;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 同步工具集，用于对多个
*/
var _cache = {};
/**
 * 判断是否正在进行操作
 *
 * @export
 * @param {string} name 队列名
 * @returns {boolean} 队列是否正在操作
 */
function isOperating(name) {
    var ctx = _cache[name];
    return (ctx != null && ctx.operating);
}
/**
 * 开始同步操作，所有传递了相同name的操作会被以队列方式顺序执行
 *
 * @export
 * @param name 一个队列的名字
 * @param {Function} fn 要执行的方法
 * @param {*} [thisArg] 方法this对象
 * @param {...any[]} [args] 方法参数
 */
function wait(name, fn, thisArg) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    var ctx = _cache[name];
    if (ctx == null) {
        _cache[name] = ctx = { operating: false, datas: [] };
    }
    if (ctx.operating) {
        // 队列正在执行，推入缓存
        ctx.datas.push({ fn: fn, thisArg: thisArg, args: args });
    }
    else {
        // 队列没有在执行，直接执行
        ctx.operating = true;
        fn.apply(thisArg, args);
    }
}
/**
 * 完成一步操作并唤醒后续操作
 *
 * @export
 * @param {string} name 队列名字
 * @returns {void}
 */
function notify(name) {
    var ctx = _cache[name];
    if (ctx == null || ctx.datas.length <= 0) {
        // 队列执行完了，直接结束
        ctx.operating = false;
        return;
    }
    var data = ctx.datas.shift();
    data.fn.apply(data.thisArg, data.args);
}


/***/ }),
/* 63 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export NoneScenePolicy */
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-08
 * @modify date 2017-09-08
 *
 * 无任何动画的场景策略，可应用于任何显示层实现
*/
var NoneScenePolicy = /** @class */ (function () {
    function NoneScenePolicy() {
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    NoneScenePolicy.prototype.prepareSwitch = function (from, to) {
        // 这个策略里啥也不用准备
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    NoneScenePolicy.prototype.switch = function (from, to, callback) {
        // 直接延迟到下一帧回调（不能同步回调，否则可能会出问题）
        setTimeout(callback, 0);
    };
    return NoneScenePolicy;
}());

/** 默认导出实例 */
/* harmony default export */ __webpack_exports__["a"] = (new NoneScenePolicy());


/***/ }),
/* 64 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * 通讯相关的消息
*/
var NetMessage = /** @class */ (function () {
    function NetMessage() {
    }
    /**
     * 发送网络请求消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_REQUEST = "netRequest";
    /**
     * 接受网络返回消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_RESPONSE = "netResponse";
    /**
     * 网络请求错误消息
     *
     * @static
     * @type {string}
     * @memberof NetMessage
     */
    NetMessage.NET_ERROR = "netError";
    return NetMessage;
}());
/* harmony default export */ __webpack_exports__["a"] = (NetMessage);


/***/ }),
/* 65 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Watcher__ = __webpack_require__(43);


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 一个绑定
*/
var Bind = /** @class */ (function () {
    function Bind(mediator) {
        this._watcherDict = {};
        this._mediator = mediator;
    }
    Object.defineProperty(Bind.prototype, "mediator", {
        /**
         * 获取已绑定的中介者实例
         *
         * @readonly
         * @type {IMediator}
         * @memberof Bind
         */
        get: function () {
            return this._mediator;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 创建一个观察者，在数值变更时会通知回调进行更新
     *
     * @param {*} currentTarget 作用目标，指表达式所在的显示对象
     * @param {*} target 绑定表达式本来所在的对象
     * @param {EvalExp} exp 表达式或方法
     * @param {WatcherCallback} callback 订阅器回调
     * @param {*} thisArg this指向
     * @param {...any[]} scopes 作用域列表，最后一个作用域会被当做this指向
     * @returns {IWatcher} 返回观察者本身
     * @memberof Bind
     */
    Bind.prototype.createWatcher = function (currentTarget, target, exp, callback, thisArg) {
        var scopes = [];
        for (var _i = 5; _i < arguments.length; _i++) {
            scopes[_i - 5] = arguments[_i];
        }
        var key = __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["f" /* getObjectHashs */].apply(void 0, [currentTarget, exp, Object(__WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["d" /* getGUID */])()].concat(scopes));
        var watcher = this._watcherDict[key];
        if (!watcher)
            this._watcherDict[key] = watcher = new (__WEBPACK_IMPORTED_MODULE_1__Watcher__["a" /* default */].bind.apply(__WEBPACK_IMPORTED_MODULE_1__Watcher__["a" /* default */], [void 0, this, currentTarget, target, exp, callback, thisArg].concat(scopes)))();
        return watcher;
    };
    /**
     * 销毁绑定关系
     *
     * @memberof Bind
     */
    Bind.prototype.dispose = function () {
        for (var key in this._watcherDict) {
            var watcher = this._watcherDict[key];
            watcher.dispose();
            delete this._watcherDict[key];
        }
        this._mediator = null;
    };
    return Bind;
}());
/* harmony default export */ __webpack_exports__["a"] = (Bind);


/***/ }),
/* 66 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = mutate;
/* harmony export (immutable) */ __webpack_exports__["b"] = unmutate;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__ = __webpack_require__(4);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__Dep__ = __webpack_require__(67);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__Watcher__ = __webpack_require__(43);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 变异器，将ViewModel变异为具有依赖功能的形式，也可以认为是编译过程
*/
// 记录数组中会造成数据更新的所有方法名
var arrMethods = [
    "push",
    "pop",
    "unshift",
    "shift",
    "splice",
    "sort",
    "reverse"
];
/**
 * 将用户传进来的数据“变异”成为具有截获数据变更能力的数据
 * @param data 原始数据
 * @returns {any} 变异后的数据
 */
function mutate(data) {
    // 如果是简单类型，则啥也不做
    if (!data || typeof data != "object")
        return data;
    // 递归变异所有内部变量，及其__proto__下的属性，因为getter/setter会被定义在__proto__上，而不是当前对象上
    var keys = Object.keys(data).concat(Object.keys(data.__proto__ || {}));
    // 去重
    var temp = {};
    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {
        var key = keys_1[_i];
        if (!temp[key]) {
            temp[key] = key;
            // 递归变异
            mutateObject(data, key);
        }
    }
    return data;
}
/**
 * 反变异，将已经变异过的对象恢复原状
 *
 * @author Raykid
 * @date 2019-02-19
 * @export
 * @param {*} data
 * @returns {*}
 */
function unmutate(data) {
    // 如果是简单类型，则啥也不做
    if (!data || typeof data != "object")
        return data;
    // 递归变异所有内部变量，及其__proto__下的属性，因为getter/setter会被定义在__proto__上，而不是当前对象上
    var keys = Object.keys(data).concat(Object.keys(data.__proto__ || {}));
    // 去重
    var temp = {};
    for (var _i = 0, keys_2 = keys; _i < keys_2.length; _i++) {
        var key = keys_2[_i];
        if (!temp[key]) {
            temp[key] = key;
            // 递归反变异
            unmutateObject(data, key);
        }
    }
    return data;
}
function onGet(dep, result, mutateSub) {
    // 如果Watcher.updating不是null，说明当前正在执行表达式，那么获取的变量自然是其需要依赖的
    var watcher = __WEBPACK_IMPORTED_MODULE_2__Watcher__["a" /* default */].updating;
    if (watcher)
        dep.watch(watcher);
    // 首次获取需要变异
    if (mutateSub) {
        // 如果是数组就走专门的数组变异方法，否则递归变异对象
        if (Array.isArray(result))
            mutateArray(result, dep);
        else
            mutate(result);
    }
}
function onSet(dep, value) {
    // 如果是数组就走专门的数组变异方法，否则递归变异对象
    if (Array.isArray(value))
        mutateArray(value, dep);
    else
        mutate(value);
    // 触发通知
    dep.notify();
}
function mutateObject(data, key) {
    var depKey = Object(__WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["f" /* getObjectHashs */])(data, key);
    // 对每个复杂类型对象都要有一个对应的依赖列表
    var dep = data[depKey];
    var mutateSub = true;
    if (!dep) {
        dep = new __WEBPACK_IMPORTED_MODULE_1__Dep__["a" /* default */]();
        // 判断本来这个属性是值属性还是getter/setter属性，要有不同的操作方式
        var desc = Object.getOwnPropertyDescriptor(data, key) || Object.getOwnPropertyDescriptor(data.__proto__ || {}, key);
        if (desc) {
            // 开始变异当前属性
            if (desc.hasOwnProperty("value")) {
                // 值属性的变异过程
                Object.defineProperty(data, key, {
                    enumerable: true,
                    configurable: true,
                    get: function () {
                        // 利用闭包保存原始值
                        var result = desc.value;
                        // 执行处理
                        onGet(dep, result, mutateSub);
                        // 设置标记
                        mutateSub = false;
                        // 返回值
                        return result;
                    },
                    set: function (value) {
                        if (!desc.writable || value === desc.value)
                            return;
                        desc.value = value;
                        // 执行处理
                        onSet(dep, value);
                    }
                });
            }
            else {
                // getter/setter属性的变异过程
                Object.defineProperty(data, key, {
                    enumerable: true,
                    configurable: true,
                    get: function () {
                        if (!desc.get)
                            return;
                        // 获取get方法结果
                        var result = desc.get.call(data);
                        // 执行处理
                        onGet(dep, result, mutateSub);
                        // 设置标记
                        mutateSub = false;
                        // 返回值
                        return result;
                    },
                    set: function (value) {
                        if (!desc.set)
                            return;
                        // 设置
                        desc.set.call(data, value);
                        // 执行处理
                        onSet(dep, value);
                    }
                });
            }
        }
        // 打一个标记表示已经变异过了
        Object.defineProperty(data, depKey, {
            value: dep,
            writable: false,
            enumerable: false,
            configurable: true
        });
        Object.defineProperty(data, depKey + "|oriDesc", {
            value: desc,
            writable: false,
            enumerable: false,
            configurable: true
        });
    }
}
function unmutateObject(data, key) {
    var depKey = Object(__WEBPACK_IMPORTED_MODULE_0__utils_ObjectUtil__["f" /* getObjectHashs */])(data, key);
    // 对每个复杂类型对象都要有一个对应的依赖列表
    var dep = data[depKey];
    if (dep) {
        var target = data[key];
        // 深度优先递归反变异
        if (target instanceof Array) {
            unmutateArray(target, dep);
        }
        else {
            unmutate(target);
        }
        // 开始反变异自身
        var desc = data[depKey + "|oriDesc"];
        Object.defineProperty(data, key, desc);
        // 移除标记
        delete data[depKey];
        delete data[depKey + "|oriDesc"];
    }
}
function mutateArray(arr, dep) {
    // 变异当前数组
    Object.setPrototypeOf(arr, defineReactiveArray(dep));
    // 遍历当前数组，将内容对象全部变异
    for (var i = 0, len = arr.length; i < len; i++) {
        mutate(arr[i]);
    }
}
function unmutateArray(arr, dep) {
    // 遍历当前数组，将内容对象全部反变异
    for (var i = 0, len = arr.length; i < len; i++) {
        unmutate(arr[i]);
    }
    // 反变异当前数组
    Object.setPrototypeOf(arr, Array.prototype);
}
function defineReactiveArray(dep) {
    var proto = Array.prototype;
    var result = Object.create(proto);
    // 遍历所有方法，一个一个地变异
    arrMethods.forEach(function (method) {
        // 利用闭包记录一个原始方法
        var oriMethod = proto[method];
        // 开始变异
        Object.defineProperty(result, method, {
            value: function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                // 首先调用原始方法，获取返回值
                var result = oriMethod.apply(this, args);
                // 数组插入项
                var inserted;
                switch (method) {
                    case "push":
                    case "unshift":
                        inserted = args;
                        break;
                    case "splice":
                        inserted = args.slice(2);
                        break;
                }
                // 监视数组插入项，而不是重新监视整个数组
                if (inserted && inserted.length) {
                    mutateArray(inserted, dep);
                }
                // 触发更新
                dep.notify({ method: args });
                // 返回值
                return result;
            }
        });
    });
    // 提供替换数组设置的方法，因为直接设置数组下标的方式无法变异
    Object.defineProperty(result, "$set", {
        value: function (index, value) {
            // 超出数组长度默认追加到最后
            if (index >= this.length)
                index = this.length;
            return this.splice(index, 1, value)[0];
        }
    });
    // 提供替换数组移除的方法，因为直接移除的方式无法变异
    Object.defineProperty(result, "$remove", {
        value: function (item) {
            var index = this.indexOf(item);
            if (index > -1)
                return this.splice(index, 1);
            return null;
        }
    });
    return result;
}


/***/ }),
/* 67 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__ = __webpack_require__(3);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * 定义一个依赖，一个观察者实现
*/
var Dep = /** @class */ (function () {
    function Dep() {
        this._map = new __WEBPACK_IMPORTED_MODULE_0__utils_Dictionary__["a" /* default */]();
    }
    /**
     * 添加数据变更订阅者
     * @param watcher 数据变更订阅者
     */
    Dep.prototype.watch = function (watcher) {
        this._map.set(watcher, watcher);
    };
    /**
     * 数据变更，通知所有订阅者
     * @param extra 可能的额外数据
     */
    Dep.prototype.notify = function (extra) {
        var _this = this;
        this._map.forEach(function (watcher) {
            if (watcher.disposed)
                // 观察者已经销毁，移除监听
                _this._map.delete(watcher);
            else
                // 观察者依然生效，更新之
                watcher.update(extra);
        });
    };
    return Dep;
}());
/* harmony default export */ __webpack_exports__["a"] = (Dep);


/***/ }),
/* 68 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (immutable) */ __webpack_exports__["listenOnOpen"] = listenOnOpen;
/* harmony export (immutable) */ __webpack_exports__["searchUIDepth"] = searchUIDepth;
/* harmony export (immutable) */ __webpack_exports__["pushCompileCommand"] = pushCompileCommand;
/* harmony export (immutable) */ __webpack_exports__["unshiftCompileCommand"] = unshiftCompileCommand;
/* harmony export (immutable) */ __webpack_exports__["compile"] = compile;
/* harmony export (immutable) */ __webpack_exports__["compileValue"] = compileValue;
/* harmony export (immutable) */ __webpack_exports__["compileExp"] = compileExp;
/* harmony export (immutable) */ __webpack_exports__["compileFunc"] = compileFunc;
/* harmony export (immutable) */ __webpack_exports__["compileOn"] = compileOn;
/* harmony export (immutable) */ __webpack_exports__["compileIf"] = compileIf;
/* harmony export (immutable) */ __webpack_exports__["compileFor"] = compileFor;
/* harmony export (immutable) */ __webpack_exports__["compileMessage"] = compileMessage;
/* harmony export (immutable) */ __webpack_exports__["compileResponse"] = compileResponse;
/* harmony export (immutable) */ __webpack_exports__["searchUI"] = searchUI;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ConstructUtil__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__ = __webpack_require__(36);



var onOpenDict = new __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__["a" /* default */]();
function listenOnOpen(prototype, before, after) {
    Object(__WEBPACK_IMPORTED_MODULE_0__utils_ConstructUtil__["b" /* listenApply */])(prototype.constructor, "onOpen", function (mediator) {
        // 记录onOpen篡改次数
        var count = onOpenDict.get(mediator) || 0;
        onOpenDict.set(mediator, count + 1);
        // 调用回调
        before && before(mediator);
    }, function (mediator) {
        // 调用回调
        after && after(mediator);
        // 递减篡改次数
        var count = onOpenDict.get(mediator) - 1;
        onOpenDict.set(mediator, count);
        // 判断是否所有onOpen都调用完毕，如果完毕了，则启动编译过程
        if (count <= 0) {
            // 移除数据
            onOpenDict.delete(mediator);
            // 全调用完毕了，按层级顺序由浅入深编译
            var bindTargets = mediator.bindTargets;
            for (var depth in bindTargets) {
                var dict = bindTargets[depth];
                dict.forEach(function (currentTarget) { return compile(mediator, currentTarget); });
            }
        }
    });
}
/**
 * 获取显示对象在mediator.skin中的嵌套层级
 *
 * @param {IMediator} mediator 中介者
 * @param {*} target 目标显示对象
 * @returns {number}
 */
function getDepth(mediator, target) {
    var skin = mediator.skin;
    var bridge = mediator.bridge;
    var depth = 0;
    if (bridge.isMySkin(target)) {
        while (target && target !== skin) {
            depth++;
            target = bridge.getParent(target);
        }
        // 如果显示对象是没有根的，或者不在skin的显示树中，则返回0
        if (!target)
            depth = 0;
    }
    return depth;
}
function searchUIDepth(values, mediator, target, callback, addressing) {
    if (addressing === void 0) { addressing = false; }
    // 获取显示层级
    var depth = getDepth(mediator, target);
    // 如果有中断编译则将遍历的工作推迟到中断重启后，否则直接开始遍历
    var stopLeftHandlers = target.__stop_left_handlers__;
    if (stopLeftHandlers)
        stopLeftHandlers.push(handler);
    else
        handler(target, mediator.bindTargets, stopLeftHandlers);
    function handler(target, bindTargets, leftHandlers) {
        var index = -1;
        if (leftHandlers)
            index = leftHandlers.indexOf(handler);
        // 遍历绑定的目标，将编译指令绑定到目标身上，而不是指令所在的显示对象身上
        searchUI(values, target, function (currentTarget, name, exp, depth) {
            if (addressing)
                currentTarget = currentTarget[name];
            // 记录当前编译目标和命令本体目标到bindTargets中
            var dict = bindTargets[depth];
            if (!dict)
                bindTargets[depth] = dict = new __WEBPACK_IMPORTED_MODULE_1__utils_Dictionary__["a" /* default */]();
            dict.set(currentTarget, target);
            // 调用回调
            callback(currentTarget, target, name, exp, leftHandlers, index);
        }, depth);
    }
}
function getBindParams(currentTarget) {
    var bindParams = currentTarget.__bind_commands__;
    if (!bindParams) {
        bindParams = [];
        Object.defineProperty(currentTarget, "__bind_commands__", {
            configurable: true,
            enumerable: false,
            writable: true,
            value: bindParams
        });
    }
    return bindParams;
}
/**
 * 添加编译命令到显示对象上（正向）
 *
 * @export
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {*} target 编译命令本来所在的对象
 * @param {IBindCommand} cmd 命令函数
 * @param {...any[]} args 命令参数列表
 */
function pushCompileCommand(currentTarget, target, cmd) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    // 添加编译指令
    getBindParams(currentTarget).push({ cmd: cmd, target: target, args: args });
}
/**
 * 添加编译命令到显示对象上（反向）
 *
 * @export
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {*} target 编译命令本来所在的对象
 * @param {IBindCommand} cmd 命令函数
 * @param {...any[]} args 命令参数列表
 */
function unshiftCompileCommand(currentTarget, target, cmd) {
    var args = [];
    for (var _i = 3; _i < arguments.length; _i++) {
        args[_i - 3] = arguments[_i];
    }
    getBindParams(currentTarget).unshift({ cmd: cmd, target: target, args: args });
}
/**
 * 编译显示对象，会先编译自身，然后再递归编译子对象
 *
 * @export
 * @param {IMediator} mediator 显示对象所属的中介者
 * @param {ICompileTarget} currentTarget 显示对象
 * @param {any[]} [envModels] 环境变量数组
 */
function compile(mediator, currentTarget, envModels) {
    // 取到编译参数列表
    var bindParams = currentTarget.__bind_commands__;
    // 编译currentTarget自身
    if (bindParams) {
        // 这里没有提前读取出length属性，因为需要动态判断数组长度
        for (var i = 0; i < bindParams.length;) {
            // 使用shift按顺序取出编译命令
            var params = bindParams.shift();
            // 调用编译命令，并且更新中止状态
            params.cmd.apply(params, [mediator, currentTarget, params.target, envModels || []].concat(params.args));
        }
    }
}
/**
 * 编译bindValue命令，不会中止编译
 */
function compileValue(mediator, currentTarget, target, envModels, name, exp) {
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindValue(mediator, currentTarget, target, envModels, name, exp);
}
/**
 * 编译bindExp命令，不会中止编译
 */
function compileExp(mediator, currentTarget, target, envModels, exp) {
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindExp(mediator, currentTarget, target, envModels, exp);
}
/**
 * 编译bindFunc命令，不会中止编译
 */
function compileFunc(mediator, currentTarget, target, envModels, name) {
    var argExps = [];
    for (var _i = 5; _i < arguments.length; _i++) {
        argExps[_i - 5] = arguments[_i];
    }
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindFunc.apply(__WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */], [mediator, currentTarget, target, envModels, name].concat(argExps));
}
/**
 * 编译bindOn命令，不会中止编译
 */
function compileOn(mediator, currentTarget, target, envModels, type, exp) {
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindOn(mediator, currentTarget, target, envModels, type, exp);
}
function isPosterity(mediator, target, parent) {
    var tempParent = mediator.bridge.getParent(target);
    if (!tempParent)
        return false;
    else if (tempParent === parent)
        return true;
    else
        return isPosterity(mediator, tempParent, parent);
}
function getAllSubTargets(mediator, target) {
    var bindTargets = mediator.bindTargets;
    var subTargets = [];
    for (var _i = 0, bindTargets_1 = bindTargets; _i < bindTargets_1.length; _i++) {
        var bindTarget = bindTargets_1[_i];
        bindTarget && bindTarget.forEach(function (tempTarget) {
            if (isPosterity(mediator, tempTarget, target))
                subTargets.push(tempTarget);
        });
    }
    return subTargets;
}
/**
 * 编译bindIf命令，会中止编译，直到判断条件为true时才会启动以继续编译
 */
function compileIf(mediator, currentTarget, target, envModels, exp) {
    // 将后面的编译命令缓存起来
    var bindParams = currentTarget.__bind_commands__;
    var caches = [{ target: currentTarget, params: bindParams.splice(0, bindParams.length) }];
    // 后代节点的也要缓存住
    var subTargets = getAllSubTargets(mediator, currentTarget);
    for (var _i = 0, subTargets_1 = subTargets; _i < subTargets_1.length; _i++) {
        var subTarget = subTargets_1[_i];
        var subBindParams = subTarget.__bind_commands__;
        caches.push({ target: subTarget, params: subBindParams.splice(0, subBindParams.length) });
    }
    // 绑定if命令
    var terminated = false;
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindIf(mediator, currentTarget, target, envModels, exp, function (value) {
        // 如果条件为true，则启动继续编译，但只编译一次，编译过就不需要再编译了
        if (!terminated && value) {
            // 恢复后面的命令
            for (var _i = 0, caches_1 = caches; _i < caches_1.length; _i++) {
                var cache = caches_1[_i];
                cache.target.__bind_commands__ = cache.params;
                // 继续编译
                compile(mediator, cache.target, envModels);
            }
            // 设置已终结标识
            terminated = true;
        }
    });
}
/**
 * 编译bindFor命令，会中止编译，直到生成新的renderer实例时才会继续编译新实例
 */
function compileFor(mediator, currentTarget, target, envModels, name, exp, mediatorCls, declaredMediatorCls, dataExp) {
    // 将后面的编译命令缓存起来
    var leftHandlers = target.__stop_left_handlers__;
    // 绑定for命令
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindFor(mediator, currentTarget, target, envModels, name, exp, mediatorCls, declaredMediatorCls, dataExp, function (data, renderer, subEnvModels) {
        var subLeftHandlers = leftHandlers.concat();
        var bindTargets = [];
        // 针对每一个renderer赋值后续编译指令
        for (var _i = 0, subLeftHandlers_1 = subLeftHandlers; _i < subLeftHandlers_1.length; _i++) {
            var leftHandler = subLeftHandlers_1[_i];
            leftHandler(renderer, bindTargets, subLeftHandlers);
        }
        // 编译renderer实例
        for (var depth in bindTargets) {
            var dict = bindTargets[depth];
            dict.forEach(function (currentTarget) { return compile(mediator, currentTarget, subEnvModels); });
        }
    });
}
/**
 * 编译bindMessage命令，不会中止编译
 */
function compileMessage(mediator, currentTarget, target, envModels, type, name, exp, observable) {
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindMessage(mediator, currentTarget, target, envModels, type, name, exp, observable);
}
/**
 * 编译bindResponse命令，不会中止编译
 */
function compileResponse(mediator, currentTarget, target, envModels, type, name, exp, observable) {
    __WEBPACK_IMPORTED_MODULE_2__bind_BindManager__["a" /* bindManager */].bindResponse(mediator, currentTarget, target, envModels, type, name, exp, observable);
}
/**
 * 搜索UI，取到目标节点，执行回调
 *
 * @export
 * @param {*} values 值结构字典
 * @param {*} ui ui实体
 * @param {(ui:any, key:string, value:any, depth?:number)=>void} callback 回调
 * @param {number} [depth=0] 遍历深度，方法会继续增加这个深度
 */
function searchUI(values, ui, callback, depth) {
    if (depth === void 0) { depth = 0; }
    for (var key in values) {
        var value = values[key];
        var index = key.indexOf(".");
        if (index >= 0) {
            // 是表达式寻址，递归寻址
            var newValue = {};
            newValue[key.substr(index + 1)] = value;
            searchUI(newValue, ui[key.substring(0, index)], callback, depth + 1);
        }
        else if (typeof value == "object" && !(value instanceof Array)) {
            // 是子对象寻址，递归寻址
            searchUI(value, ui[key], callback, depth + 1);
        }
        else {
            // 是表达式，调用回调，将调用层级也传递回去
            callback(ui, key, value, depth);
        }
    }
}


/***/ }),
/* 69 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__DOMBridge__ = __webpack_require__(26);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * DOM遮罩实现
*/
var MaskEntityImpl = /** @class */ (function () {
    function MaskEntityImpl(params) {
        this._maskAlpha = 0.5;
        this._loadingAlpha = 0.5;
        this._modalPanelAlpha = 0.5;
        this._showingMask = false;
        this._showingLoading = false;
        if (params != null) {
            this._maskAlpha = (params.maskAlpha != null ? params.maskAlpha : 0.5);
            this._loadingAlpha = (params.loadingAlpha != null ? params.loadingAlpha : 0.5);
            this._modalPanelAlpha = (params.modalPanelAlpha != null ? params.modalPanelAlpha : 0.5);
            // 初始化loading皮肤
            if (typeof params.loadingSkin == "string") {
                var temp = document.createElement("div");
                temp.innerHTML = params.loadingSkin;
                params.loadingSkin = temp;
            }
            this.loadingSkin = params.loadingSkin;
        }
        this.maskData = params || {};
        this._mask = document.createElement("div");
        this._loadingMask = document.createElement("div");
        this._modalPanelDict = new __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__["a" /* default */]();
        this._modalPanelList = [];
        this._modalPanelMask = document.createElement("div");
    }
    /**
     * 显示遮罩
     */
    MaskEntityImpl.prototype.showMask = function (alpha) {
        if (this._showingMask)
            return;
        this._showingMask = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._maskAlpha;
        this._mask.style.backgroundColor = "#000";
        this._mask.style.opacity = alpha.toString();
        this._mask.style.width = "100%";
        this._mask.style.height = "100%";
        // 添加显示
        bridge.maskLayer.appendChild(this._mask);
    };
    /**
     * 隐藏遮罩
     */
    MaskEntityImpl.prototype.hideMask = function () {
        if (!this._showingMask)
            return;
        this._showingMask = false;
        // 隐藏
        if (this._mask.parentElement != null)
            this._mask.parentElement.removeChild(this._mask);
    };
    /**当前是否在显示遮罩*/
    MaskEntityImpl.prototype.isShowingMask = function () {
        return this._showingMask;
    };
    /**
     * 显示加载图
     */
    MaskEntityImpl.prototype.showLoading = function (alpha) {
        if (this._showingLoading)
            return;
        this._showingLoading = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._loadingAlpha;
        this._loadingMask.style.backgroundColor = "#000";
        this._loadingMask.style.opacity = alpha.toString();
        this._loadingMask.style.width = "100%";
        this._loadingMask.style.height = "100%";
        // 添加显示
        bridge.maskLayer.appendChild(this._loadingMask);
        // 添加loading皮肤
        if (this.loadingSkin)
            bridge.maskLayer.appendChild(this.loadingSkin);
    };
    /**
     * 隐藏加载图
     */
    MaskEntityImpl.prototype.hideLoading = function () {
        if (!this._showingLoading)
            return;
        this._showingLoading = false;
        // 隐藏
        if (this._loadingMask.parentElement != null)
            this._loadingMask.parentElement.removeChild(this._loadingMask);
        if (this.loadingSkin != null && this.loadingSkin.parentElement != null)
            this.loadingSkin.parentElement.removeChild(this.loadingSkin);
    };
    /**当前是否在显示loading*/
    MaskEntityImpl.prototype.isShowingLoading = function () {
        return this._showingLoading;
    };
    /** 显示模态窗口遮罩 */
    MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
        if (this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.set(panel, panel);
        this._modalPanelList.push(panel);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._modalPanelAlpha;
        this._modalPanelMask.style.backgroundColor = "#000";
        this._modalPanelMask.style.opacity = alpha.toString();
        this._modalPanelMask.style.width = "100%";
        this._modalPanelMask.style.height = "100%";
        // 添加显示
        var entity = panel.skin;
        var parent = entity.parentElement;
        if (parent != null) {
            if (this._modalPanelMask.parentElement) {
                this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
            }
            var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
            var index = bridge.getChildIndex(parent, entity);
            bridge.addChildAt(parent, this._modalPanelMask, index);
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskEntityImpl.prototype.hideModalMask = function (panel) {
        if (!this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.delete(panel);
        this._modalPanelList.splice(this._modalPanelList.indexOf(panel), 1);
        // 判断是否还需要Mask
        if (this._modalPanelList.length <= 0) {
            // 隐藏
            if (this._modalPanelMask.parentElement != null)
                this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
        }
        else {
            // 移动Mask
            var entity = this._modalPanelList[this._modalPanelList.length - 1].skin;
            var parent = entity.parentElement;
            if (parent != null) {
                if (this._modalPanelMask.parentElement) {
                    this._modalPanelMask.parentElement.removeChild(this._modalPanelMask);
                }
                var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__DOMBridge__["default"].TYPE);
                var index = bridge.getChildIndex(parent, entity);
                bridge.addChildAt(parent, this._modalPanelMask, index);
            }
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
        return (this._modalPanelDict.get(panel) != null);
    };
    return MaskEntityImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (MaskEntityImpl);


/***/ }),
/* 70 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["e"] = wrapSkin;
/* harmony export (immutable) */ __webpack_exports__["c"] = isDOMStr;
/* harmony export (immutable) */ __webpack_exports__["b"] = isDOMPath;
/* harmony export (immutable) */ __webpack_exports__["a"] = copyRef;
/* harmony export (immutable) */ __webpack_exports__["d"] = toHTMLElement;
/* unused harmony export getHTMLContent */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_mediator_MediatorStatus__ = __webpack_require__(18);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-26
 * @modify date 2017-10-26
 *
 * 为DOM提供皮肤转换的工具集
*/
/**
 * 为中介者包装皮肤
 *
 * @export
 * @param {IMediator} mediator 中介者
 * @param {(HTMLElement|string|string[])} skin 皮肤，可以是HTMLElement，也可以是皮肤字符串，也可以是皮肤模板地址或地址数组
 * @returns {HTMLElement} 皮肤的HTMLElement形式，可能会稍后再填充内容，如果想在皮肤加载完毕后再拿到皮肤请使用complete参数
 */
function wrapSkin(mediator, skin) {
    var result = (skin instanceof HTMLElement ? skin : document.createElement("div"));
    // 判断中介者当前状态
    if (mediator.status < __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_mediator_MediatorStatus__["a" /* default */].OPENING) {
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", doWrapSkin);
    }
    else {
        // 直接执行要执行的
        doWrapSkin();
    }
    // 同步返回皮肤
    return result;
    function doWrapSkin() {
        if (skin instanceof HTMLElement) {
            // 拷贝引用
            doCopyRef(result, skin.innerHTML, mediator);
        }
        else {
            // 转换皮肤
            skin = getHTMLContent(skin);
            // 赋值皮肤内容
            result.innerHTML = skin;
            // 拷贝引用
            doCopyRef(result, skin, mediator);
        }
    }
}
/**
 * 判断是否是DOM字符串
 *
 * @export
 * @param {string} str 字符串
 * @returns {boolean}
 */
function isDOMStr(str) {
    return str && (str.indexOf("<") >= 0 && str.indexOf(">") >= 0);
}
var reg = /(\.htm|\.html|\.tpl)$/;
/**
 * 判断是否是DOM模板路径
 *
 * @export
 * @param {string} path 路径字符串
 * @returns {boolean}
 */
function isDOMPath(path) {
    return path && reg.test(path);
}
/**
 * 将from中的所有拥有id属性的节点引用复制到to对象上
 *
 * @export
 * @param {HTMLElement} from 复制源DOM节点
 * @param {*} to 复制目标对象
 */
function copyRef(from, to) {
    doCopyRef(from, from.innerHTML, to);
}
function doCopyRef(fromEle, fromStr, to) {
    // 使用正则表达式将拥有id的节点赋值给mediator
    var reg = /id=("([^"]+)"|'([^']+)')/g;
    var res;
    while (res = reg.exec(fromStr)) {
        var id = res[2] || res[3];
        to[id] = fromEle.querySelector("#" + id);
    }
}
/**
 * 转换皮肤为HTMLElement
 *
 * @export
 * @param {(HTMLElement|string|string[])} skin 皮肤
 * @returns {HTMLElement}
 */
function toHTMLElement(skin) {
    if (skin instanceof HTMLElement)
        return skin;
    var result = document.createElement("div");
    result.innerHTML = getHTMLContent(skin);
    return result;
}
/**
 * 将皮肤字符串/字符串数组或皮肤路径转变为HTML内容字符串
 *
 * @export
 * @param {(string|string[])} skin 可以是皮肤字符串、皮肤字符串数组或皮肤路径
 * @returns {string}
 */
function getHTMLContent(skin) {
    if (skin instanceof Array) {
        // 是字符串数组，拆分后皮肤化再连接起来
        return skin.map(getHTMLContent).join("");
    }
    else if (isDOMStr(skin)) {
        // 是皮肤字符串，直接返回
        return skin;
    }
    else {
        // 是皮肤路径或路径短名称，获取后返回
        return __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_assets_AssetsManager__["a" /* assetsManager */].getAssets(skin);
    }
}


/***/ }),
/* 71 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 回弹效果
*/
var BackPanelPolicy = /** @class */ (function () {
    function BackPanelPolicy() {
        this._reg = /(\w*)(\d+)(\w*)/;
    }
    /**
     * 显示时调用
     * @param panel 弹出框对象
     * @param callback 完成回调，必须调用
     * @param from 动画起始点
     */
    BackPanelPolicy.prototype.pop = function (panel, callback, from) {
        var entity = panel.skin;
        var curStyle = getComputedStyle(entity);
        var tween = new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](entity).end().stop();
        entity.style.position = "fixed";
        entity.style.left = "calc(50% - " + curStyle.width + " * 0.5)";
        entity.style.top = "calc(50% - " + curStyle.height + " * 0.5)";
        entity.style.transform = "scale(0, 0)";
        // 开始缓动
        var key = "__tween__step__";
        entity[key] = 0;
        var props = {};
        props[key] = 1;
        tween.to(props, 300).easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Back.Out).onUpdate(function () {
            entity.style.transform = "scale(" + entity[key] + ", " + entity[key] + ")";
        }).onComplete(function () {
            delete entity[key];
            entity.style.transform = "";
            callback();
        }).start();
    };
    /**
     * 关闭时调用
     * @param popup 弹出框对象
     * @param callback 完成回调，必须调用
     * @param to 动画完结点
     */
    BackPanelPolicy.prototype.drop = function (panel, callback, to) {
        var entity = panel.skin;
        var tween = new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](entity).end().stop();
        entity.style.transform = "scale(1, 1)";
        // 开始缓动
        var key = "__tween__step__";
        entity[key] = 1;
        var props = {};
        props[key] = 0;
        tween.to(props, 300).easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Back.In).onUpdate(function () {
            entity.style.transform = "scale(" + entity[key] + ", " + entity[key] + ")";
        }).onComplete(function () {
            delete entity[key];
            entity.style.transform = "";
            callback();
        }).start();
    };
    return BackPanelPolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (BackPanelPolicy);


/***/ }),
/* 72 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__ = __webpack_require__(27);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 淡入淡出场景切换策略
*/
var FadeScenePolicy = /** @class */ (function () {
    function FadeScenePolicy() {
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    FadeScenePolicy.prototype.prepareSwitch = function (from, to) {
        if (from != null) {
            // 移除克隆节点
            if (this._stageClone && this._stageClone.parentElement) {
                this._stageClone.parentElement.removeChild(this._stageClone);
            }
            // 克隆当前屏幕
            var stage = from.bridge.stage;
            this._stageClone = stage.cloneNode(true);
            this._stageClone.style.position = "fixed";
            this._stageClone.style.left = "0%";
            this._stageClone.style.top = "0%";
            this._stageClone.style.zIndex = "2147483647"; // 层级要最高
            this._stageClone.style.pointerEvents = "none"; // 要屏蔽点击事件
            // 添加克隆节点
            from.bridge.htmlWrapper.appendChild(this._stageClone);
            // 移除from
            var fromDisplay = from.skin;
            if (fromDisplay.parentElement != null) {
                fromDisplay.parentElement.removeChild(fromDisplay);
            }
        }
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    FadeScenePolicy.prototype.switch = function (from, to, callback) {
        var _this = this;
        if (from != null) {
            // 开始淡出
            var key = "__tween__step__";
            this._stageClone[key] = 1;
            var props = {};
            props[key] = 0;
            new __WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Tween"](this._stageClone)
                .end()
                .stop()
                .to(props, 300)
                .easing(__WEBPACK_IMPORTED_MODULE_0__tweenjs_tween_js__["Easing"].Linear.None)
                .onUpdate(function () {
                _this._stageClone.style.opacity = _this._stageClone[key];
            })
                .onComplete(function () {
                delete _this._stageClone[key];
                // 移除截屏
                if (_this._stageClone.parentElement != null) {
                    _this._stageClone.parentElement.removeChild(_this._stageClone);
                }
                // 调用回调
                callback();
            })
                .start();
        }
        else {
            // 移除克隆节点
            if (this._stageClone && this._stageClone.parentElement) {
                this._stageClone.parentElement.removeChild(this._stageClone);
            }
            // 调用回调
            callback();
        }
    };
    return FadeScenePolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (FadeScenePolicy);


/***/ }),
/* 73 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "audioManager", function() { return audioManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__env_Shell__ = __webpack_require__(74);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__message_EngineMessage__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__AudioContextImpl__ = __webpack_require__(75);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__AudioTagImpl__ = __webpack_require__(46);







/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 音频管理器，音频接口被强行分为两部分：Sound和Music。
 * Sound：使用Audio标签播放，可以跨域播放但可能会被某些浏览器限制，必须在点击事件处理函数中播放
 * Music：使用AudioContext播放，可以一定程度上越过点击事件检查，但无法跨域播放，适合播放背景音乐
*/
var AudioManager = /** @class */ (function () {
    function AudioManager() {
        var _this = this;
        this._soundImpl = new __WEBPACK_IMPORTED_MODULE_6__AudioTagImpl__["a" /* default */]();
        // 为WebAudio做兼容处理
        window["AudioContext"] = window["AudioContext"] || window["webkitAudioContext"] || window["mozAudioContext"] || window["msAudioContext"];
        // 由于IE可能不支持AudioContext，因此如果是IE则要改用Audio标签实现
        this._musicImpl = (window["AudioContext"] ? new __WEBPACK_IMPORTED_MODULE_5__AudioContextImpl__["a" /* default */]() : this._soundImpl);
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_4__message_EngineMessage__["a" /* default */].INITIALIZED, function () {
            // 读取持久化记录
            var shell = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            _this.muteSound = (shell.localStorageGet(AudioManager_1.STORAGE_KEY_MUTE_SOUND) === "true");
            _this.muteMusic = (shell.localStorageGet(AudioManager_1.STORAGE_KEY_MUTE_MUSIC) === "true");
        });
    }
    AudioManager_1 = AudioManager;
    /**
     * 注册Sound音频实现对象
     *
     * @param {IAudio} soundImpl Sound音频实现对象
     * @memberof AudioManager
     */
    AudioManager.prototype.registerSoundImpl = function (soundImpl) {
        if (this._soundImpl)
            this._soundImpl.dispose();
        this._soundImpl = soundImpl;
    };
    Object.defineProperty(AudioManager.prototype, "muteSound", {
        /**
         * 获取或设置Sound类型音频静音属性
         *
         * @type {boolean}
         * @memberof AudioManager
         */
        get: function () {
            return this._soundImpl.mute;
        },
        set: function (value) {
            if (value === this._soundImpl.mute)
                return;
            this._soundImpl.mute = value;
            // 持久化
            var shell = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            shell.localStorageSet(AudioManager_1.STORAGE_KEY_MUTE_SOUND, value + "");
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.loadSound = function (url) {
        this._soundImpl.load(url);
    };
    /**
     * 播放Sound音频，如果没有加载则会先行加载
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @memberof AudioManager
     */
    AudioManager.prototype.playSound = function (params) {
        // 判断静音
        if (this.muteSound)
            return;
        // 停止其他音频
        if (params.stopOthers) {
            this.stopAllSound();
            this.stopAllMusics();
        }
        this._soundImpl.play(params);
    };
    /**
     * 跳转Sound音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioManager
     */
    AudioManager.prototype.seekSound = function (url, time) {
        this._soundImpl.seek(url, time);
    };
    /**
     * 停止Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.stopSound = function (url) {
        this._soundImpl.stop(url);
    };
    /**
     * 暂停Sound音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.pauseSound = function (url) {
        this._soundImpl.pause(url);
    };
    /**
     * 停止所有Sound音频
     *
     * @memberof AudioManager
     */
    AudioManager.prototype.stopAllSound = function () {
        this._soundImpl.stopAll();
    };
    /**
     * 注册Music音频实现对象
     *
     * @param {IAudio} musicImpl Music音频实现对象
     * @memberof AudioManager
     */
    AudioManager.prototype.registerMusicImpl = function (musicImpl) {
        if (this._musicImpl)
            this._musicImpl.dispose();
        this._musicImpl = musicImpl;
    };
    Object.defineProperty(AudioManager.prototype, "muteMusic", {
        /**
         * 获取或设置Music类型音频静音属性
         *
         * @type {boolean}
         * @memberof AudioManager
         */
        get: function () {
            return this._musicImpl.mute;
        },
        set: function (value) {
            if (value === this._musicImpl.mute)
                return;
            this._musicImpl.mute = value;
            // 持久化
            var shell = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(__WEBPACK_IMPORTED_MODULE_3__env_Shell__["a" /* default */]);
            shell.localStorageSet(AudioManager_1.STORAGE_KEY_MUTE_MUSIC, value + "");
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.loadMusic = function (url) {
        this._musicImpl.load(url);
    };
    /**
     * 播放Music音频，如果没有加载则会先行加载
     *
     * @param {AudioPlayParams} [params] 音频参数
     * @memberof AudioManager
     */
    AudioManager.prototype.playMusic = function (params) {
        // 判断静音
        if (this.muteMusic)
            return;
        // 停止其他音频
        if (params.stopOthers) {
            this.stopAllSound();
            this.stopAllMusics();
        }
        this._musicImpl.play(params);
    };
    /**
     * 跳转Music音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioManager
     */
    AudioManager.prototype.seekMusic = function (url, time) {
        this._musicImpl.seek(url, time);
    };
    /**
     * 停止Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.stopMusic = function (url) {
        this._musicImpl.stop(url);
    };
    /**
     * 暂停Music音频
     *
     * @param {string} url 音频地址
     * @memberof AudioManager
     */
    AudioManager.prototype.pauseMusic = function (url) {
        this._musicImpl.pause(url);
    };
    /**
     * 停止所有Music音频
     *
     * @memberof AudioManager
     */
    AudioManager.prototype.stopAllMusics = function () {
        this._musicImpl.stopAll();
    };
    var AudioManager_1;
    AudioManager.STORAGE_KEY_MUTE_SOUND = "AudioManager::muteSound";
    AudioManager.STORAGE_KEY_MUTE_MUSIC = "AudioManager::muteMusic";
    AudioManager = AudioManager_1 = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"],
        __WEBPACK_IMPORTED_MODULE_0_tslib__["e" /* __metadata */]("design:paramtypes", [])
    ], AudioManager);
    return AudioManager;
}());
/* harmony default export */ __webpack_exports__["default"] = (AudioManager);
/** 再额外导出一个单例 */
var audioManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(AudioManager);


/***/ }),
/* 74 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export shell */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__ = __webpack_require__(34);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_URLUtil__ = __webpack_require__(12);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__audio_AudioTagImpl__ = __webpack_require__(46);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__Environment__ = __webpack_require__(5);








/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-23
 * @modify date 2017-10-23
 *
 * 外壳接口，该类既作为外壳接口的注入基类，也作为标准浏览器的实现使用
*/
var Shell = /** @class */ (function () {
    function Shell() {
    }
    Object.defineProperty(Shell.prototype, "proxy", {
        /**
         * 设置外壳代理，如果条件命中了该代理类型，则生成该代理实例并替代外壳行为
         *
         * @memberof Shell
         */
        set: function (value) {
            if (value.hit)
                this._proxy = new value();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Shell.prototype, "type", {
        /**
         * 获取当前外壳类型
         *
         * @readonly
         * @type {string}
         * @memberof Shell
         */
        get: function () {
            if (this._proxy)
                return this._proxy.type;
            else
                return "web";
        },
        enumerable: true,
        configurable: true
    });
    /*************************** 下面是页面跳转接口 ***************************/
    /**
     * 刷新页面
     *
     * @param {{
     *         forcedReload?:boolean, // false表示允许从缓存取，true表示强制从服务器取，默认是false
     *         url?:string, // 传递则使用新URL刷新页面
     *         replace?:boolean // 如果有新url，则表示是否要替换当前浏览历史
     *     }} [params]
     * @memberof Shell
     */
    Shell.prototype.reload = function (params) {
        if (this._proxy) {
            this._proxy.reload(params);
        }
        else {
            if (!params)
                window.location.reload();
            else if (!params.url)
                window.location.reload(params.forcedReload);
            else if (!params.replace)
                window.location.href = params.url;
            else
                window.location.replace(params.url);
        }
    };
    /**
     * 打开一个新页面
     *
     * @param {{
     *         url?:string, // 新页面地址，不传则不更新地址
     *         name?:string, // 给新页面命名，或导航到已有页面
     *         replace?:boolean, // 是否替换当前浏览历史条目，默认false
     *         features:{[key:string]:any} // 其他可能的参数
     *     }} [params]
     * @memberof Shell
     */
    Shell.prototype.open = function (params) {
        if (this._proxy) {
            this._proxy.open(params);
        }
        else {
            if (!params) {
                window.open();
            }
            else {
                var features = undefined;
                if (params.features) {
                    features = [];
                    for (var key in params.features) {
                        features.push(key + "=" + params.features[key]);
                    }
                }
                window.open(params.url, params.name, features && features.join(","), params.replace);
            }
        }
    };
    /**
     * 关闭窗口
     *
     * @memberof Shell
     */
    Shell.prototype.close = function () {
        if (this._proxy)
            this._proxy.close();
        else
            window.close();
    };
    /*************************** 下面是本地存储接口 ***************************/
    /**
     * 获取本地存储
     *
     * @param {string} key 要获取值的键
     * @returns {string} 获取的值
     * @memberof Shell
     */
    Shell.prototype.localStorageGet = function (key) {
        if (this._proxy)
            return this._proxy.localStorageGet(key);
        else
            return window.localStorage.getItem(key);
    };
    /**
     * 设置本地存储
     *
     * @param {string} key 要设置的键
     * @param {string} value 要设置的值
     * @memberof Shell
     */
    Shell.prototype.localStorageSet = function (key, value) {
        if (this._proxy)
            this._proxy.localStorageSet(key, value);
        else
            window.localStorage.setItem(key, value);
    };
    /**
     * 移除本地存储
     *
     * @param {string} key 要移除的键
     * @memberof Shell
     */
    Shell.prototype.localStorageRemove = function (key) {
        if (this._proxy)
            this._proxy.localStorageRemove(key);
        else
            window.localStorage.removeItem(key);
    };
    /**
     * 清空本地存储
     *
     * @memberof Shell
     */
    Shell.prototype.localStorageClear = function () {
        if (this._proxy)
            this._proxy.localStorageClear();
        else
            window.localStorage.clear();
    };
    Shell = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Shell);
    return Shell;
}());
/* harmony default export */ __webpack_exports__["a"] = (Shell);
/**
 * 这是Shell在微信浏览器下的一个变形代理
 *
 * @class ShellWX
 * @extends {Shell}
 */
var ShellWX = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](ShellWX, _super);
    function ShellWX() {
        var _this = _super.call(this) || this;
        // 去加载微信jssdk
        __WEBPACK_IMPORTED_MODULE_5__assets_AssetsManager__["a" /* assetsManager */].loadJsFiles([{
                url: Object(__WEBPACK_IMPORTED_MODULE_4__utils_URLUtil__["e" /* validateProtocol */])("http://res.wx.qq.com/open/js/jweixin-1.2.0.js"),
                mode: __WEBPACK_IMPORTED_MODULE_3__core_interfaces_JSFile__["a" /* JSLoadMode */].TAG
            }], function (err) {
            if (!err && window["wx"]) {
                // 变异AudioTagImpl，在微信里的Audio标签需要从微信触发加载
                var oriLoad = __WEBPACK_IMPORTED_MODULE_6__audio_AudioTagImpl__["a" /* default */].prototype.load;
                __WEBPACK_IMPORTED_MODULE_6__audio_AudioTagImpl__["a" /* default */].prototype.load = function (url) {
                    var _this = this;
                    // 处理url
                    var toUrl = __WEBPACK_IMPORTED_MODULE_7__Environment__["environment"].toCDNHostURL(url);
                    // 尝试获取缓存数据
                    var data = this._audioCache[toUrl];
                    // 如果没有缓存才去加载
                    if (!data || data.__from_cache__) {
                        // 先调用原始方法，否则行为就变了
                        if (!data)
                            oriLoad.call(this, url);
                        else
                            delete data.__from_cache__;
                        // 从微信里触发加载操作
                        window["wx"].checkJsApi({
                            jsApiList: ["checkJsApi"],
                            success: function () {
                                var data = _this._audioCache[toUrl];
                                var node = data.node;
                                node.load();
                            }
                        });
                    }
                };
                // 派发事件
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(ShellWX.EVENT_WX_PREPARED, window["wx"]);
            }
        });
        return _this;
    }
    Object.defineProperty(ShellWX, "hit", {
        get: function () {
            return (window.top === window &&
                /MicroMessenger/i.test(navigator.userAgent));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ShellWX.prototype, "type", {
        get: function () {
            return "weixin";
        },
        enumerable: true,
        configurable: true
    });
    ShellWX.prototype.close = function () {
        window["WeixinJSBridge"].invoke("closeWindow");
    };
    ShellWX.EVENT_WX_PREPARED = "eventWXPrepared";
    return ShellWX;
}(Shell));
/** 再额外导出一个单例 */
var shell = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Shell);
/** 尝试添加微信外壳代理 */
shell.proxy = ShellWX;


/***/ }),
/* 75 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__system_System__ = __webpack_require__(24);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__AudioMessage__ = __webpack_require__(47);





/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-30
 * @modify date 2017-10-30
 *
 * 使用AudioContext实现IAudio接口的实现类
*/
var AudioContextImpl = /** @class */ (function () {
    function AudioContextImpl() {
        var _this = this;
        this._disposed = false;
        this._mute = false;
        this._playingDict = {};
        this._audioCache = {};
        this._onInit = null;
        this._context = new (window["AudioContext"] || window["webkitAudioContext"])();
        this._onInit = function () {
            window.removeEventListener("touchstart", _this._onInit, true);
            window.removeEventListener("mousedown", _this._onInit, true);
            _this._onInit = null;
            // 生成一个空的音频，播放并停止，用以解除限制
            var source = _this._context.createBufferSource();
            source.buffer = _this._context.createBuffer(1, 1, 44100);
            source.connect(_this._context.destination);
            source.start();
            source.stop();
            // 要先挂起
            _this._context.suspend();
            // 如果当前有正在播放的音频，全部再播放一次
            for (var url in _this._audioCache) {
                var data = _this._audioCache[url];
                if (data.status == AudioStatus.PLAYING) {
                    // 停止播放
                    _this.stop(data.playParams.url);
                    // 重新播放
                    _this.play(data.playParams);
                }
            }
        };
        // 这里监听触摸事件，一定要使用捕获阶段，否则会被某些框架阻止，比如egret
        window.addEventListener("touchstart", this._onInit, true);
        window.addEventListener("mousedown", this._onInit, true);
    }
    Object.defineProperty(AudioContextImpl.prototype, "disposed", {
        get: function () {
            return this._disposed;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(AudioContextImpl.prototype, "mute", {
        /**
         * 静音状态
         *
         * @type {boolean}
         * @memberof AudioTagImpl
         */
        get: function () {
            return this._mute;
        },
        set: function (value) {
            this._mute = value;
            // 静音，暂停所有声音
            for (var url in this._playingDict) {
                if (value) {
                    // 静音，停止音频，不可调用stop方法，因为要保持播放中的音频状态
                    this._doStop(url);
                }
                else {
                    // 非静音，播放音频
                    var params = this._playingDict[url];
                    this.play(params);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 加载音频
     *
     * @param {string} url 音频地址
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.load = function (url) {
        var _this = this;
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        // 如果没有缓存才去加载
        if (!data) {
            // 使用AudioContext加载
            this._audioCache[toUrl] = data = { buffer: null, status: AudioStatus.LOADING, playParams: null, progress: null };
            // 派发加载开始事件
            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_LOAD_STARTED, url);
            // 开始加载
            __WEBPACK_IMPORTED_MODULE_1__assets_AssetsManager__["a" /* assetsManager */].loadAssets(toUrl, function (result) {
                if (result instanceof ArrayBuffer) {
                    _this._context.decodeAudioData(result, function (buffer) {
                        data.buffer = buffer;
                        // 设置状态
                        data.status = AudioStatus.PAUSED;
                        // 派发加载完毕事件
                        __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_LOAD_ENDED, url);
                        // 如果自动播放则播放
                        if (data.playParams)
                            _this.play(data.playParams);
                    });
                }
            }, "arraybuffer");
        }
    };
    /**
     * 播放音频，如果音频没有加载则先加载再播放
     *
     * @param {AudioPlayParams} params 音频播放参数
     * @returns {void}
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.play = function (params) {
        var _this = this;
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(params.url);
        // 尝试获取缓存数据
        var data = this._audioCache[toUrl];
        if (!data) {
            // 没有加载过，开始加载音频
            this.load(params.url);
            // 设置播放参数
            this._audioCache[toUrl].playParams = params;
        }
        else {
            switch (data.status) {
                case AudioStatus.LOADING:
                    // 正在加载中，替换自动播放参数
                    data.playParams = params;
                    break;
                case AudioStatus.PLAYING:
                    // 正在播放，关闭后再播放
                    this.stop(params.url);
                    this.play(params);
                    break;
                case AudioStatus.PAUSED:
                    // 设置状态
                    data.status = AudioStatus.PLAYING;
                    // 记录播放中
                    this._playingDict[toUrl] = params;
                    // 已经加载完毕，直接播放
                    data.node = this._context.createBufferSource();
                    data.node.buffer = data.buffer;
                    if (params.loop != null)
                        data.node.loop = params.loop;
                    data.node.connect(this._context.destination);
                    // 监听播放完毕
                    data.node.onended = function () {
                        var data = _this._audioCache[toUrl];
                        if (data) {
                            // 停止播放
                            _this.stop(params.url);
                            // 派发播放完毕事件
                            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_PLAY_ENDED, params.url);
                        }
                    };
                    // 要播放之前要起用
                    this._context.resume();
                    // 开始播放，优先取参数中的时间，没有就取默认开始时间
                    var playTime;
                    if (params && params.time != null)
                        playTime = params.time * 0.001;
                    else
                        playTime = data.playTime;
                    delete data.playTime;
                    data.node.start(playTime);
                    // 开始播放进度监测
                    var lastTime = this._context.currentTime;
                    var curTime = playTime || 0;
                    data.progress = __WEBPACK_IMPORTED_MODULE_3__system_System__["a" /* system */].enterFrame(function () {
                        var nowTime = _this._context.currentTime;
                        var deltaTime = nowTime - lastTime;
                        lastTime = nowTime;
                        if (data.status == AudioStatus.PLAYING) {
                            curTime += deltaTime * 1000;
                            var totalTime = data.node.buffer.duration * 1000;
                            __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_PLAY_PROGRESS, params.url, curTime, totalTime);
                        }
                    });
                    // 派发播放开始事件
                    __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_PLAY_STARTED, params.url);
                    break;
            }
        }
    };
    AudioContextImpl.prototype._doStop = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            // 设置状态
            data.status = AudioStatus.PAUSED;
            // 取消进度监测
            data.node.onended = null;
            if (data.progress)
                data.progress.cancel();
            // 结束播放
            if (data.node) {
                try {
                    // 这里可能会报错，需要try cath
                    data.node.stop(time);
                    // 停止播音频时需要挂起
                    this._context.suspend();
                }
                catch (err) {
                    console.warn(err);
                }
                // 派发播放停止事件
                __WEBPACK_IMPORTED_MODULE_0__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_4__AudioMessage__["a" /* default */].AUDIO_PLAY_STOPPED, url);
            }
        }
    };
    /**
     * 暂停音频（不会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.pause = function (url) {
        this._doStop(url);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止音频（会重置进度）
     *
     * @param {string} url 音频URL
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.stop = function (url) {
        this._doStop(url, 0);
        // 移除播放中
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        delete this._playingDict[toUrl];
    };
    /**
     * 停止所有音频
     *
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.stopAll = function () {
        for (var url in this._audioCache) {
            this.stop(url);
        }
    };
    /**
     * 跳转音频进度
     *
     * @param {string} url 音频URL
     * @param {number} time 要跳转到的音频位置，毫秒值
     * @memberof AudioContextImpl
     */
    AudioContextImpl.prototype.seek = function (url, time) {
        var toUrl = __WEBPACK_IMPORTED_MODULE_2__env_Environment__["environment"].toCDNHostURL(url);
        var data = this._audioCache[toUrl];
        if (data) {
            var params = data.playParams;
            if (data.status == AudioStatus.PLAYING) {
                // 停止重新播放
                this.stop(url);
                params.time = time;
                this.play(params);
            }
            else {
                data.playTime = time;
            }
        }
    };
    AudioContextImpl.prototype.dispose = function () {
        if (!this._disposed) {
            if (this._onInit) {
                window.removeEventListener("touchstart", this._onInit, true);
                window.removeEventListener("mousedown", this._onInit, true);
                this._onInit = null;
            }
            this.stopAll();
            this._disposed = true;
        }
    };
    return AudioContextImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (AudioContextImpl);
var AudioStatus;
(function (AudioStatus) {
    /**
     * 加载中
     */
    AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
    /**
     * 已暂停
     */
    AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
    /**
     * 播放中
     */
    AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
})(AudioStatus || (AudioStatus = {}));


/***/ }),
/* 76 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(51), __webpack_require__(42), __webpack_require__(78)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, TestResponse_1, RequestData_1, HTTPRequestPolicy_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var TestRequest = /** @class */ (function (_super) {
        __extends(TestRequest, _super);
        function TestRequest() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.__policy = HTTPRequestPolicy_1.default;
            return _this;
        }
        Object.defineProperty(TestRequest.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    path: "/test",
                    protocol: "http",
                    response: TestResponse_1.default,
                    data: {
                        test: this.test // string - 测试
                    }
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        return TestRequest;
    }(RequestData_1.default));
    exports.default = TestRequest;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdFJlcXVlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUZXN0UmVxdWVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0lBS0E7Ozs7OztNQU1FO0lBQ0Y7UUFBeUMsK0JBQVc7UUFBcEQ7WUFBQSxxRUF1QkM7WUFEVSxjQUFRLEdBQWtCLDJCQUFNLENBQUM7O1FBQzVDLENBQUM7UUFiRyxzQkFBVyxpQ0FBUTtpQkFBbkI7Z0JBRUksT0FBTztvQkFDSCxJQUFJLEVBQUUsTUFBTTtvQkFDckIsSUFBSSxFQUFFLE9BQU87b0JBQ0osUUFBUSxFQUFFLE1BQU07b0JBQ2hCLFFBQVEsRUFBRSxzQkFBWTtvQkFDdEIsSUFBSSxFQUFFO3dCQUNGLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFBLGNBQWM7cUJBQ2hDO2lCQUNKLENBQUM7WUFDTixDQUFDOzs7V0FBQTtRQUFBLENBQUM7UUFFTixrQkFBQztJQUFELENBQUMsQUF2QkQsQ0FBeUMscUJBQVcsR0F1Qm5EIn0=

/***/ }),
/* 77 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(45)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, DataType_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * 测试
    */
    var Test = /** @class */ (function (_super) {
        __extends(Test, _super);
        function Test() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Test.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.test = data.test;
        };
        Test.prototype.pack = function () {
            return {
                test: this.test
            };
        };
        return Test;
    }(DataType_1.default));
    exports.default = Test;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztJQUVBOzs7Ozs7TUFNRTtJQUNGO1FBQWtDLHdCQUFRO1FBQTFDOztRQXNCQSxDQUFDO1FBWmEsc0JBQU8sR0FBakIsVUFBa0IsSUFBUTtZQUV0QixJQUFHLElBQUksSUFBSSxJQUFJO2dCQUFFLE9BQU87WUFDeEIsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQzFCLENBQUM7UUFFTSxtQkFBSSxHQUFYO1lBRUksT0FBTztnQkFDSCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7YUFDbEIsQ0FBQztRQUNOLENBQUM7UUFDTCxXQUFDO0lBQUQsQ0FBQyxBQXRCRCxDQUFrQyxrQkFBUSxHQXNCekMifQ==

/***/ }),
/* 78 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HTTPRequestPolicy", function() { return HTTPRequestPolicy; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_HTTPUtil__ = __webpack_require__(35);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__NetManager__ = __webpack_require__(14);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ObjectUtil__ = __webpack_require__(4);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * HTTP请求策略
*/
var HTTPRequestPolicy = /** @class */ (function () {
    function HTTPRequestPolicy() {
    }
    /**
     * 发送请求逻辑
     *
     * @param {RequestData} request 请求数据
     * @memberof HTTPRequestPolicy
     */
    HTTPRequestPolicy.prototype.sendRequest = function (request) {
        // 取到参数
        var params = request.__params;
        // 修改数据
        var httpParams = Object(__WEBPACK_IMPORTED_MODULE_3__utils_ObjectUtil__["b" /* extendObject */])({
            url: __WEBPACK_IMPORTED_MODULE_1__env_Environment__["environment"].toHostURL(params.path, params.hostIndex),
            onResponse: function (result) { return __WEBPACK_IMPORTED_MODULE_2__NetManager__["netManager"].__onResponse(request.__params.response, result, request); },
            onError: function (err) { return __WEBPACK_IMPORTED_MODULE_2__NetManager__["netManager"].__onError(request.__params.response, err, request); },
            headerDict: {}
        }, params);
        // 发送
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_HTTPUtil__["a" /* load */])(httpParams);
    };
    return HTTPRequestPolicy;
}());

/** 再额外导出一个实例 */
/* harmony default export */ __webpack_exports__["default"] = (new HTTPRequestPolicy());


/***/ }),
/* 79 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(7), __webpack_require__(53)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Mediator_1, Injector_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestComp = /** @class */ (function (_super) {
        __extends(TestComp, _super);
        function TestComp() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TestComp.prototype.onOpen = function () {
            this.skin.x = 100;
            this.skin.y = 100;
            this.parent.skin.addChild(this.skin);
            this.dispatch("TestCompMsg");
        };
        TestComp.prototype.onDispose = function () {
            this.parent.skin.removeChild(this.skin);
        };
        TestComp = __decorate([
            Injector_1.EgretMediatorClass("TestComp", "TestCompSkin")
        ], TestComp);
        return TestComp;
    }(Mediator_1.default));
    exports.default = TestComp;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdENvbXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUZXN0Q29tcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBSUE7UUFBc0MsNEJBQVE7UUFBOUM7O1FBZUEsQ0FBQztRQWJVLHlCQUFNLEdBQWI7WUFFSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDbEIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQ2xCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFckMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUNqQyxDQUFDO1FBRU0sNEJBQVMsR0FBaEI7WUFFSSxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzVDLENBQUM7UUFkZ0IsUUFBUTtZQUQ1Qiw2QkFBa0IsQ0FBQyxVQUFVLEVBQUUsY0FBYyxDQUFDO1dBQzFCLFFBQVEsQ0FlNUI7UUFBRCxlQUFDO0tBQUEsQUFmRCxDQUFzQyxrQkFBUSxHQWU3QztzQkFmb0IsUUFBUSJ9

/***/ }),
/* 80 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(19), __webpack_require__(9), __webpack_require__(7), __webpack_require__(10), __webpack_require__(54)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Injector_1, Injector_2, Mediator_1, ModuleManager_1, TestPanel_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var TestForMediator = /** @class */ (function (_super) {
        __extends(TestForMediator, _super);
        function TestForMediator(skin) {
            return _super.call(this, skin) || this;
        }
        TestForMediator.prototype.onOpen = function (data) {
            this.viewModel = {
                data: data,
                onClickText: function () {
                    ModuleManager_1.moduleManager.open(TestPanel_1.default);
                }
            };
            console.log("asdfasdf - " + data);
        };
        __decorate([
            Injector_2.BindOn("click", "onClickText"),
            __metadata("design:type", Object)
        ], TestForMediator.prototype, "skin", void 0);
        __decorate([
            Injector_2.BindValue({ innerHTML: "'这是替换后的渲染器内层 - ' + data.fuck + '<br/>'" }),
            __metadata("design:type", HTMLElement)
        ], TestForMediator.prototype, "asdf", void 0);
        TestForMediator = __decorate([
            Injector_1.DOMMediatorClass("TestForMediator", "<div>这是替换后的渲染器外层<div id='asdf'></div></div>"),
            __metadata("design:paramtypes", [Object])
        ], TestForMediator);
        return TestForMediator;
    }(Mediator_1.default));
    exports.default = TestForMediator;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVzdEZvck1lZGlhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiVGVzdEZvck1lZGlhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFPQTtRQUE2QyxtQ0FBUTtRQVFqRCx5QkFBbUIsSUFBSTttQkFFbkIsa0JBQU0sSUFBSSxDQUFDO1FBQ2YsQ0FBQztRQUVNLGdDQUFNLEdBQWIsVUFBYyxJQUFJO1lBRWQsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDYixJQUFJLEVBQUUsSUFBSTtnQkFDVixXQUFXLEVBQUU7b0JBQ1QsNkJBQWEsQ0FBQyxJQUFJLENBQUMsbUJBQVMsQ0FBQyxDQUFDO2dCQUNsQyxDQUFDO2FBQ0osQ0FBQTtZQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQ3RDLENBQUM7UUFuQkQ7WUFEQyxpQkFBTSxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUM7O3FEQUNmO1FBR2hCO1lBREMsb0JBQVMsQ0FBQyxFQUFDLFNBQVMsRUFBRSx3Q0FBd0MsRUFBQyxDQUFDO3NDQUNyRCxXQUFXO3FEQUFDO1FBTlAsZUFBZTtZQURuQywyQkFBZ0IsQ0FBQyxpQkFBaUIsRUFBRSw2Q0FBNkMsQ0FBQzs7V0FDOUQsZUFBZSxDQXVCbkM7UUFBRCxzQkFBQztLQUFBLEFBdkJELENBQTZDLGtCQUFRLEdBdUJwRDtzQkF2Qm9CLGVBQWUifQ==

/***/ }),
/* 81 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__ = __webpack_require__(7);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__mediator_MediatorMessage__ = __webpack_require__(25);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__PanelManager__ = __webpack_require__(22);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 * @export
 * @class PanelMediator
 * @extends {Mediator<S, OD, CD>}
 * @implements {IPanel<S, OD, CD>}
 * @template S 皮肤类型
 * @template OD 开启参数类型
 * @template CD 关闭参数类型
 *
 * 实现了IPanel接口的弹窗中介者基类
*/
var PanelMediator = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](PanelMediator, _super);
    function PanelMediator(skin, policy) {
        var _this = _super.call(this, skin) || this;
        _this.policy = policy;
        return _this;
    }
    PanelMediator.prototype.__afterOnOpen = function (data, isModel, from) {
        __WEBPACK_IMPORTED_MODULE_3__PanelManager__["a" /* panelManager */].pop(this, data, isModel, from);
    };
    PanelMediator.prototype.__afterOnClose = function (data, to) {
        var _this = this;
        // 篡改onAfterDrop，等待关闭动画结束后再执行
        var oriOnAfterDrop = this.onAfterDrop;
        this.onAfterDrop = function (data, to) {
            oriOnAfterDrop.call(_this, data, to);
            // 派发关闭事件
            _this.dispatch(__WEBPACK_IMPORTED_MODULE_2__mediator_MediatorMessage__["a" /* default */].MEDIATOR_CLOSED, _this);
            // 调用销毁
            _this.dispose();
        };
        __WEBPACK_IMPORTED_MODULE_3__PanelManager__["a" /* panelManager */].drop(this, data, to);
    };
    /** 在弹出前调用的方法 */
    PanelMediator.prototype.onBeforePop = function (data, isModel, from) {
        // 可重写
    };
    /** 在弹出后调用的方法 */
    PanelMediator.prototype.onAfterPop = function (data, isModel, from) {
        // 可重写
    };
    /** 在关闭前调用的方法 */
    PanelMediator.prototype.onBeforeDrop = function (data, to) {
        // 可重写
    };
    /** 在关闭后调用的方法 */
    PanelMediator.prototype.onAfterDrop = function (data, to) {
        // 可重写
    };
    return PanelMediator;
}(__WEBPACK_IMPORTED_MODULE_1__mediator_Mediator__["default"]));
/* harmony default export */ __webpack_exports__["default"] = (PanelMediator);


/***/ }),
/* 82 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(52), __webpack_require__(49), __webpack_require__(15), __webpack_require__(2), __webpack_require__(10), __webpack_require__(9), __webpack_require__(19), __webpack_require__(54)], __WEBPACK_AMD_DEFINE_RESULT__ = (function (require, exports, Second_1, FuckModel_1, SceneMediator_1, Injector_1, ModuleManager_1, Injector_2, Injector_3, TestPanel_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * 测试首个模块
    */
    var Third = /** @class */ (function (_super) {
        __extends(Third, _super);
        function Third() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Third_1 = Third;
        Third.prototype.listAssets = function () {
            return ["./modules/test.html"];
        };
        Third.prototype.onOpen = function () {
            var _this = this;
            this.viewModel = {
                fuckList: [1, 2, "shit", "you"],
                fuckText: "fuck you",
                onClickBtn: function () {
                    _this.viewModel.fuckText = "clicked";
                    _this.moduleManager.open(Second_1.default, null, true);
                },
                onClickText: function () {
                    _this.moduleManager.open(TestPanel_1.default);
                },
                onClickFuck: function () {
                    _this.moduleManager.close(Third_1);
                },
                fuckModel: this.fuckModel1
            };
        };
        var Third_1;
        Third.moduleName = "Third";
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", ModuleManager_1.default)
        ], Third.prototype, "moduleManager", void 0);
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", FuckModel_1.default)
        ], Third.prototype, "fuckModel1", void 0);
        __decorate([
            Injector_1.Inject,
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], Third.prototype, "fuckModel2", void 0);
        __decorate([
            Injector_1.Inject(1),
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], Third.prototype, "fuckModel3", void 0);
        __decorate([
            Injector_2.BindOn({ click: "onClickBtn" }),
            Injector_2.BindIf("fuckText == '1234'"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "btn", void 0);
        __decorate([
            Injector_2.BindFor("fuck in fuckList"),
            Injector_2.BindValue({ textContent: "fuck + ' - ' + fuckText + ' - 1'" }),
            Injector_2.BindOn("click", "onClickText"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "txt", void 0);
        __decorate([
            Injector_2.BindOn("click", "onClickFuck"),
            Injector_2.BindValue("textContent", "fuckModel.fuck"),
            __metadata("design:type", HTMLElement)
        ], Third.prototype, "fuck", void 0);
        Third = Third_1 = __decorate([
            Injector_3.DOMMediatorClass("Third", "./modules/test.html")
        ], Third);
        return Third;
    }(SceneMediator_1.default));
    exports.default = Third;
}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGhpcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUaGlyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBYUE7Ozs7Ozs7TUFPRTtJQUdGO1FBQW1DLHlCQUFhO1FBQWhEOztRQStDQSxDQUFDO2tCQS9Db0IsS0FBSztRQXdCZiwwQkFBVSxHQUFqQjtZQUVJLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1FBQ25DLENBQUM7UUFFTSxzQkFBTSxHQUFiO1lBQUEsaUJBaUJDO1lBZkcsSUFBSSxDQUFDLFNBQVMsR0FBRztnQkFDYixRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUM7Z0JBQy9CLFFBQVEsRUFBRSxVQUFVO2dCQUNwQixVQUFVLEVBQUU7b0JBQ1IsS0FBSSxDQUFDLFNBQVMsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDO29CQUNwQyxLQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxnQkFBTSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztnQkFDaEQsQ0FBQztnQkFDRCxXQUFXLEVBQUU7b0JBQ1QsS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsbUJBQVMsQ0FBQyxDQUFDO2dCQUN2QyxDQUFDO2dCQUNELFdBQVcsRUFBRTtvQkFDVCxLQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxPQUFLLENBQUMsQ0FBQztnQkFDcEMsQ0FBQztnQkFDRCxTQUFTLEVBQUUsSUFBSSxDQUFDLFVBQVU7YUFDN0IsQ0FBQztRQUNOLENBQUM7O1FBNUNhLGdCQUFVLEdBQVUsT0FBTyxDQUFDO1FBRzFDO1lBREMsaUJBQU07c0NBQ2UsdUJBQWE7b0RBQUM7UUFFcEM7WUFEQyxpQkFBTTtzQ0FDWSxtQkFBUztpREFBQztRQUU3QjtZQURDLGlCQUFNO3NDQUNZLHNCQUFVO2lEQUFDO1FBRTlCO1lBREMsaUJBQU0sQ0FBQyxDQUFDLENBQUM7c0NBQ1Msc0JBQVU7aURBQUM7UUFJOUI7WUFGQyxpQkFBTSxDQUFDLEVBQUMsS0FBSyxFQUFFLFlBQVksRUFBQyxDQUFDO1lBQzdCLGlCQUFNLENBQUMsb0JBQW9CLENBQUM7c0NBQ2xCLFdBQVc7MENBQUE7UUFJdEI7WUFIQyxrQkFBTyxDQUFDLGtCQUFrQixDQUFDO1lBQzNCLG9CQUFTLENBQUMsRUFBQyxXQUFXLEVBQUUsa0NBQWtDLEVBQUMsQ0FBQztZQUM1RCxpQkFBTSxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUM7c0NBQ3BCLFdBQVc7MENBQUM7UUFHdkI7WUFGQyxpQkFBTSxDQUFDLE9BQU8sRUFBRSxhQUFhLENBQUM7WUFDOUIsb0JBQVMsQ0FBQyxhQUFhLEVBQUUsZ0JBQWdCLENBQUM7c0NBQy9CLFdBQVc7MkNBQUM7UUF0QlAsS0FBSztZQUR6QiwyQkFBZ0IsQ0FBQyxPQUFPLEVBQUUscUJBQXFCLENBQUM7V0FDNUIsS0FBSyxDQStDekI7UUFBRCxZQUFDO0tBQUEsQUEvQ0QsQ0FBbUMsdUJBQWEsR0ErQy9DO3NCQS9Db0IsS0FBSyJ9

/***/ }),
/* 83 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine_Engine__ = __webpack_require__(84);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, "core", function() { return __WEBPACK_IMPORTED_MODULE_1__core_Core__["a"]; });


/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-18
 * @modify date 2017-09-18
 *
 * Olympus框架便捷启动与框架外观模块
*/
var Olympus = /** @class */ (function () {
    function Olympus() {
    }
    /**
     * 启动Olympus框架
     *
     * @static
     * @param {IInitParams} params 启动参数
     * @memberof Olympus
     */
    Olympus.startup = function (params) {
        // 初始化引擎模块
        __WEBPACK_IMPORTED_MODULE_0__engine_Engine__["a" /* engine */].initialize(params);
    };
    return Olympus;
}());
/* harmony default export */ __webpack_exports__["default"] = (Olympus);


/***/ }),
/* 84 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export InitStep */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return engine; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__ = __webpack_require__(11);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__bridge_BridgeMessage__ = __webpack_require__(41);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__env_Hash__ = __webpack_require__(50);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__message_EngineMessage__ = __webpack_require__(48);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__module_ModuleManager__ = __webpack_require__(10);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__ = __webpack_require__(17);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__version_Version__ = __webpack_require__(21);












/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * Engine模组是开发框架的引擎部分，包括业务模块系统、应用程序启动和初始化、弹窗和场景管理器等与项目开发相关的逻辑都在这个模组中
 * 这个模组的逻辑都高度集成在子模组中了，因此也只是收集相关子模组
*/
var InitStep;
(function (InitStep) {
    /** 框架尚未开始初始化 */
    InitStep[InitStep["Uninit"] = 0] = "Uninit";
    /** 框架已准备好初始化 */
    InitStep[InitStep["ReadyToInit"] = 1] = "ReadyToInit";
    /** 开始执行初始化 */
    InitStep[InitStep["StartInit"] = 2] = "StartInit";
    /** 版本号系统初始化完毕 */
    InitStep[InitStep["VersionInited"] = 3] = "VersionInited";
    /** 表现层桥初始化完毕 */
    InitStep[InitStep["BridgesInited"] = 4] = "BridgesInited";
    /** 预加载，可能会触发多次，每次传递两个参数：预加载文件名或路径、预加载文件内容 */
    InitStep[InitStep["Preload"] = 5] = "Preload";
    /** 开始打开首个模块 */
    InitStep[InitStep["OpenFirstModule"] = 6] = "OpenFirstModule";
    /** 首个模块打开完毕，初始化流程完毕 */
    InitStep[InitStep["Inited"] = 7] = "Inited";
})(InitStep || (InitStep = {}));
var Engine = /** @class */ (function () {
    function Engine() {
        this._initStep = InitStep.Uninit;
    }
    Object.defineProperty(Engine.prototype, "initParams", {
        /**
         * 获取初始化参数
         *
         * @readonly
         * @type {IInitParams}
         * @memberof Engine
         */
        get: function () {
            return this._initParams;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Engine.prototype, "initStep", {
        /**
         * 获取框架初始化进程
         *
         * @readonly
         * @type {InitStep}
         * @memberof Engine
         */
        get: function () {
            return this._initStep;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 初始化Engine
     *
     * @param {IInitParams} params 初始化参数
     * @memberof Engine
     */
    Engine.prototype.initialize = function (params) {
        var self = this;
        // 调用进度回调，初始化为0%
        this._initStep = InitStep.ReadyToInit;
        params.onInitProgress && params.onInitProgress(0, this._initStep);
        // 执行初始化
        if (document.readyState == "loading")
            document.addEventListener("readystatechange", doInitialize);
        else
            doInitialize();
        function doInitialize() {
            // 调用进度回调，开始初始化为10%
            self._initStep = InitStep.StartInit;
            params.onInitProgress && params.onInitProgress(0.1, self._initStep);
            // 移除事件
            if (this == document)
                document.removeEventListener("readystatechange", doInitialize);
            // 要判断document是否初始化完毕
            self._initParams = params;
            // 加载页
            self._loadElement = (typeof params.loadElement == "string" ? document.querySelector(params.loadElement) : params.loadElement);
            // 监听错误事件
            if (params.onError)
                self.listenError(params.onError);
            // 初始化环境参数
            __WEBPACK_IMPORTED_MODULE_6__env_Environment__["environment"].initialize(params.env, params.hostsDict, params.cdnsDict);
            // 初始化版本号工具
            if (params.hasVersion !== false)
                __WEBPACK_IMPORTED_MODULE_11__version_Version__["a" /* version */].initialize(afterInitVersion, params.version);
            else
                afterInitVersion();
            function afterInitVersion() {
                // 调用进度回调，版本号初始化完毕为20%
                self._initStep = InitStep.VersionInited;
                params.onInitProgress && params.onInitProgress(0.2, self._initStep);
                // 监听Bridge初始化完毕事件，显示第一个模块
                __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_5__bridge_BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT, self.onAllBridgesInit, self);
                // 注册并初始化表现层桥实例
                __WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */].registerBridge.apply(__WEBPACK_IMPORTED_MODULE_4__bridge_BridgeManager__["a" /* bridgeManager */], params.bridges);
            }
        }
    };
    /**
     * 添加错误监听函数
     *
     * @param {(evt?:ErrorEvent)=>void} handler 错误监听函数
     * @memberof Engine
     */
    Engine.prototype.listenError = function (handler) {
        if (handler)
            window.addEventListener("error", handler);
    };
    Engine.prototype.onAllBridgesInit = function () {
        return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](this, void 0, void 0, function () {
            var _i, _a, plugin, preloads, curIndex, totalCount;
            var _this = this;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        // 调用进度回调，表现层桥初始化完毕为30%
                        this._initStep = InitStep.BridgesInited;
                        this._initParams.onInitProgress && this._initParams.onInitProgress(0.3, this._initStep);
                        // 注销监听
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].unlisten(__WEBPACK_IMPORTED_MODULE_5__bridge_BridgeMessage__["a" /* default */].BRIDGE_ALL_INIT, this.onAllBridgesInit, this);
                        if (!this._initParams.plugins) return [3 /*break*/, 4];
                        _i = 0, _a = this._initParams.plugins;
                        _b.label = 1;
                    case 1:
                        if (!(_i < _a.length)) return [3 /*break*/, 4];
                        plugin = _a[_i];
                        return [4 /*yield*/, plugin.initPlugin()];
                    case 2:
                        _b.sent();
                        _b.label = 3;
                    case 3:
                        _i++;
                        return [3 /*break*/, 1];
                    case 4:
                        // 注册短名称
                        __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__["a" /* assetsManager */].configPath(this._initParams.pathDict);
                        preloads = this._initParams.preloads;
                        if (preloads) {
                            curIndex = 0;
                            totalCount = preloads.length;
                            __WEBPACK_IMPORTED_MODULE_3__assets_AssetsManager__["a" /* assetsManager */].loadAssets(preloads, this.onPreloadOK.bind(this), null, function (key, value) {
                                curIndex++;
                                // 调用进度回调，每个预加载文件平分30%-90%的进度
                                var progress = 0.3 + 0.6 * curIndex / totalCount;
                                // 保留2位小数
                                progress = Math.round(progress * 100) * 0.01;
                                _this._initStep = InitStep.Preload;
                                _this._initParams.onInitProgress && _this._initParams.onInitProgress(progress, _this._initStep, key, value);
                            });
                        }
                        else {
                            // 没有预加载，直接完成
                            this.onPreloadOK();
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    Engine.prototype.onPreloadOK = function () {
        return __WEBPACK_IMPORTED_MODULE_0_tslib__["a" /* __awaiter */](this, void 0, void 0, function () {
            var _a, i, data;
            return __WEBPACK_IMPORTED_MODULE_0_tslib__["d" /* __generator */](this, function (_b) {
                switch (_b.label) {
                    case 0:
                        // 调用进度回调，打开首个模块为90%
                        this._initStep = InitStep.OpenFirstModule;
                        this._initParams.onInitProgress && this._initParams.onInitProgress(0.9, this._initStep);
                        // 派发事件
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].dispatch(__WEBPACK_IMPORTED_MODULE_8__message_EngineMessage__["a" /* default */].INITIALIZED);
                        // 调用初始化完成回调
                        _a = this._initParams.onInited;
                        if (!_a) 
                        // 调用初始化完成回调
                        return [3 /*break*/, 2];
                        return [4 /*yield*/, this._initParams.onInited()];
                    case 1:
                        _a = (_b.sent());
                        _b.label = 2;
                    case 2:
                        // 调用初始化完成回调
                        _a;
                        // 监听首个模块开启
                        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].listen(__WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__["default"].MODULE_CHANGE, this.onModuleChange, this);
                        // 打开首个模块
                        __WEBPACK_IMPORTED_MODULE_9__module_ModuleManager__["moduleManager"].open(this._initParams.firstModule, __WEBPACK_IMPORTED_MODULE_7__env_Hash__["hash"].firstModuleParams);
                        // 如果有哈希模块则打开之
                        for (i in __WEBPACK_IMPORTED_MODULE_7__env_Hash__["hash"].moduleDatas) {
                            data = __WEBPACK_IMPORTED_MODULE_7__env_Hash__["hash"].moduleDatas[i];
                            // 如果模块没有名字则不进行操作
                            if (data.name)
                                __WEBPACK_IMPORTED_MODULE_9__module_ModuleManager__["moduleManager"].open(data.name, data.params, data.direct);
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    Engine.prototype.onModuleChange = function (from) {
        // 调用进度回调，全部过程完毕，100%
        this._initStep = InitStep.Inited;
        this._initParams.onInitProgress && this._initParams.onInitProgress(1, this._initStep);
        // 注销监听
        __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].unlisten(__WEBPACK_IMPORTED_MODULE_10__module_ModuleMessage__["default"].MODULE_CHANGE, this.onModuleChange, this);
        // 移除loadElement显示
        if (this._loadElement) {
            var parent = this._loadElement.parentElement;
            parent && parent.removeChild(this._loadElement);
        }
    };
    Engine = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], Engine);
    return Engine;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (Engine);
/** 再额外导出一个单例 */
var engine = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(Engine);


/***/ }),
/* 85 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-19
 * @modify date 2017-09-19
 *
 * 渲染模式枚举
*/
var RenderMode;
(function (RenderMode) {
    RenderMode[RenderMode["AUTO"] = 0] = "AUTO";
    RenderMode[RenderMode["CANVAS"] = 1] = "CANVAS";
    RenderMode[RenderMode["WEBGL"] = 2] = "WEBGL";
})(RenderMode || (RenderMode = {}));
/* harmony default export */ __webpack_exports__["a"] = (RenderMode);


/***/ }),
/* 86 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* unused harmony export ResourceVersionController */
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_panel_PanelManager__ = __webpack_require__(22);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_platform_PlatformManager__ = __webpack_require__(87);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_olympus_r_engine_version_Version__ = __webpack_require__(21);





var ResourceVersionController = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](ResourceVersionController, _super);
    function ResourceVersionController() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ResourceVersionController.prototype.getVirtualUrl = function (url) {
        // 添加imgDomain
        url = __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__["environment"].toCDNHostURL(url);
        // 添加版本号，有哈希值就用哈希值加载，没有就用编译版本号加载
        url = __WEBPACK_IMPORTED_MODULE_4_olympus_r_engine_version_Version__["a" /* version */].wrapHashUrl(url);
        // 返回url
        return url;
    };
    return ResourceVersionController;
}(RES.VersionController));

// 这里直接注册一下
RES.registerVersionController(new ResourceVersionController());
var AssetsLoader = /** @class */ (function () {
    function AssetsLoader(handler) {
        this._retryDict = {};
        this._handler = handler;
    }
    AssetsLoader.prototype.loadGroups = function (groups) {
        // 调用回调
        this._handler.start && this._handler.start();
        // 组名如果是空字符串则会导致Egret什么都不干，所以要移除空字符串的组名
        groups = groups && groups.filter(function (group) {
            if (typeof group == "string")
                return (group != "");
            else
                return (group.name != "");
        });
        // 开始加载
        var groupDict = {};
        var pgsDict;
        var len = groups ? groups.length : 0;
        if (len == 0) {
            this._handler.complete && this._handler.complete(groupDict);
        }
        else {
            RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
            RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
            RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
            var temp = groups.concat();
            pgsDict = {};
            for (var i in groups) {
                var group = groups[i];
                if (typeof group == "string") {
                    pgsDict[group] = 0;
                    RES.loadGroup(group);
                }
                else {
                    pgsDict[group.name] = 0;
                    RES.loadGroup(group.name, group.priority);
                }
            }
        }
        function onProgress(evt) {
            // 填充资源字典
            var itemDict = groupDict[evt.groupName];
            if (!itemDict)
                groupDict[evt.groupName] = itemDict = {};
            itemDict[evt.resItem.name] = evt.resItem;
            // 计算总进度
            pgsDict[evt.groupName] = evt.itemsLoaded / evt.itemsTotal;
            var pgs = 0;
            for (var key in pgsDict) {
                pgs += pgsDict[key];
            }
            pgs /= len;
            // 回调
            this._handler.progress && this._handler.progress(evt.resItem, pgs);
        }
        function onOneComplete(evt) {
            // 调用单一完毕回调
            this._handler.oneComplete && this._handler.oneComplete(groupDict[evt.groupName]);
            // 测试是否全部完毕
            var index = temp.indexOf(evt.groupName);
            if (index >= 0) {
                // 移除加载组名
                temp.splice(index, 1);
                // 判断是否全部完成
                if (temp.length == 0) {
                    // 移除事件监听
                    RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                    // 调用回调
                    this._handler.complete && this._handler.complete(groupDict);
                }
            }
        }
        function onOneError(evt) {
            var groupName = evt.groupName;
            var retryTimes = this._retryDict[groupName];
            if (retryTimes == null)
                retryTimes = 0;
            if (retryTimes < 3) {
                this._retryDict[groupName] = ++retryTimes;
                // 打印日志
                console.warn("加载失败，重试第" + retryTimes + "次: " + groupName);
                // 没到最大重试次数，将为url添加一个随机时间戳重新加回加载队列
                RES.loadGroup(evt.groupName);
            }
            else {
                // 打印日志
                console.warn("加载失败3次，正在尝试切换CDN...");
                // 尝试切换CDN
                var allDone = __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_env_Environment__["environment"].nextCDN();
                if (!allDone) {
                    // 重新加载
                    RES.loadGroup(evt.groupName);
                }
                else {
                    // 移除事件监听
                    RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                    RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                    // 调用模板方法
                    this._handler.oneError && this._handler.oneError(evt);
                    // 切换CDN失败了，弹出提示，使用户可以手动刷新页面
                    __WEBPACK_IMPORTED_MODULE_2_olympus_r_engine_panel_PanelManager__["a" /* panelManager */].confirm("资源组加载失败[" + groupName + "]，点击确定刷新页面", function () {
                        __WEBPACK_IMPORTED_MODULE_3_olympus_r_engine_platform_PlatformManager__["a" /* platformManager */].reload();
                    });
                }
            }
        }
    };
    return AssetsLoader;
}());
/* harmony default export */ __webpack_exports__["a"] = (AssetsLoader);


/***/ }),
/* 87 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return platformManager; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__core_Core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__WebPlatform__ = __webpack_require__(88);




/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 平台接口管理器，通过桥接模式统一不同平台的不同接口，从而实现对框架其他模块透明化
*/
var PlatformManager = /** @class */ (function () {
    function PlatformManager() {
        /**
         * 平台接口实现对象，默认是普通网页平台，也可以根据需要定制
         *
         * @type {IPlatform}
         * @memberof PlatformManager
         */
        this.platform = new __WEBPACK_IMPORTED_MODULE_3__WebPlatform__["a" /* default */]();
    }
    /**
     * 刷新当前页面
     *
     * @memberof PlatformManager
     */
    PlatformManager.prototype.reload = function () {
        this.platform.reload();
    };
    PlatformManager = __WEBPACK_IMPORTED_MODULE_0_tslib__["b" /* __decorate */]([
        __WEBPACK_IMPORTED_MODULE_2__core_injector_Injector__["Injectable"]
    ], PlatformManager);
    return PlatformManager;
}());
/* unused harmony default export */ var _unused_webpack_default_export = (PlatformManager);
/** 再额外导出一个单例 */
var platformManager = __WEBPACK_IMPORTED_MODULE_1__core_Core__["a" /* core */].getInject(PlatformManager);


/***/ }),
/* 88 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-21
 * @modify date 2017-09-21
 *
 * 网页平台接口实现类，也是平台接口的默认类
*/
var WebPlatform = /** @class */ (function () {
    function WebPlatform() {
    }
    WebPlatform.prototype.reload = function () {
        window.location.reload(true);
    };
    return WebPlatform;
}());
/* harmony default export */ __webpack_exports__["a"] = (WebPlatform);


/***/ }),
/* 89 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__ = __webpack_require__(90);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 回弹效果
*/
var BackPanelPolicy = /** @class */ (function () {
    function BackPanelPolicy() {
    }
    /**
     * 显示时调用
     * @param panel 弹出框对象
     * @param callback 完成回调，必须调用
     * @param from 动画起始点
     */
    BackPanelPolicy.prototype.pop = function (panel, callback, from) {
        // 开始动画弹出
        var entity = panel.skin;
        egret.Tween.removeTweens(entity);
        // 恢复体积
        entity.scaleX = 1;
        entity.scaleY = 1;
        var fromX = 0;
        var fromY = 0;
        if (from != null) {
            fromX = from.x;
            fromY = from.y;
        }
        else {
            fromX = entity.stage.stageWidth * 0.5;
            fromY = entity.stage.stageHeight * 0.5;
        }
        // 更新弹出后位置
        entity.x = fromX - entity.width * 0.5;
        entity.y = fromY - entity.height * 0.5;
        // 开始缓动
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__["a" /* tweenFrom */])(entity, {
            x: fromX,
            y: fromY,
            scaleX: 0,
            scaleY: 0
        }, 300, egret.Ease.backOut).call(callback);
    };
    /**
     * 关闭时调用
     * @param popup 弹出框对象
     * @param callback 完成回调，必须调用
     * @param to 动画完结点
     */
    BackPanelPolicy.prototype.drop = function (panel, callback, to) {
        // 开始动画关闭
        var entity = panel.skin;
        egret.Tween.removeTweens(entity);
        var toX = 0;
        var toY = 0;
        if (to != null) {
            toX = to.x;
            toY = to.y;
        }
        else {
            toX = entity.x + entity.width * 0.5;
            toY = entity.y + entity.height * 0.5;
        }
        Object(__WEBPACK_IMPORTED_MODULE_0__utils_TweenUtil__["b" /* tweenTo */])(entity, {
            x: toX,
            y: toY,
            scaleX: 0,
            scaleY: 0
        }, 300, egret.Ease.backIn).call(function () {
            // 恢复体积
            entity.scaleX = 1;
            entity.scaleY = 1;
            if (callback != null)
                callback();
        });
    };
    return BackPanelPolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (BackPanelPolicy);


/***/ }),
/* 90 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["b"] = tweenTo;
/* harmony export (immutable) */ __webpack_exports__["a"] = tweenFrom;
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * Egret缓动工具集，用来弥补Egret的Tween的不足
*/
function tweenTo(target, props, duration, ease) {
    return egret.Tween.get(target).to(props, duration, ease);
}
function tweenFrom(target, props, duration, ease) {
    // 对换参数状态
    var toProps = {};
    for (var key in props) {
        toProps[key] = target[key];
        target[key] = props[key];
    }
    // 开始缓动
    return egret.Tween.get(target).to(toProps, duration, ease);
}


/***/ }),
/* 91 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * 淡入淡出场景切换策略
*/
var FadeScenePolicy = /** @class */ (function () {
    function FadeScenePolicy() {
        this._tempSnapshot = new egret.Bitmap();
    }
    /**
     * 准备切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     */
    FadeScenePolicy.prototype.prepareSwitch = function (from, to) {
        if (from != null) {
            var root = from.bridge.root;
            // 截取当前屏幕
            var texture = new egret.RenderTexture();
            texture.drawToTexture(root);
            this._tempSnapshot.texture = texture;
            this._tempSnapshot.alpha = 1;
            root.addChild(this._tempSnapshot);
            // 移除from
            var fromDisplay = from.skin;
            if (fromDisplay.parent != null) {
                fromDisplay.parent.removeChild(fromDisplay);
            }
        }
    };
    /**
     * 切换场景时调度
     * @param from 切出的场景
     * @param to 切入的场景
     * @param callback 切换完毕的回调方法
     */
    FadeScenePolicy.prototype.switch = function (from, to, callback) {
        if (from != null) {
            // 开始淡出
            egret.Tween.removeTweens(this._tempSnapshot);
            egret.Tween.get(this._tempSnapshot).to({
                alpha: 0
            }, 300).call(function () {
                // 移除截屏
                if (this._tempSnapshot.parent != null) {
                    this._tempSnapshot.parent.removeChild(this._tempSnapshot);
                }
                // 回收资源
                if (this._tempSnapshot.texture != null) {
                    this._tempSnapshot.texture.dispose();
                    this._tempSnapshot.texture = null;
                }
                // 调用回调
                callback();
            }, this);
        }
        else {
            // 移除截屏
            if (this._tempSnapshot.parent != null) {
                this._tempSnapshot.parent.removeChild(this._tempSnapshot);
            }
            // 调用回调
            callback();
        }
    };
    return FadeScenePolicy;
}());
/* harmony default export */ __webpack_exports__["a"] = (FadeScenePolicy);


/***/ }),
/* 92 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__ = __webpack_require__(8);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__ = __webpack_require__(3);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__EgretBridge__ = __webpack_require__(28);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-25
 * @modify date 2017-10-25
 *
 * Egret遮罩实现
*/
var MaskEntityImpl = /** @class */ (function () {
    function MaskEntityImpl(params) {
        this._maskAlpha = 0.5;
        this._loadingAlpha = 0.5;
        this._modalPanelAlpha = 0.5;
        this._showingMask = false;
        this._showingLoading = false;
        if (params != null) {
            this._maskAlpha = (params.maskAlpha != null ? params.maskAlpha : 0.5);
            this._loadingAlpha = (params.loadingAlpha != null ? params.loadingAlpha : 0.5);
            this._modalPanelAlpha = (params.modalPanelAlpha != null ? params.modalPanelAlpha : 0.5);
            this._loadingSkinFactory = params.loadingSkinFactory;
        }
        this.maskData = params || {};
        this._mask = new egret.Shape();
        this._mask.touchEnabled = true;
        this._loadingMask = new egret.Shape();
        this._loadingMask.touchEnabled = true;
        this._modalPanelDict = new __WEBPACK_IMPORTED_MODULE_1_olympus_r_utils_Dictionary__["a" /* default */]();
        this._modalPanelList = [];
        this._modalPanelMask = new egret.Shape();
        this._modalPanelMask.touchEnabled = true;
    }
    Object.defineProperty(MaskEntityImpl.prototype, "loadingSkin", {
        get: function () {
            // 初始化皮肤
            if (!this._loadingSkin && this._loadingSkinFactory)
                this._loadingSkin = this._loadingSkinFactory();
            return this._loadingSkin;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 显示遮罩
     */
    MaskEntityImpl.prototype.showMask = function (alpha) {
        if (this._showingMask)
            return;
        this._showingMask = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._maskAlpha;
        this._mask.graphics.clear();
        this._mask.graphics.beginFill(0, alpha);
        this._mask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._mask.graphics.endFill();
        // 添加显示
        bridge.maskLayer.addChild(this._mask);
    };
    /**
     * 隐藏遮罩
     */
    MaskEntityImpl.prototype.hideMask = function () {
        if (!this._showingMask)
            return;
        this._showingMask = false;
        // 隐藏
        if (this._mask.parent != null)
            this._mask.parent.removeChild(this._mask);
    };
    /**当前是否在显示遮罩*/
    MaskEntityImpl.prototype.isShowingMask = function () {
        return this._showingMask;
    };
    /**
     * 显示加载图
     */
    MaskEntityImpl.prototype.showLoading = function (alpha) {
        if (this._showingLoading)
            return;
        this._showingLoading = true;
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._loadingAlpha;
        this._loadingMask.graphics.clear();
        this._loadingMask.graphics.beginFill(0, alpha);
        this._loadingMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._loadingMask.graphics.endFill();
        // 添加显示
        bridge.maskLayer.addChild(this._loadingMask);
        // 添加loading皮肤
        if (this.loadingSkin)
            bridge.maskLayer.addChild(this.loadingSkin);
    };
    /**
     * 隐藏加载图
     */
    MaskEntityImpl.prototype.hideLoading = function () {
        if (!this._showingLoading)
            return;
        this._showingLoading = false;
        // 隐藏
        if (this._loadingMask.parent != null)
            this._loadingMask.parent.removeChild(this._loadingMask);
        if (this.loadingSkin != null && this.loadingSkin.parent != null)
            this.loadingSkin.parent.removeChild(this._loadingSkin);
    };
    /**当前是否在显示loading*/
    MaskEntityImpl.prototype.isShowingLoading = function () {
        return this._showingLoading;
    };
    /** 显示模态窗口遮罩 */
    MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
        if (this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.set(panel, panel);
        this._modalPanelList.push(panel);
        // 显示
        var bridge = __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_bridge_BridgeManager__["a" /* bridgeManager */].getBridge(__WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE);
        // 绘制遮罩
        if (alpha == null)
            alpha = this._modalPanelAlpha;
        this._modalPanelMask.graphics.clear();
        this._modalPanelMask.graphics.beginFill(0, alpha);
        this._modalPanelMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
        this._modalPanelMask.graphics.endFill();
        // 添加显示
        var entity = panel.skin;
        var parent = entity.parent;
        if (parent != null) {
            if (this._modalPanelMask.parent) {
                this._modalPanelMask.parent.removeChild(this._modalPanelMask);
            }
            var index = parent.getChildIndex(entity);
            parent.addChildAt(this._modalPanelMask, index);
        }
    };
    /** 隐藏模态窗口遮罩 */
    MaskEntityImpl.prototype.hideModalMask = function (panel) {
        if (!this.isShowingModalMask(panel))
            return;
        this._modalPanelDict.delete(panel);
        this._modalPanelList.splice(this._modalPanelList.indexOf(panel), 1);
        // 判断是否还需要Mask
        if (this._modalPanelList.length <= 0) {
            // 隐藏
            if (this._modalPanelMask.parent != null)
                this._modalPanelMask.parent.removeChild(this._modalPanelMask);
        }
        else {
            // 移动Mask
            var entity = this._modalPanelList[this._modalPanelList.length - 1].skin;
            var parent = entity.parent;
            if (parent != null) {
                if (this._modalPanelMask.parent) {
                    this._modalPanelMask.parent.removeChild(this._modalPanelMask);
                }
                var index = parent.getChildIndex(entity);
                parent.addChildAt(this._modalPanelMask, index);
            }
        }
    };
    /** 当前是否在显示模态窗口遮罩 */
    MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
        return (this._modalPanelDict.get(panel) != null);
    };
    return MaskEntityImpl;
}());
/* harmony default export */ __webpack_exports__["a"] = (MaskEntityImpl);


/***/ }),
/* 93 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = wrapEUIList;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-17
 * @modify date 2017-10-17
 *
 * UI工具集
*/

/**
 * 包装EUI的DataGroup组件，使用传入的处理函数处理每个渲染器更新的逻辑
 *
 * @export
 * @param {eui.DataGroup} group 被包装的DataGroup组件
 * @param {(data?:any, renderer?:any)=>void} rendererHandler 渲染器处理函数，每次数据更新时会被调用，处理单个渲染器的渲染逻辑
 * @param {(datas?:eui.ICollection, group?:eui.DataGroup)=>void} [updateHandler] 数据更新处理函数，每次显示更新时会被调用，处理列表显示更新后的渲染逻辑
 */
function wrapEUIList(group, rendererHandler, updateHandler) {
    group.itemRenderer = ItemRenderer.bind(null, group.itemRendererSkinName, rendererHandler);
    if (updateHandler) {
        // 监听group尺寸是否改变
        var enterFrameHandler = function () {
            if (group.contentWidth > 0 || group.contentHeight > 0) {
                // 移除事件监听
                group.removeEventListener(egret.Event.ENTER_FRAME, enterFrameHandler, this);
                // 调用回调
                updateHandler(group.dataProvider, group);
            }
        };
        group.addEventListener(egret.Event.ENTER_FRAME, enterFrameHandler, this);
    }
}
var ItemRenderer = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](ItemRenderer, _super);
    function ItemRenderer(skinName, rendererHandler) {
        var _this = _super.call(this) || this;
        _this.skinName = skinName;
        _this._rendererHandler = rendererHandler;
        return _this;
    }
    ItemRenderer.prototype.dataChanged = function () {
        _super.prototype.dataChanged.call(this);
        this._rendererHandler(this.data, this);
    };
    return ItemRenderer;
}(eui.ItemRenderer));


/***/ }),
/* 94 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_tslib__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_core_command_Command__ = __webpack_require__(95);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__EgretBridge__ = __webpack_require__(28);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2018-02-05
 * @modify date 2018-02-05
 *
 * 这个命令是为了修复egret在display==none时获取自身尺寸是空尺寸的bug
*/
var UpdateScreenSizeCommand = /** @class */ (function (_super) {
    __WEBPACK_IMPORTED_MODULE_0_tslib__["c" /* __extends */](UpdateScreenSizeCommand, _super);
    function UpdateScreenSizeCommand() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UpdateScreenSizeCommand.prototype.exec = function () {
        var params = this.msg.params;
        var to = params[0];
        var from = params[1];
        if (to && to.bridge.type === __WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE && from && from.bridge.type !== __WEBPACK_IMPORTED_MODULE_2__EgretBridge__["default"].TYPE) {
            // 是从其他类型场景跳转回来的，为了防止在其他场景触发过resize导致egret尺寸失效，更新一次屏幕尺寸
            egret.updateAllScreens();
        }
    };
    return UpdateScreenSizeCommand;
}(__WEBPACK_IMPORTED_MODULE_1_olympus_r_core_command_Command__["a" /* default */]));
/* harmony default export */ __webpack_exports__["a"] = (UpdateScreenSizeCommand);


/***/ }),
/* 95 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__Core__ = __webpack_require__(1);

/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-01
 * @modify date 2017-09-01
 *
 * 内核命令类，内核命令在注册了消息后可以在消息派发时被执行
*/
var Command = /** @class */ (function () {
    function Command(msg) {
        this.msg = msg;
    }
    Command.prototype.dispatch = function (typeOrMsg) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        __WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */].dispatch.apply(__WEBPACK_IMPORTED_MODULE_0__Core__["a" /* core */], [typeOrMsg].concat(params));
    };
    return Command;
}());
/* harmony default export */ __webpack_exports__["a"] = (Command);


/***/ }),
/* 96 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (immutable) */ __webpack_exports__["a"] = wrapSkin;
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_mediator_MediatorStatus__ = __webpack_require__(18);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_scene_SceneMediator__ = __webpack_require__(15);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__ = __webpack_require__(6);



/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-09
 * @modify date 2017-10-09
 *
 * Egret皮肤工具集
*/
function wrapSkin(mediator, skin) {
    var result;
    var comp = getComponent(skin);
    if (!comp && !(skin instanceof egret.DisplayObject)) {
        var compCls = ((mediator.skin instanceof eui.Component && mediator.skin.constructor) || eui.Component);
        comp = new compCls();
        comp.skinName = skin;
        result = comp;
    }
    else {
        result = skin;
    }
    // 判断中介者当前状态
    if (mediator.status < __WEBPACK_IMPORTED_MODULE_0_olympus_r_engine_mediator_MediatorStatus__["a" /* default */].OPENING) {
        Object(__WEBPACK_IMPORTED_MODULE_2_olympus_r_utils_ConstructUtil__["b" /* listenApply */])(mediator, "onOpen", doWrapSkin);
    }
    else {
        // 直接执行要执行的
        doWrapSkin();
    }
    return result;
    function doWrapSkin() {
        // 场景需要拉伸到与stage同宽高
        if (mediator instanceof __WEBPACK_IMPORTED_MODULE_1_olympus_r_engine_scene_SceneMediator__["default"]) {
            comp.percentWidth = 100;
            comp.percentHeight = 100;
        }
        // 启动引用转发
        if (result instanceof egret.DisplayObjectContainer && comp && comp.skin) {
            // 转发ui引用，如果传入的是显示对象，则需要判断目标是否属于该对象的后裔
            var needJudgeDescendant = (skin instanceof egret.DisplayObjectContainer);
            for (var _i = 0, _a = comp.skin.skinParts; _i < _a.length; _i++) {
                var name = _a[_i];
                var target = comp[name];
                if (!needJudgeDescendant || isDescendant(target, skin))
                    mediator[name] = target;
            }
        }
    }
}
function getComponent(skin) {
    if (!(skin instanceof egret.DisplayObject))
        return null;
    if (skin instanceof eui.Component && skin.skin)
        return skin;
    return getComponent(skin.parent);
}
function isDescendant(descendant, ascendant) {
    return (descendant !== ascendant && contains(descendant, ascendant));
}
function contains(target, parent) {
    if (!target || !parent)
        return false;
    if (target === parent)
        return true;
    return contains(target.parent, parent);
}


/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgNWIyNjFiNzAyZGU3OTZlZjA0MDMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL0NvcmUuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnkuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL09iamVjdFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9lbnYvRW52aXJvbm1lbnQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci91dGlscy9VUkxVdGlsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9saWJzL1JlZmxlY3QuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvTmV0TWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tYXNrL01hc2tNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvclN0YXR1cy5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9pbmplY3Rvci9JbmplY3Rvci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9nbG9iYWwvUGF0Y2guanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS92ZXJzaW9uL1ZlcnNpb24uanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL1V0aWxzLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc3lzdGVtL1N5c3RlbS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL0RPTUJyaWRnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9AdHdlZW5qcy90d2Vlbi5qcy9zcmMvVHdlZW4uanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L0VncmV0QnJpZGdlLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvb2JzZXJ2YWJsZS9PYnNlcnZhYmxlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvTWVzc2FnZS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9tZXNzYWdlL0NvcmVNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci91dGlscy9BcnJheVV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvaW50ZXJmYWNlcy9KU0ZpbGUuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0hUVFBVdGlsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9CaW5kTWFuYWdlci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvRGlzcGxheVV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9JTWVkaWF0b3JNb2R1bGVQYXJ0LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvU2NlbmVNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvU2NlbmVNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYnJpZGdlL0JyaWRnZU1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVxdWVzdERhdGEuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL1dhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVzcG9uc2VEYXRhLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L0RhdGFUeXBlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9UYWdJbXBsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NZXNzYWdlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbWVzc2FnZS9FbmdpbmVNZXNzYWdlLmpzIiwid2VicGFjazovLy8uL3Rlc3QvbW9kZWxzL0Z1Y2tNb2RlbC50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Vudi9IYXNoLmpzIiwid2VicGFjazovLy8uL3Rlc3QvbmV0L3Jlc3BvbnNlL1Rlc3RSZXNwb25zZS50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvU2Vjb25kLnRzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9pbmplY3Rvci9JbmplY3Rvci5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvVGVzdFBhbmVsLnRzIiwid2VicGFjazovLy8uL3Rlc3QvbWFpbi50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvRmlyc3QudHMiLCJ3ZWJwYWNrOi8vLyh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9tZXNzYWdlL0NvbW1vbk1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9JUHJvbXB0UGFuZWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9Ob25lUGFuZWxQb2xpY3kuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL1N5bmNVdGlsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvTm9uZVNjZW5lUG9saWN5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L05ldE1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0JpbmQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL011dGF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0RlcC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0JpbmRVdGlsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vZG9tL21hc2svTWFza0VudGl0eS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS91dGlscy9Ta2luVXRpbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9wYW5lbC9CYWNrUGFuZWxQb2xpY3kuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWRvbS9kb20vc2NlbmUvRmFkZVNjZW5lUG9saWN5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvZW52L1NoZWxsLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9Db250ZXh0SW1wbC5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25ldC9yZXF1ZXN0L1Rlc3RSZXF1ZXN0LnRzIiwid2VicGFjazovLy8uL3Rlc3QvbmV0L3R5cGUvVGVzdC50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL25ldC9wb2xpY2llcy9IVFRQUmVxdWVzdFBvbGljeS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L21vZHVsZXMvVGVzdENvbXAudHMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9tb2R1bGVzL1Rlc3RGb3JNZWRpYXRvci50cyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BhbmVsL1BhbmVsTWVkaWF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9tb2R1bGVzL1RoaXJkLnRzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9PbHltcHVzLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvRW5naW5lLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9SZW5kZXJNb2RlLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9Bc3NldHNMb2FkZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wbGF0Zm9ybS9QbGF0Zm9ybU1hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wbGF0Zm9ybS9XZWJQbGF0Zm9ybS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvcGFuZWwvQmFja1BhbmVsUG9saWN5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9Ud2VlblV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3NjZW5lL0ZhZGVTY2VuZVBvbGljeS5qcyIsIndlYnBhY2s6Ly8vLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvbWFzay9NYXNrRW50aXR5LmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9VSVV0aWwuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L2NvbW1hbmQvVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQuanMiLCJ3ZWJwYWNrOi8vLy4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvY29tbWFuZC9Db21tYW5kLmpzIiwid2VicGFjazovLy8uL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9Ta2luVXRpbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4REFBc0QsK0RBQStEOztBQUVySDtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDN0RBO0FBQUE7QUFDQTtBQUNBLCtEQUErRDtBQUMvRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFVLGdCQUFnQixzQ0FBc0MsaUJBQWlCLEVBQUU7QUFDbkYseUJBQXlCLHVEQUF1RDtBQUNoRjtBQUNBOztBQUVBO0FBQ0E7QUFDQSxtQkFBbUIsc0JBQXNCO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdEQUFnRCxPQUFPO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0REFBNEQsY0FBYztBQUMxRTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsNENBQTRDLFFBQVE7QUFDcEQ7QUFDQTs7QUFFQTtBQUNBLG1D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QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsZ0JBQWdCO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxnQkFBZ0I7QUFDakU7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsbUJBQW1CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJEQUEyRCx3QkFBd0I7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtFQUE0QyxRQUFRO0FBQ3BEO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRUFBNEMsUUFBUTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDbnNCQTtBQUNlO0FBQ007QUFDSTtBQUNFO0FBQ1A7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLFFBQVE7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxRQUFRO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELHVCQUF1QjtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCwwQkFBMEI7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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OztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxrQkFBa0IscUJBQXFCOztBQUV2Qzs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsdUNBQXVDO0FBQ3ZDOztBQUVBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUEsZ0VBQWdFLHNCQUFzQjtBQUN0RjtBQUNBOztBQUVBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7QUFDQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLElBQUk7O0FBRUo7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7O0FBRUEsSUFBSTs7QUFFSjs7QUFFQTtBQUNBOztBQUVBLGtFQUFrRSxzQkFBc0I7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7O0FBR0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBLEdBQUc7O0FBRUg7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7O0FBRUE7O0FBRUEsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBLEVBQUU7O0FBRUY7O0FBRUE7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTs7QUFFQTs7QUFFQSxHQUFHOztBQUVIOztBQUVBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxtQkFBbUIsT0FBTztBQUMxQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUEsR0FBRzs7QUFFSDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFBQTs7QUFFSCxFQUFFOztBQUVGO0FBQ0E7O0FBRUEsRUFBRTs7QUFFRjtBQUNBOztBQUVBOztBQUVBLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwNUJEO0FBQUE7QUFDZTtBQUNmO0FBQ0E7QUFDc0I7QUFDSztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ3NCO0FBQ3RCO0FBQ21CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtB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QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOzs7Ozs7O0FDNXhCRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEscUNBQXFDOztBQUVyQztBQUNBO0FBQ0E7O0FBRUEsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixVQUFVOzs7Ozs7Ozs7O0FDdkx0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFEQUFxRCx5QkFBeUI7QUFDOUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOzBFQUNEO0FBQ0E7QUFDQTs7Ozs7Ozs7QUNwTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7OztBQ3JDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7OztBQ3JDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQjtBQUNsQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7Ozs7Ozs7OztBQzNGeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsa0NBQWtDOzs7Ozs7OztBQ3BRbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FB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REFBNkQsK0JBQStCO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCx1REFBdUQsRUFBRTtBQUM1RztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxFQUFFO0FBQ2IsV0FBVyxFQUFFO0FBQ2IsV0FBVyxxREFBcUQ7QUFDaEUsV0FBVyxPQUFPO0FBQ2xCO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUNuU3dCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDs7Ozs7Ozs7Ozs7Ozs7Ozs7QUN2S3dCO0FBQ3hCO0FBQ3NCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsVUFBVTtBQUNyQixXQUFXLDhCQUE4QjtBQUN6QyxhQUFhLFlBQVk7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsT0FBTztBQUNsQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxPQUFPO0FBQ2xCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxZQUFZO0FBQ3ZCLFdBQVcsRUFBRTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDhCQUE4QjtBQUN6QyxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxrQkFBa0I7QUFDN0IsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQ3hId0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7Ozs7QUNqRXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseURBQXlEO0FBQ3pELDBEQUEwRDtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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ZUFBZSxnQkFBZ0I7QUFDL0IsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsd0JBQXdCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7MEVBQ0Q7QUFDQTtBQUNBOzs7Ozs7OztBQy9PQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsZ0NBQWdDO0FBQ2pDOzs7Ozs7Ozs7Ozs7OztBQ2RBO0FBQ3NCO0FBQ0M7QUFDRztBQUNSO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ087QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7Ozs7O0FDeElBO0FBQ2U7QUFDTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTs7Ozs7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7QUNoQjZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7QUNqRkE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7Ozs7O0FDdEV3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7Ozs7Ozs7OztBQzlLQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxjQUFjO0FBQ3pCLFdBQVcsaUNBQWlDO0FBQzVDLFdBQVcscURBQXFEO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOzs7Ozs7Ozs7OztBQzdDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7QUMzQmU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEOzs7Ozs7Ozs7Ozs7QUN0QkE7QUFDQTtBQUNzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsZ0JBQWdCO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA1NSk7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gd2VicGFjay9ib290c3RyYXAgNWIyNjFiNzAyZGU3OTZlZjA0MDMiLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzXG4vLyBtb2R1bGUgaWQgPSAwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBcIi4uL2xpYnMvUmVmbGVjdFwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgKiBhcyBQYXRjaCBmcm9tIFwiLi9nbG9iYWwvUGF0Y2hcIjtcclxuaW1wb3J0IE9ic2VydmFibGUgZnJvbSBcIi4vb2JzZXJ2YWJsZS9PYnNlcnZhYmxlXCI7XHJcblBhdGNoO1xyXG4vKipcclxuICog5qC45b+D5LiK5LiL5paH5a+56LGh77yM6LSf6LSj5YaF5qC45raI5oGv6L2s5Y+R44CB5a+56LGh5rOo5YWl562J5qC45b+D5Yqf6IO955qE5a6e546wXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQGNsYXNzIENvcmVcclxuICovXHJcbnZhciBDb3JlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29yZSgpIHtcclxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5LiL6Z2i5piv5YaF5qC45raI5oGv57O757ufICoqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZSgpO1xyXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKiDkuIvpnaLmmK/kvp3otZbms6jlhaXns7vnu58gKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6K6w5b2V5bey57uP5rOo5YWl6L+H55qE5a+56LGh5Y2V5L6LXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEB0eXBlIHtEaWN0aW9uYXJ5PEZ1bmN0aW9uLCBhbnk+fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5faW5qZWN0RGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5rOo5YWl5a2X56ym5Liy57G75Z6L5a2X5YW477yM6K6w5b2V5rOo5YWl5a2X56ym5Liy5ZKM57G75Z6L5p6E6YCg5Ye95pWw55qE5pig5bCEXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqIEB0eXBlIHtEaWN0aW9uYXJ5PGFueSwgSUNvbnN0cnVjdG9yPn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2luamVjdFN0ckRpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIC8vIOi/m+ihjOWNleS+i+WIpOaWrVxyXG4gICAgICAgIGlmIChDb3JlLl9pbnN0YW5jZSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi5bey55Sf5oiQ6L+HQ29yZeWunuS+i++8jOS4jeWFgeiuuOWkmuasoeeUn+aIkFwiKTtcclxuICAgICAgICAvLyDotYvlgLzljZXkvotcclxuICAgICAgICBDb3JlLl9pbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgLy8g5rOo5YWl6Ieq6LqrXHJcbiAgICAgICAgdGhpcy5tYXBJbmplY3RWYWx1ZSh0aGlzKTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb3JlLnByb3RvdHlwZSwgXCJkaXNwb3NlZFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29yZeeahGRpc3Bvc2Vk5bGe5oCn5rKh5pyJ5Lu75L2V5L2c55So77yM5LuF5Li65LqG5a6e546w5o6l5Y+j77yM5aeL57uI5Lya6L+U5ZueZmFsc2VcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb3JlLnByb3RvdHlwZSwgXCJvYnNlcnZhYmxlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlsIZJT2JzZXJ2YWJsZeaatOmcsuWHuuadpVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZhYmxlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvcmUucHJvdG90eXBlLCBcInBhcmVudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Yiw54i257qnSU9ic2VydmFibGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJT2JzZXJ2YWJsZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKiBkaXNwYXRjaOaWueazleWunueOsCAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLmRpc3BhdGNoLmFwcGx5KHRoaXMuX29ic2VydmFibGUsIHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzlhoXmoLjmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbmmK/kuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgKi9cclxuICAgIENvcmUucHJvdG90eXBlLmxpc3RlbiA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLmxpc3Rlbih0eXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOWGheaguOa2iOaBr+ebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOa2iOaBr+exu+Wei1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDmtojmga/lpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIOa2iOaBr3RoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9ZmFsc2VdIOaYr+WQpuaYr+S4gOasoeaAp+ebkeWQrFxyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUudW5saXN0ZW4gPSBmdW5jdGlvbiAodHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSkge1xyXG4gICAgICAgIGlmIChvbmNlID09PSB2b2lkIDApIHsgb25jZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZS51bmxpc3Rlbih0eXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOWRveS7pOWIsOeJueWumua2iOaBr+exu+Wei+S4iu+8jOW9k+i/meS4quexu+Wei+eahOa2iOaBr+a0vuWPkeWIsOahhuaetuWGheaguOaXtuS8muinpuWPkUNvbW1hbmTov5DooYxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDopoHms6jlhoznmoTmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7KElDb21tYW5kQ29uc3RydWN0b3IpfSBjbWQg5ZG95Luk5aSE55CG5Zmo77yM5Y+v5Lul5piv5pa55rOV5b2i5byP77yM5Lmf5Y+v5Lul5L2/57G75b2i5byPXHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUubWFwQ29tbWFuZCh0eXBlLCBjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA5ZG95LukXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo6ZSA55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqFxyXG4gICAgICogQHJldHVybnMge3ZvaWR9XHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS51bm1hcENvbW1hbmQgPSBmdW5jdGlvbiAodHlwZSwgY21kKSB7XHJcbiAgICAgICAgdGhpcy5fb2JzZXJ2YWJsZS51bm1hcENvbW1hbmQodHlwZSwgY21kKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOS4gOS4quexu+Wei+azqOWFpe+8jOS8mueri+WNs+eUn+aIkOS4gOS4quWunuS+i+W5tuazqOWFpeWIsOahhuaetuWGheaguOS4rVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfSB0YXJnZXQg6KaB5rOo5YWl55qE57G75Z6L77yI5rOo5oSP5LiN5piv5a6e5L6L77yJXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0eXBlXSDlpoLmnpzmj5Dkvpvor6Xlj4LmlbDvvIzliJnkvb/nlKjor6Xnsbvlnovku6Pmm7/ms6jlhaXnsbvlnovnmoRrZXnvvIzlkKbliJnkvb/nlKjms6jlhaXnsbvlnovoh6rouqvkvZzkuLprZXlcclxuICAgICAqIEBtZW1iZXJvZiBDb3JlXHJcbiAgICAgKi9cclxuICAgIENvcmUucHJvdG90eXBlLm1hcEluamVjdCA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUpIHtcclxuICAgICAgICAvLyDlpoLmnpzlt7Lnu4/ms6jlhaXov4fkuobvvIzliJnkvb/nlKjlt7Lnu4/ms6jlhaXnmoTljZXkvovlho3mrKHms6jlhaVcclxuICAgICAgICB2YXIgb3JpVGFyZ2V0ID0gdGFyZ2V0W1wiX19vcmlfY29uc3RydWN0b3JfX1wiXSB8fCB0YXJnZXQ7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5faW5qZWN0RGljdC5nZXQob3JpVGFyZ2V0KSB8fCBuZXcgdGFyZ2V0KCk7XHJcbiAgICAgICAgdGhpcy5tYXBJbmplY3RWYWx1ZSh2YWx1ZSwgdHlwZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhaXkuIDkuKrlr7nosaHlrp7kvotcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIOimgeazqOWFpeeahOWvueixoeWunuS+i1xyXG4gICAgICogQHBhcmFtIHsqfSBbdHlwZV0g5aaC5p6c5o+Q5L6b6K+l5Y+C5pWw77yM5YiZ5L2/55So6K+l57G75Z6L5Luj5pu/5rOo5YWl57G75Z6L55qEa2V577yM5ZCm5YiZ5L2/55So5rOo5YWl5a6e5L6L55qE5p6E6YCg5Ye95pWw5L2c5Li6a2V5XHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS5tYXBJbmplY3RWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgdHlwZSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+Wtl+espuS4suWImeiusOW9leexu+Wei+aehOmAoOWHveaVsOaYoOWwhFxyXG4gICAgICAgIGlmICghKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbikgfHwgIXR5cGUucHJvdG90eXBlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luamVjdFN0ckRpY3Quc2V0KHR5cGUsIHZhbHVlLmNvbnN0cnVjdG9yKTtcclxuICAgICAgICAgICAgdHlwZSA9IHZhbHVlLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDorrDlvZXlt7Lms6jlhaXnmoTljZXkvotcclxuICAgICAgICB0aGlzLl9pbmplY3REaWN0LnNldCh2YWx1ZS5jb25zdHJ1Y3RvciwgdmFsdWUpO1xyXG4gICAgICAgIC8vIOW8gOWni+azqOWFpVxyXG4gICAgICAgIFJlZmxlY3QuZGVmaW5lTWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCB2YWx1ZSwgdHlwZVtcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgdHlwZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTnsbvlnovms6jlhaVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHR5cGUg6KaB56e76Zmk5rOo5YWl55qE57G75Z6LXHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS51bm1hcEluamVjdCA9IGZ1bmN0aW9uICh0eXBlKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5a2X56ym5Liy5YiZ6K6w5b2V57G75Z6L5p6E6YCg5Ye95pWw5pig5bCEXHJcbiAgICAgICAgaWYgKCEodHlwZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB8fCAhdHlwZS5wcm90b3R5cGUpXHJcbiAgICAgICAgICAgIHR5cGUgPSB0aGlzLl9pbmplY3RTdHJEaWN0LmdldCh0eXBlKTtcclxuICAgICAgICBSZWZsZWN0LmRlbGV0ZU1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgdHlwZVtcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgdHlwZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bms6jlhaXnmoTlr7nosaHlrp7kvotcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHR5cGUg5rOo5YWl5a+56LGh55qE57G75Z6LXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0g5rOo5YWl55qE5a+56LGh5a6e5L6LXHJcbiAgICAgKiBAbWVtYmVyb2YgQ29yZVxyXG4gICAgICovXHJcbiAgICBDb3JlLnByb3RvdHlwZS5nZXRJbmplY3QgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgICAgIGlmICghKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbikgfHwgIXR5cGUucHJvdG90eXBlKVxyXG4gICAgICAgICAgICB0eXBlID0gdGhpcy5faW5qZWN0U3RyRGljdC5nZXQodHlwZSk7XHJcbiAgICAgICAgaWYgKHR5cGUpIHtcclxuICAgICAgICAgICAgLy8g6ZyA6KaB55So5Y6f5aeL55qE5p6E6YCg5Ye95pWw5Y+WXHJcbiAgICAgICAgICAgIHR5cGUgPSB0eXBlW1wiX19vcmlfY29uc3RydWN0b3JfX1wiXSB8fCB0eXBlO1xyXG4gICAgICAgICAgICByZXR1cm4gUmVmbGVjdC5nZXRNZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIHR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENvcmXnmoRkaXNwb3Nl5pa55rOV5rKh5pyJ5Lu75L2V5L2c55So77yM5LuF5Li65LqG5a6e546w5o6l5Y+jXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIENvcmVcclxuICAgICAqL1xyXG4gICAgQ29yZS5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQ29yZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQ29yZTtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGNvcmUgPSBuZXcgQ29yZSgpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL0NvcmUuanNcbi8vIG1vZHVsZSBpZCA9IDFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IFwiLi4vLi4vbGlicy9SZWZsZWN0XCI7XHJcbmltcG9ydCB7IGxpc3RlbkNvbnN0cnVjdCB9IGZyb20gXCIuLi8uLi91dGlscy9Db25zdHJ1Y3RVdGlsXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vQ29yZVwiO1xyXG5pbXBvcnQgeyBkZWNvcmF0ZVRoaXMgfSBmcm9tIFwiLi4vZ2xvYmFsL1BhdGNoXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOVxyXG4gKlxyXG4gKiBDb3Jl5qih57uE55qE6KOF6aWw5Zmo5rOo5YWl5qih5Z2XXHJcbiovXHJcbi8qKiDnlJ/miJDnsbvlnovlrp7kvovlubbms6jlhaXvvIzlj6/ku6Xov5vooYznsbvlnovovazmjaLms6jlhaXvvIjljbPms6jlhaXnsbvlnovlj6/ku6Xlkozms6jlhoznsbvlnovkuI3kuIDoh7TvvIzph4fnlKhASW5qZWN0YWJsZShBbm90aGVyQ2xhc3Mp55qE5b2i5byP5Y2z5Y+v77yJICovXHJcbmV4cG9ydCBmdW5jdGlvbiBJbmplY3RhYmxlKCkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMgPT09IGRlY29yYXRlVGhpcykge1xyXG4gICAgICAgIC8vIOS4jemcgOimgei9rOaNouazqOWGjOexu+Wei++8jOebtOaOpeazqOWGjFxyXG4gICAgICAgIGNvcmUubWFwSW5qZWN0KGFyZ3NbMF0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g6ZyA6KaB6L2s5o2i5rOo5YaM57G75Z6L77yM6ZyA6KaB6L+U5Zue5LiA5LiqQ2xhc3NEZWNvcmF0b3JcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHJlYWxDbHMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhcmdzXzEgPSBhcmdzOyBfaSA8IGFyZ3NfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbHMgPSBhcmdzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgLy8g5rOo5YWl57G75Z6LXHJcbiAgICAgICAgICAgICAgICBjb3JlLm1hcEluamVjdChyZWFsQ2xzLCBjbHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOmcgOimgei9rOaNoueahOS5n+imgemineWkluWwhuiHqui6q+azqOWFpeS4gOS4qlxyXG4gICAgICAgICAgICBjb3JlLm1hcEluamVjdChyZWFsQ2xzKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbjtcclxuZXhwb3J0IGZ1bmN0aW9uIEluamVjdCh0YXJnZXQsIGtleSkge1xyXG4gICAgaWYgKGtleSkge1xyXG4gICAgICAgIHZhciBjbHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgdGFyZ2V0LCBrZXkpO1xyXG4gICAgICAgIGRvSW5qZWN0KHRhcmdldC5jb25zdHJ1Y3Rvciwga2V5LCBjbHMpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGRvSW5qZWN0KHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgcHJvcGVydHlLZXksIHRhcmdldCk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG47XHJcbmZ1bmN0aW9uIGRvSW5qZWN0KGNscywga2V5LCB0eXBlKSB7XHJcbiAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgIHZhciB0YXJnZXQ7XHJcbiAgICBsaXN0ZW5Db25zdHJ1Y3QoY2xzLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaW5zdGFuY2UsIGtleSwge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGFyZ2V0IHx8ICh0YXJnZXQgPSBjb3JlLmdldEluamVjdCh0eXBlKSk7IH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZ2V0T2JqZWN0SGFzaCB9IGZyb20gXCIuL09iamVjdFV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE1XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE1XHJcbiAqXHJcbiAqIOWtl+WFuO+8jOaUr+aMgWtleeS4uuS7u+aEj+exu+Wei+eahOWvueixoVxyXG4qL1xyXG52YXIgRGljdGlvbmFyeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERpY3Rpb25hcnkoKSB7XHJcbiAgICAgICAgdGhpcy5fa2V5RGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlRGljdCA9IHt9O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERpY3Rpb25hcnkucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWtl+WFuOWGheeahOWFg+e0oOaVsOmHj1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRGljdGlvbmFyeVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2l6ZSA9IDA7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdClcclxuICAgICAgICAgICAgICAgIHNpemUrKztcclxuICAgICAgICAgICAgcmV0dXJuIHNpemU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGljdGlvbmFyeS5wcm90b3R5cGUsIFwia2V5c1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5a2X5YW4a2V555qE6ZuG5ZCIXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7S1tdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBEaWN0aW9uYXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdCkge1xyXG4gICAgICAgICAgICAgICAga2V5cy5wdXNoKHRoaXMuX2tleURpY3RbaGFzaF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERpY3Rpb25hcnkucHJvdG90eXBlLCBcInZhbHVlc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5a2X5YW45YC855qE6ZuG5ZCIXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7VltdfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBEaWN0aW9uYXJ5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaGFzaCBpbiB0aGlzLl92YWx1ZURpY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKHRoaXMuX3ZhbHVlRGljdFtoYXNoXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5LiA5Liq6ZSu5YC85a+5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtLfSBrZXkg6ZSuXHJcbiAgICAgKiBAcGFyYW0ge1Z9IHZhbHVlIOWAvFxyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgaGFzaCA9IGdldE9iamVjdEhhc2goa2V5KTtcclxuICAgICAgICB0aGlzLl9rZXlEaWN0W2hhc2hdID0ga2V5O1xyXG4gICAgICAgIHRoaXMuX3ZhbHVlRGljdFtoYXNoXSA9IHZhbHVlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5LiA5Liq5YC8XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtLfSBrZXkg6ZSuXHJcbiAgICAgKiBAcmV0dXJucyB7Vn0g5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgRGljdGlvbmFyeVxyXG4gICAgICovXHJcbiAgICBEaWN0aW9uYXJ5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGhhc2ggPSBnZXRPYmplY3RIYXNoKGtleSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlRGljdFtoYXNoXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIoOmZpOS4gOS4qumUruWAvOWvuVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7S30ga2V5IOmUrlxyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBoYXNoID0gZ2V0T2JqZWN0SGFzaChrZXkpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9rZXlEaWN0W2hhc2hdO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl92YWx1ZURpY3RbaGFzaF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpgY3ljoblrZflhbhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhrZXk6SywgdmFsdWU6Vik9PnZvaWR9IGNhbGxiYWNrIOavj+asoemBjeWOhueahOWbnuiwg1xyXG4gICAgICogQG1lbWJlcm9mIERpY3Rpb25hcnlcclxuICAgICAqL1xyXG4gICAgRGljdGlvbmFyeS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xyXG4gICAgICAgIGZvciAodmFyIGhhc2ggaW4gdGhpcy5fa2V5RGljdCkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gdGhpcy5fa2V5RGljdFtoYXNoXTtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5fdmFsdWVEaWN0W2hhc2hdO1xyXG4gICAgICAgICAgICBjYWxsYmFjayhrZXksIHZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERpY3Rpb25hcnk7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IERpY3Rpb25hcnk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0RpY3Rpb25hcnkuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTExXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTExXHJcbiAqXHJcbiAqIOWvueixoeW3peWFt+mbhlxyXG4qL1xyXG4vKipcclxuICogcG9wdWxhdGUgcHJvcGVydGllc1xyXG4gKiBAcGFyYW0gdGFyZ2V0ICAgICAgICDnm67moIdvYmpcclxuICogQHBhcmFtIHNvdXJjZXMgICAgICAg5p2l5rqQb2JqXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kT2JqZWN0KHRhcmdldCkge1xyXG4gICAgdmFyIHNvdXJjZXMgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgc291cmNlc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIHNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlKSB7XHJcbiAgICAgICAgaWYgKCFzb3VyY2UpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICBmb3IgKHZhciBwcm9wTmFtZSBpbiBzb3VyY2UpIHtcclxuICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldFtwcm9wTmFtZV0gPSBzb3VyY2VbcHJvcE5hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdGFyZ2V0O1xyXG59XHJcbi8qKlxyXG4gKiDlpI3liLblr7nosaFcclxuICogQHBhcmFtIHRhcmdldCDopoHlpI3liLbnmoTlr7nosaFcclxuICogQHBhcmFtIGRlZXAg5piv5ZCm5rex6KGo5aSN5Yi277yM6buY6K6k5rWF6KGo5aSN5Yi2XHJcbiAqIEByZXR1cm5zIHthbnl9IOWkjeWItuWQjueahOWvueixoVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsb25lT2JqZWN0KHRhcmdldCwgZGVlcCkge1xyXG4gICAgaWYgKGRlZXAgPT09IHZvaWQgMCkgeyBkZWVwID0gZmFsc2U7IH1cclxuICAgIGlmICh0YXJnZXQgPT0gbnVsbClcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIHZhciBuZXdPYmplY3QgPSB0YXJnZXQgaW5zdGFuY2VvZiBBcnJheSA/IFtdIDogT2JqZWN0LmNyZWF0ZShPYmplY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KSk7XHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHRhcmdldCk7XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMSA9IGtleXM7IF9pIDwga2V5c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBrZXkgPSBrZXlzXzFbX2ldO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgIGlmIChkZWVwICYmIHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOaYr+a3seihqOWkjeWItu+8jOWImemcgOimgemAkuW9kuWkjeWItuWtkOWvueixoVxyXG4gICAgICAgICAgICB2YWx1ZSA9IGNsb25lT2JqZWN0KHZhbHVlLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbmV3T2JqZWN0W2tleV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXdPYmplY3Q7XHJcbn1cclxuLyoqXHJcbiAqIOeUn+aIkOS4gOS4qumaj+acuklEXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0R1VJRCgpIHtcclxuICAgIHZhciBzID0gW107XHJcbiAgICB2YXIgaGV4RGlnaXRzID0gXCIwMTIzNDU2Nzg5YWJjZGVmXCI7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM2OyBpKyspIHtcclxuICAgICAgICBzW2ldID0gaGV4RGlnaXRzLnN1YnN0cihNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAweDEwKSwgMSk7XHJcbiAgICB9XHJcbiAgICBzWzE0XSA9IFwiNFwiOyAvLyBiaXRzIDEyLTE1IG9mIHRoZSB0aW1lX2hpX2FuZF92ZXJzaW9uIGZpZWxkIHRvIDAwMTBcclxuICAgIHNbMTldID0gaGV4RGlnaXRzLnN1YnN0cigocGFyc2VJbnQoc1sxOV0pICYgMHgzKSB8IDB4OCwgMSk7IC8vIGJpdHMgNi03IG9mIHRoZSBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkIHRvIDAxXHJcbiAgICBzWzhdID0gc1sxM10gPSBzWzE4XSA9IHNbMjNdID0gXCItXCI7XHJcbiAgICByZXR1cm4gcy5qb2luKFwiXCIpO1xyXG59XHJcbnZhciBfZ2V0QXV0b0luY0lkTWFwID0ge307XHJcbi8qKlxyXG4gKiDnlJ/miJDoh6rlop5pZO+8iOS7jjDlvIDlp4vvvIlcclxuICogQHBhcmFtIHR5cGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRBdXRvSW5jSWQodHlwZSkge1xyXG4gICAgdmFyIGluZGV4ID0gX2dldEF1dG9JbmNJZE1hcFt0eXBlXSB8fCAwO1xyXG4gICAgX2dldEF1dG9JbmNJZE1hcFt0eXBlXSA9IGluZGV4Kys7XHJcbiAgICByZXR1cm4gdHlwZSArIFwiLVwiICsgaW5kZXg7XHJcbn1cclxuLyoqXHJcbiAqIOWIpOaWreWvueixoeaYr+WQpuS4um51bGzmiJbogIXnqbrlr7nosaFcclxuICogQHBhcmFtIG9iaiDopoHliKTmlq3nmoTlr7nosaFcclxuICogQHJldHVybnMge2Jvb2xlYW59IOaYr+WQpuS4um51bGzmiJbogIXnqbrlr7nosaFcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5KG9iaikge1xyXG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8qKlxyXG4gKiDnp7vpmaRkYXRh5Lit5YyF5ZCr55qE56m65byV55So5oiW5pyq5a6a5LmJXHJcbiAqIEBwYXJhbSBkYXRhIOimgeiiq+enu+mZpOepuuW8leeUqOaIluacquWumuS5ieeahOWvueixoVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHRyaW1EYXRhKGRhdGEpIHtcclxuICAgIGZvciAodmFyIGtleSBpbiBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGRhdGFba2V5XSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbn1cclxuLyoqXHJcbiAqIOiuqWNoaWxk57G757un5om/6IeqcGFyZW5057G7XHJcbiAqIEBwYXJhbSBjaGlsZCDlrZDnsbtcclxuICogQHBhcmFtIHBhcmVudCDniLbnsbtcclxuICovXHJcbmV4cG9ydCB2YXIgZXh0ZW5kc0NsYXNzID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0W1wic2V0UHJvdG90eXBlT2ZcIl0gfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKVxyXG4gICAgICAgICAgICBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSlcclxuICAgICAgICAgICAgICAgIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgaGFzaCA9IDA7XHJcbnZhciBoYXNoVHlwZXMgPSBbXCJvYmplY3RcIiwgXCJmdW5jdGlvblwiXTtcclxuLyoqXHJcbiAqIOiOt+WPluS4gOS4quWvueixoeeahOWvueixoeWTiOW4jOWtl+espuS4slxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOS7u+aEj+Wvueixoe+8jOWPr+S7peaYr+WfuuehgOexu+Wei+aIlm51bGxcclxuICogQHJldHVybnMge3N0cmluZ30g5ZOI5biM5YC8XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqZWN0SGFzaCh0YXJnZXQpIHtcclxuICAgIGlmICh0YXJnZXQgPT0gbnVsbClcclxuICAgICAgICByZXR1cm4gXCJfX29iamVjdF9oYXNoXzBfX1wiO1xyXG4gICAgdmFyIGtleSA9IFwiX19vYmplY3RfaGFzaF9fXCI7XHJcbiAgICB2YXIgdmFsdWU7XHJcbiAgICAvLyDlj6rmnInlvZPliY3lr7nosaHkuIrmnIlrZXnmiY3nrpdcclxuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGFyZ2V0LCBrZXkpKVxyXG4gICAgICAgIHZhbHVlID0gdGFyZ2V0W2tleV07XHJcbiAgICAvLyDlpoLmnpzlt7Lnu4/mnInlk4jluIzlgLzliJnnm7TmjqXov5Tlm55cclxuICAgIGlmICh2YWx1ZSlcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICAvLyDlpoLmnpzmmK/ln7rnoYDnsbvlnovliJnnm7TmjqXov5Tlm57lr7nlupTlrZfnrKbkuLJcclxuICAgIHZhciB0eXBlID0gdHlwZW9mIHRhcmdldDtcclxuICAgIGlmIChoYXNoVHlwZXMuaW5kZXhPZih0eXBlKSA8IDApXHJcbiAgICAgICAgcmV0dXJuIHR5cGUgKyBcIjpcIiArIHRhcmdldDtcclxuICAgIC8vIOWmguaenOaYr+Wkjeadguexu+Wei+WImei/lOWbnuiuoeeul+eahOWTiOW4jOWAvOW5tuaJk+S4iuagh+etvlxyXG4gICAgdmFyIHZhbHVlID0gXCJfX29iamVjdF9oYXNoX1wiICsgKCsraGFzaCkgKyBcIl9fXCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHtcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxyXG4gICAgICAgIHZhbHVlOiB2YWx1ZVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluWkmuS4quWvueixoeeahOWTiOW4jOWtl+espuS4su+8jOS8muWvueavj+S4quWvueixoeiwg+eUqGdldE9iamVjdEhhc2jnlJ/miJDljZXkuKrlk4jluIzlgLzvvIzlubbnlKh86L+e5o6lXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsuLi5hbnlbXX0gdGFyZ2V0cyDluIzmnJvojrflj5blk4jluIzlgLznmoTlr7nosaHliJfooahcclxuICogQHJldHVybnMge3N0cmluZ30g5aSa5Liq5a+56LGh5YWx5ZCM5L2c55So5LiL55qE5ZOI5biM5YC8XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T2JqZWN0SGFzaHMoKSB7XHJcbiAgICB2YXIgdGFyZ2V0cyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB0YXJnZXRzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICB2YXIgdmFsdWVzID0gdGFyZ2V0cy5tYXAoZnVuY3Rpb24gKHRhcmdldCkgeyByZXR1cm4gZ2V0T2JqZWN0SGFzaCh0YXJnZXQpOyB9KTtcclxuICAgIHJldHVybiB2YWx1ZXMuam9pbihcInxcIik7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvT2JqZWN0VXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgd3JhcEhvc3QsIGdldEN1ck9yaWdpbiB9IGZyb20gXCIuLi8uLi91dGlscy9VUkxVdGlsXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMVxyXG4gKlxyXG4gKiDnjq/looPlj4LmlbBcclxuKi9cclxudmFyIEVudmlyb25tZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW52aXJvbm1lbnQoKSB7XHJcbiAgICAgICAgdGhpcy5fZW52ID0gXCJkZXZcIjtcclxuICAgICAgICB0aGlzLl9ob3N0c0RpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9jZG5zRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2N1ckNETkluZGV4ID0gMDtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbnZpcm9ubWVudC5wcm90b3R5cGUsIFwiZW52XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3njq/looPlrZfnrKbkuLJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9lbnY7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRW52aXJvbm1lbnQucHJvdG90eXBlLCBcImhvc3RzRGljdFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Z+f5ZCN5a2X5YW4XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7e1tlbnY6c3RyaW5nXTpzdHJpbmdbXX19XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9ob3N0c0RpY3Q7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW9k+WJjeeOr+Wig+S4i+afkOe0ouW8leWkhOeahOa2iOaBr+Wfn+WQjVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbaW5kZXg9MF0g5Z+f5ZCN5a2X5YW457Si5byV77yM6buY6K6k5pivMFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30g5Z+f5ZCN5a2X56ym5Liy77yM5aaC5p6c5Y+W5LiN5Yiw5YiZ5L2/55So5b2T5YmN5Z+f5ZCNXHJcbiAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAqL1xyXG4gICAgRW52aXJvbm1lbnQucHJvdG90eXBlLmdldEhvc3QgPSBmdW5jdGlvbiAoaW5kZXgpIHtcclxuICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH1cclxuICAgICAgICB2YXIgaG9zdHMgPSB0aGlzLl9ob3N0c0RpY3RbdGhpcy5fZW52XTtcclxuICAgICAgICBpZiAoIWhvc3RzKVxyXG4gICAgICAgICAgICByZXR1cm4gZ2V0Q3VyT3JpZ2luKCk7XHJcbiAgICAgICAgcmV0dXJuIChob3N0c1tpbmRleF0gfHwgZ2V0Q3VyT3JpZ2luKCkpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbnZpcm9ubWVudC5wcm90b3R5cGUsIFwiY2Ruc0RpY3RcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlkNETuWtl+WFuFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3tbZW52OnN0cmluZ106c3RyaW5nW119fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFbnZpcm9ubWVudFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2Ruc0RpY3Q7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRW52aXJvbm1lbnQucHJvdG90eXBlLCBcImN1ckNETkhvc3RcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluW9k+WJjeS9v+eUqOeahENETuWfn+WQjVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGNkbnMgPSB0aGlzLl9jZG5zRGljdFt0aGlzLl9lbnZdO1xyXG4gICAgICAgICAgICBpZiAoIWNkbnMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q3VyT3JpZ2luKCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoY2Ruc1t0aGlzLl9jdXJDRE5JbmRleF0gfHwgZ2V0Q3VyT3JpZ2luKCkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIfmjaLkuIvkuIDkuKpDRE5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0g5piv5ZCm5bey57uP5Yiw6L6+Q0RO5YiX6KGo55qE57uI54K577yM5Zue5Yiw5LqG6LW354K5XHJcbiAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAqL1xyXG4gICAgRW52aXJvbm1lbnQucHJvdG90eXBlLm5leHRDRE4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNkbnMgPSB0aGlzLl9jZG5zRGljdFt0aGlzLl9lbnZdO1xyXG4gICAgICAgIGlmICghY2RucylcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgdGhpcy5fY3VyQ0ROSW5kZXgrKztcclxuICAgICAgICBpZiAodGhpcy5fY3VyQ0ROSW5kZXggPj0gY2Rucy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VyQ0ROSW5kZXggPSAwO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyWRW52aXJvbm1lbnTlr7nosaHvvIzlm6DkuLror6Xlr7nosaHkv53lrZjnmoTmlbDmja7ln7rmnKzmnaXoh6rpobnnm67liJ3lp4vlj4LmlbDvvIzmiYDku6Xlv4XpobvmnIlpbml0aWFsaXpl5pa55rOVXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtlbnZdIOW9k+WJjeaJgOWxnueOr+Wig+Wtl+espuS4slxyXG4gICAgICogQHBhcmFtIHt7W2VudjpzdHJpbmddOnN0cmluZ1tdfX0gW2hvc3RzRGljdF0gaG9zdOaVsOe7hOWtl+WFuFxyXG4gICAgICogQHBhcmFtIHt7W2VudjpzdHJpbmddOnN0cmluZ1tdfX0gW2NkbnNEaWN0XSBjZG7mlbDnu4TlrZflhbhcclxuICAgICAqIEBtZW1iZXJvZiBFbnZpcm9ubWVudFxyXG4gICAgICovXHJcbiAgICBFbnZpcm9ubWVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChlbnYsIGhvc3RzRGljdCwgY2Ruc0RpY3QpIHtcclxuICAgICAgICB0aGlzLl9lbnYgPSBlbnYgfHwgXCJkZXZcIjtcclxuICAgICAgICB0aGlzLl9ob3N0c0RpY3QgPSBob3N0c0RpY3QgfHwge307XHJcbiAgICAgICAgdGhpcy5fY2Ruc0RpY3QgPSBjZG5zRGljdCB8fCB7fTtcclxuICAgICAgICB0aGlzLl9jdXJDRE5JbmRleCA9IDA7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDorql1cmznmoTln5/lkI3lj5jmiJDmtojmga/ln5/lkI1cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOimgei9rOWPmOeahHVybFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtpbmRleD0wXSBob3N057Si5byV77yM6buY6K6kMFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30g6L2s5Y+Y5ZCO55qEdXJsXHJcbiAgICAgKiBAbWVtYmVyb2YgRW52aXJvbm1lbnRcclxuICAgICAqL1xyXG4gICAgRW52aXJvbm1lbnQucHJvdG90eXBlLnRvSG9zdFVSTCA9IGZ1bmN0aW9uICh1cmwsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKGluZGV4ID09PSB2b2lkIDApIHsgaW5kZXggPSAwOyB9XHJcbiAgICAgICAgLy8g5Yqg5LiKZG9tYWluXHJcbiAgICAgICAgdXJsID0gd3JhcEhvc3QodXJsLCB0aGlzLmdldEhvc3QoaW5kZXgpKTtcclxuICAgICAgICAvLyDov5Tlm551cmxcclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6pdXJs55qE5Z+f5ZCN5Y+Y5oiQQ0RO5Z+f5ZCNXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDopoHovazlj5jnmoR1cmxcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2ZvcmNlZD1mYWxzZV0g5piv5ZCm5by65Yi25pu/5o2iaG9zdFxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaW5maXg9dHJ1ZV0g5piv5ZCm5Yqg5YWl6Lev5b6E5Lit57yA77yM5Y2zaG9zdOS5i+WQju+8jGluZGV4Lmh0bWzkuYvliY3nmoTpg6jliIbvvIzpu5jorqTliqDlhaVcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOi9rOWPmOWQjueahHVybFxyXG4gICAgICogQG1lbWJlcm9mIEVudmlyb25tZW50XHJcbiAgICAgKi9cclxuICAgIEVudmlyb25tZW50LnByb3RvdHlwZS50b0NETkhvc3RVUkwgPSBmdW5jdGlvbiAodXJsLCBmb3JjZWQsIGluZml4KSB7XHJcbiAgICAgICAgaWYgKGZvcmNlZCA9PT0gdm9pZCAwKSB7IGZvcmNlZCA9IGZhbHNlOyB9XHJcbiAgICAgICAgaWYgKGluZml4ID09PSB2b2lkIDApIHsgaW5maXggPSB0cnVlOyB9XHJcbiAgICAgICAgaWYgKGluZml4KSB7XHJcbiAgICAgICAgICAgIC8vIOe7hOe7h+S4ree8gFxyXG4gICAgICAgICAgICB2YXIgbWlkbmFtZUluZGV4ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmxhc3RJbmRleE9mKFwiL1wiKTtcclxuICAgICAgICAgICAgdmFyIG1pZG5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3Vic3RyaW5nKDAsIG1pZG5hbWVJbmRleCArIDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gd3JhcEhvc3QodXJsLCB0aGlzLmN1ckNETkhvc3QgKyBcIi9cIiArIG1pZG5hbWUsIGZvcmNlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlj6rmm7/mjaLln5/lkI1cclxuICAgICAgICAgICAgcmV0dXJuIHdyYXBIb3N0KHVybCwgdGhpcy5jdXJDRE5Ib3N0LCBmb3JjZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBFbnZpcm9ubWVudCA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgRW52aXJvbm1lbnQpO1xyXG4gICAgcmV0dXJuIEVudmlyb25tZW50O1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBFbnZpcm9ubWVudDtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGVudmlyb25tZW50ID0gY29yZS5nZXRJbmplY3QoRW52aXJvbm1lbnQpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvZW52L0Vudmlyb25tZW50LmpzXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBcIi4uL2xpYnMvUmVmbGVjdFwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyBleHRlbmRzQ2xhc3MgfSBmcm9tIFwiLi4vdXRpbHMvT2JqZWN0VXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTNcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTNcclxuICpcclxuICog6KOF6aWw5Zmo5bel5YW36ZuGXHJcbiovXHJcbi8vIOeUqOadpeWIpOaWreaYr+WQpuaUr+aMgVByb3h5XHJcbnZhciBoYXNQcm94eSA9IGZhbHNlO1xyXG4od2luZG93W1wiUHJveHlcIl0gJiYgUHJveHkucmV2b2NhYmxlIGluc3RhbmNlb2YgRnVuY3Rpb24pO1xyXG52YXIgaW5zdGFuY2VEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuZnVuY3Rpb24gaGFuZGxlSW5zdGFuY2UoaW5zdGFuY2UpIHtcclxuICAgIHZhciBjbHMgPSBpbnN0YW5jZS5jb25zdHJ1Y3RvcjtcclxuICAgIGNscyA9IGNsc1tcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgY2xzO1xyXG4gICAgdmFyIGZ1bmNzID0gaW5zdGFuY2VEaWN0LmdldChjbHMpO1xyXG4gICAgaWYgKGZ1bmNzKVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgZnVuY3NfMSA9IGZ1bmNzOyBfaSA8IGZ1bmNzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBmdW5jID0gZnVuY3NfMVtfaV07XHJcbiAgICAgICAgICAgIGZ1bmMoaW5zdGFuY2UpO1xyXG4gICAgICAgIH1cclxufVxyXG4vKipcclxuICog5YyF6KOF5LiA5Liq57G75Z6L77yM55uR5ZCs57G75Z6L55qE5a6e5L6L5YyW5pON5L2cXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29uc3RydWN0b3J9IGNscyDopoHnm5HlkKzmnoTpgKDnmoTnsbvlnovmnoTpgKDlmahcclxuICogQHJldHVybnMge0lDb25zdHJ1Y3Rvcn0g5paw55qE5p6E6YCg5Ye95pWwXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gd3JhcENvbnN0cnVjdChjbHMpIHtcclxuICAgIGlmIChoYXNQcm94eSkge1xyXG4gICAgICAgIC8vIOS9v+eUqFByb3h555uR5ZCs57G75Z6L5p6E5bu6XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm94eShjbHMsIHtcclxuICAgICAgICAgICAgY29uc3RydWN0OiBmdW5jdGlvbiAodGFyZ2V0LCBhcmdzLCBuZXdUYXJnZXQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBSZWZsZWN0W1wiY29uc3RydWN0XCJdKHRhcmdldCwgYXJncywgbmV3VGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXdUYXJnZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNvbnN0cnVjdG9yID0gbmV3VGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgaGFuZGxlSW5zdGFuY2UocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8vIOWIm+W7uuS4gOS4quaWsOeahOaehOmAoOWHveaVsFxyXG4gICAgICAgIHZhciBmdW5jO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIOWwneivleS/neaMgeWOn+Wni+exu+Wei+eahOWQjeensFxyXG4gICAgICAgICAgICBldmFsKCdmdW5jID0gZnVuY3Rpb24gJyArIGNsc1tcIm5hbWVcIl0gKyAnKCl7b25Db25zdHJ1Y3QuY2FsbCh0aGlzLCBhcmd1bWVudHMpfScpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIC8vIOWwneivleWksei0pe+8jOS9v+eUqOaXoOWQjeexu+Wei1xyXG4gICAgICAgICAgICBmdW5jID0gb25Db25zdHJ1Y3Q7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWKqOaAgeiuvue9rue7p+aJv1xyXG4gICAgICAgIGV4dGVuZHNDbGFzcyhmdW5jLCBjbHMpO1xyXG4gICAgICAgIC8vIOS4uuaWsOeahOaehOmAoOWHveaVsOaJk+S4gOS4quagh+etvu+8jOeUqOS7peiusOW9leWOn+Wni+eahOaehOmAoOWHveaVsFxyXG4gICAgICAgIGZ1bmNbXCJfX29yaV9jb25zdHJ1Y3Rvcl9fXCJdID0gY2xzO1xyXG4gICAgICAgIC8vIOS4uuWOn+Wni+aehOmAoOWHveaVsOS5n+aJk+S4gOS4quagh+etvu+8jOeUqOS7peiusOW9leaWsOaehOmAoOWHveaVsFxyXG4gICAgICAgIGNsc1tcIl9fd3JhcF9jb25zdHJ1Y3Rvcl9fXCJdID0gZnVuYztcclxuICAgICAgICAvLyDov5Tlm57mlrDnmoTmnoTpgKDlh73mlbBcclxuICAgICAgICByZXR1cm4gZnVuYztcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uQ29uc3RydWN0KGFyZ3MpIHtcclxuICAgICAgICAvLyDmgaLlpI1fX3Byb3RvX19cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfX3Byb3RvX19cIiwge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgdmFsdWU6IGNscy5wcm90b3R5cGVcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDosIPnlKjniLbnsbvmnoTpgKDlh73mlbDmnoTpgKDlrp7kvotcclxuICAgICAgICBjbHMuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgaGFuZGxlSW5zdGFuY2UodGhpcyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOWmguaenOS8oOWFpeeahOexu+acieWMheijheexu++8jOWImei/lOWbnuWMheijheexu++8jOWQpuWImei/lOWbnuWFtuacrOi6q1xyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfSBjbHMg6KaB6I635Y+W5YyF6KOF57G755qE57G75p6E6YCg5Ye95pWwXHJcbiAqIEByZXR1cm5zIHtJQ29uc3RydWN0b3J9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29uc3RydWN0b3IoY2xzKSB7XHJcbiAgICByZXR1cm4gKGNsc1tcIl9fd3JhcF9jb25zdHJ1Y3Rvcl9fXCJdIHx8IGNscyk7XHJcbn1cclxuLyoqXHJcbiAqIOebkeWQrOexu+Wei+eahOWunuS+i+WMllxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfSBjbHMg6KaB55uR5ZCs5a6e5L6L5YyW55qE57G7XHJcbiAqIEBwYXJhbSB7KGluc3RhbmNlPzphbnkpPT52b2lkfSBoYW5kbGVyIOWkhOeQhuWHveaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbkNvbnN0cnVjdChjbHMsIGhhbmRsZXIpIHtcclxuICAgIGNscyA9IGNsc1tcIl9fb3JpX2NvbnN0cnVjdG9yX19cIl0gfHwgY2xzO1xyXG4gICAgdmFyIGxpc3QgPSBpbnN0YW5jZURpY3QuZ2V0KGNscyk7XHJcbiAgICBpZiAoIWxpc3QpXHJcbiAgICAgICAgaW5zdGFuY2VEaWN0LnNldChjbHMsIGxpc3QgPSBbXSk7XHJcbiAgICBpZiAobGlzdC5pbmRleE9mKGhhbmRsZXIpIDwgMClcclxuICAgICAgICBsaXN0LnB1c2goaGFuZGxlcik7XHJcbn1cclxuLyoqXHJcbiAqIOenu+mZpOWunuS+i+WMluebkeWQrFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfSBjbHMg6KaB56e76Zmk55uR5ZCs5a6e5L6L5YyW55qE57G7XHJcbiAqIEBwYXJhbSB7KGluc3RhbmNlPzphbnkpPT52b2lkfSBoYW5kbGVyIOWkhOeQhuWHveaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHVubGlzdGVuQ29uc3RydWN0KGNscywgaGFuZGxlcikge1xyXG4gICAgY2xzID0gY2xzW1wiX19vcmlfY29uc3RydWN0b3JfX1wiXSB8fCBjbHM7XHJcbiAgICB2YXIgbGlzdCA9IGluc3RhbmNlRGljdC5nZXQoY2xzKTtcclxuICAgIGlmIChsaXN0KSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gbGlzdC5pbmRleE9mKGhhbmRsZXIpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKVxyXG4gICAgICAgICAgICBsaXN0LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOebkeWQrOexu+Wei+mUgOavge+8iOWmguaenOiDveWkn+mUgOavgeeahOivne+8jOmcgOimgeexu+Wei+WFt+aciWRpc3Bvc2Xmlrnms5XvvInvvIzor6Xnm5HlkKzkuI3pnIDopoHnp7vpmaRcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcn0gY2xzIOimgeebkeWQrOmUgOavgeeahOexu1xyXG4gKiBAcGFyYW0geyhpbnN0YW5jZT86YW55KT0+dm9pZH0gaGFuZGxlciDlpITnkIblh73mlbBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsaXN0ZW5EaXNwb3NlKGNscywgaGFuZGxlcikge1xyXG4gICAgdmFyIGRpc3Bvc2UgPSBjbHMucHJvdG90eXBlLmRpc3Bvc2U7XHJcbiAgICAvLyDliKTmlq3nsbvlnovmmK/lkKblhbfmnIlkaXNwb3Nl5pa55rOVXHJcbiAgICBpZiAoZGlzcG9zZSkge1xyXG4gICAgICAgIC8vIOabv+aNomRpc3Bvc2Xmlrnms5VcclxuICAgICAgICBjbHMucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBoYW5kbGVyKHRoaXMpO1xyXG4gICAgICAgICAgICAvLyDosIPnlKjljp/lp4tkaXNwb3Nl5pa55rOV5omn6KGM6ZSA5q+BXHJcbiAgICAgICAgICAgIHJldHVybiBkaXNwb3NlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog55uR5ZCs5p+Q5Liq5a6e5L6L55qE5p+Q5Liq5pa55rOV6LCD55So77yM5bm25o+S5YWl6YC76L6RXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29uc3RydWN0b3J8YW55fSB0YXJnZXQg6KaB55uR5ZCs55qE5a+56LGh57G75Z6L5oiW5a6e5L6LXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOimgeebkeWQrOiwg+eUqOeahOaWueazleWQjVxyXG4gKiBAcGFyYW0geyhpbnN0YW5jZTphbnksIGFyZ3M/OmFueVtdKT0+YW55W118dm9pZH0gW2JlZm9yZV0g5omn6KGM5YmN6LCD55So55qE5Zue6LCD77yM5aaC5p6c5pyJ6L+U5Zue5YC85YiZ5pu/5o2i5o6J5q2j5byP5pa55rOV5omn6KGM5pe255qE5Y+C5pWwXHJcbiAqIEBwYXJhbSB7KGluc3RhbmNlOmFueSwgYXJncz86YW55W10sIHJlc3VsdD86YW55KT0+YW55fSBbYWZ0ZXJdIOaJp+ihjOWQjuiwg+eUqOeahOWbnuiwg++8jOWPr+S7peaOpeaUtuato+W8j+aWueazleeahOi/lOWbnuWAvO+8jOWmguaenGFmdGVy5pyJ6L+U5Zue5YC85YiZ5pu/5o2i5o6J5q2j5byP5pa55rOV55qE6L+U5Zue5YC8XHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9dHJ1ZV0g5piv5ZCm5piv5LiA5qyh5oCn55uR5ZCs77yM6buY6K6k5pivdHJ1ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RlbkFwcGx5KHRhcmdldCwgbmFtZSwgYmVmb3JlLCBhZnRlciwgb25jZSkge1xyXG4gICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gdHJ1ZTsgfVxyXG4gICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIEZ1bmN0aW9uKVxyXG4gICAgICAgIC8vIOaYr+S4quexu+Wei++8jOebkeWQrOaehOW7uuWQjuWGjeaJp+ihjOWkhOeQhlxyXG4gICAgICAgIGxpc3RlbkNvbnN0cnVjdCh0YXJnZXQsIG9uR2V0SW5zdGFuY2UpO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIC8vIOaYr+S4quWunuS+i++8jOebtOaOpeaJp+ihjOWkhOeQhlxyXG4gICAgICAgIG9uR2V0SW5zdGFuY2UodGFyZ2V0KTtcclxuICAgIGZ1bmN0aW9uIG9uR2V0SW5zdGFuY2UoaW5zdGFuY2UpIHtcclxuICAgICAgICAvLyDnr6HmlLnmjIflrprmlrnms5VcclxuICAgICAgICB2YXIgb3JpRnVuYyA9IGluc3RhbmNlLmhhc093blByb3BlcnR5KG5hbWUpID8gaW5zdGFuY2VbbmFtZV0gOiBudWxsO1xyXG4gICAgICAgIGluc3RhbmNlW25hbWVdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICB2YXIgdGVtcEFyZ3MgPSBiZWZvcmUgJiYgYmVmb3JlKGluc3RhbmNlLCBhcmdzKTtcclxuICAgICAgICAgICAgLy8g5pu/5o2i5Y+C5pWwXHJcbiAgICAgICAgICAgIGlmICh0ZW1wQXJncylcclxuICAgICAgICAgICAgICAgIGFyZ3MgPSB0ZW1wQXJncztcclxuICAgICAgICAgICAgLy8g5aaC5p6c5piv5LiA5qyh5oCn55uR5ZCs77yM5YiZ5oGi5aSN5Y6f5aeL5pa55rOVXHJcbiAgICAgICAgICAgIGlmIChvbmNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3JpRnVuYylcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZVtuYW1lXSA9IG9yaUZ1bmM7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGluc3RhbmNlW25hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWOn+Wni+aWueazlVxyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gaW5zdGFuY2VbbmFtZV0uYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICB2YXIgdGVtcFJlc3VsdCA9IGFmdGVyICYmIGFmdGVyKGluc3RhbmNlLCBhcmdzLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAvLyDmm7/mjaLnu5PmnpxcclxuICAgICAgICAgICAgaWYgKHRlbXBSZXN1bHQpXHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0ZW1wUmVzdWx0O1xyXG4gICAgICAgICAgICAvLyDov5Tlm57nu5PmnpxcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IE9ic2VydmFibGUgZnJvbSBcIi4uLy4uL2NvcmUvb2JzZXJ2YWJsZS9PYnNlcnZhYmxlXCI7XHJcbmltcG9ydCB7IHVuaXF1ZSB9IGZyb20gXCIuLi8uLi91dGlscy9BcnJheVV0aWxcIjtcclxuaW1wb3J0IHsgZ2V0Q29uc3RydWN0b3IgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RydWN0VXRpbFwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyBhc3NldHNNYW5hZ2VyIH0gZnJvbSBcIi4uL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IGJpbmRNYW5hZ2VyIH0gZnJvbSBcIi4uL2JpbmQvQmluZE1hbmFnZXJcIjtcclxuaW1wb3J0IHsgbXV0YXRlLCB1bm11dGF0ZSB9IGZyb20gXCIuLi9iaW5kL011dGF0b3JcIjtcclxuaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gJy4uL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyJztcclxuaW1wb3J0IHsgbWFza01hbmFnZXIgfSBmcm9tIFwiLi4vbWFzay9NYXNrTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBuZXRNYW5hZ2VyIH0gZnJvbSBcIi4uL25ldC9OZXRNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IHN5c3RlbSB9IGZyb20gXCIuLi9zeXN0ZW0vU3lzdGVtXCI7XHJcbmltcG9ydCB7IE1vZHVsZU9wZW5TdGF0dXMgfSBmcm9tIFwiLi9JTWVkaWF0b3JNb2R1bGVQYXJ0XCI7XHJcbmltcG9ydCBNZWRpYXRvck1lc3NhZ2UgZnJvbSBcIi4vTWVkaWF0b3JNZXNzYWdlXCI7XHJcbmltcG9ydCBNZWRpYXRvclN0YXR1cyBmcm9tIFwiLi9NZWRpYXRvclN0YXR1c1wiO1xyXG52YXIgbW9kdWxlRGljdCA9IHt9O1xyXG52YXIgbW9kdWxlTmFtZURpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4vKipcclxuICog5rOo5YaM5qih5Z2XXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG1vZHVsZU5hbWUg5qih5Z2X5ZCNXHJcbiAqIEBwYXJhbSB7SU1lZGlhdG9yQ29uc3RydWN0b3J9IGNscyDmqKHlnZfnsbvlnotcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3Rlck1vZHVsZShtb2R1bGVOYW1lLCBjbHMpIHtcclxuICAgIG1vZHVsZURpY3RbbW9kdWxlTmFtZV0gPSBjbHM7XHJcbiAgICBtb2R1bGVOYW1lRGljdC5zZXQoY2xzLCBtb2R1bGVOYW1lKTtcclxufVxyXG4vKipcclxuICog6I635Y+W5qih5Z2X57G75Z6LXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG1vZHVsZU5hbWUg5qih5Z2X5ZCNXHJcbiAqIEByZXR1cm5zIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcn1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNb2R1bGUobW9kdWxlTmFtZSkge1xyXG4gICAgcmV0dXJuIG1vZHVsZURpY3RbbW9kdWxlTmFtZV07XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPluaooeWdl+WQjVxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7TW9kdWxlVHlwZX0gdHlwZSDmqKHlnZflrp7kvovmiJbmqKHlnZfnsbvlnotcclxuICogQHJldHVybnMge3N0cmluZ30g5qih5Z2X5ZCNXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kdWxlTmFtZSh0eXBlKSB7XHJcbiAgICB2YXIgY2xzID0gZ2V0Q29uc3RydWN0b3IodHlwZSBpbnN0YW5jZW9mIEZ1bmN0aW9uID8gdHlwZSA6IHR5cGUuY29uc3RydWN0b3IpO1xyXG4gICAgcmV0dXJuIG1vZHVsZU5hbWVEaWN0LmdldChjbHMpO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBpc01lZGlhdG9yKHRhcmdldCkge1xyXG4gICAgcmV0dXJuICh0YXJnZXQuZGVsZWdhdGVNZWRpYXRvciBpbnN0YW5jZW9mIEZ1bmN0aW9uICYmIHRhcmdldC51bmRlbGVnYXRlTWVkaWF0b3IgaW5zdGFuY2VvZiBGdW5jdGlvbik7XHJcbn1cclxuLyoqXHJcbiAqIOS4reS7i+iAheWfuuexu1xyXG4gKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZGF0ZSAyMDE5LTAzLTA0XHJcbiAqIEBleHBvcnRcclxuICogQGNsYXNzIE1lZGlhdG9yXHJcbiAqIEBpbXBsZW1lbnRzIHtJTWVkaWF0b3I8UywgT0QsIENEPn1cclxuICogQHRlbXBsYXRlIFMg55qu6IKk57G75Z6LXHJcbiAqIEB0ZW1wbGF0ZSBPRCDlvIDlkK/lj4LmlbDnsbvlnotcclxuICogQHRlbXBsYXRlIENEIOWFs+mXreWPguaVsOexu+Wei1xyXG4gKi9cclxudmFyIE1lZGlhdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWVkaWF0b3Ioc2tpbikge1xyXG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IE1lZGlhdG9yU3RhdHVzLlVOT1BFTjtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnu5Hlrprnm67moIfmlbDnu4TvvIznrKzkuIDlsYJrZXnmmK/osIPnlKjlsYLnuqfvvIznrKzkuozlsYLmmK/or6XlsYLnuqfpnIDopoHnvJbor5HnmoTlr7nosaHmlbDnu4RcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtEaWN0aW9uYXJ5PFMsIFM+W119XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5iaW5kVGFyZ2V0cyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX29wZW5NYXNrID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9jbG9zZUNhY2hlID0gW107XHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgdGhpcy5fZGlzcG9zZURpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOeItuS4reS7i+iAhVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lNZWRpYXRvcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2hpbGRyZW4gPSBbXTtcclxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiog5LiL6Z2i5piv5qih5Z2X5raI5oGv57O757ufICoqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZShjb3JlKTtcclxuICAgICAgICAvLyDotYvlgLzmqKHlnZflkI3np7BcclxuICAgICAgICB0aGlzLl9tb2R1bGVOYW1lID0gZ2V0TW9kdWxlTmFtZSh0aGlzKTtcclxuICAgICAgICAvLyDotYvlgLznmq7ogqRcclxuICAgICAgICBpZiAoc2tpbikge1xyXG4gICAgICAgICAgICB0aGlzLnNraW4gPSBza2luO1xyXG4gICAgICAgICAgICAvLyDotYvlgLzmoaVcclxuICAgICAgICAgICAgdGhpcy5icmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZUJ5U2tpbihza2luKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vcmlTa2luID0gc2tpbjtcclxuICAgICAgICAvLyDliJ3lp4vljJbnu5HlrppcclxuICAgICAgICBiaW5kTWFuYWdlci5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJzdGF0dXNcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluS4reS7i+iAheeKtuaAgVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge01lZGlhdG9yU3RhdHVzfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJ2aWV3TW9kZWxcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaIluiuvue9rlZpZXdNb2RlbFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUgeyp9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl92aWV3TW9kZWw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAvLyDorr7nva7nmoTml7blgJnov5vooYzkuIDmrKHlj5jlvIJcclxuICAgICAgICAgICAgdGhpcy5fdmlld01vZGVsID0gbXV0YXRlKHZhbHVlKTtcclxuICAgICAgICAgICAgLy8g5pu05paw57uR5a6aXHJcbiAgICAgICAgICAgIGJpbmRNYW5hZ2VyLmJpbmQodGhpcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcImRpc3Bvc2VkXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bkuK3ku4vogIXmmK/lkKblt7LooqvplIDmr4FcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3N0YXR1cyA9PT0gTWVkaWF0b3JTdGF0dXMuRElTUE9TRUQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJvcGVuTWFza1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5byA5ZCv5pe25piv5ZCm6Kem5Y+R5YWo5bGP6YGu572p77yM6Ziy5q2i55So5oi35pON5L2c77yM6K6+572u5pON5L2c5Lya5b2x5ZON5omA5pyJ5a2Q5a2Z5Lit5LuL6ICF44CC6buY6K6k5pivdHJ1ZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vcGVuTWFzaztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29wZW5NYXNrID0gdmFsdWU7XHJcbiAgICAgICAgICAgIC8vIOmAkuW9kuiuvue9ruaJgOacieWtkOS4reS7i+iAheeahG9wZW5NYXNrXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIGNoaWxkLm9wZW5NYXNrID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZWRpYXRvci5wcm90b3R5cGUsIFwicmVzcG9uc2VzXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmqKHlnZfliJ3lp4vmtojmga/nmoTov5Tlm57mlbDmja5cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtSZXNwb25zZURhdGFbXX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNlcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvLyDpgJLlvZLorr7nva7lrZDkuK3ku4vogIXnmoRkYXRhXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBtZWRpYXRvciA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLnJlc3BvbnNlcyA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcIm1vZHVsZU5hbWVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaooeWdl+WQjVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZHVsZU5hbWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veS7jmxpc3RBc3NldHPkuK3ojrflj5bliLDnmoTmiYDmnInotYTmupBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhlcnI/OkVycm9yKT0+dm9pZH0gaGFuZGxlciDliqDovb3lrozmr5XlkI7nmoTlm57osIPvvIzlpoLmnpzlh7rplJnliJnkvJrnu5nlh7plcnLlj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5sb2FkQXNzZXRzID0gZnVuY3Rpb24gKGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBtZWRpYXRvcnMgPSB0aGlzLl9jaGlsZHJlbi5jb25jYXQoKTtcclxuICAgICAgICB2YXIgdGVtcCA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgaWYgKGVyciB8fCBtZWRpYXRvcnMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqG9uTG9hZEFzc2V0c+aOpeWPo1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub25Mb2FkQXNzZXRzKGVycik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWKoOi9veS4gOS4quWtkOS4reS7i+iAheeahOi1hOa6kFxyXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gbWVkaWF0b3JzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci5sb2FkQXNzZXRzKHRlbXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDliqDovb3oh6rouqvotYTmupBcclxuICAgICAgICB2YXIgYXNzZXRzID0gdGhpcy5saXN0QXNzZXRzKCk7XHJcbiAgICAgICAgaWYgKGFzc2V0cyAmJiBhc3NldHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAvLyDljrvph41cclxuICAgICAgICAgICAgYXNzZXRzID0gdW5pcXVlKGFzc2V0cyk7XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+WKoOi9vVxyXG4gICAgICAgICAgICB0aGlzLmJyaWRnZS5sb2FkQXNzZXRzKGFzc2V0cywgdGhpcywgdGVtcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDmsqHmnInotYTmupDvvIznm7TmjqXosIPnlKjlm57osINcclxuICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veS7jmxpc3RTdHlsZUZpbGVz5Lit6I635Y+W5Yiw55qE5omA5pyJ6LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Yqg6L295a6M5q+V5ZCO55qE5Zue6LCD77yM5aaC5p6c5Ye66ZSZ5YiZ5Lya57uZ5Ye6ZXJy5Y+C5pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgSU1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5sb2FkU3R5bGVGaWxlcyA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbWVkaWF0b3JzID0gdGhpcy5fY2hpbGRyZW4uY29uY2F0KCk7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnIgfHwgbWVkaWF0b3JzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkxvYWRTdHlsZUZpbGVz5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vbkxvYWRTdHlsZUZpbGVzKGVycik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWKoOi9veS4gOS4quWtkOS4reS7i+iAheeahOi1hOa6kFxyXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gbWVkaWF0b3JzLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci5sb2FkU3R5bGVGaWxlcyh0ZW1wKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5byA5aeL5Yqg6L29Y3Nz5paH5Lu2XHJcbiAgICAgICAgdmFyIGNzc0ZpbGVzID0gdGhpcy5saXN0U3R5bGVGaWxlcygpO1xyXG4gICAgICAgIC8vIOWOu+mHjVxyXG4gICAgICAgIGNzc0ZpbGVzID0gdW5pcXVlKGNzc0ZpbGVzKTtcclxuICAgICAgICAvLyDliqDovb1cclxuICAgICAgICBhc3NldHNNYW5hZ2VyLmxvYWRTdHlsZUZpbGVzKGNzc0ZpbGVzLCB0ZW1wKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veS7jmxpc3RKc0ZpbGVz5Lit6I635Y+W5Yiw55qE5omA5pyJ6LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Yqg6L295a6M5q+V5ZCO55qE5Zue6LCD77yM5aaC5p6c5Ye66ZSZ5YiZ5Lya57uZ5Ye6ZXJy5Y+C5pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgSU1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5sb2FkSnNGaWxlcyA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgbWVkaWF0b3JzID0gdGhpcy5fY2hpbGRyZW4uY29uY2F0KCk7XHJcbiAgICAgICAgdmFyIHRlbXAgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGlmIChlcnIgfHwgbWVkaWF0b3JzLmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkxvYWRKc0ZpbGVz5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5vbkxvYWRKc0ZpbGVzKGVycik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWKoOi9veS4gOS4quWtkOS4reS7i+iAheeahGpzXHJcbiAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBtZWRpYXRvcnMuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLmxvYWRKc0ZpbGVzKHRlbXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDlvIDlp4vliqDovb1qc+aWh+S7tlxyXG4gICAgICAgIHZhciBqc0ZpbGVzID0gdGhpcy5saXN0SnNGaWxlcygpO1xyXG4gICAgICAgIC8vIOWOu+mHjVxyXG4gICAgICAgIGpzRmlsZXMgPSB1bmlxdWUoanNGaWxlcyk7XHJcbiAgICAgICAgLy8g5Yqg6L29XHJcbiAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkSnNGaWxlcyhqc0ZpbGVzLCB0ZW1wKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWPkemAgeS7jmxpc3RJbml0UmVxdWVzdHPkuK3ojrflj5bliLDnmoTmiYDmnInotYTmupBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhlcnI/OkVycm9yKT0+dm9pZH0gaGFuZGxlciDliqDovb3lrozmr5XlkI7nmoTlm57osIPvvIzlpoLmnpzlh7rplJnliJnkvJrnu5nlh7plcnLlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBJTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnNlbmRJbml0UmVxdWVzdHMgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIG1lZGlhdG9ycyA9IHRoaXMuX2NoaWxkcmVuLmNvbmNhdCgpO1xyXG4gICAgICAgIHZhciB0ZW1wID0gZnVuY3Rpb24gKHJlc3BvbnNlcykge1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2VzIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlcnIgPSByZXNwb25zZXMgaW5zdGFuY2VvZiBFcnJvciA/IHJlc3BvbnNlcyA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqG9uU2VuZEluaXRSZXF1ZXN0c+aOpeWPo1xyXG4gICAgICAgICAgICAgICAgX3RoaXMub25TZW5kSW5pdFJlcXVlc3RzKGVycik7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpc01pbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc01pbmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDotYvlgLzov5Tlm57lgLxcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZXNwb25zZXMgPSByZXNwb25zZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3AgPSBfdGhpcy5vbkdldFJlc3BvbnNlcyhyZXNwb25zZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdG9wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoXCLnlKjmiLfkuK3mraLmiZPlvIDmqKHlnZfmk43kvZxcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqG9uU2VuZEluaXRSZXF1ZXN0c+aOpeWPo1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5vblNlbmRJbml0UmVxdWVzdHMoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvcnMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvblNlbmRJbml0UmVxdWVzdHPmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5vblNlbmRJbml0UmVxdWVzdHMoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlj5HpgIHkuIDkuKrlrZDkuK3ku4vogIXnmoTliJ3lp4vljJbmtojmga9cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBtZWRpYXRvcnMuc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5zZW5kSW5pdFJlcXVlc3RzKHRlbXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDlj5HpgIHmiYDmnInmqKHlnZfmtojmga/vvIzmqKHlnZfmtojmga/pu5jorqTlj5HpgIHlhajlsYDlhoXmoLhcclxuICAgICAgICB2YXIgaXNNaW5lID0gdHJ1ZTtcclxuICAgICAgICBuZXRNYW5hZ2VyLnNlbmRNdWx0aVJlcXVlc3RzKHRoaXMubGlzdEluaXRSZXF1ZXN0cygpLCB0ZW1wLCB0aGlzLCB0aGlzLm9ic2VydmFibGUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5b2T5omA6ZyA6LWE5rqQ5Yqg6L295a6M5q+V5ZCO6LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFcnJvcn0gW2Vycl0g5Yqg6L295Ye66ZSZ5Lya57uZ5Ye66ZSZ6K+v5a+56LGh77yM5rKh6ZSZ5YiZ5LiN57uZXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uTG9hZEFzc2V0cyA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+aJgOmcgENTU+WKoOi9veWujOavleWQjuiwg+eUqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RXJyb3J9IFtlcnJdIOWKoOi9veWHuumUmeS8mue7meWHuumUmeivr+Wvueixoe+8jOayoemUmeWImeS4jee7mVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbkxvYWRTdHlsZUZpbGVzID0gZnVuY3Rpb24gKGVycikge1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5b2T5omA6ZyAanPliqDovb3lrozmr5XlkI7osIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0Vycm9yfSBbZXJyXSDliqDovb3lh7rplJnkvJrnu5nlh7rplJnor6/lr7nosaHvvIzmsqHplJnliJnkuI3nu5lcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25Mb2FkSnNGaWxlcyA9IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+aJgOmcgOi1hOa6kOWKoOi9veWujOavleWQjuiwg+eUqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RXJyb3J9IFtlcnJdIOWKoOi9veWHuumUmeS8mue7meWHuumUmeivr+Wvueixoe+8jOayoemUmeWImeS4jee7mVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vblNlbmRJbml0UmVxdWVzdHMgPSBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPojrflj5bliLDmiYDmnInliJ3lp4vljJbor7fmsYLov5Tlm57ml7bosIPnlKjvvIzlj6/ku6XpgJrov4fov5Tlm57kuIDkuKp0cnVl5p2l6Zi75q2i5qih5Z2X55qE5omT5byAXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtSZXNwb25zZURhdGFbXX0gcmVzcG9uc2VzIOi/lOWbnue7k+aehOaVsOe7hFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IOi/lOWbnnRydWXliJnooajnpLrlgZzmraLmqKHlnZfmiZPlvIBcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25HZXRSZXNwb25zZXMgPSBmdW5jdGlvbiAocmVzcG9uc2VzKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5omT5byA77yM5Li65LqG5a6e546wSU9wZW5DbG9zZeaOpeWPo1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7T0R9IFtkYXRhXSDlvIDlkK/mlbDmja5cclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5YW25LuW5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fSDlvILmraXov5Tlm55vbk9wZW7ml7bov5Tlm57nmoTlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIC8vIOWIpOaWreeKtuaAgVxyXG4gICAgICAgICAgICBpZiAoX3RoaXMuX3N0YXR1cyA9PT0gTWVkaWF0b3JTdGF0dXMuVU5PUEVOKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgIF90aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5PUEVOSU5HO1xyXG4gICAgICAgICAgICAgICAgLy8g6LWL5YC85Y+C5pWwXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIC8vIOiusOS4gOS4quaYr+WQpumcgOimgemBrue9qeeahGZsYWdcclxuICAgICAgICAgICAgICAgIHZhciBtYXNrRmxhZyA9IF90aGlzLm9wZW5NYXNrO1xyXG4gICAgICAgICAgICAgICAgLy8g5Y+R6YCB5Yid5aeL5YyW5raI5oGvXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zZW5kSW5pdFJlcXVlc3RzKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWRlTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIgJiYgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIoTW9kdWxlT3BlblN0YXR1cy5TdG9wLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhyZWplY3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDliqDovb3miYDmnInlt7LmiZjnrqHkuK3ku4vogIXnmoTotYTmupBcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9hZEFzc2V0cyhmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk6YGu572pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1hc2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2R1bGVPcGVuSGFuZGxlciAmJiBfdGhpcy5tb2R1bGVPcGVuSGFuZGxlcihNb2R1bGVPcGVuU3RhdHVzLlN0b3AsIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55SocmVqZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDliqDovb1jc3Pmlofku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkU3R5bGVGaWxlcyhmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlkZU1hc2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIgJiYgX3RoaXMubW9kdWxlT3BlbkhhbmRsZXIoTW9kdWxlT3BlblN0YXR1cy5TdG9wLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55SocmVqZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWKoOi9vWpz5paH5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2FkSnNGaWxlcyhmdW5jdGlvbiAoZXJyKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0LCBzdWJDb3VudCwgX2ksIF9hLCBtZWRpYXRvciwgZXJyXzE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTpga7nvalcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaWRlTWFzaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZXJyKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1vZHVsZU9wZW5IYW5kbGVyICYmIHRoaXMubW9kdWxlT3BlbkhhbmRsZXIoTW9kdWxlT3BlblN0YXR1cy5TdG9wLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqHJlamVjdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnRyeXMucHVzaChbMSwgNSwgLCA2XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6KaB5YWI5byA5ZCv6Ieq6Lqr77yM5YaN5byA5ZCv5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2R1bGVPcGVuSGFuZGxlciAmJiB0aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuQmVmb3JlT3Blbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5qih5p2/5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fX2JlZm9yZU9uT3Blbi5hcHBseSh0aGlzLCBbZGF0YV0uY29uY2F0KGFyZ3MpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5qih5p2/5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMub25PcGVuLmFwcGx5KHRoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWIneWni+WMlue7keWumu+8jOWmguaenOWtkOexu+W5tuayoeacieWcqG9uT3BlbuS4reiuvue9rnZpZXdNb2RlbO+8jOWImee7meS4gOS4qum7mOiupOWAvOS7peWQr+WKqOe7keWumuWKn+iDvVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fdmlld01vZGVsKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXdNb2RlbCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YkNvdW50ID0gdGhpcy5fY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJDb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5omA5pyJ5bey5omY566h5Lit5LuL6ICF55qEb3BlbuaWueazlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3Iub3BlbihkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5PUEVORUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5qih5p2/5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5fX2FmdGVyT25PcGVuLmFwcGx5KHRoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjmqKHmnb/mlrnms5VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tb2R1bGVPcGVuSGFuZGxlciAmJiB0aGlzLm1vZHVsZU9wZW5IYW5kbGVyKE1vZHVsZU9wZW5TdGF0dXMuQWZ0ZXJPcGVuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoKE1lZGlhdG9yTWVzc2FnZS5NRURJQVRPUl9PUEVORUQsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqHJlc29sdmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzEgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycl8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDmmL7npLpMb2FkaW5nXHJcbiAgICAgICAgICAgICAgICBpZiAobWFza0ZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrTWFuYWdlci5zaG93TG9hZGluZyhudWxsLCBcIm1lZGlhdG9yT3BlblwiKTtcclxuICAgICAgICAgICAgICAgICAgICBtYXNrRmxhZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGhpZGVNYXNrKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6ZqQ6JePTG9hZGluZ1xyXG4gICAgICAgICAgICAgICAgaWYgKCFtYXNrRmxhZylcclxuICAgICAgICAgICAgICAgICAgICBtYXNrTWFuYWdlci5oaWRlTG9hZGluZyhcIm1lZGlhdG9yT3BlblwiKTtcclxuICAgICAgICAgICAgICAgIG1hc2tGbGFnID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuX19iZWZvcmVPbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g57uZ5a2Q57G755So55qE5qih5p2/5pa55rOVXHJcbiAgICB9O1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLl9fYWZ0ZXJPbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g57uZ5a2Q57G755So55qE5qih5p2/5pa55rOVXHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJjbG9zZURhdGFcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOW8guatpeiOt+WPluWFs+mXreWPguaVsFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge1Byb21pc2U8Q0Q+fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzLnN0YXR1cyA8IE1lZGlhdG9yU3RhdHVzLkNMT1NFRCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOayoeacieWFs+mXreWujOaIkO+8jOetieW+heWujOaIkFxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9jbG9zZUNhY2hlLnB1c2goW3Jlc29sdmUsIHJlamVjdF0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5YWz6Zet5a6M5oiQ77yM55u05o6lcmVzb2x2ZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMuX2Nsb3NlRGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhbPpl63vvIzkuLrkuoblrp7njrBJT3BlbkNsb3Nl5o6l5Y+jXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtDRH0gW2RhdGFdIOWFs+mXreaVsOaNrlxyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDlhbbku5blj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59IOW8guatpei/lOWbnm9uQ2xvc2Xml7bov5Tlm57nmoTlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZHJlbiwgcmVzdWx0LCBlcnJfMjtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISh0aGlzLl9zdGF0dXMgPT09IE1lZGlhdG9yU3RhdHVzLk9QRU5FRCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDQsICwgNV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jbG9zZURhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbiA9IHRoaXMuX2NoaWxkcmVuLmNvbmNhdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBQcm9taXNlLmFsbChjaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGNoaWxkKSB7IHJldHVybiBjaGlsZC5jbG9zZSgpOyB9KSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlhbPpl63oh6rouqtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5qih5p2/5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX19iZWZvcmVPbkNsb3NlLmFwcGx5KHRoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDkv67mlLnnirbmgIFcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gTWVkaWF0b3JTdGF0dXMuQ0xPU0lORztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5vbkNsb3NlLmFwcGx5KHRoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xvc2VEYXRhID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS/ruaUueeKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5DTE9TRUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOaooeadv+aWueazlVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9fYWZ0ZXJPbkNsb3NlLmFwcGx5KHRoaXMsIFtkYXRhXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhyZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5fY2xvc2VEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5omA5pyJY2FjaGXkuK3nmoRyZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLl9jbG9zZUNhY2hlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlQ2FjaGUuc2hpZnQoKVswXSh0aGlzLl9jbG9zZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzIgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJfMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOaJgOaciWNhY2hl5Lit55qEcmVqZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLl9jbG9zZUNhY2hlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlQ2FjaGUuc2hpZnQoKVsxXSh0aGlzLl9jbG9zZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDVdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTogcmV0dXJuIFszIC8qYnJlYWsqLywgN107XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3RhdHVzIDwgTWVkaWF0b3JTdGF0dXMuQ0xPU0VEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDov5jmsqHlvIDlkK/lkaLvvIzmlL7lhaXnvJPlrZhcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb3NlQ2FjaGUucHVzaChbcmVzb2x2ZSwgcmVqZWN0XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlt7Lnu4/lhbPpl63ov4fkuobvvIznm7TmjqVyZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMuX2Nsb3NlRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA3O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSk7XHJcbiAgICB9O1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLl9fYmVmb3JlT25DbG9zZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDnu5nlrZDnsbvnlKjnmoTmqKHmnb/mlrnms5VcclxuICAgIH07XHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuX19hZnRlck9uQ2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5rS+5Y+R5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgdGhpcy5kaXNwYXRjaChNZWRpYXRvck1lc3NhZ2UuTUVESUFUT1JfQ0xPU0VELCB0aGlzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+aJk+W8gOaXtuiwg+eUqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7T0R9IFtkYXRhXSDlj6/og73nmoTmiZPlvIDlj4LmlbBcclxuICAgICAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5YW25LuW5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7YW55fFByb21pc2U8YW55Pn0g6Iul6L+U5Zue5a+56LGh5YiZ5L2/55So6K+l5a+56LGh5pu/5o2i5Lyg5YWl55qEZGF0Yei/m+ihjOWQjue7reW8gOWQr+aTjeS9nFxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPlhbPpl63ml7bosIPnlKhcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0NEfSBbZGF0YV0g5Y+v6IO955qE5YWz6Zet5Y+C5pWwXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOWFtuS7luWPguaVsFxyXG4gICAgICogQHJldHVybnMge2FueXxQcm9taXNlPGFueT59IOiLpei/lOWbnuWvueixoeWImeS9v+eUqOivpeWvueixoeW9k+WBmmNsb3Nl5pON5L2c55qE6L+U5Zue5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLm9uQ2xvc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzkuovku7bvvIzku47ov5nkuKrmlrnms5Xnm5HlkKznmoTkuovku7bkvJrlnKjkuK3ku4vogIXplIDmr4Hml7booqvoh6rliqjnp7vpmaTnm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge1N9IHRhcmdldCDkuovku7bnm67moIflr7nosaFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOS6i+S7tuexu+Wei1xyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciDkuovku7blpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJHlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubWFwTGlzdGVuZXIgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0ID09IHRhcmdldCAmJiBkYXRhLnR5cGUgPT0gdHlwZSAmJiBkYXRhLmhhbmRsZXIgPT0gaGFuZGxlciAmJiBkYXRhLnRoaXNBcmcgPT0gdGhpc0FyZykge1xyXG4gICAgICAgICAgICAgICAgLy8g5bey57uP5a2Y5Zyo5LiA5qC355qE55uR5ZCs77yM5LiN5YaN55uR5ZCsXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6K6w5b2V55uR5ZCsXHJcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzLnB1c2goeyB0YXJnZXQ6IHRhcmdldCwgdHlwZTogdHlwZSwgaGFuZGxlcjogaGFuZGxlciwgdGhpc0FyZzogdGhpc0FyZyB9KTtcclxuICAgICAgICAvLyDosIPnlKjmoaXmjqXlj6NcclxuICAgICAgICB0aGlzLmJyaWRnZS5tYXBMaXN0ZW5lcih0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA55uR5ZCs5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtTfSB0YXJnZXQg5LqL5Lu255uu5qCH5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5LqL5Lu25aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCR5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubWFwTGlzdGVuZXIgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0ID09IHRhcmdldCAmJiBkYXRhLnR5cGUgPT0gdHlwZSAmJiBkYXRhLmhhbmRsZXIgPT0gaGFuZGxlciAmJiBkYXRhLnRoaXNBcmcgPT0gdGhpc0FyZykge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5qGl5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZS51bm1hcExpc3RlbmVyKHRhcmdldCwgdHlwZSwgaGFuZGxlciwgdGhpc0FyZyk7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTorrDlvZVcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xpc3RlbmVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOaJgOacieazqOWGjOWcqOW9k+WJjeS4reS7i+iAheS4iueahOS6i+S7tuebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUudW5tYXBBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX2xpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2xpc3RlbmVycy5wb3AoKTtcclxuICAgICAgICAgICAgLy8g6LCD55So5qGl5o6l5Y+jXHJcbiAgICAgICAgICAgIHRoaXMuYnJpZGdlLnVubWFwTGlzdGVuZXIoZGF0YS50YXJnZXQsIGRhdGEudHlwZSwgZGF0YS5oYW5kbGVyLCBkYXRhLnRoaXNBcmcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuZGlzcG9zZUNoaWxkID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBvcmlEaXNwb3NlKSB7XHJcbiAgICAgICAgLy8g6LCD55So5Y6f5aeL6ZSA5q+B5pa55rOVXHJcbiAgICAgICAgb3JpRGlzcG9zZS5jYWxsKG1lZGlhdG9yKTtcclxuICAgICAgICAvLyDlj5bmtojmiZjnrqFcclxuICAgICAgICB0aGlzLnVuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICB9O1xyXG4gICAgO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJyb290XCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmoLnnuqfkuK3ku4vogIXvvIjlvZPlgZrmqKHlnZfnm7TmjqXooqvmiZPlvIDnmoTkuK3ku4vogIXvvIlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJTWVkaWF0b3J9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIElNZWRpYXRvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMucGFyZW50ID8gdGhpcy5wYXJlbnQucm9vdCA6IHRoaXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lZGlhdG9yLnByb3RvdHlwZSwgXCJjaGlsZHJlblwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5omA5pyJ5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU1lZGlhdG9yW119XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5omY566h5a2Q5Lit5LuL6ICFXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOimgeaJmOeuoeeahOS4reS7i+iAhVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5kZWxlZ2F0ZU1lZGlhdG9yID0gZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NoaWxkcmVuLmluZGV4T2YobWVkaWF0b3IpIDwgMCkge1xyXG4gICAgICAgICAgICAvLyDmiZjnrqHmlrDnmoTkuK3ku4vogIVcclxuICAgICAgICAgICAgdGhpcy5fY2hpbGRyZW4ucHVzaChtZWRpYXRvcik7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWFs+ezu1xyXG4gICAgICAgICAgICBtZWRpYXRvci5wYXJlbnQgPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyDorr7nva5vYnNlcnZhYmxl5YWz57O7XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLm9ic2VydmFibGUucGFyZW50ID0gdGhpcy5fb2JzZXJ2YWJsZTtcclxuICAgICAgICAgICAgLy8g56+h5pS5ZGlzcG9zZeaWueazle+8jOS7peebkeWQrOWFtmRpc3Bvc2VcclxuICAgICAgICAgICAgaWYgKG1lZGlhdG9yLmhhc093blByb3BlcnR5KFwiZGlzcG9zZVwiKSlcclxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3Bvc2VEaWN0LnNldChtZWRpYXRvciwgbWVkaWF0b3IuZGlzcG9zZSk7XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLmRpc3Bvc2UgPSB0aGlzLmRpc3Bvc2VDaGlsZC5iaW5kKHRoaXMsIG1lZGlhdG9yLCBtZWRpYXRvci5kaXNwb3NlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojmiZjnrqHlrZDkuK3ku4vogIVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig6KaB5Y+W5raI5omY566h55qE5Lit5LuL6ICFXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVuZGVsZWdhdGVNZWRpYXRvciA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2NoaWxkcmVuLmluZGV4T2YobWVkaWF0b3IpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOaJmOeuoeS4reS7i+iAhVxyXG4gICAgICAgICAgICB0aGlzLl9jaGlsZHJlbi5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTlhbPns7tcclxuICAgICAgICAgICAgbWVkaWF0b3IucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgLy8g56e76Zmkb2JzZXJ2YWJsZeWFs+ezu1xyXG4gICAgICAgICAgICBpZiAobWVkaWF0b3Iub2JzZXJ2YWJsZSlcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLm9ic2VydmFibGUucGFyZW50ID0gbnVsbDtcclxuICAgICAgICAgICAgLy8g5oGi5aSNZGlzcG9zZeaWueazle+8jOWPlua2iOebkeWQrGRpc3Bvc2VcclxuICAgICAgICAgICAgdmFyIG9yaURpc3Bvc2UgPSB0aGlzLl9kaXNwb3NlRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICBpZiAob3JpRGlzcG9zZSlcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLmRpc3Bvc2UgPSBvcmlEaXNwb3NlO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgbWVkaWF0b3IuZGlzcG9zZTtcclxuICAgICAgICAgICAgdGhpcy5fZGlzcG9zZURpY3QuZGVsZXRlKG1lZGlhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliKTmlq3mjIflrprkuK3ku4vogIXmmK/lkKbljIXlkKvlnKjor6XkuK3ku4vogIXph4zvvIjliKTmlq3ojIPlm7TljIXmi6zlvZPliY3kuK3ku4vogIXlkozlrZDlrZnnuqfkuK3ku4vogIXvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig6KaB5Yik5pat55qE5Lit5LuL6ICFXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuY29udGFpbnNNZWRpYXRvciA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIC8vIOmmluWFiOWIpOaWreiHqui6q1xyXG4gICAgICAgIGlmIChtZWRpYXRvciA9PT0gdGhpcylcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgLy8g5Yik5pat5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgdmFyIGNvbnRhaW5zID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX2NoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgY2hpbGQgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5jb250YWluc01lZGlhdG9yKG1lZGlhdG9yKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvbnRhaW5zO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YW25LuW5qih5Z2X6KKr5YWz6Zet5Zue5Yiw5b2T5YmN5qih5Z2X5pe26LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5Zue5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUud2FrZVVwID0gZnVuY3Rpb24gKGZyb20sIGRhdGEpIHtcclxuICAgICAgICAvLyDosIPnlKjoh6rouqvmlrnms5VcclxuICAgICAgICB0aGlzLm9uV2FrZVVwKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIC8vIOmAkuW9kuiwg+eUqOWtkOS4reS7i+iAheaWueazlVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBtZWRpYXRvci5vbldha2VVcChmcm9tLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmqKHlnZfliIfmjaLliLDliY3lj7Dml7bosIPnlKjvvIjkuI53YWtlVXDnmoTljLrliKvmmK9vcGVu5pe2YWN0aXZhdGXkvJrop6blj5HvvIzkvYZ3YWtlVXDkuI3kvJrvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhJTWVkaWF0b3J8dW5kZWZpbmVkKX0gZnJvbSDku47lk6rkuKrmqKHlnZfmnaXliLDlvZPliY3mqKHlnZdcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWPr+iDveeahOWPguaVsOS8oOmAklxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5hY3RpdmF0ZSA9IGZ1bmN0aW9uIChmcm9tLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g6LCD55So6Ieq6Lqr5pa55rOVXHJcbiAgICAgICAgdGhpcy5vbkFjdGl2YXRlKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIC8vIOmAkuW9kuiwg+eUqOWtkOS4reS7i+iAheaWueazlVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9jaGlsZHJlbjsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1lZGlhdG9yID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBtZWRpYXRvci5vbkFjdGl2YXRlKGZyb20sIGRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaooeWdl+WIh+aNouWIsOWQjuWPsOaXtuiwg+eUqO+8iGNsb3Nl5LmL5ZCO5oiW6ICF5YW25LuW5qih5Z2X5omT5byA5pe277yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IHRvIOWwhuimgeWOu+W+gOWTquS4quaooeWdl1xyXG4gICAgICogQHBhcmFtIHsqfSBbZGF0YV0g5Y+v6IO955qE5Y+C5pWw5Lyg6YCSXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLmRlYWN0aXZhdGUgPSBmdW5jdGlvbiAodG8sIGRhdGEpIHtcclxuICAgICAgICAvLyDosIPnlKjoh6rouqvmlrnms5VcclxuICAgICAgICB0aGlzLm9uRGVhY3RpdmF0ZSh0bywgZGF0YSk7XHJcbiAgICAgICAgLy8g6YCS5b2S6LCD55So5a2Q5Lit5LuL6ICF5pa55rOVXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX2NoaWxkcmVuOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgbWVkaWF0b3IgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLm9uRGVhY3RpdmF0ZSh0bywgZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiX5Ye65Lit5LuL6ICF5omA6ZyA55qE6LWE5rqQ5pWw57uE77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0QXNzZXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiX5Ye65omA6ZyAQ1NT6LWE5rqQVVJM77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ1tdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0U3R5bGVGaWxlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIl+WHuuaJgOmcgEpT6LWE5rqQVVJM77yM5Y+v6YeN5YaZXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge0pTRmlsZVtdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0SnNGaWxlcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIl+WHuuaooeWdl+WIneWni+WMluivt+axgu+8jOWPr+mHjeWGmVxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtSZXF1ZXN0RGF0YVtdfVxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5saXN0SW5pdFJlcXVlc3RzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YW25LuW5qih5Z2X6KKr5YWz6Zet5Zue5Yiw5b2T5YmN5qih5Z2X5pe26LCD55SoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5Zue5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25XYWtlVXAgPSBmdW5jdGlvbiAoZnJvbSwgZGF0YSkge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5qih5Z2X5YiH5o2i5Yiw5YmN5Y+w5pe26LCD55So77yI5LiOb25XYWtlVXDnmoTljLrliKvmmK9vcGVu5pe2b25BY3RpdmF0ZeS8muinpuWPke+8jOS9hm9uV2FrZVVw5LiN5Lya77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoSU1lZGlhdG9yfHVuZGVmaW5lZCl9IGZyb20g5LuO5ZOq5Liq5qih5Z2X5p2l5Yiw5b2T5YmN5qih5Z2XXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj6/og73nmoTlj4LmlbDkvKDpgJJcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChmcm9tLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmqKHlnZfliIfmjaLliLDlkI7lj7Dml7bosIPnlKjvvIhjbG9zZeS5i+WQjuaIluiAheWFtuS7luaooeWdl+aJk+W8gOaXtu+8iVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KElNZWRpYXRvcnx1bmRlZmluZWQpfSB0byDlsIbopoHljrvlvoDlk6rkuKrmqKHlnZdcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWPr+iDveeahOWPguaVsOS8oOmAklxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5vbkRlYWN0aXZhdGUgPSBmdW5jdGlvbiAodG8sIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWVkaWF0b3IucHJvdG90eXBlLCBcIm9ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOaatOmcsklPYnNlcnZhYmxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vYnNlcnZhYmxlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqIGRpc3BhdGNo5pa55rOV5a6e546wICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHBhcmFtc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLmRpc3BhdGNoLmFwcGx5KHRoaXMuX29ic2VydmFibGUsIHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDmtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5raI5oGv5aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSDmtojmga90aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbmmK/kuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUubGlzdGVuKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5raI5oGv55uR5ZCsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOa2iOaBr+WkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10g5raI5oGvdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0g5piv5ZCm5piv5LiA5qyh5oCn55uR5ZCsXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubGlzdGVuID0gZnVuY3Rpb24gKHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcsIG9uY2UpIHtcclxuICAgICAgICBpZiAob25jZSA9PT0gdm9pZCAwKSB7IG9uY2UgPSBmYWxzZTsgfVxyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUudW5saXN0ZW4odHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozlkb3ku6TliLDnibnlrprmtojmga/nsbvlnovkuIrvvIzlvZPov5nkuKrnsbvlnovnmoTmtojmga/mtL7lj5HliLDmoYbmnrblhoXmoLjml7bkvJrop6blj5FDb21tYW5k6L+Q6KGMXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo5YaM55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqO+8jOWPr+S7peaYr+aWueazleW9ouW8j++8jOS5n+WPr+S7peS9v+exu+W9ouW8j1xyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIHRoaXMuX29ic2VydmFibGUubWFwQ29tbWFuZCh0eXBlLCBjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo6ZSA5ZG95LukXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo6ZSA55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqFxyXG4gICAgICogQHJldHVybnMge3ZvaWR9XHJcbiAgICAgKiBAbWVtYmVyb2YgTWVkaWF0b3JcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3IucHJvdG90eXBlLnVubWFwQ29tbWFuZCA9IGZ1bmN0aW9uICh0eXBlLCBjbWQpIHtcclxuICAgICAgICB0aGlzLl9vYnNlcnZhYmxlLnVubWFwQ29tbWFuZCh0eXBlLCBjbWQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZSA5q+B5Lit5LuL6ICFXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIE1lZGlhdG9yXHJcbiAgICAgKi9cclxuICAgIE1lZGlhdG9yLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8g5Yik5pat54q25oCBXHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IE1lZGlhdG9yU3RhdHVzLkRJU1BPU0lORylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOS/ruaUueeKtuaAgVxyXG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IE1lZGlhdG9yU3RhdHVzLkRJU1BPU0lORztcclxuICAgICAgICAvLyDnp7vpmaTnu5HlrppcclxuICAgICAgICBiaW5kTWFuYWdlci51bmJpbmQodGhpcyk7XHJcbiAgICAgICAgLy8g5rOo6ZSA5LqL5Lu255uR5ZCsXHJcbiAgICAgICAgdGhpcy51bm1hcEFsbExpc3RlbmVycygpO1xyXG4gICAgICAgIC8vIOiwg+eUqOaooeadv+aWueazlVxyXG4gICAgICAgIHRoaXMub25EaXNwb3NlKCk7XHJcbiAgICAgICAgLy8g56e76Zmk5pi+56S677yM5Y+q56e76Zmk5rKh5pyJ5Y6f5aeL55qu6IKk55qE77yM5Zug5Li65aaC5p6c5pyJ5Y6f5aeL55qu6IKk77yM5YW25Y6f5aeLcGFyZW505Y+v6IO95LiN5biM5pyb5a2Q6IqC54K56KKr56e76ZmkXHJcbiAgICAgICAgaWYgKCF0aGlzLm9yaVNraW4pIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2tpbiAmJiB0aGlzLmJyaWRnZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMuYnJpZGdlLmdldFBhcmVudCh0aGlzLnNraW4pO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudClcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJyaWRnZS5yZW1vdmVDaGlsZChwYXJlbnQsIHRoaXMuc2tpbik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g56e76Zmk6KGo546w5bGC5qGlXHJcbiAgICAgICAgdGhpcy5icmlkZ2UgPSBudWxsO1xyXG4gICAgICAgIC8vIOenu+mZpFZpZXdNb2RlbFxyXG4gICAgICAgIHVubXV0YXRlKHRoaXMuX3ZpZXdNb2RlbCk7XHJcbiAgICAgICAgdGhpcy5fdmlld01vZGVsID0gbnVsbDtcclxuICAgICAgICAvLyDnp7vpmaTnu5Hlrprnm67moIfmlbDnu4RcclxuICAgICAgICB0aGlzLmJpbmRUYXJnZXRzID0gbnVsbDtcclxuICAgICAgICAvLyDnp7vpmaTmlbDmja5cclxuICAgICAgICB0aGlzLmRhdGEgPSBudWxsO1xyXG4gICAgICAgIC8vIOenu+mZpOearuiCpFxyXG4gICAgICAgIHRoaXMuc2tpbiA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vcmlTa2luID0gbnVsbDtcclxuICAgICAgICAvLyDnp7vpmaTniLblvJXnlKhcclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgLy8g56e76Zmk5YW25LuW5peg55So5a+56LGhXHJcbiAgICAgICAgdGhpcy5tb2R1bGVPcGVuSGFuZGxlciA9IG51bGw7XHJcbiAgICAgICAgLy8g5bCG5omA5pyJ5a2Q5Lit5LuL6ICF6ZSA5q+BXHJcbiAgICAgICAgdmFyIGNoaWxkcmVuID0gdGhpcy5fY2hpbGRyZW4uY29uY2F0KCk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjaGlsZHJlbl8xID0gY2hpbGRyZW47IF9pIDwgY2hpbGRyZW5fMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGNoaWxkID0gY2hpbGRyZW5fMVtfaV07XHJcbiAgICAgICAgICAgIGNoaWxkLmRpc3Bvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5bCGb2JzZXJ2YWJsZeeahOmUgOavgeaLluW7tuWIsOS4i+S4gOW4p++8jOWboOS4uuiZveeEtuaJp+ihjOS6humUgOavge+8jOS9huacieWPr+iDvei/meS5i+WQjui/mOS8muS9v+eUqG9ic2VydmFibGXlj5HpgIHmtojmga9cclxuICAgICAgICBzeXN0ZW0ubmV4dEZyYW1lKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g56e76Zmkb2JzZXJ2YWJsZVxyXG4gICAgICAgICAgICBfdGhpcy5fb2JzZXJ2YWJsZS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIF90aGlzLl9vYnNlcnZhYmxlID0gbnVsbDtcclxuICAgICAgICAgICAgLy8g5L+u5pS554q25oCBXHJcbiAgICAgICAgICAgIF90aGlzLl9zdGF0dXMgPSBNZWRpYXRvclN0YXR1cy5ESVNQT1NFRDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOW9k+mUgOavgeaXtuiwg+eUqFxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvclxyXG4gICAgICovXHJcbiAgICBNZWRpYXRvci5wcm90b3R5cGUub25EaXNwb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOWPr+mHjeWGmVxyXG4gICAgfTtcclxuICAgIHJldHVybiBNZWRpYXRvcjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTWVkaWF0b3I7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tZWRpYXRvci9NZWRpYXRvci5qc1xuLy8gbW9kdWxlIGlkID0gN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgbWFza01hbmFnZXIgfSBmcm9tIFwiLi4vbWFzay9NYXNrTWFuYWdlclwiO1xyXG5pbXBvcnQgTWVkaWF0b3IgZnJvbSBcIi4uL21lZGlhdG9yL01lZGlhdG9yXCI7XHJcbmltcG9ydCB7IG1vZHVsZU1hbmFnZXIgfSBmcm9tIFwiLi4vbW9kdWxlL01vZHVsZU1hbmFnZXJcIjtcclxuaW1wb3J0IHsgcGFuZWxNYW5hZ2VyIH0gZnJvbSBcIi4uL3BhbmVsL1BhbmVsTWFuYWdlclwiO1xyXG5pbXBvcnQgeyBzY2VuZU1hbmFnZXIgfSBmcm9tIFwiLi4vc2NlbmUvU2NlbmVNYW5hZ2VyXCI7XHJcbmltcG9ydCBCcmlkZ2VNZXNzYWdlIGZyb20gXCIuL0JyaWRnZU1lc3NhZ2VcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIOeUqOadpeeuoeeQhuaJgOacieihqOeOsOWxguWvueixoVxyXG4qL1xyXG52YXIgQnJpZGdlTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJyaWRnZU1hbmFnZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fYnJpZGdlRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2JyaWRnZUxpc3QgPSBbXTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCcmlkZ2VNYW5hZ2VyLnByb3RvdHlwZSwgXCJjdXJyZW50QnJpZGdlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3nmoTooajnjrDlsYLmoaXlrp7kvovvvIjop4TliJnmmK/lj5blvZPliY3mqKHlnZfnmoTnrKzkuIDkuKrmi6XmnIlicmlkZ2XlsZ7mgKfnmoRNZWRpYXRvcueahGJyaWRnZe+8iVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lCcmlkZ2V9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEJyaWRnZU1hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g5om+5Ye65b2T5YmN55qE5Zy65pmv5oiW5qih5Z2XXHJcbiAgICAgICAgICAgIHZhciBjdXJIYXNCcmlkZ2UgPSBzY2VuZU1hbmFnZXIuY3VycmVudFNjZW5lIHx8IG1vZHVsZU1hbmFnZXIuY3VycmVudE1vZHVsZUluc3RhbmNlO1xyXG4gICAgICAgICAgICAvLyDlhYjnlKjlvZPliY3pppbkuKpJSGFzQnJpZGdl55qEYnJpZGdlXHJcbiAgICAgICAgICAgIGlmIChjdXJIYXNCcmlkZ2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBoYXNCcmlkZ2VzID0gdGhpcy5nZXRBbGxIYXNCcmlkZ2VzKGN1ckhhc0JyaWRnZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIGhhc0JyaWRnZXNfMSA9IGhhc0JyaWRnZXM7IF9pIDwgaGFzQnJpZGdlc18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBoYXNCcmlkZ2UgPSBoYXNCcmlkZ2VzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNCcmlkZ2UuYnJpZGdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGFzQnJpZGdlLmJyaWRnZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDmsqHmib7liLDvvIzlho3nlKjnrKzkuIDkuKrmoaXku6Pmm79cclxuICAgICAgICAgICAgcmV0dXJuICh0aGlzLl9icmlkZ2VMaXN0WzBdICYmIHRoaXMuX2JyaWRnZUxpc3RbMF1bMF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJyaWRnZU1hbmFnZXIucHJvdG90eXBlLCBcImJyaWRnZXNcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaJgOacieihqOeOsOWxguahpVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lCcmlkZ2VbXX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQnJpZGdlTWFuYWdlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYnJpZGdlTGlzdC5tYXAoZnVuY3Rpb24gKGJyaWRnZURhdGEpIHsgcmV0dXJuIGJyaWRnZURhdGFbMF07IH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQnJpZGdlTWFuYWdlci5wcm90b3R5cGUuZ2V0QWxsSGFzQnJpZGdlcyA9IGZ1bmN0aW9uIChoYXNCcmlkZ2UpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW2hhc0JyaWRnZV07XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5Lit5LuL6ICF77yM5YiZ6aKd5aSW5o+Q5L6b5a2Q5Lit5LuL6ICFXHJcbiAgICAgICAgaWYgKGhhc0JyaWRnZSBpbnN0YW5jZW9mIE1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBoYXNCcmlkZ2UuY2hpbGRyZW47IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQodGhpcy5nZXRBbGxIYXNCcmlkZ2VzKHRlbXApKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W6KGo546w5bGC5qGl5a6e5L6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KGo546w5bGC57G75Z6LXHJcbiAgICAgKiBAcmV0dXJucyB7SUJyaWRnZX0g6KGo546w5bGC5qGl5a6e5L6LXHJcbiAgICAgKiBAbWVtYmVyb2YgQnJpZGdlTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCcmlkZ2VNYW5hZ2VyLnByb3RvdHlwZS5nZXRCcmlkZ2UgPSBmdW5jdGlvbiAodHlwZSkge1xyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fYnJpZGdlRGljdFt0eXBlXTtcclxuICAgICAgICByZXR1cm4gKGRhdGEgJiYgZGF0YVswXSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpgJrov4fnu5nlh7rkuIDkuKrmmL7npLrlr7nosaHnmq7ogqTlrp7kvovmnaXojrflj5blkIjpgILnmoTooajnjrDlsYLmoaXlrp7kvotcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHNraW4g55qu6IKk5a6e5L6LXHJcbiAgICAgKiBAcmV0dXJucyB7SUJyaWRnZXxudWxsfSDnmq7ogqTmiYDlsZ7ooajnjrDlsYLmoaXlrp7kvotcclxuICAgICAqIEBtZW1iZXJvZiBCcmlkZ2VNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1hbmFnZXIucHJvdG90eXBlLmdldEJyaWRnZUJ5U2tpbiA9IGZ1bmN0aW9uIChza2luKSB7XHJcbiAgICAgICAgaWYgKHNraW4pIHtcclxuICAgICAgICAgICAgLy8g6YGN5Y6G5omA5pyJ5bey5rOo5YaM55qE6KGo546w5bGC5qGl6L+b6KGM5Yik5patXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9icmlkZ2VMaXN0OyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgYnJpZGdlID0gZGF0YVswXTtcclxuICAgICAgICAgICAgICAgIGlmIChicmlkZ2UuaXNNeVNraW4oc2tpbikpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGJyaWRnZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOS4gOS4quihqOeOsOWxguahpeWunuS+i+WIsOahhuaetuS4rVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7Li4uSUJyaWRnZVtdfSBicmlkZ2VzIOimgeazqOWGjOeahOaJgOacieihqOeOsOWxguahpVxyXG4gICAgICogQG1lbWJlcm9mIEJyaWRnZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQnJpZGdlTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXJCcmlkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgYnJpZGdlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGJyaWRnZXNbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6L+b6KGMRE9N5Yid5aeL5YyW5Yik5patXHJcbiAgICAgICAgaWYgKCFkb2N1bWVudC5ib2R5KSB7XHJcbiAgICAgICAgICAgIHZhciBvbkxvYWQgPSBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgb25Mb2FkKTtcclxuICAgICAgICAgICAgICAgIC8vIOmHjeaWsOiwg+eUqOazqOWGjOaWueazlVxyXG4gICAgICAgICAgICAgICAgX3RoaXMucmVnaXN0ZXJCcmlkZ2UuYXBwbHkoX3RoaXMsIGJyaWRnZXMpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgb25Mb2FkKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDov5vooYzliJ3lp4vljJZcclxuICAgICAgICBpZiAoYnJpZGdlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgLy8g6K6w5b2VXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9hID0gMCwgYnJpZGdlc18xID0gYnJpZGdlczsgX2EgPCBicmlkZ2VzXzEubGVuZ3RoOyBfYSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlc18xW19hXTtcclxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gYnJpZGdlLnR5cGU7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2JyaWRnZURpY3RbdHlwZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IFticmlkZ2UsIGZhbHNlXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9icmlkZ2VEaWN0W3R5cGVdID0gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9icmlkZ2VMaXN0LnB1c2goZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5byA5aeL5Yid5aeL5YyWXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9iID0gMCwgYnJpZGdlc18yID0gYnJpZGdlczsgX2IgPCBicmlkZ2VzXzIubGVuZ3RoOyBfYisrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlc18yW19iXTtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChCcmlkZ2VNZXNzYWdlLkJSSURHRV9CRUZPUkVfSU5JVCwgYnJpZGdlKTtcclxuICAgICAgICAgICAgICAgIC8vIOWIneWni+WMlk1hc2tcclxuICAgICAgICAgICAgICAgIG1hc2tNYW5hZ2VyLnJlZ2lzdGVyTWFzayhicmlkZ2UudHlwZSwgYnJpZGdlLm1hc2tFbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgLy8g5rOo5YaM6YCa55So5o+Q56S65qGGXHJcbiAgICAgICAgICAgICAgICBwYW5lbE1hbmFnZXIucmVnaXN0ZXJQcm9tcHQoYnJpZGdlLnR5cGUsIGJyaWRnZS5wcm9tcHRDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAvLyDliJ3lp4vljJbor6XooajnjrDlsYLlrp7kvotcclxuICAgICAgICAgICAgICAgIGlmIChicmlkZ2UuaW5pdClcclxuICAgICAgICAgICAgICAgICAgICBicmlkZ2UuaW5pdChhZnRlckluaXRCcmlkZ2UpO1xyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIGFmdGVySW5pdEJyaWRnZShicmlkZ2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRlc3RBbGxJbml0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGFmdGVySW5pdEJyaWRnZShicmlkZ2UpIHtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5raI5oGvXHJcbiAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQnJpZGdlTWVzc2FnZS5CUklER0VfQUZURVJfSU5JVCwgYnJpZGdlKTtcclxuICAgICAgICAgICAgLy8g6K6+572u5Yid5aeL5YyW5a6M5q+V5bGe5oCnXHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gc2VsZi5fYnJpZGdlRGljdFticmlkZ2UudHlwZV07XHJcbiAgICAgICAgICAgIGRhdGFbMV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyDlhYjpmpDol4/ooajnjrDlsYLmoaXnmoRodG1sV3JhcHBlclxyXG4gICAgICAgICAgICBicmlkZ2UuaHRtbFdyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICAvLyDmtYvor5XmmK/lkKblhajpg6jliJ3lp4vljJblrozmr5VcclxuICAgICAgICAgICAgc2VsZi50ZXN0QWxsSW5pdCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBCcmlkZ2VNYW5hZ2VyLnByb3RvdHlwZS50ZXN0QWxsSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYWxsSW5pdGVkID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fYnJpZGdlTGlzdDsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGRhdGEgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIGFsbEluaXRlZCA9IGFsbEluaXRlZCAmJiBkYXRhWzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWxsSW5pdGVkKVxyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FMTF9JTklUKTtcclxuICAgIH07XHJcbiAgICBCcmlkZ2VNYW5hZ2VyID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBCcmlkZ2VNYW5hZ2VyKTtcclxuICAgIHJldHVybiBCcmlkZ2VNYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBCcmlkZ2VNYW5hZ2VyO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgYnJpZGdlTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KEJyaWRnZU1hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYnJpZGdlL0JyaWRnZU1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgZGVjb3JhdGVUaGlzIH0gZnJvbSBcIi4uLy4uL2NvcmUvZ2xvYmFsL1BhdGNoXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgTWVzc2FnZSBmcm9tIFwiLi4vLi4vY29yZS9tZXNzYWdlL01lc3NhZ2VcIjtcclxuaW1wb3J0IFwiLi4vLi4vbGlicy9SZWZsZWN0XCI7XHJcbmltcG9ydCB7IGxpc3RlbkFwcGx5LCBsaXN0ZW5Db25zdHJ1Y3QsIGxpc3RlbkRpc3Bvc2UsIHdyYXBDb25zdHJ1Y3QgfSBmcm9tIFwiLi4vLi4vdXRpbHMvQ29uc3RydWN0VXRpbFwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyByZXBsYWNlRGlzcGxheSB9IGZyb20gXCIuLi8uLi91dGlscy9EaXNwbGF5VXRpbFwiO1xyXG5pbXBvcnQgeyBldmFsRXhwIH0gZnJvbSBcIi4uL2JpbmQvVXRpbHNcIjtcclxuaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCIuLi9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG5pbXBvcnQgTWVkaWF0b3IsIHsgZ2V0TW9kdWxlTmFtZSwgaXNNZWRpYXRvciwgcmVnaXN0ZXJNb2R1bGUgfSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JcIjtcclxuaW1wb3J0IE1lZGlhdG9yU3RhdHVzIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclN0YXR1c1wiO1xyXG5pbXBvcnQgeyBuZXRNYW5hZ2VyIH0gZnJvbSBcIi4uL25ldC9OZXRNYW5hZ2VyXCI7XHJcbmltcG9ydCBSZXNwb25zZURhdGEgZnJvbSBcIi4uL25ldC9SZXNwb25zZURhdGFcIjtcclxuaW1wb3J0ICogYXMgQmluZFV0aWwgZnJvbSBcIi4vQmluZFV0aWxcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE5XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTE5XHJcbiAqXHJcbiAqIOi0n+i0o+azqOWFpeeahOaooeWdl1xyXG4qL1xyXG4vKiog5a6a5LmJ5pWw5o2u5qih5Z6L77yM5pSv5oyB5a6e5L6L5rOo5YWl77yM5bm25LiU6Ieq6Lqr5Lmf5Lya6KKr5rOo5YWlICovXHJcbmV4cG9ydCBmdW5jdGlvbiBNb2RlbENsYXNzKCkge1xyXG4gICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgLy8g6L2s6LCDSW5qZWN0YWJsZeaWueazlVxyXG4gICAgaWYgKHRoaXMgPT09IGRlY29yYXRlVGhpcykge1xyXG4gICAgICAgIHZhciBjbHMgPSB3cmFwQ29uc3RydWN0KGFyZ3NbMF0pO1xyXG4gICAgICAgIEluamVjdGFibGUuY2FsbCh0aGlzLCBjbHMpO1xyXG4gICAgICAgIHJldHVybiBjbHM7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gSW5qZWN0YWJsZS5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHJlYWxDbHMpIHtcclxuICAgICAgICAgICAgcmVhbENscyA9IHdyYXBDb25zdHJ1Y3QocmVhbENscyk7XHJcbiAgICAgICAgICAgIHJlc3VsdC5jYWxsKHRoaXMsIHJlYWxDbHMpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVhbENscztcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XHJcbi8qKiDlrprkuYnnlYzpnaLkuK3ku4vogIXvvIzmlK/mjIHlrp7kvovms6jlhaXvvIzlubblj6/moLnmja7miYDotYvmmL7npLrlr7nosaHoh6rliqjosIPmlbTmiYDkvb/nlKjnmoTooajnjrDlsYLmoaUgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIE1lZGlhdG9yQ2xhc3MobW9kdWxlTmFtZSkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjbHMpIHtcclxuICAgICAgICAvLyDliKTmlq3kuIDkuItNZWRpYXRvcuaYr+WQpuaciWRpc3Bvc2Xmlrnms5XvvIzmsqHmnInnmoTor53lvLnkuIDkuKrorablkYpcclxuICAgICAgICBpZiAoIWNscy5wcm90b3R5cGUuZGlzcG9zZSlcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiTWVkaWF0b3JbXCIgKyBjbHNbXCJuYW1lXCJdICsgXCJd5LiN5YW35pyJZGlzcG9zZeaWueazle+8jOWPr+iDveS8mumAoOaIkOWGheWtmOmXrumimO+8jOivt+iuqeivpU1lZGlhdG9y5a6e546wSURpc3Bvc2FibGXmjqXlj6NcIik7XHJcbiAgICAgICAgLy8g55uR5ZCs5a6e5L6L5YyWXHJcbiAgICAgICAgbGlzdGVuQ29uc3RydWN0KGNscywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIC8vIOabv+aNonNraW7lsZ7mgKdcclxuICAgICAgICAgICAgdmFyICRza2luO1xyXG4gICAgICAgICAgICB2YXIgb3JpU2tpbiA9IGluc3RhbmNlLnNraW47XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpbnN0YW5jZSwgXCJza2luXCIsIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNraW47XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICRza2luKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RCcmlkZ2UgPSB0aGlzLmJyaWRnZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmoLnmja5za2lu57G75Z6L6YCJ5Y+W6KGo546w5bGC5qGlXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5icmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZUJ5U2tpbih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYnJpZGdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmJyaWRnZSA9PT0gbGFzdEJyaWRnZSAmJiAkc2tpbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6ZyA6KaB5Yik5pat5qGl55qE57G75Z6L5piv5ZCm55u45ZCM77yM5LiU5LmL5YmN5pyJ55qu6IKk77yM5YiZ5pu/5o2i55qu6IKkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2tpbiA9IHRoaXMuYnJpZGdlLnJlcGxhY2VTa2luKHRoaXMsICRza2luLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlkKbliJnnm7TmjqXljIXoo4XkuIDkuIvnmq7ogqRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRza2luID0gdGhpcy5icmlkZ2Uud3JhcFNraW4odGhpcywgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDkuI3orqTor4bnmoTnmq7ogqTnsbvlnovvvIznm7TmjqXotYvlgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNraW4gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmnKzmnaXlsLHmnInnmq7ogqTvvIzliJnotYvlgLznmq7ogqRcclxuICAgICAgICAgICAgaWYgKG9yaVNraW4pXHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5za2luID0gb3JpU2tpbjtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDljIXoo4XnsbtcclxuICAgICAgICB2YXIgd3JhcHBlckNscyA9IHdyYXBDb25zdHJ1Y3QoY2xzKTtcclxuICAgICAgICAvLyDms6jlhozmqKHlnZfvvIzmr4/kuIDkuKpNZWRpYXRvcumDveacieaIkOS4uueLrOeri01vZHVsZeeahOiDveWKm1xyXG4gICAgICAgIHJlZ2lzdGVyTW9kdWxlKG1vZHVsZU5hbWUsIHdyYXBwZXJDbHMpO1xyXG4gICAgICAgIC8vIOi/lOWbnuWMheijheexu1xyXG4gICAgICAgIHJldHVybiB3cmFwcGVyQ2xzO1xyXG4gICAgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gTWVzc2FnZUhhbmRsZXIodGFyZ2V0LCBrZXkpIHtcclxuICAgIGlmIChrZXkpIHtcclxuICAgICAgICB2YXIgZGVmcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCB0YXJnZXQsIGtleSk7XHJcbiAgICAgICAgdmFyIHJlc0NsYXNzID0gZGVmc1swXTtcclxuICAgICAgICBpZiAoIShyZXNDbGFzcy5wcm90b3R5cGUgaW5zdGFuY2VvZiBNZXNzYWdlKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQE1lc3NhZ2VIYW5kbGVy6KOF6aWw5Zmo6KOF6aWw55qE5pa55rOV55qE6aaW5Liq5Y+C5pWw5b+F6aG75pivTWVzc2FnZVwiKTtcclxuICAgICAgICBkb01lc3NhZ2VIYW5kbGVyKHRhcmdldC5jb25zdHJ1Y3Rvciwga2V5LCByZXNDbGFzcywgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpIHtcclxuICAgICAgICAgICAgZG9NZXNzYWdlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCB0YXJnZXQsIHRydWUpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuO1xyXG5leHBvcnQgZnVuY3Rpb24gR2xvYmFsTWVzc2FnZUhhbmRsZXIodGFyZ2V0LCBrZXkpIHtcclxuICAgIGlmIChrZXkpIHtcclxuICAgICAgICB2YXIgZGVmcyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCB0YXJnZXQsIGtleSk7XHJcbiAgICAgICAgdmFyIHJlc0NsYXNzID0gZGVmc1swXTtcclxuICAgICAgICBpZiAoIShyZXNDbGFzcy5wcm90b3R5cGUgaW5zdGFuY2VvZiBNZXNzYWdlKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQEdsb2JhbE1lc3NhZ2VIYW5kbGVy6KOF6aWw5Zmo6KOF6aWw55qE5pa55rOV55qE6aaW5Liq5Y+C5pWw5b+F6aG75pivTWVzc2FnZVwiKTtcclxuICAgICAgICBkb01lc3NhZ2VIYW5kbGVyKHRhcmdldC5jb25zdHJ1Y3Rvciwga2V5LCByZXNDbGFzcywgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgICAgIGRvTWVzc2FnZUhhbmRsZXIocHJvdG90eXBlLmNvbnN0cnVjdG9yLCBwcm9wZXJ0eUtleSwgdGFyZ2V0LCBmYWxzZSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG47XHJcbmZ1bmN0aW9uIGRvTWVzc2FnZUhhbmRsZXIoY2xzLCBrZXksIHR5cGUsIGluTW9kdWxlKSB7XHJcbiAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgIGxpc3RlbkNvbnN0cnVjdChjbHMsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGlmIChpbnN0YW5jZSBpbnN0YW5jZW9mIE1lZGlhdG9yICYmIGluc3RhbmNlLnBhcmVudCkge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzmmK/ooqvmiZjnrqHnmoRNZWRpYXRvcu+8jOWImemcgOimgeetieWIsOiiq+aJmOeuoeWQjuWGjeaJp+ihjOazqOWGjFxyXG4gICAgICAgICAgICBhZGRTdWJIYW5kbGVyKGluc3RhbmNlLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IGluTW9kdWxlID8gaW5zdGFuY2Uub2JzZXJ2YWJsZSB8fCBjb3JlLm9ic2VydmFibGUgOiBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLmxpc3Rlbih0eXBlLCBpbnN0YW5jZVtrZXldLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBpbk1vZHVsZSA/IGluc3RhbmNlLm9ic2VydmFibGUgfHwgY29yZS5vYnNlcnZhYmxlIDogY29yZS5vYnNlcnZhYmxlO1xyXG4gICAgICAgICAgICBvYnNlcnZhYmxlLmxpc3Rlbih0eXBlLCBpbnN0YW5jZVtrZXldLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyDnm5HlkKzplIDmr4FcclxuICAgIGxpc3RlbkRpc3Bvc2UoY2xzLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IGluTW9kdWxlID8gaW5zdGFuY2Uub2JzZXJ2YWJsZSB8fCBjb3JlLm9ic2VydmFibGUgOiBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgb2JzZXJ2YWJsZS51bmxpc3Rlbih0eXBlLCBpbnN0YW5jZVtrZXldLCBpbnN0YW5jZSk7XHJcbiAgICB9KTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gUmVzcG9uc2VIYW5kbGVyKHRhcmdldCwga2V5KSB7XHJcbiAgICBpZiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGRlZnMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgdGFyZ2V0LCBrZXkpO1xyXG4gICAgICAgIHZhciByZXNDbGFzcyA9IGRlZnNbMF07XHJcbiAgICAgICAgaWYgKCEocmVzQ2xhc3MucHJvdG90eXBlIGluc3RhbmNlb2YgUmVzcG9uc2VEYXRhKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi5peg5Y+C5pWwQFJlc3BvbnNlSGFuZGxlcuijhemlsOWZqOijhemlsOeahOaWueazleeahOmmluS4quWPguaVsOW/hemhu+aYr1Jlc3BvbnNlRGF0YVwiKTtcclxuICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcih0YXJnZXQuY29uc3RydWN0b3IsIGtleSwgZGVmc1swXSwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XHJcbiAgICAgICAgICAgIGRvUmVzcG9uc2VIYW5kbGVyKHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgcHJvcGVydHlLZXksIHRhcmdldCwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn1cclxuLyoqIOWkhOeQhumAmuiur+a2iOaBr+mUmeivryAqL1xyXG5leHBvcnQgZnVuY3Rpb24gUmVzcG9uc2VFcnJvckhhbmRsZXIoY2xzKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpIHtcclxuICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCBjbHMsIHRydWUsIHRydWUpO1xyXG4gICAgfTtcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gR2xvYmFsUmVzcG9uc2VIYW5kbGVyKHRhcmdldCwga2V5KSB7XHJcbiAgICBpZiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGRlZnMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgdGFyZ2V0LCBrZXkpO1xyXG4gICAgICAgIHZhciByZXNDbGFzcyA9IGRlZnNbMF07XHJcbiAgICAgICAgaWYgKCEocmVzQ2xhc3MucHJvdG90eXBlIGluc3RhbmNlb2YgUmVzcG9uc2VEYXRhKSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwi5peg5Y+C5pWwQEdsb2JhbFJlc3BvbnNlSGFuZGxlcuijhemlsOWZqOijhemlsOeahOaWueazleeahOmmluS4quWPguaVsOW/hemhu+aYr1Jlc3BvbnNlRGF0YVwiKTtcclxuICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcih0YXJnZXQuY29uc3RydWN0b3IsIGtleSwgZGVmc1swXSwgZmFsc2UsIGZhbHNlKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBkb1Jlc3BvbnNlSGFuZGxlcihwcm90b3R5cGUuY29uc3RydWN0b3IsIHByb3BlcnR5S2V5LCB0YXJnZXQsIGZhbHNlLCBmYWxzZSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG4vKiog5aSE55CG5YWo5bGA6YCa6K6v5raI5oGv6ZSZ6K+vICovXHJcbmV4cG9ydCBmdW5jdGlvbiBHbG9iYWxSZXNwb25zZUVycm9ySGFuZGxlcihjbHMpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgIGRvUmVzcG9uc2VIYW5kbGVyKHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgcHJvcGVydHlLZXksIGNscywgZmFsc2UsIHRydWUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkb1Jlc3BvbnNlSGFuZGxlcihjbHMsIGtleSwgdHlwZSwgaW5Nb2R1bGUsIGxpc3RlbkVycm9yKSB7XHJcbiAgICB2YXIgY3VySW5zdGFuY2U7XHJcbiAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgIGxpc3RlbkNvbnN0cnVjdChjbHMsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIC8vIOiusOW9lei1i+WAvFxyXG4gICAgICAgIGN1ckluc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5ZCm5Lit5LuL6ICFXHJcbiAgICAgICAgaWYgKGluc3RhbmNlIGluc3RhbmNlb2YgTWVkaWF0b3IgJiYgaW5zdGFuY2UucGFyZW50KSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOaYr+iiq+aJmOeuoeeahE1lZGlhdG9y77yM5YiZ6ZyA6KaB562J5Yiw6KKr5omY566h5ZCO5YaN5omn6KGM5rOo5YaMXHJcbiAgICAgICAgICAgIGFkZFN1YkhhbmRsZXIoaW5zdGFuY2UsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG5ldE1hbmFnZXIubGlzdGVuUmVzcG9uc2UodHlwZSwgaGFuZGxlciwgaW5zdGFuY2UsIGZhbHNlLCAoaW5Nb2R1bGUgPyBpbnN0YW5jZS5vYnNlcnZhYmxlIDogdW5kZWZpbmVkKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbmV0TWFuYWdlci5saXN0ZW5SZXNwb25zZSh0eXBlLCBoYW5kbGVyLCBpbnN0YW5jZSwgZmFsc2UsIChpbk1vZHVsZSA/IGluc3RhbmNlLm9ic2VydmFibGUgOiB1bmRlZmluZWQpKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIC8vIOebkeWQrOmUgOavgVxyXG4gICAgbGlzdGVuRGlzcG9zZShjbHMsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIG5ldE1hbmFnZXIudW5saXN0ZW5SZXNwb25zZSh0eXBlLCBoYW5kbGVyLCBpbnN0YW5jZSwgZmFsc2UsIChpbk1vZHVsZSA/IGluc3RhbmNlLm9ic2VydmFibGUgOiB1bmRlZmluZWQpKTtcclxuICAgIH0pO1xyXG4gICAgZnVuY3Rpb24gaGFuZGxlcihyZXNwb25zZSwgcmVxdWVzdCkge1xyXG4gICAgICAgIGlmIChsaXN0ZW5FcnJvcikge1xyXG4gICAgICAgICAgICAvLyDnm5HlkKznmoTmmK/plJnor69cclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGN1ckluc3RhbmNlW2tleV0uY2FsbCh0aGlzLCByZXNwb25zZSwgcmVxdWVzdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOebkeWQrOeahOaYr+ato+ehrueahOi/lOWbnlxyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UgaW5zdGFuY2VvZiBSZXNwb25zZURhdGEpIHtcclxuICAgICAgICAgICAgICAgIGN1ckluc3RhbmNlW2tleV0uY2FsbCh0aGlzLCByZXNwb25zZSwgcmVxdWVzdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxudmFyIHN1YkhhbmRsZXJEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuZnVuY3Rpb24gYWRkU3ViSGFuZGxlcihpbnN0YW5jZSwgaGFuZGxlcikge1xyXG4gICAgaWYgKCFpbnN0YW5jZSlcclxuICAgICAgICByZXR1cm47XHJcbiAgICB2YXIgaGFuZGxlcnMgPSBzdWJIYW5kbGVyRGljdC5nZXQoaW5zdGFuY2UpO1xyXG4gICAgaWYgKCFoYW5kbGVycylcclxuICAgICAgICBzdWJIYW5kbGVyRGljdC5zZXQoaW5zdGFuY2UsIGhhbmRsZXJzID0gW10pO1xyXG4gICAgaWYgKGhhbmRsZXJzLmluZGV4T2YoaGFuZGxlcikgPCAwKVxyXG4gICAgICAgIGhhbmRsZXJzLnB1c2goaGFuZGxlcik7XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIFN1Yk1lZGlhdG9yKGFyZzEsIGFyZzIsIGFyZzMpIHtcclxuICAgIHZhciBvcmlTa2luO1xyXG4gICAgdmFyIG1lZGlhdG9yQ2xzO1xyXG4gICAgdmFyIGRhdGFFeHA7XHJcbiAgICAvLyDliKTmlq3mmK/lkKbmmK/lj4LmlbDljJboo4XppbBcclxuICAgIGlmICh0aGlzID09PSBkZWNvcmF0ZVRoaXMpIHtcclxuICAgICAgICAvLyDml6Dlj4LmlbBcclxuICAgICAgICBkb1N1Yk1lZGlhdG9yKGFyZzEsIGFyZzIpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g5pyJ5Y+C5pWw77yM5YiG6YWN5Y+C5pWwXHJcbiAgICAgICAgaWYgKCFhcmcyICYmICFhcmczKSB7XHJcbiAgICAgICAgICAgIC8vIOS4gOS4quWPguaVsO+8jOmcgOimgeWIpOaWreivpeWPguaVsOaYr+WQpuaYr01lZGlhdG9y57G75Z6LXHJcbiAgICAgICAgICAgIGlmIChhcmcxIGluc3RhbmNlb2YgRnVuY3Rpb24gJiYgZ2V0TW9kdWxlTmFtZShhcmcxKSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK9NZWRpYXRvcuexu+Wei1xyXG4gICAgICAgICAgICAgICAgbWVkaWF0b3JDbHMgPSBhcmcxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5LiN5pivTWVkaWF0b3LnsbvlnovvvIzorqTkuLrmmK/ooajovr7lvI9cclxuICAgICAgICAgICAgICAgIGRhdGFFeHAgPSBhcmcxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGFyZzEgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICBtZWRpYXRvckNscyA9IGFyZzE7XHJcbiAgICAgICAgICAgIGRhdGFFeHAgPSBhcmcyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb3JpU2tpbiA9IGFyZzE7XHJcbiAgICAgICAgICAgIG1lZGlhdG9yQ2xzID0gYXJnMjtcclxuICAgICAgICAgICAgZGF0YUV4cCA9IGFyZzM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOi/lOWbnuijhemlsOWZqOaWueazlVxyXG4gICAgICAgIHJldHVybiBkb1N1Yk1lZGlhdG9yO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gZG9TdWJNZWRpYXRvcihwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgaWYgKGlzTWVkaWF0b3IocHJvdG90eXBlKSkge1xyXG4gICAgICAgICAgICAvLyDnm5HlkKzlrp7kvovljJZcclxuICAgICAgICAgICAgbGlzdGVuQ29uc3RydWN0KHByb3RvdHlwZS5jb25zdHJ1Y3RvciwgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2tpbiA9IG9yaVNraW47XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVjbGFyZWRDbHMgPSBSZWZsZWN0LmdldE1ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgcHJvdG90eXBlLCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVjbGFyZWRNZWRpYXRvckNscztcclxuICAgICAgICAgICAgICAgIGlmIChpc01lZGlhdG9yKGRlY2xhcmVkQ2xzLnByb3RvdHlwZSkpXHJcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyZWRNZWRpYXRvckNscyA9IGRlY2xhcmVkQ2xzO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1lZGlhdG9yO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBpbnN0YW5jZVtwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgICAgICAvLyDnr6HmlLnlsZ7mgKdcclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpbnN0YW5jZSwgcHJvcGVydHlLZXksIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c57G75Z6L5aOw5piO5Li6TWVkaWF0b3LvvIzliJnov5Tlm55NZWRpYXRvcu+8jOWQpuWImei/lOWbnuearuiCpOacrOi6q1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGRlY2xhcmVkTWVkaWF0b3JDbHMgPyBtZWRpYXRvciA6IHNraW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWPlua2iOaJmOeuoeS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmRlbGVnYXRlTWVkaWF0b3IobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Lit5LuL6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omY566h5paw55qE5Lit5LuL6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzlvZPliY3kuK3ku4vogIXmsqHmnInnmq7ogqTlsLHnlKjoo4XppbDlmajnmq7ogqRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2tpbiAmJiAhbWVkaWF0b3Iuc2tpbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3Iuc2tpbiA9IHNraW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOi1i+WAvOearuiCpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5a2Y5Zyo5Lit5LuL6ICF77yM5YiZ6aKd5aSW6LWL5YC85Lit5LuL6ICF55qu6IKkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3Iuc2tpbiAmJiBtZWRpYXRvci5zdGF0dXMgPCBNZWRpYXRvclN0YXR1cy5PUEVORUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5b2T5YmN5pyJ55qu6IKk5LiU5Lit5LuL6ICF5bCa5pyq5omT5byA5a6M5q+V77yM6K+05piO5piv546w5Zyo5piv55qu6IKk6L2s5Y+R6Zi25q6177yM6KaB55So6ICB55qu6IKk5pu/5o2i5paw55qu6IKk55qE5L2N572uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2VEaXNwbGF5KG1lZGlhdG9yLmJyaWRnZSwgdmFsdWUsIG1lZGlhdG9yLnNraW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlkIzmraXkvY3nva5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3IuYnJpZGdlLnN5bmNTa2luKHZhbHVlLCBtZWRpYXRvci5za2luKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOW9k+WJjeayoeearuiCpO+8jOaIluiAheS4reS7i+iAheW3sue7j+aJk+W8gOWujOavleS6hu+8jOivtOaYjuaWsOearuiCpOWwseaYr+imgeabv+aNouiAgeearuiCpFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5za2luID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWVkaWF0b3Llkoxza2lu6YO96LWL5YC85Li656m6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2luID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5za2luID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOW9k+WJjeS4reS7i+iAheW3sue7j+S4uuato+WcqOaJk+W8gOaIluW3suaJk+W8gOeKtuaAge+8jOWImemineWkluiwg+eUqG9wZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiZjnrqHkuK3ku4vogIVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZWdhdGVNZWRpYXRvcihtZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzlvZPliY3kuK3ku4vogIXlt7Lnu4/kuLrmraPlnKjmiZPlvIDmiJblt7LmiZPlvIDnirbmgIHvvIzliJnpop3lpJbosIPnlKhvcGVuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3Iuc2tpbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvci5zdGF0dXMgPT09IE1lZGlhdG9yU3RhdHVzLlVOT1BFTikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0Q29tbW9uU2NvcGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzOiBfdGhpcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0YTogX3RoaXMudmlld01vZGVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRicmlkZ2U6IF90aGlzLmJyaWRnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3VycmVudFRhcmdldDogbWVkaWF0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldDogbWVkaWF0b3JcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWtkE1lZGlhdG9y6L+Y5rKh5pyJb3Blbu+8jG9wZW7kuYtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSBNZWRpYXRvclN0YXR1cy5PUEVORUQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeItk1lZGlhdG9y5bey57uPb3BlbuS6hu+8jOebtOaOpW9wZW7kuYtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gZGF0YUV4cCA/IGV2YWxFeHAoZGF0YUV4cCwgdGhpcy52aWV3TW9kZWwsIHRoaXMudmlld01vZGVsLCB0aGlzLmRhdGEsIGdldENvbW1vblNjb3BlKCkpIDogdGhpcy5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB0aGlzLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmiafooYxvcGVu5pa55rOVXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci5vcGVuKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuc3RhdHVzIDwgTWVkaWF0b3JTdGF0dXMuT1BFTkVEICYmIGRhdGFFeHApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOeItk1lZGlhdG9y5Lmf5rKh5pyJb3Blbu+8jOebkeWQrOWtkE1lZGlhdG9y55qEb3Blbu+8jOevoeaUueWPguaVsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdGVuQXBwbHkobWVkaWF0b3IsIFwib3BlblwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBldmFsRXhwKGRhdGFFeHAsIF90aGlzLnZpZXdNb2RlbCwgX3RoaXMudmlld01vZGVsLCBfdGhpcy5kYXRhLCBnZXRDb21tb25TY29wZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtkYXRhXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDlrp7kvovljJZcclxuICAgICAgICAgICAgICAgIGlmICh0ZW1wKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VbcHJvcGVydHlLZXldID0gdGVtcDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRlbXAgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS8mOWFiOS9v+eUqOaYr+S4reS7i+iAheexu+eahOWFg+aVsOaNruexu+Wei++8jOWFtuasoeS9v+eUqOijhemlsOWZqOaPkOS+m+eahOS4reS7i+iAheexu+Wei1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjbHMgPSBkZWNsYXJlZE1lZGlhdG9yQ2xzIHx8IG1lZGlhdG9yQ2xzO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY2xzKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLlv4XpobvlnKjnsbvlnovlo7DmmI7miJboo4XppbDlmajkuK3oh7PlsJHkuIDlpITmj5DkvptNZWRpYXRvcueahOexu+Wei1wiKTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZVtwcm9wZXJ0eUtleV0gPSB0ZW1wID0gbmV3IGNscyhza2luKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXJzID0gc3ViSGFuZGxlckRpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICAgICAgICAgIGlmIChoYW5kbGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgaGFuZGxlcnNfMSA9IGhhbmRsZXJzOyBfaSA8IGhhbmRsZXJzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gaGFuZGxlcnNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTorrDlvZVcclxuICAgICAgICAgICAgICAgICAgICBzdWJIYW5kbGVyRGljdC5kZWxldGUobWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8g55uR5ZCs6ZSA5q+BXHJcbiAgICAgICAgICAgIGxpc3RlbkRpc3Bvc2UocHJvdG90eXBlLmNvbnN0cnVjdG9yLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtZWRpYXRvciA9IGluc3RhbmNlW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOenu+mZpOWunuS+i1xyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBpbnN0YW5jZVtwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kVmFsdWUoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgQmluZFV0aWwubGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOe7hOe7h+WPguaVsOWtl+WFuFxyXG4gICAgICAgICAgICB2YXIgdWlEaWN0O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdWlEaWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICB1aURpY3RbYXJnMV0gPSBhcmcyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdWlEaWN0ID0gYXJnMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgQmluZFV0aWwuc2VhcmNoVUlEZXB0aCh1aURpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5re75Yqg57yW6K+R5oyH5LukXHJcbiAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlVmFsdWUsIG5hbWUsIGV4cCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kRXhwKGV4cCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgQmluZFV0aWwubGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOe7hOe7h+WPguaVsOWtl+WFuFxyXG4gICAgICAgICAgICB2YXIgdWlEaWN0ID0ge307XHJcbiAgICAgICAgICAgIGlmIChleHAgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHVpRGljdFtrZXldID0gZXhwW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1aURpY3RbXCJcIl0gPSBleHA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBleHApIHtcclxuICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUV4cCwgZXhwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRGdW5jKGFyZzEsIGFyZzIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIEJpbmRVdGlsLmxpc3Rlbk9uT3Blbihwcm90b3R5cGUsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAvLyDnu4Tnu4flj4LmlbDlrZflhbhcclxuICAgICAgICAgICAgdmFyIGZ1bmNEaWN0O1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgZnVuY0RpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgIGZ1bmNEaWN0W2FyZzFdID0gYXJnMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZ1bmNEaWN0ID0gYXJnMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgQmluZFV0aWwuc2VhcmNoVUlEZXB0aChmdW5jRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgYXJnRXhwcykge1xyXG4gICAgICAgICAgICAgICAgLy8g57uf5LiA5Y+C5pWw57G75Z6L5Li65a2X56ym5Liy5pWw57uEXHJcbiAgICAgICAgICAgICAgICBpZiAoIShhcmdFeHBzIGluc3RhbmNlb2YgQXJyYXkpKVxyXG4gICAgICAgICAgICAgICAgICAgIGFyZ0V4cHMgPSBbYXJnRXhwc107XHJcbiAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZC5hcHBseShCaW5kVXRpbCwgW2N1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUZ1bmMsIG5hbWVdLmNvbmNhdChhcmdFeHBzKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kT24oYXJnMSwgYXJnMiwgYXJnMykge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgQmluZFV0aWwubGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPlue8luivkeWQr+WKqOebruagh1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICAvLyDnu4Tnu4flj4LmlbDlrZflhbhcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhcmczKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5oyH5a6a5LqGVUnlr7nosaHvvIzlhYjljrvlr7vmib5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZURpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lRGljdFthcmcxXSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwuc2VhcmNoVUlEZXB0aChuYW1lRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgdHlwZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlT24sIGFyZzIsIGFyZzMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2dERpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICBldnREaWN0W2FyZzFdID0gYXJnMjtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5zZWFyY2hVSURlcHRoKGV2dERpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIHR5cGUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZU9uLCB0eXBlLCBleHApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgICAgICBCaW5kVXRpbC5zZWFyY2hVSURlcHRoKGFyZzEsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIHR5cGUsIGV4cCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVPbiwgdHlwZSwgZXhwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRJZihhcmcxLCBhcmcyKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHByb3RvdHlwZSwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICBCaW5kVXRpbC5saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09PSBcInN0cmluZ1wiIHx8IGFyZzEgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFhcmcyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rKh5pyJ5oyH5a6a5a+75Z2A6Lev5b6E77yM5bCx5piv6KaB5pON5L2c5b2T5YmN5a+56LGh77yM5L2G5Lmf6KaB57uP6L+H5LiA5qyhc2VhcmNoVUlEZXB0aOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgoeyByOiAxMyB9LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBleHApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5re75Yqg57yW6K+R5oyH5LukXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVJZiwgYXJnMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmjIflrprkuoblr7vlnYDot6/lvoTvvIzpnIDopoHlr7vlnYBcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdWlEaWN0ID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgdWlEaWN0W2FyZzFdID0gYXJnMjtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5zZWFyY2hVSURlcHRoKHVpRGljdCwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlSWYsIGV4cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgoYXJnMSwgbWVkaWF0b3IsIHRhcmdldCwgZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5re75Yqg57yW6K+R5oyH5LukXHJcbiAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUlmLCBleHApO1xyXG4gICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gQmluZEZvcihhcmcxLCBhcmcyLCBhcmczLCBhcmc0KSB7XHJcbiAgICAvLyDnu4Tnu4flj4LmlbBcclxuICAgIHZhciB1aURpY3Q7XHJcbiAgICB2YXIgbmFtZTtcclxuICAgIHZhciBleHA7XHJcbiAgICB2YXIgbWVkaWF0b3JDbHM7XHJcbiAgICB2YXIgZGF0YUV4cDtcclxuICAgIGlmICh0eXBlb2YgYXJnMSA9PT0gXCJzdHJpbmdcIiAmJiAodHlwZW9mIGFyZzIgPT09IFwic3RyaW5nXCIgfHwgYXJnMiBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgIC8vIOaYr+Wvu+WdgOaWueW8j++8jOmcgOimgeiusOW9lW5hbWVcclxuICAgICAgICBuYW1lID0gYXJnMTtcclxuICAgICAgICBleHAgPSBhcmcyO1xyXG4gICAgICAgIG1lZGlhdG9yQ2xzID0gYXJnMztcclxuICAgICAgICBkYXRhRXhwID0gYXJnNDtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcxID09PSBcInN0cmluZ1wiIHx8IGFyZzEgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIC8vIOaYr+aXoOWvu+WdgOaWueW8j++8jOebtOaOpeS7jmV4cOW8gOWni+iusOW9lVxyXG4gICAgICAgIGV4cCA9IGFyZzE7XHJcbiAgICAgICAgbWVkaWF0b3JDbHMgPSBhcmcyO1xyXG4gICAgICAgIGRhdGFFeHAgPSBhcmczO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g5piv5a+75Z2A6ZuG5ZCI5pa55byPXHJcbiAgICAgICAgdWlEaWN0ID0gYXJnMTtcclxuICAgIH1cclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIHZhciBkZWNsYXJlZENscyA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBwcm90b3R5cGUsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICBCaW5kVXRpbC5saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgLy8g5Y+W5Yiw57yW6K+R55uu5qCH5a+56LGhXHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+i1i+WAvOaMh+S7pFxyXG4gICAgICAgICAgICBpZiAoIXVpRGljdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rKh5pyJ5oyH5a6a5a+75Z2A6Lev5b6E77yM5bCx5piv6KaB5pON5L2c5b2T5YmN5a+56LGh77yM5L2G5Lmf6KaB57uP6L+H5LiA5qyhc2VhcmNoVUlEZXB0aOaTjeS9nFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgoeyByOiAxMyB9LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBfbmFtZSwgX2V4cCwgbGVmdEhhbmRsZXJzLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgICAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwucHVzaENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgQmluZFV0aWwuY29tcGlsZUZvciwgcHJvcGVydHlLZXksIGV4cCwgbWVkaWF0b3JDbHMsIGRlY2xhcmVkQ2xzLCBkYXRhRXhwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Lit5pat57yW6K+RXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fID0gbGVmdEhhbmRsZXJzID8gbGVmdEhhbmRsZXJzLnNwbGljZShpbmRleCArIDEsIGxlZnRIYW5kbGVycy5sZW5ndGggLSBpbmRleCAtIDEpIDogW107XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmjIflrprkuoblr7vlnYDot6/lvoTvvIzpnIDopoHlr7vlnYBcclxuICAgICAgICAgICAgICAgICAgICB1aURpY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICB1aURpY3RbbmFtZV0gPSBleHA7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgICAgICAgICAgICAgQmluZFV0aWwuc2VhcmNoVUlEZXB0aCh1aURpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIF9uYW1lLCBfZXhwLCBsZWZ0SGFuZGxlcnMsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlRm9yLCBwcm9wZXJ0eUtleSwgX2V4cCwgbWVkaWF0b3JDbHMsIGRlY2xhcmVkQ2xzLCBkYXRhRXhwKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Lit5pat57yW6K+RXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fID0gbGVmdEhhbmRsZXJzID8gbGVmdEhhbmRsZXJzLnNwbGljZShpbmRleCArIDEsIGxlZnRIYW5kbGVycy5sZW5ndGggLSBpbmRleCAtIDEpIDogW107XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDpgY3ljobnu5HlrprnmoTnm67moIfvvIzlsIbnvJbor5HmjIfku6Tnu5HlrprliLDnm67moIfouqvkuIrvvIzogIzkuI3mmK/mjIfku6TmiYDlnKjnmoTmmL7npLrlr7nosaHouqvkuIpcclxuICAgICAgICAgICAgICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBfbmFtZSwgX2V4cCwgbGVmdEhhbmRsZXJzLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOe8luivkeaMh+S7pFxyXG4gICAgICAgICAgICAgICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVGb3IsIHByb3BlcnR5S2V5LCBfZXhwLCBtZWRpYXRvckNscywgZGVjbGFyZWRDbHMsIGRhdGFFeHApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruS4reaWree8luivkVxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fID0gbGVmdEhhbmRsZXJzID8gbGVmdEhhbmRsZXJzLnNwbGljZShpbmRleCArIDEsIGxlZnRIYW5kbGVycy5sZW5ndGggLSBpbmRleCAtIDEpIDogW107XHJcbiAgICAgICAgICAgICAgICB9LCB0cnVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkb0JpbmRNZXNzYWdlKG1lZGlhdG9yLCB0YXJnZXQsIHR5cGUsIHVpRGljdCwgb2JzZXJ2YWJsZSkge1xyXG4gICAgQmluZFV0aWwuc2VhcmNoVUlEZXB0aCh1aURpY3QsIG1lZGlhdG9yLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIG5hbWUsIGV4cCkge1xyXG4gICAgICAgIEJpbmRVdGlsLnB1c2hDb21waWxlQ29tbWFuZChjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIEJpbmRVdGlsLmNvbXBpbGVNZXNzYWdlLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpO1xyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gQmluZE1lc3NhZ2UoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgQmluZFV0aWwubGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PSBcInN0cmluZ1wiIHx8IGFyZzEgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv57G75Z6L5pa55byPXHJcbiAgICAgICAgICAgICAgICBkb0JpbmRNZXNzYWdlKG1lZGlhdG9yLCB0YXJnZXQsIGFyZzEsIGFyZzIsIG1lZGlhdG9yLm9ic2VydmFibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv5a2X5YW45pa55byPXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIGFyZzEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb0JpbmRNZXNzYWdlKG1lZGlhdG9yLCB0YXJnZXQsIHR5cGUsIGFyZzFbdHlwZV0sIG1lZGlhdG9yLm9ic2VydmFibGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBAcHJpdmF0ZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIEJpbmRHbG9iYWxNZXNzYWdlKGFyZzEsIGFyZzIpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAocHJvdG90eXBlLCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgIEJpbmRVdGlsLmxpc3Rlbk9uT3Blbihwcm90b3R5cGUsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gbWVkaWF0b3JbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFyZzEgPT0gXCJzdHJpbmdcIiB8fCBhcmcxIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+exu+Wei+aWueW8j1xyXG4gICAgICAgICAgICAgICAgZG9CaW5kTWVzc2FnZShtZWRpYXRvciwgdGFyZ2V0LCBhcmcxLCBhcmcyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+Wtl+WFuOaWueW8j1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBhcmcxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9CaW5kTWVzc2FnZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCBhcmcxW3R5cGVdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCB1aURpY3QsIG9ic2VydmFibGUpIHtcclxuICAgIEJpbmRVdGlsLnNlYXJjaFVJRGVwdGgodWlEaWN0LCBtZWRpYXRvciwgdGFyZ2V0LCBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBuYW1lLCBleHApIHtcclxuICAgICAgICBCaW5kVXRpbC5wdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBCaW5kVXRpbC5jb21waWxlUmVzcG9uc2UsIHR5cGUsIG5hbWUsIGV4cCwgb2JzZXJ2YWJsZSk7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kUmVzcG9uc2UoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgLy8gUmVzcG9uc2XpnIDopoHlnKhvbk9wZW7kuYvlkI7miafooYzvvIzlm6DkuLrlj6/og73mnInliJ3lp4vljJbmtojmga/pnIDopoHnu5HlrprvvIzopoHlnKhvbk9wZW7lkI7mnInkuoZ2aWV3TW9kZWzlho3pppbmrKHmm7TmlrDmmL7npLpcclxuICAgICAgICBCaW5kVXRpbC5saXN0ZW5Pbk9wZW4ocHJvdG90eXBlLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IG1lZGlhdG9yW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcmcxID09IFwic3RyaW5nXCIgfHwgYXJnMSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK/nsbvlnovmlrnlvI9cclxuICAgICAgICAgICAgICAgIGRvQmluZFJlc3BvbnNlKG1lZGlhdG9yLCB0YXJnZXQsIGFyZzEsIGFyZzIsIG1lZGlhdG9yLm9ic2VydmFibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv5a2X5YW45pa55byPXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIGFyZzEpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCB0eXBlLCBhcmcxW3R5cGVdLCBtZWRpYXRvci5vYnNlcnZhYmxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufVxyXG4vKipcclxuICogQHByaXZhdGVcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBCaW5kR2xvYmFsUmVzcG9uc2UoYXJnMSwgYXJnMikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChwcm90b3R5cGUsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgQmluZFV0aWwubGlzdGVuT25PcGVuKHByb3RvdHlwZSwgZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSBtZWRpYXRvcltwcm9wZXJ0eUtleV07XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PSBcInN0cmluZ1wiIHx8IGFyZzEgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xyXG4gICAgICAgICAgICAgICAgLy8g5piv57G75Z6L5pa55byPXHJcbiAgICAgICAgICAgICAgICBkb0JpbmRSZXNwb25zZShtZWRpYXRvciwgdGFyZ2V0LCBhcmcxLCBhcmcyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYr+Wtl+WFuOaWueW8j1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBhcmcxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9CaW5kUmVzcG9uc2UobWVkaWF0b3IsIHRhcmdldCwgdHlwZSwgYXJnMVt0eXBlXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yLmpzXG4vLyBtb2R1bGUgaWQgPSA5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBnZXRDb25zdHJ1Y3RvciB9IGZyb20gXCIuLi8uLi91dGlscy9Db25zdHJ1Y3RVdGlsXCI7XHJcbmltcG9ydCB7IE1vZHVsZU9wZW5TdGF0dXMgfSBmcm9tIFwiLi4vbWVkaWF0b3IvSU1lZGlhdG9yTW9kdWxlUGFydFwiO1xyXG5pbXBvcnQgeyBnZXRNb2R1bGUgfSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JcIjtcclxuaW1wb3J0IE1vZHVsZU1lc3NhZ2UgZnJvbSBcIi4vTW9kdWxlTWVzc2FnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTRcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTVcclxuICpcclxuICog5qih5Z2X566h55CG5Zmo77yM566h55CG5qih5Z2X55u45YWz55qE5omA5pyJ5pON5L2c44CC5qih5Z2X5YW35pyJ5ZSv5LiA5oCn77yM5ZCM5LiA5pe26Ze05LiN5Y+v5Lul5omT5byA5Lik5Liq55u45ZCM5qih5Z2X77yM5aaC5p6c5omT5byA5YiZ5Lya6YCA5Zue5Yiw5YWI5YmN55qE5qih5Z2X5aSEXHJcbiovXHJcbnZhciBNb2R1bGVNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTW9kdWxlTWFuYWdlcigpIHtcclxuICAgICAgICB0aGlzLl9tb2R1bGVTdGFjayA9IFtdO1xyXG4gICAgICAgIHRoaXMuX29wZW5DYWNoZSA9IFtdO1xyXG4gICAgICAgIHRoaXMuX29wZW5pbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2J1c3kgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZSwgXCJjdXJyZW50TW9kdWxlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvZPliY3mqKHlnZdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcnx1bmRlZmluZWR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGN1ckRhdGEgPSB0aGlzLmdldEN1cnJlbnQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIChjdXJEYXRhICYmIGN1ckRhdGFbMF0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLCBcImN1cnJlbnRNb2R1bGVJbnN0YW5jZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5b2T5YmN5qih5Z2X55qE5a6e5L6LXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7KElNZWRpYXRvcnx1bmRlZmluZWQpfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJEYXRhID0gdGhpcy5nZXRDdXJyZW50KCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoY3VyRGF0YSAmJiBjdXJEYXRhWzFdKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZSwgXCJhY3RpdmVDb3VudFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5rS75Yqo5qih5Z2X5pWw6YePXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7bnVtYmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2R1bGVTdGFjay5sZW5ndGg7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaooeWdl+WcqOagiOS4reeahOe0ouW8lVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yQ29uc3RydWN0b3J9IGNscyDmqKHlnZfnsbvlnotcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IOe0ouW8leWAvFxyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZ2V0SW5kZXggPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRoaXMuX21vZHVsZVN0YWNrLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb2R1bGVTdGFja1tpXVswXSA9PSBjbHMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W57Si5byV5aSE5qih5Z2X57G75Z6LXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOaooeWdl+e0ouW8leWAvFxyXG4gICAgICogQHJldHVybnMge0lNZWRpYXRvckNvbnN0cnVjdG9yfSDmqKHlnZfnsbvlnotcclxuICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLmdldE1vZHVsZSA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fbW9kdWxlU3RhY2tbaW5kZXhdO1xyXG4gICAgICAgIHJldHVybiBkYXRhICYmIGRhdGFbMF07XHJcbiAgICB9O1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZ2V0QWZ0ZXIgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLl9tb2R1bGVTdGFjazsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKG1vZHVsZVswXSA9PSBjbHMpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChtb2R1bGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcbiAgICBNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZS5nZXRDdXJyZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOaMiemhuuW6j+mBjeWOhuaooeWdl++8jOWPluWHuuacgOaWsOeahOayoeacieWcqOW8gOWQr+S4reeahOaooeWdl1xyXG4gICAgICAgIHZhciB0YXJnZXQ7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMuX21vZHVsZVN0YWNrOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IF9hW19pXTtcclxuICAgICAgICAgICAgaWYgKHRlbXBbMF0gIT09IHRoaXMuX29wZW5pbmcpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldCA9IHRlbXA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5qih5Z2X5piv5ZCm5byA5ZCv5LitXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3JDb25zdHJ1Y3Rvcn0gY2xzIOimgeWIpOaWreeahOaooeWdl+exu+Wei1xyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IOaYr+WQpuW8gOWQr1xyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuaXNPcGVuZWQgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9tb2R1bGVTdGFjay5maWx0ZXIoZnVuY3Rpb24gKHRlbXApIHsgcmV0dXJuIHRlbXBbMF0gPT0gY2xzOyB9KS5sZW5ndGggPiAwKTtcclxuICAgIH07XHJcbiAgICBNb2R1bGVNYW5hZ2VyLnByb3RvdHlwZS5hY3RpdmF0ZU1vZHVsZSA9IGZ1bmN0aW9uIChtb2R1bGUsIGZyb20sIGRhdGEpIHtcclxuICAgICAgICBpZiAobW9kdWxlKSB7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqGFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgIG1vZHVsZS5hY3RpdmF0ZShmcm9tLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuZGVhY3RpdmF0ZU1vZHVsZSA9IGZ1bmN0aW9uIChtb2R1bGUsIHRvLCBkYXRhKSB7XHJcbiAgICAgICAgaWYgKG1vZHVsZSkge1xyXG4gICAgICAgICAgICAvLyDosIPnlKhkZWFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgIG1vZHVsZS5kZWFjdGl2YXRlKHRvLCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDmqKHlnZdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge01vZHVsZVR5cGV8c3RyaW5nfSBjbHNPck5hbWUg5qih5Z2X57G75Z6L5oiW5ZCN56ewXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDlj4LmlbBcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3JlcGxhY2U9ZmFsc2VdIOaYr+WQpuabv+aNouW9k+WJjeaooeWdl1xyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIChtb2R1bGUsIGRhdGEsIHJlcGxhY2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmIChyZXBsYWNlID09PSB2b2lkIDApIHsgcmVwbGFjZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHR5cGUsIGNscywgYWZ0ZXIsIHRhcmdldCwgZnJvbSwgZnJvbU1vZHVsZSwgbW9kdWxlRGF0YSwgb3BlbkRhdGEsIGksIGxlbiwgY2xvc2VEYXRhO1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAodHlwZW9mIG1vZHVsZSA9PSBcInN0cmluZ1wiID8gZ2V0TW9kdWxlKG1vZHVsZSkgOiBtb2R1bGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDpnZ7nqbrliKTmlq1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0eXBlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3mmK/lkKbmraPlnKjmiZPlvIDmqKHlnZdcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2J1c3kpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29wZW5DYWNoZS5wdXNoKFt0eXBlLCBkYXRhLCByZXBsYWNlLCByZXNvbHZlXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnVzeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNscyA9IGdldENvbnN0cnVjdG9yKHR5cGUgaW5zdGFuY2VvZiBGdW5jdGlvbiA/IHR5cGUgOiB0eXBlLmNvbnN0cnVjdG9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWZ0ZXIgPSB0aGlzLmdldEFmdGVyKGNscyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghIWFmdGVyKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V5q2j5Zyo5omT5byA55qE5qih5Z2X57G75Z6LXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29wZW5pbmcgPSB0eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSB0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb24gPyBuZXcgY2xzKCkgOiB0eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDotYvlgLzmiZPlvIDlj4LmlbBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmcm9tID0gdGhpcy5nZXRDdXJyZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb21Nb2R1bGUgPSBmcm9tICYmIGZyb21bMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZURhdGEgPSBbY2xzLCB0YXJnZXQsIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVTdGFjay51bnNoaWZ0KG1vZHVsZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7lm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Lm1vZHVsZU9wZW5IYW5kbGVyID0gZnVuY3Rpb24gKHN0YXR1cywgZXJyKSB7IHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfYSwgdGVtcERhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kdWxlT3BlblN0YXR1cy5TdG9wOiByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZHVsZU9wZW5TdGF0dXMuQmVmb3JlT3BlbjogcmV0dXJuIFszIC8qYnJlYWsqLywgM107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2R1bGVPcGVuU3RhdHVzLkFmdGVyT3BlbjogcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6ZyA6KaB5Yik5pat5piv5ZCm5piv5pyA5ZCO5LiA5Liq5qih5Z2X77yM5pyA5ZCO5LiA5Liq5qih5Z2X5LiN5YWB6K646KKr6ZSA5q+BXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fbW9kdWxlU3RhY2subGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBEYXRhID0gdGhpcy5fbW9kdWxlU3RhY2suc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDplIDmr4HmqKHlnZdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wRGF0YVsxXS5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5HlpLHotKXmtojmga9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFX0ZBSUxFRCwgY2xzLCBmcm9tICYmIGZyb21bMF0sIGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMub25GaW5pc2hPcGVuKCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDov5nph4zopoHkvJjlhYjlhbPpl63moIfor4bnrKbvvIzlkKbliJnlnKjlvIDlkK/nmoTmqKHlnZfnmoRvbk9wZW7mlrnms5Xph4zlpoLmnpzmnInmk43kvZxNYXNr55qE5Yqo5L2c5bCx5Lya6KKr6L+Z5Liq5qCH6K+G6Zi75aGe5L2PXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcGVuaW5nID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOevoeaUuXRhcmdldOeahGNsb3Nl5pa55rOV77yM5L2/5YW25pS55Li66Kem5Y+RTW9kdWxlTWFuYWdlcueahGNsb3NlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVEYXRhWzJdID0gdGFyZ2V0Lmhhc093blByb3BlcnR5KFwiY2xvc2VcIikgPyB0YXJnZXQuY2xvc2UgOiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmNsb3NlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBtb2R1bGVNYW5hZ2VyLmNsb3NlKHRhcmdldCwgZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogcmV0dXJuIFsyIC8qcmV0dXJuKi8sIF9hLnNlbnQoKV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkRlYWN0aXZhdGXmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGVhY3RpdmF0ZU1vZHVsZShmcm9tTW9kdWxlLCB0YXJnZXQsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55Sob25BY3RpdmF0ZeaOpeWPo1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZU1vZHVsZSh0YXJnZXQsIGZyb21Nb2R1bGUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6ccmVwbGFjZeaYr3RydWXvvIzliJnlhbPmjonkuIrkuIDkuKrmqKHlnZdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoZnJvbSAmJiBmcm9tWzBdLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChNb2R1bGVNZXNzYWdlLk1PRFVMRV9DSEFOR0UsIGNscywgZnJvbU1vZHVsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMub25GaW5pc2hPcGVuKCldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDnu5PmnZ/kuIDmrKHmqKHlnZflvIDlkK9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRhcmdldC5vcGVuKGRhdGEpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5EYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhyZXNvbHZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob3BlbkRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGFmdGVyLmxlbmd0aCA+IDApKSByZXR1cm4gWzMgLypicmVhayovLCA1XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5omT5byA5LiU5LiN5piv5b2T5YmN5qih5Z2X77yM5YWI5YWz6Zet5b2T5YmN5qih5Z2X5Yiw55uu5qCH5qih5Z2X5LmL6Ze055qE5omA5pyJ5qih5Z2XXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDEsIGxlbiA9IGFmdGVyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKGFmdGVyW2ldWzBdLCBkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmNsb3NlKGFmdGVyWzBdWzBdLCBkYXRhKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZURhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOe7k+adn+S4gOasoeaooeWdl+W8gOWQr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLm9uRmluaXNoT3BlbigpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOe7k+adn+S4gOasoeaooeWdl+W8gOWQr1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqHJlc29sdmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjbG9zZURhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6IFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIOe7k+adn+S4gOasoeaooeWdl+W8gOWQr1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMub25GaW5pc2hPcGVuKCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g57uT5p2f5LiA5qyh5qih5Z2X5byA5ZCvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55SocmVzb2x2ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIE1vZHVsZU1hbmFnZXIucHJvdG90eXBlLm9uRmluaXNoT3BlbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG9wZW5DYWNoZSwgb3BlbkRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5YWz6Zet5qCH6K+G56ymXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29wZW5pbmcgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9idXN5ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHRoaXMuX29wZW5DYWNoZS5sZW5ndGggPiAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5DYWNoZSA9IHRoaXMuX29wZW5DYWNoZS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLm9wZW4uYXBwbHkodGhpcywgb3BlbkNhY2hlLnNsaWNlKDAsIDMpKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGVuRGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3BlbkNhY2hlWzNdKG9wZW5EYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreaooeWdl++8jOWPquacieWFs+mXreeahOaYr+W9k+WJjeaooeWdl+aXtuaJjeS8muinpuWPkW9uRGVhY3RpdmF0ZeWSjG9uQWN0aXZhdGXvvIzlkKbliJnlj6rkvJrop6blj5FjbG9zZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7TW9kdWxlVHlwZXxzdHJpbmd9IGNsc09yTmFtZSDmqKHlnZfnsbvlnovmiJblkI3np7BcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIE1vZHVsZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTW9kdWxlTWFuYWdlci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAobW9kdWxlLCBkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgdHlwZSwgY2xzLCBpbmRleCwgbW9kdWxlRGF0YSwgdGFyZ2V0LCBvcmlDbG9zZSwgY2xvc2VEYXRhLCB0bywgdG9Nb2R1bGU7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICh0eXBlb2YgbW9kdWxlID09IFwic3RyaW5nXCIgPyBnZXRNb2R1bGUobW9kdWxlKSA6IG1vZHVsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXR5cGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaVsOmHj+WIpOaWre+8jOS4jei2s+S4gOS4quaooeWdl+aXtuS4jeWFs+mXrVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVDb3VudCA8PSAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHMgPSBnZXRDb25zdHJ1Y3Rvcih0eXBlIGluc3RhbmNlb2YgRnVuY3Rpb24gPyB0eXBlIDogdHlwZS5jb25zdHJ1Y3Rvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gdGhpcy5nZXRJbmRleChjbHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVEYXRhID0gdGhpcy5fbW9kdWxlU3RhY2tbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBtb2R1bGVEYXRhWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmlDbG9zZSA9IG1vZHVsZURhdGFbMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcmlDbG9zZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbG9zZSA9IG9yaUNsb3NlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0LmNsb3NlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpbmRleCA9PSAwKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgMl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVTdGFjay5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0byA9IHRoaXMuX21vZHVsZVN0YWNrWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b01vZHVsZSA9IHRvICYmIHRvWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkRlYWN0aXZhdGXmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWFjdGl2YXRlTW9kdWxlKHRhcmdldCwgdG9Nb2R1bGUsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0YXJnZXQuY2xvc2UoZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55SoY2xvc2XmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VEYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKhvbkFjdGl2YXRl5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVNb2R1bGUodG9Nb2R1bGUsIHRhcmdldCwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqG9uV2FrZVVw5o6l5Y+jXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvTW9kdWxlLndha2VVcCh0YXJnZXQsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChNb2R1bGVNZXNzYWdlLk1PRFVMRV9DSEFOR0UsIHRvICYmIHRvWzBdLCBjbHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tb2R1bGVTdGFjay5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0YXJnZXQuY2xvc2UoZGF0YSldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55SoY2xvc2XmjqXlj6NcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VEYXRhID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNsb3NlRGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7IH0pO1xyXG4gICAgfTtcclxuICAgIE1vZHVsZU1hbmFnZXIgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIE1vZHVsZU1hbmFnZXIpO1xyXG4gICAgcmV0dXJuIE1vZHVsZU1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1vZHVsZU1hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBtb2R1bGVNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoTW9kdWxlTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tb2R1bGUvTW9kdWxlTWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCB7IEpTTG9hZE1vZGUgfSBmcm9tICcuLi8uLi9jb3JlL2ludGVyZmFjZXMvSlNGaWxlJztcclxuaW1wb3J0IHsgdW5pcXVlIH0gZnJvbSBcIi4uLy4uL3V0aWxzL0FycmF5VXRpbFwiO1xyXG5pbXBvcnQgeyBsb2FkIH0gZnJvbSBcIi4uLy4uL3V0aWxzL0hUVFBVdGlsXCI7XHJcbmltcG9ydCB7IGlzQWJzb2x1dGVQYXRoIH0gZnJvbSBcIi4uLy4uL3V0aWxzL1VSTFV0aWxcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vZW52L0Vudmlyb25tZW50XCI7XHJcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tIFwiLi4vdmVyc2lvbi9WZXJzaW9uXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0yNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0yNlxyXG4gKlxyXG4gKiDotYTmupDnrqHnkIblmahcclxuKi9cclxudmFyIEFzc2V0c01hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBc3NldHNNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX2tleURpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9hc3NldHNEaWN0ID0ge307XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIEFzc2V0c01hbmFnZXIucHJvdG90eXBlLmNvbmZpZ1BhdGggPSBmdW5jdGlvbiAoYXJnMSwgYXJnMikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgYXJnMSA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2tleURpY3RbYXJnMV0gPSBhcmcyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGFyZzEpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2tleURpY3Rba2V5XSA9IGFyZzFba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlui1hOa6kO+8jOWQjOatpeeahO+8jOS4lOWmguaenOaJvuS4jeWIsOi1hOa6kOW5tuS4jeS8muinpuWPkeWKoOi9vVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXlPclBhdGgg6LWE5rqQ55qE55+t5ZCN56ew5oiW6Lev5b6EXHJcbiAgICAgKiBAcmV0dXJucyB7Kn1cclxuICAgICAqIEBtZW1iZXJvZiBBc3NldHNNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEFzc2V0c01hbmFnZXIucHJvdG90eXBlLmdldEFzc2V0cyA9IGZ1bmN0aW9uIChrZXlPclBhdGgpIHtcclxuICAgICAgICB2YXIgcGF0aCA9IHRoaXMuX2tleURpY3Rba2V5T3JQYXRoXSB8fCBrZXlPclBhdGg7XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2Fzc2V0c0RpY3RbcGF0aF07XHJcbiAgICAgICAgLy8g5aaC5p6c5piv5Liq5pWw57uE5YiZ6KGo56S65q2j5Zyo5Yqg6L295Lit77yM6L+U5ZuedW5kZWZpbmVkXHJcbiAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIEFycmF5KVxyXG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vei1hOa6kO+8jOWmguaenOW3suWKoOi9vei/h+WImeWQjOatpeWbnuiwg++8jOWmguaenOacquWKoOi9veWImeWKoOi9veWQjuW8guatpeWbnuiwg1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfSBrZXlPclBhdGgg6LWE5rqQ55+t5ZCN56ew5oiW6LWE5rqQ6Lev5b6EXHJcbiAgICAgKiBAcGFyYW0geyhhc3NldHM/OmFueXxhbnlbXSk9PnZvaWR9IGNvbXBsZXRlIOWujOaIkOWbnuiwg++8jOWmguaenOWKoOi9veWksei0peWImeWPguaVsOaYr+S4qkVycm9y5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge1hNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlfSBbcmVzcG9uc2VUeXBlXSDliqDovb3nsbvlnotcclxuICAgICAqIEBwYXJhbSB7KGtleU9yUGF0aD86c3RyaW5nLCBhc3NldHM/OmFueSk9PnZvaWR9IFtvbmVDb21wbGV0ZV0g5LiA5Liq6LWE5rqQ5Yqg6L295a6M5q+V5Lya6LCD55So6L+Z5Liq5Zue6LCD77yM5aaC5p6c5pyJ55qE6K+d44CC5LuF5Zyoa2V5T3JQYXRo5piv5pWw57uE5oOF5Ya15LiL55Sf5pWIXHJcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cclxuICAgICAqIEBtZW1iZXJvZiBBc3NldHNNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEFzc2V0c01hbmFnZXIucHJvdG90eXBlLmxvYWRBc3NldHMgPSBmdW5jdGlvbiAoa2V5T3JQYXRoLCBjb21wbGV0ZSwgcmVzcG9uc2VUeXBlLCBvbmVDb21wbGV0ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8g6Z2e56m65Yik5patXHJcbiAgICAgICAgaWYgKCFrZXlPclBhdGgpIHtcclxuICAgICAgICAgICAgY29tcGxldGUgJiYgY29tcGxldGUodmFsdWUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiOt+WPlui3r+W+hFxyXG4gICAgICAgIGlmIChrZXlPclBhdGggaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAvLyDmlbDnu4Tljrvph41cclxuICAgICAgICAgICAga2V5T3JQYXRoID0gdW5pcXVlKGtleU9yUGF0aCk7XHJcbiAgICAgICAgICAgIC8vIOaYr+S4quaVsOe7hO+8jOi9rOaNouaIkOWNleS4gOWQjeensOaIluWvueixoVxyXG4gICAgICAgICAgICB2YXIgY291bnQgPSBrZXlPclBhdGgubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgICAgICAvLyDliKTmlq3mlbDph49cclxuICAgICAgICAgICAgaWYgKGNvdW50ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5aOw5piO5Zue6LCDXHJcbiAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIChwYXRoLCBhc3NldHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICBvbmVDb21wbGV0ZSAmJiBvbmVDb21wbGV0ZShwYXRoLCBhc3NldHMpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWhq+WFheaVsOe7hFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGtleU9yUGF0aC5pbmRleE9mKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdHNbaW5kZXhdID0gYXNzZXRzO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWIpOaWreWujOaIkFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICgtLWNvdW50ID09PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZSAmJiBjb21wbGV0ZShyZXN1bHRzKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDlubbooYzliqDovb3otYTmupBcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb3VudDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBrZXlPclBhdGhbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkQXNzZXRzKHBhdGgsIG51bGwsIG51bGwsIGhhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g55u05o6l5a6M5oiQXHJcbiAgICAgICAgICAgICAgICBjb21wbGV0ZSAmJiBjb21wbGV0ZShyZXN1bHRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5piv5Y2V5LiA5ZCN56ew5oiW5a+56LGhXHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5fa2V5RGljdFtrZXlPclBhdGhdIHx8IGtleU9yUGF0aDtcclxuICAgICAgICAgICAgLy8g6I635Y+W5YC8XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX2Fzc2V0c0RpY3RbcGF0aF07XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmraPlnKjliqDovb3kuK3vvIznrYnlvoXkuYtcclxuICAgICAgICAgICAgICAgIHZhbHVlLnB1c2goY29tcGxldGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlt7Lnu4/liqDovb3ov4fkuobvvIznm7TmjqXov5Tlm55cclxuICAgICAgICAgICAgICAgIG9uZUNvbXBsZXRlICYmIG9uZUNvbXBsZXRlKGtleU9yUGF0aCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgY29tcGxldGUgJiYgY29tcGxldGUodmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5rKh5pyJ5bCx5Y675Yqg6L29XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hc3NldHNEaWN0W3BhdGhdID0gdmFsdWUgPSBbZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbmVDb21wbGV0ZSAmJiBvbmVDb21wbGV0ZShrZXlPclBhdGgsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlICYmIGNvbXBsZXRlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfV07XHJcbiAgICAgICAgICAgICAgICBsb2FkKHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IHZlcnNpb24ud3JhcEhhc2hVcmwocGF0aCksXHJcbiAgICAgICAgICAgICAgICAgICAgdXNlQ0ROOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogcmVzcG9uc2VUeXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIG9uUmVzcG9uc2U6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V57uT5p6cXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9hc3NldHNEaWN0W3BhdGhdID0gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDpgJrnn6XlkITkuKrlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB2YWx1ZV8xID0gdmFsdWU7IF9pIDwgdmFsdWVfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyID0gdmFsdWVfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIG9uRXJyb3I6IGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk57uT5p6cXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fYXNzZXRzRGljdFtwYXRoXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6YCa55+l5ZCE5Liq5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVfMiA9IHZhbHVlOyBfaSA8IHZhbHVlXzIubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFuZGxlciA9IHZhbHVlXzJbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb1DU1PmoLflvI/mlofku7ZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBjc3NGaWxlcyDmoLflvI/mlofku7ZVUkzliJfooahcclxuICAgICAqIEBwYXJhbSB7KGVycj86RXJyb3IpPT52b2lkfSBoYW5kbGVyIOWujOaIkOWbnuiwg1xyXG4gICAgICogQG1lbWJlcm9mIEFzc2V0c01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXNzZXRzTWFuYWdlci5wcm90b3R5cGUubG9hZFN0eWxlRmlsZXMgPSBmdW5jdGlvbiAoY3NzRmlsZXMsIGhhbmRsZXIpIHtcclxuICAgICAgICBpZiAoIWNzc0ZpbGVzIHx8IGNzc0ZpbGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvdW50ID0gY3NzRmlsZXMubGVuZ3RoO1xyXG4gICAgICAgIHZhciBzdG9wID0gZmFsc2U7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBjc3NGaWxlc18xID0gY3NzRmlsZXM7IF9pIDwgY3NzRmlsZXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGNzc0ZpbGUgPSBjc3NGaWxlc18xW19pXTtcclxuICAgICAgICAgICAgdmFyIGNzc05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlua1wiKTtcclxuICAgICAgICAgICAgY3NzTm9kZS5yZWwgPSBcInN0eWxlc2hlZXRcIjtcclxuICAgICAgICAgICAgY3NzTm9kZS50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xyXG4gICAgICAgICAgICBjc3NOb2RlLmhyZWYgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodmVyc2lvbi53cmFwSGFzaFVybChjc3NGaWxlKSk7XHJcbiAgICAgICAgICAgIGNzc05vZGUub25sb2FkID0gb25Mb2FkT25lO1xyXG4gICAgICAgICAgICBjc3NOb2RlLm9uZXJyb3IgPSBvbkVycm9yT25lO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNzc05vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkxvYWRPbmUoKSB7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOWFqOmDqOWKoOi9veWujOavleWImeiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBpZiAoIXN0b3AgJiYgLS1jb3VudCA9PT0gMClcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25FcnJvck9uZShldnQpIHtcclxuICAgICAgICAgICAgaWYgKCFzdG9wKSB7XHJcbiAgICAgICAgICAgICAgICBzdG9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIobmV3IEVycm9yKFwiQ1NT5Yqg6L295aSx6LSlXCIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vUpT5paH5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtKU0ZpbGVbXX0ganNGaWxlcyBqc+aWh+S7tuWIl+ihqFxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5a6M5oiQ5Zue6LCDXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcmRlcmVkPWZhbHNlXSDmmK/lkKbkv53or4HmoIfnrb7lvaLlvI9qc+eahOaJp+ihjOmhuuW6j++8jOS/neivgeaJp+ihjOmhuuW6j+S8mumZjeS9juagh+etvuW9ouW8j2pz55qE5Yqg6L296YCf5bqm77yM5Zug5Li65b+F6aG75Liy6KGM5Yqg6L2944CC6K+l5Y+C5pWw5LiN5Lya5b2x5ZONSlNPTlDlvaLlvI/nmoTliqDovb3pgJ/luqblkozmiafooYzpobrluo/vvIxKU09OUOW9ouW8j+iEmuacrOaAu+aYr+W5tuihjOWKoOi9veS4lOmhuuW6j+aJp+ihjOeahOOAgum7mOiupOaYr3RydWVcclxuICAgICAqIEBtZW1iZXJvZiBBc3NldHNNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEFzc2V0c01hbmFnZXIucHJvdG90eXBlLmxvYWRKc0ZpbGVzID0gZnVuY3Rpb24gKGpzRmlsZXMsIGhhbmRsZXIsIG9yZGVyZWQpIHtcclxuICAgICAgICBpZiAob3JkZXJlZCA9PT0gdm9pZCAwKSB7IG9yZGVyZWQgPSB0cnVlOyB9XHJcbiAgICAgICAgaWYgKCFqc0ZpbGVzIHx8IGpzRmlsZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqc0ZpbGVzID0ganNGaWxlcy5jb25jYXQoKTtcclxuICAgICAgICB2YXIgY291bnQgPSBqc0ZpbGVzLmxlbmd0aDtcclxuICAgICAgICB2YXIganNvbnBDb3VudCA9IDA7XHJcbiAgICAgICAgdmFyIHN0b3AgPSBmYWxzZTtcclxuICAgICAgICB2YXIgbm9kZXMgPSBbXTtcclxuICAgICAgICAvLyDpgY3ljobliqDovb1qc1xyXG4gICAgICAgIGZvciAodmFyIGkgaW4ganNGaWxlcykge1xyXG4gICAgICAgICAgICB2YXIganNGaWxlID0ganNGaWxlc1tpXTtcclxuICAgICAgICAgICAgLy8g57uf5LiA57G75Z6LXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YganNGaWxlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDmmK/nroDljZXot6/lvoTvvIzlj5jmiJBKU0ZpbGVEYXRhXHJcbiAgICAgICAgICAgICAgICBqc0ZpbGVzW2ldID0ganNGaWxlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDoganNGaWxlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1vZGU6IEpTTG9hZE1vZGUuQVVUT1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDliJvlu7rkuIDkuKrnqbrnmoRzY3JpcHTmoIfnrb5cclxuICAgICAgICAgICAgdmFyIGpzTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XHJcbiAgICAgICAgICAgIGpzTm9kZS50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcclxuICAgICAgICAgICAgbm9kZXMucHVzaChqc05vZGUpO1xyXG4gICAgICAgICAgICAvLyDlvIDlp4vliqDovb1cclxuICAgICAgICAgICAgaWYgKGpzRmlsZS5tb2RlID09PSBKU0xvYWRNb2RlLkpTT05QIHx8IChqc0ZpbGUubW9kZSA9PT0gSlNMb2FkTW9kZS5BVVRPICYmICFpc0Fic29sdXRlUGF0aChqc0ZpbGUudXJsKSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9hZEFzc2V0cyhqc0ZpbGUudXJsLCBudWxsLCBudWxsLCBvbkNvbXBsZXRlT25lKTtcclxuICAgICAgICAgICAgICAgIC8vIOmAkuWinuaVsOmHj1xyXG4gICAgICAgICAgICAgICAganNvbnBDb3VudCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5L2/55Soc2NyaXB05qCH562+5pa55byP5Yqg6L2977yM5LiN55So5Zyo5oSP6aG65bqPXHJcbiAgICAgICAgICAgICAgICBqc05vZGUub25sb2FkID0gb25Mb2FkT25lO1xyXG4gICAgICAgICAgICAgICAganNOb2RlLm9uZXJyb3IgPSBvbkVycm9yT25lO1xyXG4gICAgICAgICAgICAgICAganNOb2RlLnNyYyA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh2ZXJzaW9uLndyYXBIYXNoVXJsKGpzRmlsZS51cmwpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliKTmlq3kuIDmrKFcclxuICAgICAgICB2YXIgYXBwZW5kSW5kZXggPSAwO1xyXG4gICAgICAgIGp1ZGdlQXBwZW5kKCk7XHJcbiAgICAgICAgZnVuY3Rpb24ganVkZ2VBcHBlbmQoKSB7XHJcbiAgICAgICAgICAgIGlmIChqc29ucENvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDov5nph4znu5/kuIDlsIbmiYDmnIlzY3JpcHTmoIfnrb7mt7vliqDliLBET03kuK3vvIzku6XmraTkv53mjIHpobrluo9cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBhcHBlbmRJbmRleCwgbGVuID0gbm9kZXMubGVuZ3RoOyBpIDwgbGVuOykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlID0gbm9kZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChub2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXmt7vliqDntKLlvJVcclxuICAgICAgICAgICAgICAgICAgICBhcHBlbmRJbmRleCA9ICsraTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzpnIDopoHkv53mjIHpobrluo/kuJTlvZPliY3mmK/moIfnrb7lvaLlvI9qc++8jOWImeWBnOatoua3u+WKoO+8jOetieW+heWKoOi9veWujOavleWGjee7p+e7rVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcmRlcmVkICYmIG5vZGUuc3JjKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkNvbXBsZXRlT25lKHVybCwgcmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5aSx6LSlXHJcbiAgICAgICAgICAgICAgICBvbkVycm9yT25lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlj5bliLDntKLlvJVcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGpzRmlsZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIganNGaWxlID0ganNGaWxlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoanNGaWxlLnVybCA9PT0gdXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5aGr5YWFc2NyaXB05qCH562+5YaF5a65XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBqc05vZGUgPSBub2Rlc1tpbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAganNOb2RlLmlubmVySFRNTCA9IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOmAkuWHj2pzb25w5pWw6YePXHJcbiAgICAgICAgICAgICAgICBqc29ucENvdW50LS07XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjmiJDlip9cclxuICAgICAgICAgICAgICAgIG9uTG9hZE9uZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uTG9hZE9uZSgpIHtcclxuICAgICAgICAgICAgLy8g5re75Yqg5qCH562+XHJcbiAgICAgICAgICAgIGp1ZGdlQXBwZW5kKCk7XHJcbiAgICAgICAgICAgIC8vIOWmguaenOWFqOmDqOWKoOi9veWujOavleWImeiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBpZiAoIXN0b3AgJiYgLS1jb3VudCA9PT0gMClcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25FcnJvck9uZSgpIHtcclxuICAgICAgICAgICAgaWYgKCFzdG9wKSB7XHJcbiAgICAgICAgICAgICAgICBzdG9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIobmV3IEVycm9yKFwiSlPliqDovb3lpLHotKVcIikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFzc2V0c01hbmFnZXIgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIEFzc2V0c01hbmFnZXIpO1xyXG4gICAgcmV0dXJuIEFzc2V0c01hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEFzc2V0c01hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBhc3NldHNNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoQXNzZXRzTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hc3NldHMvQXNzZXRzTWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZXh0ZW5kT2JqZWN0IH0gZnJvbSBcIi4vT2JqZWN0VXRpbFwiO1xyXG4vKipcclxuICog6I635Y+W5b2T5YmN6aG16Z2i55qEb3JpZ2lu77yM5Lya5YW85a65SUUxMOS7peS4i1xyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VyT3JpZ2luKCkge1xyXG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4pXHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5vcmlnaW47XHJcbiAgICByZXR1cm4gKHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0KTtcclxufVxyXG4vKipcclxuICog6KeE5pW0dXJsXHJcbiAqIEBwYXJhbSB1cmxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmltVVJMKHVybCkge1xyXG4gICAgLy8g5Y676Zmk5aSa5L2Z55qEXCIvXCJcclxuICAgIHVybCA9IHVybC5yZXBsYWNlKC8oW146XFwvXXwoOlxcLykpXFwvKy9nLCBcIiQxL1wiKTtcclxuICAgIGlmICh1cmwuY2hhckF0KDApID09IFwiL1wiKVxyXG4gICAgICAgIHVybCA9IHVybC5zdWJzdHIoMSk7XHJcbiAgICAvLyDlpITnkIbpnZ7ntKfotLTln5/lkI3nmoRcIi94eC8uLi9cIlxyXG4gICAgdmFyIHJlZyA9IC8oPyE6XFwvezIsfVteXFwvXStcXC8pKFteXFwvXFwuXSspXFwvW15cXC9cXC5dKz9cXC9cXC5cXC5cXC8vO1xyXG4gICAgd2hpbGUgKHJlZy50ZXN0KHVybCkpIHtcclxuICAgICAgICB1cmwgPSB1cmwucmVwbGFjZShyZWcsIFwiLyQxXCIpO1xyXG4gICAgfVxyXG4gICAgLy8g5aSE55CGXCIvLi9cIuWSjOWJqeS9meeahFwiLy4uL1wi77yM55u05o6l5Lii5byD5LmLXHJcbiAgICB2YXIgcmVnID0gL1xcL1xcLnsxLDJ9XFwvLztcclxuICAgIHdoaWxlIChyZWcudGVzdCh1cmwpKSB7XHJcbiAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UocmVnLCBcIi9cIik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcbi8qKlxyXG4gKiDmo4Dmn6VVUkzmmK/lkKbmmK/nu53lr7not6/lvoTvvIjlhbfmnInljY/orq7lpLTvvIlcclxuICogQHBhcmFtIHVybCDopoHliKTmlq3nmoRVUkxcclxuICogQHJldHVybnMge2FueX0g5piv5ZCm5piv57ud5a+56Lev5b6EXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNBYnNvbHV0ZVBhdGgodXJsKSB7XHJcbiAgICBpZiAodXJsID09IG51bGwpXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgcmV0dXJuICh1cmwuaW5kZXhPZihcIjovL1wiKSA+PSAwKTtcclxufVxyXG4vKipcclxuICog5aaC5p6cdXJs5pyJcHJvdG9jb2zvvIzkvb/lhbbkuI7lvZPliY3ln5/lkI3nmoRwcm90b2NvbOe7n+S4gO+8jOWQpuWImeS8mui3qOWfn1xyXG4gKiBAcGFyYW0gdXJsIOimgee7n+S4gHByb3RvY29s55qEdXJsXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcHJvdG9jb2xdIOimgee7n+S4gOaIkOeahHByb3RvY29s77yM5LiN5Lyg5YiZ5qC55o2u5b2T5YmN6aG16Z2i55qEcHJvdG9jb2zkvb/nlKjjgILmoLnmja7moIflh4bvvIxwcm90b2NvbOaYr+imgeaQuuW4pjrnmoTvvIzmr5TlpoLigJxodHRwOuKAnVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlUHJvdG9jb2wodXJsLCBwcm90b2NvbCkge1xyXG4gICAgaWYgKHVybCA9PSBudWxsKVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgdmFyIGluZGV4ID0gdXJsLmluZGV4T2YoXCI6Ly9cIik7XHJcbiAgICBpZiAoaW5kZXggPCAwKVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICAvLyDlm6DkuLpwcm90b2NvbOaYr+imgeaQuuW4pjrnmoTvvIzmiYDku6VpbmRleOiHquWKoDFcclxuICAgIGluZGV4Kys7XHJcbiAgICBpZiAocHJvdG9jb2wpIHtcclxuICAgICAgICAvLyDnm7TmjqXkvb/nlKjkvKDpgJLnmoRwcm90b2NvbFxyXG4gICAgICAgIHJldHVybiBwcm90b2NvbCArIHVybC5zdWJzdHIoaW5kZXgpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcHJvdG9jb2wgPSB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KTtcclxuICAgICAgICAvLyDosIPmlbRodHRw5ZKMaHR0cHNcclxuICAgICAgICBpZiAocHJvdG9jb2wgPT0gXCJodHRwOlwiIHx8IHByb3RvY29sID09IFwiaHR0cHM6XCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIHVybC5zdWJzdHIoaW5kZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDosIPmlbR3c+WSjHdzc1xyXG4gICAgICAgIGlmIChwcm90b2NvbCA9PSBcIndzOlwiIHx8IHByb3RvY29sID09IFwid3NzOlwiKSB7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT0gXCJodHRwczpcIilcclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCJ3c3M6XCI7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gXCJ3czpcIjtcclxuICAgICAgICAgICAgcmV0dXJuIHByb3RvY29sICsgdXJsLnN1YnN0cihpbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOS4jemcgOimgeiwg+aVtFxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOabv+aNonVybOS4reeahGhvc3TvvIzlpoLmnpzkvKDlhaXnmoTmmK/nu53lr7not6/lvoTkuJRmb3JjZWTkuLpmYWxzZe+8jOWImeS4jeS8muWQiOazleWMlnByb3RvY29sXHJcbiAqIEBwYXJhbSB1cmwgICAgICAgdXJsXHJcbiAqIEBwYXJhbSBob3N0ICAgICAg6KaB5pu/5o2i55qEaG9zdFxyXG4gKiBAcGFyYW0gZm9yY2VkICAgIOaYr+WQpuW8uuWItuabv+aNou+8iOm7mOiupGZhbHNl77yJXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gd3JhcEhvc3QodXJsLCBob3N0LCBmb3JjZWQpIHtcclxuICAgIGlmIChmb3JjZWQgPT09IHZvaWQgMCkgeyBmb3JjZWQgPSBmYWxzZTsgfVxyXG4gICAgaWYgKHVybCA9PSBudWxsKVxyXG4gICAgICAgIHJldHVybiB1cmw7XHJcbiAgICBob3N0ID0gaG9zdCB8fCBnZXRDdXJPcmlnaW4oKTtcclxuICAgIHZhciByZSA9IC9eKD86W15cXC9dKyk6XFwvezIsfSg/OlteXFwvXSspXFwvLztcclxuICAgIHZhciBhcnIgPSB1cmwubWF0Y2gocmUpO1xyXG4gICAgaWYgKGFyciAmJiBhcnIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGlmIChmb3JjZWQpIHtcclxuICAgICAgICAgICAgdXJsID0gdXJsLnN1YnN0cihhcnJbMF0ubGVuZ3RoKTtcclxuICAgICAgICAgICAgdXJsID0gaG9zdCArIFwiL1wiICsgdXJsO1xyXG4gICAgICAgICAgICAvLyDlkIjms5XljJbkuIDkuItwcm90b2NvbFxyXG4gICAgICAgICAgICB1cmwgPSB2YWxpZGF0ZVByb3RvY29sKHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgdXJsID0gaG9zdCArIFwiL1wiICsgdXJsO1xyXG4gICAgICAgIC8vIOWQiOazleWMluS4gOS4i3Byb3RvY29sXHJcbiAgICAgICAgdXJsID0gdmFsaWRhdGVQcm90b2NvbCh1cmwpO1xyXG4gICAgfVxyXG4gICAgLy8g5pyA5ZCO6KeE5pW05LiA5LiLdXJsXHJcbiAgICB1cmwgPSB0cmltVVJMKHVybCk7XHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcbi8qKlxyXG4gKiDlsIbnm7jlr7nkuo7lvZPliY3pobXpnaLnmoTnm7jlr7not6/lvoTljIXoo4XmiJDnu53lr7not6/lvoRcclxuICogQHBhcmFtIHJlbGF0aXZlUGF0aCDnm7jlr7nkuo7lvZPliY3pobXpnaLnmoTnm7jlr7not6/lvoRcclxuICogQHBhcmFtIGhvc3Qg5Lyg6YCS6K+l5Y+C5pWw5Lya55So6K+laG9zdOabv+aNouW9k+WJjWhvc3RcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3cmFwQWJzb2x1dGVQYXRoKHJlbGF0aXZlUGF0aCwgaG9zdCkge1xyXG4gICAgLy8g6I635Y+W5b2T5YmN6aG16Z2i55qEdXJsXHJcbiAgICB2YXIgY3VyUGF0aCA9IGdldFBhdGgod2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgdmFyIHVybCA9IHRyaW1VUkwoY3VyUGF0aCArIFwiL1wiICsgcmVsYXRpdmVQYXRoKTtcclxuICAgIGlmIChob3N0ICE9IG51bGwpIHtcclxuICAgICAgICB1cmwgPSB3cmFwSG9zdCh1cmwsIGhvc3QsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVybDtcclxufVxyXG4vKipcclxuICog6I635Y+WVVJM55qEaG9zdCtwYXRobmFtZemDqOWIhu+8jOWNs+mXruWPtyg/KeS7peWJjeeahOmDqOWIhlxyXG4gKlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEhvc3RBbmRQYXRobmFtZSh1cmwpIHtcclxuICAgIGlmICh1cmwgPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1cmzkuI3og73kuLrnqbpcIik7XHJcbiAgICAvLyDljrvmjolnZXTlj4LmlbDlkoxoYXNoXHJcbiAgICB1cmwgPSB1cmwuc3BsaXQoXCIjXCIpWzBdLnNwbGl0KFwiP1wiKVswXTtcclxuICAgIC8vIOWOu+aOieWkmuS9meeahC9cclxuICAgIHVybCA9IHRyaW1VUkwodXJsKTtcclxuICAgIHJldHVybiB1cmw7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPllVSTOi3r+W+hO+8iOaWh+S7tuWQjeWJjeeahOmDqOWIhu+8iVxyXG4gKiBAcGFyYW0gdXJsIOimgeWIhuaekOeahFVSTFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFBhdGgodXJsKSB7XHJcbiAgICAvLyDpppblhYjljrvmjonlpJrkvZnnmoQvXHJcbiAgICB1cmwgPSBnZXRIb3N0QW5kUGF0aG5hbWUodXJsKTtcclxuICAgIC8vIOeEtuWQjuiOt+WPluWIsOi3r+W+hFxyXG4gICAgdmFyIHVybEFyciA9IHVybC5zcGxpdChcIi9cIik7XHJcbiAgICB1cmxBcnIucG9wKCk7XHJcbiAgICByZXR1cm4gdXJsQXJyLmpvaW4oXCIvXCIpICsgXCIvXCI7XHJcbn1cclxuLyoqXHJcbiAqIOiOt+WPllVSTOeahOaWh+S7tuWQjVxyXG4gKiBAcGFyYW0gdXJsIOimgeWIhuaekOeahFVSTFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE5hbWUodXJsKSB7XHJcbiAgICAvLyDlhYjljrvmjolnZXTlj4LmlbDlkoxoYXNoXHJcbiAgICB1cmwgPSB1cmwuc3BsaXQoXCIjXCIpWzBdLnNwbGl0KFwiP1wiKVswXTtcclxuICAgIC8vIOeEtuWQjuiOt+WPluWIsOaWh+S7tuWQjVxyXG4gICAgdmFyIHVybEFyciA9IHVybC5zcGxpdChcIi9cIik7XHJcbiAgICB2YXIgZmlsZU5hbWUgPSB1cmxBcnJbdXJsQXJyLmxlbmd0aCAtIDFdO1xyXG4gICAgcmV0dXJuIGZpbGVOYW1lO1xyXG59XHJcbi8qKlxyXG4gKiDop6PmnpBVUkxcclxuICogQHBhcmFtIHVybCDopoHooqvop6PmnpDnmoRVUkzlrZfnrKbkuLJcclxuICogQHJldHVybnMge2FueX0g6Kej5p6Q5ZCO55qEVVJMTG9jYXRpb27nu5PmnoTkvZNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVybCh1cmwpIHtcclxuICAgIHZhciByZWdFeHAgPSAvKChbXjpdKzopXFwvezIsfSgoW146XFwvXFw/I10rKSg6KFxcZCspKT8pKT8oXFwvW14/I10qKT8oXFw/W14jXSopPygjLiopPy87XHJcbiAgICB2YXIgbWF0Y2ggPSByZWdFeHAuZXhlYyh1cmwpO1xyXG4gICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaHJlZjogbWF0Y2hbMF0gfHwgXCJcIixcclxuICAgICAgICAgICAgb3JpZ2luOiBtYXRjaFsxXSB8fCBcIlwiLFxyXG4gICAgICAgICAgICBwcm90b2NvbDogbWF0Y2hbMl0gfHwgXCJcIixcclxuICAgICAgICAgICAgaG9zdDogbWF0Y2hbM10gfHwgXCJcIixcclxuICAgICAgICAgICAgaG9zdG5hbWU6IG1hdGNoWzRdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIHBvcnQ6IG1hdGNoWzZdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIHBhdGhuYW1lOiBtYXRjaFs3XSB8fCBcIlwiLFxyXG4gICAgICAgICAgICBzZWFyY2g6IG1hdGNoWzhdIHx8IFwiXCIsXHJcbiAgICAgICAgICAgIGhhc2g6IChtYXRjaFs5XSA9PSBcIiNcIiA/IFwiXCIgOiBtYXRjaFs5XSkgfHwgXCJcIlxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLkvKDlhaVwYXJzZVVybOaWueazleeahOWPguaVsOS4jeaYr+S4gOS4quWujOaVtOeahFVSTO+8mlwiICsgdXJsKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog6Kej5p6QdXJs5p+l6K+i5Y+C5pWwXHJcbiAqIEBUT0RPIOa3u+WKoOWvuWpxdWVyeee8lueggeaWueW8j+eahOaUr+aMgVxyXG4gKiBAcGFyYW0gdXJsIHVybFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKHVybCkge1xyXG4gICAgdmFyIGluZGV4ID0gdXJsLmluZGV4T2YoXCIjXCIpO1xyXG4gICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICB1cmwgPSB1cmwuc3Vic3RyaW5nKDAsIGluZGV4KTtcclxuICAgIH1cclxuICAgIGluZGV4ID0gdXJsLmluZGV4T2YoXCI/XCIpO1xyXG4gICAgaWYgKGluZGV4IDwgMClcclxuICAgICAgICByZXR1cm4ge307XHJcbiAgICB2YXIgcXVlcnlTdHJpbmcgPSB1cmwuc3Vic3RyaW5nKGluZGV4ICsgMSk7XHJcbiAgICB2YXIgcGFyYW1zID0ge307XHJcbiAgICB2YXIga3ZzID0gcXVlcnlTdHJpbmcuc3BsaXQoXCImXCIpO1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrdnNfMSA9IGt2czsgX2kgPCBrdnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga3YgPSBrdnNfMVtfaV07XHJcbiAgICAgICAgdmFyIHBhaXIgPSBrdi5zcGxpdChcIj1cIiwgMik7XHJcbiAgICAgICAgaWYgKHBhaXIubGVuZ3RoICE9PSAyIHx8ICFwYWlyWzBdKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiW1VSTFV0aWxdIGludmFsaWQgcXVlcnkgcGFyYW1zOiBcIiArIGt2KTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBuYW1lID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhaXJbMF0pO1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IGRlY29kZVVSSUNvbXBvbmVudChwYWlyWzFdKTtcclxuICAgICAgICBwYXJhbXNbbmFtZV0gPSB2YWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXM7XHJcbn1cclxuLyoqXHJcbiAqIOWwhuWPguaVsOi/nuaOpeWIsOaMh+WumlVSTOWQjumdolxyXG4gKiBAcGFyYW0gdXJsIHVybFxyXG4gKiBAcGFyYW0gcGFyYW1zIOS4gOS4qm1hcO+8jOWMheWQq+imgei/nuaOpeeahOWPguaVsFxyXG4gKiBAcmV0dXJuIHN0cmluZyDov57mjqXlkI7nmoRVUkzlnLDlnYBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBqb2luUXVlcnlQYXJhbXModXJsLCBwYXJhbXMpIHtcclxuICAgIGlmICh1cmwgPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ1cmzkuI3og73kuLrnqbpcIik7XHJcbiAgICB2YXIgb3JpUGFyYW1zID0gZ2V0UXVlcnlQYXJhbXModXJsKTtcclxuICAgIHZhciB0YXJnZXRQYXJhbXMgPSBleHRlbmRPYmplY3Qob3JpUGFyYW1zLCBwYXJhbXMpO1xyXG4gICAgdmFyIGhhc2ggPSBwYXJzZVVybCh1cmwpLmhhc2g7XHJcbiAgICB1cmwgPSBnZXRIb3N0QW5kUGF0aG5hbWUodXJsKTtcclxuICAgIHZhciBpc0ZpcnN0ID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGtleSBpbiB0YXJnZXRQYXJhbXMpIHtcclxuICAgICAgICBpZiAoaXNGaXJzdCkge1xyXG4gICAgICAgICAgICB1cmwgKz0gXCI/XCIgKyBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHRhcmdldFBhcmFtc1trZXldKTtcclxuICAgICAgICAgICAgaXNGaXJzdCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXJsICs9IFwiJlwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh0YXJnZXRQYXJhbXNba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8g5Yqg5LiKaGFzaFxyXG4gICAgdXJsICs9IGhhc2g7XHJcbiAgICByZXR1cm4gdXJsO1xyXG59XHJcbi8qKlxyXG4gKiDlsIblj4LmlbDpk77mjqXliLBVUkznmoRoYXNo5ZCO6Z2iXHJcbiAqIEBwYXJhbSB1cmwg5aaC5p6c5Lyg5YWl55qEdXJs5rKh5pyJ5rOo5piOaGFzaOaooeWdl++8jOWImeS4jeS8mui/m+ihjOaTjeS9nFxyXG4gKiBAcGFyYW0gcGFyYW1zIOS4gOS4qm1hcO+8jOWMheWQq+imgei/nuaOpeeahOWPguaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGpvaW5IYXNoUGFyYW1zKHVybCwgcGFyYW1zKSB7XHJcbiAgICBpZiAodXJsID09IG51bGwpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidXJs5LiN6IO95Li656m6XCIpO1xyXG4gICAgdmFyIGhhc2ggPSBwYXJzZVVybCh1cmwpLmhhc2g7XHJcbiAgICBpZiAoaGFzaCA9PSBudWxsIHx8IGhhc2ggPT0gXCJcIilcclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgZm9yICh2YXIga2V5IGluIHBhcmFtcykge1xyXG4gICAgICAgIHZhciB2YWx1ZSA9IHBhcmFtc1trZXldO1xyXG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgIT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZS50b1N0cmluZygpO1xyXG4gICAgICAgIGhhc2ggKz0gKChoYXNoLmluZGV4T2YoXCI/XCIpIDwgMCA/IFwiP1wiIDogXCImXCIpICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICh1cmwuc3BsaXQoXCIjXCIpWzBdICsgaGFzaCk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvVVJMVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gMTJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoQykgTWljcm9zb2Z0LiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxudmFyIF9SZWZsZWN0O1xyXG4oZnVuY3Rpb24gKFJlZmxlY3QpIHtcclxuICAgIC8vIE1ldGFkYXRhIFByb3Bvc2FsXHJcbiAgICAvLyBodHRwczovL3JidWNrdG9uLmdpdGh1Yi5pby9yZWZsZWN0LW1ldGFkYXRhL1xyXG4gICAgKGZ1bmN0aW9uIChmYWN0b3J5KSB7XHJcbiAgICAgICAgdmFyIHJvb3QgPSB0eXBlb2YgZ2xvYmFsID09PSBcIm9iamVjdFwiID8gZ2xvYmFsIDpcclxuICAgICAgICAgICAgdHlwZW9mIHNlbGYgPT09IFwib2JqZWN0XCIgPyBzZWxmIDpcclxuICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzID09PSBcIm9iamVjdFwiID8gdGhpcyA6XHJcbiAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb24oXCJyZXR1cm4gdGhpcztcIikoKTtcclxuICAgICAgICB2YXIgZXhwb3J0ZXIgPSBtYWtlRXhwb3J0ZXIoUmVmbGVjdCk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiByb290LlJlZmxlY3QgPT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgcm9vdC5SZWZsZWN0ID0gUmVmbGVjdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGV4cG9ydGVyID0gbWFrZUV4cG9ydGVyKHJvb3QuUmVmbGVjdCwgZXhwb3J0ZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmYWN0b3J5KGV4cG9ydGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBtYWtlRXhwb3J0ZXIodGFyZ2V0LCBwcmV2aW91cykge1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGFyZ2V0W2tleV0gIT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgeyBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXMpXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfSkoZnVuY3Rpb24gKGV4cG9ydGVyKSB7XHJcbiAgICAgICAgdmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XHJcbiAgICAgICAgLy8gZmVhdHVyZSB0ZXN0IGZvciBTeW1ib2wgc3VwcG9ydFxyXG4gICAgICAgIHZhciBzdXBwb3J0c1N5bWJvbCA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIjtcclxuICAgICAgICB2YXIgdG9QcmltaXRpdmVTeW1ib2wgPSBzdXBwb3J0c1N5bWJvbCAmJiB0eXBlb2YgU3ltYm9sLnRvUHJpbWl0aXZlICE9PSBcInVuZGVmaW5lZFwiID8gU3ltYm9sLnRvUHJpbWl0aXZlIDogXCJAQHRvUHJpbWl0aXZlXCI7XHJcbiAgICAgICAgdmFyIGl0ZXJhdG9yU3ltYm9sID0gc3VwcG9ydHNTeW1ib2wgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciAhPT0gXCJ1bmRlZmluZWRcIiA/IFN5bWJvbC5pdGVyYXRvciA6IFwiQEBpdGVyYXRvclwiO1xyXG4gICAgICAgIHZhciBzdXBwb3J0c0NyZWF0ZSA9IHR5cGVvZiBPYmplY3QuY3JlYXRlID09PSBcImZ1bmN0aW9uXCI7IC8vIGZlYXR1cmUgdGVzdCBmb3IgT2JqZWN0LmNyZWF0ZSBzdXBwb3J0XHJcbiAgICAgICAgdmFyIHN1cHBvcnRzUHJvdG8gPSB7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5OyAvLyBmZWF0dXJlIHRlc3QgZm9yIF9fcHJvdG9fXyBzdXBwb3J0XHJcbiAgICAgICAgdmFyIGRvd25MZXZlbCA9ICFzdXBwb3J0c0NyZWF0ZSAmJiAhc3VwcG9ydHNQcm90bztcclxuICAgICAgICB2YXIgSGFzaE1hcCA9IHtcclxuICAgICAgICAgICAgLy8gY3JlYXRlIGFuIG9iamVjdCBpbiBkaWN0aW9uYXJ5IG1vZGUgKGEuay5hLiBcInNsb3dcIiBtb2RlIGluIHY4KVxyXG4gICAgICAgICAgICBjcmVhdGU6IHN1cHBvcnRzQ3JlYXRlXHJcbiAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuIE1ha2VEaWN0aW9uYXJ5KE9iamVjdC5jcmVhdGUobnVsbCkpOyB9XHJcbiAgICAgICAgICAgICAgICA6IHN1cHBvcnRzUHJvdG9cclxuICAgICAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuIE1ha2VEaWN0aW9uYXJ5KHsgX19wcm90b19fOiBudWxsIH0pOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgOiBmdW5jdGlvbiAoKSB7IHJldHVybiBNYWtlRGljdGlvbmFyeSh7fSk7IH0sXHJcbiAgICAgICAgICAgIGhhczogZG93bkxldmVsXHJcbiAgICAgICAgICAgICAgICA/IGZ1bmN0aW9uIChtYXAsIGtleSkgeyByZXR1cm4gaGFzT3duLmNhbGwobWFwLCBrZXkpOyB9XHJcbiAgICAgICAgICAgICAgICA6IGZ1bmN0aW9uIChtYXAsIGtleSkgeyByZXR1cm4ga2V5IGluIG1hcDsgfSxcclxuICAgICAgICAgICAgZ2V0OiBkb3duTGV2ZWxcclxuICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKG1hcCwga2V5KSB7IHJldHVybiBoYXNPd24uY2FsbChtYXAsIGtleSkgPyBtYXBba2V5XSA6IHVuZGVmaW5lZDsgfVxyXG4gICAgICAgICAgICAgICAgOiBmdW5jdGlvbiAobWFwLCBrZXkpIHsgcmV0dXJuIG1hcFtrZXldOyB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gTG9hZCBnbG9iYWwgb3Igc2hpbSB2ZXJzaW9ucyBvZiBNYXAsIFNldCwgYW5kIFdlYWtNYXBcclxuICAgICAgICB2YXIgZnVuY3Rpb25Qcm90b3R5cGUgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRnVuY3Rpb24pO1xyXG4gICAgICAgIHZhciB1c2VQb2x5ZmlsbCA9IHR5cGVvZiBwcm9jZXNzID09PSBcIm9iamVjdFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52W1wiUkVGTEVDVF9NRVRBREFUQV9VU0VfTUFQX1BPTFlGSUxMXCJdID09PSBcInRydWVcIjtcclxuICAgICAgICB2YXIgX01hcCA9ICF1c2VQb2x5ZmlsbCAmJiB0eXBlb2YgTWFwID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIE1hcC5wcm90b3R5cGUuZW50cmllcyA9PT0gXCJmdW5jdGlvblwiID8gTWFwIDogQ3JlYXRlTWFwUG9seWZpbGwoKTtcclxuICAgICAgICB2YXIgX1NldCA9ICF1c2VQb2x5ZmlsbCAmJiB0eXBlb2YgU2V0ID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFNldC5wcm90b3R5cGUuZW50cmllcyA9PT0gXCJmdW5jdGlvblwiID8gU2V0IDogQ3JlYXRlU2V0UG9seWZpbGwoKTtcclxuICAgICAgICB2YXIgX1dlYWtNYXAgPSAhdXNlUG9seWZpbGwgJiYgdHlwZW9mIFdlYWtNYXAgPT09IFwiZnVuY3Rpb25cIiA/IFdlYWtNYXAgOiBDcmVhdGVXZWFrTWFwUG9seWZpbGwoKTtcclxuICAgICAgICAvLyBbW01ldGFkYXRhXV0gaW50ZXJuYWwgc2xvdFxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5LW9iamVjdC1pbnRlcm5hbC1tZXRob2RzLWFuZC1pbnRlcm5hbC1zbG90c1xyXG4gICAgICAgIHZhciBNZXRhZGF0YSA9IG5ldyBfV2Vha01hcCgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFwcGxpZXMgYSBzZXQgb2YgZGVjb3JhdG9ycyB0byBhIHByb3BlcnR5IG9mIGEgdGFyZ2V0IG9iamVjdC5cclxuICAgICAgICAgKiBAcGFyYW0gZGVjb3JhdG9ycyBBbiBhcnJheSBvZiBkZWNvcmF0b3JzLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3QuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSB0byBkZWNvcmF0ZS5cclxuICAgICAgICAgKiBAcGFyYW0gYXR0cmlidXRlcyAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBkZXNjcmlwdG9yIGZvciB0aGUgdGFyZ2V0IGtleS5cclxuICAgICAgICAgKiBAcmVtYXJrcyBEZWNvcmF0b3JzIGFyZSBhcHBsaWVkIGluIHJldmVyc2Ugb3JkZXIuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBFeGFtcGxlID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiLFxyXG4gICAgICAgICAqICAgICAgICAgUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzQXJyYXksIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKSkpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnNBcnJheSwgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIsXHJcbiAgICAgICAgICogICAgICAgICAgICAgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihFeGFtcGxlLnByb3RvdHlwZSwgXCJtZXRob2RcIikpKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwgcHJvcGVydHlLZXksIGF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghSXNBcnJheShkZWNvcmF0b3JzKSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc09iamVjdChhdHRyaWJ1dGVzKSAmJiAhSXNVbmRlZmluZWQoYXR0cmlidXRlcykgJiYgIUlzTnVsbChhdHRyaWJ1dGVzKSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoSXNOdWxsKGF0dHJpYnV0ZXMpKVxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERlY29yYXRlUHJvcGVydHkoZGVjb3JhdG9ycywgdGFyZ2V0LCBwcm9wZXJ0eUtleSwgYXR0cmlidXRlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUlzQXJyYXkoZGVjb3JhdG9ycykpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc0NvbnN0cnVjdG9yKHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIERlY29yYXRlQ29uc3RydWN0b3IoZGVjb3JhdG9ycywgdGFyZ2V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcImRlY29yYXRlXCIsIGRlY29yYXRlKTtcclxuICAgICAgICAvLyA0LjEuMiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI3JlZmxlY3QubWV0YWRhdGFcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGRlZmF1bHQgbWV0YWRhdGEgZGVjb3JhdG9yIGZhY3RvcnkgdGhhdCBjYW4gYmUgdXNlZCBvbiBhIGNsYXNzLCBjbGFzcyBtZW1iZXIsIG9yIHBhcmFtZXRlci5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgVGhlIGtleSBmb3IgdGhlIG1ldGFkYXRhIGVudHJ5LlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YVZhbHVlIFRoZSB2YWx1ZSBmb3IgdGhlIG1ldGFkYXRhIGVudHJ5LlxyXG4gICAgICAgICAqIEByZXR1cm5zIEEgZGVjb3JhdG9yIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEByZW1hcmtzXHJcbiAgICAgICAgICogSWYgYG1ldGFkYXRhS2V5YCBpcyBhbHJlYWR5IGRlZmluZWQgZm9yIHRoZSB0YXJnZXQgYW5kIHRhcmdldCBrZXksIHRoZVxyXG4gICAgICAgICAqIG1ldGFkYXRhVmFsdWUgZm9yIHRoYXQga2V5IHdpbGwgYmUgb3ZlcndyaXR0ZW4uXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBAUmVmbGVjdC5tZXRhZGF0YShrZXksIHZhbHVlKVxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvciwgVHlwZVNjcmlwdCBvbmx5KVxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIEBSZWZsZWN0Lm1ldGFkYXRhKGtleSwgdmFsdWUpXHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlLCBUeXBlU2NyaXB0IG9ubHkpXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgQFJlZmxlY3QubWV0YWRhdGEoa2V5LCB2YWx1ZSlcclxuICAgICAgICAgKiAgICAgICAgIHByb3BlcnR5O1xyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICBAUmVmbGVjdC5tZXRhZGF0YShrZXksIHZhbHVlKVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZCgpIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgQFJlZmxlY3QubWV0YWRhdGEoa2V5LCB2YWx1ZSlcclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZCgpIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBtZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBkZWNvcmF0b3IodGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgICAgIGlmICghSXNVbmRlZmluZWQocHJvcGVydHlLZXkpICYmICFJc1Byb3BlcnR5S2V5KHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlLCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZGVjb3JhdG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcIm1ldGFkYXRhXCIsIG1ldGFkYXRhKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZWZpbmUgYSB1bmlxdWUgbWV0YWRhdGEgZW50cnkgb24gdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgQSBrZXkgdXNlZCB0byBzdG9yZSBhbmQgcmV0cmlldmUgbWV0YWRhdGEuXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGFkYXRhVmFsdWUgQSB2YWx1ZSB0aGF0IGNvbnRhaW5zIGF0dGFjaGVkIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdG8gZGVmaW5lIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZSk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZS5wcm90b3R5cGUsIFwicHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIG9wdGlvbnMsIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICBSZWZsZWN0LmRlZmluZU1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgb3B0aW9ucywgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGRlY29yYXRvciBmYWN0b3J5IGFzIG1ldGFkYXRhLXByb2R1Y2luZyBhbm5vdGF0aW9uLlxyXG4gICAgICAgICAqICAgICBmdW5jdGlvbiBNeUFubm90YXRpb24ob3B0aW9ucyk6IERlY29yYXRvciB7XHJcbiAgICAgICAgICogICAgICAgICByZXR1cm4gKHRhcmdldCwga2V5PykgPT4gUmVmbGVjdC5kZWZpbmVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIG9wdGlvbnMsIHRhcmdldCwga2V5KTtcclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZGVmaW5lTWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUsIHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlLCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJkZWZpbmVNZXRhZGF0YVwiLCBkZWZpbmVNZXRhZGF0YSk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0cyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlciB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluIGhhcyB0aGUgcHJvdmlkZWQgbWV0YWRhdGEga2V5IGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIG1ldGFkYXRhS2V5IEEga2V5IHVzZWQgdG8gc3RvcmUgYW5kIHJldHJpZXZlIG1ldGFkYXRhLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG1ldGFkYXRhIGtleSB3YXMgZGVmaW5lZCBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluOyBvdGhlcndpc2UsIGBmYWxzZWAuXHJcbiAgICAgICAgICogQGV4YW1wbGVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICBjbGFzcyBFeGFtcGxlIHtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5IGRlY2xhcmF0aW9ucyBhcmUgbm90IHBhcnQgb2YgRVM2LCB0aG91Z2ggdGhleSBhcmUgdmFsaWQgaW4gVHlwZVNjcmlwdDpcclxuICAgICAgICAgKiAgICAgICAgIC8vIHN0YXRpYyBzdGF0aWNQcm9wZXJ0eTtcclxuICAgICAgICAgKiAgICAgICAgIC8vIHByb3BlcnR5O1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgICAgICBjb25zdHJ1Y3RvcihwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIHN0YXRpYyBzdGF0aWNNZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBtZXRob2QocCkgeyB9XHJcbiAgICAgICAgICogICAgIH1cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBjb25zdHJ1Y3RvclxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZS5wcm90b3R5cGUsIFwicHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5oYXNNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljTWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc01ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gaGFzTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeUhhc01ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJoYXNNZXRhZGF0YVwiLCBoYXNNZXRhZGF0YSk7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR2V0cyBhIHZhbHVlIGluZGljYXRpbmcgd2hldGhlciB0aGUgdGFyZ2V0IG9iamVjdCBoYXMgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIGtleSBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgYHRydWVgIGlmIHRoZSBtZXRhZGF0YSBrZXkgd2FzIGRlZmluZWQgb24gdGhlIHRhcmdldCBvYmplY3Q7IG90aGVyd2lzZSwgYGZhbHNlYC5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY1Byb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0Lmhhc093bk1ldGFkYXRhKFwiY3VzdG9tOmFubm90YXRpb25cIiwgRXhhbXBsZSwgXCJzdGF0aWNNZXRob2RcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gbWV0aG9kIChvbiBwcm90b3R5cGUpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuaGFzT3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLnByb3RvdHlwZSwgXCJtZXRob2RcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBoYXNPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSkge1xyXG4gICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHRhcmdldCkpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIGlmICghSXNVbmRlZmluZWQocHJvcGVydHlLZXkpKVxyXG4gICAgICAgICAgICAgICAgcHJvcGVydHlLZXkgPSBUb1Byb3BlcnR5S2V5KHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgcmV0dXJuIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCwgcHJvcGVydHlLZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBleHBvcnRlcihcImhhc093bk1ldGFkYXRhXCIsIGhhc093bk1ldGFkYXRhKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXRzIHRoZSBtZXRhZGF0YSB2YWx1ZSBmb3IgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIGtleSBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluLlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgbWV0YWRhdGEga2V5IGlmIGZvdW5kOyBvdGhlcndpc2UsIGB1bmRlZmluZWRgLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0TWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldE1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRNZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cG9ydGVyKFwiZ2V0TWV0YWRhdGFcIiwgZ2V0TWV0YWRhdGEpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldHMgdGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgcHJvdmlkZWQgbWV0YWRhdGEga2V5IG9uIHRoZSB0YXJnZXQgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSBtZXRhZGF0YUtleSBBIGtleSB1c2VkIHRvIHN0b3JlIGFuZCByZXRyaWV2ZSBtZXRhZGF0YS5cclxuICAgICAgICAgKiBAcGFyYW0gdGFyZ2V0IFRoZSB0YXJnZXQgb2JqZWN0IG9uIHdoaWNoIHRoZSBtZXRhZGF0YSBpcyBkZWZpbmVkLlxyXG4gICAgICAgICAqIEBwYXJhbSBwcm9wZXJ0eUtleSAoT3B0aW9uYWwpIFRoZSBwcm9wZXJ0eSBrZXkgZm9yIHRoZSB0YXJnZXQuXHJcbiAgICAgICAgICogQHJldHVybnMgVGhlIG1ldGFkYXRhIHZhbHVlIGZvciB0aGUgbWV0YWRhdGEga2V5IGlmIGZvdW5kOyBvdGhlcndpc2UsIGB1bmRlZmluZWRgLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0T3duTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGdldE93bk1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0LCBwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV4cG9ydGVyKFwiZ2V0T3duTWV0YWRhdGFcIiwgZ2V0T3duTWV0YWRhdGEpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldHMgdGhlIG1ldGFkYXRhIGtleXMgZGVmaW5lZCBvbiB0aGUgdGFyZ2V0IG9iamVjdCBvciBpdHMgcHJvdG90eXBlIGNoYWluLlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiB1bmlxdWUgbWV0YWRhdGEga2V5cy5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0TWV0YWRhdGFLZXlzKEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YUtleXMoRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE1ldGFkYXRhS2V5cyhFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE1ldGFkYXRhS2V5cyhFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRNZXRhZGF0YUtleXMoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0TWV0YWRhdGFLZXlzKHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeU1ldGFkYXRhS2V5cyh0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJnZXRNZXRhZGF0YUtleXNcIiwgZ2V0TWV0YWRhdGFLZXlzKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXRzIHRoZSB1bmlxdWUgbWV0YWRhdGEga2V5cyBkZWZpbmVkIG9uIHRoZSB0YXJnZXQgb2JqZWN0LlxyXG4gICAgICAgICAqIEBwYXJhbSB0YXJnZXQgVGhlIHRhcmdldCBvYmplY3Qgb24gd2hpY2ggdGhlIG1ldGFkYXRhIGlzIGRlZmluZWQuXHJcbiAgICAgICAgICogQHBhcmFtIHByb3BlcnR5S2V5IChPcHRpb25hbCkgVGhlIHByb3BlcnR5IGtleSBmb3IgdGhlIHRhcmdldC5cclxuICAgICAgICAgKiBAcmV0dXJucyBBbiBhcnJheSBvZiB1bmlxdWUgbWV0YWRhdGEga2V5cy5cclxuICAgICAgICAgKiBAZXhhbXBsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIGNsYXNzIEV4YW1wbGUge1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHkgZGVjbGFyYXRpb25zIGFyZSBub3QgcGFydCBvZiBFUzYsIHRob3VnaCB0aGV5IGFyZSB2YWxpZCBpbiBUeXBlU2NyaXB0OlxyXG4gICAgICAgICAqICAgICAgICAgLy8gc3RhdGljIHN0YXRpY1Byb3BlcnR5O1xyXG4gICAgICAgICAqICAgICAgICAgLy8gcHJvcGVydHk7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgICAgIGNvbnN0cnVjdG9yKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgc3RhdGljIHN0YXRpY01ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgICAgIG1ldGhvZChwKSB7IH1cclxuICAgICAgICAgKiAgICAgfVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIGNvbnN0cnVjdG9yXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZ2V0T3duTWV0YWRhdGFLZXlzKEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YUtleXMoRXhhbXBsZSwgXCJzdGF0aWNQcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBwcm9wZXJ0eSAob24gcHJvdG90eXBlKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE93bk1ldGFkYXRhS2V5cyhFeGFtcGxlLnByb3RvdHlwZSwgXCJwcm9wZXJ0eVwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIGNvbnN0cnVjdG9yKVxyXG4gICAgICAgICAqICAgICByZXN1bHQgPSBSZWZsZWN0LmdldE93bk1ldGFkYXRhS2V5cyhFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5nZXRPd25NZXRhZGF0YUtleXMoRXhhbXBsZS5wcm90b3R5cGUsIFwibWV0aG9kXCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0T3duTWV0YWRhdGFLZXlzKHRhcmdldCwgcHJvcGVydHlLZXkpIHtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdCh0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICBpZiAoIUlzVW5kZWZpbmVkKHByb3BlcnR5S2V5KSlcclxuICAgICAgICAgICAgICAgIHByb3BlcnR5S2V5ID0gVG9Qcm9wZXJ0eUtleShwcm9wZXJ0eUtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeU93bk1ldGFkYXRhS2V5cyh0YXJnZXQsIHByb3BlcnR5S2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJnZXRPd25NZXRhZGF0YUtleXNcIiwgZ2V0T3duTWV0YWRhdGFLZXlzKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZWxldGVzIHRoZSBtZXRhZGF0YSBlbnRyeSBmcm9tIHRoZSB0YXJnZXQgb2JqZWN0IHdpdGggdGhlIHByb3ZpZGVkIGtleS5cclxuICAgICAgICAgKiBAcGFyYW0gbWV0YWRhdGFLZXkgQSBrZXkgdXNlZCB0byBzdG9yZSBhbmQgcmV0cmlldmUgbWV0YWRhdGEuXHJcbiAgICAgICAgICogQHBhcmFtIHRhcmdldCBUaGUgdGFyZ2V0IG9iamVjdCBvbiB3aGljaCB0aGUgbWV0YWRhdGEgaXMgZGVmaW5lZC5cclxuICAgICAgICAgKiBAcGFyYW0gcHJvcGVydHlLZXkgKE9wdGlvbmFsKSBUaGUgcHJvcGVydHkga2V5IGZvciB0aGUgdGFyZ2V0LlxyXG4gICAgICAgICAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgbWV0YWRhdGEgZW50cnkgd2FzIGZvdW5kIGFuZCBkZWxldGVkOyBvdGhlcndpc2UsIGZhbHNlLlxyXG4gICAgICAgICAqIEBleGFtcGxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgY2xhc3MgRXhhbXBsZSB7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eSBkZWNsYXJhdGlvbnMgYXJlIG5vdCBwYXJ0IG9mIEVTNiwgdGhvdWdoIHRoZXkgYXJlIHZhbGlkIGluIFR5cGVTY3JpcHQ6XHJcbiAgICAgICAgICogICAgICAgICAvLyBzdGF0aWMgc3RhdGljUHJvcGVydHk7XHJcbiAgICAgICAgICogICAgICAgICAvLyBwcm9wZXJ0eTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAgICAgY29uc3RydWN0b3IocCkgeyB9XHJcbiAgICAgICAgICogICAgICAgICBzdGF0aWMgc3RhdGljTWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICAgICAgbWV0aG9kKHApIHsgfVxyXG4gICAgICAgICAqICAgICB9XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gY29uc3RydWN0b3JcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIHByb3BlcnR5IChvbiBjb25zdHJ1Y3RvcilcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUsIFwic3RhdGljUHJvcGVydHlcIik7XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiAgICAgLy8gcHJvcGVydHkgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcInByb3BlcnR5XCIpO1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogICAgIC8vIG1ldGhvZCAob24gY29uc3RydWN0b3IpXHJcbiAgICAgICAgICogICAgIHJlc3VsdCA9IFJlZmxlY3QuZGVsZXRlTWV0YWRhdGEoXCJjdXN0b206YW5ub3RhdGlvblwiLCBFeGFtcGxlLCBcInN0YXRpY01ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgICAvLyBtZXRob2QgKG9uIHByb3RvdHlwZSlcclxuICAgICAgICAgKiAgICAgcmVzdWx0ID0gUmVmbGVjdC5kZWxldGVNZXRhZGF0YShcImN1c3RvbTphbm5vdGF0aW9uXCIsIEV4YW1wbGUucHJvdG90eXBlLCBcIm1ldGhvZFwiKTtcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZU1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQsIHByb3BlcnR5S2V5KSB7XHJcbiAgICAgICAgICAgIGlmICghSXNPYmplY3QodGFyZ2V0KSlcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChwcm9wZXJ0eUtleSkpXHJcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSA9IFRvUHJvcGVydHlLZXkocHJvcGVydHlLZXkpO1xyXG4gICAgICAgICAgICB2YXIgbWV0YWRhdGFNYXAgPSBHZXRPckNyZWF0ZU1ldGFkYXRhTWFwKHRhcmdldCwgcHJvcGVydHlLZXksIC8qQ3JlYXRlKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICBpZiAoSXNVbmRlZmluZWQobWV0YWRhdGFNYXApKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAoIW1ldGFkYXRhTWFwLmRlbGV0ZShtZXRhZGF0YUtleSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmIChtZXRhZGF0YU1hcC5zaXplID4gMClcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0TWV0YWRhdGEgPSBNZXRhZGF0YS5nZXQodGFyZ2V0KTtcclxuICAgICAgICAgICAgdGFyZ2V0TWV0YWRhdGEuZGVsZXRlKHByb3BlcnR5S2V5KTtcclxuICAgICAgICAgICAgaWYgKHRhcmdldE1ldGFkYXRhLnNpemUgPiAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIE1ldGFkYXRhLmRlbGV0ZSh0YXJnZXQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwb3J0ZXIoXCJkZWxldGVNZXRhZGF0YVwiLCBkZWxldGVNZXRhZGF0YSk7XHJcbiAgICAgICAgZnVuY3Rpb24gRGVjb3JhdGVDb25zdHJ1Y3RvcihkZWNvcmF0b3JzLCB0YXJnZXQpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkZWNvcmF0b3IgPSBkZWNvcmF0b3JzW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRlZCA9IGRlY29yYXRvcih0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChkZWNvcmF0ZWQpICYmICFJc051bGwoZGVjb3JhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNDb25zdHJ1Y3RvcihkZWNvcmF0ZWQpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID0gZGVjb3JhdGVkO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIERlY29yYXRlUHJvcGVydHkoZGVjb3JhdG9ycywgdGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRlY29yYXRvciA9IGRlY29yYXRvcnNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgZGVjb3JhdGVkID0gZGVjb3JhdG9yKHRhcmdldCwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFJc1VuZGVmaW5lZChkZWNvcmF0ZWQpICYmICFJc051bGwoZGVjb3JhdGVkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QoZGVjb3JhdGVkKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0b3IgPSBkZWNvcmF0ZWQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRlc2NyaXB0b3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgQ3JlYXRlKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXRNZXRhZGF0YSA9IE1ldGFkYXRhLmdldChPKTtcclxuICAgICAgICAgICAgaWYgKElzVW5kZWZpbmVkKHRhcmdldE1ldGFkYXRhKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFDcmVhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIHRhcmdldE1ldGFkYXRhID0gbmV3IF9NYXAoKTtcclxuICAgICAgICAgICAgICAgIE1ldGFkYXRhLnNldChPLCB0YXJnZXRNZXRhZGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhTWFwID0gdGFyZ2V0TWV0YWRhdGEuZ2V0KFApO1xyXG4gICAgICAgICAgICBpZiAoSXNVbmRlZmluZWQobWV0YWRhdGFNYXApKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIUNyZWF0ZSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgbWV0YWRhdGFNYXAgPSBuZXcgX01hcCgpO1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0TWV0YWRhdGEuc2V0KFAsIG1ldGFkYXRhTWFwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFNYXA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDMuMS4xLjEgT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUClcclxuICAgICAgICAvLyBodHRwczovL3JidWNrdG9uLmdpdGh1Yi5pby9yZWZsZWN0LW1ldGFkYXRhLyNvcmRpbmFyeWhhc21ldGFkYXRhXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUCkge1xyXG4gICAgICAgICAgICB2YXIgaGFzT3duID0gT3JkaW5hcnlIYXNPd25NZXRhZGF0YShNZXRhZGF0YUtleSwgTywgUCk7XHJcbiAgICAgICAgICAgIGlmIChoYXNPd24pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTyk7XHJcbiAgICAgICAgICAgIGlmICghSXNOdWxsKHBhcmVudCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlIYXNNZXRhZGF0YShNZXRhZGF0YUtleSwgcGFyZW50LCBQKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzLjEuMi4xIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEoTWV0YWRhdGFLZXksIE8sIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9yYnVja3Rvbi5naXRodWIuaW8vcmVmbGVjdC1tZXRhZGF0YS8jb3JkaW5hcnloYXNvd25tZXRhZGF0YVxyXG4gICAgICAgIGZ1bmN0aW9uIE9yZGluYXJ5SGFzT3duTWV0YWRhdGEoTWV0YWRhdGFLZXksIE8sIFApIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhTWFwID0gR2V0T3JDcmVhdGVNZXRhZGF0YU1hcChPLCBQLCAvKkNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgaWYgKElzVW5kZWZpbmVkKG1ldGFkYXRhTWFwKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgcmV0dXJuIFRvQm9vbGVhbihtZXRhZGF0YU1hcC5oYXMoTWV0YWRhdGFLZXkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjMuMSBPcmRpbmFyeUdldE1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5Z2V0bWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeUdldE1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBoYXNPd24gPSBPcmRpbmFyeUhhc093bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTtcclxuICAgICAgICAgICAgaWYgKGhhc093bilcclxuICAgICAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTyk7XHJcbiAgICAgICAgICAgIGlmICghSXNOdWxsKHBhcmVudCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT3JkaW5hcnlHZXRNZXRhZGF0YShNZXRhZGF0YUtleSwgcGFyZW50LCBQKTtcclxuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjQuMSBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5Z2V0b3dubWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChJc1VuZGVmaW5lZChtZXRhZGF0YU1hcCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXR1cm4gbWV0YWRhdGFNYXAuZ2V0KE1ldGFkYXRhS2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjUuMSBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlLCBPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5ZGVmaW5lb3dubWV0YWRhdGFcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeURlZmluZU93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlLCBPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyB0cnVlKTtcclxuICAgICAgICAgICAgbWV0YWRhdGFNYXAuc2V0KE1ldGFkYXRhS2V5LCBNZXRhZGF0YVZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gMy4xLjYuMSBPcmRpbmFyeU1ldGFkYXRhS2V5cyhPLCBQKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vcmJ1Y2t0b24uZ2l0aHViLmlvL3JlZmxlY3QtbWV0YWRhdGEvI29yZGluYXJ5bWV0YWRhdGFrZXlzXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlNZXRhZGF0YUtleXMoTywgUCkge1xyXG4gICAgICAgICAgICB2YXIgb3duS2V5cyA9IE9yZGluYXJ5T3duTWV0YWRhdGFLZXlzKE8sIFApO1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gT3JkaW5hcnlHZXRQcm90b3R5cGVPZihPKTtcclxuICAgICAgICAgICAgaWYgKHBhcmVudCA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBvd25LZXlzO1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50S2V5cyA9IE9yZGluYXJ5TWV0YWRhdGFLZXlzKHBhcmVudCwgUCk7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnRLZXlzLmxlbmd0aCA8PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG93bktleXM7XHJcbiAgICAgICAgICAgIGlmIChvd25LZXlzLmxlbmd0aCA8PSAwKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBhcmVudEtleXM7XHJcbiAgICAgICAgICAgIHZhciBzZXQgPSBuZXcgX1NldCgpO1xyXG4gICAgICAgICAgICB2YXIga2V5cyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIG93bktleXNfMSA9IG93bktleXM7IF9pIDwgb3duS2V5c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGtleSA9IG93bktleXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgaGFzS2V5ID0gc2V0LmhhcyhrZXkpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXNLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXQuYWRkKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICh2YXIgX2EgPSAwLCBwYXJlbnRLZXlzXzEgPSBwYXJlbnRLZXlzOyBfYSA8IHBhcmVudEtleXNfMS5sZW5ndGg7IF9hKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBwYXJlbnRLZXlzXzFbX2FdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhc0tleSA9IHNldC5oYXMoa2V5KTtcclxuICAgICAgICAgICAgICAgIGlmICghaGFzS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0LmFkZChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyAzLjEuNy4xIE9yZGluYXJ5T3duTWV0YWRhdGFLZXlzKE8sIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly9yYnVja3Rvbi5naXRodWIuaW8vcmVmbGVjdC1tZXRhZGF0YS8jb3JkaW5hcnlvd25tZXRhZGF0YWtleXNcclxuICAgICAgICBmdW5jdGlvbiBPcmRpbmFyeU93bk1ldGFkYXRhS2V5cyhPLCBQKSB7XHJcbiAgICAgICAgICAgIHZhciBrZXlzID0gW107XHJcbiAgICAgICAgICAgIHZhciBtZXRhZGF0YU1hcCA9IEdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoTywgUCwgLypDcmVhdGUqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChJc1VuZGVmaW5lZChtZXRhZGF0YU1hcCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5cztcclxuICAgICAgICAgICAgdmFyIGtleXNPYmogPSBtZXRhZGF0YU1hcC5rZXlzKCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVyYXRvciA9IEdldEl0ZXJhdG9yKGtleXNPYmopO1xyXG4gICAgICAgICAgICB2YXIgayA9IDA7XHJcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dCA9IEl0ZXJhdG9yU3RlcChpdGVyYXRvcik7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBrZXlzLmxlbmd0aCA9IGs7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGtleXM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFZhbHVlID0gSXRlcmF0b3JWYWx1ZShuZXh0KTtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAga2V5c1trXSA9IG5leHRWYWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgSXRlcmF0b3JDbG9zZShpdGVyYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGsrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA2IEVDTUFTY3JpcHQgRGF0YSBUeXAwZXMgYW5kIFZhbHVlc1xyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWVjbWFzY3JpcHQtZGF0YS10eXBlcy1hbmQtdmFsdWVzXHJcbiAgICAgICAgZnVuY3Rpb24gVHlwZSh4KSB7XHJcbiAgICAgICAgICAgIGlmICh4ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDEgLyogTnVsbCAqLztcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlb2YgeCkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInVuZGVmaW5lZFwiOiByZXR1cm4gMCAvKiBVbmRlZmluZWQgKi87XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOiByZXR1cm4gMiAvKiBCb29sZWFuICovO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOiByZXR1cm4gMyAvKiBTdHJpbmcgKi87XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwic3ltYm9sXCI6IHJldHVybiA0IC8qIFN5bWJvbCAqLztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjogcmV0dXJuIDUgLyogTnVtYmVyICovO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcIm9iamVjdFwiOiByZXR1cm4geCA9PT0gbnVsbCA/IDEgLyogTnVsbCAqLyA6IDYgLyogT2JqZWN0ICovO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIDYgLyogT2JqZWN0ICovO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS4xIFRoZSBVbmRlZmluZWQgVHlwZVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWVjbWFzY3JpcHQtbGFuZ3VhZ2UtdHlwZXMtdW5kZWZpbmVkLXR5cGVcclxuICAgICAgICBmdW5jdGlvbiBJc1VuZGVmaW5lZCh4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB4ID09PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS4yIFRoZSBOdWxsIFR5cGVcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzLW51bGwtdHlwZVxyXG4gICAgICAgIGZ1bmN0aW9uIElzTnVsbCh4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB4ID09PSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA2LjEuNSBUaGUgU3ltYm9sIFR5cGVcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzLXN5bWJvbC10eXBlXHJcbiAgICAgICAgZnVuY3Rpb24gSXNTeW1ib2woeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09IFwic3ltYm9sXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDYuMS43IFRoZSBPYmplY3QgVHlwZVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLW9iamVjdC10eXBlXHJcbiAgICAgICAgZnVuY3Rpb24gSXNPYmplY3QoeCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIHggPT09IFwib2JqZWN0XCIgPyB4ICE9PSBudWxsIDogdHlwZW9mIHggPT09IFwiZnVuY3Rpb25cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy4xIFR5cGUgQ29udmVyc2lvblxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXR5cGUtY29udmVyc2lvblxyXG4gICAgICAgIC8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXRvcHJpbWl0aXZlXHJcbiAgICAgICAgZnVuY3Rpb24gVG9QcmltaXRpdmUoaW5wdXQsIFByZWZlcnJlZFR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChUeXBlKGlucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwIC8qIFVuZGVmaW5lZCAqLzogcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICAgICAgY2FzZSAxIC8qIE51bGwgKi86IHJldHVybiBpbnB1dDtcclxuICAgICAgICAgICAgICAgIGNhc2UgMiAvKiBCb29sZWFuICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDMgLyogU3RyaW5nICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQgLyogU3ltYm9sICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDUgLyogTnVtYmVyICovOiByZXR1cm4gaW5wdXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGhpbnQgPSBQcmVmZXJyZWRUeXBlID09PSAzIC8qIFN0cmluZyAqLyA/IFwic3RyaW5nXCIgOiBQcmVmZXJyZWRUeXBlID09PSA1IC8qIE51bWJlciAqLyA/IFwibnVtYmVyXCIgOiBcImRlZmF1bHRcIjtcclxuICAgICAgICAgICAgdmFyIGV4b3RpY1RvUHJpbSA9IEdldE1ldGhvZChpbnB1dCwgdG9QcmltaXRpdmVTeW1ib2wpO1xyXG4gICAgICAgICAgICBpZiAoZXhvdGljVG9QcmltICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleG90aWNUb1ByaW0uY2FsbChpbnB1dCwgaGludCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBPcmRpbmFyeVRvUHJpbWl0aXZlKGlucHV0LCBoaW50ID09PSBcImRlZmF1bHRcIiA/IFwibnVtYmVyXCIgOiBoaW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy4xLjEuMSBPcmRpbmFyeVRvUHJpbWl0aXZlKE8sIGhpbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3JkaW5hcnl0b3ByaW1pdGl2ZVxyXG4gICAgICAgIGZ1bmN0aW9uIE9yZGluYXJ5VG9QcmltaXRpdmUoTywgaGludCkge1xyXG4gICAgICAgICAgICBpZiAoaGludCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvU3RyaW5nXzEgPSBPLnRvU3RyaW5nO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodG9TdHJpbmdfMSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdG9TdHJpbmdfMS5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZU9mID0gTy52YWx1ZU9mO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodmFsdWVPZikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdmFsdWVPZi5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZU9mID0gTy52YWx1ZU9mO1xyXG4gICAgICAgICAgICAgICAgaWYgKElzQ2FsbGFibGUodmFsdWVPZikpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdmFsdWVPZi5jYWxsKE8pO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghSXNPYmplY3QocmVzdWx0KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciB0b1N0cmluZ18yID0gTy50b1N0cmluZztcclxuICAgICAgICAgICAgICAgIGlmIChJc0NhbGxhYmxlKHRvU3RyaW5nXzIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRvU3RyaW5nXzIuY2FsbChPKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIUlzT2JqZWN0KHJlc3VsdCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjEuMiBUb0Jvb2xlYW4oYXJndW1lbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLzIwMTYvI3NlYy10b2Jvb2xlYW5cclxuICAgICAgICBmdW5jdGlvbiBUb0Jvb2xlYW4oYXJndW1lbnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICEhYXJndW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMS4xMiBUb1N0cmluZyhhcmd1bWVudClcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy10b3N0cmluZ1xyXG4gICAgICAgIGZ1bmN0aW9uIFRvU3RyaW5nKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIlwiICsgYXJndW1lbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMS4xNCBUb1Byb3BlcnR5S2V5KGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLXRvcHJvcGVydHlrZXlcclxuICAgICAgICBmdW5jdGlvbiBUb1Byb3BlcnR5S2V5KGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBUb1ByaW1pdGl2ZShhcmd1bWVudCwgMyAvKiBTdHJpbmcgKi8pO1xyXG4gICAgICAgICAgICBpZiAoSXNTeW1ib2woa2V5KSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgICAgIHJldHVybiBUb1N0cmluZyhrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIgVGVzdGluZyBhbmQgQ29tcGFyaXNvbiBPcGVyYXRpb25zXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtdGVzdGluZy1hbmQtY29tcGFyaXNvbi1vcGVyYXRpb25zXHJcbiAgICAgICAgLy8gNy4yLjIgSXNBcnJheShhcmd1bWVudClcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1pc2FycmF5XHJcbiAgICAgICAgZnVuY3Rpb24gSXNBcnJheShhcmd1bWVudCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheVxyXG4gICAgICAgICAgICAgICAgPyBBcnJheS5pc0FycmF5KGFyZ3VtZW50KVxyXG4gICAgICAgICAgICAgICAgOiBhcmd1bWVudCBpbnN0YW5jZW9mIE9iamVjdFxyXG4gICAgICAgICAgICAgICAgICAgID8gYXJndW1lbnQgaW5zdGFuY2VvZiBBcnJheVxyXG4gICAgICAgICAgICAgICAgICAgIDogT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZ3VtZW50KSA9PT0gXCJbb2JqZWN0IEFycmF5XVwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIuMyBJc0NhbGxhYmxlKGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWlzY2FsbGFibGVcclxuICAgICAgICBmdW5jdGlvbiBJc0NhbGxhYmxlKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgYW4gYXBwcm94aW1hdGlvbiBhcyB3ZSBjYW5ub3QgY2hlY2sgZm9yIFtbQ2FsbF1dIGludGVybmFsIG1ldGhvZC5cclxuICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmd1bWVudCA9PT0gXCJmdW5jdGlvblwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjIuNCBJc0NvbnN0cnVjdG9yKGFyZ3VtZW50KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWlzY29uc3RydWN0b3JcclxuICAgICAgICBmdW5jdGlvbiBJc0NvbnN0cnVjdG9yKGFyZ3VtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIE5PVEU6IFRoaXMgaXMgYW4gYXBwcm94aW1hdGlvbiBhcyB3ZSBjYW5ub3QgY2hlY2sgZm9yIFtbQ29uc3RydWN0XV0gaW50ZXJuYWwgbWV0aG9kLlxyXG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3VtZW50ID09PSBcImZ1bmN0aW9uXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDcuMi43IElzUHJvcGVydHlLZXkoYXJndW1lbnQpXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtaXNwcm9wZXJ0eWtleVxyXG4gICAgICAgIGZ1bmN0aW9uIElzUHJvcGVydHlLZXkoYXJndW1lbnQpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChUeXBlKGFyZ3VtZW50KSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAzIC8qIFN0cmluZyAqLzogcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQgLyogU3ltYm9sICovOiByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjMgT3BlcmF0aW9ucyBvbiBPYmplY3RzXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3BlcmF0aW9ucy1vbi1vYmplY3RzXHJcbiAgICAgICAgLy8gNy4zLjkgR2V0TWV0aG9kKFYsIFApXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtZ2V0bWV0aG9kXHJcbiAgICAgICAgZnVuY3Rpb24gR2V0TWV0aG9kKFYsIFApIHtcclxuICAgICAgICAgICAgdmFyIGZ1bmMgPSBWW1BdO1xyXG4gICAgICAgICAgICBpZiAoZnVuYyA9PT0gdW5kZWZpbmVkIHx8IGZ1bmMgPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICBpZiAoIUlzQ2FsbGFibGUoZnVuYykpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyA3LjQgT3BlcmF0aW9ucyBvbiBJdGVyYXRvciBPYmplY3RzXHJcbiAgICAgICAgLy8gaHR0cHM6Ly90YzM5LmdpdGh1Yi5pby9lY21hMjYyLyNzZWMtb3BlcmF0aW9ucy1vbi1pdGVyYXRvci1vYmplY3RzXHJcbiAgICAgICAgZnVuY3Rpb24gR2V0SXRlcmF0b3Iob2JqKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXRob2QgPSBHZXRNZXRob2Qob2JqLCBpdGVyYXRvclN5bWJvbCk7XHJcbiAgICAgICAgICAgIGlmICghSXNDYWxsYWJsZShtZXRob2QpKVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOyAvLyBmcm9tIENhbGxcclxuICAgICAgICAgICAgdmFyIGl0ZXJhdG9yID0gbWV0aG9kLmNhbGwob2JqKTtcclxuICAgICAgICAgICAgaWYgKCFJc09iamVjdChpdGVyYXRvcikpXHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVyYXRvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjQgSXRlcmF0b3JWYWx1ZShpdGVyUmVzdWx0KVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8yMDE2LyNzZWMtaXRlcmF0b3J2YWx1ZVxyXG4gICAgICAgIGZ1bmN0aW9uIEl0ZXJhdG9yVmFsdWUoaXRlclJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlclJlc3VsdC52YWx1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjUgSXRlcmF0b3JTdGVwKGl0ZXJhdG9yKVxyXG4gICAgICAgIC8vIGh0dHBzOi8vdGMzOS5naXRodWIuaW8vZWNtYTI2Mi8jc2VjLWl0ZXJhdG9yc3RlcFxyXG4gICAgICAgIGZ1bmN0aW9uIEl0ZXJhdG9yU3RlcChpdGVyYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LmRvbmUgPyBmYWxzZSA6IHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbilcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1pdGVyYXRvcmNsb3NlXHJcbiAgICAgICAgZnVuY3Rpb24gSXRlcmF0b3JDbG9zZShpdGVyYXRvcikge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGl0ZXJhdG9yW1wicmV0dXJuXCJdO1xyXG4gICAgICAgICAgICBpZiAoZilcclxuICAgICAgICAgICAgICAgIGYuY2FsbChpdGVyYXRvcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIDkuMSBPcmRpbmFyeSBPYmplY3QgSW50ZXJuYWwgTWV0aG9kcyBhbmQgSW50ZXJuYWwgU2xvdHNcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1vcmRpbmFyeS1vYmplY3QtaW50ZXJuYWwtbWV0aG9kcy1hbmQtaW50ZXJuYWwtc2xvdHNcclxuICAgICAgICAvLyA5LjEuMS4xIE9yZGluYXJ5R2V0UHJvdG90eXBlT2YoTylcclxuICAgICAgICAvLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL2VjbWEyNjIvI3NlYy1vcmRpbmFyeWdldHByb3RvdHlwZW9mXHJcbiAgICAgICAgZnVuY3Rpb24gT3JkaW5hcnlHZXRQcm90b3R5cGVPZihPKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihPKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBPICE9PSBcImZ1bmN0aW9uXCIgfHwgTyA9PT0gZnVuY3Rpb25Qcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIFR5cGVTY3JpcHQgZG9lc24ndCBzZXQgX19wcm90b19fIGluIEVTNSwgYXMgaXQncyBub24tc3RhbmRhcmQuXHJcbiAgICAgICAgICAgIC8vIFRyeSB0byBkZXRlcm1pbmUgdGhlIHN1cGVyY2xhc3MgY29uc3RydWN0b3IuIENvbXBhdGlibGUgaW1wbGVtZW50YXRpb25zXHJcbiAgICAgICAgICAgIC8vIG11c3QgZWl0aGVyIHNldCBfX3Byb3RvX18gb24gYSBzdWJjbGFzcyBjb25zdHJ1Y3RvciB0byB0aGUgc3VwZXJjbGFzcyBjb25zdHJ1Y3RvcixcclxuICAgICAgICAgICAgLy8gb3IgZW5zdXJlIGVhY2ggY2xhc3MgaGFzIGEgdmFsaWQgYGNvbnN0cnVjdG9yYCBwcm9wZXJ0eSBvbiBpdHMgcHJvdG90eXBlIHRoYXRcclxuICAgICAgICAgICAgLy8gcG9pbnRzIGJhY2sgdG8gdGhlIGNvbnN0cnVjdG9yLlxyXG4gICAgICAgICAgICAvLyBJZiB0aGlzIGlzIG5vdCB0aGUgc2FtZSBhcyBGdW5jdGlvbi5bW1Byb3RvdHlwZV1dLCB0aGVuIHRoaXMgaXMgZGVmaW5hdGVseSBpbmhlcml0ZWQuXHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlbiBpbiBFUzYgb3Igd2hlbiB1c2luZyBfX3Byb3RvX18gaW4gYSBjb21wYXRpYmxlIGJyb3dzZXIuXHJcbiAgICAgICAgICAgIGlmIChwcm90byAhPT0gZnVuY3Rpb25Qcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBzdXBlciBwcm90b3R5cGUgaXMgT2JqZWN0LnByb3RvdHlwZSwgbnVsbCwgb3IgdW5kZWZpbmVkLCB0aGVuIHdlIGNhbm5vdCBkZXRlcm1pbmUgdGhlIGhlcml0YWdlLlxyXG4gICAgICAgICAgICB2YXIgcHJvdG90eXBlID0gTy5wcm90b3R5cGU7XHJcbiAgICAgICAgICAgIHZhciBwcm90b3R5cGVQcm90byA9IHByb3RvdHlwZSAmJiBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG90eXBlKTtcclxuICAgICAgICAgICAgaWYgKHByb3RvdHlwZVByb3RvID09IG51bGwgfHwgcHJvdG90eXBlUHJvdG8gPT09IE9iamVjdC5wcm90b3R5cGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBjb25zdHJ1Y3RvciB3YXMgbm90IGEgZnVuY3Rpb24sIHRoZW4gd2UgY2Fubm90IGRldGVybWluZSB0aGUgaGVyaXRhZ2UuXHJcbiAgICAgICAgICAgIHZhciBjb25zdHJ1Y3RvciA9IHByb3RvdHlwZVByb3RvLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnN0cnVjdG9yICE9PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgc29tZSBraW5kIG9mIHNlbGYtcmVmZXJlbmNlLCB0aGVuIHdlIGNhbm5vdCBkZXRlcm1pbmUgdGhlIGhlcml0YWdlLlxyXG4gICAgICAgICAgICBpZiAoY29uc3RydWN0b3IgPT09IE8pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvdG87XHJcbiAgICAgICAgICAgIC8vIHdlIGhhdmUgYSBwcmV0dHkgZ29vZCBndWVzcyBhdCB0aGUgaGVyaXRhZ2UuXHJcbiAgICAgICAgICAgIHJldHVybiBjb25zdHJ1Y3RvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gbmFpdmUgTWFwIHNoaW1cclxuICAgICAgICBmdW5jdGlvbiBDcmVhdGVNYXBQb2x5ZmlsbCgpIHtcclxuICAgICAgICAgICAgdmFyIGNhY2hlU2VudGluZWwgPSB7fTtcclxuICAgICAgICAgICAgdmFyIGFycmF5U2VudGluZWwgPSBbXTtcclxuICAgICAgICAgICAgdmFyIE1hcEl0ZXJhdG9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIE1hcEl0ZXJhdG9yKGtleXMsIHZhbHVlcywgc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGtleXM7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gdmFsdWVzO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBNYXBJdGVyYXRvci5wcm90b3R5cGVbXCJAQGl0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfTtcclxuICAgICAgICAgICAgICAgIE1hcEl0ZXJhdG9yLnByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9O1xyXG4gICAgICAgICAgICAgICAgTWFwSXRlcmF0b3IucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5faW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDAgJiYgaW5kZXggPCB0aGlzLl9rZXlzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fc2VsZWN0b3IodGhpcy5fa2V5c1tpbmRleF0sIHRoaXMuX3ZhbHVlc1tpbmRleF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggKyAxID49IHRoaXMuX2tleXMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMgPSBhcnJheVNlbnRpbmVsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogcmVzdWx0LCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgTWFwSXRlcmF0b3IucHJvdG90eXBlLnRocm93ID0gZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2luZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5kZXggPSAtMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlcyA9IGFycmF5U2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIE1hcEl0ZXJhdG9yLnByb3RvdHlwZS5yZXR1cm4gPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbmRleCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gYXJyYXlTZW50aW5lbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gYXJyYXlTZW50aW5lbDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHZhbHVlLCBkb25lOiB0cnVlIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hcEl0ZXJhdG9yO1xyXG4gICAgICAgICAgICB9KCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIE1hcCgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVLZXkgPSBjYWNoZVNlbnRpbmVsO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSAtMjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXAucHJvdG90eXBlLCBcInNpemVcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fa2V5cy5sZW5ndGg7IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAoa2V5KSB7IHJldHVybiB0aGlzLl9maW5kKGtleSwgLyppbnNlcnQqLyBmYWxzZSkgPj0gMDsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmQoa2V5LCAvKmluc2VydCovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXggPj0gMCA/IHRoaXMuX3ZhbHVlc1tpbmRleF0gOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmQoa2V5LCAvKmluc2VydCovIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlc1tpbmRleF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSB0aGlzLl9maW5kKGtleSwgLyppbnNlcnQqLyBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpemUgPSB0aGlzLl9rZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IGluZGV4ICsgMTsgaSA8IHNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5c1tpIC0gMV0gPSB0aGlzLl9rZXlzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdmFsdWVzW2kgLSAxXSA9IHRoaXMuX3ZhbHVlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXlzLmxlbmd0aC0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoLS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkgPT09IHRoaXMuX2NhY2hlS2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlU2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUluZGV4ID0gLTI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleXMubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl92YWx1ZXMubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWNoZUtleSA9IGNhY2hlU2VudGluZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FjaGVJbmRleCA9IC0yO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldEtleSk7IH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlLnZhbHVlcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldFZhbHVlKTsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5ldyBNYXBJdGVyYXRvcih0aGlzLl9rZXlzLCB0aGlzLl92YWx1ZXMsIGdldEVudHJ5KTsgfTtcclxuICAgICAgICAgICAgICAgIE1hcC5wcm90b3R5cGVbXCJAQGl0ZXJhdG9yXCJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5lbnRyaWVzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBNYXAucHJvdG90eXBlW2l0ZXJhdG9yU3ltYm9sXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZW50cmllcygpOyB9O1xyXG4gICAgICAgICAgICAgICAgTWFwLnByb3RvdHlwZS5fZmluZCA9IGZ1bmN0aW9uIChrZXksIGluc2VydCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYWNoZUtleSAhPT0ga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSB0aGlzLl9rZXlzLmluZGV4T2YodGhpcy5fY2FjaGVLZXkgPSBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY2FjaGVJbmRleCA8IDAgJiYgaW5zZXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhY2hlSW5kZXggPSB0aGlzLl9rZXlzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fa2V5cy5wdXNoKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlcy5wdXNoKHVuZGVmaW5lZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9jYWNoZUluZGV4O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXA7XHJcbiAgICAgICAgICAgIH0oKSk7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGdldEtleShrZXksIF8pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gZ2V0VmFsdWUoXywgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBnZXRFbnRyeShrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW2tleSwgdmFsdWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG5haXZlIFNldCBzaGltXHJcbiAgICAgICAgZnVuY3Rpb24gQ3JlYXRlU2V0UG9seWZpbGwoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gU2V0KCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21hcCA9IG5ldyBfTWFwKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2V0LnByb3RvdHlwZSwgXCJzaXplXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5zaXplOyB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB0aGlzLl9tYXAuaGFzKHZhbHVlKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB0aGlzLl9tYXAuc2V0KHZhbHVlLCB2YWx1ZSksIHRoaXM7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdGhpcy5fbWFwLmRlbGV0ZSh2YWx1ZSk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgeyB0aGlzLl9tYXAuY2xlYXIoKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUua2V5cyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5rZXlzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlLnZhbHVlcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC52YWx1ZXMoKTsgfTtcclxuICAgICAgICAgICAgICAgIFNldC5wcm90b3R5cGUuZW50cmllcyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX21hcC5lbnRyaWVzKCk7IH07XHJcbiAgICAgICAgICAgICAgICBTZXQucHJvdG90eXBlW1wiQEBpdGVyYXRvclwiXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMua2V5cygpOyB9O1xyXG4gICAgICAgICAgICAgICAgU2V0LnByb3RvdHlwZVtpdGVyYXRvclN5bWJvbF0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmtleXMoKTsgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBTZXQ7XHJcbiAgICAgICAgICAgIH0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG5haXZlIFdlYWtNYXAgc2hpbVxyXG4gICAgICAgIGZ1bmN0aW9uIENyZWF0ZVdlYWtNYXBQb2x5ZmlsbCgpIHtcclxuICAgICAgICAgICAgdmFyIFVVSURfU0laRSA9IDE2O1xyXG4gICAgICAgICAgICB2YXIga2V5cyA9IEhhc2hNYXAuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZhciByb290S2V5ID0gQ3JlYXRlVW5pcXVlS2V5KCk7XHJcbiAgICAgICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gV2Vha01hcCgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9rZXkgPSBDcmVhdGVVbmlxdWVLZXkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFdlYWtNYXAucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGUgPSBHZXRPckNyZWF0ZVdlYWtNYXBUYWJsZSh0YXJnZXQsIC8qY3JlYXRlKi8gZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0YWJsZSAhPT0gdW5kZWZpbmVkID8gSGFzaE1hcC5oYXModGFibGUsIHRoaXMuX2tleSkgOiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBXZWFrTWFwLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGUgIT09IHVuZGVmaW5lZCA/IEhhc2hNYXAuZ2V0KHRhYmxlLCB0aGlzLl9rZXkpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIFdlYWtNYXAucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICh0YXJnZXQsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhYmxlW3RoaXMuX2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICBXZWFrTWFwLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlID0gR2V0T3JDcmVhdGVXZWFrTWFwVGFibGUodGFyZ2V0LCAvKmNyZWF0ZSovIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGUgIT09IHVuZGVmaW5lZCA/IGRlbGV0ZSB0YWJsZVt0aGlzLl9rZXldIDogZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgV2Vha01hcC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogbm90IGEgcmVhbCBjbGVhciwganVzdCBtYWtlcyB0aGUgcHJldmlvdXMgZGF0YSB1bnJlYWNoYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2tleSA9IENyZWF0ZVVuaXF1ZUtleSgpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBXZWFrTWFwO1xyXG4gICAgICAgICAgICB9KCkpO1xyXG4gICAgICAgICAgICBmdW5jdGlvbiBDcmVhdGVVbmlxdWVLZXkoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIga2V5O1xyXG4gICAgICAgICAgICAgICAgZG9cclxuICAgICAgICAgICAgICAgICAgICBrZXkgPSBcIkBAV2Vha01hcEBAXCIgKyBDcmVhdGVVVUlEKCk7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoSGFzaE1hcC5oYXMoa2V5cywga2V5KSk7XHJcbiAgICAgICAgICAgICAgICBrZXlzW2tleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBHZXRPckNyZWF0ZVdlYWtNYXBUYWJsZSh0YXJnZXQsIGNyZWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXNPd24uY2FsbCh0YXJnZXQsIHJvb3RLZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjcmVhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcm9vdEtleSwgeyB2YWx1ZTogSGFzaE1hcC5jcmVhdGUoKSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXRbcm9vdEtleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gRmlsbFJhbmRvbUJ5dGVzKGJ1ZmZlciwgc2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpXHJcbiAgICAgICAgICAgICAgICAgICAgYnVmZmVyW2ldID0gTWF0aC5yYW5kb20oKSAqIDB4ZmYgfCAwO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmdW5jdGlvbiBHZW5SYW5kb21CeXRlcyhzaXplKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIFVpbnQ4QXJyYXkgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY3J5cHRvICE9PSBcInVuZGVmaW5lZFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShzaXplKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtc0NyeXB0byAhPT0gXCJ1bmRlZmluZWRcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcyhuZXcgVWludDhBcnJheShzaXplKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZpbGxSYW5kb21CeXRlcyhuZXcgVWludDhBcnJheShzaXplKSwgc2l6ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gRmlsbFJhbmRvbUJ5dGVzKG5ldyBBcnJheShzaXplKSwgc2l6ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZnVuY3Rpb24gQ3JlYXRlVVVJRCgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gR2VuUmFuZG9tQnl0ZXMoVVVJRF9TSVpFKTtcclxuICAgICAgICAgICAgICAgIC8vIG1hcmsgYXMgcmFuZG9tIC0gUkZDIDQxMjIgwqcgNC40XHJcbiAgICAgICAgICAgICAgICBkYXRhWzZdID0gZGF0YVs2XSAmIDB4NGYgfCAweDQwO1xyXG4gICAgICAgICAgICAgICAgZGF0YVs4XSA9IGRhdGFbOF0gJiAweGJmIHwgMHg4MDtcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgVVVJRF9TSVpFOyArK29mZnNldCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBieXRlID0gZGF0YVtvZmZzZXRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgPT09IDQgfHwgb2Zmc2V0ID09PSA2IHx8IG9mZnNldCA9PT0gOClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IFwiLVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChieXRlIDwgMTYpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBcIjBcIjtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gYnl0ZS50b1N0cmluZygxNikudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gdXNlcyBhIGhldXJpc3RpYyB1c2VkIGJ5IHY4IGFuZCBjaGFrcmEgdG8gZm9yY2UgYW4gb2JqZWN0IGludG8gZGljdGlvbmFyeSBtb2RlLlxyXG4gICAgICAgIGZ1bmN0aW9uIE1ha2VEaWN0aW9uYXJ5KG9iaikge1xyXG4gICAgICAgICAgICBvYmouX18gPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBvYmouX187XHJcbiAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pKF9SZWZsZWN0IHx8IChfUmVmbGVjdCA9IHt9KSk7XHJcbi8vIEhhY2sgZm9yIHd4IG1pbmlwcm9ncmFtXHJcbnRyeVxyXG57XHJcbiAgICBpZihSZWZsZWN0ICE9PSBfUmVmbGVjdCkgcm9vdGFnZSgpO1xyXG59XHJcbmNhdGNoKGVycilcclxue1xyXG4gICAgcm9vdGFnZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByb290YWdlKClcclxue1xyXG4gICAgdmFyIHJvb3QgPSB3aW5kb3cgfHwgZ2xvYmFsO1xyXG4gICAgaWYocm9vdCkgcm9vdC5SZWZsZWN0ID0gX1JlZmxlY3Q7XHJcbn1cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UmVmbGVjdC5qcy5tYXBcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9saWJzL1JlZmxlY3QuanNcbi8vIG1vZHVsZSBpZCA9IDEzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgQ29yZU1lc3NhZ2UgZnJvbSBcIi4uLy4uL2NvcmUvbWVzc2FnZS9Db3JlTWVzc2FnZVwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tICcuLi8uLi91dGlscy9EaWN0aW9uYXJ5JztcclxuaW1wb3J0IHsgZXh0ZW5kT2JqZWN0IH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IHsgbWFza01hbmFnZXIgfSBmcm9tIFwiLi4vbWFzay9NYXNrTWFuYWdlclwiO1xyXG5pbXBvcnQgTmV0TWVzc2FnZSBmcm9tIFwiLi9OZXRNZXNzYWdlXCI7XHJcbmltcG9ydCBSZXF1ZXN0RGF0YSwgeyBjb21tb25EYXRhIH0gZnJvbSBcIi4vUmVxdWVzdERhdGFcIjtcclxudmFyIE5ldE1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOZXRNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlTGlzdGVuZXJzID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICBjb3JlLmxpc3RlbihDb3JlTWVzc2FnZS5NRVNTQUdFX0RJU1BBVENIRUQsIHRoaXMub25Nc2dEaXNwYXRjaGVkLCBjb3JlKTtcclxuICAgIH1cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLm9uTXNnRGlzcGF0Y2hlZCA9IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IHRoaXMub2JzZXJ2YWJsZTtcclxuICAgICAgICAvLyDlpoLmnpzmtojmga/mmK/pgJrorq/mtojmga/liJnlgZrlpITnkIZcclxuICAgICAgICBpZiAobXNnIGluc3RhbmNlb2YgUmVxdWVzdERhdGEpIHtcclxuICAgICAgICAgICAgLy8g5re75Yqg6YGu572pXHJcbiAgICAgICAgICAgIGlmIChtc2cuX191c2VNYXNrKVxyXG4gICAgICAgICAgICAgICAgbWFza01hbmFnZXIuc2hvd0xvYWRpbmcobnVsbCwgXCJuZXRcIik7XHJcbiAgICAgICAgICAgIC8vIOaMh+Wumua2iOaBr+WPguaVsOi/nuaOpeS4iuWFrOWFseWPguaVsOS9nOS4uuWPguaVsFxyXG4gICAgICAgICAgICBleHRlbmRPYmplY3QobXNnLl9fcGFyYW1zLmRhdGEsIGNvbW1vbkRhdGEpO1xyXG4gICAgICAgICAgICAvLyDlj5HpgIHmtojmga9cclxuICAgICAgICAgICAgbXNnLl9fcG9saWN5LnNlbmRSZXF1ZXN0KG1zZyk7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkeezu+e7n+a2iOaBr1xyXG4gICAgICAgICAgICBvYnNlcnZhYmxlLmRpc3BhdGNoKE5ldE1lc3NhZ2UuTkVUX1JFUVVFU1QsIG1zZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5rOo5YaM5LiA5Liq6L+U5Zue57uT5p6E5L2TXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJUmVzcG9uc2VEYXRhQ29uc3RydWN0b3J9IGNscyDov5Tlm57nu5PmnoTkvZPmnoTpgKDlmahcclxuICAgICAqIEBtZW1iZXJvZiBOZXRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VEaWN0W2Nscy50eXBlXSA9IGNscztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOS4gOS4qumAmuiur+i/lOWbnuebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KElSZXNwb25zZURhdGFDb25zdHJ1Y3RvcnxzdHJpbmcpfSBjbHNPclR5cGUg6KaB55uR5ZCs55qE6L+U5Zue57uT5p6E5p6E6YCg5Zmo5oiW6ICF57G75Z6L5a2X56ym5LiyXHJcbiAgICAgKiBAcGFyYW0ge1Jlc3BvbnNlSGFuZGxlcn0gaGFuZGxlciDlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9ZmFsc2VdIOaYr+WQpuS4gOasoeaAp+ebkeWQrFxyXG4gICAgICogQHBhcmFtIHtJT2JzZXJ2YWJsZX0gW29ic2VydmFibGVdIOimgeWPkemAgeWIsOeahOWGheaguFxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgTmV0TWFuYWdlci5wcm90b3R5cGUubGlzdGVuUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2xzT3JUeXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlLCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIGNscyA9ICh0eXBlb2YgY2xzT3JUeXBlID09IFwic3RyaW5nXCIgPyB0aGlzLl9yZXNwb25zZURpY3RbY2xzT3JUeXBlXSA6IGNsc09yVHlwZSk7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX3Jlc3BvbnNlTGlzdGVuZXJzLmdldChjbHMpO1xyXG4gICAgICAgIGlmICghbGlzdGVuZXJzKVxyXG4gICAgICAgICAgICB0aGlzLl9yZXNwb25zZUxpc3RlbmVycy5zZXQoY2xzLCBsaXN0ZW5lcnMgPSBbXSk7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaXN0ZW5lcnNfMSA9IGxpc3RlbmVyczsgX2kgPCBsaXN0ZW5lcnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzXzFbX2ldO1xyXG4gICAgICAgICAgICBpZiAoaGFuZGxlciA9PSBsaXN0ZW5lclswXSAmJiB0aGlzQXJnID09IGxpc3RlbmVyWzFdICYmIG9uY2UgPT0gbGlzdGVuZXJbMl0pXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxpc3RlbmVycy5wdXNoKFtoYW5kbGVyLCB0aGlzQXJnLCBvbmNlLCBvYnNlcnZhYmxlXSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTkuIDkuKrpgJrorq/ov5Tlm57nm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhJUmVzcG9uc2VEYXRhQ29uc3RydWN0b3J8c3RyaW5nKX0gY2xzT3JUeXBlIOimgeenu+mZpOebkeWQrOeahOi/lOWbnue7k+aehOaehOmAoOWZqOaIluiAheexu+Wei+Wtl+espuS4slxyXG4gICAgICogQHBhcmFtIHtSZXNwb25zZUhhbmRsZXJ9IGhhbmRsZXIg5Zue6LCD5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvbmNlPWZhbHNlXSDmmK/lkKbkuIDmrKHmgKfnm5HlkKxcclxuICAgICAqIEBwYXJhbSB7SU9ic2VydmFibGV9IFtvYnNlcnZhYmxlXSDopoHlj5HpgIHliLDnmoTlhoXmoLhcclxuICAgICAqIEBtZW1iZXJvZiBOZXRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLnVubGlzdGVuUmVzcG9uc2UgPSBmdW5jdGlvbiAoY2xzT3JUeXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlLCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIGNscyA9ICh0eXBlb2YgY2xzT3JUeXBlID09IFwic3RyaW5nXCIgPyB0aGlzLl9yZXNwb25zZURpY3RbY2xzT3JUeXBlXSA6IGNsc09yVHlwZSk7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX3Jlc3BvbnNlTGlzdGVuZXJzLmdldChjbHMpO1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gbGlzdGVuZXJzW2ldO1xyXG4gICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIgPT0gbGlzdGVuZXJbMF0gJiYgdGhpc0FyZyA9PSBsaXN0ZW5lclsxXSAmJiBvbmNlID09IGxpc3RlbmVyWzJdICYmIG9ic2VydmFibGUgPT0gbGlzdGVuZXJbM10pIHtcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcnMuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Y+R6YCB5aSa5p2h6K+35rGC77yM5bm25LiU562J5b6F6L+U5Zue57uT5p6c77yI5aaC5p6c5pyJ55qE6K+d77yJ77yM6LCD55So5Zue6LCDXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtSZXF1ZXN0RGF0YVtdfSBbcmVxdWVzdHNdIOimgeWPkemAgeeahOivt+axguWIl+ihqFxyXG4gICAgICogQHBhcmFtIHsocmVzcG9uc2VzPzpSZXNwb25zZURhdGFbXXxFcnJvcik9PnZvaWR9IFtoYW5kbGVyXSDmlLbliLDov5Tlm57nu5PmnpzmiJbplJnor6/lkI7nmoTlm57osIPlh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJFcclxuICAgICAqIEBwYXJhbSB7SU9ic2VydmFibGV9IFtvYnNlcnZhYmxlXSDopoHlj5HpgIHliLDnmoTlhoXmoLhcclxuICAgICAqIEBtZW1iZXJvZiBOZXRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLnNlbmRNdWx0aVJlcXVlc3RzID0gZnVuY3Rpb24gKHJlcXVlc3RzLCBoYW5kbGVyLCB0aGlzQXJnLCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXNwb25zZXMgPSBbXTtcclxuICAgICAgICB2YXIgbGVmdFJlc0NvdW50ID0gMDtcclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHJlcXVlc3RzIHx8IFtdOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gcmVxdWVzdC5fX3BhcmFtcy5yZXNwb25zZTtcclxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDnm5HlkKzkuIDmrKHmgKfov5Tlm55cclxuICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuUmVzcG9uc2UocmVzcG9uc2UsIG9uUmVzcG9uc2UsIHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgLy8g6K6w5b2V6L+U5Zue55uR5ZCsXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZXMucHVzaChyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDorrDlvZXmlbDph49cclxuICAgICAgICAgICAgICAgIGxlZnRSZXNDb3VudCsrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOWPkemAgeivt+axglxyXG4gICAgICAgICAgICBvYnNlcnZhYmxlLmRpc3BhdGNoKHJlcXVlc3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmtYvor5Xlm57osINcclxuICAgICAgICB0ZXN0Q2FsbGJhY2soKTtcclxuICAgICAgICBmdW5jdGlvbiBvblJlc3BvbnNlKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZSBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlh7rplJnkuobvvIznm7TmjqXosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIgJiYgaGFuZGxlci5jYWxsKHRoaXNBcmcsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaIkOWKn+S6hlxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHJlc3BvbnNlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcmVzcG9uc2VzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRlbXAgPT0gcmVzcG9uc2UuY29uc3RydWN0b3IgJiYgdGhpcyA9PT0gcmVzcG9uc2UuX19wYXJhbXMucmVxdWVzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnVubGlzdGVuUmVzcG9uc2UodGVtcCwgb25SZXNwb25zZSwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlc1trZXldID0gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnRSZXNDb3VudC0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmtYvor5Xlm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVzdENhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiB0ZXN0Q2FsbGJhY2soKSB7XHJcbiAgICAgICAgICAgIC8vIOWIpOaWreaYr+WQpuWFqOmDqOabv+aNouWujOavlVxyXG4gICAgICAgICAgICBpZiAobGVmdFJlc0NvdW50IDw9IDApIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIgJiYgaGFuZGxlci5jYWxsKHRoaXNBcmcsIHJlc3BvbnNlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvILmraXniYjmnKznmoRzZW5kTXVsdGlSZXF1ZXN0c1xyXG4gICAgICpcclxuICAgICAqIEBhdXRob3IgUmF5a2lkXHJcbiAgICAgKiBAZGF0ZSAyMDE5LTAzLTA4XHJcbiAgICAgKiBAcGFyYW0ge1JlcXVlc3REYXRhW119IFtyZXF1ZXN0c10g6KaB5Y+R6YCB55qE6K+35rGC5YiX6KGoXHJcbiAgICAgKiBAcGFyYW0ge0lPYnNlcnZhYmxlfSBbb2JzZXJ2YWJsZV0g6KaB5Y+R6YCB5Yiw55qE5YaF5qC4XHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtjYW5SZWplY3Q9ZmFsc2VdIOaYr+WQpuWFgeiuuHJlamVjdO+8jOm7mOiupGZhbHNl77yM5Y2z5YWB6K646YeN6K+VXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxSZXNwb25zZURhdGFbXT59IOi/lOWbnuS4gOS4qlByb21pc2XnlKjkuo7lvILmraXnm5HlkKzlm57osINcclxuICAgICAqIEBtZW1iZXJvZiBOZXRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLnNlbmRNdWx0aVJlcXVlc3RzQXN5bmMgPSBmdW5jdGlvbiAocmVxdWVzdHMsIG9ic2VydmFibGUsIGNhblJlamVjdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGNhblJlamVjdCA9PT0gdm9pZCAwKSB7IGNhblJlamVjdCA9IGZhbHNlOyB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgX3RoaXMuc2VuZE11bHRpUmVxdWVzdHMocmVxdWVzdHMsIGZ1bmN0aW9uIChyZXNwb25zZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZXMgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmUmeivr1xyXG4gICAgICAgICAgICAgICAgICAgIGNhblJlamVjdCAmJiByZWplY3QocmVzcG9uc2VzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOato+ehrlxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2VzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgX3RoaXMsIG9ic2VydmFibGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKiDov5nph4zlr7zlh7rkuI3luIzmnJvnlKjmiLfkvb/nlKjnmoTmlrnms5XvvIzkvpvmoYbmnrblhoXkvb/nlKggKi9cclxuICAgIE5ldE1hbmFnZXIucHJvdG90eXBlLl9fb25SZXNwb25zZSA9IGZ1bmN0aW9uIChyZXNwb25zZUNscywgcmVzdWx0LCByZXF1ZXN0KSB7XHJcbiAgICAgICAgLy8g56e76Zmk6YGu572pXHJcbiAgICAgICAgaWYgKHJlcXVlc3QgJiYgcmVxdWVzdC5fX3VzZU1hc2spXHJcbiAgICAgICAgICAgIG1hc2tNYW5hZ2VyLmhpZGVMb2FkaW5nKFwibmV0XCIpO1xyXG4gICAgICAgIC8vIOino+aekOe7k+aenFxyXG4gICAgICAgIGlmIChyZXNwb25zZUNscykge1xyXG4gICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBuZXcgcmVzcG9uc2VDbHMoKTtcclxuICAgICAgICAgICAgLy8g5omn6KGM6Kej5p6QXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLnBhcnNlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9rumFjeWvueivt+axguWSjOWPkemAgeWGheaguFxyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICAgICAgaWYgKHJlcXVlc3QpIHtcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLl9fcGFyYW1zLnJlcXVlc3QgPSByZXF1ZXN0O1xyXG4gICAgICAgICAgICAgICAgLy8g55Sx5LiK6Iez5LiL5om+5Yiw5pyA6L+c55qE5LiA5Liq5pyJ5pWI5YaF5qC4XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gcmVxdWVzdC5fX29ic2VydmFibGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXAgPSByZXF1ZXN0Ll9fb2JzZXJ2YWJsZXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wIHx8IHRlbXAuZGlzcG9zZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2YWJsZSA9IHRlbXA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5rS+5Y+R5LqL5Lu2XHJcbiAgICAgICAgICAgIG9ic2VydmFibGUuZGlzcGF0Y2goTmV0TWVzc2FnZS5ORVRfUkVTUE9OU0UsIHJlc3BvbnNlLCByZXF1ZXN0KTtcclxuICAgICAgICAgICAgLy8g6YCS5b2S5aSE55CG5LqL5Lu255uR5ZCsXHJcbiAgICAgICAgICAgIHRoaXMucmVjdXJzZVJlc3BvbnNlKHJlc3BvbnNlQ2xzLCByZXNwb25zZSwgcmVxdWVzdCwgb2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCLmsqHmnInmib7liLDov5Tlm57nu5PmnoTkvZPlrprkuYnvvJpcIiArIHJlc3BvbnNlQ2xzLnR5cGUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBOZXRNYW5hZ2VyLnByb3RvdHlwZS5fX29uRXJyb3IgPSBmdW5jdGlvbiAocmVzcG9uc2VDbHMsIGVyciwgcmVxdWVzdCkge1xyXG4gICAgICAgIC8vIOenu+mZpOmBrue9qVxyXG4gICAgICAgIGlmIChyZXF1ZXN0ICYmIHJlcXVlc3QuX191c2VNYXNrKVxyXG4gICAgICAgICAgICBtYXNrTWFuYWdlci5oaWRlTG9hZGluZyhcIm5ldFwiKTtcclxuICAgICAgICAvLyDlpoLmnpzmnInphY3lr7nor7fmsYLvvIzliJnlsIbov5Tlm57lgLzlj5HpgIHliLDor7fmsYLmiYDlnKjnmoTljp/lp4vlhoXmoLjph4xcclxuICAgICAgICB2YXIgb2JzZXJ2YWJsZSA9IHJlcXVlc3QgJiYgcmVxdWVzdC5fX29yaU9ic2VydmFibGU7XHJcbiAgICAgICAgLy8g5rS+5Y+R5LqL5Lu2XHJcbiAgICAgICAgb2JzZXJ2YWJsZS5kaXNwYXRjaChOZXRNZXNzYWdlLk5FVF9FUlJPUiwgZXJyLCByZXF1ZXN0KTtcclxuICAgICAgICAvLyDpgJLlvZLlpITnkIbkuovku7bnm5HlkKxcclxuICAgICAgICB0aGlzLnJlY3Vyc2VSZXNwb25zZShyZXNwb25zZUNscywgZXJyLCByZXF1ZXN0LCBvYnNlcnZhYmxlKTtcclxuICAgIH07XHJcbiAgICBOZXRNYW5hZ2VyLnByb3RvdHlwZS5yZWN1cnNlUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzcG9uc2VDbHMsIHJlc3BvbnNlLCByZXF1ZXN0LCBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgLy8g5YWI6YCS5b2S54i257qn77yM5LiO5raI5oGv5Y+R6YCB5pe26aG65bqP55u45Y+NXHJcbiAgICAgICAgaWYgKG9ic2VydmFibGUucGFyZW50KSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVjdXJzZVJlc3BvbnNlKHJlc3BvbnNlQ2xzLCByZXNwb25zZSwgcmVxdWVzdCwgb2JzZXJ2YWJsZS5wYXJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDop6blj5Hkuovku7blvaLlvI/nm5HlkKxcclxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fcmVzcG9uc2VMaXN0ZW5lcnMuZ2V0KHJlc3BvbnNlQ2xzKTtcclxuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5jb25jYXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaXN0ZW5lcnNfMiA9IGxpc3RlbmVyczsgX2kgPCBsaXN0ZW5lcnNfMi5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IGxpc3RlbmVyc18yW19pXTtcclxuICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lclszXSA9PSBvYnNlcnZhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5b+F6aG75piv5ZCM5qC45raI5oGv5omN6IO96Kem5Y+R5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdGVuZXJbMF0uY2FsbChsaXN0ZW5lclsxXSwgcmVzcG9uc2UsIHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOaYr+S4gOasoeaAp+ebkeWQrOWImeenu+mZpOS5i1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ZW5lclsyXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxpc3RlblJlc3BvbnNlKHJlc3BvbnNlQ2xzLCBsaXN0ZW5lclswXSwgbGlzdGVuZXJbMV0sIGxpc3RlbmVyWzJdLCBsaXN0ZW5lclszXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTmV0TWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZSxcclxuICAgICAgICB0c2xpYl8xLl9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcclxuICAgIF0sIE5ldE1hbmFnZXIpO1xyXG4gICAgcmV0dXJuIE5ldE1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE5ldE1hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBuZXRNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoTmV0TWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvTmV0TWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMTRcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IE1lZGlhdG9yIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvclwiO1xyXG5pbXBvcnQgTWVkaWF0b3JNZXNzYWdlIGZyb20gXCIuLi9tZWRpYXRvci9NZWRpYXRvck1lc3NhZ2VcIjtcclxuaW1wb3J0IHsgc2NlbmVNYW5hZ2VyIH0gZnJvbSBcIi4vU2NlbmVNYW5hZ2VyXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDlrp7njrDkuoZJU2NlbmXmjqXlj6PnmoTlnLrmma/kuK3ku4vogIXln7rnsbtcclxuKi9cclxudmFyIFNjZW5lTWVkaWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhTY2VuZU1lZGlhdG9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2NlbmVNZWRpYXRvcihza2luLCBwb2xpY3kpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBza2luKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnBvbGljeSA9IHBvbGljeTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25PcGVuID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICBzY2VuZU1hbmFnZXIucHVzaCh0aGlzLCBkYXRhKTtcclxuICAgIH07XHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5fX2FmdGVyT25DbG9zZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAvLyDnr6HmlLlvbkFmdGVyT3V077yM562J5b6F5YWz6Zet5Yqo55S757uT5p2f5ZCO5YaN5omn6KGMXHJcbiAgICAgICAgdmFyIG9yaU9uQWZ0ZXJPdXQgPSB0aGlzLm9uQWZ0ZXJPdXQ7XHJcbiAgICAgICAgdGhpcy5vbkFmdGVyT3V0ID0gZnVuY3Rpb24gKHRvU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAgICAgb3JpT25BZnRlck91dC5jYWxsKF90aGlzLCB0b1NjZW5lLCBkYXRhKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKE1lZGlhdG9yTWVzc2FnZS5NRURJQVRPUl9DTE9TRUQsIF90aGlzKTtcclxuICAgICAgICAgICAgLy8g6LCD55So6ZSA5q+BXHJcbiAgICAgICAgICAgIF90aGlzLmRpc3Bvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHNjZW5lTWFuYWdlci5wb3AodGhpcywgZGF0YSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIflhaXlnLrmma/lvIDlp4vliY3osIPnlKhcclxuICAgICAqIEBwYXJhbSBmcm9tU2NlbmUg5LuO5ZOq5Liq5Zy65pmv5YiH5YWlXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDliIflnLrmma/ml7blj6/og73nmoTlj4LmlbBcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZWRpYXRvci5wcm90b3R5cGUub25CZWZvcmVJbiA9IGZ1bmN0aW9uIChmcm9tU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+WFpeWcuuaZr+W8gOWni+WQjuiwg+eUqFxyXG4gICAgICogQHBhcmFtIGZyb21TY2VuZSDku47lk6rkuKrlnLrmma/liIflhaVcclxuICAgICAqIEBwYXJhbSBkYXRhIOWIh+WcuuaZr+aXtuWPr+iDveeahOWPguaVsFxyXG4gICAgICovXHJcbiAgICBTY2VuZU1lZGlhdG9yLnByb3RvdHlwZS5vbkFmdGVySW4gPSBmdW5jdGlvbiAoZnJvbVNjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIflh7rlnLrmma/lvIDlp4vliY3osIPnlKhcclxuICAgICAqIEBwYXJhbSB0b1NjZW5lIOimgeWIh+WFpeWIsOWTquS4quWcuuaZr1xyXG4gICAgICogQHBhcmFtIGRhdGEg5YiH5Zy65pmv5pe25Y+v6IO955qE5Y+C5pWwXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWVkaWF0b3IucHJvdG90eXBlLm9uQmVmb3JlT3V0ID0gZnVuY3Rpb24gKHRvU2NlbmUsIGRhdGEpIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIh+WHuuWcuuaZr+W8gOWni+WQjuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHRvU2NlbmUg6KaB5YiH5YWl5Yiw5ZOq5Liq5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gZGF0YSDliIflnLrmma/ml7blj6/og73nmoTlj4LmlbBcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZWRpYXRvci5wcm90b3R5cGUub25BZnRlck91dCA9IGZ1bmN0aW9uICh0b1NjZW5lLCBkYXRhKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNjZW5lTWVkaWF0b3I7XHJcbn0oTWVkaWF0b3IpKTtcclxuZXhwb3J0IGRlZmF1bHQgU2NlbmVNZWRpYXRvcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3IuanNcbi8vIG1vZHVsZSBpZCA9IDE1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tICcuLi8uLi91dGlscy9EaWN0aW9uYXJ5JztcclxuaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCIuLi9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMjVcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMjVcclxuICpcclxuICog6YGu572p566h55CG5ZmoXHJcbiovXHJcbnZhciBNYXNrTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1hc2tNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX2VudGl0eURpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFza0RpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9pc1Nob3dpbmdNYXNrID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxNYXNrRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICB9XHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuZ2V0TG9hZGluZ01hc2tDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY291bnQgPSAwO1xyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLl9sb2FkaW5nTWFza0RpY3QpIHtcclxuICAgICAgICAgICAgdmFyIHRlbXAgPSB0aGlzLl9sb2FkaW5nTWFza0RpY3Rba2V5XTtcclxuICAgICAgICAgICAgaWYgKHRlbXAgPiAwKVxyXG4gICAgICAgICAgICAgICAgY291bnQgKz0gdGVtcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvdW50O1xyXG4gICAgfTtcclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5wbHVzTG9hZGluZ01hc2tDb3VudCA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICB2YXIgY291bnQgPSB0aGlzLl9sb2FkaW5nTWFza0RpY3Rba2V5XSB8fCAwO1xyXG4gICAgICAgIGlmIChjb3VudCA8IDApXHJcbiAgICAgICAgICAgIGNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFza0RpY3Rba2V5XSA9ICsrY291bnQ7XHJcbiAgICAgICAgcmV0dXJuIGNvdW50O1xyXG4gICAgfTtcclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5taW51c0xvYWRpbmdNYXNrQ291bnQgPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV0gfHwgMDtcclxuICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgIGlmIChjb3VudCA8IDApXHJcbiAgICAgICAgICAgIGNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFza0RpY3Rba2V5XSA9IGNvdW50O1xyXG4gICAgICAgIGlmIChjb3VudCA9PSAwKVxyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fbG9hZGluZ01hc2tEaWN0W2tleV07XHJcbiAgICAgICAgcmV0dXJuIGNvdW50O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyWTWFza1V0aWxcclxuICAgICAqIEBwYXJhbSB0eXBlIOaJgOWxnuihqOeOsOWxguahpVxyXG4gICAgICogQHBhcmFtIGVudGl0eSDpga7nvanlrp7kvZNcclxuICAgICAqL1xyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyTWFzayA9IGZ1bmN0aW9uICh0eXBlLCBlbnRpdHkpIHtcclxuICAgICAgICB0aGlzLl9lbnRpdHlEaWN0W3R5cGVdID0gZW50aXR5O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pi+56S66YGu572pXHJcbiAgICAgKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5zaG93TWFzayA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuW3sue7j+W8gOWQr+S6hlxyXG4gICAgICAgIGlmICh0aGlzLl9pc1Nob3dpbmdNYXNrKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5faXNTaG93aW5nTWFzayA9IHRydWU7XHJcbiAgICAgICAgLy8g5q+P5Liq5bey5rOo5YaM55qE6KGo546w5bGC6YO95pi+56S66YGu572pXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGJyaWRnZU1hbmFnZXIuYnJpZGdlczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGJyaWRnZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX2VudGl0eURpY3RbYnJpZGdlLnR5cGVdO1xyXG4gICAgICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIOaYvuekuumBrue9qVxyXG4gICAgICAgICAgICAgICAgZW50aXR5LnNob3dNYXNrKGFscGhhKTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd01hc2sgJiYgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd01hc2soKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmakOiXj+mBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuaGlkZU1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5ZCm5bey57uP5byA5ZCv5LqGXHJcbiAgICAgICAgaWYgKCF0aGlzLl9pc1Nob3dpbmdNYXNrKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5faXNTaG93aW5nTWFzayA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOavj+S4quW3suazqOWGjOeahOihqOeOsOWxgumDveenu+mZpOmBrue9qVxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBicmlkZ2VNYW5hZ2VyLmJyaWRnZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBicmlkZ2UgPSBfYVtfaV07XHJcbiAgICAgICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W2JyaWRnZS50eXBlXTtcclxuICAgICAgICAgICAgaWYgKGVudGl0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVNYXNrICYmIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVNYXNrKCk7XHJcbiAgICAgICAgICAgICAgICAvLyDpmpDol4/pga7nvalcclxuICAgICAgICAgICAgICAgIGVudGl0eS5oaWRlTWFzaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKuW9k+WJjeaYr+WQpuWcqOaYvuekuumBrue9qSovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuaXNTaG93aW5nTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faXNTaG93aW5nTWFzaztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuWKoOi9veWbvlxyXG4gICAgICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuc2hvd0xvYWRpbmcgPSBmdW5jdGlvbiAoYWxwaGEsIGtleSkge1xyXG4gICAgICAgIGlmIChrZXkgPT09IHZvaWQgMCkgeyBrZXkgPSBudWxsOyB9XHJcbiAgICAgICAgLy8g6Iul5b2T5YmN5L2g5rKh5pyJbG9hZGluZ+WImeaYvuekumxvYWRpbmdcclxuICAgICAgICBpZiAodGhpcy5nZXRMb2FkaW5nTWFza0NvdW50KCkgPT0gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gYnJpZGdlTWFuYWdlci5icmlkZ2VzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGJyaWRnZSA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLl9lbnRpdHlEaWN0W2JyaWRnZS50eXBlXTtcclxuICAgICAgICAgICAgICAgIGlmIChlbnRpdHkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaYvuekuumBrue9qVxyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eS5zaG93TG9hZGluZyhhbHBoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd0xvYWRpbmcgJiYgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd0xvYWRpbmcoZW50aXR5LmxvYWRpbmdTa2luKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlop7orqHmlbBcclxuICAgICAgICB0aGlzLnBsdXNMb2FkaW5nTWFza0NvdW50KGtleSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpmpDol4/liqDovb3lm75cclxuICAgICAqL1xyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLmhpZGVMb2FkaW5nID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGlmIChrZXkgPT09IHZvaWQgMCkgeyBrZXkgPSBudWxsOyB9XHJcbiAgICAgICAgLy8g5YeP6K6h5pWwXHJcbiAgICAgICAgdGhpcy5taW51c0xvYWRpbmdNYXNrQ291bnQoa2V5KTtcclxuICAgICAgICBpZiAodGhpcy5nZXRMb2FkaW5nTWFza0NvdW50KCkgPT0gMCkge1xyXG4gICAgICAgICAgICAvLyDnp7vpmaRsb2FkaW5nXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBicmlkZ2VNYW5hZ2VyLmJyaWRnZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYnJpZGdlID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX2VudGl0eURpY3RbYnJpZGdlLnR5cGVdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGVudGl0eSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXR5Lm1hc2tEYXRhLm9uSGlkZUxvYWRpbmcgJiYgZW50aXR5Lm1hc2tEYXRhLm9uSGlkZUxvYWRpbmcoZW50aXR5LmxvYWRpbmdTa2luKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpmpDol4/pga7nvalcclxuICAgICAgICAgICAgICAgICAgICBlbnRpdHkuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKirlvZPliY3mmK/lkKblnKjmmL7npLpsb2FkaW5nKi9cclxuICAgIE1hc2tNYW5hZ2VyLnByb3RvdHlwZS5pc1Nob3dpbmdMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5nZXRMb2FkaW5nTWFza0NvdW50KCkgPiAwKTtcclxuICAgIH07XHJcbiAgICAvKiog5pi+56S65qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuc2hvd01vZGFsTWFzayA9IGZ1bmN0aW9uIChwb3B1cCwgYWxwaGEpIHtcclxuICAgICAgICAvLyDliKTmlq3mmK/lkKblt7Lnu4/lnKjmiZPlvIDkuoZcclxuICAgICAgICBpZiAodGhpcy5pc1Nob3dpbmdNb2RhbE1hc2socG9wdXApKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g5byA5ZCv6YGu572pXHJcbiAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlQnlTa2luKHBvcHVwLnNraW4pO1xyXG4gICAgICAgIGlmIChicmlkZ2UpIHtcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX2VudGl0eURpY3RbYnJpZGdlLnR5cGVdO1xyXG4gICAgICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiusOW9lVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxNYXNrRGljdC5zZXQocG9wdXAsIHBvcHVwKTtcclxuICAgICAgICAgICAgICAgIC8vIOaYvuekuumBrue9qVxyXG4gICAgICAgICAgICAgICAgZW50aXR5LnNob3dNb2RhbE1hc2socG9wdXAsIGFscGhhKTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgZW50aXR5Lm1hc2tEYXRhLm9uU2hvd01vZGFsTWFzayAmJiBlbnRpdHkubWFza0RhdGEub25TaG93TW9kYWxNYXNrKHBvcHVwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog6ZqQ6JeP5qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrTWFuYWdlci5wcm90b3R5cGUuaGlkZU1vZGFsTWFzayA9IGZ1bmN0aW9uIChwb3B1cCkge1xyXG4gICAgICAgIC8vIOWIpOaWreaYr+WQpuW3sue7j+W8gOWQr+S6hlxyXG4gICAgICAgIGlmICghdGhpcy5pc1Nob3dpbmdNb2RhbE1hc2socG9wdXApKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g5byA5aeL5YWz6Zet6YGu572pXHJcbiAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlQnlTa2luKHBvcHVwLnNraW4pO1xyXG4gICAgICAgIGlmIChicmlkZ2UpIHtcclxuICAgICAgICAgICAgdmFyIGVudGl0eSA9IHRoaXMuX2VudGl0eURpY3RbYnJpZGdlLnR5cGVdO1xyXG4gICAgICAgICAgICBpZiAoZW50aXR5ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiusOW9lVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxNYXNrRGljdC5kZWxldGUocG9wdXApO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBlbnRpdHkubWFza0RhdGEub25IaWRlTW9kYWxNYXNrICYmIGVudGl0eS5tYXNrRGF0YS5vbkhpZGVNb2RhbE1hc2socG9wdXApO1xyXG4gICAgICAgICAgICAgICAgLy8g6ZqQ6JeP6YGu572pXHJcbiAgICAgICAgICAgICAgICBlbnRpdHkuaGlkZU1vZGFsTWFzayhwb3B1cCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIOW9k+WJjeaYr+WQpuWcqOaYvuekuuaooeaAgeeql+WPo+mBrue9qSAqL1xyXG4gICAgTWFza01hbmFnZXIucHJvdG90eXBlLmlzU2hvd2luZ01vZGFsTWFzayA9IGZ1bmN0aW9uIChwb3B1cCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fbW9kYWxNYXNrRGljdC5nZXQocG9wdXApICE9IG51bGwpO1xyXG4gICAgfTtcclxuICAgIE1hc2tNYW5hZ2VyID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlXHJcbiAgICBdLCBNYXNrTWFuYWdlcik7XHJcbiAgICByZXR1cm4gTWFza01hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1hc2tNYW5hZ2VyO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgbWFza01hbmFnZXIgPSBjb3JlLmdldEluamVjdChNYXNrTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9tYXNrL01hc2tNYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAxNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMThcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMThcclxuICpcclxuICog5qih5Z2X5raI5oGvXHJcbiovXHJcbnZhciBNb2R1bGVNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTW9kdWxlTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5qih5Z2X5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIE1vZHVsZU1lc3NhZ2UuTU9EVUxFX0NIQU5HRSA9IFwibW9kdWxlQ2hhbmdlXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouaooeWdl+Wksei0pea2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgTW9kdWxlTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNb2R1bGVNZXNzYWdlLk1PRFVMRV9DSEFOR0VfRkFJTEVEID0gXCJtb2R1bGVDaGFuZ2VGYWlsZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L295qih5Z2X5aSx6LSl5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBNb2R1bGVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIE1vZHVsZU1lc3NhZ2UuTU9EVUxFX0xPQURfQVNTRVRTX0VSUk9SID0gXCJtb2R1bGVMb2FkQXNzZXRzRXJyb3JcIjtcclxuICAgIHJldHVybiBNb2R1bGVNZXNzYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBNb2R1bGVNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1lc3NhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDE3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxOC0wMi0yNFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxOC0wMi0yNFxyXG4gKlxyXG4gKiDkuK3ku4vogIXnirbmgIHmnprkuL5cclxuKi9cclxudmFyIE1lZGlhdG9yU3RhdHVzO1xyXG4oZnVuY3Rpb24gKE1lZGlhdG9yU3RhdHVzKSB7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIlVOT1BFTlwiXSA9IDBdID0gXCJVTk9QRU5cIjtcclxuICAgIE1lZGlhdG9yU3RhdHVzW01lZGlhdG9yU3RhdHVzW1wiT1BFTklOR1wiXSA9IDFdID0gXCJPUEVOSU5HXCI7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIk9QRU5FRFwiXSA9IDJdID0gXCJPUEVORURcIjtcclxuICAgIE1lZGlhdG9yU3RhdHVzW01lZGlhdG9yU3RhdHVzW1wiQ0xPU0lOR1wiXSA9IDNdID0gXCJDTE9TSU5HXCI7XHJcbiAgICBNZWRpYXRvclN0YXR1c1tNZWRpYXRvclN0YXR1c1tcIkNMT1NFRFwiXSA9IDRdID0gXCJDTE9TRURcIjtcclxuICAgIE1lZGlhdG9yU3RhdHVzW01lZGlhdG9yU3RhdHVzW1wiRElTUE9TSU5HXCJdID0gNV0gPSBcIkRJU1BPU0lOR1wiO1xyXG4gICAgTWVkaWF0b3JTdGF0dXNbTWVkaWF0b3JTdGF0dXNbXCJESVNQT1NFRFwiXSA9IDZdID0gXCJESVNQT1NFRFwiO1xyXG59KShNZWRpYXRvclN0YXR1cyB8fCAoTWVkaWF0b3JTdGF0dXMgPSB7fSkpO1xyXG5leHBvcnQgZGVmYXVsdCBNZWRpYXRvclN0YXR1cztcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yU3RhdHVzLmpzXG4vLyBtb2R1bGUgaWQgPSAxOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBicmlkZ2VNYW5hZ2VyIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvYnJpZGdlL0JyaWRnZU1hbmFnZXJcIjtcclxuaW1wb3J0IHsgTWVkaWF0b3JDbGFzcyB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCB7IGxpc3RlbkNvbnN0cnVjdCwgbGlzdGVuQXBwbHkgfSBmcm9tIFwib2x5bXB1cy1yL3V0aWxzL0NvbnN0cnVjdFV0aWxcIjtcclxuaW1wb3J0IERPTUJyaWRnZSBmcm9tIFwiLi4vLi4vRE9NQnJpZGdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0wOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0wOVxyXG4gKlxyXG4gKiDotJ/otKPms6jlhaXnmoTmqKHlnZdcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIERPTU1lZGlhdG9yQ2xhc3MobW9kdWxlTmFtZSwgc2tpbikge1xyXG4gICAgdmFyIHNraW5zID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHNraW5zW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjbHMpIHtcclxuICAgICAgICAvLyDosIPnlKhNZWRpYXRvckNsYXNz5pa55rOVXHJcbiAgICAgICAgY2xzID0gTWVkaWF0b3JDbGFzcyhtb2R1bGVOYW1lKShjbHMpO1xyXG4gICAgICAgIC8vIOebkeWQrOexu+Wei+WunuS+i+WMlu+8jOi9rOaNouearuiCpOagvOW8j1xyXG4gICAgICAgIHZhciBmaW5hbFNraW47XHJcbiAgICAgICAgaWYgKHNraW5zLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBmaW5hbFNraW4gPSBza2luO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc2tpbnMudW5zaGlmdChza2luKTtcclxuICAgICAgICAgICAgZmluYWxTa2luID0gc2tpbnM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxpc3RlbkNvbnN0cnVjdChjbHMsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAvLyDlhYjotYvlgLzmoaVcclxuICAgICAgICAgICAgbWVkaWF0b3IuYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRE9NQnJpZGdlLlRZUEUpO1xyXG4gICAgICAgICAgICAvLyDnhLblkI7nm5HlkKxvbk9wZW7vvIzlnKhvbk9wZW7kuK3orr7nva7nmq7ogqRcclxuICAgICAgICAgICAgbGlzdGVuQXBwbHkobWVkaWF0b3IsIFwib25PcGVuXCIsIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgICAgICAgICAgbWVkaWF0b3Iuc2tpbiA9IGZpbmFsU2tpbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8g6L+U5Zue57uT5p6c57G75Z6LXHJcbiAgICAgICAgcmV0dXJuIGNscztcclxuICAgIH07XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9pbmplY3Rvci9JbmplY3Rvci5qc1xuLy8gbW9kdWxlIGlkID0gMTlcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IFwiLi4vLi4vbGlicy9SZWZsZWN0XCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiDov5nkuKrmlofku7bnmoTlrZjlnKjmmK/kuLrkuoblr7nnjrDmnIlqc+WKn+iDveaJk+ihpeS4geS/rmJ1Z+etiVxyXG4qL1xyXG4vKiog5L+u5aSNQXJyYXkuZmluZEluZGV45Lya6KKr6YGN5Y6G5Yiw55qE6Zeu6aKYICovXHJcbmlmIChBcnJheS5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkoXCJmaW5kSW5kZXhcIikpIHtcclxuICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihBcnJheS5wcm90b3R5cGUsIFwiZmluZEluZGV4XCIpO1xyXG4gICAgaWYgKGRlc2MuZW51bWVyYWJsZSkge1xyXG4gICAgICAgIGRlc2MuZW51bWVyYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBcnJheS5wcm90b3R5cGUsIFwiZmluZEluZGV4XCIsIGRlc2MpO1xyXG4gICAgfVxyXG59XHJcbi8qKiDkuLrmn5DkupvkuI3mlK/mjIFFcnJvckV2ZW5055qE5rWP6KeI5Zmo5re75YqgRXJyb3JFdmVudOaUr+aMgSAqL1xyXG50cnkge1xyXG4gICAgbmV3IEVycm9yRXZlbnQoXCJcIik7XHJcbn1cclxuY2F0Y2ggKGVycikge1xyXG4gICAgd2luZG93W1wiRXJyb3JFdmVudFwiXSA9IGZ1bmN0aW9uIEVycm9yRXZlbnQodHlwZSwgZXJyb3JFdmVudEluaXREaWN0KSB7XHJcbiAgICAgICAgaWYgKCFlcnJvckV2ZW50SW5pdERpY3QpXHJcbiAgICAgICAgICAgIGVycm9yRXZlbnRJbml0RGljdCA9IHt9O1xyXG4gICAgICAgIGlmIChFdmVudCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgIEV2ZW50LmNhbGwodGhpcywgdHlwZSwgZXJyb3JFdmVudEluaXREaWN0KTtcclxuICAgICAgICAgICAgdGhpcy5pbml0RXJyb3JFdmVudCh0eXBlLCBlcnJvckV2ZW50SW5pdERpY3QuYnViYmxlcywgZXJyb3JFdmVudEluaXREaWN0LmNhbmNlbGFibGUsIGVycm9yRXZlbnRJbml0RGljdC5tZXNzYWdlLCBlcnJvckV2ZW50SW5pdERpY3QuZmlsZW5hbWUsIGVycm9yRXZlbnRJbml0RGljdC5saW5lbm8pO1xyXG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3JFdmVudEluaXREaWN0LmVycm9yO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudChcIkVycm9yRXZlbnRcIik7XHJcbiAgICAgICAgICAgIGV2dC5pbml0RXJyb3JFdmVudCh0eXBlLCBlcnJvckV2ZW50SW5pdERpY3QuYnViYmxlcywgZXJyb3JFdmVudEluaXREaWN0LmNhbmNlbGFibGUsIGVycm9yRXZlbnRJbml0RGljdC5tZXNzYWdlLCBlcnJvckV2ZW50SW5pdERpY3QuZmlsZW5hbWUsIGVycm9yRXZlbnRJbml0RGljdC5saW5lbm8pO1xyXG4gICAgICAgICAgICByZXR1cm4gZXZ0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB3aW5kb3dbXCJFcnJvckV2ZW50XCJdLnByb3RvdHlwZS5pbml0RXJyb3JFdmVudCA9IGZ1bmN0aW9uIGluaXRFcnJvckV2ZW50KHR5cGVBcmcsIGNhbkJ1YmJsZUFyZywgY2FuY2VsYWJsZUFyZywgbWVzc2FnZUFyZywgZmlsZW5hbWVBcmcsIGxpbmVub0FyZykge1xyXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGVBcmc7XHJcbiAgICAgICAgdGhpcy5idWJibGVzID0gY2FuQnViYmxlQXJnO1xyXG4gICAgICAgIHRoaXMuY2FuY2VsYWJsZSA9IGNhbmNlbGFibGVBcmc7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZUFyZztcclxuICAgICAgICB0aGlzLmZpbGVuYW1lID0gZmlsZW5hbWVBcmc7XHJcbiAgICAgICAgdGhpcy5saW5lbm8gPSBsaW5lbm9Bcmc7XHJcbiAgICB9O1xyXG59XHJcbi8qKiDnr6HmlLlSZWZsZWN0LmRlY29yYXRl5pa55rOV77yM55So5LqO5Li66KOF6aWw5Zmo5pa55rOV5omT5LiqZmxhZ++8jOagh+iusOijhemlsOWZqOaYr+WQpuS4uuWPguaVsOWMluijhemlsCAqL1xyXG5leHBvcnQgdmFyIGRlY29yYXRlVGhpcyA9IHt9O1xyXG5pZiAoUmVmbGVjdCAmJiBSZWZsZWN0LmRlY29yYXRlKSB7XHJcbiAgICB2YXIgb3JpRGVjb3JhdGUgPSBSZWZsZWN0LmRlY29yYXRlO1xyXG4gICAgUmVmbGVjdC5kZWNvcmF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g56+h5pS5YXJnc1swXVswXe+8iOijhemlsOWZqOaWueazleW8leeUqO+8ie+8jOWcqOiwg+eUqOaXtuS4uuWFtuaPkOS+m+S4gOS4qnRoaXPmjIflkJHvvIzmjIflkJF3aW5kb3dcclxuICAgICAgICB2YXIgb3JpUmVmID0gYXJnc1swXVswXTtcclxuICAgICAgICBhcmdzWzBdWzBdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBvcmlSZWYuYXBwbHkoZGVjb3JhdGVUaGlzLCBhcmdzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOiwg+eUqOWOn+Wni+aWueazlVxyXG4gICAgICAgIHZhciByZXN1bHQgPSBvcmlEZWNvcmF0ZS5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICAvLyDov5jljp/nr6HmlLnpoblcclxuICAgICAgICBhcmdzWzBdWzBdID0gb3JpUmVmO1xyXG4gICAgICAgIC8vIOi/lOWbnue7k+aenFxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvZ2xvYmFsL1BhdGNoLmpzXG4vLyBtb2R1bGUgaWQgPSAyMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgdHJpbVVSTCwgd3JhcEFic29sdXRlUGF0aCB9IGZyb20gXCIuLi8uLi91dGlscy9VUkxVdGlsXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMVxyXG4gKlxyXG4gKiDnrqHnkIbmlofku7blk4jluIzniYjmnKzlj7dcclxuKi9cclxudmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBWZXJzaW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2hhc2hEaWN0ID0ge307XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMluWTiOW4jOeJiOacrOW3peWFt1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7KCk9PnZvaWR9IGhhbmRsZXIg5Zue6LCDXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW2hvc3RdIHZlcnNpb24uY2Zn5paH5Lu25Yqg6L295Z+f5ZCN77yM5LiN5Lyg5YiZ5L2/55So5b2T5YmN5Z+f5ZCNXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3ZlcnNpb25dIOWKoOi9vXZlcnNpb24uY2Zn5paH5Lu255qE54mI5pys5Y+377yM5LiN5Lyg5YiZ5L2/55So6ZqP5py65pe26Ze05oiz5L2c5Li654mI5pys5Y+3XHJcbiAgICAgKiBAbWVtYmVyb2YgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBWZXJzaW9uLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24gKGhhbmRsZXIsIGhvc3QsIHZlcnNpb24pIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHdpbmRvd1tcIl9fT2x5bXB1c19WZXJzaW9uX2hhc2hEaWN0X19cIl0pIHtcclxuICAgICAgICAgICAgLy8g5LmL5YmN5Zyo5ZOq5Yqg6L296L+H77yM5peg6ZyA5YaN5qyh5Yqg6L2977yM55u05o6l5L2/55SoXHJcbiAgICAgICAgICAgIHRoaXMuX2hhc2hEaWN0ID0gd2luZG93W1wiX19PbHltcHVzX1ZlcnNpb25faGFzaERpY3RfX1wiXTtcclxuICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5Y675Yqg6L29dmVyc2lvbi5jZmdcclxuICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAod2luZG93W1wiWERvbWFpblJlcXVlc3RcIl0gJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRSAxMC5cIikgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb2RlIGZvciBJRTcgLSBJRTlcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgd2luZG93W1wiWERvbWFpblJlcXVlc3RcIl0oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3aW5kb3dbXCJYTUxIdHRwUmVxdWVzdFwiXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY29kZSBmb3IgSUUxMCwgRmlyZWZveCwgQ2hyb21lLCBPcGVyYSwgU2FmYXJpXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAod2luZG93W1wiQWN0aXZlWE9iamVjdFwiXSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY29kZSBmb3IgSUU2LCBJRTVcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QgPSBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOazqOWGjOWbnuiwg+WHveaVsFxyXG4gICAgICAgICAgICByZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K+05piO5piv5LiN5pSv5oyBWE1MSHR0cFJlcXVlc3TnmoTmg4XlhrXvvIzmn6XnnIvlhbZyZXNwb25zZVRleHTmmK/lkKbkuLpcIlwiXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVlc3QucmVzcG9uc2VUZXh0ID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWksei0pVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IobmV3IEVycm9yRXZlbnQoXCJSZXF1ZXN0RXJyb3JcIiwgeyBmaWxlbmFtZTogdXJsIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkxvYWQoZXZ0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWNs+S9v+aYr29uTG9hZOS5n+imgeWIpOaWreS4i+eKtuaAgeeggVxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXNIZWFkID0gTWF0aC5mbG9vcihyZXF1ZXN0LnN0YXR1cyAqIDAuMDEpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoc3RhdHVzSGVhZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDJ4eOWSjDN4eOeahOeKtuaAgeeggeiupOS4uuaYr+aIkOWKn1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Mb2FkKGV2dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA0eHjlkow1eHjnmoTnirbmgIHnoIHorqTkuLrmmK/plJnor6/vvIzovazosIPplJnor6/lm57osINcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvcihuZXcgRXJyb3JFdmVudChcIlJlcXVlc3RFcnJvclwiLCB7IGZpbGVuYW1lOiB1cmwsIG1lc3NhZ2U6IHJlcXVlc3Quc3RhdHVzICsgXCIgXCIgKyByZXF1ZXN0LnN0YXR1c1RleHQgfSkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB2YXIgdXJsO1xyXG4gICAgICAgICAgICBpZiAodmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS9v+eUqC1yX+aWueW8j+WKoOi9veWksei0peS6hu+8jOWGjeivleS4gOasoeeUqHF1ZXJ55Y+C5pWw5Yqg6L2954mI5pys5Y+3XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHdyYXBBYnNvbHV0ZVBhdGgoXCJ2ZXJzaW9uLmNmZz92PVwiICsgdmVyc2lvbiwgaG9zdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5hYm9ydCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGhhbmRsZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdC5zZW5kKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy8g6K6+572u6L+e5o6l5L+h5oGvXHJcbiAgICAgICAgICAgICAgICB1cmwgPSB3cmFwQWJzb2x1dGVQYXRoKFwidmVyc2lvbi5jZmdcIiwgaG9zdCk7XHJcbiAgICAgICAgICAgICAgICAvLyDmt7vliqAtcl/mlrnlvI/niYjmnKzlj7dcclxuICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuam9pblZlcnNpb24odXJsLCB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOayoeacieeJiOacrOWPt++8jOebtOaOpeS9v+eUqOW9k+WJjeaXtumXtOaIs+WKoOi9vVxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gaGFuZGxlcjtcclxuICAgICAgICAgICAgICAgIHVybCA9IHdyYXBBYnNvbHV0ZVBhdGgoXCJ2ZXJzaW9uLmNmZz92PVwiICsgRGF0ZS5ub3coKSwgaG9zdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmVxdWVzdC5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vIOWPkemAgeaVsOaNru+8jOW8gOWni+WSjOacjeWKoeWZqOi/m+ihjOS6pOS6klxyXG4gICAgICAgICAgICByZXF1ZXN0LnNlbmQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25Mb2FkKGV2dCkge1xyXG4gICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGV2dC50YXJnZXQ7XHJcbiAgICAgICAgICAgIHZhciByZXNwb25zZVRleHQgPSByZXF1ZXN0LnJlc3BvbnNlVGV4dDtcclxuICAgICAgICAgICAgdmFyIGxpbmVzID0gcmVzcG9uc2VUZXh0LnNwbGl0KFwiXFxuXCIpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIGxpbmVzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IGxpbmVzW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IGxpbmUuc3BsaXQoXCIgIFwiKTtcclxuICAgICAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gYXJyWzFdLnN1YnN0cigyKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBhcnJbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5faGFzaERpY3Rba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOWcqHdpbmRvd+S4iuaMguS4gOS7vVxyXG4gICAgICAgICAgICB3aW5kb3dbXCJfX09seW1wdXNfVmVyc2lvbl9oYXNoRGljdF9fXCJdID0gc2VsZi5faGFzaERpY3Q7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5paH5Lu25ZOI5biM5YC877yM5aaC5p6c5rKh5pyJ5paH5Lu25ZOI5biM5YC85YiZ6L+U5ZuebnVsbFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg5paH5Lu255qEVVJMXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDmlofku7bnmoTlk4jluIzlgLzvvIzmiJbogIVudWxsXHJcbiAgICAgKiBAbWVtYmVyb2YgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRIYXNoID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHVybCA9IHRyaW1VUkwodXJsKTtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcclxuICAgICAgICBmb3IgKHZhciBwYXRoIGluIHRoaXMuX2hhc2hEaWN0KSB7XHJcbiAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZihwYXRoKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB0aGlzLl9oYXNoRGljdFtwYXRoXTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlsIZ1cmzovazmjaLkuLrlk4jluIzniYjmnKx1cmxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOWOn+Wni3VybFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30g5ZOI5biM54mI5pysdXJsXHJcbiAgICAgKiBAbWVtYmVyb2YgVmVyc2lvblxyXG4gICAgICovXHJcbiAgICBWZXJzaW9uLnByb3RvdHlwZS53cmFwSGFzaFVybCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB2YXIgaGFzaCA9IHRoaXMuZ2V0SGFzaCh1cmwpO1xyXG4gICAgICAgIGlmIChoYXNoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdXJsID0gdGhpcy5qb2luVmVyc2lvbih1cmwsIGhhc2gpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5re75YqgLXJfWFhY5b2i5byP54mI5pys5Y+3XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHZlcnNpb24g54mI5pys5Y+377yM5Lul5pWw5a2X5ZKM5bCP5YaZ5a2X5q+N57uE5oiQXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDliqDniYjmnKzlj7flkI7nmoR1cmzvvIzlpoLmnpzmsqHmnInmn6XliLDniYjmnKzlj7fliJnov5Tlm57ljp/lp4t1cmxcclxuICAgICAqIEBtZW1iZXJvZiBWZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIFZlcnNpb24ucHJvdG90eXBlLmpvaW5WZXJzaW9uID0gZnVuY3Rpb24gKHVybCwgdmVyc2lvbikge1xyXG4gICAgICAgIGlmICh2ZXJzaW9uID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiB1cmw7XHJcbiAgICAgICAgLy8g5Y675o6JdmVyc2lvbuS4reeahOmdnuazleWtl+esplxyXG4gICAgICAgIHZlcnNpb24gPSB2ZXJzaW9uLnJlcGxhY2UoL1teMC05YS16XSsvaWcsIFwiXCIpO1xyXG4gICAgICAgIC8vIOaPkuWFpeeJiOacrOWPt1xyXG4gICAgICAgIHZhciByZWcgPSAvKChbYS16QS1aXSs6XFwvK1teXFwvXFw/I10rXFwvKT9bXlxcPyNdKylcXC4oW15cXD9dKykoXFw/LispPy87XHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IHJlZy5leGVjKHVybCk7XHJcbiAgICAgICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHVybCA9IHJlc3VsdFsxXSArIFwiLXJfXCIgKyB2ZXJzaW9uICsgXCIuXCIgKyByZXN1bHRbM10gKyAocmVzdWx0WzRdIHx8IFwiXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76ZmkLXJfWFhY5b2i5byP54mI5pys5Y+3XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCB1cmxcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOenu+mZpOeJiOacrOWPt+WQjueahHVybFxyXG4gICAgICogQG1lbWJlcm9mIFZlcnNpb25cclxuICAgICAqL1xyXG4gICAgVmVyc2lvbi5wcm90b3R5cGUucmVtb3ZlVmVyc2lvbiA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAvLyDljrvmjoktcl9YWFjniYjmnKzlj7fvvIzlpoLmnpzmnIlcclxuICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvXFwtcl9bYS16MC05XStcXC4vaWcsIFwiLlwiKTtcclxuICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgfTtcclxuICAgIFZlcnNpb24gPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGVcclxuICAgIF0sIFZlcnNpb24pO1xyXG4gICAgcmV0dXJuIFZlcnNpb247XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFZlcnNpb247XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciB2ZXJzaW9uID0gY29yZS5nZXRJbmplY3QoVmVyc2lvbik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS92ZXJzaW9uL1ZlcnNpb24uanNcbi8vIG1vZHVsZSBpZCA9IDIxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyBicmlkZ2VNYW5hZ2VyIH0gZnJvbSBcIi4uL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IG1hc2tNYW5hZ2VyIH0gZnJvbSBcIi4uL21hc2svTWFza01hbmFnZXJcIjtcclxuaW1wb3J0IHsgQnV0dG9uVHlwZSB9IGZyb20gXCIuL0lQcm9tcHRQYW5lbFwiO1xyXG5pbXBvcnQgbm9uZSBmcm9tIFwiLi9Ob25lUGFuZWxQb2xpY3lcIjtcclxuaW1wb3J0IFBhbmVsTWVzc2FnZSBmcm9tIFwiLi9QYW5lbE1lc3NhZ2VcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIOW8ueeql+euoeeQhuWZqO+8jOWMheWQq+W8ueWHuuW8ueeql+OAgeWFs+mXreW8ueeql+OAgeW8ueeql+euoeeQhuetieWKn+iDvVxyXG4qL1xyXG52YXIgUGFuZWxNYW5hZ2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gUGFuZWxNYW5hZ2VyKCkge1xyXG4gICAgICAgIHRoaXMuX3BhbmVscyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX3ByaW9yaXRpZXMgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKiDkuIvpnaLmmK/pgJrnlKjlvLnnqpfnmoTpgLvovpEgKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgICAgIHRoaXMuX3Byb21wdERpY3QgPSB7fTtcclxuICAgIH1cclxuICAgIFBhbmVsTWFuYWdlcl8xID0gUGFuZWxNYW5hZ2VyO1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blvZPliY3mmL7npLrnmoTlvLnnqpfmlbDnu4TvvIjlia/mnKzvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lDb25zdHJ1Y3Rvcn0gW2Nsc10g5by556qX57G75Z6L77yM5aaC5p6c5Lyg6YCS6K+l5Y+C5pWw5YiZ5Y+q6L+U5Zue6K+l57G75Z6L55qE5bey5omT5byA5by556qX77yM5ZCm5YiZ5bCG6L+U5Zue5omA5pyJ5bey5omT5byA55qE5by556qXXHJcbiAgICAgKiBAcmV0dXJucyB7SVBhbmVsW119IOW3suaJk+W8gOW8ueeql+aVsOe7hFxyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQYW5lbE1hbmFnZXIucHJvdG90eXBlLmdldE9wZW5lZCA9IGZ1bmN0aW9uIChjbHMpIHtcclxuICAgICAgICBpZiAoIWNscylcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhbmVscy5jb25jYXQoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYW5lbHMuZmlsdGVyKGZ1bmN0aW9uIChwYW5lbCkgeyByZXR1cm4gcGFuZWwuY29uc3RydWN0b3IgPT0gY2xzOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluW8ueeql+aYr+WQpuW3suW8gOWQr1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVBhbmVsfSBwYW5lbCDlvLnnqpflr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSDmmK/lkKblt7Lnu4/lvIDlkK9cclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5pc09wZW5lZCA9IGZ1bmN0aW9uIChwYW5lbCkge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fcGFuZWxzLmluZGV4T2YocGFuZWwpID49IDApO1xyXG4gICAgfTtcclxuICAgIFBhbmVsTWFuYWdlci5wcm90b3R5cGUudXBkYXRlTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgLy8g6aaW5YWI5bCG5Lyg5YWl55qEcGFuZWznmoTmqKHmgIHpga7nvanljrvpmaRcclxuICAgICAgICBtYXNrTWFuYWdlci5oaWRlTW9kYWxNYXNrKHBhbmVsKTtcclxuICAgICAgICAvLyDnhLblkI7kuLrmnIDkuIrlsYLnmoTmqKHmgIHlvLnnqpfmt7vliqDpga7nvalcclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fcGFuZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIHBhbmVsID0gdGhpcy5fcGFuZWxzW2ldO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxEaWN0LmdldChwYW5lbCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOW3sue7j+aciemBrue9qeS6hu+8jOWFiOenu+mZpOS5i1xyXG4gICAgICAgICAgICAgICAgaWYgKG1hc2tNYW5hZ2VyLmlzU2hvd2luZ01vZGFsTWFzayhwYW5lbCkpXHJcbiAgICAgICAgICAgICAgICAgICAgbWFza01hbmFnZXIuaGlkZU1vZGFsTWFzayhwYW5lbCk7XHJcbiAgICAgICAgICAgICAgICAvLyDmt7vliqDpga7nvalcclxuICAgICAgICAgICAgICAgIG1hc2tNYW5hZ2VyLnNob3dNb2RhbE1hc2socGFuZWwsIHBhbmVsLm1hc2tBbHBoYSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOS4gOS4quW8ueeql1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVBhbmVsfSBwYW5lbCDopoHmiZPlvIDnmoTlvLnnqpdcclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOaVsOaNrlxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNNb2RhbD10cnVlXSDmmK/lkKbmqKHmgIHlvLnlh7pcclxuICAgICAqIEBwYXJhbSB7e3g6bnVtYmVyLCB5Om51bWJlcn19IFtmcm9tXSDlvLnlh7rotbfngrnkvY3nva5cclxuICAgICAqIEByZXR1cm5zIHtJUGFuZWx9IOi/lOWbnuW8ueeql+WvueixoVxyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQYW5lbE1hbmFnZXIucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uIChwYW5lbCwgZGF0YSwgaXNNb2RhbCwgZnJvbSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGlzTW9kYWwgPT09IHZvaWQgMCkgeyBpc01vZGFsID0gdHJ1ZTsgfVxyXG4gICAgICAgIGlmICh0aGlzLl9wYW5lbHMuaW5kZXhPZihwYW5lbCkgPCAwKSB7XHJcbiAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICB0aGlzLl9wYW5lbHMucHVzaChwYW5lbCk7XHJcbiAgICAgICAgICAgIC8vIOW8ueeql+aJgOWcqOeahOihqOeOsOWxguW/hemhu+imgeaYvuekulxyXG4gICAgICAgICAgICBwYW5lbC5icmlkZ2UuaHRtbFdyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwiXCI7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluetlueVpVxyXG4gICAgICAgICAgICB2YXIgcG9saWN5ID0gcGFuZWwucG9saWN5IHx8IHBhbmVsLmJyaWRnZS5kZWZhdWx0UGFuZWxQb2xpY3kgfHwgbm9uZTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIHBhbmVsLm9uQmVmb3JlUG9wKGRhdGEsIGlzTW9kYWwsIGZyb20pO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChQYW5lbE1lc3NhZ2UuUEFORUxfQkVGT1JFX1BPUCwgcGFuZWwsIGlzTW9kYWwsIGZyb20pO1xyXG4gICAgICAgICAgICAvLyDosIPnlKjlh4blpIfmjqXlj6NcclxuICAgICAgICAgICAgcG9saWN5LnByZXBhcmUgJiYgcG9saWN5LnByZXBhcmUocGFuZWwpO1xyXG4gICAgICAgICAgICAvLyDmt7vliqDmmL7npLpcclxuICAgICAgICAgICAgdmFyIGJyaWRnZSA9IHBhbmVsLmJyaWRnZTtcclxuICAgICAgICAgICAgYnJpZGdlLmFkZENoaWxkKHBhbmVsLmJyaWRnZS5wYW5lbExheWVyLCBwYW5lbC5za2luKTtcclxuICAgICAgICAgICAgLy8g5qC55o2u5LyY5YWI57qn6L+b6KGM5o6S5bqPXHJcbiAgICAgICAgICAgIHRoaXMuX3BhbmVscy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJpQSA9IF90aGlzLl9wcmlvcml0aWVzLmdldChhKSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIHByaUIgPSBfdGhpcy5fcHJpb3JpdGllcy5nZXQoYikgfHwgMDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmlBIC0gcHJpQjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIOagueaNruaOkuW6j+WQjueahOmhuuW6j+iwg+aVtOaYvuekuumhuuW6j1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5fcGFuZWxzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICB0ZW1wLmJyaWRnZS5hZGRDaGlsZCh0ZW1wLmJyaWRnZS5wYW5lbExheWVyLCB0ZW1wLnNraW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOetlueVpeaOpeWPo1xyXG4gICAgICAgICAgICBwb2xpY3kucG9wKHBhbmVsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIHBhbmVsLm9uQWZ0ZXJQb3AoZGF0YSwgaXNNb2RhbCwgZnJvbSk7XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goUGFuZWxNZXNzYWdlLlBBTkVMX0FGVEVSX1BPUCwgcGFuZWwsIGlzTW9kYWwsIGZyb20pO1xyXG4gICAgICAgICAgICB9LCBmcm9tKTtcclxuICAgICAgICAgICAgLy8g6K6w5b2V5qih5oCB5pWw5o2uXHJcbiAgICAgICAgICAgIHRoaXMuX21vZGFsRGljdC5zZXQocGFuZWwsIGlzTW9kYWwpO1xyXG4gICAgICAgICAgICAvLyDmm7TmlrDmqKHmgIHpga7nvalcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVNb2RhbE1hc2socGFuZWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcGFuZWw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlhbPpl63kuIDkuKrlvLnnqpdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lQYW5lbH0gcGFuZWwg6KaB5YWz6Zet55qE5by556qXXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDmlbDmja5cclxuICAgICAqIEBwYXJhbSB7e3g6bnVtYmVyLCB5Om51bWJlcn19IFt0b10g5YWz6Zet57uI54K55L2N572uXHJcbiAgICAgKiBAcmV0dXJucyB7SVBhbmVsfSDov5Tlm57lvLnnqpflr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5kcm9wID0gZnVuY3Rpb24gKHBhbmVsLCBkYXRhLCB0bykge1xyXG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMuX3BhbmVscy5pbmRleE9mKHBhbmVsKTtcclxuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAvLyDmlbDmja7lhYjooYxcclxuICAgICAgICAgICAgdGhpcy5fcGFuZWxzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIC8vIOiOt+WPluetlueVpVxyXG4gICAgICAgICAgICB2YXIgcG9saWN5ID0gcGFuZWwucG9saWN5IHx8IHBhbmVsLmJyaWRnZS5kZWZhdWx0UGFuZWxQb2xpY3kgfHwgbm9uZTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIHBhbmVsLm9uQmVmb3JlRHJvcChkYXRhLCB0byk7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKFBhbmVsTWVzc2FnZS5QQU5FTF9CRUZPUkVfRFJPUCwgcGFuZWwsIHRvKTtcclxuICAgICAgICAgICAgLy8g6LCD55So562W55Wl5o6l5Y+jXHJcbiAgICAgICAgICAgIHBvbGljeS5kcm9wKHBhbmVsLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIHBhbmVsLm9uQWZ0ZXJEcm9wKGRhdGEsIHRvKTtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkea2iOaBr1xyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChQYW5lbE1lc3NhZ2UuUEFORUxfQUZURVJfRFJPUCwgcGFuZWwsIHRvKTtcclxuICAgICAgICAgICAgfSwgdG8pO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTkvJjlhYjnuqfmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fcHJpb3JpdGllcy5kZWxldGUocGFuZWwpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTmqKHmgIHmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fbW9kYWxEaWN0LmRlbGV0ZShwYW5lbCk7XHJcbiAgICAgICAgICAgIC8vIOabtOaWsOaooeaAgemBrue9qVxyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1vZGFsTWFzayhwYW5lbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYW5lbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjOmAmueUqOW8ueeql1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOmAmueUqOW8ueeql+imgeazqOWGjOWIsOeahOihqOeOsOWxguexu+Wei1xyXG4gICAgICogQHBhcmFtIHtJUHJvbXB0UGFuZWxDb25zdHJ1Y3Rvcn0gcHJvbXB0IOmAmueUqOW8ueeql+exu+Wei1xyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQYW5lbE1hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyUHJvbXB0ID0gZnVuY3Rpb24gKHR5cGUsIHByb21wdCkge1xyXG4gICAgICAgIHRoaXMuX3Byb21wdERpY3RbdHlwZV0gPSBwcm9tcHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlj5bmtojms6jlhozpgJrnlKjlvLnnqpdcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDopoHlj5bmtojms6jlhozpgJrnlKjlvLnnqpfnmoTooajnjrDlsYLnsbvlnotcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS51bnJlZ2lzdGVyUHJvbXB0ID0gZnVuY3Rpb24gKHR5cGUpIHtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcHJvbXB0RGljdFt0eXBlXTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWFuYWdlci5wcm90b3R5cGUucHJvbXB0ID0gZnVuY3Rpb24gKG1zZ09yUGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgaGFuZGxlcnNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwYXJhbXM7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBtc2dPclBhcmFtcyA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IHtcclxuICAgICAgICAgICAgICAgIG1zZzogbXNnT3JQYXJhbXMsXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyczogaGFuZGxlcnNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IG1zZ09yUGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlj5bliLDlvZPliY3lnLrmma/nmoTnsbvlnotcclxuICAgICAgICB2YXIgY3VyQnJpZGdlID0gYnJpZGdlTWFuYWdlci5jdXJyZW50QnJpZGdlO1xyXG4gICAgICAgIHZhciB0eXBlID0gY3VyQnJpZGdlICYmIGN1ckJyaWRnZS50eXBlO1xyXG4gICAgICAgIC8vIOeUqOWcuuaZr+exu+Wei+WPluWIsOW8ueeql+WvueixoVxyXG4gICAgICAgIHZhciBwcm9tcHRDbHMgPSB0aGlzLl9wcm9tcHREaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmIChwcm9tcHRDbHMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDmsqHmnInmib7liLDlvZPliY3mqKHlnZfnsbvlnovlhbPogZTnmoTpgJrnlKjlvLnnqpfnsbvlnovvvIzmlLnnlKjns7vnu5/lvLnnqpflh5HlkIjkuIDkuItcclxuICAgICAgICAgICAgYWxlcnQocGFyYW1zLm1zZyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5aKe5Yqg6buY6K6k5YC8XHJcbiAgICAgICAgZm9yICh2YXIgaSBpbiBwYXJhbXMuaGFuZGxlcnMpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBwYXJhbXMuaGFuZGxlcnNbaV07XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLnRleHQgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIudGV4dCA9IGhhbmRsZXIuZGF0YTtcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIuYnV0dG9uVHlwZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgaGFuZGxlci5idXR0b25UeXBlID0gQnV0dG9uVHlwZS5ub3JtYWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWunuS+i+WMllxyXG4gICAgICAgIHZhciBwcm9tcHQgPSBuZXcgcHJvbXB0Q2xzKCk7XHJcbiAgICAgICAgLy8g6K6+572u5LyY5YWI57qnXHJcbiAgICAgICAgdGhpcy5fcHJpb3JpdGllcy5zZXQocHJvbXB0LCBQYW5lbE1hbmFnZXJfMS5QUklPUklUWV9QUk9NUFQpO1xyXG4gICAgICAgIC8vIOaYvuekuuW8ueeql1xyXG4gICAgICAgIHByb21wdC5vcGVuKHBhcmFtcyk7XHJcbiAgICAgICAgLy8g5pu05paw5by556qXXHJcbiAgICAgICAgcHJvbXB0LnVwZGF0ZShwYXJhbXMpO1xyXG4gICAgICAgIC8vIOi/lOWbnuW8ueeql1xyXG4gICAgICAgIHJldHVybiBwcm9tcHQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrorablkYrnqpflj6PvvIjlj6rmnInkuIDkuKrnoa7lrprmjInpkq7vvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8SVByb21wdFBhcmFtcyl9IG1zZ09yUGFyYW1zIOimgeaYvuekuueahOaWh+acrO+8jOaIluiAheW8ueeql+aVsOaNrlxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gW29rSGFuZGxlcl0g56Gu5a6a5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcmV0dXJucyB7SVByb21wdFBhbmVsfSDov5Tlm57lvLnnqpflrp7kvZNcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5hbGVydCA9IGZ1bmN0aW9uIChtc2dPclBhcmFtcywgb2tIYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIHBhcmFtcztcclxuICAgICAgICBpZiAodHlwZW9mIG1zZ09yUGFyYW1zID09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgcGFyYW1zID0geyBtc2c6IG1zZ09yUGFyYW1zIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMgPSBtc2dPclBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcGFyYW1zLmhhbmRsZXJzID0gW1xyXG4gICAgICAgICAgICB7IGRhdGE6IFwi56Gu5a6aXCIsIGhhbmRsZXI6IG9rSGFuZGxlciwgYnV0dG9uVHlwZTogQnV0dG9uVHlwZS5pbXBvcnRhbnQgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvbXB0KHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrnoa7orqTnqpflj6PvvIjmnInkuIDkuKrnoa7lrprmjInpkq7lkozkuIDkuKrlj5bmtojmjInpkq7vvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyhzdHJpbmd8SVByb21wdFBhcmFtcyl9IG1zZ09yUGFyYW1zIOimgeaYvuekuueahOaWh+acrO+8jOaIluiAheW8ueeql+aVsOaNrlxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gW29rSGFuZGxlcl0g56Gu5a6a5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcGFyYW0geygpPT52b2lkfSBbY2FuY2VsSGFuZGxlcl0g5Y+W5raI5oyJ6ZKu54K55Ye75Zue6LCDXHJcbiAgICAgKiBAcmV0dXJucyB7SVByb21wdFBhbmVsfSDov5Tlm57lvLnnqpflrp7kvZNcclxuICAgICAqIEBtZW1iZXJvZiBQYW5lbE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgUGFuZWxNYW5hZ2VyLnByb3RvdHlwZS5jb25maXJtID0gZnVuY3Rpb24gKG1zZ09yUGFyYW1zLCBva0hhbmRsZXIsIGNhbmNlbEhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgcGFyYW1zO1xyXG4gICAgICAgIGlmICh0eXBlb2YgbXNnT3JQYXJhbXMgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBwYXJhbXMgPSB7IG1zZzogbXNnT3JQYXJhbXMgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IG1zZ09yUGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwYXJhbXMuaGFuZGxlcnMgPSBbXHJcbiAgICAgICAgICAgIHsgZGF0YTogXCLlj5bmtohcIiwgaGFuZGxlcjogY2FuY2VsSGFuZGxlciwgYnV0dG9uVHlwZTogQnV0dG9uVHlwZS5ub3JtYWwgfSxcclxuICAgICAgICAgICAgeyBkYXRhOiBcIuehruWumlwiLCBoYW5kbGVyOiBva0hhbmRsZXIsIGJ1dHRvblR5cGU6IEJ1dHRvblR5cGUuaW1wb3J0YW50IH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnByb21wdChwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIHZhciBQYW5lbE1hbmFnZXJfMTtcclxuICAgIFBhbmVsTWFuYWdlci5QUklPUklUWV9OT1JNQUwgPSAwO1xyXG4gICAgUGFuZWxNYW5hZ2VyLlBSSU9SSVRZX1BST01QVCA9IDE7XHJcbiAgICBQYW5lbE1hbmFnZXIgPSBQYW5lbE1hbmFnZXJfMSA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgUGFuZWxNYW5hZ2VyKTtcclxuICAgIHJldHVybiBQYW5lbE1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFBhbmVsTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHBhbmVsTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KFBhbmVsTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wYW5lbC9QYW5lbE1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDIyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGV4dGVuZE9iamVjdCB9IGZyb20gXCIuLi8uLi91dGlscy9PYmplY3RVdGlsXCI7XHJcbmZ1bmN0aW9uIHdyYXBFdmFsRnVuYyhleHApIHtcclxuICAgIC8vIOi/meS4quaWueazleeahOWKn+iDveS4u+imgeaYr+WwhuWkmuS4qnNjb3Bl5ZCI5bm25oiQ5Li65LiA5Liqc2NvcGVcclxuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHNjb3BlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHNjb3Blc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2NvcGUgPSBleHRlbmRPYmplY3QuYXBwbHkodm9pZCAwLCBbe31dLmNvbmNhdChzY29wZXMucmV2ZXJzZSgpKSk7XHJcbiAgICAgICAgcmV0dXJuIGV4cC5jYWxsKHRoaXMsIHNjb3BlKTtcclxuICAgIH07XHJcbn1cclxuLyoqXHJcbiAqIOWwhuihqOi+vuW8j+WMheijheaIkOS4uuaWueazlVxyXG4gKlxyXG4gKiBAcGFyYW0geyhFdmFsRXhwKX0gZXhwIOihqOi+vuW8j+aIluaWueazlVxyXG4gKiBAcGFyYW0ge251bWJlcn0gc2NvcGVDb3VudCDlj4LmlbDkuKrmlbDvvIzku4XlnKhleHDkuLrooajovr7lvI/ml7bmnInmlYhcclxuICogQHJldHVybnMge0V2YWxGdW5jfSDljIXoo4Xmlrnms5VcclxuICovXHJcbmZ1bmN0aW9uIHdyYXBFdmFsRnVuY0V4cChleHAsIHNjb3BlQ291bnQpIHtcclxuICAgIGlmICh0eXBlb2YgZXhwID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgdmFyIGFyZ0xpc3QgPSBbXTtcclxuICAgICAgICB2YXIgZXhwU3RyID0gZXhwO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NvcGVDb3VudDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGFyZ0xpc3QucHVzaChcInNcIiArIGkpO1xyXG4gICAgICAgICAgICBleHBTdHIgPSBcIndpdGgoc1wiICsgaSArIFwifHx7fSl7XCIgKyBleHBTdHIgKyBcIn1cIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEZ1bmN0aW9uKGFyZ0xpc3Quam9pbihcIixcIiksIGV4cFN0cik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gd3JhcEV2YWxGdW5jKGV4cCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOWIm+W7uuS4gOS4quaJp+ihjOaWueazle+8jOeUqOS6juacquadpeaJp+ihjFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7KEV2YWxFeHApfSBleHAg6KGo6L6+5byP5oiW5pa55rOVXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBbc2NvcGVDb3VudD0wXSDmiYDpnIDnmoTln5/nmoTmlbDph49cclxuICogQHJldHVybnMge0V2YWxGdW5jfSDliJvlu7rnmoTmlrnms5VcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSdW5GdW5jKGV4cCwgc2NvcGVDb3VudCkge1xyXG4gICAgaWYgKHNjb3BlQ291bnQgPT09IHZvaWQgMCkgeyBzY29wZUNvdW50ID0gMDsgfVxyXG4gICAgaWYgKHR5cGVvZiBleHAgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICB2YXIgZnVuYztcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBmdW5jID0gd3JhcEV2YWxGdW5jRXhwKGV4cCwgc2NvcGVDb3VudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgLy8g5Y+v6IO95piv5p+Q5Lqb54mI5pys55qE6Kej6YeK5Zmo5LiN6K6k6K+G5qih5p2/5a2X56ym5Liy77yM5bCG5qih5p2/5a2X56ym5Liy5Y+Y5oiQ5pmu6YCa5a2X56ym5LiyXHJcbiAgICAgICAgICAgIHZhciBzZXBTdHIgPSAoZXhwLmluZGV4T2YoJ1wiJykgPCAwID8gJ1wiJyA6IFwiJ1wiKTtcclxuICAgICAgICAgICAgLy8g5bCGZXhw5Lit55qEwrfmm7/mjaLkuLonXHJcbiAgICAgICAgICAgIHZhciByZWcgPSAvKFteXFxcXF0/KWAvZztcclxuICAgICAgICAgICAgZXhwID0gZXhwLnJlcGxhY2UocmVnLCBcIiQxXCIgKyBzZXBTdHIpO1xyXG4gICAgICAgICAgICAvLyDlsIZleHDkuK0key4uLn3mm7/mjaLkuLpcIiArIC4uLiArIFwi55qE5b2i5byPXHJcbiAgICAgICAgICAgIHJlZyA9IC9cXCRcXHsoLio/KVxcfS9nO1xyXG4gICAgICAgICAgICBleHAgPSBleHAucmVwbGFjZShyZWcsIHNlcFN0ciArIFwiKygkMSkrXCIgKyBzZXBTdHIpO1xyXG4gICAgICAgICAgICAvLyDph43mlrDnlJ/miJDmlrnms5Xlubbov5Tlm55cclxuICAgICAgICAgICAgZnVuYyA9IHdyYXBFdmFsRnVuY0V4cChleHAsIHNjb3BlQ291bnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZnVuYztcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB3cmFwRXZhbEZ1bmMoZXhwKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog55u05o6l5omn6KGM6KGo6L6+5byP77yM5LiN5rGC5YC844CC6K+l5pa55rOV5Y+v5Lul5omn6KGM5aSa5p2h6K+t5Y+lXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDooajovr7lvI/miJbmlrnms5VcclxuICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkVxyXG4gKiBAcGFyYW0gey4uLmFueVtdfSBzY29wZXMg6KGo6L6+5byP55qE5L2c55So5Z+f5YiX6KGoXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcnVuRXhwKGV4cCwgdGhpc0FyZykge1xyXG4gICAgdmFyIHNjb3BlcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBzY29wZXNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICBjcmVhdGVSdW5GdW5jKGV4cCwgc2NvcGVzLmxlbmd0aCkuYXBwbHkodGhpc0FyZywgc2NvcGVzKTtcclxufVxyXG4vKipcclxuICog5Yib5bu65LiA5Liq6KGo6L6+5byP5rGC5YC85pa55rOV77yM55So5LqO5pyq5p2l5omn6KGMXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDooajovr7lvI/miJbmlrnms5VcclxuICogQHBhcmFtIHtudW1iZXJ9IFtzY29wZUNvdW50PTBdIOaJgOmcgOeahOWfn+eahOaVsOmHj1xyXG4gKiBAcmV0dXJucyB7RXZhbEZ1bmN9IOWIm+W7uueahOaWueazlVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUV2YWxGdW5jKGV4cCwgc2NvcGVDb3VudCkge1xyXG4gICAgaWYgKHNjb3BlQ291bnQgPT09IHZvaWQgMCkgeyBzY29wZUNvdW50ID0gMDsgfVxyXG4gICAgaWYgKHR5cGVvZiBleHAgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVJ1bkZ1bmMoXCJyZXR1cm4gXCIgKyBleHAsIHNjb3BlQ291bnQpO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIHJldHVybiB3cmFwRXZhbEZ1bmMoZXhwKTtcclxufVxyXG4vKipcclxuICog6KGo6L6+5byP5rGC5YC877yM5peg5rOV5omn6KGM5aSa5p2h6K+t5Y+lXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDooajovr7lvI/miJbmlrnms5VcclxuICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkVxyXG4gKiBAcGFyYW0gey4uLmFueVtdfSBzY29wZXMg6KGo6L6+5byP55qE5L2c55So5Z+f5YiX6KGoXHJcbiAqIEByZXR1cm5zIHsqfSDov5Tlm57lgLxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBldmFsRXhwKGV4cCwgdGhpc0FyZykge1xyXG4gICAgdmFyIHNjb3BlcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBzY29wZXNbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gY3JlYXRlRXZhbEZ1bmMoZXhwLCBzY29wZXMubGVuZ3RoKS5hcHBseSh0aGlzQXJnLCBzY29wZXMpO1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL1V0aWxzLmpzXG4vLyBtb2R1bGUgaWQgPSAyM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIOeUqOadpeiusOW9leeoi+W6j+i/kOihjOaXtumXtO+8jOW5tuS4lOaPkOS+m+W7tui/n+Wbnuiwg+aIlumikeeOh+Wbnuiwg+WKn+iDvVxyXG4qL1xyXG52YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU3lzdGVtKCkge1xyXG4gICAgICAgIC8vIOi/memHjOWwneivleS4gOS4i1RT55qEVHVwbGXnsbvlnovigJTigJRSYXlraWRcclxuICAgICAgICB0aGlzLl9uZXh0RnJhbWVMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5fdGltZXIgPSAwO1xyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBpZiAod2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShvblJlcXVlc3RBbmltYXRpb25GcmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuI3mlK/mjIFyZXF1ZXN0QW5pbWF0aW9uRnJhbWXliJnmlLnnlKhzZXRUaW1lb3V06K6h5pe277yM5bu26L+f5pe26Ze0MTAwMC82MOavq+enklxyXG4gICAgICAgICAgICB2YXIgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1clRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LWL5YC8dGltZXJcclxuICAgICAgICAgICAgICAgIHNlbGYuX3RpbWVyID0gY3VyVGltZSAtIHN0YXJ0VGltZTtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqHRpY2vmlrnms5VcclxuICAgICAgICAgICAgICAgIHNlbGYudGljaygpO1xyXG4gICAgICAgICAgICB9LCAxMDAwIC8gNjApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvblJlcXVlc3RBbmltYXRpb25GcmFtZSh0aW1lcikge1xyXG4gICAgICAgICAgICAvLyDotYvlgLx0aW1lcu+8jOi/meS4quaWueazlemHjOaXoOazleiOt+WPlnRoaXPvvIzlm6DmraTpnIDopoHpgJrov4fms6jlhaXnmoTpnZnmgIHlsZ7mgKflj5bliLDoh6rouqvlrp7kvotcclxuICAgICAgICAgICAgc2VsZi5fdGltZXIgPSB0aW1lcjtcclxuICAgICAgICAgICAgLy8g6LCD55SodGlja+aWueazlVxyXG4gICAgICAgICAgICBzZWxmLnRpY2soKTtcclxuICAgICAgICAgICAgLy8g6K6h5YiS5LiL5LiA5qyh5omn6KGMXHJcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShvblJlcXVlc3RBbmltYXRpb25GcmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bku47nqIvluo/ov5DooYzliLDlvZPliY3miYDnu4/ov4fnmoTmr6vnp5LmlbBcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSDmr6vnp5LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5nZXRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdGltZXI7XHJcbiAgICB9O1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIOiwg+eUqOS4i+S4gOW4p+Wbnuiwg1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0aGlzLl9uZXh0RnJhbWVMaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fbmV4dEZyYW1lTGlzdC5zaGlmdCgpO1xyXG4gICAgICAgICAgICBkYXRhWzBdLmFwcGx5KGRhdGFbMV0sIGRhdGFbMl0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWcqOS4i+S4gOW4p+aJp+ihjOafkOS4quaWueazlVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5biM5pyb5Zyo5LiL5LiA5bin5omn6KGM55qE5p+Q5Liq5pa55rOVXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOaWueazleWPguaVsOWIl+ihqFxyXG4gICAgICogQHJldHVybnMge0lDYW5jZWxhYmxlfSDlj6/lj5bmtojnmoTlj6Xmn4RcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5uZXh0RnJhbWUgPSBmdW5jdGlvbiAoaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGF0YSA9IFtoYW5kbGVyLCB0aGlzQXJnLCBhcmdzXTtcclxuICAgICAgICB0aGlzLl9uZXh0RnJhbWVMaXN0LnB1c2goZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBfdGhpcy5fbmV4dEZyYW1lTGlzdC5pbmRleE9mKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX25leHRGcmFtZUxpc3Quc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmr4/luKfmiafooYzmn5DkuKrmlrnms5XvvIznm7TliLDlj5bmtojkuLrmraJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOavj+W4p+aJp+ihjOeahOafkOS4quaWueazlVxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDmlrnms5Xlj4LmlbDliJfooahcclxuICAgICAqIEByZXR1cm5zIHtJQ2FuY2VsYWJsZX0g5Y+v5Y+W5raI55qE5Y+l5p+EXHJcbiAgICAgKiBAbWVtYmVyb2YgU3lzdGVtXHJcbiAgICAgKi9cclxuICAgIFN5c3RlbS5wcm90b3R5cGUuZW50ZXJGcmFtZSA9IGZ1bmN0aW9uIChoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGNhbmNlbGFibGUgPSB0aGlzLm5leHRGcmFtZS5hcHBseSh0aGlzLCBbb25OZXh0RnJhbWUsIHRoaXNBcmddLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgdmFyIGNhbmNlbGVkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5jZWxhYmxlLmNhbmNlbCgpO1xyXG4gICAgICAgICAgICAgICAgY2FuY2VsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBmdW5jdGlvbiBvbk5leHRGcmFtZSgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5rKh6KKr5Y+W5raI77yM5YiZ5omn6KGM5LiL5LiA5binXHJcbiAgICAgICAgICAgIGlmICghY2FuY2VsZWQpXHJcbiAgICAgICAgICAgICAgICBjYW5jZWxhYmxlID0gc2VsZi5uZXh0RnJhbWUuYXBwbHkoc2VsZiwgW29uTmV4dEZyYW1lLCB0aGlzXS5jb25jYXQoYXJncykpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruW7tui/n+Wbnuiwg1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkdXJhdGlvbiDlu7bov5/mr6vnp5LlgLxcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5Zue6LCD5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOimgeS8oOmAkueahOWPguaVsFxyXG4gICAgICogQHJldHVybnMge0lDYW5jZWxhYmxlfSDlj6/lj5bmtojnmoTlj6Xmn4RcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5zZXRUaW1lb3V0ID0gZnVuY3Rpb24gKGR1cmF0aW9uLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc3RhcnRUaW1lciA9IHRoaXMuX3RpbWVyO1xyXG4gICAgICAgIC8vIOWQr+WKqOiuoeaXtuWZqFxyXG4gICAgICAgIHZhciBuZXh0RnJhbWUgPSB0aGlzLm5leHRGcmFtZSh0aWNrLCB0aGlzKTtcclxuICAgICAgICBmdW5jdGlvbiB0aWNrKCkge1xyXG4gICAgICAgICAgICB2YXIgZGVsdGEgPSB0aGlzLl90aW1lciAtIHN0YXJ0VGltZXI7XHJcbiAgICAgICAgICAgIGlmIChkZWx0YSA+PSBkdXJhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgbmV4dEZyYW1lID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIuYXBwbHkodGhpc0FyZywgYXJncyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0RnJhbWUgPSB0aGlzLm5leHRGcmFtZSh0aWNrLCB0aGlzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjYW5jZWw6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG5leHRGcmFtZSAmJiBuZXh0RnJhbWUuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICBuZXh0RnJhbWUgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiuvue9ruW7tuaXtumXtOmalFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkdXJhdGlvbiDlu7bov5/mr6vnp5LlgLxcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5Zue6LCD5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBhcmdzIOimgeS8oOmAkueahOWPguaVsFxyXG4gICAgICogQHJldHVybnMge0lDYW5jZWxhYmxlfSDlj6/lj5bmtojnmoTlj6Xmn4RcclxuICAgICAqIEBtZW1iZXJvZiBTeXN0ZW1cclxuICAgICAqL1xyXG4gICAgU3lzdGVtLnByb3RvdHlwZS5zZXRJbnRlcnZhbCA9IGZ1bmN0aW9uIChkdXJhdGlvbiwgaGFuZGxlciwgdGhpc0FyZykge1xyXG4gICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRpbWVvdXQgPSB0aGlzLnNldFRpbWVvdXQoZHVyYXRpb24sIG9uVGltZW91dCwgdGhpcyk7XHJcbiAgICAgICAgdmFyIGNhbmNlbGVkID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2FuY2VsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ICYmIHRpbWVvdXQuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGNhbmNlbGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZnVuY3Rpb24gb25UaW1lb3V0KCkge1xyXG4gICAgICAgICAgICAvLyDop6blj5Hlm57osINcclxuICAgICAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzQXJnLCBhcmdzKTtcclxuICAgICAgICAgICAgLy8g57un57ut5LiL5LiA5qyhXHJcbiAgICAgICAgICAgIGlmICghY2FuY2VsZWQpXHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gdGhpcy5zZXRUaW1lb3V0KGR1cmF0aW9uLCBvblRpbWVvdXQsIHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBTeXN0ZW0gPSB0c2xpYl8xLl9fZGVjb3JhdGUoW1xyXG4gICAgICAgIEluamVjdGFibGUsXHJcbiAgICAgICAgdHNsaWJfMS5fX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW10pXHJcbiAgICBdLCBTeXN0ZW0pO1xyXG4gICAgcmV0dXJuIFN5c3RlbTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgU3lzdGVtO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgc3lzdGVtID0gY29yZS5nZXRJbmplY3QoU3lzdGVtKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3N5c3RlbS9TeXN0ZW0uanNcbi8vIG1vZHVsZSBpZCA9IDI0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxOC0wMy0wNVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxOC0wMy0wNVxyXG4gKlxyXG4gKiDkuK3ku4vogIXmtojmga9cclxuKi9cclxudmFyIE1lZGlhdG9yTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE1lZGlhdG9yTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Lit5LuL6ICF5byA5ZCv5a6M5q+V5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvck1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3JNZXNzYWdlLk1FRElBVE9SX09QRU5FRCA9IFwibWVkaWF0b3JPcGVuZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog5Lit5LuL6ICF5YWz6Zet5a6M5q+V5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBNZWRpYXRvck1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTWVkaWF0b3JNZXNzYWdlLk1FRElBVE9SX0NMT1NFRCA9IFwibWVkaWF0b3JDbG9zZWRcIjtcclxuICAgIHJldHVybiBNZWRpYXRvck1lc3NhZ2U7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IE1lZGlhdG9yTWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gMjVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLy8vIDxhbWQtbW9kdWxlIG5hbWU9XCJET01CcmlkZ2VcIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwidHdlZW4uanNcIi8+XHJcbmltcG9ydCB7IGdldE9iamVjdEhhc2hzLCBleHRlbmRPYmplY3QgfSBmcm9tIFwib2x5bXB1cy1yL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IHsgYXNzZXRzTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IHN5c3RlbSB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3N5c3RlbS9TeXN0ZW1cIjtcclxuaW1wb3J0IE1hc2tFbnRpdHkgZnJvbSBcIi4vZG9tL21hc2svTWFza0VudGl0eVwiO1xyXG5pbXBvcnQgeyBjb3B5UmVmLCB3cmFwU2tpbiwgaXNET01TdHIsIGlzRE9NUGF0aCwgdG9IVE1MRWxlbWVudCB9IGZyb20gXCIuL2RvbS91dGlscy9Ta2luVXRpbFwiO1xyXG5pbXBvcnQgQmFja1BhbmVsUG9saWN5IGZyb20gXCIuL2RvbS9wYW5lbC9CYWNrUGFuZWxQb2xpY3lcIjtcclxuaW1wb3J0IEZhZGVTY2VuZVBvbGljeSBmcm9tIFwiLi9kb20vc2NlbmUvRmFkZVNjZW5lUG9saWN5XCI7XHJcbmltcG9ydCAqIGFzIFRXRUVOIGZyb20gXCJAdHdlZW5qcy90d2Vlbi5qc1wiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMThcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMThcclxuICpcclxuICog5Z+65LqORE9N55qE6KGo546w5bGC5qGl5a6e546wXHJcbiovXHJcbnZhciBET01CcmlkZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBET01CcmlkZ2UocGFyYW1zKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6buY6K6k5by556qX562W55WlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SVBhbmVsUG9saWN5fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmRlZmF1bHRQYW5lbFBvbGljeSA9IG5ldyBCYWNrUGFuZWxQb2xpY3koKTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpu5jorqTlnLrmma/liIfmjaLnrZbnlaVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJU2NlbmVQb2xpY3l9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFNjZW5lUG9saWN5ID0gbmV3IEZhZGVTY2VuZVBvbGljeSgpO1xyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2luaXRQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5booajnjrDlsYLnsbvlnovlkI3np7BcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gRE9NQnJpZGdlLlRZUEU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJodG1sV3JhcHBlclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6KGo546w5bGCSFRNTOWMheijheWZqO+8jOWPr+S7peWvueWFtuagt+W8j+i/m+ihjOiHquWumuS5ieiwg+aVtFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTUJyaWRnZS5wcm90b3R5cGUsIFwicm9vdFwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5qC55pi+56S66IqC54K5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJzdGFnZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6Iie5Y+w5byV55So77yMRE9N55qE6Iie5Y+w5oyH5ZCR5qC56IqC54K5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJiZ0xheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bog4zmma/lrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9iZ0xheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTUJyaWRnZS5wcm90b3R5cGUsIFwic2NlbmVMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Zy65pmv5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2NlbmVMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcImZyYW1lTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluahhuaetuWuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJwYW5lbExheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5blvLnnqpflrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYW5lbExheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTUJyaWRnZS5wcm90b3R5cGUsIFwibWFza0xheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bpga7nvanlrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tYXNrTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJ0b3BMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6aG257qn5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SFRNTEVsZW1lbnR9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdG9wTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRE9NQnJpZGdlLnByb3RvdHlwZSwgXCJwcm9tcHRDbGFzc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6YCa55So5o+Q56S65qGGXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SVByb21wdFBhbmVsQ29uc3RydWN0b3J9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5wcm9tcHRDbGFzcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShET01CcmlkZ2UucHJvdG90eXBlLCBcIm1hc2tFbnRpdHlcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlumBrue9qeWunuS9k1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lNYXNrRW50aXR5fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBNYXNrRW50aXR5KHRoaXMuX2luaXRQYXJhbXMubWFza0RhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5jcmVhdGVMYXllciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyDnlJ/miJDkuIDkuKrniLblrrnlmajvvIzkuI3lk43lupTngrnlh7vkuovku7bvvIzkvYbkvJrmkpHotbflhajlsY/luZXojIPlm7RcclxuICAgICAgICB2YXIgbGF5ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIGxheWVyLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgIGxheWVyLnN0eWxlLnRvcCA9IFwiMCVcIjtcclxuICAgICAgICBsYXllci5zdHlsZS5sZWZ0ID0gXCIwJVwiO1xyXG4gICAgICAgIGxheWVyLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgbGF5ZXIuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgbGF5ZXIuc3R5bGUucG9pbnRlckV2ZW50cyA9IFwibm9uZVwiO1xyXG4gICAgICAgIHRoaXMucm9vdC5hcHBlbmRDaGlsZChsYXllcik7XHJcbiAgICAgICAgLy8g55Sf5oiQ5LiA5Liq5a2Q5a655Zmo77yM5a6e6ZmF55So5p2l5pS+572u5a2Q5a+56LGh77yM55uu55qE5piv5ZON5bqU54K55Ye75LqL5Lu2XHJcbiAgICAgICAgdmFyIHN1YkxheWVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICBzdWJMYXllci5zdHlsZS5wb2ludGVyRXZlbnRzID0gXCJhdXRvXCI7XHJcbiAgICAgICAgbGF5ZXIuYXBwZW5kQ2hpbGQoc3ViTGF5ZXIpO1xyXG4gICAgICAgIC8vIOi/lOWbnuWtkOWuueWZqFxyXG4gICAgICAgIHJldHVybiBzdWJMYXllcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMluihqOeOsOWxguahpe+8jOWPr+S7peayoeacieivpeaWueazle+8jOayoeacieivpeaWueazleWImeihqOekuuivpeihqOeOsOWxguaXoOmcgOWIneWni+WMllxyXG4gICAgICogQHBhcmFtIHsoKT0+dm9pZH0gY29tcGxldGUg5Yid5aeL5YyW5a6M5q+V5ZCO55qE5Zue6LCDXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb21wbGV0ZSkge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+WQjeensO+8jOWImei9rOWPmOaIkOW8leeUqFxyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDlpoLmnpzmmK/nqbrvvIzliJnnlJ/miJDkuIDkuKpcclxuICAgICAgICBpZiAoIXRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWIm+W7uuiDjOaZr+aYvuekuuWxglxyXG4gICAgICAgIHRoaXMuX2JnTGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyKCk7XHJcbiAgICAgICAgLy8g5Yib5bu65Zy65pmv5pi+56S65bGCXHJcbiAgICAgICAgdGhpcy5fc2NlbmVMYXllciA9IHRoaXMuY3JlYXRlTGF5ZXIoKTtcclxuICAgICAgICAvLyDliJvlu7rmoYbmnrbmmL7npLrlsYJcclxuICAgICAgICB0aGlzLl9mcmFtZUxheWVyID0gdGhpcy5jcmVhdGVMYXllcigpO1xyXG4gICAgICAgIC8vIOWIm+W7uuW8ueWHuuWxglxyXG4gICAgICAgIHRoaXMuX3BhbmVsTGF5ZXIgPSB0aGlzLmNyZWF0ZUxheWVyKCk7XHJcbiAgICAgICAgLy8g5Yib5bu66YGu572p5bGCXHJcbiAgICAgICAgdGhpcy5fbWFza0xheWVyID0gdGhpcy5jcmVhdGVMYXllcigpO1xyXG4gICAgICAgIC8vIOWIm+W7uumhtue6p+aYvuekuuWxglxyXG4gICAgICAgIHRoaXMuX3RvcExheWVyID0gdGhpcy5jcmVhdGVMYXllcigpO1xyXG4gICAgICAgIC8vIOa3u+WKoFR3ZWVuLmpz6amx5YqoXHJcbiAgICAgICAgc3lzdGVtLmVudGVyRnJhbWUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDmr4/mrKHkvb/nlKjmnIDmlrDnmoTlvZPliY3ov5DooYzmr6vnp5LmlbDmm7TmlrBUd2Vlbi5qc1xyXG4gICAgICAgICAgICBUV0VFTi51cGRhdGUoc3lzdGVtLmdldFRpbWVyKCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIGNvbXBsZXRlKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat55qu6IKk5piv5ZCm5pivRE9N5pi+56S66IqC54K5XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxzdHJpbmd8c3RyaW5nW119IHNraW4g55qu6IKk5a+56LGhXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0g5piv5ZCm5pivRE9N5pi+56S66IqC54K5XHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuaXNNeVNraW4gPSBmdW5jdGlvbiAoc2tpbikge1xyXG4gICAgICAgIGlmIChza2luIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIGlmICh0eXBlb2Ygc2tpbiA9PT0gXCJzdHJpbmdcIiAmJiAoaXNET01QYXRoKHNraW4pIHx8IGlzRE9NU3RyKHNraW4pKSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgaWYgKHNraW4gaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICAvLyDmlbDnu4Tph4zmr4/kuIDkuKrlhYPntKDpg73lv4XpobvmmK/nmq7ogqRcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgc2tpbl8xID0gc2tpbjsgX2kgPCBza2luXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHNraW5fMVtfaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoISh0eXBlb2YgdGVtcCA9PT0gXCJzdHJpbmdcIiAmJiAoaXNET01QYXRoKHRlbXApIHx8IGlzRE9NU3RyKHRlbXApKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDljIXoo4VIVE1MRWxlbWVudOiKgueCuVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8c3RyaW5nfHN0cmluZ1tdfSBza2luIOWOn+Wni0hUTUxFbGVtZW506IqC54K5XHJcbiAgICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9IOWMheijheWQjueahEhUTUxFbGVtZW506IqC54K5XHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUud3JhcFNraW4gPSBmdW5jdGlvbiAobWVkaWF0b3IsIHNraW4pIHtcclxuICAgICAgICByZXR1cm4gd3JhcFNraW4obWVkaWF0b3IsIHNraW4pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pu/5o2i55qu6IKk77yM55So5LqO57uE5Lu25Y+Y6Lqr5pe25LiN5ZCM6KGo546w5bGC5qGl55qE5aSE55CGXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50IOW9k+WJjeearuiCpFxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxzdHJpbmd8c3RyaW5nW119IHRhcmdldCDopoHmm7/mjaLnmoTnmq7ogqRcclxuICAgICAqIEByZXR1cm5zIHsqfSDmm7/mjaLlrozmr5XnmoTnmq7ogqRcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5yZXBsYWNlU2tpbiA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgdGFyZ2V0ID0gdG9IVE1MRWxlbWVudCh0YXJnZXQpO1xyXG4gICAgICAgIC8vIOWmguaenOacieeItuiKgueCue+8jOWImeeUqOebruagh+iKgueCueabv+aNouW9k+WJjeiKgueCueS9jee9rlxyXG4gICAgICAgIHZhciBwYXJlbnQgPSBjdXJyZW50LnBhcmVudEVsZW1lbnQ7XHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHRhcmdldCwgY3VycmVudCk7XHJcbiAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChjdXJyZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6YeN5paw5YyF6KOF6IqC54K5XHJcbiAgICAgICAgdGhpcy53cmFwU2tpbihtZWRpYXRvciwgdGFyZ2V0KTtcclxuICAgICAgICAvLyDov5Tlm57nmq7ogqRcclxuICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5ZCM5q2l55qu6IKk77yM55So5LqO57uE5Lu25Y+Y6Lqr5ZCO55qE6YeN5paw5a6a5L2NXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtIVE1MRWxlbWVudH0gY3VycmVudCDlvZPliY3nmq7ogqRcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCDmm7/mjaLnmoTnmq7ogqRcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5zeW5jU2tpbiA9IGZ1bmN0aW9uIChjdXJyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBpZiAoIWN1cnJlbnQgfHwgIXRhcmdldClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIERPTeaXoOmcgOeJueaEj+WQjOatpe+8jOWboOS4uuWFtuagt+W8j+mDveWPr+S7peS7pWNzc+agt+W8j+aWueW8j+WcqOWklumDqOihqOekuu+8jOiAjOS7heacieW9k+WJjeiKgueCueeahHN0eWxl5bGe5oCn5piv6ZyA6KaB5ZCM5q2l55qEXHJcbiAgICAgICAgZXh0ZW5kT2JqZWN0KHRhcmdldC5zdHlsZSwgY3VycmVudC5zdHlsZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJvlu7rkuIDkuKrnqbrnmoTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9XHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuY3JlYXRlRW1wdHlEaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnQg6KaB5re75Yqg5Yiw55qE54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCDooqvmt7vliqDnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IOi/lOWbnuiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5hcHBlbmRDaGlsZCh0YXJnZXQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5oyJ57Si5byV5re75Yqg5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnQg6KaB5re75Yqg5Yiw55qE54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCDooqvmt7vliqDnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDopoHmt7vliqDliLDnmoTniLbnuqfntKLlvJVcclxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IOi/lOWbnuiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmFkZENoaWxkQXQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQsIGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5pbnNlcnRCZWZvcmUodGFyZ2V0LCB0aGlzLmdldENoaWxkQXQocGFyZW50LCBpbmRleCkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5pi+56S65a+56LGhXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRhcmdldCDooqvnp7vpmaTnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IOi/lOWbnuiiq+enu+mZpOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudCAmJiB0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudEVsZW1lbnQgPT09IHBhcmVudClcclxuICAgICAgICAgICAgcmV0dXJuIHBhcmVudC5yZW1vdmVDaGlsZCh0YXJnZXQpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaMiee0ouW8leenu+mZpOaYvuekulxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOe0ouW8lVxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g6L+U5Zue6KKr56e76Zmk55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlQ2hpbGQocGFyZW50LCB0aGlzLmdldENoaWxkQXQocGFyZW50LCBpbmRleCkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5omA5pyJ5pi+56S65a+56LGhXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGRyZW4gPSBmdW5jdGlvbiAocGFyZW50KSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHBhcmVudC5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQocGFyZW50LmNoaWxkcmVuLml0ZW0oaSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlueItuWuueWZqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IOebruagh+WvueixoVxyXG4gICAgICogQHJldHVybnMge0VsZW1lbnR9IOeItuWuueWZqFxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmdldFBhcmVudCA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcclxuICAgICAgICByZXR1cm4gdGFyZ2V0LnBhcmVudEVsZW1lbnQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmjIflrprntKLlvJXlpITnmoTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCDmjIflrprniLbnuqfntKLlvJVcclxuICAgICAqIEByZXR1cm4ge0VsZW1lbnR9IOe0ouW8leWkhOeahOaYvuekuuWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIERPTUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLmdldENoaWxkQXQgPSBmdW5jdGlvbiAocGFyZW50LCBpbmRleCkge1xyXG4gICAgICAgIHJldHVybiBwYXJlbnQuY2hpbGRyZW4uaXRlbShpbmRleCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmmL7npLrntKLlvJVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdGFyZ2V0IOWtkOaYvuekuuWvueixoVxyXG4gICAgICogQHJldHVybiB7bnVtYmVyfSB0YXJnZXTlnKhwYXJlbnTkuK3nmoTntKLlvJVcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5nZXRDaGlsZEluZGV4ID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHBhcmVudC5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGFyZ2V0ID09PSBwYXJlbnQuY2hpbGRyZW4uaXRlbShpKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpgJrov4flkI3np7Dojrflj5bmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOWvueixoeWQjeensFxyXG4gICAgICogQHJldHVybiB7RWxlbWVudH0g5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRCeU5hbWUgPSBmdW5jdGlvbiAocGFyZW50LCBuYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5jaGlsZHJlbi5uYW1lZEl0ZW0obmFtZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blrZDmmL7npLrlr7nosaHmlbDph49cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEByZXR1cm4ge251bWJlcn0g5a2Q5pi+56S65a+56LGh5pWw6YePXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRDb3VudCA9IGZ1bmN0aW9uIChwYXJlbnQpIHtcclxuICAgICAgICByZXR1cm4gcGFyZW50LmNoaWxkRWxlbWVudENvdW50O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L296LWE5rqQXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gYXNzZXRzIOi1hOa6kOaVsOe7hFxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOi1hOa6kOWIl+ihqFxyXG4gICAgICogQHBhcmFtIHsoZXJyPzpFcnJvcik9PnZvaWR9IGhhbmRsZXIg5Zue6LCD5Ye95pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUubG9hZEFzc2V0cyA9IGZ1bmN0aW9uIChhc3NldHMsIG1lZGlhdG9yLCBoYW5kbGVyKSB7XHJcbiAgICAgICAgLy8g5byA5aeL5Yqg6L2955qu6IKk5YiX6KGoXHJcbiAgICAgICAgaWYgKGFzc2V0cylcclxuICAgICAgICAgICAgYXNzZXRzID0gYXNzZXRzLmNvbmNhdCgpO1xyXG4gICAgICAgIGxvYWROZXh0KCk7XHJcbiAgICAgICAgZnVuY3Rpb24gbG9hZE5leHQoKSB7XHJcbiAgICAgICAgICAgIGlmICghYXNzZXRzIHx8IGFzc2V0cy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc2tpbiA9IGFzc2V0cy5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgYXNzZXRzTWFuYWdlci5sb2FkQXNzZXRzKHNraW4sIGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgRXJyb3IpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXIocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWROZXh0KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOebkeWQrOS6i+S7tu+8jOS7jui/meS4quaWueazleebkeWQrOeahOS6i+S7tuS8muWcqOS4reS7i+iAhemUgOavgeaXtuiiq+iHquWKqOenu+mZpOebkeWQrFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7RXZlbnRUYXJnZXR9IHRhcmdldCDkuovku7bnm67moIflr7nosaFcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOS6i+S7tuexu+Wei1xyXG4gICAgICogQHBhcmFtIHsoZXZ0OkV2ZW50KT0+dm9pZH0gaGFuZGxlciDkuovku7blpITnkIblh73mlbBcclxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIHRoaXPmjIflkJHlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBET01CcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRE9NQnJpZGdlLnByb3RvdHlwZS5tYXBMaXN0ZW5lciA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpIHtcclxuICAgICAgICB2YXIga2V5ID0gZ2V0T2JqZWN0SGFzaHModGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKTtcclxuICAgICAgICAvLyDliKTmlq3mmK/lkKblt7Lnu4/lrZjlnKjor6Xnm5HlkKzvvIzlpoLmnpzlrZjlnKjliJnkuI3lho3nm5HlkKxcclxuICAgICAgICBpZiAodGhpcy5fbGlzdGVuZXJEaWN0W2tleV0pXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyDnm5HlkKxcclxuICAgICAgICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBoYW5kbGVyLmNhbGwodGhpc0FyZyB8fCB0aGlzLCBldnQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpO1xyXG4gICAgICAgIC8vIOiusOW9leebkeWQrFxyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyRGljdFtrZXldID0gbGlzdGVuZXI7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jplIDnm5HlkKzkuovku7ZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0V2ZW50VGFyZ2V0fSB0YXJnZXQg5LqL5Lu255uu5qCH5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7KGV2dDpFdmVudCk9PnZvaWR9IGhhbmRsZXIg5LqL5Lu25aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCR5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRE9NQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUudW5tYXBMaXN0ZW5lciA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpIHtcclxuICAgICAgICB2YXIga2V5ID0gZ2V0T2JqZWN0SGFzaHModGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKTtcclxuICAgICAgICAvLyDliKTmlq3mmK/lkKblt7Lnu4/lrZjlnKjor6Xnm5HlkKzvvIzlpoLmnpzlrZjlnKjliJnnp7vpmaTnm5HlkKxcclxuICAgICAgICB2YXIgbGlzdGVuZXIgPSB0aGlzLl9saXN0ZW5lckRpY3Rba2V5XTtcclxuICAgICAgICBpZiAobGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTorrDlvZVcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2xpc3RlbmVyRGljdFtrZXldO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOS4uue7keWumueahOWIl+ihqOaYvuekuuWvueixoeWMheijheS4gOS4qua4suafk+WZqOWIm+W7uuWbnuiwg1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCBCaW5kRm9y5oyH5Luk5oyH5ZCR55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyhrZXk/OmFueSwgdmFsdWU/OmFueSwgcmVuZGVyZXI/OkhUTUxFbGVtZW50KT0+dm9pZH0gaGFuZGxlciDmuLLmn5PlmajliJvlu7rlm57osINcclxuICAgICAqIEByZXR1cm5zIHsqfSDov5Tlm57kuIDkuKrlpIflv5jlvZXlr7nosaHvvIzkvJrlnKjotYvlgLzml7bmj5DkvptcclxuICAgICAqIEBtZW1iZXJvZiBJQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIERPTUJyaWRnZS5wcm90b3R5cGUud3JhcEJpbmRGb3IgPSBmdW5jdGlvbiAodGFyZ2V0LCBoYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIHBhcmVudCA9IHRhcmdldC5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIC8vIOeUn+aIkOS4gOS4qmZyb23oioLngrnlkozkuIDkuKp0b+iKgueCue+8jOeUqOadpeWNoOS9jVxyXG4gICAgICAgIHZhciBmcm9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICB2YXIgdG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHBhcmVudCAmJiBwYXJlbnQuaW5zZXJ0QmVmb3JlKGZyb20sIHRhcmdldCk7XHJcbiAgICAgICAgcGFyZW50ICYmIHBhcmVudC5pbnNlcnRCZWZvcmUodG8sIHRhcmdldCk7XHJcbiAgICAgICAgLy8g56e76Zmk5pi+56S6XHJcbiAgICAgICAgcGFyZW50ICYmIHBhcmVudC5yZW1vdmVDaGlsZCh0YXJnZXQpO1xyXG4gICAgICAgIC8vIOi/lOWbnuWkh+W/mOW9lVxyXG4gICAgICAgIHJldHVybiB7IHBhcmVudDogcGFyZW50LCBmcm9tOiBmcm9tLCB0bzogdG8sIGhhbmRsZXI6IGhhbmRsZXIgfTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOS4uuWIl+ihqOaYvuekuuWvueixoei1i+WAvFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IHRhcmdldCBCaW5kRm9y5oyH5Luk5oyH5ZCR55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IGRhdGFzIOaVsOaNrumbhuWQiFxyXG4gICAgICogQHBhcmFtIHsqfSBtZW1lbnRvIHdyYXBCaW5kRm9y6L+U5Zue55qE5aSH5b+Y5b2V5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgSUJyaWRnZVxyXG4gICAgICovXHJcbiAgICBET01CcmlkZ2UucHJvdG90eXBlLnZhbHVhdGVCaW5kRm9yID0gZnVuY3Rpb24gKHRhcmdldCwgZGF0YXMsIG1lbWVudG8pIHtcclxuICAgICAgICAvLyDnp7vpmaTlt7LmnInnmoTliJfooajpobnmmL7npLpcclxuICAgICAgICB2YXIgcGFyZW50ID0gbWVtZW50by5wYXJlbnQ7XHJcbiAgICAgICAgaWYgKHBhcmVudCkge1xyXG4gICAgICAgICAgICB2YXIgZnJvbUluZGV4ID0gdGhpcy5nZXRDaGlsZEluZGV4KHBhcmVudCwgbWVtZW50by5mcm9tKTtcclxuICAgICAgICAgICAgdmFyIHRvSW5kZXggPSB0aGlzLmdldENoaWxkSW5kZXgocGFyZW50LCBtZW1lbnRvLnRvKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleCArIDE7IGkgPCB0b0luZGV4OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGRBdChwYXJlbnQsIGZyb21JbmRleCArIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOa3u+WKoOaWsOeahOa4suafk+WZqFxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBkYXRhcykge1xyXG4gICAgICAgICAgICB2YXIgbmV3RWxlbWVudCA9IHRhcmdldC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vIOaLt+i0neWtkOWtmeWvueixoeW8leeUqFxyXG4gICAgICAgICAgICBjb3B5UmVmKG5ld0VsZW1lbnQsIG5ld0VsZW1lbnQpO1xyXG4gICAgICAgICAgICAvLyDmt7vliqDmmL7npLpcclxuICAgICAgICAgICAgcGFyZW50ICYmIHBhcmVudC5pbnNlcnRCZWZvcmUobmV3RWxlbWVudCwgbWVtZW50by50byk7XHJcbiAgICAgICAgICAgIC8vIOS9v+eUqGNsb25lTm9kZeaWueazleWkjeWItua4suafk+WZqFxyXG4gICAgICAgICAgICBtZW1lbnRvLmhhbmRsZXIoa2V5LCBkYXRhc1trZXldLCBuZXdFbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIOaPkOS+m+mdmeaAgeexu+Wei+W4uOmHjyAqL1xyXG4gICAgRE9NQnJpZGdlLlRZUEUgPSBcIkRPTVwiO1xyXG4gICAgcmV0dXJuIERPTUJyaWRnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRE9NQnJpZGdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vRE9NQnJpZGdlLmpzXG4vLyBtb2R1bGUgaWQgPSAyNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcbiAqIFR3ZWVuLmpzIC0gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vdHdlZW5qcy90d2Vlbi5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICpcbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdHdlZW5qcy90d2Vlbi5qcy9ncmFwaHMvY29udHJpYnV0b3JzIGZvciB0aGUgZnVsbCBsaXN0IG9mIGNvbnRyaWJ1dG9ycy5cbiAqIFRoYW5rIHlvdSBhbGwsIHlvdSdyZSBhd2Vzb21lIVxuICovXG5cblxudmFyIF9Hcm91cCA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy5fdHdlZW5zID0ge307XG5cdHRoaXMuX3R3ZWVuc0FkZGVkRHVyaW5nVXBkYXRlID0ge307XG59O1xuXG5fR3JvdXAucHJvdG90eXBlID0ge1xuXHRnZXRBbGw6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl90d2VlbnMpLm1hcChmdW5jdGlvbiAodHdlZW5JZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX3R3ZWVuc1t0d2VlbklkXTtcblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdH0sXG5cblx0cmVtb3ZlQWxsOiBmdW5jdGlvbiAoKSB7XG5cblx0XHR0aGlzLl90d2VlbnMgPSB7fTtcblxuXHR9LFxuXG5cdGFkZDogZnVuY3Rpb24gKHR3ZWVuKSB7XG5cblx0XHR0aGlzLl90d2VlbnNbdHdlZW4uZ2V0SWQoKV0gPSB0d2Vlbjtcblx0XHR0aGlzLl90d2VlbnNBZGRlZER1cmluZ1VwZGF0ZVt0d2Vlbi5nZXRJZCgpXSA9IHR3ZWVuO1xuXG5cdH0sXG5cblx0cmVtb3ZlOiBmdW5jdGlvbiAodHdlZW4pIHtcblxuXHRcdGRlbGV0ZSB0aGlzLl90d2VlbnNbdHdlZW4uZ2V0SWQoKV07XG5cdFx0ZGVsZXRlIHRoaXMuX3R3ZWVuc0FkZGVkRHVyaW5nVXBkYXRlW3R3ZWVuLmdldElkKCldO1xuXG5cdH0sXG5cblx0dXBkYXRlOiBmdW5jdGlvbiAodGltZSwgcHJlc2VydmUpIHtcblxuXHRcdHZhciB0d2VlbklkcyA9IE9iamVjdC5rZXlzKHRoaXMuX3R3ZWVucyk7XG5cblx0XHRpZiAodHdlZW5JZHMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGltZSA9IHRpbWUgIT09IHVuZGVmaW5lZCA/IHRpbWUgOiBUV0VFTi5ub3coKTtcblxuXHRcdC8vIFR3ZWVucyBhcmUgdXBkYXRlZCBpbiBcImJhdGNoZXNcIi4gSWYgeW91IGFkZCBhIG5ldyB0d2VlbiBkdXJpbmcgYW4gdXBkYXRlLCB0aGVuIHRoZVxuXHRcdC8vIG5ldyB0d2VlbiB3aWxsIGJlIHVwZGF0ZWQgaW4gdGhlIG5leHQgYmF0Y2guXG5cdFx0Ly8gSWYgeW91IHJlbW92ZSBhIHR3ZWVuIGR1cmluZyBhbiB1cGRhdGUsIGl0IG1heSBvciBtYXkgbm90IGJlIHVwZGF0ZWQuIEhvd2V2ZXIsXG5cdFx0Ly8gaWYgdGhlIHJlbW92ZWQgdHdlZW4gd2FzIGFkZGVkIGR1cmluZyB0aGUgY3VycmVudCBiYXRjaCwgdGhlbiBpdCB3aWxsIG5vdCBiZSB1cGRhdGVkLlxuXHRcdHdoaWxlICh0d2Vlbklkcy5sZW5ndGggPiAwKSB7XG5cdFx0XHR0aGlzLl90d2VlbnNBZGRlZER1cmluZ1VwZGF0ZSA9IHt9O1xuXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHR3ZWVuSWRzLmxlbmd0aDsgaSsrKSB7XG5cblx0XHRcdFx0dmFyIHR3ZWVuID0gdGhpcy5fdHdlZW5zW3R3ZWVuSWRzW2ldXTtcblxuXHRcdFx0XHRpZiAodHdlZW4gJiYgdHdlZW4udXBkYXRlKHRpbWUpID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdHR3ZWVuLl9pc1BsYXlpbmcgPSBmYWxzZTtcblxuXHRcdFx0XHRcdGlmICghcHJlc2VydmUpIHtcblx0XHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl90d2VlbnNbdHdlZW5JZHNbaV1dO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHR0d2VlbklkcyA9IE9iamVjdC5rZXlzKHRoaXMuX3R3ZWVuc0FkZGVkRHVyaW5nVXBkYXRlKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9XG59O1xuXG52YXIgVFdFRU4gPSBuZXcgX0dyb3VwKCk7XG5cblRXRUVOLkdyb3VwID0gX0dyb3VwO1xuVFdFRU4uX25leHRJZCA9IDA7XG5UV0VFTi5uZXh0SWQgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiBUV0VFTi5fbmV4dElkKys7XG59O1xuXG5cbi8vIEluY2x1ZGUgYSBwZXJmb3JtYW5jZS5ub3cgcG9seWZpbGwuXG4vLyBJbiBub2RlLmpzLCB1c2UgcHJvY2Vzcy5ocnRpbWUuXG5pZiAodHlwZW9mICh3aW5kb3cpID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgKHByb2Nlc3MpICE9PSAndW5kZWZpbmVkJykge1xuXHRUV0VFTi5ub3cgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHRpbWUgPSBwcm9jZXNzLmhydGltZSgpO1xuXG5cdFx0Ly8gQ29udmVydCBbc2Vjb25kcywgbmFub3NlY29uZHNdIHRvIG1pbGxpc2Vjb25kcy5cblx0XHRyZXR1cm4gdGltZVswXSAqIDEwMDAgKyB0aW1lWzFdIC8gMTAwMDAwMDtcblx0fTtcbn1cbi8vIEluIGEgYnJvd3NlciwgdXNlIHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cgaWYgaXQgaXMgYXZhaWxhYmxlLlxuZWxzZSBpZiAodHlwZW9mICh3aW5kb3cpICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgd2luZG93LnBlcmZvcm1hbmNlICE9PSB1bmRlZmluZWQgJiZcblx0XHQgd2luZG93LnBlcmZvcm1hbmNlLm5vdyAhPT0gdW5kZWZpbmVkKSB7XG5cdC8vIFRoaXMgbXVzdCBiZSBib3VuZCwgYmVjYXVzZSBkaXJlY3RseSBhc3NpZ25pbmcgdGhpcyBmdW5jdGlvblxuXHQvLyBsZWFkcyB0byBhbiBpbnZvY2F0aW9uIGV4Y2VwdGlvbiBpbiBDaHJvbWUuXG5cdFRXRUVOLm5vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cuYmluZCh3aW5kb3cucGVyZm9ybWFuY2UpO1xufVxuLy8gVXNlIERhdGUubm93IGlmIGl0IGlzIGF2YWlsYWJsZS5cbmVsc2UgaWYgKERhdGUubm93ICE9PSB1bmRlZmluZWQpIHtcblx0VFdFRU4ubm93ID0gRGF0ZS5ub3c7XG59XG4vLyBPdGhlcndpc2UsIHVzZSAnbmV3IERhdGUoKS5nZXRUaW1lKCknLlxuZWxzZSB7XG5cdFRXRUVOLm5vdyA9IGZ1bmN0aW9uICgpIHtcblx0XHRyZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdH07XG59XG5cblxuVFdFRU4uVHdlZW4gPSBmdW5jdGlvbiAob2JqZWN0LCBncm91cCkge1xuXHR0aGlzLl9vYmplY3QgPSBvYmplY3Q7XG5cdHRoaXMuX3ZhbHVlc1N0YXJ0ID0ge307XG5cdHRoaXMuX3ZhbHVlc0VuZCA9IHt9O1xuXHR0aGlzLl92YWx1ZXNTdGFydFJlcGVhdCA9IHt9O1xuXHR0aGlzLl9kdXJhdGlvbiA9IDEwMDA7XG5cdHRoaXMuX3JlcGVhdCA9IDA7XG5cdHRoaXMuX3JlcGVhdERlbGF5VGltZSA9IHVuZGVmaW5lZDtcblx0dGhpcy5feW95byA9IGZhbHNlO1xuXHR0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcblx0dGhpcy5fcmV2ZXJzZWQgPSBmYWxzZTtcblx0dGhpcy5fZGVsYXlUaW1lID0gMDtcblx0dGhpcy5fc3RhcnRUaW1lID0gbnVsbDtcblx0dGhpcy5fZWFzaW5nRnVuY3Rpb24gPSBUV0VFTi5FYXNpbmcuTGluZWFyLk5vbmU7XG5cdHRoaXMuX2ludGVycG9sYXRpb25GdW5jdGlvbiA9IFRXRUVOLkludGVycG9sYXRpb24uTGluZWFyO1xuXHR0aGlzLl9jaGFpbmVkVHdlZW5zID0gW107XG5cdHRoaXMuX29uU3RhcnRDYWxsYmFjayA9IG51bGw7XG5cdHRoaXMuX29uU3RhcnRDYWxsYmFja0ZpcmVkID0gZmFsc2U7XG5cdHRoaXMuX29uVXBkYXRlQ2FsbGJhY2sgPSBudWxsO1xuXHR0aGlzLl9vbkNvbXBsZXRlQ2FsbGJhY2sgPSBudWxsO1xuXHR0aGlzLl9vblN0b3BDYWxsYmFjayA9IG51bGw7XG5cdHRoaXMuX2dyb3VwID0gZ3JvdXAgfHwgVFdFRU47XG5cdHRoaXMuX2lkID0gVFdFRU4ubmV4dElkKCk7XG5cbn07XG5cblRXRUVOLlR3ZWVuLnByb3RvdHlwZSA9IHtcblx0Z2V0SWQ6IGZ1bmN0aW9uIGdldElkKCkge1xuXHRcdHJldHVybiB0aGlzLl9pZDtcblx0fSxcblxuXHRpc1BsYXlpbmc6IGZ1bmN0aW9uIGlzUGxheWluZygpIHtcblx0XHRyZXR1cm4gdGhpcy5faXNQbGF5aW5nO1xuXHR9LFxuXG5cdHRvOiBmdW5jdGlvbiB0byhwcm9wZXJ0aWVzLCBkdXJhdGlvbikge1xuXG5cdFx0dGhpcy5fdmFsdWVzRW5kID0gcHJvcGVydGllcztcblxuXHRcdGlmIChkdXJhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHR0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0c3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KHRpbWUpIHtcblxuXHRcdHRoaXMuX2dyb3VwLmFkZCh0aGlzKTtcblxuXHRcdHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG5cblx0XHR0aGlzLl9vblN0YXJ0Q2FsbGJhY2tGaXJlZCA9IGZhbHNlO1xuXG5cdFx0dGhpcy5fc3RhcnRUaW1lID0gdGltZSAhPT0gdW5kZWZpbmVkID8gdHlwZW9mIHRpbWUgPT09ICdzdHJpbmcnID8gVFdFRU4ubm93KCkgKyBwYXJzZUZsb2F0KHRpbWUpIDogdGltZSA6IFRXRUVOLm5vdygpO1xuXHRcdHRoaXMuX3N0YXJ0VGltZSArPSB0aGlzLl9kZWxheVRpbWU7XG5cblx0XHRmb3IgKHZhciBwcm9wZXJ0eSBpbiB0aGlzLl92YWx1ZXNFbmQpIHtcblxuXHRcdFx0Ly8gQ2hlY2sgaWYgYW4gQXJyYXkgd2FzIHByb3ZpZGVkIGFzIHByb3BlcnR5IHZhbHVlXG5cdFx0XHRpZiAodGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XSBpbnN0YW5jZW9mIEFycmF5KSB7XG5cblx0XHRcdFx0aWYgKHRoaXMuX3ZhbHVlc0VuZFtwcm9wZXJ0eV0ubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBDcmVhdGUgYSBsb2NhbCBjb3B5IG9mIHRoZSBBcnJheSB3aXRoIHRoZSBzdGFydCB2YWx1ZSBhdCB0aGUgZnJvbnRcblx0XHRcdFx0dGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XSA9IFt0aGlzLl9vYmplY3RbcHJvcGVydHldXS5jb25jYXQodGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XSk7XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gSWYgYHRvKClgIHNwZWNpZmllcyBhIHByb3BlcnR5IHRoYXQgZG9lc24ndCBleGlzdCBpbiB0aGUgc291cmNlIG9iamVjdCxcblx0XHRcdC8vIHdlIHNob3VsZCBub3Qgc2V0IHRoYXQgcHJvcGVydHkgaW4gdGhlIG9iamVjdFxuXHRcdFx0aWYgKHRoaXMuX29iamVjdFtwcm9wZXJ0eV0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gU2F2ZSB0aGUgc3RhcnRpbmcgdmFsdWUuXG5cdFx0XHR0aGlzLl92YWx1ZXNTdGFydFtwcm9wZXJ0eV0gPSB0aGlzLl9vYmplY3RbcHJvcGVydHldO1xuXG5cdFx0XHRpZiAoKHRoaXMuX3ZhbHVlc1N0YXJ0W3Byb3BlcnR5XSBpbnN0YW5jZW9mIEFycmF5KSA9PT0gZmFsc2UpIHtcblx0XHRcdFx0dGhpcy5fdmFsdWVzU3RhcnRbcHJvcGVydHldICo9IDEuMDsgLy8gRW5zdXJlcyB3ZSdyZSB1c2luZyBudW1iZXJzLCBub3Qgc3RyaW5nc1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl92YWx1ZXNTdGFydFJlcGVhdFtwcm9wZXJ0eV0gPSB0aGlzLl92YWx1ZXNTdGFydFtwcm9wZXJ0eV0gfHwgMDtcblxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0c3RvcDogZnVuY3Rpb24gc3RvcCgpIHtcblxuXHRcdGlmICghdGhpcy5faXNQbGF5aW5nKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHR0aGlzLl9ncm91cC5yZW1vdmUodGhpcyk7XG5cdFx0dGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG5cblx0XHRpZiAodGhpcy5fb25TdG9wQ2FsbGJhY2sgIT09IG51bGwpIHtcblx0XHRcdHRoaXMuX29uU3RvcENhbGxiYWNrKHRoaXMuX29iamVjdCk7XG5cdFx0fVxuXG5cdFx0dGhpcy5zdG9wQ2hhaW5lZFR3ZWVucygpO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0ZW5kOiBmdW5jdGlvbiBlbmQoKSB7XG5cblx0XHR0aGlzLnVwZGF0ZSh0aGlzLl9zdGFydFRpbWUgKyB0aGlzLl9kdXJhdGlvbik7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRzdG9wQ2hhaW5lZFR3ZWVuczogZnVuY3Rpb24gc3RvcENoYWluZWRUd2VlbnMoKSB7XG5cblx0XHRmb3IgKHZhciBpID0gMCwgbnVtQ2hhaW5lZFR3ZWVucyA9IHRoaXMuX2NoYWluZWRUd2VlbnMubGVuZ3RoOyBpIDwgbnVtQ2hhaW5lZFR3ZWVuczsgaSsrKSB7XG5cdFx0XHR0aGlzLl9jaGFpbmVkVHdlZW5zW2ldLnN0b3AoKTtcblx0XHR9XG5cblx0fSxcblxuXHRncm91cDogZnVuY3Rpb24gZ3JvdXAoZ3JvdXApIHtcblx0XHR0aGlzLl9ncm91cCA9IGdyb3VwO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGRlbGF5OiBmdW5jdGlvbiBkZWxheShhbW91bnQpIHtcblxuXHRcdHRoaXMuX2RlbGF5VGltZSA9IGFtb3VudDtcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdHJlcGVhdDogZnVuY3Rpb24gcmVwZWF0KHRpbWVzKSB7XG5cblx0XHR0aGlzLl9yZXBlYXQgPSB0aW1lcztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdHJlcGVhdERlbGF5OiBmdW5jdGlvbiByZXBlYXREZWxheShhbW91bnQpIHtcblxuXHRcdHRoaXMuX3JlcGVhdERlbGF5VGltZSA9IGFtb3VudDtcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdHlveW86IGZ1bmN0aW9uIHlveW8oeXkpIHtcblxuXHRcdHRoaXMuX3lveW8gPSB5eTtcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdGVhc2luZzogZnVuY3Rpb24gZWFzaW5nKGVhcykge1xuXG5cdFx0dGhpcy5fZWFzaW5nRnVuY3Rpb24gPSBlYXM7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRpbnRlcnBvbGF0aW9uOiBmdW5jdGlvbiBpbnRlcnBvbGF0aW9uKGludGVyKSB7XG5cblx0XHR0aGlzLl9pbnRlcnBvbGF0aW9uRnVuY3Rpb24gPSBpbnRlcjtcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdGNoYWluOiBmdW5jdGlvbiBjaGFpbigpIHtcblxuXHRcdHRoaXMuX2NoYWluZWRUd2VlbnMgPSBhcmd1bWVudHM7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRvblN0YXJ0OiBmdW5jdGlvbiBvblN0YXJ0KGNhbGxiYWNrKSB7XG5cblx0XHR0aGlzLl9vblN0YXJ0Q2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdG9uVXBkYXRlOiBmdW5jdGlvbiBvblVwZGF0ZShjYWxsYmFjaykge1xuXG5cdFx0dGhpcy5fb25VcGRhdGVDYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdHJldHVybiB0aGlzO1xuXG5cdH0sXG5cblx0b25Db21wbGV0ZTogZnVuY3Rpb24gb25Db21wbGV0ZShjYWxsYmFjaykge1xuXG5cdFx0dGhpcy5fb25Db21wbGV0ZUNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHRoaXM7XG5cblx0fSxcblxuXHRvblN0b3A6IGZ1bmN0aW9uIG9uU3RvcChjYWxsYmFjaykge1xuXG5cdFx0dGhpcy5fb25TdG9wQ2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHRyZXR1cm4gdGhpcztcblxuXHR9LFxuXG5cdHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKHRpbWUpIHtcblxuXHRcdHZhciBwcm9wZXJ0eTtcblx0XHR2YXIgZWxhcHNlZDtcblx0XHR2YXIgdmFsdWU7XG5cblx0XHRpZiAodGltZSA8IHRoaXMuX3N0YXJ0VGltZSkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX29uU3RhcnRDYWxsYmFja0ZpcmVkID09PSBmYWxzZSkge1xuXG5cdFx0XHRpZiAodGhpcy5fb25TdGFydENhbGxiYWNrICE9PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMuX29uU3RhcnRDYWxsYmFjayh0aGlzLl9vYmplY3QpO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9vblN0YXJ0Q2FsbGJhY2tGaXJlZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0ZWxhcHNlZCA9ICh0aW1lIC0gdGhpcy5fc3RhcnRUaW1lKSAvIHRoaXMuX2R1cmF0aW9uO1xuXHRcdGVsYXBzZWQgPSAodGhpcy5fZHVyYXRpb24gPT09IDAgfHwgZWxhcHNlZCA+IDEpID8gMSA6IGVsYXBzZWQ7XG5cblx0XHR2YWx1ZSA9IHRoaXMuX2Vhc2luZ0Z1bmN0aW9uKGVsYXBzZWQpO1xuXG5cdFx0Zm9yIChwcm9wZXJ0eSBpbiB0aGlzLl92YWx1ZXNFbmQpIHtcblxuXHRcdFx0Ly8gRG9uJ3QgdXBkYXRlIHByb3BlcnRpZXMgdGhhdCBkbyBub3QgZXhpc3QgaW4gdGhlIHNvdXJjZSBvYmplY3Rcblx0XHRcdGlmICh0aGlzLl92YWx1ZXNTdGFydFtwcm9wZXJ0eV0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblxuXHRcdFx0dmFyIHN0YXJ0ID0gdGhpcy5fdmFsdWVzU3RhcnRbcHJvcGVydHldIHx8IDA7XG5cdFx0XHR2YXIgZW5kID0gdGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XTtcblxuXHRcdFx0aWYgKGVuZCBpbnN0YW5jZW9mIEFycmF5KSB7XG5cblx0XHRcdFx0dGhpcy5fb2JqZWN0W3Byb3BlcnR5XSA9IHRoaXMuX2ludGVycG9sYXRpb25GdW5jdGlvbihlbmQsIHZhbHVlKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvLyBQYXJzZXMgcmVsYXRpdmUgZW5kIHZhbHVlcyB3aXRoIHN0YXJ0IGFzIGJhc2UgKGUuZy46ICsxMCwgLTMpXG5cdFx0XHRcdGlmICh0eXBlb2YgKGVuZCkgPT09ICdzdHJpbmcnKSB7XG5cblx0XHRcdFx0XHRpZiAoZW5kLmNoYXJBdCgwKSA9PT0gJysnIHx8IGVuZC5jaGFyQXQoMCkgPT09ICctJykge1xuXHRcdFx0XHRcdFx0ZW5kID0gc3RhcnQgKyBwYXJzZUZsb2F0KGVuZCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVuZCA9IHBhcnNlRmxvYXQoZW5kKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBQcm90ZWN0IGFnYWluc3Qgbm9uIG51bWVyaWMgcHJvcGVydGllcy5cblx0XHRcdFx0aWYgKHR5cGVvZiAoZW5kKSA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0XHR0aGlzLl9vYmplY3RbcHJvcGVydHldID0gc3RhcnQgKyAoZW5kIC0gc3RhcnQpICogdmFsdWU7XG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX29uVXBkYXRlQ2FsbGJhY2sgIT09IG51bGwpIHtcblx0XHRcdHRoaXMuX29uVXBkYXRlQ2FsbGJhY2sodGhpcy5fb2JqZWN0KTtcblx0XHR9XG5cblx0XHRpZiAoZWxhcHNlZCA9PT0gMSkge1xuXG5cdFx0XHRpZiAodGhpcy5fcmVwZWF0ID4gMCkge1xuXG5cdFx0XHRcdGlmIChpc0Zpbml0ZSh0aGlzLl9yZXBlYXQpKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVwZWF0LS07XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSZWFzc2lnbiBzdGFydGluZyB2YWx1ZXMsIHJlc3RhcnQgYnkgbWFraW5nIHN0YXJ0VGltZSA9IG5vd1xuXHRcdFx0XHRmb3IgKHByb3BlcnR5IGluIHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0KSB7XG5cblx0XHRcdFx0XHRpZiAodHlwZW9mICh0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldKSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XSA9IHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XSArIHBhcnNlRmxvYXQodGhpcy5fdmFsdWVzRW5kW3Byb3BlcnR5XSk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKHRoaXMuX3lveW8pIHtcblx0XHRcdFx0XHRcdHZhciB0bXAgPSB0aGlzLl92YWx1ZXNTdGFydFJlcGVhdFtwcm9wZXJ0eV07XG5cblx0XHRcdFx0XHRcdHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XSA9IHRoaXMuX3ZhbHVlc0VuZFtwcm9wZXJ0eV07XG5cdFx0XHRcdFx0XHR0aGlzLl92YWx1ZXNFbmRbcHJvcGVydHldID0gdG1wO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHRoaXMuX3ZhbHVlc1N0YXJ0W3Byb3BlcnR5XSA9IHRoaXMuX3ZhbHVlc1N0YXJ0UmVwZWF0W3Byb3BlcnR5XTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHRoaXMuX3lveW8pIHtcblx0XHRcdFx0XHR0aGlzLl9yZXZlcnNlZCA9ICF0aGlzLl9yZXZlcnNlZDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh0aGlzLl9yZXBlYXREZWxheVRpbWUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdHRoaXMuX3N0YXJ0VGltZSA9IHRpbWUgKyB0aGlzLl9yZXBlYXREZWxheVRpbWU7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5fc3RhcnRUaW1lID0gdGltZSArIHRoaXMuX2RlbGF5VGltZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGlmICh0aGlzLl9vbkNvbXBsZXRlQ2FsbGJhY2sgIT09IG51bGwpIHtcblxuXHRcdFx0XHRcdHRoaXMuX29uQ29tcGxldGVDYWxsYmFjayh0aGlzLl9vYmplY3QpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDAsIG51bUNoYWluZWRUd2VlbnMgPSB0aGlzLl9jaGFpbmVkVHdlZW5zLmxlbmd0aDsgaSA8IG51bUNoYWluZWRUd2VlbnM7IGkrKykge1xuXHRcdFx0XHRcdC8vIE1ha2UgdGhlIGNoYWluZWQgdHdlZW5zIHN0YXJ0IGV4YWN0bHkgYXQgdGhlIHRpbWUgdGhleSBzaG91bGQsXG5cdFx0XHRcdFx0Ly8gZXZlbiBpZiB0aGUgYHVwZGF0ZSgpYCBtZXRob2Qgd2FzIGNhbGxlZCB3YXkgcGFzdCB0aGUgZHVyYXRpb24gb2YgdGhlIHR3ZWVuXG5cdFx0XHRcdFx0dGhpcy5fY2hhaW5lZFR3ZWVuc1tpXS5zdGFydCh0aGlzLl9zdGFydFRpbWUgKyB0aGlzLl9kdXJhdGlvbik7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cblx0XHRcdH1cblxuXHRcdH1cblxuXHRcdHJldHVybiB0cnVlO1xuXG5cdH1cbn07XG5cblxuVFdFRU4uRWFzaW5nID0ge1xuXG5cdExpbmVhcjoge1xuXG5cdFx0Tm9uZTogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIGs7XG5cblx0XHR9XG5cblx0fSxcblxuXHRRdWFkcmF0aWM6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gayAqIGs7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gayAqICgyIC0gayk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmICgoayAqPSAyKSA8IDEpIHtcblx0XHRcdFx0cmV0dXJuIDAuNSAqIGsgKiBrO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gLSAwLjUgKiAoLS1rICogKGsgLSAyKSAtIDEpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0Q3ViaWM6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gayAqIGsgKiBrO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIC0tayAqIGsgKiBrICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogayAqIGsgKiBrO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gMC41ICogKChrIC09IDIpICogayAqIGsgKyAyKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdFF1YXJ0aWM6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gayAqIGsgKiBrICogaztcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiAxIC0gKC0tayAqIGsgKiBrICogayk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmICgoayAqPSAyKSA8IDEpIHtcblx0XHRcdFx0cmV0dXJuIDAuNSAqIGsgKiBrICogayAqIGs7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAtIDAuNSAqICgoayAtPSAyKSAqIGsgKiBrICogayAtIDIpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0UXVpbnRpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrICogayAqIGsgKiBrICogaztcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiAtLWsgKiBrICogayAqIGsgKiBrICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogayAqIGsgKiBrICogayAqIGs7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiAwLjUgKiAoKGsgLT0gMikgKiBrICogayAqIGsgKiBrICsgMik7XG5cblx0XHR9XG5cblx0fSxcblxuXHRTaW51c29pZGFsOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIDEgLSBNYXRoLmNvcyhrICogTWF0aC5QSSAvIDIpO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIE1hdGguc2luKGsgKiBNYXRoLlBJIC8gMik7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiAwLjUgKiAoMSAtIE1hdGguY29zKE1hdGguUEkgKiBrKSk7XG5cblx0XHR9XG5cblx0fSxcblxuXHRFeHBvbmVudGlhbDoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrID09PSAwID8gMCA6IE1hdGgucG93KDEwMjQsIGsgLSAxKTtcblxuXHRcdH0sXG5cblx0XHRPdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiBrID09PSAxID8gMSA6IDEgLSBNYXRoLnBvdygyLCAtIDEwICogayk7XG5cblx0XHR9LFxuXG5cdFx0SW5PdXQ6IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmIChrID09PSAwKSB7XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoayA9PT0gMSkge1xuXHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKChrICo9IDIpIDwgMSkge1xuXHRcdFx0XHRyZXR1cm4gMC41ICogTWF0aC5wb3coMTAyNCwgayAtIDEpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gMC41ICogKC0gTWF0aC5wb3coMiwgLSAxMCAqIChrIC0gMSkpICsgMik7XG5cblx0XHR9XG5cblx0fSxcblxuXHRDaXJjdWxhcjoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdHJldHVybiAxIC0gTWF0aC5zcXJ0KDEgLSBrICogayk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRyZXR1cm4gTWF0aC5zcXJ0KDEgLSAoLS1rICogaykpO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoKGsgKj0gMikgPCAxKSB7XG5cdFx0XHRcdHJldHVybiAtIDAuNSAqIChNYXRoLnNxcnQoMSAtIGsgKiBrKSAtIDEpO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gMC41ICogKE1hdGguc3FydCgxIC0gKGsgLT0gMikgKiBrKSArIDEpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0RWxhc3RpYzoge1xuXG5cdFx0SW46IGZ1bmN0aW9uIChrKSB7XG5cblx0XHRcdGlmIChrID09PSAwKSB7XG5cdFx0XHRcdHJldHVybiAwO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoayA9PT0gMSkge1xuXHRcdFx0XHRyZXR1cm4gMTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIC1NYXRoLnBvdygyLCAxMCAqIChrIC0gMSkpICogTWF0aC5zaW4oKGsgLSAxLjEpICogNSAqIE1hdGguUEkpO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0aWYgKGsgPT09IDApIHtcblx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChrID09PSAxKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gTWF0aC5wb3coMiwgLTEwICogaykgKiBNYXRoLnNpbigoayAtIDAuMSkgKiA1ICogTWF0aC5QSSkgKyAxO1xuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoayA9PT0gMCkge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGsgPT09IDEpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9XG5cblx0XHRcdGsgKj0gMjtcblxuXHRcdFx0aWYgKGsgPCAxKSB7XG5cdFx0XHRcdHJldHVybiAtMC41ICogTWF0aC5wb3coMiwgMTAgKiAoayAtIDEpKSAqIE1hdGguc2luKChrIC0gMS4xKSAqIDUgKiBNYXRoLlBJKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIDAuNSAqIE1hdGgucG93KDIsIC0xMCAqIChrIC0gMSkpICogTWF0aC5zaW4oKGsgLSAxLjEpICogNSAqIE1hdGguUEkpICsgMTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdEJhY2s6IHtcblxuXHRcdEluOiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHR2YXIgcyA9IDEuNzAxNTg7XG5cblx0XHRcdHJldHVybiBrICogayAqICgocyArIDEpICogayAtIHMpO1xuXG5cdFx0fSxcblxuXHRcdE91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0dmFyIHMgPSAxLjcwMTU4O1xuXG5cdFx0XHRyZXR1cm4gLS1rICogayAqICgocyArIDEpICogayArIHMpICsgMTtcblxuXHRcdH0sXG5cblx0XHRJbk91dDogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0dmFyIHMgPSAxLjcwMTU4ICogMS41MjU7XG5cblx0XHRcdGlmICgoayAqPSAyKSA8IDEpIHtcblx0XHRcdFx0cmV0dXJuIDAuNSAqIChrICogayAqICgocyArIDEpICogayAtIHMpKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIDAuNSAqICgoayAtPSAyKSAqIGsgKiAoKHMgKyAxKSAqIGsgKyBzKSArIDIpO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0Qm91bmNlOiB7XG5cblx0XHRJbjogZnVuY3Rpb24gKGspIHtcblxuXHRcdFx0cmV0dXJuIDEgLSBUV0VFTi5FYXNpbmcuQm91bmNlLk91dCgxIC0gayk7XG5cblx0XHR9LFxuXG5cdFx0T3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoayA8ICgxIC8gMi43NSkpIHtcblx0XHRcdFx0cmV0dXJuIDcuNTYyNSAqIGsgKiBrO1xuXHRcdFx0fSBlbHNlIGlmIChrIDwgKDIgLyAyLjc1KSkge1xuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogKGsgLT0gKDEuNSAvIDIuNzUpKSAqIGsgKyAwLjc1O1xuXHRcdFx0fSBlbHNlIGlmIChrIDwgKDIuNSAvIDIuNzUpKSB7XG5cdFx0XHRcdHJldHVybiA3LjU2MjUgKiAoayAtPSAoMi4yNSAvIDIuNzUpKSAqIGsgKyAwLjkzNzU7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gNy41NjI1ICogKGsgLT0gKDIuNjI1IC8gMi43NSkpICogayArIDAuOTg0Mzc1O1xuXHRcdFx0fVxuXG5cdFx0fSxcblxuXHRcdEluT3V0OiBmdW5jdGlvbiAoaykge1xuXG5cdFx0XHRpZiAoayA8IDAuNSkge1xuXHRcdFx0XHRyZXR1cm4gVFdFRU4uRWFzaW5nLkJvdW5jZS5JbihrICogMikgKiAwLjU7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBUV0VFTi5FYXNpbmcuQm91bmNlLk91dChrICogMiAtIDEpICogMC41ICsgMC41O1xuXG5cdFx0fVxuXG5cdH1cblxufTtcblxuVFdFRU4uSW50ZXJwb2xhdGlvbiA9IHtcblxuXHRMaW5lYXI6IGZ1bmN0aW9uICh2LCBrKSB7XG5cblx0XHR2YXIgbSA9IHYubGVuZ3RoIC0gMTtcblx0XHR2YXIgZiA9IG0gKiBrO1xuXHRcdHZhciBpID0gTWF0aC5mbG9vcihmKTtcblx0XHR2YXIgZm4gPSBUV0VFTi5JbnRlcnBvbGF0aW9uLlV0aWxzLkxpbmVhcjtcblxuXHRcdGlmIChrIDwgMCkge1xuXHRcdFx0cmV0dXJuIGZuKHZbMF0sIHZbMV0sIGYpO1xuXHRcdH1cblxuXHRcdGlmIChrID4gMSkge1xuXHRcdFx0cmV0dXJuIGZuKHZbbV0sIHZbbSAtIDFdLCBtIC0gZik7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZuKHZbaV0sIHZbaSArIDEgPiBtID8gbSA6IGkgKyAxXSwgZiAtIGkpO1xuXG5cdH0sXG5cblx0QmV6aWVyOiBmdW5jdGlvbiAodiwgaykge1xuXG5cdFx0dmFyIGIgPSAwO1xuXHRcdHZhciBuID0gdi5sZW5ndGggLSAxO1xuXHRcdHZhciBwdyA9IE1hdGgucG93O1xuXHRcdHZhciBibiA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuQmVybnN0ZWluO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPD0gbjsgaSsrKSB7XG5cdFx0XHRiICs9IHB3KDEgLSBrLCBuIC0gaSkgKiBwdyhrLCBpKSAqIHZbaV0gKiBibihuLCBpKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gYjtcblxuXHR9LFxuXG5cdENhdG11bGxSb206IGZ1bmN0aW9uICh2LCBrKSB7XG5cblx0XHR2YXIgbSA9IHYubGVuZ3RoIC0gMTtcblx0XHR2YXIgZiA9IG0gKiBrO1xuXHRcdHZhciBpID0gTWF0aC5mbG9vcihmKTtcblx0XHR2YXIgZm4gPSBUV0VFTi5JbnRlcnBvbGF0aW9uLlV0aWxzLkNhdG11bGxSb207XG5cblx0XHRpZiAodlswXSA9PT0gdlttXSkge1xuXG5cdFx0XHRpZiAoayA8IDApIHtcblx0XHRcdFx0aSA9IE1hdGguZmxvb3IoZiA9IG0gKiAoMSArIGspKTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGZuKHZbKGkgLSAxICsgbSkgJSBtXSwgdltpXSwgdlsoaSArIDEpICUgbV0sIHZbKGkgKyAyKSAlIG1dLCBmIC0gaSk7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoayA8IDApIHtcblx0XHRcdFx0cmV0dXJuIHZbMF0gLSAoZm4odlswXSwgdlswXSwgdlsxXSwgdlsxXSwgLWYpIC0gdlswXSk7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChrID4gMSkge1xuXHRcdFx0XHRyZXR1cm4gdlttXSAtIChmbih2W21dLCB2W21dLCB2W20gLSAxXSwgdlttIC0gMV0sIGYgLSBtKSAtIHZbbV0pO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gZm4odltpID8gaSAtIDEgOiAwXSwgdltpXSwgdlttIDwgaSArIDEgPyBtIDogaSArIDFdLCB2W20gPCBpICsgMiA/IG0gOiBpICsgMl0sIGYgLSBpKTtcblxuXHRcdH1cblxuXHR9LFxuXG5cdFV0aWxzOiB7XG5cblx0XHRMaW5lYXI6IGZ1bmN0aW9uIChwMCwgcDEsIHQpIHtcblxuXHRcdFx0cmV0dXJuIChwMSAtIHAwKSAqIHQgKyBwMDtcblxuXHRcdH0sXG5cblx0XHRCZXJuc3RlaW46IGZ1bmN0aW9uIChuLCBpKSB7XG5cblx0XHRcdHZhciBmYyA9IFRXRUVOLkludGVycG9sYXRpb24uVXRpbHMuRmFjdG9yaWFsO1xuXG5cdFx0XHRyZXR1cm4gZmMobikgLyBmYyhpKSAvIGZjKG4gLSBpKTtcblxuXHRcdH0sXG5cblx0XHRGYWN0b3JpYWw6IChmdW5jdGlvbiAoKSB7XG5cblx0XHRcdHZhciBhID0gWzFdO1xuXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKG4pIHtcblxuXHRcdFx0XHR2YXIgcyA9IDE7XG5cblx0XHRcdFx0aWYgKGFbbl0pIHtcblx0XHRcdFx0XHRyZXR1cm4gYVtuXTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAodmFyIGkgPSBuOyBpID4gMTsgaS0tKSB7XG5cdFx0XHRcdFx0cyAqPSBpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0YVtuXSA9IHM7XG5cdFx0XHRcdHJldHVybiBzO1xuXG5cdFx0XHR9O1xuXG5cdFx0fSkoKSxcblxuXHRcdENhdG11bGxSb206IGZ1bmN0aW9uIChwMCwgcDEsIHAyLCBwMywgdCkge1xuXG5cdFx0XHR2YXIgdjAgPSAocDIgLSBwMCkgKiAwLjU7XG5cdFx0XHR2YXIgdjEgPSAocDMgLSBwMSkgKiAwLjU7XG5cdFx0XHR2YXIgdDIgPSB0ICogdDtcblx0XHRcdHZhciB0MyA9IHQgKiB0MjtcblxuXHRcdFx0cmV0dXJuICgyICogcDEgLSAyICogcDIgKyB2MCArIHYxKSAqIHQzICsgKC0gMyAqIHAxICsgMyAqIHAyIC0gMiAqIHYwIC0gdjEpICogdDIgKyB2MCAqIHQgKyBwMTtcblxuXHRcdH1cblxuXHR9XG5cbn07XG5cbi8vIFVNRCAoVW5pdmVyc2FsIE1vZHVsZSBEZWZpbml0aW9uKVxuKGZ1bmN0aW9uIChyb290KSB7XG5cblx0aWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuXG5cdFx0Ly8gQU1EXG5cdFx0ZGVmaW5lKFtdLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gVFdFRU47XG5cdFx0fSk7XG5cblx0fSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcblxuXHRcdC8vIE5vZGUuanNcblx0XHRtb2R1bGUuZXhwb3J0cyA9IFRXRUVOO1xuXG5cdH0gZWxzZSBpZiAocm9vdCAhPT0gdW5kZWZpbmVkKSB7XG5cblx0XHQvLyBHbG9iYWwgdmFyaWFibGVcblx0XHRyb290LlRXRUVOID0gVFdFRU47XG5cblx0fVxuXG59KSh0aGlzKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvQHR3ZWVuanMvdHdlZW4uanMvc3JjL1R3ZWVuLmpzXG4vLyBtb2R1bGUgaWQgPSAyN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLy8gPGFtZC1tb2R1bGUgbmFtZT1cIkVncmV0QnJpZGdlXCIvPlxyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIm9seW1wdXMtci9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IE1vZHVsZU1lc3NhZ2UgZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1lc3NhZ2VcIjtcclxuaW1wb3J0IFNjZW5lTWVzc2FnZSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lc3NhZ2VcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9lbnYvRW52aXJvbm1lbnRcIjtcclxuaW1wb3J0IHsgd3JhcEFic29sdXRlUGF0aCB9IGZyb20gXCJvbHltcHVzLXIvdXRpbHMvVVJMVXRpbFwiO1xyXG5pbXBvcnQgUmVuZGVyTW9kZSBmcm9tIFwiLi9lZ3JldC9SZW5kZXJNb2RlXCI7XHJcbmltcG9ydCBBc3NldHNMb2FkZXIgZnJvbSBcIi4vZWdyZXQvQXNzZXRzTG9hZGVyXCI7XHJcbmltcG9ydCBCYWNrUGFuZWxQb2xpY3kgZnJvbSBcIi4vZWdyZXQvcGFuZWwvQmFja1BhbmVsUG9saWN5XCI7XHJcbmltcG9ydCBGYWRlU2NlbmVQb2xpY3kgZnJvbSBcIi4vZWdyZXQvc2NlbmUvRmFkZVNjZW5lUG9saWN5XCI7XHJcbmltcG9ydCBNYXNrRW50aXR5IGZyb20gXCIuL2VncmV0L21hc2svTWFza0VudGl0eVwiO1xyXG5pbXBvcnQgeyB3cmFwRVVJTGlzdCB9IGZyb20gXCIuL2VncmV0L3V0aWxzL1VJVXRpbFwiO1xyXG5pbXBvcnQgVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQgZnJvbSBcIi4vZWdyZXQvY29tbWFuZC9VcGRhdGVTY3JlZW5TaXplQ29tbWFuZFwiO1xyXG5pbXBvcnQgeyB3cmFwU2tpbiB9IGZyb20gXCIuL2VncmV0L3V0aWxzL1NraW5VdGlsXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gKlxyXG4gKiBFZ3JldOeahOihqOeOsOWxguahpeWunueOsO+8jOW9k+WJjUVncmV054mI5pys77yaNS4wLjdcclxuKi9cclxudmFyIEVncmV0QnJpZGdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRWdyZXRCcmlkZ2UocGFyYW1zKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6buY6K6k5by556qX562W55WlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SVBhbmVsUG9saWN5fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFBhbmVsUG9saWN5ID0gbmV3IEJhY2tQYW5lbFBvbGljeSgpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOm7mOiupOWcuuaZr+WIh+aNouetlueVpVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lTY2VuZVBvbGljeX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmRlZmF1bHRTY2VuZVBvbGljeSA9IG5ldyBGYWRlU2NlbmVQb2xpY3koKTtcclxuICAgICAgICB0aGlzLl9pbml0UGFyYW1zID0gcGFyYW1zO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5booajnjrDlsYLnsbvlnovlkI3np7BcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBFZ3JldEJyaWRnZS5UWVBFO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJodG1sV3JhcHBlclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6KGo546w5bGCSFRNTOWMheijheWZqO+8jOWPr+S7peWvueWFtuagt+W8j+i/m+ihjOiHquWumuS5ieiwg+aVtFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0hUTUxFbGVtZW50fVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcInJvb3RcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluagueaYvuekuuiKgueCuVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yb290O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJzdGFnZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6Iie5Y+w5byV55SoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuU3RhZ2V9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGFnZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwiYmdMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6IOM5pmv5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JnTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcInNjZW5lTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWcuuaZr+WuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY2VuZUxheWVyO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVncmV0QnJpZGdlLnByb3RvdHlwZSwgXCJmcmFtZUxheWVyXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmoYbmnrblrrnlmahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZnJhbWVMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwicGFuZWxMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5by556qX5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhbmVsTGF5ZXI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRWdyZXRCcmlkZ2UucHJvdG90eXBlLCBcIm1hc2tMYXllclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6YGu572p5a655ZmoXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21hc2tMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwidG9wTGF5ZXJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlumhtue6p+WuueWZqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90b3BMYXllcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwicHJvbXB0Q2xhc3NcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlumAmueUqOaPkOekuuahhlxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lQcm9tcHRQYW5lbENvbnN0cnVjdG9yfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcy5wcm9tcHRDbGFzcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFZ3JldEJyaWRnZS5wcm90b3R5cGUsIFwibWFza0VudGl0eVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W6YGu572p5a6e5L2TXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SU1hc2tFbnRpdHl9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgTWFza0VudGl0eSh0aGlzLl9pbml0UGFyYW1zLm1hc2tEYXRhKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW6KGo546w5bGC5qGlXHJcbiAgICAgKiBAcGFyYW0geygpPT52b2lkfSBjb21wbGV0ZSDliJ3lp4vljJblrozmr5XlkI7nmoTlm57osINcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChjb21wbGV0ZSkge1xyXG4gICAgICAgIC8vIOeUn+aIkGh0bWzlkoxib2R555qE5qC35byP6IqC54K5XHJcbiAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xyXG4gICAgICAgIHN0eWxlLnRleHRDb250ZW50ID0gXCJcXG4gICAgICAgICAgICBodG1sLCBib2R5IHtcXG4gICAgICAgICAgICAgICAgLW1zLXRvdWNoLWFjdGlvbjogbm9uZTtcXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZDogXCIgKyBlZ3JldC50b0NvbG9yU3RyaW5nKHRoaXMuX2luaXRQYXJhbXMuYmFja2dyb3VuZENvbG9yIHx8IDApICsgXCI7XFxuICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7XFxuICAgICAgICAgICAgICAgIGJvcmRlcjogMDtcXG4gICAgICAgICAgICAgICAgbWFyZ2luOiAwO1xcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgXCI7XHJcbiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7XHJcbiAgICAgICAgLy8g57uf5LiA5a655ZmoXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lciA9PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9pbml0UGFyYW1zLmNvbnRhaW5lcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5jb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuX2luaXRQYXJhbXMuY29udGFpbmVyO1xyXG4gICAgICAgIC8vIOaehOW7uuWuueWZqOWPguaVsFxyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS5tYXJnaW4gPSBcImF1dG9cIjtcclxuICAgICAgICBjb250YWluZXIuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICBjb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgIGNvbnRhaW5lci5zdHlsZS50b3AgPSBcIjAlXCI7XHJcbiAgICAgICAgY29udGFpbmVyLnN0eWxlLmxlZnQgPSBcIjAlXCI7XHJcbiAgICAgICAgY29udGFpbmVyLmNsYXNzTmFtZSA9IFwiZWdyZXQtcGxheWVyXCI7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtZW50cnktY2xhc3NcIiwgXCJfX0VncmV0Um9vdF9fXCIpO1xyXG4gICAgICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLW9yaWVudGF0aW9uXCIsIFwiYXV0b1wiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zY2FsZS1tb2RlXCIsIHRoaXMuX2luaXRQYXJhbXMuc2NhbGVNb2RlIHx8IGVncmV0LlN0YWdlU2NhbGVNb2RlLkZJWEVEX05BUlJPVyk7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtZnJhbWUtcmF0ZVwiLCAodGhpcy5faW5pdFBhcmFtcy5mcmFtZVJhdGUgfHwgNjApICsgXCJcIik7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtY29udGVudC13aWR0aFwiLCB0aGlzLl9pbml0UGFyYW1zLndpZHRoICsgXCJcIik7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtY29udGVudC1oZWlnaHRcIiwgdGhpcy5faW5pdFBhcmFtcy5oZWlnaHQgKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zaG93LXBhaW50LXJlY3RcIiwgKHRoaXMuX2luaXRQYXJhbXMuc2hvd1BhaW50UmVjdCB8fCBmYWxzZSkgKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1tdWx0aS1maW5nZXJlZFwiLCAodGhpcy5faW5pdFBhcmFtcy5tdWx0aUZpbmdlcmVkIHx8IDIpICsgXCJcIik7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtc2hvdy1mcHNcIiwgKHRoaXMuX2luaXRQYXJhbXMuc2hvd0ZQUyB8fCBmYWxzZSkgKyBcIlwiKTtcclxuICAgICAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1zaG93LWZwcy1zdHlsZVwiLCB0aGlzLl9pbml0UGFyYW1zLnNob3dGUFNTdHlsZSB8fCBcIng6MCx5OjAsc2l6ZToxMix0ZXh0Q29sb3I6MHhmZmZmZmYsYmdBbHBoYTowLjlcIik7XHJcbiAgICAgICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtc2hvdy1sb2dcIiwgKHRoaXMuX2luaXRQYXJhbXMuc2hvd0xvZyB8fCBmYWxzZSkgKyBcIlwiKTtcclxuICAgICAgICAvLyDmnoTlu7pfX0VncmV0Um9vdF9f57G777yM5L2/5b6XRWdyZXTlvJXmk47lj6/ku6XpgJrov4d3aW5kb3flr7vlnYDnmoTmlrnlvI/mib7liLDor6XnsbvvvIzlkIzml7blj4jlj6/ku6XorqnlhbblsIbmjqfliLbmnYPovazkuqTnu5lBcHBsaWNhdGlvblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICB3aW5kb3dbXCJfX0VncmV0Um9vdF9fXCJdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBldWkuVUlMYXllci5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgd2luZG93W1wiX19FZ3JldFJvb3RfX1wiXS5wcm90b3R5cGUgPSBuZXcgZXVpLlVJTGF5ZXIoKTtcclxuICAgICAgICB3aW5kb3dbXCJfX0VncmV0Um9vdF9fXCJdLnByb3RvdHlwZS4kb25BZGRUb1N0YWdlID0gZnVuY3Rpb24gKHN0YWdlLCBuZXN0TGV2ZWwpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So54i257G75pa55rOVXHJcbiAgICAgICAgICAgIGV1aS5VSUxheWVyLnByb3RvdHlwZS4kb25BZGRUb1N0YWdlLmNhbGwodGhpcywgc3RhZ2UsIG5lc3RMZXZlbCk7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOW8leeUqFxyXG4gICAgICAgICAgICBkZWxldGUgd2luZG93W1wiX19FZ3JldFJvb3RfX1wiXTtcclxuICAgICAgICAgICAgLy8g5bCG5o6n5Yi25p2D56e75Lqk57uZQXBwbGljYXRpb27lr7nosaFcclxuICAgICAgICAgICAgb25Sb290SW5pdGlhbGl6ZWQodGhpcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyDmoLnmja7muLLmn5PmqKHlvI/liJ3lp4vljJZFZ3JldOW8leaTjlxyXG4gICAgICAgIHN3aXRjaCAodGhpcy5faW5pdFBhcmFtcy5yZW5kZXJNb2RlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgUmVuZGVyTW9kZS5XRUJHTDpcclxuICAgICAgICAgICAgICAgIGluaXRFZ3JldChcIndlYmdsXCIpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgUmVuZGVyTW9kZS5DQU5WQVM6XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBpbml0RWdyZXQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdEVncmV0KHJlbmRlck1vZGUpIHtcclxuICAgICAgICAgICAgaWYgKHdpbmRvd1tcImV1aVwiXSkge1xyXG4gICAgICAgICAgICAgICAgLy8g56+h5pS5ZXVpLkRhdGFHcm91cC5jb21taXRQcm9wZXJ0aWVz5ZKMZ2V0VmlydHVhbEVsZW1lbnRBdOaWueazle+8jOS4unJlbmRlcmVy5re75Yqg5LiA5Liq5qCH562+5Lul5L+u5aSN5YiX6KGo6aaW6aG55riy5p+T5aSa5qyh55qEYnVnXHJcbiAgICAgICAgICAgICAgICB2YXIgb3JpQ29tbWl0UHJvcGVydGllcyA9IGV1aS5EYXRhR3JvdXAucHJvdG90eXBlW1wiY29tbWl0UHJvcGVydGllc1wiXTtcclxuICAgICAgICAgICAgICAgIGV1aS5EYXRhR3JvdXAucHJvdG90eXBlW1wiY29tbWl0UHJvcGVydGllc1wiXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9fZWdyZXRfZGF0YWdyb3VwX3N0YXRlX18gPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlDb21taXRQcm9wZXJ0aWVzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgb3JpR2V0VmlydHVhbEVsZW1lbnRBdCA9IGV1aS5EYXRhR3JvdXAucHJvdG90eXBlW1wiZ2V0VmlydHVhbEVsZW1lbnRBdFwiXTtcclxuICAgICAgICAgICAgICAgIGV1aS5EYXRhR3JvdXAucHJvdG90eXBlW1wiZ2V0VmlydHVhbEVsZW1lbnRBdFwiXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9fZWdyZXRfZGF0YWdyb3VwX3N0YXRlX18gPSAyO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlHZXRWaXJ0dWFsRWxlbWVudEF0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDnr6HmlLlldWkucmVnaXN0ZXJCaW5kYWJsZeaWueazle+8jOaKil9fYmluZGFibGVzX1/otYvlgLzlj5jkuLrkuI3lj6/pgY3ljobnmoTlsZ7mgKdcclxuICAgICAgICAgICAgICAgIHZhciBvcmlSZWdpc3RlckJpbmRhYmxlID0gZXVpLnJlZ2lzdGVyQmluZGFibGU7XHJcbiAgICAgICAgICAgICAgICBldWkucmVnaXN0ZXJCaW5kYWJsZSA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgcHJvcGVydHkpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gb3JpUmVnaXN0ZXJCaW5kYWJsZS5jYWxsKHRoaXMsIGluc3RhbmNlLCBwcm9wZXJ0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5pS55Y+Y5Y+v6YGN5Y6G5oCnXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGluc3RhbmNlLCBcIl9fYmluZGFibGVzX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc2MgJiYgZGVzYy5lbnVtZXJhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2MuZW51bWVyYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaW5zdGFuY2UsIFwiX19iaW5kYWJsZXNfX1wiLCBkZXNjKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6L+U5Zue57uT5p6cXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDnr6HmlLlXYXRjaGVyLmNoZWNrQmluZGFibGXmlrnms5XvvIzmiopfX2xpc3RlbmVyc19f6LWL5YC85Y+Y5Li65LiN5Y+v6YGN5Y6GXHJcbiAgICAgICAgICAgICAgICB2YXIgb3JpQ2hlY2tCaW5kYWJsZSA9IGV1aS5XYXRjaGVyW1wiY2hlY2tCaW5kYWJsZVwiXTtcclxuICAgICAgICAgICAgICAgIGV1aS5XYXRjaGVyW1wiY2hlY2tCaW5kYWJsZVwiXSA9IGZ1bmN0aW9uIChob3N0LCBwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlDaGVja0JpbmRhYmxlLmNhbGwodGhpcywgaG9zdCwgcHJvcGVydHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOaUueWPmOWPr+mBjeWOhuaAp1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihob3N0LCBcIl9fbGlzdGVuZXJzX19cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlc2MgJiYgZGVzYy5lbnVtZXJhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2MuZW51bWVyYWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaG9zdCwgXCJfX2xpc3RlbmVyc19fXCIsIGRlc2MpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5ZCv5YqoRWdyZXTlvJXmk45cclxuICAgICAgICAgICAgZWdyZXQucnVuRWdyZXQoe1xyXG4gICAgICAgICAgICAgICAgcmVuZGVyTW9kZTogcmVuZGVyTW9kZSxcclxuICAgICAgICAgICAgICAgIGF1ZGlvVHlwZTogMFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25Sb290SW5pdGlhbGl6ZWQocm9vdCkge1xyXG4gICAgICAgICAgICBzZWxmLl9yb290ID0gcm9vdDtcclxuICAgICAgICAgICAgc2VsZi5fc3RhZ2UgPSByb290LnN0YWdlO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rog4zmma/mmL7npLrlsYJcclxuICAgICAgICAgICAgc2VsZi5fYmdMYXllciA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgICAgICBzZWxmLl9iZ0xheWVyLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByb290LmFkZENoaWxkKHNlbGYuX2JnTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rlnLrmma/mmL7npLrlsYJcclxuICAgICAgICAgICAgc2VsZi5fc2NlbmVMYXllciA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgICAgICBzZWxmLl9zY2VuZUxheWVyLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByb290LmFkZENoaWxkKHNlbGYuX3NjZW5lTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rmoYbmnrbmmL7npLrlsYJcclxuICAgICAgICAgICAgc2VsZi5fZnJhbWVMYXllciA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgICAgICBzZWxmLl9mcmFtZUxheWVyLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByb290LmFkZENoaWxkKHNlbGYuX2ZyYW1lTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rlvLnlh7rlsYJcclxuICAgICAgICAgICAgc2VsZi5fcGFuZWxMYXllciA9IG5ldyBldWkuVUlMYXllcigpO1xyXG4gICAgICAgICAgICBzZWxmLl9wYW5lbExheWVyLnRvdWNoRW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICByb290LmFkZENoaWxkKHNlbGYuX3BhbmVsTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rpga7nvanlsYJcclxuICAgICAgICAgICAgc2VsZi5fbWFza0xheWVyID0gbmV3IGV1aS5VSUxheWVyKCk7XHJcbiAgICAgICAgICAgIHNlbGYuX21hc2tMYXllci50b3VjaEVuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgcm9vdC5hZGRDaGlsZChzZWxmLl9tYXNrTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDliJvlu7rpobbnuqfmmL7npLrlsYJcclxuICAgICAgICAgICAgc2VsZi5fdG9wTGF5ZXIgPSBuZXcgZXVpLlVJTGF5ZXIoKTtcclxuICAgICAgICAgICAgc2VsZi5fdG9wTGF5ZXIudG91Y2hFbmFibGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJvb3QuYWRkQ2hpbGQoc2VsZi5fdG9wTGF5ZXIpO1xyXG4gICAgICAgICAgICAvLyDmj5LlhaXmm7TmlrDlsY/luZXlkb3ku6RcclxuICAgICAgICAgICAgY29yZS5tYXBDb21tYW5kKFNjZW5lTWVzc2FnZS5TQ0VORV9CRUZPUkVfQ0hBTkdFLCBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZCk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9rui1hOa6kOWSjOS4u+mimOmAgumFjeWZqFxyXG4gICAgICAgICAgICBlZ3JldC5yZWdpc3RlckltcGxlbWVudGF0aW9uKFwiZXVpLklBc3NldEFkYXB0ZXJcIiwgbmV3IEFzc2V0QWRhcHRlcigpKTtcclxuICAgICAgICAgICAgZWdyZXQucmVnaXN0ZXJJbXBsZW1lbnRhdGlvbihcImV1aS5JVGhlbWVBZGFwdGVyXCIsIG5ldyBUaGVtZUFkYXB0ZXIoc2VsZi5faW5pdFBhcmFtcykpO1xyXG4gICAgICAgICAgICAvLyDliqDovb3otYTmupDphY3nva5cclxuICAgICAgICAgICAgUkVTLmFkZEV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuQ09ORklHX0NPTVBMRVRFLCBvbkNvbmZpZ0NvbXBsZXRlLCBzZWxmKTtcclxuICAgICAgICAgICAgdmFyIHVybCA9IHdyYXBBYnNvbHV0ZVBhdGgoc2VsZi5faW5pdFBhcmFtcy5wYXRoUHJlZml4ICsgXCJyZXNvdXJjZS9kZWZhdWx0LnJlcy5qc29uXCIsIGVudmlyb25tZW50LmN1ckNETkhvc3QpO1xyXG4gICAgICAgICAgICBSRVMubG9hZENvbmZpZyh1cmwsIHNlbGYuX2luaXRQYXJhbXMucGF0aFByZWZpeCArIFwicmVzb3VyY2UvXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbkNvbmZpZ0NvbXBsZXRlKGV2dCkge1xyXG4gICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5DT05GSUdfQ09NUExFVEUsIG9uQ29uZmlnQ29tcGxldGUsIHNlbGYpO1xyXG4gICAgICAgICAgICAvLyDliqDovb3kuLvpopjphY3nva5cclxuICAgICAgICAgICAgdmFyIHVybCA9IHdyYXBBYnNvbHV0ZVBhdGgodGhpcy5faW5pdFBhcmFtcy5wYXRoUHJlZml4ICsgXCJyZXNvdXJjZS9kZWZhdWx0LnRobS5qc29uXCIsIGVudmlyb25tZW50LmN1ckNETkhvc3QpO1xyXG4gICAgICAgICAgICB2YXIgdGhlbWUgPSBuZXcgZXVpLlRoZW1lKHVybCwgc2VsZi5fcm9vdC5zdGFnZSk7XHJcbiAgICAgICAgICAgIHRoZW1lLmFkZEV2ZW50TGlzdGVuZXIoZXVpLlVJRXZlbnQuQ09NUExFVEUsIG9uVGhlbWVMb2FkQ29tcGxldGUsIHNlbGYpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvblRoZW1lTG9hZENvbXBsZXRlKGV2dCkge1xyXG4gICAgICAgICAgICBldnQudGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXVpLlVJRXZlbnQuQ09NUExFVEUsIG9uVGhlbWVMb2FkQ29tcGxldGUsIHNlbGYpO1xyXG4gICAgICAgICAgICAvLyDliqDovb3pooTliqDovb3otYTmupDnu4RcclxuICAgICAgICAgICAgdmFyIHByZWxvYWRHcm91cHMgPSB0aGlzLl9pbml0UGFyYW1zLnByZWxvYWRHcm91cHM7XHJcbiAgICAgICAgICAgIHNlbGYubG9hZEFzc2V0cyhwcmVsb2FkR3JvdXBzLCBudWxsLCBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBjb21wbGV0ZShzZWxmKTsgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yik5pat55qu6IKk5piv5ZCm5pivRWdyZXTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0geyp9IHNraW4g55qu6IKk5a+56LGhXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0g5piv5ZCm5pivRWdyZXTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuaXNNeVNraW4gPSBmdW5jdGlvbiAoc2tpbikge1xyXG4gICAgICAgIGlmIChza2luIGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdClcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgaWYgKHNraW4gaW5zdGFuY2VvZiBGdW5jdGlvbilcclxuICAgICAgICAgICAgcmV0dXJuIChza2luLnByb3RvdHlwZSBpbnN0YW5jZW9mIGVncmV0LkRpc3BsYXlPYmplY3QpO1xyXG4gICAgICAgIGlmICh0eXBlb2Ygc2tpbiA9PT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgcmV0dXJuIChlZ3JldC5nZXREZWZpbml0aW9uQnlOYW1lKHNraW4pICE9IG51bGwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YyF6KOFSFRNTEVsZW1lbnToioLngrlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IHNraW4g5Y6f5aeL55qu6IKkXHJcbiAgICAgKiBAcmV0dXJucyB7ZWdyZXQuRGlzcGxheU9iamVjdH0g5YyF6KOF5ZCO55qE55qu6IKkXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLndyYXBTa2luID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBza2luKSB7XHJcbiAgICAgICAgcmV0dXJuIHdyYXBTa2luKG1lZGlhdG9yLCBza2luKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOabv+aNouearuiCpO+8jOeUqOS6jue7hOS7tuWPmOi6q+aXtuS4jeWQjOihqOeOsOWxguahpeeahOWkhOeQhlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7Kn0gY3VycmVudCDlvZPliY3nmq7ogqRcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOimgeabv+aNoueahOearuiCpFxyXG4gICAgICogQHJldHVybnMgeyp9IOabv+aNouWujOavleeahOearuiCpFxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5yZXBsYWNlU2tpbiA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgLy8gRWdyZXTnmq7ogqTpnIDopoHliKTmlq3nsbvlnovvvIzov5vooYzkuI3lkIzlpITnkIZcclxuICAgICAgICBpZiAoY3VycmVudCBpbnN0YW5jZW9mIGV1aS5Db21wb25lbnQpIHtcclxuICAgICAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIGV1aS5Db21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIOS4pOi+uemDveaYr2V1aee7hOS7tu+8jOebtOaOpeWwhuWPs+aJi+earuiCpOi1i+WAvOe7meW3puaJi1xyXG4gICAgICAgICAgICAgICAgY3VycmVudC5za2luTmFtZSA9IHRhcmdldC5za2luO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIGVncmV0LkRpc3BsYXlPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWPs+aJi+aYr+aZrumAmuaYvuekuuWvueixoe+8jOenu+mZpOW3puaJi+earuiCpO+8jOa3u+WKoOWPs+aJi+aYvuekuuWIsOWFtuS4rVxyXG4gICAgICAgICAgICAgICAgY3VycmVudC5za2luTmFtZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50LmFkZENoaWxkKHRhcmdldCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlhbbku5bmg4XlhrXpg73orqTkuLrlj7PmiYvmmK/nmq7ogqTmlbDmja5cclxuICAgICAgICAgICAgICAgIGN1cnJlbnQuc2tpbk5hbWUgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g6L+U5Zue5bem5omLXHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgZWdyZXQuRGlzcGxheU9iamVjdCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWPs+aJi+S4jeaYr+aYvuekuuWvueixoe+8jOiupOS4uuaYr+earuiCpOaVsOaNru+8jOeUn+aIkOS4gOS4qmV1aS5Db21wb25lbnTljIXoo7nlroNcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbmV3IGV1aS5Db21wb25lbnQoKTtcclxuICAgICAgICAgICAgICAgIHRlbXAuc2tpbk5hbWUgPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB0ZW1wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOWPs+aJi+abv+aNouW3puaJi+S9jee9rlxyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gY3VycmVudC5wYXJlbnQ7XHJcbiAgICAgICAgICAgIHBhcmVudC5hZGRDaGlsZEF0KHRhcmdldCwgcGFyZW50LmdldENoaWxkSW5kZXgoY3VycmVudCkpO1xyXG4gICAgICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoY3VycmVudCk7XHJcbiAgICAgICAgICAgIC8vIOi/lOWbnuWPs+aJi1xyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWQjOatpeearuiCpO+8jOeUqOS6jue7hOS7tuWPmOi6q+WQjueahOmHjeaWsOWumuS9jVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gY3VycmVudCDlvZPliY3nmq7ogqRcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gdGFyZ2V0IOabv+aNoueahOearuiCpFxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5zeW5jU2tpbiA9IGZ1bmN0aW9uIChjdXJyZW50LCB0YXJnZXQpIHtcclxuICAgICAgICBpZiAoIWN1cnJlbnQgfHwgIXRhcmdldClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOiuvue9ruWxnuaAp1xyXG4gICAgICAgIC8vIOS4i+mdouaYr2VncmV057qn5Yir5bGe5oCnXHJcbiAgICAgICAgdmFyIHByb3BzID0gW1xyXG4gICAgICAgICAgICBcIm1hdHJpeFwiLCBcImFuY2hvck9mZnNldFhcIiwgXCJhbmNob3JPZmZzZXRZXCIsIFwiYWxwaGFcIiwgXCJ2aXNpYmxlXCJcclxuICAgICAgICBdO1xyXG4gICAgICAgIC8vIOWmguaenOW9k+WJjeWuvemrmOS4jeS4ujDliJnlkIzmoLforr7nva7lrr3pq5hcclxuICAgICAgICBpZiAoY3VycmVudC53aWR0aCA+IDApXHJcbiAgICAgICAgICAgIHByb3BzLnB1c2goXCJ3aWR0aFwiKTtcclxuICAgICAgICBpZiAoY3VycmVudC5oZWlnaHQgPiAwKVxyXG4gICAgICAgICAgICBwcm9wcy5wdXNoKFwiaGVpZ2h0XCIpO1xyXG4gICAgICAgIC8vIOS4i+mdouaYr2V1aee6p+WIq+WxnuaAp1xyXG4gICAgICAgIGlmIChjdXJyZW50IGluc3RhbmNlb2YgZXVpLkNvbXBvbmVudCAmJiB0YXJnZXQgaW5zdGFuY2VvZiBldWkuQ29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHByb3BzLnB1c2guYXBwbHkocHJvcHMsIFtcclxuICAgICAgICAgICAgICAgIFwiaG9yaXpvbnRhbENlbnRlclwiLCBcInZlcnRpY2FsQ2VudGVyXCIsIFwibGVmdFwiLCBcInJpZ2h0XCIsIFwidG9wXCIsIFwiYm90dG9tXCJcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWFqOmDqOi1i+WAvFxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgcHJvcHNfMSA9IHByb3BzOyBfaSA8IHByb3BzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBwcm9wID0gcHJvcHNfMVtfaV07XHJcbiAgICAgICAgICAgIHRhcmdldFtwcm9wXSA9IGN1cnJlbnRbcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yib5bu65LiA5Liq56m655qE5pi+56S65a+56LGhXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge2VncmV0LlNwcml0ZX1cclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuY3JlYXRlRW1wdHlEaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgZWdyZXQuU3ByaXRlKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmt7vliqDmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDopoHmt7vliqDliLDnmoTniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gdGFyZ2V0IOiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHJldHVybiB7ZWdyZXQuRGlzcGxheU9iamVjdH0g6L+U5Zue6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudCAmJiB0YXJnZXQpXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuYWRkQ2hpbGQodGFyZ2V0KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjInntKLlvJXmt7vliqDmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDopoHmt7vliqDliLDnmoTniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gdGFyZ2V0IOiiq+a3u+WKoOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IOimgea3u+WKoOWIsOeahOeItue6p+e0ouW8lVxyXG4gICAgICogQHJldHVybiB7ZWdyZXQuRGlzcGxheU9iamVjdH0g6L+U5Zue6KKr5re75Yqg55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmFkZENoaWxkQXQgPSBmdW5jdGlvbiAocGFyZW50LCB0YXJnZXQsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudCAmJiB0YXJnZXQpXHJcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnQuYWRkQ2hpbGRBdCh0YXJnZXQsIGluZGV4KTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdH0gdGFyZ2V0IOiiq+enu+mZpOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHJldHVybiB7ZWdyZXQuRGlzcGxheU9iamVjdH0g6L+U5Zue6KKr56e76Zmk55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLnJlbW92ZUNoaWxkID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudCAmJiB0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudCA9PT0gcGFyZW50KVxyXG4gICAgICAgICAgICByZXR1cm4gcGFyZW50LnJlbW92ZUNoaWxkKHRhcmdldCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5oyJ57Si5byV56e76Zmk5pi+56S6XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXgg57Si5byVXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDov5Tlm57ooqvnp7vpmaTnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIGluZGV4KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudCAmJiBpbmRleCA+PSAwKVxyXG4gICAgICAgICAgICByZXR1cm4gcGFyZW50LnJlbW92ZUNoaWxkQXQoaW5kZXgpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTmiYDmnInmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUucmVtb3ZlQ2hpbGRyZW4gPSBmdW5jdGlvbiAocGFyZW50KSB7XHJcbiAgICAgICAgaWYgKHBhcmVudClcclxuICAgICAgICAgICAgcGFyZW50LnJlbW92ZUNoaWxkcmVuKCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bniLblrrnlmahcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3R9IHRhcmdldCDnm67moIflr7nosaFcclxuICAgICAqIEByZXR1cm5zIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfSDniLblrrnlmahcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuZ2V0UGFyZW50ID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQucGFyZW50O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5oyH5a6a57Si5byV5aSE55qE5pi+56S65a+56LGhXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0Q29udGFpbmVyfSBwYXJlbnQg54i25a655ZmoXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gaW5kZXgg5oyH5a6a54i257qn57Si5byVXHJcbiAgICAgKiBAcmV0dXJuIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSDntKLlvJXlpITnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBFZ3JldEJyaWRnZVxyXG4gICAgICovXHJcbiAgICBFZ3JldEJyaWRnZS5wcm90b3R5cGUuZ2V0Q2hpbGRBdCA9IGZ1bmN0aW9uIChwYXJlbnQsIGluZGV4KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5nZXRDaGlsZEF0KGluZGV4KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaYvuekuue0ouW8lVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRGlzcGxheU9iamVjdENvbnRhaW5lcn0gcGFyZW50IOeItuWuueWZqFxyXG4gICAgICogQHBhcmFtIHtlZ3JldC5EaXNwbGF5T2JqZWN0fSB0YXJnZXQg5a2Q5pi+56S65a+56LGhXHJcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9IHRhcmdldOWcqHBhcmVudOS4reeahOe0ouW8lVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5nZXRDaGlsZEluZGV4ID0gZnVuY3Rpb24gKHBhcmVudCwgdGFyZ2V0KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5nZXRDaGlsZEluZGV4KHRhcmdldCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpgJrov4flkI3np7Dojrflj5bmmL7npLrlr7nosaFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOWvueixoeWQjeensFxyXG4gICAgICogQHJldHVybiB7ZWdyZXQuRGlzcGxheU9iamVjdH0g5pi+56S65a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmdldENoaWxkQnlOYW1lID0gZnVuY3Rpb24gKHBhcmVudCwgbmFtZSkge1xyXG4gICAgICAgIHJldHVybiBwYXJlbnQuZ2V0Q2hpbGRCeU5hbWUobmFtZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blrZDmmL7npLrlr7nosaHmlbDph49cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXJ9IHBhcmVudCDniLblrrnlmahcclxuICAgICAqIEByZXR1cm4ge251bWJlcn0g5a2Q5pi+56S65a+56LGh5pWw6YePXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLmdldENoaWxkQ291bnQgPSBmdW5jdGlvbiAocGFyZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIHBhcmVudC5udW1DaGlsZHJlbjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vei1hOa6kFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IGFzc2V0cyDotYTmupDmlbDnu4RcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDotYTmupDliJfooahcclxuICAgICAqIEBwYXJhbSB7KGVycj86RXJyb3IpPT52b2lkfSBoYW5kbGVyIOWbnuiwg+WHveaVsFxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5sb2FkQXNzZXRzID0gZnVuY3Rpb24gKGFzc2V0cywgbWVkaWF0b3IsIGhhbmRsZXIpIHtcclxuICAgICAgICB2YXIgbG9hZGVyID0gbmV3IEFzc2V0c0xvYWRlcih7XHJcbiAgICAgICAgICAgIG9uZUVycm9yOiBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIobmV3IEVycm9yKFwi6LWE5rqQ5Yqg6L295aSx6LSlXCIpKTtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkeWKoOi9vemUmeivr+S6i+S7tlxyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChNb2R1bGVNZXNzYWdlLk1PRFVMRV9MT0FEX0FTU0VUU19FUlJPUiwgZXZ0KTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uIChkaWN0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGhhbmRsZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxvYWRlci5sb2FkR3JvdXBzKGFzc2V0cyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnm5HlkKzkuovku7bvvIzku47ov5nkuKrmlrnms5Xnm5HlkKznmoTkuovku7bkvJrlnKjkuK3ku4vogIXplIDmr4Hml7booqvoh6rliqjnp7vpmaTnm5HlkKxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2VncmV0LkV2ZW50RGlzcGF0Y2hlcn0gdGFyZ2V0IOS6i+S7tuebruagh+WvueixoVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5LqL5Lu257G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOS6i+S7tuWkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gdGhpc+aMh+WQkeWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIEVncmV0QnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS5tYXBMaXN0ZW5lciA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUsIGhhbmRsZXIsIHRoaXNBcmcpIHtcclxuICAgICAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOebkeWQrOS6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZWdyZXQuRXZlbnREaXNwYXRjaGVyfSB0YXJnZXQg5LqL5Lu255uu5qCH5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSDkuovku7bnsbvlnotcclxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXIg5LqL5Lu25aSE55CG5Ye95pWwXHJcbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSB0aGlz5oyH5ZCR5a+56LGhXHJcbiAgICAgKiBAbWVtYmVyb2YgRWdyZXRCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLnVubWFwTGlzdGVuZXIgPSBmdW5jdGlvbiAodGFyZ2V0LCB0eXBlLCBoYW5kbGVyLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgaGFuZGxlciwgdGhpc0FyZyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDkuLrnu5HlrprnmoTliJfooajmmL7npLrlr7nosaHljIXoo4XkuIDkuKrmuLLmn5PlmajliJvlu7rlm57osINcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2V1aS5EYXRhR3JvdXB9IHRhcmdldCBCaW5kRm9y5oyH5Luk5oyH5ZCR55qE5pi+56S65a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyhrZXk/OmFueSwgdmFsdWU/OmFueSwgcmVuZGVyZXI/OmV1aS5JSXRlbVJlbmRlcmVyKT0+dm9pZH0gcmVuZGVyZXJIYW5kbGVyIOa4suafk+WZqOWIm+W7uuWbnuiwg1xyXG4gICAgICogQHJldHVybnMgeyp9IOi/lOWbnuS4gOS4quWkh+W/mOW9leWvueixoe+8jOS8muWcqOi1i+WAvOaXtuaPkOS+m1xyXG4gICAgICogQG1lbWJlcm9mIElCcmlkZ2VcclxuICAgICAqL1xyXG4gICAgRWdyZXRCcmlkZ2UucHJvdG90eXBlLndyYXBCaW5kRm9yID0gZnVuY3Rpb24gKHRhcmdldCwgcmVuZGVyZXJIYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIG1lbWVudG8gPSB7fTtcclxuICAgICAgICB3cmFwRVVJTGlzdCh0YXJnZXQsIGZ1bmN0aW9uIChkYXRhLCByZW5kZXJlcikge1xyXG4gICAgICAgICAgICAvLyDlj5blh7prZXlcclxuICAgICAgICAgICAgdmFyIGtleTtcclxuICAgICAgICAgICAgdmFyIGRhdGFzID0gbWVtZW50by5kYXRhcztcclxuICAgICAgICAgICAgLy8g6YGN5Y6GbWVtZW50b+eahGRhdGFz5bGe5oCn77yI5ZyodmFsdWF0ZUJpbmRGb3Lml7booqvotYvlgLzvvIlcclxuICAgICAgICAgICAgaWYgKGRhdGFzIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAgICAgICAgIGtleSA9IHJlbmRlcmVyLml0ZW1JbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZGF0YXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YXNbaV0gPT09IGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6L+Z5bCx5piv5oiR5Lus6KaB5om+55qEa2V5XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgaWYgKGtleSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWVtZW50by5zeW5jRGljdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbWVtZW50by5zeW5jRGljdFtrZXldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRbXCJfX2VncmV0X2RhdGFncm91cF9zdGF0ZV9fXCJdID09PSAxIHx8IHRhcmdldFtcIl9fZWdyZXRfZGF0YWdyb3VwX3N0YXRlX19cIl0gPT09IDIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbWVudG8uc3luY0RpY3Rba2V5XSA9IGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlckhhbmRsZXIoa2V5LCBkYXRhLCByZW5kZXJlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZW5kZXJlckhhbmRsZXIoa2V5LCBkYXRhLCByZW5kZXJlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbWVtZW50bztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOS4uuWIl+ihqOaYvuekuuWvueixoei1i+WAvFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7ZXVpLkRhdGFHcm91cH0gdGFyZ2V0IEJpbmRGb3LmjIfku6TmjIflkJHnmoTmmL7npLrlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gZGF0YXMg5pWw5o2u6ZuG5ZCIXHJcbiAgICAgKiBAcGFyYW0geyp9IG1lbWVudG8gd3JhcEJpbmRGb3Lov5Tlm57nmoTlpIflv5jlvZXlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBJQnJpZGdlXHJcbiAgICAgKi9cclxuICAgIEVncmV0QnJpZGdlLnByb3RvdHlwZS52YWx1YXRlQmluZEZvciA9IGZ1bmN0aW9uICh0YXJnZXQsIGRhdGFzLCBtZW1lbnRvKSB7XHJcbiAgICAgICAgdmFyIHByb3ZpZGVyO1xyXG4gICAgICAgIC8vIOWIneWni+WMluWIl+ihqOeKtuaAgVxyXG4gICAgICAgIHRhcmdldFtcIl9fZWdyZXRfZGF0YWdyb3VwX3N0YXRlX19cIl0gPSAwO1xyXG4gICAgICAgIC8vIOiuvue9rm1lbWVudG9cclxuICAgICAgICBtZW1lbnRvLmRhdGFzID0gZGF0YXM7XHJcbiAgICAgICAgbWVtZW50by5zeW5jRGljdCA9IHt9O1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDkuIDmrKHmuLLmn5PlkI7op6PplIFcclxuICAgICAgICAgICAgZGVsZXRlIG1lbWVudG8uc3luY0RpY3Q7XHJcbiAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgLy8g5aSN5Yi2ZGF0YXNcclxuICAgICAgICBpZiAoZGF0YXMgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgICAgICBwcm92aWRlciA9IG5ldyBldWkuQXJyYXlDb2xsZWN0aW9uKGRhdGFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOaYr+Wtl+WFuO+8jOWwhuWFtuWPmOS4uuaVsOe7hFxyXG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YXMpIHtcclxuICAgICAgICAgICAgICAgIGxpc3QucHVzaChkYXRhc1trZXldKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwcm92aWRlciA9IG5ldyBldWkuQXJyYXlDb2xsZWN0aW9uKGxpc3QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDotYvlgLxcclxuICAgICAgICB0YXJnZXQuZGF0YVByb3ZpZGVyID0gcHJvdmlkZXI7XHJcbiAgICB9O1xyXG4gICAgLyoqIOaPkOS+m+mdmeaAgeexu+Wei+W4uOmHjyAqL1xyXG4gICAgRWdyZXRCcmlkZ2UuVFlQRSA9IFwiRWdyZXRcIjtcclxuICAgIHJldHVybiBFZ3JldEJyaWRnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRWdyZXRCcmlkZ2U7XHJcbnZhciBBc3NldEFkYXB0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBc3NldEFkYXB0ZXIoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEBsYW5ndWFnZSB6aF9DTlxyXG4gICAgICog6Kej5p6Q57Sg5p2QXHJcbiAgICAgKiBAcGFyYW0gc291cmNlIOW+heino+aekOeahOaWsOe0oOadkOagh+ivhuesplxyXG4gICAgICogQHBhcmFtIGNvbXBGdW5jIOino+aekOWujOaIkOWbnuiwg+WHveaVsO+8jOekuuS+i++8mmNhbGxCYWNrKGNvbnRlbnQ6YW55LHNvdXJjZTpzdHJpbmcpOnZvaWQ7XHJcbiAgICAgKiBAcGFyYW0gdGhpc09iamVjdCBjYWxsQmFja+eahCB0aGlzIOW8leeUqFxyXG4gICAgICovXHJcbiAgICBBc3NldEFkYXB0ZXIucHJvdG90eXBlLmdldEFzc2V0ID0gZnVuY3Rpb24gKHNvdXJjZSwgY29tcEZ1bmMsIHRoaXNPYmplY3QpIHtcclxuICAgICAgICBpZiAoUkVTLmhhc1Jlcyhzb3VyY2UpKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRhID0gUkVTLmdldFJlcyhzb3VyY2UpO1xyXG4gICAgICAgICAgICBpZiAoZGF0YSlcclxuICAgICAgICAgICAgICAgIG9uR2V0UmVzKGRhdGEpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBSRVMuZ2V0UmVzQXN5bmMoc291cmNlLCBvbkdldFJlcywgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBSRVMuZ2V0UmVzQnlVcmwoc291cmNlLCBvbkdldFJlcywgdGhpcywgUkVTLlJlc291cmNlSXRlbS5UWVBFX0lNQUdFKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25HZXRSZXMoZGF0YSkge1xyXG4gICAgICAgICAgICBjb21wRnVuYy5jYWxsKHRoaXNPYmplY3QsIGRhdGEsIHNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBc3NldEFkYXB0ZXI7XHJcbn0oKSk7XHJcbnZhciBUaGVtZUFkYXB0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUaGVtZUFkYXB0ZXIoaW5pdFBhcmFtcykge1xyXG4gICAgICAgIHRoaXMuX2luaXRQYXJhbXMgPSBpbml0UGFyYW1zO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDop6PmnpDkuLvpophcclxuICAgICAqIEBwYXJhbSB1cmwg5b6F6Kej5p6Q55qE5Li76aKYdXJsXHJcbiAgICAgKiBAcGFyYW0gY29tcEZ1bmMg6Kej5p6Q5a6M5oiQ5Zue6LCD5Ye95pWw77yM56S65L6L77yaY29tcEZ1bmMoZTplZ3JldC5FdmVudCk6dm9pZDtcclxuICAgICAqIEBwYXJhbSBlcnJvckZ1bmMg6Kej5p6Q5aSx6LSl5Zue6LCD5Ye95pWw77yM56S65L6L77yaZXJyb3JGdW5jKCk6dm9pZDtcclxuICAgICAqIEBwYXJhbSB0aGlzT2JqZWN0IOWbnuiwg+eahHRoaXPlvJXnlKhcclxuICAgICAqL1xyXG4gICAgVGhlbWVBZGFwdGVyLnByb3RvdHlwZS5nZXRUaGVtZSA9IGZ1bmN0aW9uICh1cmwsIGNvbXBGdW5jLCBlcnJvckZ1bmMsIHRoaXNPYmplY3QpIHtcclxuICAgICAgICBSRVMuYWRkRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5JVEVNX0xPQURfRVJST1IsIG9uRXJyb3IsIG51bGwpO1xyXG4gICAgICAgIFJFUy5nZXRSZXNCeVVybCh1cmwsIG9uR2V0UmVzLCB0aGlzLCBSRVMuUmVzb3VyY2VJdGVtLlRZUEVfVEVYVCk7XHJcbiAgICAgICAgZnVuY3Rpb24gb25HZXRSZXMoZSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8g6ZyA6KaB5Li65omA5pyJ5Li76aKY6LWE5rqQ5re75Yqg6Lev5b6E5YmN57yAXHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoZSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YS5za2lucylcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnNraW5zW2tleV0gPSB0aGlzLl9pbml0UGFyYW1zLnBhdGhQcmVmaXggKyBkYXRhLnNraW5zW2tleV07XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZGF0YS5leG1scykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOWPquaYr1VSTOWImeebtOaOpea3u+WKoOWJjee8gO+8jOWQpuWImeaYr+WGheWuuembhuaIkOaWueW8j++8jOmcgOimgeWNleeLrOS/ruaUuXBhdGjlsZ7mgKdcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhtbCA9IGRhdGEuZXhtbHNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGV4bWwgPT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5leG1sc1trZXldID0gdGhpcy5faW5pdFBhcmFtcy5wYXRoUHJlZml4ICsgZXhtbDtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4bWwucGF0aCA9IHRoaXMuX2luaXRQYXJhbXMucGF0aFByZWZpeCArIGV4bWwucGF0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGUgPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7IH1cclxuICAgICAgICAgICAgY29tcEZ1bmMuY2FsbCh0aGlzT2JqZWN0LCBlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25FcnJvcihlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnJlc0l0ZW0udXJsID09IHVybCkge1xyXG4gICAgICAgICAgICAgICAgUkVTLnJlbW92ZUV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuSVRFTV9MT0FEX0VSUk9SLCBvbkVycm9yLCBudWxsKTtcclxuICAgICAgICAgICAgICAgIGVycm9yRnVuYy5jYWxsKHRoaXNPYmplY3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBUaGVtZUFkYXB0ZXI7XHJcbn0oKSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L0VncmV0QnJpZGdlLmpzXG4vLyBtb2R1bGUgaWQgPSAyOFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzXG4vLyBtb2R1bGUgaWQgPSAyOVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgQ29tbW9uTWVzc2FnZSBmcm9tIFwiLi4vbWVzc2FnZS9Db21tb25NZXNzYWdlXCI7XHJcbmltcG9ydCBDb3JlTWVzc2FnZSBmcm9tIFwiLi4vbWVzc2FnZS9Db3JlTWVzc2FnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzFcclxuICpcclxuICog5Y+v6KeC5a+f5o6l5Y+j55qE6buY6K6k5a6e546w5a+56LGh77yM5Lya5bCG5pS25Yiw55qE5raI5oGv6YCa55+l57uZ5rOo5YaM55qE5Zue6LCDXHJcbiovXHJcbnZhciBPYnNlcnZhYmxlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT2JzZXJ2YWJsZShwYXJlbnQpIHtcclxuICAgICAgICB0aGlzLl9saXN0ZW5lckRpY3QgPSB7fTtcclxuICAgICAgICB0aGlzLl9jb21tYW5kRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQgJiYgcGFyZW50Lm9ic2VydmFibGU7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JzZXJ2YWJsZS5wcm90b3R5cGUsIFwib2JzZXJ2YWJsZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5YiwSU9ic2VydmFibGXlrp7kvZPvvIzoi6XmnKzouqvlsLHmmK9JT2JzZXJ2YWJsZeWunuS9k+WImei/lOWbnuacrOi6q1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBPYnNlcnZhYmxlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuaGFuZGxlTWVzc2FnZXMgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIHZhciBsaXN0ZW5lcnMxID0gdGhpcy5fbGlzdGVuZXJEaWN0W21zZy5fX3R5cGVdO1xyXG4gICAgICAgIHZhciBsaXN0ZW5lcnMyID0gdGhpcy5fbGlzdGVuZXJEaWN0W21zZy5jb25zdHJ1Y3Rvci50b1N0cmluZygpXTtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gKGxpc3RlbmVyczEgJiYgbGlzdGVuZXJzMiA/IGxpc3RlbmVyczEuY29uY2F0KGxpc3RlbmVyczIpIDogbGlzdGVuZXJzMSB8fCBsaXN0ZW5lcnMyKTtcclxuICAgICAgICBpZiAobGlzdGVuZXJzKSB7XHJcbiAgICAgICAgICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5jb25jYXQoKTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBsaXN0ZW5lcnNfMSA9IGxpc3RlbmVyczsgX2kgPCBsaXN0ZW5lcnNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gbGlzdGVuZXJzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5aSE55CG5Ye95pWwXHJcbiAgICAgICAgICAgICAgICBpZiAobXNnIGluc3RhbmNlb2YgQ29tbW9uTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzmmK/pgJrnlKjmtojmga/vvIzliJnlsIblj4LmlbDnu5PmnoTlkI7osIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICAoX2EgPSB0ZW1wLmhhbmRsZXIpLmNhbGwuYXBwbHkoX2EsIFt0ZW1wLnRoaXNBcmddLmNvbmNhdChtc2cucGFyYW1zKSk7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv5YW25LuW5raI5oGv77yM5YiZ55u05o6l5bCG5raI5oGv5L2T5Lyg57uZ5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcC5oYW5kbGVyLmNhbGwodGVtcC50aGlzQXJnLCBtc2cpO1xyXG4gICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv5LiA5qyh5oCn55uR5ZCs5YiZ56e76Zmk5LmLXHJcbiAgICAgICAgICAgICAgICBpZiAodGVtcC5vbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy51bmxpc3Rlbihtc2cuX190eXBlLCB0ZW1wLmhhbmRsZXIsIHRlbXAudGhpc0FyZywgdGVtcC5vbmNlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnVubGlzdGVuKG1zZy5jb25zdHJ1Y3Rvci50b1N0cmluZygpLCB0ZW1wLmhhbmRsZXIsIHRlbXAudGhpc0FyZywgdGVtcC5vbmNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5kb0Rpc3BhdGNoID0gZnVuY3Rpb24gKG1zZykge1xyXG4gICAgICAgIC8vIOiusOW9lea1gei9rOWGheaguFxyXG4gICAgICAgIG1zZy5fX29ic2VydmFibGVzLnB1c2godGhpcyk7XHJcbiAgICAgICAgLy8g6Kem5Y+R5ZG95LukXHJcbiAgICAgICAgdGhpcy5oYW5kbGVDb21tYW5kcyhtc2cpO1xyXG4gICAgICAgIC8vIOinpuWPkeeUqGxpc3RlbuW9ouW8j+ebkeWQrOeahOa2iOaBr1xyXG4gICAgICAgIHRoaXMuaGFuZGxlTWVzc2FnZXMobXNnKTtcclxuICAgIH07XHJcbiAgICAvKiogZGlzcGF0Y2jmlrnms5Xlrp7njrAgKi9cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHR5cGVPck1zZykge1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBwYXJhbXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOmUgOavgeWIpOaWrVxyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOe7n+S4gOa2iOaBr+WvueixoVxyXG4gICAgICAgIHZhciBtc2cgPSB0eXBlT3JNc2c7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0eXBlT3JNc2cgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBtc2cgPSBuZXcgQ29tbW9uTWVzc2FnZSh0eXBlT3JNc2cpO1xyXG4gICAgICAgICAgICBtc2cucGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICB0aGlzLmRvRGlzcGF0Y2gobXNnKTtcclxuICAgICAgICAvLyDpop3lpJbmtL7lj5HkuIDkuKrpgJrnlKjkuovku7ZcclxuICAgICAgICB0aGlzLmRvRGlzcGF0Y2gobmV3IENvbW1vbk1lc3NhZ2UoQ29yZU1lc3NhZ2UuTUVTU0FHRV9ESVNQQVRDSEVELCBtc2cpKTtcclxuICAgICAgICAvLyDlsIbkuovku7bovazlj5HliLDkuIrkuIDlsYJcclxuICAgICAgICB0aGlzLnBhcmVudCAmJiB0aGlzLnBhcmVudC5kaXNwYXRjaChtc2cpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog55uR5ZCs5YaF5qC45raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOa2iOaBr+WkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10g5raI5oGvdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0g5piv5ZCm5LiA5qyh5oCn55uR5ZCsXHJcbiAgICAgKiBAbWVtYmVyb2YgT2JzZXJ2YWJsZVxyXG4gICAgICovXHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5saXN0ZW4gPSBmdW5jdGlvbiAodHlwZSwgaGFuZGxlciwgdGhpc0FyZywgb25jZSkge1xyXG4gICAgICAgIGlmIChvbmNlID09PSB2b2lkIDApIHsgb25jZSA9IGZhbHNlOyB9XHJcbiAgICAgICAgLy8g6ZSA5q+B5Yik5patXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdHlwZSA9ICh0eXBlb2YgdHlwZSA9PSBcInN0cmluZ1wiID8gdHlwZSA6IHR5cGUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuX2xpc3RlbmVyRGljdFt0eXBlXTtcclxuICAgICAgICBpZiAoIWxpc3RlbmVycylcclxuICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXJEaWN0W3R5cGVdID0gbGlzdGVuZXJzID0gW107XHJcbiAgICAgICAgLy8g5qOA5p+l5a2Y5Zyo5oCnXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdGVtcCA9IGxpc3RlbmVyc1tpXTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5bey57uP5a2Y5Zyo55uR5ZCs5YiZ55u05o6l6L+U5ZueXHJcbiAgICAgICAgICAgIGlmICh0ZW1wLmhhbmRsZXIgPT0gaGFuZGxlciAmJiB0ZW1wLnRoaXNBcmcgPT0gdGhpc0FyZylcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5re75Yqg55uR5ZCsXHJcbiAgICAgICAgbGlzdGVuZXJzLnB1c2goeyBoYW5kbGVyOiBoYW5kbGVyLCB0aGlzQXJnOiB0aGlzQXJnLCBvbmNlOiBvbmNlIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog56e76Zmk5YaF5qC45raI5oGv55uR5ZCsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyIOa2iOaBr+WkhOeQhuWHveaVsFxyXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10g5raI5oGvdGhpc+aMh+WQkVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb25jZT1mYWxzZV0g5piv5ZCm5LiA5qyh5oCn55uR5ZCsXHJcbiAgICAgKiBAbWVtYmVyb2YgT2JzZXJ2YWJsZVxyXG4gICAgICovXHJcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS51bmxpc3RlbiA9IGZ1bmN0aW9uICh0eXBlLCBoYW5kbGVyLCB0aGlzQXJnLCBvbmNlKSB7XHJcbiAgICAgICAgaWYgKG9uY2UgPT09IHZvaWQgMCkgeyBvbmNlID0gZmFsc2U7IH1cclxuICAgICAgICAvLyDplIDmr4HliKTmlq1cclxuICAgICAgICBpZiAodGhpcy5fZGlzcG9zZWQpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0eXBlID0gKHR5cGVvZiB0eXBlID09IFwic3RyaW5nXCIgPyB0eXBlIDogdHlwZS50b1N0cmluZygpKTtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5fbGlzdGVuZXJEaWN0W3R5cGVdO1xyXG4gICAgICAgIC8vIOajgOafpeWtmOWcqOaAp1xyXG4gICAgICAgIGlmIChsaXN0ZW5lcnMpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBsaXN0ZW5lcnNbaV07XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzlt7Lnu4/lrZjlnKjnm5HlkKzliJnnm7TmjqXov5Tlm55cclxuICAgICAgICAgICAgICAgIGlmICh0ZW1wLmhhbmRsZXIgPT0gaGFuZGxlciAmJiB0ZW1wLnRoaXNBcmcgPT0gdGhpc0FyZyAmJiB0ZW1wLm9uY2UgPT0gb25jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxpc3RlbmVycy5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuaGFuZGxlQ29tbWFuZHMgPSBmdW5jdGlvbiAobXNnKSB7XHJcbiAgICAgICAgdmFyIGNvbW1hbmRzID0gdGhpcy5fY29tbWFuZERpY3RbbXNnLl9fdHlwZV07XHJcbiAgICAgICAgaWYgKGNvbW1hbmRzKSB7XHJcbiAgICAgICAgICAgIGNvbW1hbmRzID0gY29tbWFuZHMuY29uY2F0KCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY29tbWFuZHNfMSA9IGNvbW1hbmRzOyBfaSA8IGNvbW1hbmRzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2xzID0gY29tbWFuZHNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICAvLyDmiafooYzlkb3ku6RcclxuICAgICAgICAgICAgICAgIG5ldyBjbHMobXNnKS5leGVjKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhozlkb3ku6TliLDnibnlrprmtojmga/nsbvlnovkuIrvvIzlvZPov5nkuKrnsbvlnovnmoTmtojmga/mtL7lj5HliLDmoYbmnrblhoXmoLjml7bkvJrop6blj5FDb21tYW5k6L+Q6KGMXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg6KaB5rOo5YaM55qE5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0geyhJQ29tbWFuZENvbnN0cnVjdG9yKX0gY21kIOWRveS7pOWkhOeQhuWZqO+8jOWPr+S7peaYr+aWueazleW9ouW8j++8jOS5n+WPr+S7peS9v+exu+W9ouW8j1xyXG4gICAgICogQG1lbWJlcm9mIE9ic2VydmFibGVcclxuICAgICAqL1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUubWFwQ29tbWFuZCA9IGZ1bmN0aW9uICh0eXBlLCBjbWQpIHtcclxuICAgICAgICAvLyDplIDmr4HliKTmlq1cclxuICAgICAgICBpZiAodGhpcy5fZGlzcG9zZWQpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB2YXIgY29tbWFuZHMgPSB0aGlzLl9jb21tYW5kRGljdFt0eXBlXTtcclxuICAgICAgICBpZiAoIWNvbW1hbmRzKVxyXG4gICAgICAgICAgICB0aGlzLl9jb21tYW5kRGljdFt0eXBlXSA9IGNvbW1hbmRzID0gW107XHJcbiAgICAgICAgaWYgKGNvbW1hbmRzLmluZGV4T2YoY21kKSA8IDApXHJcbiAgICAgICAgICAgIGNvbW1hbmRzLnB1c2goY21kKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOmUgOWRveS7pFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIOimgeazqOmUgOeahOa2iOaBr+exu+Wei1xyXG4gICAgICogQHBhcmFtIHsoSUNvbW1hbmRDb25zdHJ1Y3Rvcil9IGNtZCDlkb3ku6TlpITnkIblmahcclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxyXG4gICAgICogQG1lbWJlcm9mIE9ic2VydmFibGVcclxuICAgICAqL1xyXG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUudW5tYXBDb21tYW5kID0gZnVuY3Rpb24gKHR5cGUsIGNtZCkge1xyXG4gICAgICAgIC8vIOmUgOavgeWIpOaWrVxyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHZhciBjb21tYW5kcyA9IHRoaXMuX2NvbW1hbmREaWN0W3R5cGVdO1xyXG4gICAgICAgIGlmICghY29tbWFuZHMpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB2YXIgaW5kZXggPSBjb21tYW5kcy5pbmRleE9mKGNtZCk7XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGNvbW1hbmRzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICB9O1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE9ic2VydmFibGUucHJvdG90eXBlLCBcImRpc3Bvc2VkXCIsIHtcclxuICAgICAgICAvKiog5piv5ZCm5bey57uP6KKr6ZSA5q+BICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKiDplIDmr4EgKi9cclxuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8g6ZSA5q+B5Yik5patXHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g56e76Zmk5LiK5LiA5bGC6KeC5a+f6ICF5byV55SoXHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgIC8vIOa4heepuuaJgOaciea2iOaBr+ebkeWQrFxyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyRGljdCA9IG51bGw7XHJcbiAgICAgICAgLy8g5riF56m65omA5pyJ5ZG95LukXHJcbiAgICAgICAgdGhpcy5fY29tbWFuZERpY3QgPSBudWxsO1xyXG4gICAgICAgIC8vIOagh+iusOmUgOavgVxyXG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VkID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gT2JzZXJ2YWJsZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgT2JzZXJ2YWJsZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvY29yZS9vYnNlcnZhYmxlL09ic2VydmFibGUuanNcbi8vIG1vZHVsZSBpZCA9IDMwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gKlxyXG4gKiDmtojmga/ln7rnsbtcclxuKi9cclxudmFyIE1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNZXNzYWdlKHR5cGUpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmtojmga/mtL7lj5HlhoXmoLjliJfooahcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJT2JzZXJ2YWJsZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgTWVzc2FnZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX19vYnNlcnZhYmxlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lc3NhZ2UucHJvdG90eXBlLCBcIl9fdHlwZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5raI5oGv57G75Z6L5a2X56ym5LiyXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZXNzYWdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1lc3NhZ2UucHJvdG90eXBlLCBcIl9fb2JzZXJ2YWJsZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog5raI5oGv5b2T5YmN5omA5bGe5YaF5qC4XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7SU9ic2VydmFibGV9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIE1lc3NhZ2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19vYnNlcnZhYmxlc1swXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNZXNzYWdlLnByb3RvdHlwZSwgXCJfX29yaU9ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+aJgOWxnueahOWOn+Wni+WGheaguO+8iOesrOS4gOS4qua0vuWPkeWIsOeahOWGheaguO+8iVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBNZXNzYWdlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9fb2JzZXJ2YWJsZXNbdGhpcy5fX29ic2VydmFibGVzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlho3mrKHlj5HpgIHmtojmga/vvIzkvJrkvb/nlKjpppbkuKrlhoXmoLjph43mlrDlj5HpgIHor6Xmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBNZXNzYWdlLnByb3RvdHlwZS5yZWRpc3BhdGNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuX19vcmlPYnNlcnZhYmxlLmRpc3BhdGNoKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNZXNzYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gMzFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTEzXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTEzXHJcbiAqXHJcbiAqIOaguOW/g+S6i+S7tuexu+Wei1xyXG4qL1xyXG52YXIgQ29yZU1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDb3JlTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Lu75L2V5raI5oGv5rS+5Y+R5Yiw5qGG5p625ZCO6YO95Lya5rS+5Y+R6L+Z5Liq5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBDb3JlTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBDb3JlTWVzc2FnZS5NRVNTQUdFX0RJU1BBVENIRUQgPSBcIm1lc3NhZ2VEaXNwYXRjaGVkXCI7XHJcbiAgICByZXR1cm4gQ29yZU1lc3NhZ2U7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IENvcmVNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL21lc3NhZ2UvQ29yZU1lc3NhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDMyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuL0RpY3Rpb25hcnlcIjtcclxuLyoqXHJcbiAqIOeugOWNleaVsOe7hOS5seW6j1xyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEB0ZW1wbGF0ZSBUXHJcbiAqIEBwYXJhbSB7VH0gYVxyXG4gKiBAcmV0dXJucyB7VH1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBzaHVmZmxlKGEpIHtcclxuICAgIHZhciBsZW4gPSBhLmxlbmd0aDtcclxuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICB2YXIgZW5kID0gbGVuIC0gaTtcclxuICAgICAgICB2YXIgaW5kZXggPSAoTWF0aC5yYW5kb20oKSAqIChlbmQgKyAxKSkgPj4gMDtcclxuICAgICAgICB2YXIgdCA9IGFbZW5kXTtcclxuICAgICAgICBhW2VuZF0gPSBhW2luZGV4XTtcclxuICAgICAgICBhW2luZGV4XSA9IHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYTtcclxufVxyXG4vKipcclxuICog5LuO5pWw57uE5oyH5a6a6IyD5Zu05YaF6ZqP5py65Y+W5Ye65oyH5a6a5pWw6YeP55qE5LiN6YeN5aSN5YWD57SgXHJcbiAqIEFycmF5VXRpbHMucmFuZG9taXplKFswLDEsMiwzLDQsNSw2LDcsOCw5XSwgMywgMiwgNyk7XHJcbiAqIC8v6L+U5ZueWzYsMiwzXVxyXG4gKlxyXG4gKiBAcGFyYW0gYXJyIFx0XHTljp/lp4vmlbDnu4RcclxuICogQHBhcmFtIGNvdW50XHQgICAg5pWw6YeP77yM6buY6K6k5Li66IyD5Zu05YaF5YWo6YOo5YWD57SgXHJcbiAqIEBwYXJhbSBiZWdpbiBcdOi1t+Wni+S9jee9ru+8jOm7mOiupOS4ujBcclxuICogQHBhcmFtIGVuZFx0XHTnu5PmnZ/kvY3nva7vvIzpu5jorqTkuLrmlbDnu4Tplb/luqZcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByYW5kb21pemUoYXJyLCBjb3VudCwgYmVnaW4sIGVuZCkge1xyXG4gICAgaWYgKCFhcnIgfHwgYmVnaW4gPCAwKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImludmFsaWQgYXJndW1lbnRcIik7XHJcbiAgICBhcnIgPSBhcnIuY29uY2F0KCk7XHJcbiAgICB2YXIgbGVuID0gYXJyLmxlbmd0aDtcclxuICAgIGVuZCA9IGVuZCA+PiAwO1xyXG4gICAgaWYgKCEoZW5kID49IDAgJiYgZW5kIDw9IGxlbikpIHtcclxuICAgICAgICBlbmQgPSBsZW47XHJcbiAgICB9XHJcbiAgICBiZWdpbiA9IGJlZ2luID4+IDA7XHJcbiAgICBpZiAoIShiZWdpbiA+IDApKSB7XHJcbiAgICAgICAgYmVnaW4gPSAwO1xyXG4gICAgfVxyXG4gICAgY291bnQgPSBjb3VudCA+PiAwO1xyXG4gICAgaWYgKCEoY291bnQgPj0gMCAmJiBjb3VudCA8IGVuZCAtIGJlZ2luKSkge1xyXG4gICAgICAgIGNvdW50ID0gZW5kIC0gYmVnaW47XHJcbiAgICB9XHJcbiAgICB2YXIgYXJyMiA9IFtdO1xyXG4gICAgdmFyIGVuZDIgPSBiZWdpbiArIGNvdW50O1xyXG4gICAgZm9yICh2YXIgaSA9IGJlZ2luOyBpIDwgZW5kMjsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gKE1hdGgucmFuZG9tKCkgKiAoZW5kIC0gaSkgKyBpKSA+PiAwO1xyXG4gICAgICAgIGFycjJbaSAtIGJlZ2luXSA9IGFycltpbmRleF07XHJcbiAgICAgICAgYXJyW2luZGV4XSA9IGFycltpXTtcclxuICAgIH1cclxuICAgIHJldHVybiBhcnIyO1xyXG59XHJcbi8qKlxyXG4gKiDov5vooYzmnYPph43pmo/mnLpcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAdGVtcGxhdGUgVFxyXG4gKiBAcGFyYW0ge1RbXX0gYXJyIOWOn+Wni+aVsOe7hFxyXG4gKiBAcGFyYW0ge251bWJlcltdfSB3ZWlnaHQg5p2D6YeN5pWw57uE77yM5bqU5L+d6K+B5p2D6YeN5pWw57uE55qE5YWD57Sg5pWw6YeP5LiN5bCP5LqO5Y6f5aeL5pWw57uE55qE5YWD57Sg5pWw6YePXHJcbiAqIEByZXR1cm5zIHtUfSDpgInlj5bnmoTnu5PmnpxcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiByYW5kb21pemVXZWlnaHQoYXJyLCB3ZWlnaHQpIHtcclxuICAgIGlmICghYXJyIHx8ICF3ZWlnaHQpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52YWxpZCBhcmd1bWVudFwiKTtcclxuICAgIGlmICh3ZWlnaHQubGVuZ3RoIDwgYXJyLmxlbmd0aClcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCLmnYPph43mlbDnu4TnmoTlhYPntKDmlbDph4/kuI3lupTlsI/kuo7ljp/lp4vmlbDnu4TnmoTlhYPntKDmlbDph49cIik7XHJcbiAgICAvLyDmoLnmja7mnYPph43mlbDnu4Tlu7rnq4vkuIDkuKrljLrpl7TmlbDnu4RcclxuICAgIHZhciByZWdpb25zID0gW107XHJcbiAgICB2YXIgc3VtID0gMDtcclxuICAgIGZvciAodmFyIGkgaW4gYXJyKSB7XHJcbiAgICAgICAgc3VtICs9IHdlaWdodFtpXTtcclxuICAgICAgICByZWdpb25zLnB1c2goc3VtKTtcclxuICAgIH1cclxuICAgIC8vIOmaj+acuuS4gOS4quS9jee9rlxyXG4gICAgdmFyIHJhbiA9IE1hdGgucmFuZG9tKCkgKiBzdW07XHJcbiAgICAvLyDmkJzntKLor6XkvY3nva7miYDlsZ7ljLrpl7TntKLlvJVcclxuICAgIHZhciBpbmRleDtcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSByZWdpb25zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgaWYgKHJhbiA8IHJlZ2lvbnNbaV0pIHtcclxuICAgICAgICAgICAgaW5kZXggPSBpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyDov5Tlm57ntKLlvJXlpITnmoTljp/lp4vmlbDnu4TlhYPntKBcclxuICAgIHJldHVybiBhcnJbaW5kZXhdO1xyXG59XHJcbi8qKlxyXG4gKiDmlbDnu4Tljrvph43vvIzkuI3kvJrkv67mlLnljp/mlbDnu4RcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge2FueVtdfSBsaXN0XHJcbiAqIEByZXR1cm5zIHthbnlbXX1cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1bmlxdWUobGlzdCkge1xyXG4gICAgaWYgKCFsaXN0KVxyXG4gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgLy8g5Yid5aeL5YyWXHJcbiAgICB2YXIgaGFzaCA9IG5ldyBEaWN0aW9uYXJ5KCksIHJlc3VsdCA9IFtdO1xyXG4gICAgLy8g6YGN5Y6G5b2T5YmN5pWw57uEXHJcbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgIC8vIOWmguaenGhhc2jooajkuK3msqHmnInlvZPliY3poblcclxuICAgICAgICBpZiAoIWhhc2guZ2V0KGxpc3RbaV0pKSB7XHJcbiAgICAgICAgICAgIC8vIOWtmOWFpWhhc2jooahcclxuICAgICAgICAgICAgaGFzaC5zZXQobGlzdFtpXSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIC8vIOaKiuW9k+WJjeaVsOe7hOeahOW9k+WJjemhuXB1c2jliLDkuLTml7bmlbDnu4Tph4zpnaJcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGlzdFtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci91dGlscy9BcnJheVV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDMzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImV4cG9ydCB2YXIgSlNMb2FkTW9kZTtcclxuKGZ1bmN0aW9uIChKU0xvYWRNb2RlKSB7XHJcbiAgICBKU0xvYWRNb2RlW0pTTG9hZE1vZGVbXCJBVVRPXCJdID0gMF0gPSBcIkFVVE9cIjtcclxuICAgIEpTTG9hZE1vZGVbSlNMb2FkTW9kZVtcIkpTT05QXCJdID0gMV0gPSBcIkpTT05QXCI7XHJcbiAgICBKU0xvYWRNb2RlW0pTTG9hZE1vZGVbXCJUQUdcIl0gPSAyXSA9IFwiVEFHXCI7XHJcbn0pKEpTTG9hZE1vZGUgfHwgKEpTTG9hZE1vZGUgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL2ludGVyZmFjZXMvSlNGaWxlLmpzXG4vLyBtb2R1bGUgaWQgPSAzNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCIuLi9lbmdpbmUvZW52L0Vudmlyb25tZW50XCI7XHJcbmltcG9ydCB7IGNsb25lT2JqZWN0IH0gZnJvbSBcIi4vT2JqZWN0VXRpbFwiO1xyXG5pbXBvcnQgeyBqb2luUXVlcnlQYXJhbXMsIHRyaW1VUkwsIHZhbGlkYXRlUHJvdG9jb2wgfSBmcm9tIFwiLi9VUkxVdGlsXCI7XHJcbi8qKlxyXG4gKiDlj5HpgIHkuIDkuKrmiJblpJrkuKpIVFRQ6K+35rGCXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJSFRUUFJlcXVlc3RQYXJhbXN9IHBhcmFtcyDor7fmsYLlj4LmlbBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBsb2FkKHBhcmFtcykge1xyXG4gICAgLy8g6Z2e56m65Yik5patXHJcbiAgICBpZiAoIXBhcmFtcy51cmwpIHtcclxuICAgICAgICAvLyDmiJDlip/lm57osINcclxuICAgICAgICBwYXJhbXMub25SZXNwb25zZSAmJiBwYXJhbXMub25SZXNwb25zZSgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vIOaVsOe7hOWIpOaWrVxyXG4gICAgaWYgKHBhcmFtcy51cmwgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIC8vIOS4gOasoeivt+axguWkmuS4quWcsOWdgO+8jOmcgOimgeWBmuS4gOS4qumYn+WIl+WKoOi9ve+8jOeEtuWQjuS4gOasoeaAp+Wbnuiwg1xyXG4gICAgICAgIHZhciB1cmxzID0gcGFyYW1zLnVybDtcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIHZhciBuZXdQYXJhbXMgPSBjbG9uZU9iamVjdChwYXJhbXMpO1xyXG4gICAgICAgIG5ld1BhcmFtcy5vblJlc3BvbnNlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzdWx0KTtcclxuICAgICAgICAgICAgbG9hZE5leHQoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBsb2FkTmV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHVybHMubGVuZ3RoIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOaIkOWKn+Wbnuiwg1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm9uUmVzcG9uc2UgJiYgcGFyYW1zLm9uUmVzcG9uc2UocmVzdWx0cyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbmV3UGFyYW1zLnVybCA9IHVybHMuc2hpZnQoKTtcclxuICAgICAgICAgICAgbG9hZChuZXdQYXJhbXMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgbG9hZE5leHQoKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICAvLyDkuIDmrKHor7fmsYLkuIDkuKrlnLDlnYBcclxuICAgIHZhciByZXRyeVRpbWVzID0gcGFyYW1zLnJldHJ5VGltZXMgfHwgMjtcclxuICAgIHZhciB0aW1lb3V0ID0gcGFyYW1zLnRpbWVvdXQgfHwgMTAwMDA7XHJcbiAgICB2YXIgbWV0aG9kID0gcGFyYW1zLm1ldGhvZCB8fCBcIkdFVFwiO1xyXG4gICAgdmFyIHRpbWVvdXRJZCA9IDA7XHJcbiAgICB2YXIgZGF0YSA9IHBhcmFtcy5kYXRhIHx8IHt9O1xyXG4gICAgLy8g5Y+W5YiwdXJsXHJcbiAgICB2YXIgdXJsID0gcGFyYW1zLnVybDtcclxuICAgIGlmIChwYXJhbXMudXNlQ0ROKSB7XHJcbiAgICAgICAgLy8g5aaC5p6c5L2/55SoQ0RO5YiZ5pS555SoY2Ru5Z+f5ZCNXHJcbiAgICAgICAgdXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyDlkIjms5XljJZwcm90b2NvbFxyXG4gICAgICAgIHVybCA9IHZhbGlkYXRlUHJvdG9jb2wodXJsLCBwYXJhbXMuZm9yY2VIVFRQUyA/IFwiaHR0cHM6XCIgOiBudWxsKTtcclxuICAgICAgICAvLyDop4TmlbTkuIDkuIt1cmxcclxuICAgICAgICB1cmwgPSB0cmltVVJMKHVybCk7XHJcbiAgICB9XHJcbiAgICAvLyDnlJ/miJB4aHJcclxuICAgIHZhciB4aHIgPSAod2luZG93W1wiWERvbWFpblJlcXVlc3RcIl0gJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRSAxMC5cIikgPCAwID8gbmV3IHdpbmRvd1tcIlhEb21haW5SZXF1ZXN0XCJdKCkgOiB3aW5kb3dbXCJYTUxIdHRwUmVxdWVzdFwiXSA/IG5ldyBYTUxIdHRwUmVxdWVzdCgpIDogbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKSk7XHJcbiAgICAvLyDlj5HpgIFcclxuICAgIHNlbmQoKTtcclxuICAgIGZ1bmN0aW9uIHNlbmQoKSB7XHJcbiAgICAgICAgdmFyIHNlbmREYXRhID0gbnVsbDtcclxuICAgICAgICAvLyDmoLnmja7lj5HpgIHmlrnlvI/nu4Tnu4fmlbDmja7moLzlvI9cclxuICAgICAgICBzd2l0Y2ggKG1ldGhvZCkge1xyXG4gICAgICAgICAgICBjYXNlIFwiUE9TVFwiOlxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChwYXJhbXMuaGVhZGVyRGljdCAmJiBwYXJhbXMuaGVhZGVyRGljdFtcIkNvbnRlbnQtVHlwZVwiXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5L2/55Sod2ViZm9ybeagvOW8j++8iOWNs3F1ZXJ557uT5p6E77yJ5a2X56ym5LiyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREYXRhID0gdG9Gb3JtUGFyYW1zKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwibXVsdGlwYXJ0L2Zvcm0tZGF0YVwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDkvb/nlKhGb3JtRGF0YeWvueaVsOaNrui/m+ihjOWMheijhVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXlfMSBpbiBkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZW5kRGF0YS5hcHBlbmQoa2V5XzEsIGRhdGFba2V5XzFdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlhbbku5bpg73kvb/nlKhqc29u5YyF6KOF5Li65a2X56ym5LiyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgXCJHRVRcIjpcclxuICAgICAgICAgICAgICAgIC8vIOWwhuaVsOaNrua3u+WKoOWIsHVybOS4ilxyXG4gICAgICAgICAgICAgICAgdXJsID0gam9pblF1ZXJ5UGFyYW1zKHVybCwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIuaaguS4jeaUr+aMgeeahEhUVFAgTWV0aG9k77yaXCIgKyBtZXRob2QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDmiZPlvIBYSFJcclxuICAgICAgICB4aHIub3BlbihtZXRob2QsIHVybCwgdHJ1ZSk7XHJcbiAgICAgICAgLy8g5Yid5aeL5YyW77yMcmVzcG9uc2VUeXBl5b+F6aG75Zyob3BlbuS5i+WQjuiuvue9ru+8jOWQpuWImUlFMTDlkoxJRTEx5Lya5oql6ZSZXHJcbiAgICAgICAgaWYgKHBhcmFtcy5yZXNwb25zZVR5cGUpXHJcbiAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSBwYXJhbXMucmVzcG9uc2VUeXBlO1xyXG4gICAgICAgIC8vIOWmguaenOmcgOimgXdpdGhDcmVkZW50aWFsc++8jOWImeiuvue9ruS5i1xyXG4gICAgICAgIGlmIChwYXJhbXMud2l0aENyZWRlbnRpYWxzKVxyXG4gICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcclxuICAgICAgICB4aHIub25sb2FkID0gb25Mb2FkO1xyXG4gICAgICAgIHhoci5vbmVycm9yID0gb25FcnJvcjtcclxuICAgICAgICAvLyDmt7vliqDoh6rlrprkuYnor7fmsYLlpLTvvIzlpoLmnpzlj6/ku6XnmoTor51cclxuICAgICAgICBpZiAoeGhyLnNldFJlcXVlc3RIZWFkZXIpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBhcmFtcy5oZWFkZXJEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIHBhcmFtcy5oZWFkZXJEaWN0W2tleV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOW8gOWni+WPkemAgVxyXG4gICAgICAgIHhoci5zZW5kKHNlbmREYXRhKTtcclxuICAgICAgICAvLyDlvIDlp4vorqHml7ZcclxuICAgICAgICB0aW1lb3V0SWQgPSB3aW5kb3cuc2V0VGltZW91dChvbkVycm9yLCB0aW1lb3V0KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIG9uTG9hZChldnQpIHtcclxuICAgICAgICAvLyDljbPkvb/mmK9vbkxvYWTkuZ/opoHliKTmlq3kuIvnirbmgIHnoIHvvIzkvYblpoLmnpzmsqHmnInnirbmgIHnoIHvvIzmr5TlpoLor7RYRG9tYWluUmVxdWVzdOWwseebtOaOpeiupOS4uuaIkOWKn+S6hlxyXG4gICAgICAgIHZhciBzdGF0dXNIZWFkID0geGhyLnN0YXR1cyA/IE1hdGguZmxvb3IoeGhyLnN0YXR1cyAqIDAuMDEpIDogMjtcclxuICAgICAgICBzd2l0Y2ggKHN0YXR1c0hlYWQpIHtcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAvLyAyeHjlkowzeHjnmoTnirbmgIHnoIHorqTkuLrmmK/miJDlip9cclxuICAgICAgICAgICAgICAgIHRpbWVvdXRJZCAmJiBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuICAgICAgICAgICAgICAgIHRpbWVvdXRJZCA9IDA7XHJcbiAgICAgICAgICAgICAgICAvLyDmiJDlip/lm57osINcclxuICAgICAgICAgICAgICAgIHBhcmFtcy5vblJlc3BvbnNlICYmIHBhcmFtcy5vblJlc3BvbnNlKHhoci5yZXNwb25zZSB8fCB4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIDQ6XHJcbiAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgIC8vIDR4eOWSjDV4eOeahOeKtuaAgeeggeiupOS4uuaYr+mUmeivr++8jOi9rOiwg+mUmeivr+Wbnuiwg1xyXG4gICAgICAgICAgICAgICAgb25FcnJvcigpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gb25FcnJvcigpIHtcclxuICAgICAgICAvLyDlgZzmraLorqHml7ZcclxuICAgICAgICB0aW1lb3V0SWQgJiYgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XHJcbiAgICAgICAgdGltZW91dElkID0gMDtcclxuICAgICAgICAvLyDlpLHotKXph43or5VcclxuICAgICAgICBpZiAocmV0cnlUaW1lcyA+IDApIHtcclxuICAgICAgICAgICAgLy8g5rKh5pyJ6LaF6L+H6YeN6K+V5LiK6ZmQ5YiZ6YeN6K+VXHJcbiAgICAgICAgICAgIGFib3J0QW5kUmV0cnkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOWHuumUme+8jOWmguaenOS9v+eUqENETuWKn+iDveWImeWwneivleWIh+aNolxyXG4gICAgICAgICAgICBpZiAocGFyYW1zLnVzZUNETiAmJiAhZW52aXJvbm1lbnQubmV4dENETigpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDov5jmsqHliIfmjaLlrozvvIzph43mlrDliqDovb1cclxuICAgICAgICAgICAgICAgIGxvYWQocGFyYW1zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOWIh+aNouWujOS6hui/mOWksei0pe+8jOWImeaxh+aKpemUmeivr1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm9uRXJyb3IgJiYgcGFyYW1zLm9uRXJyb3IobmV3IFhIUkVycm9yKHhocikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gYWJvcnRBbmRSZXRyeSgpIHtcclxuICAgICAgICAvLyDph43or5XmrKHmlbDpgJLlh49cclxuICAgICAgICByZXRyeVRpbWVzLS07XHJcbiAgICAgICAgLy8g5Lit5q2ieGhyXHJcbiAgICAgICAgeGhyLmFib3J0KCk7XHJcbiAgICAgICAgLy8g5re75Yqg5pe26Ze05oiz5L2c5Li66ZqP5py654mI5pys5Y+3XHJcbiAgICAgICAgdXJsID0gam9pblF1ZXJ5UGFyYW1zKHVybCwgeyBfcjogRGF0ZS5ub3coKSB9KTtcclxuICAgICAgICAvLyDph43mlrDlj5HpgIFcclxuICAgICAgICBzZW5kKCk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIOW8guatpeWKoOi9ve+8jOeUqOS6juW8guatpee8lueoi++8jOWPguaVsOS4reeahG9uUmVzcG9uc2XlkoxvbkVycm9y5bCG5Lya5aSx5pWIXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJSFRUUFJlcXVlc3RQYXJhbXN9IHBhcmFtcyDor7fmsYLlj4LmlbBcclxuICogQHJldHVybnMgeyhQcm9taXNlPGFueXxhbnlbXT4pfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGFzeW5jTG9hZChwYXJhbXMpIHtcclxuICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtcy5vblJlc3BvbnNlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXMub25FcnJvciA9IHJlamVjdDtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkKHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9KV07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufVxyXG4vKipcclxuICog5bCG5pWw5o2u6L2s5o2i5Li6Zm9ybeW9ouW8j1xyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7Kn0gZGF0YSDopoHovazmjaLnmoTmlbDmja5cclxuICogQHJldHVybnMge3N0cmluZ30g6L2s5o2i57uT5p6c5a2X56ym5LiyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9Gb3JtUGFyYW1zKGRhdGEpIHtcclxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGF0YSk7XHJcbiAgICB2YXIgcGFyYW1zID0ga2V5cy5tYXAoZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGRhdGFba2V5XSk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBwYXJhbXMuam9pbihcIiZcIik7XHJcbn1cclxudmFyIFhIUkVycm9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoWEhSRXJyb3IsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBYSFJFcnJvcih4aHIpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB4aHIuc3RhdHVzID8geGhyLnN0YXR1cyArIFwiIFwiICsgeGhyLnN0YXR1c1RleHQgOiBcIuivt+axgumUmeivr++8jOS4lOaXoOazleiOt+WPlumUmeivr+S/oeaBr1wiKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLl94aHIgPSB4aHI7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhIUkVycm9yLnByb3RvdHlwZSwgXCJ4aHJcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlumUmeivr+WvueW6lOeahFhNTEh0dHBSZXF1ZXN05a+56LGhXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7WE1MSHR0cFJlcXVlc3R9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFhIUkVycm9yXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl94aHI7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gWEhSRXJyb3I7XHJcbn0oRXJyb3IpKTtcclxuZXhwb3J0IHsgWEhSRXJyb3IgfTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvSFRUUFV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDM1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgRGljdGlvbmFyeSBmcm9tIFwiLi4vLi4vdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgeyByZXBsYWNlRGlzcGxheSB9IGZyb20gXCIuLi8uLi91dGlscy9EaXNwbGF5VXRpbFwiO1xyXG5pbXBvcnQgeyBleHRlbmRPYmplY3QsIGdldE9iamVjdEhhc2hzIH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IHsgaXNNZWRpYXRvciB9IGZyb20gJy4uL21lZGlhdG9yL01lZGlhdG9yJztcclxuaW1wb3J0IHsgbmV0TWFuYWdlciB9IGZyb20gXCIuLi9uZXQvTmV0TWFuYWdlclwiO1xyXG5pbXBvcnQgQmluZCBmcm9tIFwiLi9CaW5kXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVJ1bkZ1bmMsIGV2YWxFeHAgfSBmcm9tIFwiLi9VdGlsc1wiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTEtMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTEtMDZcclxuICpcclxuICog57uR5a6a566h55CG5Zmo77yM5Y+v5Lul5bCG5pWw5o2u5ZKM5pi+56S65a+56LGh57uR5a6a5Yiw5LiA6LW377yMTVZWTeS5puWGmeeVjOmdolxyXG4qL1xyXG52YXIgQmluZE1hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCaW5kTWFuYWdlcigpIHtcclxuICAgICAgICB0aGlzLl9iaW5kRGljdCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICAgICAgdGhpcy5fcmVnRXhwID0gL15cXHMqKFxcdyspXFxzKygoaW4pfChvZikpXFxzKyguKz8pXFxzKiQvO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5ZtZWRpYXRvcuWvueW6lOeahEJpbmREYXRhXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yXHJcbiAgICAgKiBAcmV0dXJucyB7QmluZERhdGF9XHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmdldEJpbmREYXRhID0gZnVuY3Rpb24gKG1lZGlhdG9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JpbmREaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5HlrprmlbDmja7liLBVSeS4ilxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEByZXR1cm5zIHtCaW5kfSDov5Tlm57nu5Hlrprlrp7kvotcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIHZhciBiaW5kRGF0YSA9IHRoaXMuX2JpbmREaWN0LmdldChtZWRpYXRvcik7XHJcbiAgICAgICAgaWYgKCFiaW5kRGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLl9iaW5kRGljdC5zZXQobWVkaWF0b3IsIGJpbmREYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgYmluZDogbmV3IEJpbmQobWVkaWF0b3IpLFxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzOiBbXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g6YeN5paw57uR5a6a5omA5pyJXHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IGJpbmREYXRhLmNhbGxiYWNrczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gX2FbX2ldO1xyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDov5Tlm55CaW5k5a+56LGhXHJcbiAgICAgICAgcmV0dXJuIGJpbmREYXRhLmJpbmQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnp7vpmaTnu5HlrppcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3JcclxuICAgICAqIEByZXR1cm5zIHtCaW5kfVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIGlmIChiaW5kRGF0YSkge1xyXG4gICAgICAgICAgICBiaW5kRGF0YS5iaW5kLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgdGhpcy5fYmluZERpY3QuZGVsZXRlKG1lZGlhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGJpbmREYXRhICYmIGJpbmREYXRhLmJpbmQ7XHJcbiAgICB9O1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmFkZEJpbmRIYW5kbGVyID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDliKTmlq3mlbDmja7mmK/lkKblkIjms5VcclxuICAgICAgICAgICAgaWYgKCFtZWRpYXRvci52aWV3TW9kZWwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+e7keWumlxyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g5re75Yqg57uR5a6a5pWw5o2uXHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICBpZiAoYmluZERhdGEuY2FsbGJhY2tzLmluZGV4T2YoaGFuZGxlcikgPCAwKVxyXG4gICAgICAgICAgICBiaW5kRGF0YS5jYWxsYmFja3MucHVzaChoYW5kbGVyKTtcclxuICAgICAgICAvLyDnq4vljbPosIPnlKjkuIDmrKFcclxuICAgICAgICBoYW5kbGVyKCk7XHJcbiAgICB9O1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmdldE5lYXJlc3RBbmNlc3RvciA9IGZ1bmN0aW9uIChicmlkZ2UsIHRhcmdldCwgcHJvcE5hbWUpIHtcclxuICAgICAgICBpZiAoIXRhcmdldCB8fCB0YXJnZXRbcHJvcE5hbWVdKVxyXG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0O1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmVhcmVzdEFuY2VzdG9yKGJyaWRnZSwgYnJpZGdlLmdldFBhcmVudCh0YXJnZXQpLCBwcm9wTmFtZSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5HlrprlsZ7mgKflgLxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumueahOWxnuaAp+WQjVxyXG4gICAgICogQHBhcmFtIHsoRXZhbEV4cCl9IGV4cCDnu5HlrprnmoTooajovr7lvI/miJbmlrnms5VcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZFZhbHVlID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgbmFtZSwgZXhwKSB7XHJcbiAgICAgICAgdmFyIHdhdGNoZXI7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB0aGlzLmFkZEJpbmRIYW5kbGVyKG1lZGlhdG9yLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5LmL5YmN57uR5a6a6L+H77yM5YiZ6KaB5YWI6ZSA5q+B5LmLXHJcbiAgICAgICAgICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgICAgICAgICAgd2F0Y2hlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIC8vIOe7keWumuaWsOeahOiuoumYheiAhVxyXG4gICAgICAgICAgICB3YXRjaGVyID0gKF9hID0gYmluZERhdGEuYmluZCkuY3JlYXRlV2F0Y2hlci5hcHBseShfYSwgW2N1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0W25hbWVdID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9LCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChlbnZNb2RlbHMsIFttZWRpYXRvci52aWV3TW9kZWxdKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5HlrprkuIDkuKrooajovr7lvI/vvIzkuI5iaW5kVmFsdWXnsbvkvLzvvIzkvYbkuI3kvJrnu5nlsZ7mgKfotYvlgLxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7KEV2YWxFeHApfSBleHAg57uR5a6a55qE6KGo6L6+5byP5oiW5pa55rOVXHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmJpbmRFeHAgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBleHApIHtcclxuICAgICAgICB2YXIgd2F0Y2hlcjtcclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIHRoaXMuYWRkQmluZEhhbmRsZXIobWVkaWF0b3IsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuYvliY3nu5Hlrprov4fvvIzliJnopoHlhYjplIDmr4HkuYtcclxuICAgICAgICAgICAgaWYgKHdhdGNoZXIpXHJcbiAgICAgICAgICAgICAgICB3YXRjaGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgLy8g57uR5a6a5paw55qE6K6i6ZiF6ICFXHJcbiAgICAgICAgICAgIHdhdGNoZXIgPSAoX2EgPSBiaW5kRGF0YS5iaW5kKS5jcmVhdGVXYXRjaGVyLmFwcGx5KF9hLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBleHAsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOS4jeW5suS7u+S9leS6i+aDhVxyXG4gICAgICAgICAgICAgICAgfSwgbWVkaWF0b3Iudmlld01vZGVsXS5jb25jYXQoZW52TW9kZWxzLCBbbWVkaWF0b3Iudmlld01vZGVsXSkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6a5pa55rOV5omn6KGMXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJTWVkaWF0b3J9IG1lZGlhdG9yIOS4reS7i+iAhVxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOe7keWumuWIsOeahHRhcmdldOWunuS9k+WvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBlbnZNb2RlbHMg546v5aKD5Y+Y6YeP5pWw57uEXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSDnu5HlrprnmoTmlrnms5XlkI1cclxuICAgICAqIEBwYXJhbSB7Li4uKEV2YWxFeHApW119IGFyZ0V4cHMg5omn6KGM5pa55rOV55qE5Y+C5pWw6KGo6L6+5byP5oiW5pa55rOV5YiX6KGoXHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmJpbmRGdW5jID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgbmFtZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGFyZ0V4cHMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDU7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBhcmdFeHBzW19pIC0gNV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgd2F0Y2hlcnMgPSBbXTtcclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIHRoaXMuYWRkQmluZEhhbmRsZXIobWVkaWF0b3IsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICAvLyDliKTmlq3lj4LmlbDmlbDph4/vvIzml6Dlj4LmlbDmlrnms5XkuIDmrKHmgKfmiafooYzljbPlj6/vvIzml6DpnIDnu5HlrprvvIzmnInlj4LmlbDnmoTmlrnms5XliJnpnIDopoHmr4/mrKHlj4LmlbDmlLnlj5jlsLHmiafooYzkuIDmrKFcclxuICAgICAgICAgICAgaWYgKGFyZ0V4cHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g5bCG6KGo6L6+5byP5Lit5omA5pyJdW5kZWZpbmVk5ZKMbnVsbOWPmOS4uuWGhemDqOWAvFxyXG4gICAgICAgICAgICAgICAgdmFyIHVuZGVmaW5lZFZhbHVlID0gRGF0ZS5ub3coKSAqIE1hdGgucmFuZG9tKCkgKyBcIl91bmRlZmluZWRcIjtcclxuICAgICAgICAgICAgICAgIHZhciBudWxsVmFsdWUgPSBEYXRlLm5vdygpICogTWF0aC5yYW5kb20oKSArIFwiX251bGxcIjtcclxuICAgICAgICAgICAgICAgIGFyZ0V4cHMgPSBhcmdFeHBzLm1hcChmdW5jdGlvbiAoZXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4cCA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyB1bmRlZmluZWRWYWx1ZSArIFwiJ1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV4cCA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiJ1wiICsgbnVsbFZhbHVlICsgXCInXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhwO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAvLyDnu5Hlrprooajovr7lvI/lj4LmlbDmlbDnu4RcclxuICAgICAgICAgICAgICAgIHZhciBpbml0VmFsdWUgPSB7fTtcclxuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJnc0luaXRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bCGdmFsdWXkuK3nmoR1bmRlZmluZWTlkoxudWxs5oGi5aSN5Zue5Y67XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWRWYWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT0gbnVsbFZhbHVlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5Y+C5pWw5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgYXJnc1tpbmRleF0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDliKTmlq3lj4LmlbDmmK/lkKbpvZDlhahcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWFyZ3NJbml0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhcmdzXzEgPSBhcmdzOyBfaSA8IGFyZ3NfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmcgPSBhcmdzXzFbX2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5YiX6KGo6YeM5a2Y5Zyo5Yid5aeL5YC877yM6KGo56S65rKh5pyJ6LWL5YC85a6M5q+V77yM55u05o6l6L+U5ZueXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJnID09PSBpbml0VmFsdWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiuvue9ruWIneWni+WMluWujOavleeKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzSW5pdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LWL5YC85bey57uP5a6M5q+V5LqG77yM6LCD55So5pa55rOV77yMdGhpc+aMh+WQkXVp5pys6LqrXHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRhcmdldFtuYW1lXS5hcHBseShjdXJyZW50VGFyZ2V0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDmuIXnkIbml6fnmoTorqLpmIXogIVcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB3YXRjaGVycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHdhdGNoZXJzLnNoaWZ0KCkuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g5b6q546v57uR5a6a6KGo6L6+5byP5YiwaGFuZGxlclxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFyZ0V4cHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXkuIDkuKrliJ3lp4vlgLzvvIznlKjkuo7liKTmlq3lj4LmlbDliJfooajmmK/lkKblt7LotYvlgLzlrozmr5VcclxuICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goaW5pdFZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcmdFeHBzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g57uR5a6a6KGo6L6+5byPXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdhdGNoZXIgPSAoX2EgPSBiaW5kRGF0YS5iaW5kKS5jcmVhdGVXYXRjaGVyLmFwcGx5KF9hLCBbY3VycmVudFRhcmdldCwgdGFyZ2V0LCBhcmdFeHBzW2ldLCBoYW5kbGVyLmJpbmQoX3RoaXMsIGkpLCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChlbnZNb2RlbHMsIFttZWRpYXRvci52aWV3TW9kZWxdKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6w5b2V6K6i6ZiF6ICFXHJcbiAgICAgICAgICAgICAgICAgICAgd2F0Y2hlcnMucHVzaCh3YXRjaGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIOaXoOWPguaVsOaJp+ihjO+8jOaXoOmcgOe7keWumu+8jOS4gOasoeaAp+aJp+ihjOWNs+WPr1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0W25hbWVdKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumuS6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICAgICAqIEBwYXJhbSB7Kn0gY3VycmVudFRhcmdldCDnu5HlrprliLDnmoR0YXJnZXTlrp7kvZPlr7nosaFcclxuICAgICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IOe7keWumuWRveS7pOacrOadpeaJgOWcqOeahOWvueixoVxyXG4gICAgICogQHBhcmFtIHthbnlbXX0gZW52TW9kZWxzIOeOr+Wig+WPmOmHj+aVsOe7hFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg57uR5a6a55qE5LqL5Lu257G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0V2YWxFeHB9IGV4cCDnu5HlrprnmoTkuovku7blm57osIPooajovr7lvI/miJbmlrnms5VcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZE9uID0gZnVuY3Rpb24gKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgZXhwKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLmFkZEJpbmRIYW5kbGVyKG1lZGlhdG9yLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICR0aGlzOiBtZWRpYXRvcixcclxuICAgICAgICAgICAgICAgICRkYXRhOiBtZWRpYXRvci52aWV3TW9kZWwsXHJcbiAgICAgICAgICAgICAgICAkYnJpZGdlOiBtZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICAgICAkY3VycmVudFRhcmdldDogY3VycmVudFRhcmdldCxcclxuICAgICAgICAgICAgICAgICR0YXJnZXQ6IHRhcmdldFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDorqHnrpfkuovku7ZoYXNoXHJcbiAgICAgICAgICAgIHZhciBvbkhhc2ggPSBnZXRPYmplY3RIYXNocyhjdXJyZW50VGFyZ2V0LCB0eXBlLCBleHApO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkuYvliY3mt7vliqDov4fnm5HlkKzvvIzliJnlhYjnp7vpmaTkuYtcclxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBjdXJyZW50VGFyZ2V0W29uSGFzaF07XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyKSB7XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvci51bm1hcExpc3RlbmVyKGN1cnJlbnRUYXJnZXQsIHR5cGUsIGhhbmRsZXIsIG1lZGlhdG9yLnZpZXdNb2RlbCk7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlhYjlsJ3or5XnlKhleHDlvZPlgZrmlrnms5XlkI3ljrt2aWV3TW9kZWzph4zlr7vmib7vvIzlpoLmnpzmib7kuI3liLDliJnmiopleHDlvZPlgZrkuIDkuKrmiafooYzooajovr7lvI/lpITnkIbvvIzlpJbpnaLljIXkuIDlsYLmlrnms5VcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBleHAgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gbWVkaWF0b3Iudmlld01vZGVsW2V4cF07XHJcbiAgICAgICAgICAgIGlmICghKGhhbmRsZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmdW5jID0gY3JlYXRlUnVuRnVuYyhleHAsIDMgKyBlbnZNb2RlbHMubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIC8vIOi/memHjOimgei9rOS4gOaJi++8jOiusOWIsOmXreWMhemHjOS4gOS4quWJr+acrO+8jOWQpuWImeWboOS4umJpbmRPbuaYr+W7tui/n+aTjeS9nO+8jOWIsOaXtmVudk1vZGVs5Y+v6IO95bey6KKr5L+u5pS5XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5jYWxsLmFwcGx5KGZ1bmMsIFt0aGlzLCBjb21tb25TY29wZV0uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbCwgeyAkZXZlbnQ6IGV2ZW50IH1dKSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1lZGlhdG9yLm1hcExpc3RlbmVyKGN1cnJlbnRUYXJnZXQsIHR5cGUsIGhhbmRsZXIsIG1lZGlhdG9yLnZpZXdNb2RlbCk7XHJcbiAgICAgICAgICAgIC8vIOWwhuS6i+S7tuWbnuiwg+iusOW9leWIsOaYvuekuuWvueixoeS4ilxyXG4gICAgICAgICAgICBjdXJyZW50VGFyZ2V0W29uSGFzaF0gPSBoYW5kbGVyO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpxfX2JpbmRfc3ViX2V2ZW50c19f5YiX6KGo5a2Y5Zyo77yM5YiZ5bCG5LqL5Lu26K6w5b2V5Yiw5YW25LiKXHJcbiAgICAgICAgICAgIHZhciBuZWFyZXN0QW5jZXN0b3IgPSBfdGhpcy5nZXROZWFyZXN0QW5jZXN0b3IobWVkaWF0b3IuYnJpZGdlLCB0YXJnZXQsIFwiX19iaW5kX3N1Yl9ldmVudHNfX1wiKTtcclxuICAgICAgICAgICAgdmFyIGV2ZW50cyA9IChuZWFyZXN0QW5jZXN0b3IgfHwgdGFyZ2V0KS5fX2JpbmRfc3ViX2V2ZW50c19fO1xyXG4gICAgICAgICAgICBpZiAoZXZlbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBjdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlcjogaGFuZGxlcixcclxuICAgICAgICAgICAgICAgICAgICB0aGlzQXJnOiBtZWRpYXRvci52aWV3TW9kZWxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5HlrprmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7RXZhbEV4cH0gZXhwIOe7keWumuihqOi+vuW8j+aIluaWueazlVxyXG4gICAgICogQHBhcmFtIHsodmFsdWU6Ym9vbGVhbik9PnZvaWR9IFtjYWxsYmFja10g5Yik5pat5p2h5Lu25pS55Y+Y5pe25Lya6Kem5Y+R6L+Z5Liq5Zue6LCDXHJcbiAgICAgKiBAbWVtYmVyb2YgQmluZE1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQmluZE1hbmFnZXIucHJvdG90eXBlLmJpbmRJZiA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCwgY2FsbGJhY2spIHtcclxuICAgICAgICB2YXIgd2F0Y2hlcjtcclxuICAgICAgICB2YXIgYmluZERhdGEgPSB0aGlzLl9iaW5kRGljdC5nZXQobWVkaWF0b3IpO1xyXG4gICAgICAgIHZhciByZXBsYWNlciA9IG1lZGlhdG9yLmJyaWRnZS5jcmVhdGVFbXB0eURpc3BsYXkoKTtcclxuICAgICAgICB0aGlzLmFkZEJpbmRIYW5kbGVyKG1lZGlhdG9yLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5LmL5YmN57uR5a6a6L+H77yM5YiZ6KaB5YWI6ZSA5q+B5LmLXHJcbiAgICAgICAgICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgICAgICAgICAgd2F0Y2hlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIC8vIOe7keWumuihqOi+vuW8j1xyXG4gICAgICAgICAgICB3YXRjaGVyID0gKF9hID0gYmluZERhdGEuYmluZCkuY3JlYXRlV2F0Y2hlci5hcHBseShfYSwgW2N1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwLCBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzooajovr7lvI/kuLp0cnVl5YiZ5pi+56S6dWnvvIzlkKbliJnnp7vpmaR1aVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZURpc3BsYXkobWVkaWF0b3IuYnJpZGdlLCByZXBsYWNlciwgY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlRGlzcGxheShtZWRpYXRvci5icmlkZ2UsIGN1cnJlbnRUYXJnZXQsIHJlcGxhY2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDop6blj5Hlm57osINcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChlbnZNb2RlbHMsIFttZWRpYXRvci52aWV3TW9kZWxdKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDnu5Hlrprlvqrnjq9cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumuacrOadpeaJgOWcqOeahOWvueixoeWcqE1lZGlhdG9y5Lit55qE5ZCN5a2XXHJcbiAgICAgKiBAcGFyYW0ge0JpbmRGb3JFeHBUeXBlfSBleHAg5b6q546v6KGo6L6+5byP77yM5b2i5aaC77yaXCJhIGluIGJcIu+8iOihqOekumHpgY3ljoZi5Lit55qEa2V577yJ5oiWXCJhIG9mIGJcIu+8iOihqOekumHpgY3ljoZi5Lit55qE5YC877yJ44CCYuWPr+S7peaYr+S4quihqOi+vuW8j+OAguaIluiAheS7peS4ieWFg+e7hOW9ouW8j+aPkOS+m++8jOWmgltcImFcIiwgXCJpblwiLCBcImJcIl3vvIzlhbbkuK1i5Y+v5Lul5piv6KGo6L6+5byP77yM5Lmf5Y+v5Lul5piv5rGC5YC85pa55rOVXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvckNvbnN0cnVjdG9yfSBbbWVkaWF0b3JDbHNdIOaPkOS+m+ivpeWPguaVsOWwhuS9v+eUqOaPkOS+m+eahOS4reS7i+iAheWMheijheavj+S4gOS4qua4suafk+WZqFxyXG4gICAgICogQHBhcmFtIHtJQ29uc3RydWN0b3J9IFtkZWNsYXJlZENsc10g5aOw5piO55qE57G75Z6LXHJcbiAgICAgKiBAcGFyYW0ge0V2YWxFeHB9IFtkYXRhRXhwXSDmj5Dkvpvnu5nkuK3ku4vogIXljIXoo4XlmajnmoTmlbDmja7ooajovr7lvI9cclxuICAgICAqIEBwYXJhbSB7KGRhdGE6YW55LCByZW5kZXJlcjphbnksIGVudk1vZGVsczphbnlbXSk9PnZvaWR9IFtjYWxsYmFja10g5q+P5qyh55Sf5oiQ5paw55qEcmVuZGVyZXLlrp7kvovml7bosIPnlKjov5nkuKrlm57osINcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBCaW5kTWFuYWdlci5wcm90b3R5cGUuYmluZEZvciA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIG5hbWUsIGV4cCwgbWVkaWF0b3JDbHMsIGRlY2xhcmVkQ2xzLCBkYXRhRXhwLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHdhdGNoZXI7XHJcbiAgICAgICAgdmFyIGJpbmREYXRhID0gdGhpcy5fYmluZERpY3QuZ2V0KG1lZGlhdG9yKTtcclxuICAgICAgICB2YXIgc3ViVGFyZ2V0Q2FjaGUgPSBbXTtcclxuICAgICAgICB2YXIgc3ViTWVkaWF0b3JDYWNoZSA9IFtdO1xyXG4gICAgICAgIHRoaXMuYWRkQmluZEhhbmRsZXIobWVkaWF0b3IsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgICAgICB2YXIgZXhwVHVwbGU7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZXhwID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlrZfnrKbkuLLlvaLlvI/vvIzop6PmnpDooajovr7lvI9cclxuICAgICAgICAgICAgICAgIHZhciByZXMgPSBfdGhpcy5fcmVnRXhwLmV4ZWMoZXhwKTtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIGV4cFR1cGxlID0gW3Jlc1sxXSwgcmVzWzJdLCByZXNbNV1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5YWD57uE5b2i5byP77yM55u05o6l6LWL5YC8XHJcbiAgICAgICAgICAgICAgICBleHBUdXBsZSA9IGV4cDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlpoLmnpznu5nlh7rkuoblo7DmmI7nmoRNZWRpYXRvcuexu+Wei++8jOWImeeUn+aIkOS4gOS4quWjsOaYjk1lZGlhdG9y77yM5pu/5o2i5o6JbWVkaWF0b3LlvZPliY3nmoTnmq7ogqRcclxuICAgICAgICAgICAgdmFyIGRlY2xhcmVkTWVkaWF0b3I7XHJcbiAgICAgICAgICAgIGlmIChpc01lZGlhdG9yKGRlY2xhcmVkQ2xzLnByb3RvdHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGRlY2xhcmVkTWVkaWF0b3IgPSBuZXcgZGVjbGFyZWRDbHModGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIG1lZGlhdG9yLmRlbGVnYXRlTWVkaWF0b3IoZGVjbGFyZWRNZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICBtZWRpYXRvcltuYW1lXSA9IGRlY2xhcmVkTWVkaWF0b3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZGVjbGFyZWRDbHMgPT09IEFycmF5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3JDbHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzop4Tlrprkuoblj5jouqvkuK3ku4vogIXvvIzliJnlsIbor6XlsZ7mgKflj5jmiJDkuK3ku4vogIXliJfooahcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvcltuYW1lXSA9IHN1Yk1lZGlhdG9yQ2FjaGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlkKbliJnlj5jmiJDmuLLmn5Plmajlr7nosaHliJfooahcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvcltuYW1lXSA9IHN1YlRhcmdldENhY2hlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOWMheijhea4suafk+WZqOWIm+W7uuWbnuiwg1xyXG4gICAgICAgICAgICB2YXIgbWVtZW50byA9IG1lZGlhdG9yLmJyaWRnZS53cmFwQmluZEZvcihjdXJyZW50VGFyZ2V0LCBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgcmVuZGVyZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiuvue9rueOr+Wig+WPmOmHj1xyXG4gICAgICAgICAgICAgICAgdmFyIHN1YlNjb3BlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICRrZXk6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICAkdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgICRwYXJlbnQ6IGVudk1vZGVsc1swXSB8fCBtZWRpYXRvci52aWV3TW9kZWxcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAvLyDloavlhaXnlKjmiLflo7DmmI7nmoTlsZ7mgKdcclxuICAgICAgICAgICAgICAgIHN1YlNjb3BlW2V4cFR1cGxlWzBdXSA9IChleHBUdXBsZVsxXSA9PSBcImluXCIgPyBrZXkgOiB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAvLyDnlJ/miJDkuIDkuKrnjq/looPlj5jph4/nmoTlia/mnKxcclxuICAgICAgICAgICAgICAgIHZhciBzdWJFbnZNb2RlbHMgPSBlbnZNb2RlbHMuY29uY2F0KCk7XHJcbiAgICAgICAgICAgICAgICAvLyDmj5LlhaXnjq/looPlj5jph49cclxuICAgICAgICAgICAgICAgIHN1YkVudk1vZGVscy51bnNoaWZ0KHN1YlNjb3BlKTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenHJlbmRlcmVy5bey57uP5pyJ5LqL5Lu25YiX6KGo5LqG77yM6K+05piOcmVuZGVyZXLmmK/ooqvph43nlKjnmoTvvIzliKDpmaTmiYDmnInkuovku7ZcclxuICAgICAgICAgICAgICAgIHZhciBldmVudHMgPSByZW5kZXJlci5fX2JpbmRfc3ViX2V2ZW50c19fO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBldmVudHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGV2ZW50cy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYXRvci51bm1hcExpc3RlbmVyKGRhdGEudGFyZ2V0LCBkYXRhLnR5cGUsIGRhdGEuaGFuZGxlciwgZGF0YS50aGlzQXJnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOS4unJlbmRlcmVy6K6+572u5a2Q5a+56LGh5LqL5Lu25YiX6KGoXHJcbiAgICAgICAgICAgICAgICBpZiAoIWV2ZW50cylcclxuICAgICAgICAgICAgICAgICAgICByZW5kZXJlci5fX2JpbmRfc3ViX2V2ZW50c19fID0gW107XHJcbiAgICAgICAgICAgICAgICAvLyDkuLpyZW5kZXJlcuWll+S4gOS4qk1lZGlhdG9y5aSW5aOzXHJcbiAgICAgICAgICAgICAgICBpZiAobWVkaWF0b3JDbHMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViTWVkaWF0b3IgPSBuZXcgbWVkaWF0b3JDbHMocmVuZGVyZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOabtOaWsOa4suafk+WZqFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJNZWRpYXRvci5za2luICYmIHN1Yk1lZGlhdG9yLmJyaWRnZSA9PT0gbWVkaWF0b3IuYnJpZGdlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlciA9IHN1Yk1lZGlhdG9yLnNraW47XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5omY566h5a2Q5Lit5LuL6ICF77yM5LyY5YWI5omY566h5Zyo5aOw5piO5Ye65p2l55qE5Lit6Ze05Lit5LuL6ICF5LiKXHJcbiAgICAgICAgICAgICAgICAgICAgKGRlY2xhcmVkTWVkaWF0b3IgfHwgbWVkaWF0b3IpLmRlbGVnYXRlTWVkaWF0b3Ioc3ViTWVkaWF0b3IpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rumAmueUqOWxnuaAp1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXM6IG1lZGlhdG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkZGF0YTogbWVkaWF0b3Iudmlld01vZGVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkYnJpZGdlOiBtZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjdXJyZW50VGFyZ2V0OiBjdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0OiB0YXJnZXRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOW8gOWQr+ivpeS4reS7i+iAhe+8jOS8mOWFiOS9v+eUqGRhdGFFeHDvvIzlpoLmnpzmsqHmnInliJnkvb/nlKjlvZPliY3miYDmnInnmoTmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YV8xO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhRXhwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOacieaVsOaNruihqOi+vuW8j++8jOaxguWHuuaVsOaNruihqOi+vuW8j+eahOWAvOadpVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhXzEgPSBldmFsRXhwLmFwcGx5KHZvaWQgMCwgW2RhdGFFeHAsIG1lZGlhdG9yLnZpZXdNb2RlbF0uY29uY2F0KHN1YkVudk1vZGVscy5jb25jYXQoKS5yZXZlcnNlKCksIFttZWRpYXRvci52aWV3TW9kZWwsIGNvbW1vblNjb3BlXSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rKh5pyJ5pWw5o2u6KGo6L6+5byP77yM5aWX55So5b2T5YmN5omA5Zyo5Y+Y6YeP5Z+f77yM5LiU6KaB5omT5bmz5YGa5oiQ5LiA5LiqZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhXzEgPSBleHRlbmRPYmplY3QuYXBwbHkodm9pZCAwLCBbe30sIGNvbW1vblNjb3BlLCBtZWRpYXRvci52aWV3TW9kZWxdLmNvbmNhdChzdWJFbnZNb2RlbHMpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgc3ViTWVkaWF0b3Iub3BlbihkYXRhXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOe8k+WtmOWtkOS4reS7i+iAhVxyXG4gICAgICAgICAgICAgICAgICAgIHN1Yk1lZGlhdG9yQ2FjaGUucHVzaChzdWJNZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDnvJPlrZjmuLLmn5Plmajlr7nosaFcclxuICAgICAgICAgICAgICAgICAgICBzdWJUYXJnZXRDYWNoZS5wdXNoKHJlbmRlcmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOinpuWPkeWbnuiwg++8jOi/m+ihjOWGhemDqOe8luivkVxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2sodmFsdWUsIHJlbmRlcmVyLCBzdWJFbnZNb2RlbHMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5LmL5YmN57uR5a6a6L+H77yM5YiZ6KaB5YWI6ZSA5q+B5LmLXHJcbiAgICAgICAgICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgICAgICAgICAgd2F0Y2hlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIC8vIOiOt+W+l+imgemBjeWOhueahOaVsOaNrumbhuWQiFxyXG4gICAgICAgICAgICB3YXRjaGVyID0gKF9hID0gYmluZERhdGEuYmluZCkuY3JlYXRlV2F0Y2hlci5hcHBseShfYSwgW2N1cnJlbnRUYXJnZXQsIHRhcmdldCwgZXhwVHVwbGVbMl0sIGZ1bmN0aW9uIChkYXRhcykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOmBjeWOhueahOWvueixoeaYr+S4quaVsOWtl++8jOWImeS8qumAoOS4gOS4quS4tOaXtuaVsOe7hOS+m+S9v+eUqFxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YXMgPT09IFwibnVtYmVyXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBBcnIgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhczsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyLnB1c2goaSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YXMgPSB0ZW1wQXJyO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyDmuIXnqbrlt7LmnInnmoTlrZDkuK3ku4vogIVcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc3ViTWVkaWF0b3JDYWNoZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViTWVkaWF0b3IgPSBzdWJNZWRpYXRvckNhY2hlLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhdG9yLnVuZGVsZWdhdGVNZWRpYXRvcihzdWJNZWRpYXRvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Yk1lZGlhdG9yLmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6LWL5YC8XHJcbiAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3IuYnJpZGdlLnZhbHVhdGVCaW5kRm9yKGN1cnJlbnRUYXJnZXQsIGRhdGFzLCBtZW1lbnRvKTtcclxuICAgICAgICAgICAgICAgIH0sIG1lZGlhdG9yLnZpZXdNb2RlbF0uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbF0pKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOe7keWumk1lc3NhZ2VcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7SUNvbnN0cnVjdG9yfHN0cmluZ30gdHlwZSDnu5HlrprnmoTmtojmga/nsbvlnovlrZfnrKbkuLJcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumueahOWxnuaAp+WQjVxyXG4gICAgICogQHBhcmFtIHtFdmFsRXhwfSBleHAg57uR5a6a55qE6KGo6L6+5byP5oiW5pa55rOVXHJcbiAgICAgKiBAcGFyYW0ge0lPYnNlcnZhYmxlfSBbb2JzZXJ2YWJsZV0g57uR5a6a55qE5raI5oGv5YaF5qC477yM6buY6K6k5pivY29yZVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIHR5cGUsIG5hbWUsIGV4cCwgb2JzZXJ2YWJsZSkge1xyXG4gICAgICAgIGlmICghb2JzZXJ2YWJsZSlcclxuICAgICAgICAgICAgb2JzZXJ2YWJsZSA9IGNvcmUub2JzZXJ2YWJsZTtcclxuICAgICAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobWVkaWF0b3IuZGlzcG9zZWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIG1lZGlhdG9y5bey6ZSA5q+B77yM5Y+W5raI55uR5ZCsXHJcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLnVubGlzdGVuKHR5cGUsIGhhbmRsZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1zZztcclxuICAgICAgICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxICYmIHR5cGVvZiBhcmdzWzBdID09IFwib2JqZWN0XCIgJiYgYXJnc1swXS50eXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIG1zZyA9IGFyZ3NbMF07XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgbXNnID0geyAkYXJndW1lbnRzOiBhcmdzIH07XHJcbiAgICAgICAgICAgICAgICAvLyDorr7nva7pgJrnlKjlsZ7mgKdcclxuICAgICAgICAgICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpczogbWVkaWF0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgJGRhdGE6IG1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgICAgICAgICAkYnJpZGdlOiBtZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgJGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsXHJcbiAgICAgICAgICAgICAgICAgICAgJHRhcmdldDogdGFyZ2V0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldFtuYW1lXSA9IGV2YWxFeHAuYXBwbHkodm9pZCAwLCBbZXhwLCBtZWRpYXRvci52aWV3TW9kZWwsIG1zZ10uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbCwgY29tbW9uU2NvcGVdKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOa3u+WKoOebkeWQrFxyXG4gICAgICAgIG9ic2VydmFibGUubGlzdGVuKHR5cGUsIGhhbmRsZXIpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog57uR5a6aUmVzcG9uc2VcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5Lit5LuL6ICFXHJcbiAgICAgKiBAcGFyYW0geyp9IGN1cnJlbnRUYXJnZXQg57uR5a6a5Yiw55qEdGFyZ2V05a6e5L2T5a+56LGhXHJcbiAgICAgKiBAcGFyYW0geyp9IHRhcmdldCDnu5Hlrprlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICAgICAqIEBwYXJhbSB7YW55W119IGVudk1vZGVscyDnjq/looPlj5jph4/mlbDnu4RcclxuICAgICAqIEBwYXJhbSB7SVJlc3BvbnNlRGF0YUNvbnN0cnVjdG9yfHN0cmluZ30gdHlwZSDnu5HlrprnmoTpgJrorq/mtojmga/nsbvlnotcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOe7keWumueahOWxnuaAp+WQjVxyXG4gICAgICogQHBhcmFtIHtFdmFsRXhwfSBleHAg57uR5a6a55qE6KGo6L6+5byP5oiW5pa55rOVXHJcbiAgICAgKiBAcGFyYW0ge0lPYnNlcnZhYmxlfSBbb2JzZXJ2YWJsZV0g57uR5a6a55qE5raI5oGv5YaF5qC477yM6buY6K6k5pivY29yZVxyXG4gICAgICogQG1lbWJlcm9mIEJpbmRNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEJpbmRNYW5hZ2VyLnByb3RvdHlwZS5iaW5kUmVzcG9uc2UgPSBmdW5jdGlvbiAobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCB0eXBlLCBuYW1lLCBleHAsIG9ic2VydmFibGUpIHtcclxuICAgICAgICBpZiAoIW9ic2VydmFibGUpXHJcbiAgICAgICAgICAgIG9ic2VydmFibGUgPSBjb3JlLm9ic2VydmFibGU7XHJcbiAgICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgaWYgKG1lZGlhdG9yLmRpc3Bvc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBtZWRpYXRvcuW3sumUgOavge+8jOWPlua2iOebkeWQrFxyXG4gICAgICAgICAgICAgICAgbmV0TWFuYWdlci51bmxpc3RlblJlc3BvbnNlKHR5cGUsIGhhbmRsZXIsIG51bGwsIG51bGwsIG9ic2VydmFibGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g6K6+572u6YCa55So5bGe5oCnXHJcbiAgICAgICAgICAgICAgICB2YXIgY29tbW9uU2NvcGUgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRoaXM6IG1lZGlhdG9yLFxyXG4gICAgICAgICAgICAgICAgICAgICRkYXRhOiBtZWRpYXRvci52aWV3TW9kZWwsXHJcbiAgICAgICAgICAgICAgICAgICAgJGJyaWRnZTogbWVkaWF0b3IuYnJpZGdlLFxyXG4gICAgICAgICAgICAgICAgICAgICRjdXJyZW50VGFyZ2V0OiBjdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAgICAgICAgICR0YXJnZXQ6IHRhcmdldFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRUYXJnZXRbbmFtZV0gPSBldmFsRXhwLmFwcGx5KHZvaWQgMCwgW2V4cCwgbWVkaWF0b3Iudmlld01vZGVsLCByZXNwb25zZV0uY29uY2F0KGVudk1vZGVscywgW21lZGlhdG9yLnZpZXdNb2RlbCwgY29tbW9uU2NvcGVdKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOa3u+WKoOebkeWQrFxyXG4gICAgICAgIG5ldE1hbmFnZXIubGlzdGVuUmVzcG9uc2UodHlwZSwgaGFuZGxlciwgbnVsbCwgbnVsbCwgb2JzZXJ2YWJsZSk7XHJcbiAgICAgICAgLy8g5aaC5p6cbWVkaWF0b3LmiYDkvp3otZbnmoTmqKHlnZfmnInliJ3lp4vljJbmtojmga/vvIzliJnopoHpop3lpJbop6blj5HliJ3lp4vljJbmtojmga/nmoTnu5HlrppcclxuICAgICAgICBpZiAobWVkaWF0b3JbXCJkZXBlbmRNb2R1bGVJbnN0YW5jZVwiXSkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gbWVkaWF0b3JbXCJkZXBlbmRNb2R1bGVJbnN0YW5jZVwiXS5yZXNwb25zZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBCaW5kTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgQmluZE1hbmFnZXIpO1xyXG4gICAgcmV0dXJuIEJpbmRNYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBCaW5kTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGJpbmRNYW5hZ2VyID0gY29yZS5nZXRJbmplY3QoQmluZE1hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9CaW5kTWFuYWdlci5qc1xuLy8gbW9kdWxlIGlkID0gMzZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE4LTAzLTIyXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE4LTAzLTIyXHJcbiAqXHJcbiAqIOaYvuekuuW3peWFt1xyXG4qL1xyXG4vKipcclxuICog5pu/5o2i5pi+56S6XHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQnJpZGdlfSBicmlkZ2Ug6KaB5L2/55So55qE5qGlXHJcbiAqIEBwYXJhbSB7Kn0gY3VycmVudCDooqvmm7/mjaLnmoTmmL7npLpcclxuICogQHBhcmFtIHsqfSB0YXJnZXQg5pu/5o2i5oiQ5Li655qE5pi+56S6XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZURpc3BsYXkoYnJpZGdlLCBjdXJyZW50LCB0YXJnZXQpIHtcclxuICAgIC8vIOS4pOS4quearuiCpOW/hemhu+mDveaYr+matuWxnuahpeeahOearuiCpFxyXG4gICAgaWYgKGJyaWRnZS5pc015U2tpbih0YXJnZXQpICYmIGJyaWRnZS5pc015U2tpbihjdXJyZW50KSkge1xyXG4gICAgICAgIHZhciBwYXJlbnQgPSBicmlkZ2UuZ2V0UGFyZW50KGN1cnJlbnQpO1xyXG4gICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYnJpZGdlLmdldENoaWxkSW5kZXgocGFyZW50LCBjdXJyZW50KTtcclxuICAgICAgICAgICAgYnJpZGdlLmFkZENoaWxkQXQocGFyZW50LCB0YXJnZXQsIGluZGV4KTtcclxuICAgICAgICAgICAgYnJpZGdlLnJlbW92ZUNoaWxkKHBhcmVudCwgY3VycmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL3V0aWxzL0Rpc3BsYXlVdGlsLmpzXG4vLyBtb2R1bGUgaWQgPSAzN1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTgtMDEtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTgtMDEtMzBcclxuICpcclxuICog6K+l5o6l5Y+j6KeE5a6a5LqG5Lit5LuL6ICF5YW35pyJ55qE5qih5Z2X6YOo5YiG5Yqf6IO9XHJcbiovXHJcbmV4cG9ydCB2YXIgTW9kdWxlT3BlblN0YXR1cztcclxuKGZ1bmN0aW9uIChNb2R1bGVPcGVuU3RhdHVzKSB7XHJcbiAgICBNb2R1bGVPcGVuU3RhdHVzW01vZHVsZU9wZW5TdGF0dXNbXCJTdG9wXCJdID0gMF0gPSBcIlN0b3BcIjtcclxuICAgIE1vZHVsZU9wZW5TdGF0dXNbTW9kdWxlT3BlblN0YXR1c1tcIkJlZm9yZU9wZW5cIl0gPSAxXSA9IFwiQmVmb3JlT3BlblwiO1xyXG4gICAgTW9kdWxlT3BlblN0YXR1c1tNb2R1bGVPcGVuU3RhdHVzW1wiQWZ0ZXJPcGVuXCJdID0gMl0gPSBcIkFmdGVyT3BlblwiO1xyXG59KShNb2R1bGVPcGVuU3RhdHVzIHx8IChNb2R1bGVPcGVuU3RhdHVzID0ge30pKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL0lNZWRpYXRvck1vZHVsZVBhcnQuanNcbi8vIG1vZHVsZSBpZCA9IDM4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tIFwiLi4vLi4vY29yZS9pbmplY3Rvci9JbmplY3RvclwiO1xyXG5pbXBvcnQgeyBub3RpZnksIHdhaXQgfSBmcm9tIFwiLi4vLi4vdXRpbHMvU3luY1V0aWxcIjtcclxuaW1wb3J0IG5vbmUgZnJvbSBcIi4vTm9uZVNjZW5lUG9saWN5XCI7XHJcbmltcG9ydCBTY2VuZU1lc3NhZ2UgZnJvbSBcIi4vU2NlbmVNZXNzYWdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDlvLnnqpfnrqHnkIblmajvvIzljIXlkKvliIfmjaLlnLrmma/jgIFwdXNo5Zy65pmv44CBcG9w5Zy65pmv5Yqf6IO9XHJcbiovXHJcbnZhciBTWU5DX05BTUUgPSBcIlNjZW5lTWFuYWdlcl9zeW5jXCI7XHJcbnZhciBDaGFuZ2VUeXBlO1xyXG4oZnVuY3Rpb24gKENoYW5nZVR5cGUpIHtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIlN3aXRjaFwiXSA9IDBdID0gXCJTd2l0Y2hcIjtcclxuICAgIENoYW5nZVR5cGVbQ2hhbmdlVHlwZVtcIlB1c2hcIl0gPSAxXSA9IFwiUHVzaFwiO1xyXG4gICAgQ2hhbmdlVHlwZVtDaGFuZ2VUeXBlW1wiUG9wXCJdID0gMl0gPSBcIlBvcFwiO1xyXG59KShDaGFuZ2VUeXBlIHx8IChDaGFuZ2VUeXBlID0ge30pKTtcclxudmFyIFNjZW5lTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNjZW5lTWFuYWdlcigpIHtcclxuICAgICAgICB0aGlzLl9zY2VuZVN0YWNrID0gW107XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2NlbmVNYW5hZ2VyLnByb3RvdHlwZSwgXCJjdXJyZW50U2NlbmVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluW9k+WJjeWcuuaZr1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge0lTY2VuZX1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgU2NlbmVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY2VuZVN0YWNrWzBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNjZW5lTWFuYWdlci5wcm90b3R5cGUsIFwiYWN0aXZlQ291bnRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPlua0u+WKqOWcuuaZr+S4quaVsFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge251bWJlcn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgU2NlbmVNYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zY2VuZVN0YWNrLmxlbmd0aDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Zy65pmv5piv5ZCm5bey57uP5byA5ZCvXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJU2NlbmV9IHNjZW5lIOWcuuaZr+WvueixoVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IOaYr+WQpuW3sue7j+W8gOWQr1xyXG4gICAgICogQG1lbWJlcm9mIFNjZW5lTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLmlzT3BlbmVkID0gZnVuY3Rpb24gKHNjZW5lKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9zY2VuZVN0YWNrLmluZGV4T2Yoc2NlbmUpID49IDApO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv77yM5pu/5o2i5b2T5YmN5Zy65pmv77yM5b2T5YmN5Zy65pmv5Lya6KKr6ZSA5q+BXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJU2NlbmV9IHNjZW5lIOimgeWIh+aNouWIsOeahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIHsqfSBbZGF0YV0g6KaB5pC65bim57uZ5LiL5LiA5Liq5Zy65pmv55qE5pWw5o2uXHJcbiAgICAgKiBAcmV0dXJucyB7SVNjZW5lfSDlnLrmma/mnKzkvZNcclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1hbmFnZXJcclxuICAgICAqL1xyXG4gICAgU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5zd2l0Y2ggPSBmdW5jdGlvbiAoc2NlbmUsIGRhdGEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgICAgIGlmIChzY2VuZSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgLy8g5aaC5p6c5YiH5YWl55qE5piv56ys5LiA5Liq5Zy65pmv77yM5YiZ5pS555SocHVzaOaTjeS9nFxyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZUNvdW50ID09IDApXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnB1c2goc2NlbmUsIGRhdGEpO1xyXG4gICAgICAgIC8vIOWQjOatpeaJp+ihjFxyXG4gICAgICAgIHdhaXQoU1lOQ19OQU1FLCB0aGlzLmRvQ2hhbmdlLCB0aGlzLCB0aGlzLmN1cnJlbnRTY2VuZSwgc2NlbmUsIGRhdGEsIHNjZW5lLnBvbGljeSB8fCBzY2VuZS5icmlkZ2UuZGVmYXVsdFNjZW5lUG9saWN5IHx8IG5vbmUsIENoYW5nZVR5cGUuU3dpdGNoLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICBfdGhpcy5fc2NlbmVTdGFja1swXSA9IHNjZW5lO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfU1RBQ0tfQ0hBTkdFKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2NlbmU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjqjlhaXlnLrmma/vvIzlvZPliY3lnLrmma/kuI3kvJrplIDmr4HvvIzogIzmmK/ov5vlhaXlnLrmma/moIjkv53lrZjvvIzku6XlkI7lj6/ku6XpgJrov4dwb3BTY2VuZemHjeaWsOWxleeOsFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SVNjZW5lfSBzY2VuZSDopoHmjqjlhaXnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB7Kn0gW2RhdGFdIOimgeaQuuW4pue7meS4i+S4gOS4quWcuuaZr+eahOaVsOaNrlxyXG4gICAgICogQHJldHVybnMge0lTY2VuZX0g5Zy65pmv5pys5L2TXHJcbiAgICAgKiBAbWVtYmVyb2YgU2NlbmVNYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWFuYWdlci5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uIChzY2VuZSwgZGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8g6Z2e56m65Yik5patXHJcbiAgICAgICAgaWYgKHNjZW5lID09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBzY2VuZTtcclxuICAgICAgICAvLyDlkIzmraXmiafooYxcclxuICAgICAgICB3YWl0KFNZTkNfTkFNRSwgdGhpcy5kb0NoYW5nZSwgdGhpcywgdGhpcy5jdXJyZW50U2NlbmUsIHNjZW5lLCBkYXRhLCBzY2VuZS5wb2xpY3kgfHwgc2NlbmUuYnJpZGdlLmRlZmF1bHRTY2VuZVBvbGljeSB8fCBub25lLCBDaGFuZ2VUeXBlLlB1c2gsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy8g5pWw5o2u5YWI6KGMXHJcbiAgICAgICAgICAgIF90aGlzLl9zY2VuZVN0YWNrLnVuc2hpZnQoc2NlbmUpO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfU1RBQ0tfQ0hBTkdFKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2NlbmU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvLnlh7rlnLrmma/vvIzlvZPliY3lnLrmma/kvJrooqvplIDmr4HvvIzlvZPliY3kvY3kuo7moIjpobbnmoTlnLrmma/kvJrph43mlrDmmL7npLpcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0lTY2VuZX0gc2NlbmUg6KaB5YiH5o2i5Ye655qE5Zy65pmv77yM5aaC5p6c5Lyg5YWl55qE5Zy65pmv5LiN5piv5b2T5YmN5Zy65pmv5YiZ5LuF56e76Zmk5oyH5a6a5Zy65pmv77yM5LiN5Lya6L+b6KGM5YiH5o2i5pON5L2cXHJcbiAgICAgKiBAcGFyYW0geyp9IFtkYXRhXSDopoHmkLrluKbnu5nkuIvkuIDkuKrlnLrmma/nmoTmlbDmja5cclxuICAgICAqIEByZXR1cm5zIHtJU2NlbmV9IOWcuuaZr+acrOS9k1xyXG4gICAgICogQG1lbWJlcm9mIFNjZW5lTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uIChzY2VuZSwgZGF0YSkge1xyXG4gICAgICAgIC8vIOmdnuepuuWIpOaWrVxyXG4gICAgICAgIGlmIChzY2VuZSA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gc2NlbmU7XHJcbiAgICAgICAgLy8g5ZCM5q2l5omn6KGMXHJcbiAgICAgICAgd2FpdChTWU5DX05BTUUsIHRoaXMuZG9Qb3AsIHRoaXMsIHNjZW5lLCBkYXRhKTtcclxuICAgICAgICByZXR1cm4gc2NlbmU7XHJcbiAgICB9O1xyXG4gICAgU2NlbmVNYW5hZ2VyLnByb3RvdHlwZS5kb1BvcCA9IGZ1bmN0aW9uIChzY2VuZSwgZGF0YSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8g5aaC5p6c5rKh5pyJ6Laz5aSf55qE5Zy65pmv5YKo5aSH5YiZ5LuA5LmI6YO95LiN5YGaXHJcbiAgICAgICAgaWYgKHRoaXMuYWN0aXZlQ291bnQgPD0gMSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWcuuaZr+agiOS4reeahOWcuuaZr+aVsOmHj+S4jei2s++8jOaXoOazleaJp+ihjHBvcOaTjeS9nFwiKTtcclxuICAgICAgICAgICAgLy8g5a6M5oiQ5q2l6aqkXHJcbiAgICAgICAgICAgIG5vdGlmeShTWU5DX05BTUUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOmqjOivgeaYr+WQpuaYr+W9k+WJjeWcuuaZr++8jOS4jeaYr+WImeebtOaOpeenu+mZpO+8jOS4jeS9v+eUqFBvbGljeVxyXG4gICAgICAgIHZhciB0byA9IHRoaXMuX3NjZW5lU3RhY2tbMV07XHJcbiAgICAgICAgdmFyIHBvbGljeSA9IHNjZW5lLnBvbGljeSB8fCBzY2VuZS5icmlkZ2UuZGVmYXVsdFNjZW5lUG9saWN5IHx8IG5vbmU7XHJcbiAgICAgICAgaWYgKHRoaXMuX3NjZW5lU3RhY2suaW5kZXhPZihzY2VuZSkgIT0gMCkge1xyXG4gICAgICAgICAgICB0byA9IG51bGw7XHJcbiAgICAgICAgICAgIHBvbGljeSA9IG5vbmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOaJp+ihjOWIh+aNolxyXG4gICAgICAgIHRoaXMuZG9DaGFuZ2Uoc2NlbmUsIHRvLCBkYXRhLCBwb2xpY3ksIENoYW5nZVR5cGUuUG9wLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOaVsOaNruWFiOihjFxyXG4gICAgICAgICAgICBfdGhpcy5fc2NlbmVTdGFjay5zcGxpY2UoX3RoaXMuX3NjZW5lU3RhY2suaW5kZXhPZihzY2VuZSksIDEpO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hmtojmga9cclxuICAgICAgICAgICAgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfU1RBQ0tfQ0hBTkdFKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBTY2VuZU1hbmFnZXIucHJvdG90eXBlLmRvQ2hhbmdlID0gZnVuY3Rpb24gKGZyb20sIHRvLCBkYXRhLCBwb2xpY3ksIHR5cGUsIGJlZ2luLCBjb21wbGV0ZSkge1xyXG4gICAgICAgIC8vIOWmguaenGZyb23lkox0b+acieS4gOS4quS4um51bGzliJlwb2xpY3nkuLpub25lXHJcbiAgICAgICAgaWYgKCFmcm9tIHx8ICF0bylcclxuICAgICAgICAgICAgcG9saWN5ID0gbm9uZTtcclxuICAgICAgICAvLyB0b+aMh+WumueahOWcuuaZr+W/hemhu+imgeaYvuekulxyXG4gICAgICAgIGlmICh0bylcclxuICAgICAgICAgICAgdG8uYnJpZGdlLmh0bWxXcmFwcGVyLnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xyXG4gICAgICAgIC8vIOWmguaenOimgeS6pOabv+eahOS4pOS4quWcuuaZr+S4jeaYr+WQjOS4gOS4quexu+Wei+eahOWcuuaZr++8jOWImeWIh+aNokhUTUxXcmFwcGVy5pi+56S677yM5LiUUG9saWN55Lmf6YeH55So5peg5YiH5o2i562W55WlXHJcbiAgICAgICAgaWYgKGZyb20gJiYgdG8gJiYgdG8uYnJpZGdlLnR5cGUgIT0gZnJvbS5icmlkZ2UudHlwZSkge1xyXG4gICAgICAgICAgICBmcm9tLmJyaWRnZS5odG1sV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgIHBvbGljeSA9IG5vbmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIGJlZ2luICYmIGJlZ2luKCk7XHJcbiAgICAgICAgLy8g6I635Y+W5o6l5Y+j5byV55SoXHJcbiAgICAgICAgdmFyIHByZXBhcmVGdW5jO1xyXG4gICAgICAgIHZhciBkb0Z1bmM7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQ2hhbmdlVHlwZS5Td2l0Y2g6XHJcbiAgICAgICAgICAgICAgICBwcmVwYXJlRnVuYyA9IHBvbGljeS5wcmVwYXJlU3dpdGNoO1xyXG4gICAgICAgICAgICAgICAgZG9GdW5jID0gcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUHVzaDpcclxuICAgICAgICAgICAgICAgIHByZXBhcmVGdW5jID0gcG9saWN5LnByZXBhcmVQdXNoIHx8IHBvbGljeS5wcmVwYXJlU3dpdGNoO1xyXG4gICAgICAgICAgICAgICAgZG9GdW5jID0gcG9saWN5LnB1c2ggfHwgcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIENoYW5nZVR5cGUuUG9wOlxyXG4gICAgICAgICAgICAgICAgcHJlcGFyZUZ1bmMgPSBwb2xpY3kucHJlcGFyZVBvcCB8fCBwb2xpY3kucHJlcGFyZVN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGRvRnVuYyA9IHBvbGljeS5wb3AgfHwgcG9saWN5LnN3aXRjaDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDliY3nva7lpITnkIZcclxuICAgICAgICB0byAmJiBmcm9tICYmIGZyb20ub25CZWZvcmVPdXQodG8sIGRhdGEpO1xyXG4gICAgICAgIHRvICYmIHRvLm9uQmVmb3JlSW4oZnJvbSwgZGF0YSk7XHJcbiAgICAgICAgLy8g5rS+5Y+R5LqL5Lu2XHJcbiAgICAgICAgdG8gJiYgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfQkVGT1JFX0NIQU5HRSwgdG8sIGZyb20pO1xyXG4gICAgICAgIC8vIOiwg+eUqOWHhuWkh+aOpeWPo1xyXG4gICAgICAgIHByZXBhcmVGdW5jICYmIHByZXBhcmVGdW5jLmNhbGwocG9saWN5LCBmcm9tLCB0byk7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgdG8gJiYgdG8uYnJpZGdlLmFkZENoaWxkKHRvLmJyaWRnZS5zY2VuZUxheWVyLCB0by5za2luKTtcclxuICAgICAgICAvLyDosIPnlKjliIfmjaLmjqXlj6NcclxuICAgICAgICBkb0Z1bmMuY2FsbChwb2xpY3ksIGZyb20sIHRvLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOWujOaIkOatpemqpFxyXG4gICAgICAgICAgICBub3RpZnkoU1lOQ19OQU1FKTtcclxuICAgICAgICAgICAgLy8g56e76Zmk5pi+56S6XHJcbiAgICAgICAgICAgIHRvICYmIGZyb20gJiYgZnJvbS5icmlkZ2UucmVtb3ZlQ2hpbGQoZnJvbS5icmlkZ2Uuc2NlbmVMYXllciwgZnJvbS5za2luKTtcclxuICAgICAgICAgICAgLy8g5ZCO572u5aSE55CGXHJcbiAgICAgICAgICAgIHRvICYmIGZyb20gJiYgZnJvbS5vbkFmdGVyT3V0KHRvLCBkYXRhKTtcclxuICAgICAgICAgICAgdG8gJiYgdG8ub25BZnRlckluKGZyb20sIGRhdGEpO1xyXG4gICAgICAgICAgICAvLyDmtL7lj5Hkuovku7ZcclxuICAgICAgICAgICAgdG8gJiYgY29yZS5kaXNwYXRjaChTY2VuZU1lc3NhZ2UuU0NFTkVfQUZURVJfQ0hBTkdFLCB0bywgZnJvbSk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBjb21wbGV0ZSAmJiBjb21wbGV0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFNjZW5lTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgU2NlbmVNYW5hZ2VyKTtcclxuICAgIHJldHVybiBTY2VuZU1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFNjZW5lTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHNjZW5lTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KFNjZW5lTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDM5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDlnLrmma/nm7jlhbPnmoTmtojmga9cclxuKi9cclxudmFyIFNjZW5lTWVzc2FnZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNjZW5lTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv5YmN55qE5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZXNzYWdlLlNDRU5FX0JFRk9SRV9DSEFOR0UgPSBcInNjZW5lQmVmb3JlQ2hhbmdlXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWIh+aNouWcuuaZr+WQjueahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgU2NlbmVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFNjZW5lTWVzc2FnZS5TQ0VORV9BRlRFUl9DSEFOR0UgPSBcInNjZW5lQWZ0ZXJDaGFuZ2VcIjtcclxuICAgIC8qKlxyXG4gICAgICog5Zy65pmv5qCI5pWw5o2u5Y+Y5YyW5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBTY2VuZU1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgU2NlbmVNZXNzYWdlLlNDRU5FX1NUQUNLX0NIQU5HRSA9IFwic2NlbmVTdGFja0NoYW5nZVwiO1xyXG4gICAgcmV0dXJuIFNjZW5lTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgU2NlbmVNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvc2NlbmUvU2NlbmVNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA0MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog6KGo546w5bGC5raI5oGvXHJcbiovXHJcbnZhciBCcmlkZ2VNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQnJpZGdlTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyW6KGo546w5bGC5a6e5L6L5YmN55qE5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBWaWV3TWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBCcmlkZ2VNZXNzYWdlLkJSSURHRV9CRUZPUkVfSU5JVCA9IFwiYnJpZGdlQmVmb3JlSW5pdFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliJ3lp4vljJbooajnjrDlsYLlrp7kvovlkI7nmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFZpZXdNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FGVEVSX0lOSVQgPSBcImJyaWRnZUFmdGVySW5pdFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiYDmnInooajnjrDlsYLlrp7kvovpg73liJ3lp4vljJblrozmr5XnmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFZpZXdNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FMTF9JTklUID0gXCJicmlkZ2VBbGxJbml0XCI7XHJcbiAgICByZXR1cm4gQnJpZGdlTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQnJpZGdlTWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA0MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgUmVxdWVzdERhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZXF1ZXN0RGF0YSgpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDnlKjmiLflj4LmlbDvvIzlj6/ku6Xkv53lrZjku7vmhI/lj4LmlbDliLBNZXNzYWdl5Lit77yM6K+l5Y+C5pWw5Lit55qE5pWw5o2u5LiN5Lya6KKr5Y+R6YCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Kn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgUmVxdWVzdERhdGFcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLl9fdXNlckRhdGEgPSB7fTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDmmK/lkKblnKjmjqXliLDov5Tlm57liY3kvb/nlKhsb2FkaW5n57G75Z6L6YGu572p6KaG55uW5YWo5bGP77yM6Ziy5q2i55So5oi35pON5L2c77yM6buY6K6k5pivdHJ1ZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFJlcXVlc3REYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fX3VzZU1hc2sgPSB0cnVlO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+a0vuWPkeWGheaguOWIl+ihqFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX19vYnNlcnZhYmxlcyA9IFtdO1xyXG4gICAgICAgIC8vIOemgeaOiemDqOWIhuacrOWcsOWPmOmHj+eahOWPr+mBjeWOhuaAp1xyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHtcclxuICAgICAgICAgICAgX191c2VyRGF0YToge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9fdXNlckRhdGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgX19vYnNlcnZhYmxlczoge1xyXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9fb2JzZXJ2YWJsZXNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlcXVlc3REYXRhLnByb3RvdHlwZSwgXCJfX29ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+W9k+WJjeaJgOWxnuWGheaguFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX29ic2VydmFibGVzWzBdO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJlcXVlc3REYXRhLnByb3RvdHlwZSwgXCJfX29yaU9ic2VydmFibGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOa2iOaBr+aJgOWxnueahOWOn+Wni+WGheaguO+8iOesrOS4gOS4qua0vuWPkeWIsOeahOWGheaguO+8iVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge0lPYnNlcnZhYmxlfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX29ic2VydmFibGVzW3RoaXMuX19vYnNlcnZhYmxlcy5sZW5ndGggLSAxXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXF1ZXN0RGF0YS5wcm90b3R5cGUsIFwiX190eXBlXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bor7fmsYLmtojmga/nsbvlnovlrZfnrKbkuLJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFJlcXVlc3REYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9fcGFyYW1zLnR5cGU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWGjeasoeWPkemAgea2iOaBr++8jOS8muS9v+eUqOmmluS4quWGheaguOmHjeaWsOWPkemAgeivpea2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBSZXF1ZXN0RGF0YVxyXG4gICAgICovXHJcbiAgICBSZXF1ZXN0RGF0YS5wcm90b3R5cGUucmVkaXNwYXRjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9fb3JpT2JzZXJ2YWJsZS5kaXNwYXRjaCh0aGlzKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVxdWVzdERhdGE7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFJlcXVlc3REYXRhO1xyXG4vKiog5a+85Ye65YWs5YWx5raI5oGv5Y+C5pWw5a+56LGhICovXHJcbmV4cG9ydCB2YXIgY29tbW9uRGF0YSA9IHt9O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L1JlcXVlc3REYXRhLmpzXG4vLyBtb2R1bGUgaWQgPSA0MlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBjcmVhdGVFdmFsRnVuYyB9IGZyb20gXCIuL1V0aWxzXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMS0wNlxyXG4gKlxyXG4gKiDmlbDmja7mm7TmlrDorqLpmIXogIXvvIzlvZPkvp3otZbnmoTmlbDmja7mnInmm7TmlrDml7bkvJrop6blj5FjYWxsYmFja+mAmuefpeWklumdolxyXG4qL1xyXG52YXIgV2F0Y2hlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdhdGNoZXIoYmluZCwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBleHAsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIHNjb3BlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gNjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHNjb3Blc1tfaSAtIDZdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZGlzcG9zZWQgPSBmYWxzZTtcclxuICAgICAgICAvLyDorrDlvZVCaW5k5a6e5L6LXHJcbiAgICAgICAgdGhpcy5fYmluZCA9IGJpbmQ7XHJcbiAgICAgICAgLy8g6K6w5b2V5L2c55So55uu5qCH44CB6KGo6L6+5byP5ZKM5L2c55So5Z+fXHJcbiAgICAgICAgdGhpcy5fY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXQ7XHJcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMuX2V4cCA9IGV4cDtcclxuICAgICAgICB0aGlzLl90aGlzQXJnID0gdGhpc0FyZztcclxuICAgICAgICB0aGlzLl9zY29wZXMgPSBzY29wZXM7XHJcbiAgICAgICAgLy8g5bCG6KGo6L6+5byP5ZKM5L2c55So5Z+f6Kej5p6Q5Li65LiA5LiqRnVuY3Rpb25cclxuICAgICAgICB0aGlzLl9leHBGdW5jID0gY3JlYXRlRXZhbEZ1bmMoZXhwLCAxICsgc2NvcGVzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8g6K6w5b2V5Zue6LCD5Ye95pWwXHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgICAgICAvLyDov5vooYzpppbmrKHmm7TmlrBcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdhdGNoZXIucHJvdG90eXBlLCBcImRpc3Bvc2VkXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bor6Xop4Llr5/ogIXmmK/lkKblt7Lnu4/ooqvplIDmr4FcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBXYXRjaGVyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kaXNwb3NlZDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5Yiw6KGo6L6+5byP5b2T5YmN5pyA5paw5YC8XHJcbiAgICAgKiBAcmV0dXJucyB7YW55fSDmnIDmlrDlgLxcclxuICAgICAqL1xyXG4gICAgV2F0Y2hlci5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIGlmICh0aGlzLl9kaXNwb3NlZClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgdmFyIHZhbHVlO1xyXG4gICAgICAgIC8vIOiusOW9leiHqui6q1xyXG4gICAgICAgIFdhdGNoZXIudXBkYXRpbmcgPSB0aGlzO1xyXG4gICAgICAgIC8vIOiuvue9rumAmueUqOWxnuaAp1xyXG4gICAgICAgIHZhciBjb21tb25TY29wZSA9IHtcclxuICAgICAgICAgICAgJHRoaXM6IHRoaXMuX2JpbmQubWVkaWF0b3IsXHJcbiAgICAgICAgICAgICRkYXRhOiB0aGlzLl9iaW5kLm1lZGlhdG9yLnZpZXdNb2RlbCxcclxuICAgICAgICAgICAgJGJyaWRnZTogdGhpcy5fYmluZC5tZWRpYXRvci5icmlkZ2UsXHJcbiAgICAgICAgICAgICRjdXJyZW50VGFyZ2V0OiB0aGlzLl9jdXJyZW50VGFyZ2V0LFxyXG4gICAgICAgICAgICAkdGFyZ2V0OiB0aGlzLl90YXJnZXRcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIOihqOi+vuW8j+axguWAvFxyXG4gICAgICAgIHZhbHVlID0gKF9hID0gdGhpcy5fZXhwRnVuYykuY2FsbC5hcHBseShfYSwgW3RoaXMuX3RoaXNBcmddLmNvbmNhdCh0aGlzLl9zY29wZXMsIFtjb21tb25TY29wZV0pKTtcclxuICAgICAgICAvLyDnp7vpmaToh6rouqvorrDlvZVcclxuICAgICAgICBXYXRjaGVyLnVwZGF0aW5nID0gbnVsbDtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlvZPkvp3otZbnmoTmlbDmja7mnInmm7TmlrDml7bosIPnlKjor6Xmlrnms5VcclxuICAgICAqIEBwYXJhbSBleHRyYSDlj6/og73nmoTpop3lpJbmlbDmja5cclxuICAgICAqL1xyXG4gICAgV2F0Y2hlci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKGV4dHJhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5nZXRWYWx1ZSgpO1xyXG4gICAgICAgIGlmICghV2F0Y2hlci5pc0VxdWFsKHZhbHVlLCB0aGlzLl92YWx1ZSkpIHtcclxuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgJiYgdGhpcy5fY2FsbGJhY2sodmFsdWUsIHRoaXMuX3ZhbHVlLCBleHRyYSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gV2F0Y2hlci5kZWVwQ29weSh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDplIDmr4HorqLpmIXogIUgKi9cclxuICAgIFdhdGNoZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2Rpc3Bvc2VkKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2JpbmQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2N1cnJlbnRUYXJnZXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3RhcmdldCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fdGhpc0FyZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fZXhwID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zY29wZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2V4cEZ1bmMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IHRydWU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmK/lkKbnm7jnrYnvvIzljIXmi6zln7rnoYDnsbvlnovlkozlr7nosaEv5pWw57uE55qE5a+55q+UXHJcbiAgICAgKi9cclxuICAgIFdhdGNoZXIuaXNFcXVhbCA9IGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgcmV0dXJuIChhID09IGIgfHwgKFdhdGNoZXIuaXNPYmplY3QoYSkgJiYgV2F0Y2hlci5pc09iamVjdChiKVxyXG4gICAgICAgICAgICA/IEpTT04uc3RyaW5naWZ5KGEpID09IEpTT04uc3RyaW5naWZ5KGIpXHJcbiAgICAgICAgICAgIDogZmFsc2UpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYr+WQpuS4uuWvueixoSjljIXmi6zmlbDnu4TjgIHmraPliJnnrYkpXHJcbiAgICAgKi9cclxuICAgIFdhdGNoZXIuaXNPYmplY3QgPSBmdW5jdGlvbiAob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuIChvYmogJiYgdHlwZW9mIG9iaiA9PSBcIm9iamVjdFwiKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWkjeWItuWvueixoe+8jOiLpeS4uuWvueixoeWImea3seW6puWkjeWItlxyXG4gICAgICovXHJcbiAgICBXYXRjaGVyLmRlZXBDb3B5ID0gZnVuY3Rpb24gKGZyb20pIHtcclxuICAgICAgICBpZiAoV2F0Y2hlci5pc09iamVjdChmcm9tKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy8g5aSN5p2C57G75Z6L5a+56LGh77yM5YWI5a2X56ym5Liy5YyW77yM5YaN5a+56LGh5YyWXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShmcm9tKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycikgeyB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWfuuacrOexu+Wei+WvueixoeWSjOaXoOazleWkjeWItueahOWvueixoe+8jOebtOaOpei/lOWbnuS5i1xyXG4gICAgICAgIHJldHVybiBmcm9tO1xyXG4gICAgfTtcclxuICAgIC8qKiDorrDlvZXlvZPliY3mraPlnKjmiafooYx1cGRhdGXmlrnms5XnmoRXYXRjaGVy5byV55SoICovXHJcbiAgICBXYXRjaGVyLnVwZGF0aW5nID0gbnVsbDtcclxuICAgIFdhdGNoZXIuX3VpZCA9IDA7XHJcbiAgICByZXR1cm4gV2F0Y2hlcjtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgV2F0Y2hlcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvV2F0Y2hlci5qc1xuLy8gbW9kdWxlIGlkID0gNDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IERhdGFUeXBlIGZyb20gXCIuL0RhdGFUeXBlXCI7XHJcbnZhciBSZXNwb25zZURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhSZXNwb25zZURhdGEsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBSZXNwb25zZURhdGEoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFJlc3BvbnNlRGF0YTtcclxufShEYXRhVHlwZSkpO1xyXG5leHBvcnQgZGVmYXVsdCBSZXNwb25zZURhdGE7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVzcG9uc2VEYXRhLmpzXG4vLyBtb2R1bGUgaWQgPSA0NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTFcclxuICpcclxuICog6K+35rGC5oiW6L+U5Zue5pWw5o2u57uT5p6E5L2TXHJcbiovXHJcbnZhciBEYXRhVHlwZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIERhdGFUeXBlKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDop6PmnpDlkI7nq6/ov5Tlm57nmoRKU09O5a+56LGh77yM55Sf5oiQ57uT5p6E5L2TXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHthbnl9IGRhdGEg5ZCO56uv6L+U5Zue55qESlNPTuWvueixoVxyXG4gICAgICogQHJldHVybnMge0RhdGFUeXBlfSDnu5PmnoTkvZPlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBEYXRhVHlwZVxyXG4gICAgICovXHJcbiAgICBEYXRhVHlwZS5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX19yYXdEYXRhID0gdGhpcy5kb1BhcnNlKGRhdGEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBEYXRhVHlwZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRGF0YVR5cGU7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvRGF0YVR5cGUuanNcbi8vIG1vZHVsZSBpZCA9IDQ1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vLi4vY29yZS9Db3JlXCI7XHJcbmltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIi4uL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgQXVkaW9NZXNzYWdlIGZyb20gXCIuL0F1ZGlvTWVzc2FnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzBcclxuICpcclxuICog5L2/55SoQXVkaW/moIfnrb7lrp7njrBJQXVkaW/mjqXlj6PnmoTlrp7njrDnsbtcclxuKi9cclxudmFyIEF1ZGlvVGFnSW1wbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEF1ZGlvVGFnSW1wbCgpIHtcclxuICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX211dGUgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9wbGF5aW5nRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2F1ZGlvQ2FjaGUgPSB7fTtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdWRpb1RhZ0ltcGwucHJvdG90eXBlLCBcImRpc3Bvc2VkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2VkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUsIFwibXV0ZVwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6Z2Z6Z+z54q25oCBXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5fbXV0ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAvLyDpnZnpn7PvvIzmmoLlgZzmiYDmnInlo7Dpn7NcclxuICAgICAgICAgICAgZm9yICh2YXIgdXJsIGluIHRoaXMuX3BsYXlpbmdEaWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZnpn7PvvIzlgZzmraLpn7PpopHvvIzkuI3lj6/osIPnlKhzdG9w5pa55rOV77yM5Zug5Li66KaB5L+d5oyB5pKt5pS+5Lit55qE6Z+z6aKR54q25oCBXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9TdG9wKHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDpnZ7pnZnpn7PvvIzmkq3mlL7pn7PpopFcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5fcGxheWluZ0RpY3RbdXJsXTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5saXN0ZW5Qcm9ncmVzcyA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgZGF0YS5ub2RlLm9udGltZXVwZGF0ZSA9IGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgLy8g5Y+q5pyJ5pKt5pS+54q25oCB5Y+v5Lul5rS+5Y+RUFJPR1JFU1Pkuovku7ZcclxuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IEF1ZGlvU3RhdHVzLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgICAgIC8vIOaIkeS7rOinhOWumuS9v+eUqOavq+enkuWAvOS9nOS4uuWNleS9jVxyXG4gICAgICAgICAgICAgICAgdmFyIGN1clRpbWUgPSBkYXRhLm5vZGUuY3VycmVudFRpbWUgKiAxMDAwO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRvdGFsVGltZSA9IGRhdGEubm9kZS5kdXJhdGlvbiAqIDEwMDA7XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmkq3mlL7ov5vluqbkuovku7ZcclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfUFJPR1JFU1MsIGRhdGEucGxheVBhcmFtcy51cmwsIGN1clRpbWUsIHRvdGFsVGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L296Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgLy8g5bCd6K+V6I635Y+W57yT5a2Y5pWw5o2uXHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICAvLyDlpoLmnpzmsqHmnInnvJPlrZjmiY3ljrvliqDovb1cclxuICAgICAgICBpZiAoIWRhdGEpIHtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5Yqg6L295byA5aeL5LqL5Lu2XHJcbiAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX0xPQURfU1RBUlRFRCwgdXJsKTtcclxuICAgICAgICAgICAgLy8g5L2/55SoQXVkaW/moIfnrb7liqDovb1cclxuICAgICAgICAgICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIik7XHJcbiAgICAgICAgICAgIC8vIOi/memHjOW8uuWItuS9v+eUqGF1dG9wbGF577yM5Zug5Li65ZyoSU9T55qEc2FmYXJp5LiK5aaC5p6c5rKh6L+Z5Liq5Y+C5pWw77yM5YiZ5qC55pys5LiN5Lya6Kem5Y+Rb25sb2FkZWRkYXRh5LqL5Lu2XHJcbiAgICAgICAgICAgIG5vZGUuYXV0b3BsYXkgPSB0cnVlO1xyXG4gICAgICAgICAgICBub2RlLnNyYyA9IHRvVXJsO1xyXG4gICAgICAgICAgICAvLyDkv53lrZjmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fYXVkaW9DYWNoZVt0b1VybF0gPSBkYXRhID0geyBub2RlOiBub2RlLCBzdGF0dXM6IEF1ZGlvU3RhdHVzLkxPQURJTkcsIHBsYXlQYXJhbXM6IG51bGwgfTtcclxuICAgICAgICAgICAgLy8g55uR5ZCs5Yqg6L29XHJcbiAgICAgICAgICAgIG5vZGUub25sb2FkZWRkYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8g6K6w5b2V5Yqg6L295a6M5q+VXHJcbiAgICAgICAgICAgICAgICBkYXRhLnN0YXR1cyA9IEF1ZGlvU3RhdHVzLlBBVVNFRDtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkeWKoOi9veWujOavleS6i+S7tlxyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fTE9BRF9FTkRFRCwgdXJsKTtcclxuICAgICAgICAgICAgICAgIC8vIOWmguaenOS4jeiHquWKqOaSreaUvuWImeaaguWBnFxyXG4gICAgICAgICAgICAgICAgaWYgKCFkYXRhLnBsYXlQYXJhbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnBhdXNlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gZGF0YS5wbGF5UGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rueKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gQXVkaW9TdGF0dXMuUExBWUlORztcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXmkq3mlL7kuK1cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fcGxheWluZ0RpY3RbdG9VcmxdID0gcGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuW8gOWni+S6i+S7tlxyXG4gICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfU1RBUlRFRCwgcGFyYW1zLnVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g55uR5ZCs5pKt5pS+6L+b5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubGlzdGVuUHJvZ3Jlc3MoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG5vZGUub25lbmRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiuvue9rueKtuaAgVxyXG4gICAgICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmkq3mlL7lrozmr5Xkuovku7ZcclxuICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfRU5ERUQsIHVybCk7XHJcbiAgICAgICAgICAgICAgICAvLyDlpoLmnpzlvqrnjq/liJnlho3lvIBcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnBsYXlQYXJhbXMubG9vcClcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5KGRhdGEucGxheVBhcmFtcyk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG5vZGUub25lcnJvciA9IGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgICAgICAgICAgIC8v5rS+5Y+R6ZSZ6K+v5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19FUlJPUiwgdXJsLCBldnQpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvumfs+mike+8jOWmguaenOmfs+mikeayoeacieWKoOi9veWImeWFiOWKoOi9veWGjeaSreaUvlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QXVkaW9QbGF5UGFyYW1zfSBwYXJhbXMg6Z+z6aKR5pKt5pS+5Y+C5pWwXHJcbiAgICAgKiBAcmV0dXJucyB7dm9pZH1cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTChwYXJhbXMudXJsKTtcclxuICAgICAgICAvLyDlsJ3or5Xojrflj5bnvJPlrZjmlbDmja5cclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAvLyDmsqHmnInliqDovb3ov4fvvIzlvIDlp4vliqDovb3pn7PpopFcclxuICAgICAgICAgICAgdGhpcy5sb2FkKHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAvLyDorr7nva7mkq3mlL7lj4LmlbBcclxuICAgICAgICAgICAgdGhpcy5fYXVkaW9DYWNoZVt0b1VybF0ucGxheVBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5zdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgQXVkaW9TdGF0dXMuTE9BRElORzpcclxuICAgICAgICAgICAgICAgICAgICAvLyDmraPlnKjliqDovb3kuK3vvIzmm7/mjaLoh6rliqjmkq3mlL7lj4LmlbBcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnBsYXlQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEF1ZGlvU3RhdHVzLlBMQVlJTkc6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5q2j5Zyo5pKt5pS+77yM5YWz6Zet5ZCO5YaN5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxheShwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBBdWRpb1N0YXR1cy5QQVVTRUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5Yqg6L295a6M5q+V77yM5pqC5YGc5Lit77yM55u05o6l5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5wbGF5UGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbXMuc3RvcE90aGVycylcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wQWxsKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5sb29wICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZS5sb29wID0gcGFyYW1zLmxvb3A7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtcy50aW1lICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZS5jdXJyZW50VGltZSA9IHBhcmFtcy50aW1lICogMC4wMDE7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g55uR5ZCs5pKt5pS+6L+b5bqmXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5Qcm9ncmVzcyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlvIDlp4vmkq3mlL7vvIxzYWZhcmnkuI3mlK/mjIHnm7TmjqVwbGF5KFdURj8p5omA5Lul6KaB55SoYXV0b3BsYXnliqBsb2Fk6L+b6KGM5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLmF1dG9wbGF5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUubG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiuvue9rueKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gQXVkaW9TdGF0dXMuUExBWUlORztcclxuICAgICAgICAgICAgICAgICAgICAvLyDorrDlvZXmkq3mlL7kuK1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF0gPSBwYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5rS+5Y+R5pKt5pS+5byA5aeL5LqL5Lu2XHJcbiAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9TVEFSVEVELCBwYXJhbXMudXJsKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLl9kb1N0b3AgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICBkYXRhLm5vZGUuYXV0b3BsYXkgPSBmYWxzZTtcclxuICAgICAgICAgICAgZGF0YS5ub2RlLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIC8vIOiuvue9ruWBnOatouaXtumXtFxyXG4gICAgICAgICAgICBpZiAodGltZSAhPSBudWxsKVxyXG4gICAgICAgICAgICAgICAgZGF0YS5ub2RlLmN1cnJlbnRUaW1lID0gdGltZSAqIDAuMDAxO1xyXG4gICAgICAgICAgICAvLyDorr7nva7nirbmgIFcclxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuWBnOatouS6i+S7tlxyXG4gICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1NUT1BQRUQsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pqC5YGc6Z+z6aKR77yI5LiN5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9kb1N0b3AodXJsKTtcclxuICAgICAgICAvLyDnp7vpmaTmkq3mlL7kuK1cclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcGxheWluZ0RpY3RbdG9VcmxdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i6Z+z6aKR77yI5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb1RhZ0ltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9UYWdJbXBsLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2RvU3RvcCh1cmwsIDApO1xyXG4gICAgICAgIC8vIOenu+mZpOaSreaUvuS4rVxyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraLmiYDmnInpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUuc3RvcEFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciB1cmwgaW4gdGhpcy5fYXVkaW9DYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AodXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7Povazpn7PpopHov5vluqZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUg6KaB6Lez6L2s5Yiw55qE6Z+z6aKR5L2N572u77yM5q+r56eS5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9UYWdJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uICh1cmwsIHRpbWUpIHtcclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdXJsXTtcclxuICAgICAgICBpZiAoZGF0YSlcclxuICAgICAgICAgICAgZGF0YS5ub2RlLmN1cnJlbnRUaW1lID0gdGltZSAqIDAuMDAxO1xyXG4gICAgfTtcclxuICAgIEF1ZGlvVGFnSW1wbC5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2Rpc3Bvc2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcEFsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBdWRpb1RhZ0ltcGw7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEF1ZGlvVGFnSW1wbDtcclxudmFyIEF1ZGlvU3RhdHVzO1xyXG4oZnVuY3Rpb24gKEF1ZGlvU3RhdHVzKSB7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9veS4rVxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIkxPQURJTkdcIl0gPSAwXSA9IFwiTE9BRElOR1wiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDlt7LmmoLlgZxcclxuICAgICAqL1xyXG4gICAgQXVkaW9TdGF0dXNbQXVkaW9TdGF0dXNbXCJQQVVTRURcIl0gPSAxXSA9IFwiUEFVU0VEXCI7XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvuS4rVxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIlBMQVlJTkdcIl0gPSAyXSA9IFwiUExBWUlOR1wiO1xyXG59KShBdWRpb1N0YXR1cyB8fCAoQXVkaW9TdGF0dXMgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9UYWdJbXBsLmpzXG4vLyBtb2R1bGUgaWQgPSA0NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzBcclxuICpcclxuICog6Z+z6aKR5raI5oGvXHJcbiovXHJcbnZhciBBdWRpb01lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdWRpb01lc3NhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOmfs+mikeWKoOi9veW8gOWni+S6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWVzc2FnZS5BVURJT19MT0FEX1NUQVJURUQgPSBcImF1ZGlvTG9hZFN0YXJ0ZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog6Z+z6aKR5Yqg6L295a6M5q+V5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgQXVkaW9NZXNzYWdlLkFVRElPX0xPQURfRU5ERUQgPSBcImF1ZGlvTG9hZEVuZGVkXCI7XHJcbiAgICAvKipcclxuICAgICAqIOmfs+mikeaSreaUvuW8gOWni+S6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1NUQVJURUQgPSBcImF1ZGlvUGxheVN0YXJ0ZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog6Z+z6aKR5pKt5pS+5YGc5q2i5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfU1RPUFBFRCA9IFwiYXVkaW9QbGF5U3RvcHBlZFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDpn7PpopHmkq3mlL7lrozmr5Xkuovku7ZcclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9FTkRFRCA9IFwiYXVkaW9QbGF5RW5kZWRcIjtcclxuICAgIC8qKlxyXG4gICAgICog6Z+z6aKR5pKt5pS+6L+b5bqm5LqL5Lu2XHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfUFJPR1JFU1MgPSBcImF1ZGlvUGxheVByb2dyZXNzXCI7XHJcbiAgICAvKipcclxuICAgICAqIOmfs+mikemUmeivr+S6i+S7tlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWVzc2FnZS5BVURJT19FUlJPUiA9IFwiYXVkaW9FcnJvclwiO1xyXG4gICAgcmV0dXJuIEF1ZGlvTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQXVkaW9NZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA0N1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTgtMDEtMDhcclxuICogQG1vZGlmeSBkYXRlIDIwMTgtMDEtMDhcclxuICpcclxuICog5byV5pOO5raI5oGv57G75Z6LXHJcbiovXHJcbnZhciBFbmdpbmVNZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW5naW5lTWVzc2FnZSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5byV5pOO5Yid5aeL5YyW5a6M5q+V5raI5oGvXHJcbiAgICAgKlxyXG4gICAgICogQHN0YXRpY1xyXG4gICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAqIEBtZW1iZXJvZiBFbmdpbmVNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIEVuZ2luZU1lc3NhZ2UuSU5JVElBTElaRUQgPSBcImluaXRpYWxpemVkXCI7XHJcbiAgICByZXR1cm4gRW5naW5lTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRW5naW5lTWVzc2FnZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL21lc3NhZ2UvRW5naW5lTWVzc2FnZS5qc1xuLy8gbW9kdWxlIGlkID0gNDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fbWV0YWRhdGEgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XHJcbn07XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci9jb3JlL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9lbnYvSGFzaFwiLCBcIm9seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3JcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBJbmplY3Rvcl8xLCBIYXNoXzEsIEluamVjdG9yXzIpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgdmFyIElGdWNrTW9kZWwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gSUZ1Y2tNb2RlbCgpIHtcclxuICAgICAgICB9XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KElGdWNrTW9kZWwucHJvdG90eXBlLCBcImZ1Y2tcIiwge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gSUZ1Y2tNb2RlbDtcclxuICAgIH0oKSk7XHJcbiAgICBleHBvcnRzLklGdWNrTW9kZWwgPSBJRnVja01vZGVsO1xyXG4gICAgdmFyIEZ1Y2tNb2RlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmdW5jdGlvbiBGdWNrTW9kZWwoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2Z1Y2sgPSBcIkZ1Y2tcIjtcclxuICAgICAgICAgICAgdGhpcy5zaGl0ID0gXCJTaGl0XCI7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRnVjayBNb2RlbCBDb25zdHJ1Y3RlZCFcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGdWNrTW9kZWwucHJvdG90eXBlLCBcImZ1Y2tcIiwge1xyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9mdWNrO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZnVjayA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICBGdWNrTW9kZWwucHJvdG90eXBlLmZ1Y2tZb3UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIk95ZSFcIjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkluamVjdCxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhhc2hfMS5kZWZhdWx0KVxyXG4gICAgICAgIF0sIEZ1Y2tNb2RlbC5wcm90b3R5cGUsIFwiaGFzaFwiLCB2b2lkIDApO1xyXG4gICAgICAgIEZ1Y2tNb2RlbCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLk1vZGVsQ2xhc3MoMSwgSUZ1Y2tNb2RlbCksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcclxuICAgICAgICBdLCBGdWNrTW9kZWwpO1xyXG4gICAgICAgIHJldHVybiBGdWNrTW9kZWw7XHJcbiAgICB9KCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gRnVja01vZGVsO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pUm5WamEwMXZaR1ZzTG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lSblZqYTAxdlpHVnNMblJ6SWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3T3pzN096czdPenM3T3p0SlFVbEJPMUZCUVVFN1VVRk5RU3hEUVVGRE8xRkJTa2NzYzBKQlFWY3NORUpCUVVrN2FVSkJRV1k3WjBKQlJVa3NUMEZCVHl4SlFVRkpMRU5CUVVNN1dVRkRhRUlzUTBGQlF6czdPMWRCUVVFN1VVRkRUQ3hwUWtGQlF6dEpRVUZFTEVOQlFVTXNRVUZPUkN4SlFVMURPMGxCVGxrc1owTkJRVlU3U1VGVGRrSTdVVUZwUWtrN1dVRmFVU3hWUVVGTExFZEJRVlVzVFVGQlRTeERRVUZETzFsQlZYWkNMRk5CUVVrc1IwRkJWU3hOUVVGTkxFTkJRVU03V1VGSmVFSXNUMEZCVHl4RFFVRkRMRWRCUVVjc1EwRkJReXg1UWtGQmVVSXNRMEZCUXl4RFFVRkRPMUZCUXpORExFTkJRVU03VVVGa1JDeHpRa0ZCVnl3eVFrRkJTVHRwUWtGQlpqdG5Ra0ZGU1N4UFFVRlBMRWxCUVVrc1EwRkJReXhMUVVGTExFTkJRVU03V1VGRGRFSXNRMEZCUXp0cFFrRkRSQ3hWUVVGblFpeExRVUZaTzJkQ1FVVjRRaXhKUVVGSkxFTkJRVU1zUzBGQlN5eEhRVUZITEV0QlFVc3NRMEZCUXp0WlFVTjJRaXhEUVVGRE96czdWMEZLUVR0UlFXRk5MREpDUVVGUExFZEJRV1E3V1VGRlNTeFBRVUZQTEUxQlFVMHNRMEZCUXp0UlFVTnNRaXhEUVVGRE8xRkJkRUpFTzFsQlJFTXNhVUpCUVUwN2MwTkJRMDBzWTBGQlNUc3JRMEZCUXp0UlFVaEVMRk5CUVZNN1dVRkVOMElzY1VKQlFWVXNRMEZCUXl4RFFVRkRMRVZCUVVVc1ZVRkJWU3hEUVVGRE96dFhRVU5NTEZOQlFWTXNRMEV3UWpkQ08xRkJRVVFzWjBKQlFVTTdTMEZCUVN4QlFURkNSQ3hKUVRCQ1F6dHpRa0V4UW05Q0xGTkJRVk1pZlE9PVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9tb2RlbHMvRnVja01vZGVsLnRzXG4vLyBtb2R1bGUgaWQgPSA0OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTA2XHJcbiAqXHJcbiAqIEhhc2jnsbvmmK/lnLDlnYDot6/nlLHvvIjnvZHpobXlk4jluIzvvInnrqHnkIblmajvvIzop4Tlrprlk4jluIzmoLzlvI/kuLrvvJojW+aooeWdl+WQjV0/W+WPguaVsOWQjV09W+WPguaVsOWAvF0mW+WPguaVsOWQjV09W+WPguaVsOWAvF0mLi4uXHJcbiovXHJcbnZhciBIYXNoID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSGFzaCgpIHtcclxuICAgICAgICB0aGlzLl9rZWVwSGFzaCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2hhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaDtcclxuICAgICAgICB0aGlzLl9tb2R1bGVEYXRhRGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX21vZHVsZURhdGFzID0gW107XHJcbiAgICAgICAgdmFyIHJlZyA9IC8jKFteXFw/JiNdKyk/KFxcPyhbXlxcPyY9I10rPVteXFw/Jj0jXSspKCYoW15cXD8mPSNdKz1bXlxcPyY9I10rKSkqKT8vZztcclxuICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgIHdoaWxlIChyZXN1bHQgPSByZWcuZXhlYyh0aGlzLl9oYXNoKSkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IHJlc3VsdFsxXSxcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge30sXHJcbiAgICAgICAgICAgICAgICBkaXJlY3Q6IGZhbHNlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIOino+aekOaooeWdl+WPguaVsFxyXG4gICAgICAgICAgICB2YXIgcGFyYW1zU3RyID0gcmVzdWx0WzJdO1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zU3RyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHBhcmFtc1N0ciA9IHBhcmFtc1N0ci5zdWJzdHIoMSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1zID0gcGFyYW1zU3RyLnNwbGl0KFwiJlwiKTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBwYXJhbXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFpciA9IHBhcmFtc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFpciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcGFpci5zcGxpdChcIj1cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmUruWSjOWAvOmDveimgeWBmuS4gOasoVVSTOino+eggVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gZGVjb2RlVVJJQ29tcG9uZW50KHRlbXBbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBkZWNvZGVVUklDb21wb25lbnQodGVtcFsxXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucGFyYW1zW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8g5aSE55CGZGlyZWN05Y+C5pWwXHJcbiAgICAgICAgICAgIGRhdGEuZGlyZWN0ID0gKGRhdGEucGFyYW1zLmRpcmVjdCA9PSBcInRydWVcIik7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhLnBhcmFtcy5kaXJlY3Q7XHJcbiAgICAgICAgICAgIC8vIOWkhOeQhmtlZXBIYXNo5Y+C5pWwXHJcbiAgICAgICAgICAgIHRoaXMuX2tlZXBIYXNoID0gdGhpcy5fa2VlcEhhc2ggfHwgKGRhdGEucGFyYW1zLmtlZXBIYXNoID09IFwidHJ1ZVwiKTtcclxuICAgICAgICAgICAgZGVsZXRlIGRhdGEucGFyYW1zLmtlZXBIYXNoO1xyXG4gICAgICAgICAgICAvLyDorrDlvZXmqKHlnZfot7PovazmlbDmja5cclxuICAgICAgICAgICAgdGhpcy5fbW9kdWxlRGF0YURpY3RbZGF0YS5uYW1lXSA9IGRhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZHVsZURhdGFzLnB1c2goZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOWmguaenGtlZXBIYXNo5LiN5pivdHJ1Ze+8jOWImeenu+mZpOWTiOW4jOWAvFxyXG4gICAgICAgIGlmICghdGhpcy5fa2VlcEhhc2gpIHtcclxuICAgICAgICAgICAgLy8g6KaB5L2/55Sod2luZG93LmxvY2F0aW9uLnJlcGxhY2Xmlrnms5XvvIzkuI3og73nm7TmjqXorr7nva5oYXNo5bGe5oCn77yM5ZCm5YiZ5Lya5Lqn55Sf5Y6G5Y+y6K6w5b2VXHJcbiAgICAgICAgICAgIHZhciB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdXJsLmluZGV4T2YoXCIjXCIpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPj0gMClcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHVybC5zdWJzdHIoMCwgaW5kZXggKyAxKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEhhc2gucHJvdG90eXBlLCBcImhhc2hcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluWOn+Wni+eahOWTiOW4jOWtl+espuS4slxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgSGFzaFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faGFzaDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIYXNoLnByb3RvdHlwZSwgXCJtb2R1bGVEYXRhc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5qih5Z2X6Lez6L2s5pWw5o2u5pWw57uEXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SUhhc2hNb2R1bGVEYXRhW119XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEhhc2hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vZHVsZURhdGFzO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEhhc2gucHJvdG90eXBlLCBcImZpcnN0TW9kdWxlUGFyYW1zXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bkvKDpgJLnu5npppbmqKHlnZfnmoTlj4LmlbDvvIzpppbmqKHlnZfmlbDmja7nmoTkvKDpgJLmlrnlvI/kuLrkvY3kuo7nrKzkuIDkuKoj5ZCO5LiU5LiN5aGr5YaZ5qih5Z2X5ZCNXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7Kn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgSGFzaFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX21vZHVsZURhdGFzWzBdO1xyXG4gICAgICAgICAgICBpZiAoIWRhdGEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAvLyDlpoLmnpzkvKDpgJLnmoTnrKzkuIDkuKrmqKHlnZfmnInlkI3lrZfvvIzliJnkuI3orqTkuLrmmK/kvKDpgJLnu5npppbmqKHlnZfnmoRcclxuICAgICAgICAgICAgcmV0dXJuIChkYXRhLm5hbWUgPyB1bmRlZmluZWQgOiBkYXRhLnBhcmFtcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSGFzaC5wcm90b3R5cGUsIFwia2VlcEhhc2hcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaYr+WQpuS/neaMgeWTiOW4jOWAvFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEhhc2hcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2tlZXBIYXNoO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bmjIflrprlk4jluIzlj4LmlbBcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IOWPguaVsOWQjVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFttb2R1bGVOYW1lXSDlj4LmlbDmiYDlsZ7mqKHlnZflkI3vvIzkuI3kvKDliJnojrflj5bnrKzkuIDkuKrmqKHlnZfnmoTlj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IOWPguaVsOWAvFxyXG4gICAgICogQG1lbWJlcm9mIEhhc2hcclxuICAgICAqL1xyXG4gICAgSGFzaC5wcm90b3R5cGUuZ2V0UGFyYW0gPSBmdW5jdGlvbiAoa2V5LCBtb2R1bGVOYW1lKSB7XHJcbiAgICAgICAgdmFyIGRhdGEgPSAobW9kdWxlTmFtZSA/IHRoaXMuX21vZHVsZURhdGFEaWN0W21vZHVsZU5hbWVdIDogdGhpcy5fbW9kdWxlRGF0YXNbMF0pO1xyXG4gICAgICAgIHJldHVybiAoZGF0YSAmJiBkYXRhLnBhcmFtc1trZXldKTtcclxuICAgIH07XHJcbiAgICBIYXNoID0gdHNsaWJfMS5fX2RlY29yYXRlKFtcclxuICAgICAgICBJbmplY3RhYmxlLFxyXG4gICAgICAgIHRzbGliXzEuX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtdKVxyXG4gICAgXSwgSGFzaCk7XHJcbiAgICByZXR1cm4gSGFzaDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgSGFzaDtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGhhc2ggPSBjb3JlLmdldEluamVjdChIYXNoKTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2Vudi9IYXNoLmpzXG4vLyBtb2R1bGUgaWQgPSA1MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi4vdHlwZS9UZXN0XCIsIFwib2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVzcG9uc2VEYXRhXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9uZXQvTmV0TWFuYWdlclwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFRlc3RfMSwgUmVzcG9uc2VEYXRhXzEsIE5ldE1hbmFnZXJfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICAvKipcclxuICAgICAqIEBhdXRob3IgVGVtcGxhdGVHZW5lcmF0b3JcclxuICAgICAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAgICAgKiBAbW9kaWZ5IGRhdGUgMTAvOS8yMDE3XHJcbiAgICAgKlxyXG4gICAgICog5rWL6K+VXHJcbiAgICAqL1xyXG4gICAgdmFyIFRlc3RSZXNwb25zZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgICAgICBfX2V4dGVuZHMoVGVzdFJlc3BvbnNlLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RSZXNwb25zZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGVzdFJlc3BvbnNlLnByb3RvdHlwZSwgXCJfX3BhcmFtc1wiLCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlRlc3RcIixcclxuICAgICAgICAgICAgICAgICAgICBwcm90b2NvbDogXCJodHRwXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICA7XHJcbiAgICAgICAgVGVzdFJlc3BvbnNlLnByb3RvdHlwZS5kb1BhcnNlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5fX3BhcmFtcy5zdWNjZXNzID0gZGF0YS5zdWNjZXNzO1xyXG4gICAgICAgICAgICB0aGlzLnRlc3QgPSBuZXcgVGVzdF8xLmRlZmF1bHQoKS5wYXJzZShkYXRhLnRlc3QpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGVzdFJlc3BvbnNlLnByb3RvdHlwZS5wYWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgdGVzdDogdGhpcy50ZXN0LnBhY2soKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgVGVzdFJlc3BvbnNlLnR5cGUgPSBcIlRlc3RcIjtcclxuICAgICAgICByZXR1cm4gVGVzdFJlc3BvbnNlO1xyXG4gICAgfShSZXNwb25zZURhdGFfMS5kZWZhdWx0KSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBUZXN0UmVzcG9uc2U7XHJcbiAgICAvKiog5rOo5YaM6L+U5Zue5L2TICovXHJcbiAgICBOZXRNYW5hZ2VyXzEubmV0TWFuYWdlci5yZWdpc3RlclJlc3BvbnNlKFRlc3RSZXNwb25zZSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEZKbGMzQnZibk5sTG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lWR1Z6ZEZKbGMzQnZibk5sTG5SeklsMHNJbTVoYldWeklqcGJYU3dpYldGd2NHbHVaM01pT2lJN096czdPenM3T3pzN096czdTVUZKUVRzN096czdPMDFCVFVVN1NVRkRSanRSUVVFd1F5eG5RMEZCV1R0UlFVRjBSRHM3VVVGclEwRXNRMEZCUXp0UlFYaENSeXh6UWtGQlZ5eHJRMEZCVVR0cFFrRkJia0k3WjBKQlJVa3NUMEZCVHp0dlFrRkRTQ3hKUVVGSkxFVkJRVVVzVFVGQlRUdHZRa0ZEV2l4UlFVRlJMRVZCUVVVc1RVRkJUVHR2UWtGRGFFSXNUVUZCVFN4RlFVRkZMRXRCUVVzN2FVSkJRMmhDTEVOQlFVTTdXVUZEVGl4RFFVRkRPenM3VjBGQlFUdFJRVUZCTEVOQlFVTTdVVUZKVVN3NFFrRkJUeXhIUVVGcVFpeFZRVUZyUWl4SlFVRlJPMWxCUlhSQ0xFbEJRVWNzU1VGQlNTeEpRVUZKTEVsQlFVazdaMEpCUVVVc1QwRkJUenRaUVVONFFpeEpRVUZKTEVOQlFVTXNVVUZCVVN4RFFVRkRMRTlCUVU4c1IwRkJSeXhKUVVGSkxFTkJRVU1zVDBGQlR5eERRVUZETzFsQlEzSkRMRWxCUVVrc1EwRkJReXhKUVVGSkxFZEJRVk1zU1VGQlNTeGpRVUZKTEVWQlFVVXNRMEZCUXl4TFFVRkxMRU5CUVVNc1NVRkJTU3hEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETzFGQlEyeEVMRU5CUVVNN1VVRkZUU3d5UWtGQlNTeEhRVUZZTzFsQlJVa3NUMEZCVHp0blFrRkRTQ3hKUVVGSkxFVkJRVVVzU1VGQlNTeERRVUZETEVsQlFVa3NRMEZCUXl4SlFVRkpMRVZCUVVVN1lVRkRla0lzUTBGQlF6dFJRVU5PTEVOQlFVTTdVVUZrWVN4cFFrRkJTU3hIUVVGVkxFMUJRVTBzUTBGQlF6dFJRV1YyUXl4dFFrRkJRenRMUVVGQkxFRkJiRU5FTEVOQlFUQkRMSE5DUVVGWkxFZEJhME55UkR0elFrRnNRMjlDTEZsQlFWazdTVUZ2UTJwRExGbEJRVms3U1VGRFdpeDFRa0ZCVlN4RFFVRkRMR2RDUVVGblFpeERRVUZETEZsQlFWa3NRMEZCUXl4RFFVRkRJbjA9XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25ldC9yZXNwb25zZS9UZXN0UmVzcG9uc2UudHNcbi8vIG1vZHVsZSBpZCA9IDUxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcclxufTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lZGlhdG9yXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci1lZ3JldC9lZ3JldC9pbmplY3Rvci9JbmplY3RvclwiLCBcIi4vVGVzdENvbXBcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNYW5hZ2VyXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgU2NlbmVNZWRpYXRvcl8xLCBJbmplY3Rvcl8xLCBJbmplY3Rvcl8yLCBUZXN0Q29tcF8xLCBNb2R1bGVNYW5hZ2VyXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAYXV0aG9yIFJheWtpZFxyXG4gICAgICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICAgICAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTE4XHJcbiAgICAgKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gICAgICpcclxuICAgICAqIOa1i+ivleesrOS6jOS4quaooeWdl1xyXG4gICAgKi9cclxuICAgIHZhciBTZWNvbmQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFNlY29uZCwgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBTZWNvbmQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgU2Vjb25kLnByb3RvdHlwZS5saXN0QXNzZXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW1wicHJlbG9hZFwiXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFNlY29uZC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLm1hcExpc3RlbmVyKHRoaXMuYnRuLCBlZ3JldC5Ub3VjaEV2ZW50LlRPVUNIX1RBUCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbW9kdWxlTWFuYWdlci5jbG9zZShTZWNvbmQpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuZGlzcGF0Y2goXCJGdWNrTXNnXCIsIFwiU2hpdCEhIVwiKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld01vZGVsID0ge1xyXG4gICAgICAgICAgICAgICAgb25Nc2c6IGZ1bmN0aW9uIChtc2cpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDooajovr7lvI/ph4zkvb/nlKjlh73mlbDlj6/ku6XlnKjlh73mlbDph4zmiafooYzlpI3mnYLpgLvovpHvvIzlubbkuJTlhbfmnInku6PnoIHmj5DnpLpcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtc2cpO1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZHVsZU1hbmFnZXJfMS5tb2R1bGVNYW5hZ2VyLmNsb3NlKF90aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbXNnICsgXCIgLSAxXCI7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVjazogXCJ5b3VcIixcclxuICAgICAgICAgICAgICAgIGZ1Y2tMaXN0OiBbXCJmdWNrXCIsIFwic2hpdFwiLCBcInlvdVwiLCBcIiEhIVwiXVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAvLyDmtYvor5Xmtojmga9cclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaChcImZ1Y2tcIiwgMTIzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFNlY29uZC5wcm90b3R5cGUub25GdWNrID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXNzYWdlIGF0IFNlY29uZDogXCIgKyBhKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFNlY29uZC5wcm90b3R5cGUub25UZXN0Q29tcE1zZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUZXN0Q29tcE1zZyBSZWNlaXZlZFwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFNlY29uZC5wcm90b3R5cGUub25UZXN0Q29tcE1zZ0dsb2JhbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUZXN0Q29tcE1zZyBSZWNlaXZlZCBHbG9iYWxcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBTZWNvbmQubW9kdWxlTmFtZSA9IFwiU2Vjb25kXCI7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuU3ViTWVkaWF0b3IsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBUZXN0Q29tcF8xLmRlZmF1bHQpXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJfdGVzdENvbXBcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5CaW5kTWVzc2FnZShcIkZ1Y2tNc2dcIiwgeyBsYWJlbDogXCJvbk1zZygkYXJndW1lbnRzWzBdKVwiIH0pLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRGdW5jKFwiZ2V0Q3VycmVudFN0YXRlXCIsIFtcImZ1Y2tcIiwgXCJvbk1zZ1wiLCB1bmRlZmluZWRdKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIGV1aS5CdXR0b24pXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJidG5cIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5CaW5kRm9yKFwiaSBvZiBmdWNrTGlzdC5jb25jYXQoZnVja0xpc3QpLmNvbmNhdChmdWNrTGlzdCkuY29uY2F0KGZ1Y2tMaXN0KVwiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5CaW5kVmFsdWUoXCJ0eHQudGV4dFwiLCBmdW5jdGlvbiAoc2NvcGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS5pO1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5CaW5kRm9yKFwibHN0XCIsIFwiaiBvZiBmdWNrTGlzdFwiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5CaW5kVmFsdWUoe1xyXG4gICAgICAgICAgICAgICAgdHh0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogXCInaT0nICsgaSArICcgJiAnICsgJ2o9JyArIGpcIlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIGV1aS5EYXRhR3JvdXApXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJsc3RcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5NZXNzYWdlSGFuZGxlcihcImZ1Y2tcIiksXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuR2xvYmFsTWVzc2FnZUhhbmRsZXIoXCJmdWNrXCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVuY3Rpb24pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnBhcmFtdHlwZXNcIiwgW09iamVjdF0pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxyXG4gICAgICAgIF0sIFNlY29uZC5wcm90b3R5cGUsIFwib25GdWNrXCIsIG51bGwpO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLk1lc3NhZ2VIYW5kbGVyKFwiVGVzdENvbXBNc2dcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJvblRlc3RDb21wTXNnXCIsIG51bGwpO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkdsb2JhbE1lc3NhZ2VIYW5kbGVyKFwiVGVzdENvbXBNc2dcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXHJcbiAgICAgICAgXSwgU2Vjb25kLnByb3RvdHlwZSwgXCJvblRlc3RDb21wTXNnR2xvYmFsXCIsIG51bGwpO1xyXG4gICAgICAgIFNlY29uZCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkVncmV0TWVkaWF0b3JDbGFzcyhcIlNlY29uZFwiLCBcIkZ1Y2syU2tpblwiKVxyXG4gICAgICAgIF0sIFNlY29uZCk7XHJcbiAgICAgICAgcmV0dXJuIFNlY29uZDtcclxuICAgIH0oU2NlbmVNZWRpYXRvcl8xLmRlZmF1bHQpKTtcclxuICAgIGV4cG9ydHMuZGVmYXVsdCA9IFNlY29uZDtcclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVUyVmpiMjVrTG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lVMlZqYjI1a0xuUnpJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3U1VGTlFUczdPenM3T3p0TlFVOUZPMGxCUjBZN1VVRkJiME1zTUVKQlFXRTdVVUZCYWtRN08xRkJhMFZCTEVOQlFVTTdVVUUxUTFVc01rSkJRVlVzUjBGQmFrSTdXVUZGU1N4UFFVRlBMRU5CUVVNc1UwRkJVeXhEUVVGRExFTkJRVU03VVVGRGRrSXNRMEZCUXp0UlFVVk5MSFZDUVVGTkxFZEJRV0k3V1VGQlFTeHBRa0Z0UWtNN1dVRnFRa2NzU1VGQlNTeERRVUZETEZkQlFWY3NRMEZCUXl4SlFVRkpMRU5CUVVNc1IwRkJSeXhGUVVGRkxFdEJRVXNzUTBGQlF5eFZRVUZWTEVOQlFVTXNVMEZCVXl4RlFVRkZPMmRDUVVOdVJDd3JRa0ZCSzBJN1owSkJSUzlDTEV0QlFVa3NRMEZCUXl4UlFVRlJMRU5CUVVNc1UwRkJVeXhGUVVGRkxGTkJRVk1zUTBGQlF5eERRVUZETzFsQlEzaERMRU5CUVVNc1EwRkJReXhEUVVGRE8xbEJRMGdzU1VGQlNTeERRVUZETEZOQlFWTXNSMEZCUnp0blFrRkRZaXhMUVVGTExFVkJRVVVzVlVGQlFTeEhRVUZITzI5Q1FVTk9MR2REUVVGblF6dHZRa0ZEYUVNc1QwRkJUeXhEUVVGRExFZEJRVWNzUTBGQlF5eEhRVUZITEVOQlFVTXNRMEZCUXp0dlFrRkRha0lzTmtKQlFXRXNRMEZCUXl4TFFVRkxMRU5CUVVNc1MwRkJTU3hEUVVGRExFTkJRVU03YjBKQlF6RkNMRTlCUVU4c1IwRkJSeXhIUVVGSExFMUJRVTBzUTBGQlF6dG5Ra0ZEZUVJc1EwRkJRenRuUWtGRFJDeEpRVUZKTEVWQlFVVXNTMEZCU3p0blFrRkRXQ3hSUVVGUkxFVkJRVVVzUTBGQlF5eE5RVUZOTEVWQlFVVXNUVUZCVFN4RlFVRkZMRXRCUVVzc1JVRkJSU3hMUVVGTExFTkJRVU03WVVGRE0wTXNRMEZCUXp0WlFVTkdMRTlCUVU4N1dVRkRVQ3hKUVVGSkxFTkJRVU1zVVVGQlVTeERRVUZETEUxQlFVMHNSVUZCUlN4SFFVRkhMRU5CUVVNc1EwRkJRenRSUVVNdlFpeERRVUZETzFGQlNVOHNkVUpCUVUwc1IwRkJaQ3hWUVVGbExFTkJRVU03V1VGRldpeFBRVUZQTEVOQlFVTXNSMEZCUnl4RFFVRkRMSEZDUVVGeFFpeEhRVUZITEVOQlFVTXNRMEZCUXl4RFFVRkRPMUZCUXpORExFTkJRVU03VVVGSFR5dzRRa0ZCWVN4SFFVRnlRanRaUVVWSkxFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNjMEpCUVhOQ0xFTkJRVU1zUTBGQlF6dFJRVU40UXl4RFFVRkRPMUZCUjA4c2IwTkJRVzFDTEVkQlFUTkNPMWxCUlVrc1QwRkJUeXhEUVVGRExFZEJRVWNzUTBGQlF5dzJRa0ZCTmtJc1EwRkJReXhEUVVGRE8xRkJReTlETEVOQlFVTTdVVUV2UkdFc2FVSkJRVlVzUjBGQlZTeFJRVUZSTEVOQlFVTTdVVUZITTBNN1dVRkVReXh6UWtGQlZ6dHpRMEZEVFN4clFrRkJVVHRwUkVGQlF6dFJRVWt6UWp0WlFVWkRMSE5DUVVGWExFTkJRVU1zVTBGQlV5eEZRVUZGTEVWQlFVTXNTMEZCU3l4RlFVRkZMSE5DUVVGelFpeEZRVUZETEVOQlFVTTdXVUZEZGtRc2JVSkJRVkVzUTBGQlF5eHBRa0ZCYVVJc1JVRkJSU3hEUVVGRExFMUJRVTBzUlVGQlJTeFBRVUZQTEVWQlFVVXNVMEZCVXl4RFFVRkRMRU5CUVVNN2MwTkJReTlETEVkQlFVY3NRMEZCUXl4TlFVRk5PekpEUVVGRE8xRkJWM1JDTzFsQlZrTXNhMEpCUVU4c1EwRkJReXhyUlVGQmEwVXNRMEZCUXp0WlFVTXpSU3h2UWtGQlV5eERRVUZETEZWQlFWVXNSVUZCUlN4VlFVRlRMRXRCUVZNN1owSkJRM0pETEU5QlFVOHNTMEZCU3l4RFFVRkRMRU5CUVVNc1EwRkJRenRaUVVOdVFpeERRVUZETEVOQlFVTTdXVUZEUkN4clFrRkJUeXhEUVVGRExFdEJRVXNzUlVGQlJTeGxRVUZsTEVOQlFVTTdXVUZETDBJc2IwSkJRVk1zUTBGQlF6dG5Ra0ZEVUN4SFFVRkhMRVZCUVVVN2IwSkJRMFFzU1VGQlNTeEZRVUZGTERaQ1FVRTJRanRwUWtGRGRFTTdZVUZEU2l4RFFVRkRPM05EUVVOVExFZEJRVWNzUTBGQlF5eFRRVUZUT3pKRFFVRkRPMUZCT0VKNlFqdFpRVVpETEhsQ1FVRmpMRU5CUVVNc1RVRkJUU3hEUVVGRE8xbEJRM1JDTEN0Q1FVRnZRaXhEUVVGRExFMUJRVTBzUTBGQlF6czdPenMwUTBGSk5VSTdVVUZIUkR0WlFVUkRMSGxDUVVGakxFTkJRVU1zWVVGQllTeERRVUZET3pzN08yMUVRVWszUWp0UlFVZEVPMWxCUkVNc0swSkJRVzlDTEVOQlFVTXNZVUZCWVN4RFFVRkRPenM3TzNsRVFVbHVRenRSUVdwRlowSXNUVUZCVFR0WlFVUXhRaXcyUWtGQmEwSXNRMEZCUXl4UlFVRlJMRVZCUVVVc1YwRkJWeXhEUVVGRE8xZEJRM0pDTEUxQlFVMHNRMEZyUlRGQ08xRkJRVVFzWVVGQlF6dExRVUZCTEVGQmJFVkVMRU5CUVc5RExIVkNRVUZoTEVkQmEwVm9SRHR6UWtGc1JXOUNMRTFCUVUwaWZRPT1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kdWxlcy9TZWNvbmQudHNcbi8vIG1vZHVsZSBpZCA9IDUyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGxpc3RlbkNvbnN0cnVjdCB9IGZyb20gXCJvbHltcHVzLXIvdXRpbHMvQ29uc3RydWN0VXRpbFwiO1xyXG5pbXBvcnQgeyBNZWRpYXRvckNsYXNzIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTA5XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTA5XHJcbiAqXHJcbiAqIOi0n+i0o+azqOWFpeeahOaooeWdl1xyXG4qL1xyXG5leHBvcnQgZnVuY3Rpb24gRWdyZXRTa2luKHNraW4pIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XHJcbiAgICAgICAgLy8g55uR5ZCs57G75Z6L5a6e5L6L5YyW77yM6L2s5o2i55qu6IKk5qC85byPXHJcbiAgICAgICAgbGlzdGVuQ29uc3RydWN0KGNscywgZnVuY3Rpb24gKG1lZGlhdG9yKSB7IHJldHVybiBtZWRpYXRvci5za2luID0gc2tpbjsgfSk7XHJcbiAgICB9O1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBFZ3JldE1lZGlhdG9yQ2xhc3MobW9kdWxlTmFtZSwgc2tpbikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjbHMpIHtcclxuICAgICAgICAvLyDosIPnlKhNZWRpYXRvckNsYXNz5pa55rOVXHJcbiAgICAgICAgY2xzID0gTWVkaWF0b3JDbGFzcyhtb2R1bGVOYW1lKShjbHMpO1xyXG4gICAgICAgIC8vIOebkeWQrOexu+Wei+WunuS+i+WMlu+8jOi9rOaNouearuiCpOagvOW8j1xyXG4gICAgICAgIGxpc3RlbkNvbnN0cnVjdChjbHMsIGZ1bmN0aW9uIChtZWRpYXRvcikgeyByZXR1cm4gbWVkaWF0b3Iuc2tpbiA9IHNraW47IH0pO1xyXG4gICAgICAgIC8vIOi/lOWbnue7k+aenOexu+Wei1xyXG4gICAgICAgIHJldHVybiBjbHM7XHJcbiAgICB9O1xyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L2luamVjdG9yL0luamVjdG9yLmpzXG4vLyBtb2R1bGUgaWQgPSA1M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fbWV0YWRhdGEgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XHJcbn07XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci9lbmdpbmUvaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL3BhbmVsL1BhbmVsTWVkaWF0b3JcIiwgXCJvbHltcHVzLXItZG9tL2RvbS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1hbmFnZXJcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBJbmplY3Rvcl8xLCBQYW5lbE1lZGlhdG9yXzEsIEluamVjdG9yXzIsIE1vZHVsZU1hbmFnZXJfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICB2YXIgVGVzdFBhbmVsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgICAgIF9fZXh0ZW5kcyhUZXN0UGFuZWwsIF9zdXBlcik7XHJcbiAgICAgICAgZnVuY3Rpb24gVGVzdFBhbmVsKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFRlc3RQYW5lbF8xID0gVGVzdFBhbmVsO1xyXG4gICAgICAgIFRlc3RQYW5lbC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBNb2R1bGVNYW5hZ2VyXzEubW9kdWxlTWFuYWdlci5jbG9zZShUZXN0UGFuZWxfMSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgVGVzdFBhbmVsXzE7XHJcbiAgICAgICAgVGVzdFBhbmVsLm1vZHVsZU5hbWUgPSBcIlRlc3RQYW5lbFwiO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkJpbmRPbihcImNsaWNrXCIsIFwib25DbGlja1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIFRlc3RQYW5lbC5wcm90b3R5cGUsIFwic2tpblwiLCB2b2lkIDApO1xyXG4gICAgICAgIFRlc3RQYW5lbCA9IFRlc3RQYW5lbF8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuRE9NTWVkaWF0b3JDbGFzcyhcIlRlc3RQYW5lbFwiLCBcIlxcbiAgICA8ZGl2IHN0eWxlPVxcXCJiYWNrZ3JvdW5kOiNmZmZmZmY7IHdpZHRoOjQwMHB4OyBoZWlnaHQ6IDI1MHB4O1xcXCI+XFxuICAgICAgICBqbGsxMjRrbDFqMlxcbiAgICA8L2Rpdj5cXG5cIilcclxuICAgICAgICBdLCBUZXN0UGFuZWwpO1xyXG4gICAgICAgIHJldHVybiBUZXN0UGFuZWw7XHJcbiAgICB9KFBhbmVsTWVkaWF0b3JfMS5kZWZhdWx0KSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBUZXN0UGFuZWw7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEZCaGJtVnNMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVZHVnpkRkJoYm1Wc0xuUnpJbDBzSW01aGJXVnpJanBiWFN3aWJXRndjR2x1WjNNaU9pSTdPenM3T3pzN096czdPenM3T3pzN096czdPenM3U1VGVlFUdFJRVUYxUXl3MlFrRkJZVHRSUVVGd1JEczdVVUZsUVN4RFFVRkRPM05DUVdadlFpeFRRVUZUTzFGQlQyNUNMREJDUVVGTkxFZEJRV0k3V1VGRlNTeEpRVUZKTEVOQlFVTXNVMEZCVXl4SFFVRkhPMmRDUVVOaUxFOUJRVThzUlVGQlJUdHZRa0ZEVEN3MlFrRkJZU3hEUVVGRExFdEJRVXNzUTBGQlF5eFhRVUZUTEVOQlFVTXNRMEZCUXp0blFrRkRia01zUTBGQlF6dGhRVU5LTEVOQlFVTTdVVUZEVGl4RFFVRkRPenRSUVZwaExHOUNRVUZWTEVkQlFWVXNWMEZCVnl4RFFVRkRPMUZCUnpsRE8xbEJSRU1zYVVKQlFVMHNRMEZCUXl4UFFVRlBMRVZCUVVVc1UwRkJVeXhEUVVGRE8zTkRRVU5tTEZkQlFWYzdLME5CUVVNN1VVRk1VQ3hUUVVGVE8xbEJURGRDTERKQ1FVRm5RaXhEUVVGRExGZEJRVmNzUlVGQlJTd3dSMEZKT1VJc1EwRkJRenRYUVVOdFFpeFRRVUZUTEVOQlpUZENPMUZCUVVRc1owSkJRVU03UzBGQlFTeEJRV1pFTEVOQlFYVkRMSFZDUVVGaExFZEJaVzVFTzNOQ1FXWnZRaXhUUVVGVEluMD1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kdWxlcy9UZXN0UGFuZWwudHNcbi8vIG1vZHVsZSBpZCA9IDU0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwib2x5bXB1cy1yXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSB0eXBlcz1cIm9seW1wdXMtci1kb21cIi8+XHJcbi8vLyA8cmVmZXJlbmNlIHR5cGVzPVwib2x5bXB1cy1yLWVncmV0XCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi9lZ3JldC9saWJzL21vZHVsZXMvZWdyZXQvZWdyZXQuZC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4vZWdyZXQvbGlicy9tb2R1bGVzL3Jlcy9yZXMuZC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4vZWdyZXQvbGlicy9tb2R1bGVzL2V1aS9ldWkuZC50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4vZWdyZXQvbGlicy9tb2R1bGVzL3R3ZWVuL3R3ZWVuLmQudHNcIi8+XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIi4vbW9kdWxlcy9GaXJzdFwiLCBcIm9seW1wdXMtci9PbHltcHVzXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9lbnYvRW52aXJvbm1lbnRcIiwgXCJvbHltcHVzLXItZG9tL0RPTUJyaWRnZVwiLCBcIm9seW1wdXMtci1lZ3JldC9FZ3JldEJyaWRnZVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIEZpcnN0XzEsIE9seW1wdXNfMSwgRW52aXJvbm1lbnRfMSwgRE9NQnJpZGdlXzEsIEVncmV0QnJpZGdlXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAYXV0aG9yIFJheWtpZFxyXG4gICAgICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICAgICAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA4LTMxXHJcbiAgICAgKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wMVxyXG4gICAgICpcclxuICAgICAqIOa1i+ivlemhueebrlxyXG4gICAgKi9cclxuICAgIE9seW1wdXNfMS5kZWZhdWx0LnN0YXJ0dXAoe1xyXG4gICAgICAgIGJyaWRnZXM6IFtcclxuICAgICAgICAgICAgbmV3IERPTUJyaWRnZV8xLmRlZmF1bHQoe1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBcIiNyb290RE9NXCJcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgIG5ldyBFZ3JldEJyaWRnZV8xLmRlZmF1bHQoe1xyXG4gICAgICAgICAgICAgICAgd2lkdGg6IDcyMCxcclxuICAgICAgICAgICAgICAgIGhlaWdodDogMTI4MCxcclxuICAgICAgICAgICAgICAgIHBhdGhQcmVmaXg6IFwiZWdyZXQvXCIsXHJcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IFwiI3Jvb3RFZ3JldFwiLFxyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAwLFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgZmlyc3RNb2R1bGU6IEZpcnN0XzEuZGVmYXVsdCxcclxuICAgICAgICBsb2FkRWxlbWVudDogXCIjbG9hZGluZ1wiLFxyXG4gICAgICAgIGhvc3RzRGljdDoge1xyXG4gICAgICAgICAgICBkZXY6IFtcImh0dHA6Ly93d3cudGVzdC4xN3p1b3llLm5ldC9cIl0sXHJcbiAgICAgICAgICAgIHRlc3Q6IFtcImh0dHBzOi8vd3d3LnRlc3QuMTd6dW95ZS5uZXQvXCJdLFxyXG4gICAgICAgICAgICBzdGFnaW5nOiBbXCJodHRwczovL3d3dy5zdGFnaW5nLjE3enVveWUubmV0L1wiXSxcclxuICAgICAgICAgICAgcHJvZDogW1wiaHR0cHM6Ly93d3cuMTd6dW95ZS5jb20vXCJdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjZG5zRGljdDoge1xyXG4gICAgICAgICAgICB0ZXN0OiBbXCJodHRwczovL2Nkbi1jbmMudGVzdC4xN3p1b3llLm5ldC9cIl0sXHJcbiAgICAgICAgICAgIHN0YWdpbmc6IFtcImh0dHBzOi8vY2RuLWNuYy5zdGFnaW5nLjE3enVveWUubmV0L1wiXSxcclxuICAgICAgICAgICAgcHJvZDogW1wiaHR0cHM6Ly9jZG4tY25jLjE3enVveWUuY29tL1wiXVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGF0aERpY3Q6IHtcclxuICAgICAgICAgICAgYTogXCJ0ZXN0MS5qc1wiLFxyXG4gICAgICAgICAgICBiOiBcInRlc3QyLmpzXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHByZWxvYWRzOiBbXCJhXCIsIFwiYlwiXSxcclxuICAgICAgICBvbkluaXRlZDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZShcIkVncmV0XCIpLmRlZmF1bHRTY2VuZVBvbGljeSA9IG5vbmU7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKEVudmlyb25tZW50XzEuZW52aXJvbm1lbnQuZW52LCBFbnZpcm9ubWVudF8xLmVudmlyb25tZW50LmdldEhvc3QoKSwgRW52aXJvbm1lbnRfMS5lbnZpcm9ubWVudC5jdXJDRE5Ib3N0KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG9uSW5pdFByb2dyZXNzOiBmdW5jdGlvbiAocHJnLCBzdGVwKSB7XHJcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIFtwcmcsIHN0ZXBdLmNvbmNhdChhcmdzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2liV0ZwYmk1cWN5SXNJbk52ZFhKalpWSnZiM1FpT2lJaUxDSnpiM1Z5WTJWeklqcGJJbTFoYVc0dWRITWlYU3dpYm1GdFpYTWlPbHRkTENKdFlYQndhVzVuY3lJNklrRkJRVUVzYTBOQlFXdERPMEZCUTJ4RExITkRRVUZ6UXp0QlFVTjBReXgzUTBGQmQwTTdRVUZEZUVNc05rUkJRVFpFTzBGQlF6ZEVMSGxFUVVGNVJEdEJRVU42UkN4NVJFRkJlVVE3UVVGRGVrUXNOa1JCUVRaRU96czdPMGxCVnpkRU96czdPenM3TzAxQlQwVTdTVUZEUml4cFFrRkJUeXhEUVVGRExFOUJRVThzUTBGQlF6dFJRVU5hTEU5QlFVOHNSVUZCUlR0WlFVTk1MRWxCUVVrc2JVSkJRVk1zUTBGQlF6dG5Ra0ZEVml4VFFVRlRMRVZCUVVVc1ZVRkJWVHRoUVVONFFpeERRVUZETzFsQlEwWXNTVUZCU1N4eFFrRkJWeXhEUVVGRE8yZENRVU5hTEV0QlFVc3NSVUZCUlN4SFFVRkhPMmRDUVVOV0xFMUJRVTBzUlVGQlJTeEpRVUZKTzJkQ1FVTmFMRlZCUVZVc1JVRkJSU3hSUVVGUk8yZENRVU53UWl4VFFVRlRMRVZCUVVVc1dVRkJXVHRuUWtGRGRrSXNaVUZCWlN4RlFVRkZMRU5CUVVNN1lVRkZja0lzUTBGQlF6dFRRVU5NTzFGQlEwUXNWMEZCVnl4RlFVRkZMR1ZCUVVzN1VVRkRiRUlzVjBGQlZ5eEZRVUZGTEZWQlFWVTdVVUZEZGtJc1UwRkJVeXhGUVVGRk8xbEJRMUFzUjBGQlJ5eEZRVUZGTEVOQlFVTXNPRUpCUVRoQ0xFTkJRVU03V1VGRGNrTXNTVUZCU1N4RlFVRkZMRU5CUVVNc0swSkJRU3RDTEVOQlFVTTdXVUZEZGtNc1QwRkJUeXhGUVVGRkxFTkJRVU1zYTBOQlFXdERMRU5CUVVNN1dVRkROME1zU1VGQlNTeEZRVUZGTEVOQlFVTXNNRUpCUVRCQ0xFTkJRVU03VTBGRGNrTTdVVUZEUkN4UlFVRlJMRVZCUVVVN1dVRkRUaXhKUVVGSkxFVkJRVVVzUTBGQlF5eHRRMEZCYlVNc1EwRkJRenRaUVVNelF5eFBRVUZQTEVWQlFVVXNRMEZCUXl4elEwRkJjME1zUTBGQlF6dFpRVU5xUkN4SlFVRkpMRVZCUVVVc1EwRkJReXc0UWtGQk9FSXNRMEZCUXp0VFFVTjZRenRSUVVORUxGRkJRVkVzUlVGQlJUdFpRVU5PTEVOQlFVTXNSVUZCUlN4VlFVRlZPMWxCUTJJc1EwRkJReXhGUVVGRkxGVkJRVlU3VTBGRGFFSTdVVUZEUkN4UlFVRlJMRVZCUVVVc1EwRkJReXhIUVVGSExFVkJRVVVzUjBGQlJ5eERRVUZETzFGQlEzQkNMRkZCUVZFc1JVRkJSVHRaUVVWT0xEaEVRVUU0UkR0WlFVTTVSQ3hQUVVGUExFTkJRVU1zUjBGQlJ5eERRVUZETEhsQ1FVRlhMRU5CUVVNc1IwRkJSeXhGUVVGRkxIbENRVUZYTEVOQlFVTXNUMEZCVHl4RlFVRkZMRVZCUVVVc2VVSkJRVmNzUTBGQlF5eFZRVUZWTEVOQlFVTXNRMEZCUXp0UlFVTm9SaXhEUVVGRE8xRkJRMFFzWTBGQll5eEZRVUZGTEZWQlFVTXNSMEZCVlN4RlFVRkZMRWxCUVdFN1dVRkJSU3hqUVVGUE8ybENRVUZRTEZWQlFVOHNSVUZCVUN4eFFrRkJUeXhGUVVGUUxFbEJRVTg3WjBKQlFWQXNOa0pCUVU4N08xbEJReTlETEU5QlFVOHNRMEZCUXl4SFFVRkhMRTlCUVZnc1QwRkJUeXhIUVVGTExFZEJRVWNzUlVGQlJTeEpRVUZKTEZOQlFVc3NTVUZCU1N4SFFVRkZPMUZCUTNCRExFTkJRVU03UzBGRFNpeERRVUZETEVOQlFVTWlmUT09XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21haW4udHNcbi8vIG1vZHVsZSBpZCA9IDU1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcclxufTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwib2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCJvbHltcHVzLXIvY29yZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NYW5hZ2VyXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1hbmFnZXJcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNZXNzYWdlXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9TY2VuZU1lZGlhdG9yXCIsIFwiLi4vbW9kZWxzL0Z1Y2tNb2RlbFwiLCBcIi4uL25ldC9yZXF1ZXN0L1Rlc3RSZXF1ZXN0XCIsIFwiLi4vbmV0L3Jlc3BvbnNlL1Rlc3RSZXNwb25zZVwiLCBcIi4vU2Vjb25kXCIsIFwiLi9UZXN0Rm9yTWVkaWF0b3JcIiwgXCIuL1RoaXJkXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgSW5qZWN0b3JfMSwgSW5qZWN0b3JfMiwgQXVkaW9NYW5hZ2VyXzEsIEluamVjdG9yXzMsIE1vZHVsZU1hbmFnZXJfMSwgTW9kdWxlTWVzc2FnZV8xLCBTY2VuZU1lZGlhdG9yXzEsIEZ1Y2tNb2RlbF8xLCBUZXN0UmVxdWVzdF8xLCBUZXN0UmVzcG9uc2VfMSwgU2Vjb25kXzEsIFRlc3RGb3JNZWRpYXRvcl8xLCBUaGlyZF8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQGF1dGhvciBSYXlraWRcclxuICAgICAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAgICAgKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gICAgICogQG1vZGlmeSBkYXRlIDIwMTctMDktMThcclxuICAgICAqXHJcbiAgICAgKiDmtYvor5XpppbkuKrmqKHlnZdcclxuICAgICovXHJcbiAgICB2YXIgRmlyc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKEZpcnN0LCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIEZpcnN0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIEZpcnN0XzEgPSBGaXJzdDtcclxuICAgICAgICBGaXJzdC5wcm90b3R5cGUubGlzdEFzc2V0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtcIi4vbW9kdWxlcy90ZXN0Lmh0bWxcIl07XHJcbiAgICAgICAgfTtcclxuICAgICAgICBGaXJzdC5wcm90b3R5cGUubGlzdEpzRmlsZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXCJ0ZXN0MS5qc1wiLCBcIi4vdGVzdDIuanNcIl07XHJcbiAgICAgICAgfTtcclxuICAgICAgICBGaXJzdC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICAvLyB0aGlzLm1hcExpc3RlbmVyKHRoaXMuYnRuLCBcImNsaWNrXCIsIGZ1bmN0aW9uKCk6dm9pZFxyXG4gICAgICAgICAgICAvLyB7XHJcbiAgICAgICAgICAgIC8vICAgICB0aGlzLnR4dC50ZXh0Q29udGVudCA9IFwiRnVjayB5b3UhISFcIjtcclxuICAgICAgICAgICAgLy8gICAgIHRoaXMubW9kdWxlTWFuYWdlci5vcGVuKFNlY29uZCk7XHJcbiAgICAgICAgICAgIC8vIH0sIHRoaXMpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmZ1Y2tNb2RlbDEuZnVjaywgdGhpcy5mdWNrTW9kZWwxID09PSB0aGlzLmZ1Y2tNb2RlbDIsIHRoaXMuZnVja01vZGVsMSA9PT0gdGhpcy5mdWNrTW9kZWwzKTtcclxuICAgICAgICAgICAgdGhpcy52aWV3TW9kZWwgPSB7XHJcbiAgICAgICAgICAgICAgICBmdWNrTGlzdDogWzEsIDIsIFwic2hpdFwiLCBcInlvdVwiXSxcclxuICAgICAgICAgICAgICAgIGZ1Y2tUZXh0OiBcImZ1Y2sgeW91XCIsXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrQnRuOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMudmlld01vZGVsLmZ1Y2tUZXh0ID0gXCJjbGlja2VkXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5tb2R1bGVNYW5hZ2VyLm9wZW4oU2Vjb25kKTtcclxuICAgICAgICAgICAgICAgICAgICBuZXcgU2Vjb25kXzEuZGVmYXVsdCgpLm9wZW4oKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrRnVjazogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1vZHVsZU1hbmFnZXIub3BlbihUaGlyZF8xLmRlZmF1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1Y2tNb2RlbDogdGhpcy5mdWNrTW9kZWwxXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIEF1ZGlvTWFuYWdlcl8xLmF1ZGlvTWFuYWdlci5wbGF5TXVzaWMoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBcIi4vdGVzdC5tcDNcIlxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy52aWV3TW9kZWwuZnVja1RleHQgPSBcIjEyMzRcIjtcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMudmlld01vZGVsLmZ1Y2tMaXN0ID0gW1wiaGVsbG9cIiwgXCJ3b3JsZFwiXTtcclxuICAgICAgICAgICAgICAgIF90aGlzLnZpZXdNb2RlbC5mdWNrTGlzdC5wdXNoKFwiamZrc2RqbGZcIik7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5mdWNrTW9kZWwxLmZ1Y2sgPSBcIllvdSEhIVwiO1xyXG4gICAgICAgICAgICB9LCAzMDAwKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwYXRjaChuZXcgVGVzdFJlcXVlc3RfMS5kZWZhdWx0KCkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLm9uTW9kdWxlQ2hhbmdlID0gZnVuY3Rpb24gKHRvLCBmcm9tKSB7XHJcbiAgICAgICAgICAgIGlmICh0byA9PSBGaXJzdF8xKVxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjaGFuZ2UgdG8gZmlyc3QgbW9kdWxlIVwiKTtcclxuICAgICAgICAgICAgZWxzZSBpZiAodG8gPT0gU2Vjb25kXzEuZGVmYXVsdClcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlIHRvIHNlY29uZCBtb2R1bGUhXCIpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRmlyc3QucHJvdG90eXBlLm9uUmVzcG9uc2UgPSBmdW5jdGlvbiAocmVzLCByZXEpIHtcclxuICAgICAgICAgICAgYWxlcnQoXCIxMjNcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBGaXJzdC5wcm90b3R5cGUub25GdWNrID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZXNzYWdlIGF0IEZpcnN0TW9kdWxlOiBcIiArIGEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIEZpcnN0XzE7XHJcbiAgICAgICAgRmlyc3QubW9kdWxlTmFtZSA9IFwiRmlyc3RcIjtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5JbmplY3QsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBNb2R1bGVNYW5hZ2VyXzEuZGVmYXVsdClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwibW9kdWxlTWFuYWdlclwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkluamVjdCxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1Y2tNb2RlbF8xLmRlZmF1bHQpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcImZ1Y2tNb2RlbDFcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5JbmplY3QsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdWNrTW9kZWxfMS5JRnVja01vZGVsKVxyXG4gICAgICAgIF0sIEZpcnN0LnByb3RvdHlwZSwgXCJmdWNrTW9kZWwyXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuSW5qZWN0KDEpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVja01vZGVsXzEuSUZ1Y2tNb2RlbClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwiZnVja01vZGVsM1wiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8zLkJpbmRPbih7IGNsaWNrOiBcIm9uQ2xpY2tCdG5cIiB9KSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5CaW5kSWYoXCJmdWNrVGV4dCA9PSAnMTIzNCdcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIVE1MRWxlbWVudClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwiYnRuXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuQmluZEZvcihcImZ1Y2sgb2YgZnVja0xpc3RcIiwgVGVzdEZvck1lZGlhdG9yXzEuZGVmYXVsdCksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIVE1MRWxlbWVudClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwidHh0XCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuQmluZE9uKFwiY2xpY2tcIiwgXCJvbkNsaWNrRnVja1wiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5CaW5kVmFsdWUoXCJ0ZXh0Q29udGVudFwiLCBcImZ1Y2tNb2RlbC5mdWNrXCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcImZ1Y2tcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5NZXNzYWdlSGFuZGxlcihNb2R1bGVNZXNzYWdlXzEuZGVmYXVsdC5NT0RVTEVfQ0hBTkdFKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3QsIE9iamVjdF0pLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnJldHVybnR5cGVcIiwgdm9pZCAwKVxyXG4gICAgICAgIF0sIEZpcnN0LnByb3RvdHlwZSwgXCJvbk1vZHVsZUNoYW5nZVwiLCBudWxsKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5SZXNwb25zZUhhbmRsZXIsXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdW5jdGlvbiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbVGVzdFJlc3BvbnNlXzEuZGVmYXVsdCwgVGVzdFJlcXVlc3RfMS5kZWZhdWx0XSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cmV0dXJudHlwZVwiLCB2b2lkIDApXHJcbiAgICAgICAgXSwgRmlyc3QucHJvdG90eXBlLCBcIm9uUmVzcG9uc2VcIiwgbnVsbCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzMuTWVzc2FnZUhhbmRsZXIoXCJmdWNrXCIpLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8zLkdsb2JhbE1lc3NhZ2VIYW5kbGVyKFwiZnVja1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1bmN0aW9uKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpwYXJhbXR5cGVzXCIsIFtPYmplY3RdKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjpyZXR1cm50eXBlXCIsIHZvaWQgMClcclxuICAgICAgICBdLCBGaXJzdC5wcm90b3R5cGUsIFwib25GdWNrXCIsIG51bGwpO1xyXG4gICAgICAgIEZpcnN0ID0gRmlyc3RfMSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkRPTU1lZGlhdG9yQ2xhc3MoXCJGaXJzdFwiLCBcIi4vbW9kdWxlcy90ZXN0Lmh0bWxcIilcclxuICAgICAgICBdLCBGaXJzdCk7XHJcbiAgICAgICAgcmV0dXJuIEZpcnN0O1xyXG4gICAgfShTY2VuZU1lZGlhdG9yXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gRmlyc3Q7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lSbWx5YzNRdWFuTWlMQ0p6YjNWeVkyVlNiMjkwSWpvaUlpd2ljMjkxY21ObGN5STZXeUpHYVhKemRDNTBjeUpkTENKdVlXMWxjeUk2VzEwc0ltMWhjSEJwYm1keklqb2lPenM3T3pzN096czdPenM3T3pzN096czdPenM3TzBsQlkwRTdPenM3T3pzN1RVRlBSVHRKUVVkR08xRkJRVzFETEhsQ1FVRmhPMUZCUVdoRU96dFJRWGRHUVN4RFFVRkRPMnRDUVhoR2IwSXNTMEZCU3p0UlFYTkNaaXd3UWtGQlZTeEhRVUZxUWp0WlFVVkpMRTlCUVU4c1EwRkJReXh4UWtGQmNVSXNRMEZCUXl4RFFVRkRPMUZCUTI1RExFTkJRVU03VVVGRlRTd3lRa0ZCVnl4SFFVRnNRanRaUVVWSkxFOUJRVThzUTBGQlF5eFZRVUZWTEVWQlFVVXNXVUZCV1N4RFFVRkRMRU5CUVVNN1VVRkRkRU1zUTBGQlF6dFJRVVZOTEhOQ1FVRk5MRWRCUVdJN1dVRkJRU3hwUWtGdFEwTTdXVUZxUTBjc2MwUkJRWE5FTzFsQlEzUkVMRWxCUVVrN1dVRkRTaXcwUTBGQk5FTTdXVUZETlVNc2RVTkJRWFZETzFsQlEzWkRMRmxCUVZrN1dVRkRXaXhQUVVGUExFTkJRVU1zUjBGQlJ5eERRVUZETEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1NVRkJTU3hGUVVGRkxFbEJRVWtzUTBGQlF5eFZRVUZWTEV0QlFVc3NTVUZCU1N4RFFVRkRMRlZCUVZVc1JVRkJSU3hKUVVGSkxFTkJRVU1zVlVGQlZTeExRVUZMTEVsQlFVa3NRMEZCUXl4VlFVRlZMRU5CUVVNc1EwRkJRenRaUVVVMVJ5eEpRVUZKTEVOQlFVTXNVMEZCVXl4SFFVRkhPMmRDUVVOaUxGRkJRVkVzUlVGQlJTeERRVUZETEVOQlFVTXNSVUZCUlN4RFFVRkRMRVZCUVVVc1RVRkJUU3hGUVVGRkxFdEJRVXNzUTBGQlF6dG5Ra0ZETDBJc1VVRkJVU3hGUVVGRkxGVkJRVlU3WjBKQlEzQkNMRlZCUVZVc1JVRkJSVHR2UWtGRFVpeExRVUZKTEVOQlFVTXNVMEZCVXl4RFFVRkRMRkZCUVZFc1IwRkJSeXhUUVVGVExFTkJRVU03YjBKQlEzQkRMRzFEUVVGdFF6dHZRa0ZEYmtNc1NVRkJTU3huUWtGQlRTeEZRVUZGTEVOQlFVTXNTVUZCU1N4RlFVRkZMRU5CUVVNN1owSkJRM2hDTEVOQlFVTTdaMEpCUTBRc1YwRkJWeXhGUVVGRk8yOUNRVU5VTEV0QlFVa3NRMEZCUXl4aFFVRmhMRU5CUVVNc1NVRkJTU3hEUVVGRExHVkJRVXNzUTBGQlF5eERRVUZETzJkQ1FVTnVReXhEUVVGRE8yZENRVU5FTEZOQlFWTXNSVUZCUlN4SlFVRkpMRU5CUVVNc1ZVRkJWVHRoUVVNM1FpeERRVUZETzFsQlJVWXNNa0pCUVZrc1EwRkJReXhUUVVGVExFTkJRVU03WjBKQlEyNUNMRWRCUVVjc1JVRkJSU3haUVVGWk8yRkJRM0JDTEVOQlFVTXNRMEZCUXp0WlFVVklMRlZCUVZVc1EwRkJRenRuUWtGRFVDeExRVUZKTEVOQlFVTXNVMEZCVXl4RFFVRkRMRkZCUVZFc1IwRkJSeXhOUVVGTkxFTkJRVU03WjBKQlEycERMR2RFUVVGblJEdG5Ra0ZEYUVRc1MwRkJTU3hEUVVGRExGTkJRVk1zUTBGQlF5eFJRVUZSTEVOQlFVTXNTVUZCU1N4RFFVRkRMRlZCUVZVc1EwRkJReXhEUVVGRE8yZENRVU42UXl4TFFVRkpMRU5CUVVNc1ZVRkJWU3hEUVVGRExFbEJRVWtzUjBGQlJ5eFJRVUZSTEVOQlFVTTdXVUZEY0VNc1EwRkJReXhGUVVGRkxFbEJRVWtzUTBGQlF5eERRVUZETzFsQlJWUXNTVUZCU1N4RFFVRkRMRkZCUVZFc1EwRkJReXhKUVVGSkxIRkNRVUZYTEVWQlFVVXNRMEZCUXl4RFFVRkRPMUZCUTNKRExFTkJRVU03VVVGSFR5dzRRa0ZCWXl4SFFVRjBRaXhWUVVGMVFpeEZRVUZOTEVWQlFVVXNTVUZCVVR0WlFVVnVReXhKUVVGSExFVkJRVVVzU1VGQlNTeFBRVUZMTzJkQ1FVRkZMRTlCUVU4c1EwRkJReXhIUVVGSExFTkJRVU1zZVVKQlFYbENMRU5CUVVNc1EwRkJRenRwUWtGRGJFUXNTVUZCUnl4RlFVRkZMRWxCUVVrc1owSkJRVTA3WjBKQlFVVXNUMEZCVHl4RFFVRkRMRWRCUVVjc1EwRkJReXd3UWtGQk1FSXNRMEZCUXl4RFFVRkRPMUZCUTJ4RkxFTkJRVU03VVVGSFR5d3dRa0ZCVlN4SFFVRnNRaXhWUVVGdFFpeEhRVUZuUWl4RlFVRkZMRWRCUVdVN1dVRkZhRVFzUzBGQlN5eERRVUZETEV0QlFVc3NRMEZCUXl4RFFVRkRPMUZCUTJwQ0xFTkJRVU03VVVGSlR5eHpRa0ZCVFN4SFFVRmtMRlZCUVdVc1EwRkJRenRaUVVWYUxFOUJRVThzUTBGQlF5eEhRVUZITEVOQlFVTXNNRUpCUVRCQ0xFZEJRVWNzUTBGQlF5eERRVUZETEVOQlFVTTdVVUZEYUVRc1EwRkJRenM3VVVGeVJtRXNaMEpCUVZVc1IwRkJWU3hQUVVGUExFTkJRVU03VVVGSE1VTTdXVUZFUXl4cFFrRkJUVHR6UTBGRFpTeDFRa0ZCWVR0dlJFRkJRenRSUVVWd1F6dFpRVVJETEdsQ1FVRk5PM05EUVVOWkxHMUNRVUZUTzJsRVFVRkRPMUZCUlRkQ08xbEJSRU1zYVVKQlFVMDdjME5CUTFrc2MwSkJRVlU3YVVSQlFVTTdVVUZGT1VJN1dVRkVReXhwUWtGQlRTeERRVUZETEVOQlFVTXNRMEZCUXp0elEwRkRVeXh6UWtGQlZUdHBSRUZCUXp0UlFVazVRanRaUVVaRExHbENRVUZOTEVOQlFVTXNSVUZCUXl4TFFVRkxMRVZCUVVVc1dVRkJXU3hGUVVGRExFTkJRVU03V1VGRE4wSXNhVUpCUVUwc1EwRkJReXh2UWtGQmIwSXNRMEZCUXp0elEwRkRiRUlzVjBGQlZ6c3dRMEZCUVR0UlFVVjBRanRaUVVSRExHdENRVUZQTEVOQlFVTXNhMEpCUVd0Q0xFVkJRVVVzZVVKQlFXVXNRMEZCUXp0elEwRkRiRU1zVjBGQlZ6c3dRMEZCUXp0UlFVZDJRanRaUVVaRExHbENRVUZOTEVOQlFVTXNUMEZCVHl4RlFVRkZMR0ZCUVdFc1EwRkJRenRaUVVNNVFpeHZRa0ZCVXl4RFFVRkRMR0ZCUVdFc1JVRkJSU3huUWtGQlowSXNRMEZCUXp0elEwRkRMMElzVjBGQlZ6c3lRMEZCUXp0UlFXdEVlRUk3V1VGRVF5eDVRa0ZCWXl4RFFVRkRMSFZDUVVGaExFTkJRVU1zWVVGQllTeERRVUZET3pzN08yMUVRVXN6UXp0UlFVZEVPMWxCUkVNc01FSkJRV1U3T3paRFFVTlBMSE5DUVVGWkxFVkJRVTBzY1VKQlFWYzdPeXREUVVkdVJEdFJRVWxFTzFsQlJrTXNlVUpCUVdNc1EwRkJReXhOUVVGTkxFTkJRVU03V1VGRGRFSXNLMEpCUVc5Q0xFTkJRVU1zVFVGQlRTeERRVUZET3pzN096SkRRVWsxUWp0UlFYWkdaMElzUzBGQlN6dFpRVVI2UWl3eVFrRkJaMElzUTBGQlF5eFBRVUZQTEVWQlFVVXNjVUpCUVhGQ0xFTkJRVU03VjBGRE5VSXNTMEZCU3l4RFFYZEdla0k3VVVGQlJDeFpRVUZETzB0QlFVRXNRVUY0UmtRc1EwRkJiVU1zZFVKQlFXRXNSMEYzUmk5RE8zTkNRWGhHYjBJc1MwRkJTeUo5XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L21vZHVsZXMvRmlyc3QudHNcbi8vIG1vZHVsZSBpZCA9IDU2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBnO1xyXG5cclxuLy8gVGhpcyB3b3JrcyBpbiBub24tc3RyaWN0IG1vZGVcclxuZyA9IChmdW5jdGlvbigpIHtcclxuXHRyZXR1cm4gdGhpcztcclxufSkoKTtcclxuXHJcbnRyeSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiBldmFsIGlzIGFsbG93ZWQgKHNlZSBDU1ApXHJcblx0ZyA9IGcgfHwgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpIHx8ICgxLGV2YWwpKFwidGhpc1wiKTtcclxufSBjYXRjaChlKSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcclxuXHRpZih0eXBlb2Ygd2luZG93ID09PSBcIm9iamVjdFwiKVxyXG5cdFx0ZyA9IHdpbmRvdztcclxufVxyXG5cclxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxyXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xyXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGc7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vICh3ZWJwYWNrKS9idWlsZGluL2dsb2JhbC5qc1xuLy8gbW9kdWxlIGlkID0gNTdcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IE1lc3NhZ2UgZnJvbSBcIi4vTWVzc2FnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDFcclxuICpcclxuICog5qGG5p625YaF5qC46YCa55So5raI5oGvXHJcbiovXHJcbnZhciBDb21tb25NZXNzYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoQ29tbW9uTWVzc2FnZSwgX3N1cGVyKTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBNZXNzYWdlLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUg5raI5oGv57G75Z6LXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBwYXJhbXMg5Y+v6IO955qE5raI5oGv5Y+C5pWw5YiX6KGoXHJcbiAgICAgKiBAbWVtYmVyb2YgTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBDb21tb25NZXNzYWdlKHR5cGUpIHtcclxuICAgICAgICB2YXIgcGFyYW1zID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgcGFyYW1zW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB0eXBlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQ29tbW9uTWVzc2FnZTtcclxufShNZXNzYWdlKSk7XHJcbmV4cG9ydCBkZWZhdWx0IENvbW1vbk1lc3NhZ2U7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2NvcmUvbWVzc2FnZS9Db21tb25NZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA1OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjFcclxuICpcclxuICog6YCa55So5by556qX55qE5ZCE56eN5o6l5Y+jXHJcbiovXHJcbmV4cG9ydCB2YXIgQnV0dG9uVHlwZTtcclxuKGZ1bmN0aW9uIChCdXR0b25UeXBlKSB7XHJcbiAgICBCdXR0b25UeXBlW0J1dHRvblR5cGVbXCJub3JtYWxcIl0gPSAwXSA9IFwibm9ybWFsXCI7XHJcbiAgICBCdXR0b25UeXBlW0J1dHRvblR5cGVbXCJpbXBvcnRhbnRcIl0gPSAxXSA9IFwiaW1wb3J0YW50XCI7XHJcbn0pKEJ1dHRvblR5cGUgfHwgKEJ1dHRvblR5cGUgPSB7fSkpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvSVByb21wdFBhbmVsLmpzXG4vLyBtb2R1bGUgaWQgPSA1OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog5peg5Lu75L2V5Yqo55S755qE5by55Ye6562W55Wl77yM5Y+v5bqU55So5LqO5Lu75L2V5pi+56S65bGC5a6e546wXHJcbiovXHJcbnZhciBOb25lUGFuZWxQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOb25lUGFuZWxQb2xpY3koKSB7XHJcbiAgICB9XHJcbiAgICBOb25lUGFuZWxQb2xpY3kucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uIChwYW5lbCwgY2FsbGJhY2ssIGZyb20pIHtcclxuICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCAwKTtcclxuICAgIH07XHJcbiAgICBOb25lUGFuZWxQb2xpY3kucHJvdG90eXBlLmRyb3AgPSBmdW5jdGlvbiAocGFuZWwsIGNhbGxiYWNrLCBmcm9tKSB7XHJcbiAgICAgICAgc2V0VGltZW91dChjYWxsYmFjaywgMCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE5vbmVQYW5lbFBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IHsgTm9uZVBhbmVsUG9saWN5IH07XHJcbi8qKiDpu5jorqTlr7zlh7rlrp7kvosgKi9cclxuZXhwb3J0IGRlZmF1bHQgbmV3IE5vbmVQYW5lbFBvbGljeSgpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvTm9uZVBhbmVsUG9saWN5LmpzXG4vLyBtb2R1bGUgaWQgPSA2MFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICpcclxuICog5by556qX55u45YWz55qE5raI5oGvXHJcbiovXHJcbnZhciBQYW5lbE1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBQYW5lbE1lc3NhZ2UoKSB7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOW8ueeql+WJjeeahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9CRUZPUkVfUE9QID0gXCJwYW5lbEJlZm9yZVBvcFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmiZPlvIDlvLnnqpflkI7nmoTmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIFBhbmVsTWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBQYW5lbE1lc3NhZ2UuUEFORUxfQUZURVJfUE9QID0gXCJwYW5lbEFmdGVyUG9wXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreW8ueeql+WJjeeahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9CRUZPUkVfRFJPUCA9IFwicGFuZWxCZWZvcmVEcm9wXCI7XHJcbiAgICAvKipcclxuICAgICAqIOWFs+mXreW8ueeql+WQjueahOa2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgUGFuZWxNZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIFBhbmVsTWVzc2FnZS5QQU5FTF9BRlRFUl9EUk9QID0gXCJwYW5lbEFmdGVyRHJvcFwiO1xyXG4gICAgcmV0dXJuIFBhbmVsTWVzc2FnZTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgUGFuZWxNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvUGFuZWxNZXNzYWdlLmpzXG4vLyBtb2R1bGUgaWQgPSA2MVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIvKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDhcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDhcclxuICpcclxuICog5ZCM5q2l5bel5YW36ZuG77yM55So5LqO5a+55aSa5LiqXHJcbiovXHJcbnZhciBfY2FjaGUgPSB7fTtcclxuLyoqXHJcbiAqIOWIpOaWreaYr+WQpuato+WcqOi/m+ihjOaTjeS9nFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIOmYn+WIl+WQjVxyXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0g6Zif5YiX5piv5ZCm5q2j5Zyo5pON5L2cXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNPcGVyYXRpbmcobmFtZSkge1xyXG4gICAgdmFyIGN0eCA9IF9jYWNoZVtuYW1lXTtcclxuICAgIHJldHVybiAoY3R4ICE9IG51bGwgJiYgY3R4Lm9wZXJhdGluZyk7XHJcbn1cclxuLyoqXHJcbiAqIOW8gOWni+WQjOatpeaTjeS9nO+8jOaJgOacieS8oOmAkuS6huebuOWQjG5hbWXnmoTmk43kvZzkvJrooqvku6XpmJ/liJfmlrnlvI/pobrluo/miafooYxcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0gbmFtZSDkuIDkuKrpmJ/liJfnmoTlkI3lrZdcclxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4g6KaB5omn6KGM55qE5pa55rOVXHJcbiAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIOaWueazlXRoaXPlr7nosaFcclxuICogQHBhcmFtIHsuLi5hbnlbXX0gW2FyZ3NdIOaWueazleWPguaVsFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdhaXQobmFtZSwgZm4sIHRoaXNBcmcpIHtcclxuICAgIHZhciBhcmdzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICB2YXIgY3R4ID0gX2NhY2hlW25hbWVdO1xyXG4gICAgaWYgKGN0eCA9PSBudWxsKSB7XHJcbiAgICAgICAgX2NhY2hlW25hbWVdID0gY3R4ID0geyBvcGVyYXRpbmc6IGZhbHNlLCBkYXRhczogW10gfTtcclxuICAgIH1cclxuICAgIGlmIChjdHgub3BlcmF0aW5nKSB7XHJcbiAgICAgICAgLy8g6Zif5YiX5q2j5Zyo5omn6KGM77yM5o6o5YWl57yT5a2YXHJcbiAgICAgICAgY3R4LmRhdGFzLnB1c2goeyBmbjogZm4sIHRoaXNBcmc6IHRoaXNBcmcsIGFyZ3M6IGFyZ3MgfSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyDpmJ/liJfmsqHmnInlnKjmiafooYzvvIznm7TmjqXmiafooYxcclxuICAgICAgICBjdHgub3BlcmF0aW5nID0gdHJ1ZTtcclxuICAgICAgICBmbi5hcHBseSh0aGlzQXJnLCBhcmdzKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog5a6M5oiQ5LiA5q2l5pON5L2c5bm25ZSk6YaS5ZCO57ut5pON5L2cXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IG5hbWUg6Zif5YiX5ZCN5a2XXHJcbiAqIEByZXR1cm5zIHt2b2lkfVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG5vdGlmeShuYW1lKSB7XHJcbiAgICB2YXIgY3R4ID0gX2NhY2hlW25hbWVdO1xyXG4gICAgaWYgKGN0eCA9PSBudWxsIHx8IGN0eC5kYXRhcy5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgIC8vIOmYn+WIl+aJp+ihjOWujOS6hu+8jOebtOaOpee7k+adn1xyXG4gICAgICAgIGN0eC5vcGVyYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB2YXIgZGF0YSA9IGN0eC5kYXRhcy5zaGlmdCgpO1xyXG4gICAgZGF0YS5mbi5hcHBseShkYXRhLnRoaXNBcmcsIGRhdGEuYXJncyk7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvdXRpbHMvU3luY1V0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDYyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wOFxyXG4gKlxyXG4gKiDml6Dku7vkvZXliqjnlLvnmoTlnLrmma/nrZbnlaXvvIzlj6/lupTnlKjkuo7ku7vkvZXmmL7npLrlsYLlrp7njrBcclxuKi9cclxudmFyIE5vbmVTY2VuZVBvbGljeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE5vbmVTY2VuZVBvbGljeSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5YeG5aSH5YiH5o2i5Zy65pmv5pe26LCD5bqmXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliIflh7rnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB0byDliIflhaXnmoTlnLrmma9cclxuICAgICAqL1xyXG4gICAgTm9uZVNjZW5lUG9saWN5LnByb3RvdHlwZS5wcmVwYXJlU3dpdGNoID0gZnVuY3Rpb24gKGZyb20sIHRvKSB7XHJcbiAgICAgICAgLy8g6L+Z5Liq562W55Wl6YeM5ZWl5Lmf5LiN55So5YeG5aSHXHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDliIfmjaLlnLrmma/ml7bosIPluqZcclxuICAgICAqIEBwYXJhbSBmcm9tIOWIh+WHuueahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIHRvIOWIh+WFpeeahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIOWIh+aNouWujOavleeahOWbnuiwg+aWueazlVxyXG4gICAgICovXHJcbiAgICBOb25lU2NlbmVQb2xpY3kucHJvdG90eXBlLnN3aXRjaCA9IGZ1bmN0aW9uIChmcm9tLCB0bywgY2FsbGJhY2spIHtcclxuICAgICAgICAvLyDnm7TmjqXlu7bov5/liLDkuIvkuIDluKflm57osIPvvIjkuI3og73lkIzmraXlm57osIPvvIzlkKbliJnlj6/og73kvJrlh7rpl67popjvvIlcclxuICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrLCAwKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTm9uZVNjZW5lUG9saWN5O1xyXG59KCkpO1xyXG5leHBvcnQgeyBOb25lU2NlbmVQb2xpY3kgfTtcclxuLyoqIOm7mOiupOWvvOWHuuWunuS+iyAqL1xyXG5leHBvcnQgZGVmYXVsdCBuZXcgTm9uZVNjZW5lUG9saWN5KCk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9zY2VuZS9Ob25lU2NlbmVQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDYzXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xMVxyXG4gKlxyXG4gKiDpgJrorq/nm7jlhbPnmoTmtojmga9cclxuKi9cclxudmFyIE5ldE1lc3NhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOZXRNZXNzYWdlKCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlj5HpgIHnvZHnu5zor7fmsYLmtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTmV0TWVzc2FnZS5ORVRfUkVRVUVTVCA9IFwibmV0UmVxdWVzdFwiO1xyXG4gICAgLyoqXHJcbiAgICAgKiDmjqXlj5fnvZHnu5zov5Tlm57mtojmga9cclxuICAgICAqXHJcbiAgICAgKiBAc3RhdGljXHJcbiAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICogQG1lbWJlcm9mIE5ldE1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgTmV0TWVzc2FnZS5ORVRfUkVTUE9OU0UgPSBcIm5ldFJlc3BvbnNlXCI7XHJcbiAgICAvKipcclxuICAgICAqIOe9kee7nOivt+axgumUmeivr+a2iOaBr1xyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgKiBAbWVtYmVyb2YgTmV0TWVzc2FnZVxyXG4gICAgICovXHJcbiAgICBOZXRNZXNzYWdlLk5FVF9FUlJPUiA9IFwibmV0RXJyb3JcIjtcclxuICAgIHJldHVybiBOZXRNZXNzYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBOZXRNZXNzYWdlO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvbmV0L05ldE1lc3NhZ2UuanNcbi8vIG1vZHVsZSBpZCA9IDY0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGdldEdVSUQsIGdldE9iamVjdEhhc2hzIH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IFdhdGNoZXIgZnJvbSBcIi4vV2F0Y2hlclwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTEtMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTEtMDZcclxuICpcclxuICog5LiA5Liq57uR5a6aXHJcbiovXHJcbnZhciBCaW5kID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQmluZChtZWRpYXRvcikge1xyXG4gICAgICAgIHRoaXMuX3dhdGNoZXJEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fbWVkaWF0b3IgPSBtZWRpYXRvcjtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCaW5kLnByb3RvdHlwZSwgXCJtZWRpYXRvclwiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5bey57uR5a6a55qE5Lit5LuL6ICF5a6e5L6LXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SU1lZGlhdG9yfVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBCaW5kXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYXRvcjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5Yib5bu65LiA5Liq6KeC5a+f6ICF77yM5Zyo5pWw5YC85Y+Y5pu05pe25Lya6YCa55+l5Zue6LCD6L+b6KGM5pu05pawXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsqfSBjdXJyZW50VGFyZ2V0IOS9nOeUqOebruagh++8jOaMh+ihqOi+vuW8j+aJgOWcqOeahOaYvuekuuWvueixoVxyXG4gICAgICogQHBhcmFtIHsqfSB0YXJnZXQg57uR5a6a6KGo6L6+5byP5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAgICAgKiBAcGFyYW0ge0V2YWxFeHB9IGV4cCDooajovr7lvI/miJbmlrnms5VcclxuICAgICAqIEBwYXJhbSB7V2F0Y2hlckNhbGxiYWNrfSBjYWxsYmFjayDorqLpmIXlmajlm57osINcclxuICAgICAqIEBwYXJhbSB7Kn0gdGhpc0FyZyB0aGlz5oyH5ZCRXHJcbiAgICAgKiBAcGFyYW0gey4uLmFueVtdfSBzY29wZXMg5L2c55So5Z+f5YiX6KGo77yM5pyA5ZCO5LiA5Liq5L2c55So5Z+f5Lya6KKr5b2T5YGadGhpc+aMh+WQkVxyXG4gICAgICogQHJldHVybnMge0lXYXRjaGVyfSDov5Tlm57op4Llr5/ogIXmnKzouqtcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kXHJcbiAgICAgKi9cclxuICAgIEJpbmQucHJvdG90eXBlLmNyZWF0ZVdhdGNoZXIgPSBmdW5jdGlvbiAoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBleHAsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XHJcbiAgICAgICAgdmFyIHNjb3BlcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gNTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHNjb3Blc1tfaSAtIDVdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGtleSA9IGdldE9iamVjdEhhc2hzLmFwcGx5KHZvaWQgMCwgW2N1cnJlbnRUYXJnZXQsIGV4cCwgZ2V0R1VJRCgpXS5jb25jYXQoc2NvcGVzKSk7XHJcbiAgICAgICAgdmFyIHdhdGNoZXIgPSB0aGlzLl93YXRjaGVyRGljdFtrZXldO1xyXG4gICAgICAgIGlmICghd2F0Y2hlcilcclxuICAgICAgICAgICAgdGhpcy5fd2F0Y2hlckRpY3Rba2V5XSA9IHdhdGNoZXIgPSBuZXcgKFdhdGNoZXIuYmluZC5hcHBseShXYXRjaGVyLCBbdm9pZCAwLCB0aGlzLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGV4cCwgY2FsbGJhY2ssIHRoaXNBcmddLmNvbmNhdChzY29wZXMpKSkoKTtcclxuICAgICAgICByZXR1cm4gd2F0Y2hlcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmUgOavgee7keWumuWFs+ezu1xyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBCaW5kXHJcbiAgICAgKi9cclxuICAgIEJpbmQucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIHRoaXMuX3dhdGNoZXJEaWN0KSB7XHJcbiAgICAgICAgICAgIHZhciB3YXRjaGVyID0gdGhpcy5fd2F0Y2hlckRpY3Rba2V5XTtcclxuICAgICAgICAgICAgd2F0Y2hlci5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl93YXRjaGVyRGljdFtrZXldO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9tZWRpYXRvciA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJpbmQ7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEJpbmQ7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9iaW5kL0JpbmQuanNcbi8vIG1vZHVsZSBpZCA9IDY1XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGdldE9iamVjdEhhc2hzIH0gZnJvbSBcIi4uLy4uL3V0aWxzL09iamVjdFV0aWxcIjtcclxuaW1wb3J0IERlcCBmcm9tIFwiLi9EZXBcIjtcclxuaW1wb3J0IFdhdGNoZXIgZnJvbSBcIi4vV2F0Y2hlclwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTEtMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTEtMDZcclxuICpcclxuICog5Y+Y5byC5Zmo77yM5bCGVmlld01vZGVs5Y+Y5byC5Li65YW35pyJ5L6d6LWW5Yqf6IO955qE5b2i5byP77yM5Lmf5Y+v5Lul6K6k5Li65piv57yW6K+R6L+H56iLXHJcbiovXHJcbi8vIOiusOW9leaVsOe7hOS4reS8mumAoOaIkOaVsOaNruabtOaWsOeahOaJgOacieaWueazleWQjVxyXG52YXIgYXJyTWV0aG9kcyA9IFtcclxuICAgIFwicHVzaFwiLFxyXG4gICAgXCJwb3BcIixcclxuICAgIFwidW5zaGlmdFwiLFxyXG4gICAgXCJzaGlmdFwiLFxyXG4gICAgXCJzcGxpY2VcIixcclxuICAgIFwic29ydFwiLFxyXG4gICAgXCJyZXZlcnNlXCJcclxuXTtcclxuLyoqXHJcbiAqIOWwhueUqOaIt+S8oOi/m+adpeeahOaVsOaNruKAnOWPmOW8guKAneaIkOS4uuWFt+acieaIquiOt+aVsOaNruWPmOabtOiDveWKm+eahOaVsOaNrlxyXG4gKiBAcGFyYW0gZGF0YSDljp/lp4vmlbDmja5cclxuICogQHJldHVybnMge2FueX0g5Y+Y5byC5ZCO55qE5pWw5o2uXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbXV0YXRlKGRhdGEpIHtcclxuICAgIC8vIOWmguaenOaYr+eugOWNleexu+Wei++8jOWImeWVpeS5n+S4jeWBmlxyXG4gICAgaWYgKCFkYXRhIHx8IHR5cGVvZiBkYXRhICE9IFwib2JqZWN0XCIpXHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAvLyDpgJLlvZLlj5jlvILmiYDmnInlhoXpg6jlj5jph4/vvIzlj4rlhbZfX3Byb3RvX1/kuIvnmoTlsZ7mgKfvvIzlm6DkuLpnZXR0ZXIvc2V0dGVy5Lya6KKr5a6a5LmJ5ZyoX19wcm90b19f5LiK77yM6ICM5LiN5piv5b2T5YmN5a+56LGh5LiKXHJcbiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpLmNvbmNhdChPYmplY3Qua2V5cyhkYXRhLl9fcHJvdG9fXyB8fCB7fSkpO1xyXG4gICAgLy8g5Y676YeNXHJcbiAgICB2YXIgdGVtcCA9IHt9O1xyXG4gICAgZm9yICh2YXIgX2kgPSAwLCBrZXlzXzEgPSBrZXlzOyBfaSA8IGtleXNfMS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICB2YXIga2V5ID0ga2V5c18xW19pXTtcclxuICAgICAgICBpZiAoIXRlbXBba2V5XSkge1xyXG4gICAgICAgICAgICB0ZW1wW2tleV0gPSBrZXk7XHJcbiAgICAgICAgICAgIC8vIOmAkuW9kuWPmOW8glxyXG4gICAgICAgICAgICBtdXRhdGVPYmplY3QoZGF0YSwga2V5KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGF0YTtcclxufVxyXG4vKipcclxuICog5Y+N5Y+Y5byC77yM5bCG5bey57uP5Y+Y5byC6L+H55qE5a+56LGh5oGi5aSN5Y6f54q2XHJcbiAqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBkYXRlIDIwMTktMDItMTlcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyp9IGRhdGFcclxuICogQHJldHVybnMgeyp9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5tdXRhdGUoZGF0YSkge1xyXG4gICAgLy8g5aaC5p6c5piv566A5Y2V57G75Z6L77yM5YiZ5ZWl5Lmf5LiN5YGaXHJcbiAgICBpZiAoIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT0gXCJvYmplY3RcIilcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIC8vIOmAkuW9kuWPmOW8guaJgOacieWGhemDqOWPmOmHj++8jOWPiuWFtl9fcHJvdG9fX+S4i+eahOWxnuaAp++8jOWboOS4umdldHRlci9zZXR0ZXLkvJrooqvlrprkuYnlnKhfX3Byb3RvX1/kuIrvvIzogIzkuI3mmK/lvZPliY3lr7nosaHkuIpcclxuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoZGF0YSkuY29uY2F0KE9iamVjdC5rZXlzKGRhdGEuX19wcm90b19fIHx8IHt9KSk7XHJcbiAgICAvLyDljrvph41cclxuICAgIHZhciB0ZW1wID0ge307XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGtleXNfMiA9IGtleXM7IF9pIDwga2V5c18yLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBrZXkgPSBrZXlzXzJbX2ldO1xyXG4gICAgICAgIGlmICghdGVtcFtrZXldKSB7XHJcbiAgICAgICAgICAgIHRlbXBba2V5XSA9IGtleTtcclxuICAgICAgICAgICAgLy8g6YCS5b2S5Y+N5Y+Y5byCXHJcbiAgICAgICAgICAgIHVubXV0YXRlT2JqZWN0KGRhdGEsIGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbn1cclxuZnVuY3Rpb24gb25HZXQoZGVwLCByZXN1bHQsIG11dGF0ZVN1Yikge1xyXG4gICAgLy8g5aaC5p6cV2F0Y2hlci51cGRhdGluZ+S4jeaYr251bGzvvIzor7TmmI7lvZPliY3mraPlnKjmiafooYzooajovr7lvI/vvIzpgqPkuYjojrflj5bnmoTlj5jph4/oh6rnhLbmmK/lhbbpnIDopoHkvp3otZbnmoRcclxuICAgIHZhciB3YXRjaGVyID0gV2F0Y2hlci51cGRhdGluZztcclxuICAgIGlmICh3YXRjaGVyKVxyXG4gICAgICAgIGRlcC53YXRjaCh3YXRjaGVyKTtcclxuICAgIC8vIOmmluasoeiOt+WPlumcgOimgeWPmOW8glxyXG4gICAgaWYgKG11dGF0ZVN1Yikge1xyXG4gICAgICAgIC8vIOWmguaenOaYr+aVsOe7hOWwsei1sOS4k+mXqOeahOaVsOe7hOWPmOW8guaWueazle+8jOWQpuWImemAkuW9kuWPmOW8guWvueixoVxyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdCkpXHJcbiAgICAgICAgICAgIG11dGF0ZUFycmF5KHJlc3VsdCwgZGVwKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIG11dGF0ZShyZXN1bHQpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG9uU2V0KGRlcCwgdmFsdWUpIHtcclxuICAgIC8vIOWmguaenOaYr+aVsOe7hOWwsei1sOS4k+mXqOeahOaVsOe7hOWPmOW8guaWueazle+8jOWQpuWImemAkuW9kuWPmOW8guWvueixoVxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKVxyXG4gICAgICAgIG11dGF0ZUFycmF5KHZhbHVlLCBkZXApO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIG11dGF0ZSh2YWx1ZSk7XHJcbiAgICAvLyDop6blj5HpgJrnn6VcclxuICAgIGRlcC5ub3RpZnkoKTtcclxufVxyXG5mdW5jdGlvbiBtdXRhdGVPYmplY3QoZGF0YSwga2V5KSB7XHJcbiAgICB2YXIgZGVwS2V5ID0gZ2V0T2JqZWN0SGFzaHMoZGF0YSwga2V5KTtcclxuICAgIC8vIOWvueavj+S4quWkjeadguexu+Wei+WvueixoemDveimgeacieS4gOS4quWvueW6lOeahOS+nei1luWIl+ihqFxyXG4gICAgdmFyIGRlcCA9IGRhdGFbZGVwS2V5XTtcclxuICAgIHZhciBtdXRhdGVTdWIgPSB0cnVlO1xyXG4gICAgaWYgKCFkZXApIHtcclxuICAgICAgICBkZXAgPSBuZXcgRGVwKCk7XHJcbiAgICAgICAgLy8g5Yik5pat5pys5p2l6L+Z5Liq5bGe5oCn5piv5YC85bGe5oCn6L+Y5pivZ2V0dGVyL3NldHRlcuWxnuaAp++8jOimgeacieS4jeWQjOeahOaTjeS9nOaWueW8j1xyXG4gICAgICAgIHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihkYXRhLCBrZXkpIHx8IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZGF0YS5fX3Byb3RvX18gfHwge30sIGtleSk7XHJcbiAgICAgICAgaWYgKGRlc2MpIHtcclxuICAgICAgICAgICAgLy8g5byA5aeL5Y+Y5byC5b2T5YmN5bGe5oCnXHJcbiAgICAgICAgICAgIGlmIChkZXNjLmhhc093blByb3BlcnR5KFwidmFsdWVcIikpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWAvOWxnuaAp+eahOWPmOW8gui/h+eoi1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRhdGEsIGtleSwge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDliKnnlKjpl63ljIXkv53lrZjljp/lp4vlgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGRlc2MudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaJp+ihjOWkhOeQhlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkdldChkZXAsIHJlc3VsdCwgbXV0YXRlU3ViKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u5qCH6K6wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG11dGF0ZVN1YiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDov5Tlm57lgLxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzYy53cml0YWJsZSB8fCB2YWx1ZSA9PT0gZGVzYy52YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzYy52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmiafooYzlpITnkIZcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TZXQoZGVwLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnZXR0ZXIvc2V0dGVy5bGe5oCn55qE5Y+Y5byC6L+H56iLXHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwga2V5LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzYy5nZXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiOt+WPlmdldOaWueazlee7k+aenFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZGVzYy5nZXQuY2FsbChkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5omn6KGM5aSE55CGXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uR2V0KGRlcCwgcmVzdWx0LCBtdXRhdGVTdWIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDorr7nva7moIforrBcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRlU3ViID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOi/lOWbnuWAvFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZXNjLnNldClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2Muc2V0LmNhbGwoZGF0YSwgdmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmiafooYzlpITnkIZcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25TZXQoZGVwLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5omT5LiA5Liq5qCH6K6w6KGo56S65bey57uP5Y+Y5byC6L+H5LqGXHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRhdGEsIGRlcEtleSwge1xyXG4gICAgICAgICAgICB2YWx1ZTogZGVwLFxyXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZGF0YSwgZGVwS2V5ICsgXCJ8b3JpRGVzY1wiLCB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBkZXNjLFxyXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB1bm11dGF0ZU9iamVjdChkYXRhLCBrZXkpIHtcclxuICAgIHZhciBkZXBLZXkgPSBnZXRPYmplY3RIYXNocyhkYXRhLCBrZXkpO1xyXG4gICAgLy8g5a+55q+P5Liq5aSN5p2C57G75Z6L5a+56LGh6YO96KaB5pyJ5LiA5Liq5a+55bqU55qE5L6d6LWW5YiX6KGoXHJcbiAgICB2YXIgZGVwID0gZGF0YVtkZXBLZXldO1xyXG4gICAgaWYgKGRlcCkge1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSBkYXRhW2tleV07XHJcbiAgICAgICAgLy8g5rex5bqm5LyY5YWI6YCS5b2S5Y+N5Y+Y5byCXHJcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIEFycmF5KSB7XHJcbiAgICAgICAgICAgIHVubXV0YXRlQXJyYXkodGFyZ2V0LCBkZXApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdW5tdXRhdGUodGFyZ2V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5byA5aeL5Y+N5Y+Y5byC6Ieq6LqrXHJcbiAgICAgICAgdmFyIGRlc2MgPSBkYXRhW2RlcEtleSArIFwifG9yaURlc2NcIl07XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGRhdGEsIGtleSwgZGVzYyk7XHJcbiAgICAgICAgLy8g56e76Zmk5qCH6K6wXHJcbiAgICAgICAgZGVsZXRlIGRhdGFbZGVwS2V5XTtcclxuICAgICAgICBkZWxldGUgZGF0YVtkZXBLZXkgKyBcInxvcmlEZXNjXCJdO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIG11dGF0ZUFycmF5KGFyciwgZGVwKSB7XHJcbiAgICAvLyDlj5jlvILlvZPliY3mlbDnu4RcclxuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihhcnIsIGRlZmluZVJlYWN0aXZlQXJyYXkoZGVwKSk7XHJcbiAgICAvLyDpgY3ljoblvZPliY3mlbDnu4TvvIzlsIblhoXlrrnlr7nosaHlhajpg6jlj5jlvIJcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICBtdXRhdGUoYXJyW2ldKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB1bm11dGF0ZUFycmF5KGFyciwgZGVwKSB7XHJcbiAgICAvLyDpgY3ljoblvZPliY3mlbDnu4TvvIzlsIblhoXlrrnlr7nosaHlhajpg6jlj43lj5jlvIJcclxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhcnIubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICB1bm11dGF0ZShhcnJbaV0pO1xyXG4gICAgfVxyXG4gICAgLy8g5Y+N5Y+Y5byC5b2T5YmN5pWw57uEXHJcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoYXJyLCBBcnJheS5wcm90b3R5cGUpO1xyXG59XHJcbmZ1bmN0aW9uIGRlZmluZVJlYWN0aXZlQXJyYXkoZGVwKSB7XHJcbiAgICB2YXIgcHJvdG8gPSBBcnJheS5wcm90b3R5cGU7XHJcbiAgICB2YXIgcmVzdWx0ID0gT2JqZWN0LmNyZWF0ZShwcm90byk7XHJcbiAgICAvLyDpgY3ljobmiYDmnInmlrnms5XvvIzkuIDkuKrkuIDkuKrlnLDlj5jlvIJcclxuICAgIGFyck1ldGhvZHMuZm9yRWFjaChmdW5jdGlvbiAobWV0aG9kKSB7XHJcbiAgICAgICAgLy8g5Yip55So6Zet5YyF6K6w5b2V5LiA5Liq5Y6f5aeL5pa55rOVXHJcbiAgICAgICAgdmFyIG9yaU1ldGhvZCA9IHByb3RvW21ldGhvZF07XHJcbiAgICAgICAgLy8g5byA5aeL5Y+Y5byCXHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlc3VsdCwgbWV0aG9kLCB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDpppblhYjosIPnlKjljp/lp4vmlrnms5XvvIzojrflj5bov5Tlm57lgLxcclxuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvcmlNZXRob2QuYXBwbHkodGhpcywgYXJncyk7XHJcbiAgICAgICAgICAgICAgICAvLyDmlbDnu4Tmj5LlhaXpoblcclxuICAgICAgICAgICAgICAgIHZhciBpbnNlcnRlZDtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAobWV0aG9kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInB1c2hcIjpcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidW5zaGlmdFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZCA9IGFyZ3M7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzcGxpY2VcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWQgPSBhcmdzLnNsaWNlKDIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOebkeinhuaVsOe7hOaPkuWFpemhue+8jOiAjOS4jeaYr+mHjeaWsOebkeinhuaVtOS4quaVsOe7hFxyXG4gICAgICAgICAgICAgICAgaWYgKGluc2VydGVkICYmIGluc2VydGVkLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG11dGF0ZUFycmF5KGluc2VydGVkLCBkZXApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8g6Kem5Y+R5pu05pawXHJcbiAgICAgICAgICAgICAgICBkZXAubm90aWZ5KHsgbWV0aG9kOiBhcmdzIH0pO1xyXG4gICAgICAgICAgICAgICAgLy8g6L+U5Zue5YC8XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIOaPkOS+m+abv+aNouaVsOe7hOiuvue9rueahOaWueazle+8jOWboOS4uuebtOaOpeiuvue9ruaVsOe7hOS4i+agh+eahOaWueW8j+aXoOazleWPmOW8glxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHJlc3VsdCwgXCIkc2V0XCIsIHtcclxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKGluZGV4LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAvLyDotoXlh7rmlbDnu4Tplb/luqbpu5jorqTov73liqDliLDmnIDlkI5cclxuICAgICAgICAgICAgaWYgKGluZGV4ID49IHRoaXMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgaW5kZXggPSB0aGlzLmxlbmd0aDtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3BsaWNlKGluZGV4LCAxLCB2YWx1ZSlbMF07XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICAvLyDmj5Dkvpvmm7/mjaLmlbDnu4Tnp7vpmaTnmoTmlrnms5XvvIzlm6DkuLrnm7TmjqXnp7vpmaTnmoTmlrnlvI/ml6Dms5Xlj5jlvIJcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXN1bHQsIFwiJHJlbW92ZVwiLCB7XHJcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXhPZihpdGVtKTtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL2JpbmQvTXV0YXRvci5qc1xuLy8gbW9kdWxlIGlkID0gNjZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IERpY3Rpb25hcnkgZnJvbSBcIi4uLy4uL3V0aWxzL0RpY3Rpb25hcnlcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTExLTA2XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTExLTA2XHJcbiAqXHJcbiAqIOWumuS5ieS4gOS4quS+nei1lu+8jOS4gOS4quinguWvn+iAheWunueOsFxyXG4qL1xyXG52YXIgRGVwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVwKCkge1xyXG4gICAgICAgIHRoaXMuX21hcCA9IG5ldyBEaWN0aW9uYXJ5KCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOaVsOaNruWPmOabtOiuoumYheiAhVxyXG4gICAgICogQHBhcmFtIHdhdGNoZXIg5pWw5o2u5Y+Y5pu06K6i6ZiF6ICFXHJcbiAgICAgKi9cclxuICAgIERlcC5wcm90b3R5cGUud2F0Y2ggPSBmdW5jdGlvbiAod2F0Y2hlcikge1xyXG4gICAgICAgIHRoaXMuX21hcC5zZXQod2F0Y2hlciwgd2F0Y2hlcik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmlbDmja7lj5jmm7TvvIzpgJrnn6XmiYDmnInorqLpmIXogIVcclxuICAgICAqIEBwYXJhbSBleHRyYSDlj6/og73nmoTpop3lpJbmlbDmja5cclxuICAgICAqL1xyXG4gICAgRGVwLnByb3RvdHlwZS5ub3RpZnkgPSBmdW5jdGlvbiAoZXh0cmEpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX21hcC5mb3JFYWNoKGZ1bmN0aW9uICh3YXRjaGVyKSB7XHJcbiAgICAgICAgICAgIGlmICh3YXRjaGVyLmRpc3Bvc2VkKVxyXG4gICAgICAgICAgICAgICAgLy8g6KeC5a+f6ICF5bey57uP6ZSA5q+B77yM56e76Zmk55uR5ZCsXHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fbWFwLmRlbGV0ZSh3YXRjaGVyKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgLy8g6KeC5a+f6ICF5L6d54S255Sf5pWI77yM5pu05paw5LmLXHJcbiAgICAgICAgICAgICAgICB3YXRjaGVyLnVwZGF0ZShleHRyYSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIERlcDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRGVwO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYmluZC9EZXAuanNcbi8vIG1vZHVsZSBpZCA9IDY3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGxpc3RlbkFwcGx5IH0gZnJvbSAnLi4vLi4vdXRpbHMvQ29uc3RydWN0VXRpbCc7XHJcbmltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCIuLi8uLi91dGlscy9EaWN0aW9uYXJ5XCI7XHJcbmltcG9ydCB7IGJpbmRNYW5hZ2VyIH0gZnJvbSBcIi4uL2JpbmQvQmluZE1hbmFnZXJcIjtcclxudmFyIG9uT3BlbkRpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG5leHBvcnQgZnVuY3Rpb24gbGlzdGVuT25PcGVuKHByb3RvdHlwZSwgYmVmb3JlLCBhZnRlcikge1xyXG4gICAgbGlzdGVuQXBwbHkocHJvdG90eXBlLmNvbnN0cnVjdG9yLCBcIm9uT3BlblwiLCBmdW5jdGlvbiAobWVkaWF0b3IpIHtcclxuICAgICAgICAvLyDorrDlvZVvbk9wZW7nr6HmlLnmrKHmlbBcclxuICAgICAgICB2YXIgY291bnQgPSBvbk9wZW5EaWN0LmdldChtZWRpYXRvcikgfHwgMDtcclxuICAgICAgICBvbk9wZW5EaWN0LnNldChtZWRpYXRvciwgY291bnQgKyAxKTtcclxuICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICBiZWZvcmUgJiYgYmVmb3JlKG1lZGlhdG9yKTtcclxuICAgIH0sIGZ1bmN0aW9uIChtZWRpYXRvcikge1xyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIGFmdGVyICYmIGFmdGVyKG1lZGlhdG9yKTtcclxuICAgICAgICAvLyDpgJLlh4/nr6HmlLnmrKHmlbBcclxuICAgICAgICB2YXIgY291bnQgPSBvbk9wZW5EaWN0LmdldChtZWRpYXRvcikgLSAxO1xyXG4gICAgICAgIG9uT3BlbkRpY3Quc2V0KG1lZGlhdG9yLCBjb3VudCk7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5ZCm5omA5pyJb25PcGVu6YO96LCD55So5a6M5q+V77yM5aaC5p6c5a6M5q+V5LqG77yM5YiZ5ZCv5Yqo57yW6K+R6L+H56iLXHJcbiAgICAgICAgaWYgKGNvdW50IDw9IDApIHtcclxuICAgICAgICAgICAgLy8g56e76Zmk5pWw5o2uXHJcbiAgICAgICAgICAgIG9uT3BlbkRpY3QuZGVsZXRlKG1lZGlhdG9yKTtcclxuICAgICAgICAgICAgLy8g5YWo6LCD55So5a6M5q+V5LqG77yM5oyJ5bGC57qn6aG65bqP55Sx5rWF5YWl5rex57yW6K+RXHJcbiAgICAgICAgICAgIHZhciBiaW5kVGFyZ2V0cyA9IG1lZGlhdG9yLmJpbmRUYXJnZXRzO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBkZXB0aCBpbiBiaW5kVGFyZ2V0cykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpY3QgPSBiaW5kVGFyZ2V0c1tkZXB0aF07XHJcbiAgICAgICAgICAgICAgICBkaWN0LmZvckVhY2goZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQpIHsgcmV0dXJuIGNvbXBpbGUobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQpOyB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiDojrflj5bmmL7npLrlr7nosaHlnKhtZWRpYXRvci5za2lu5Lit55qE5bWM5aWX5bGC57qnXHJcbiAqXHJcbiAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICogQHBhcmFtIHsqfSB0YXJnZXQg55uu5qCH5pi+56S65a+56LGhXHJcbiAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAqL1xyXG5mdW5jdGlvbiBnZXREZXB0aChtZWRpYXRvciwgdGFyZ2V0KSB7XHJcbiAgICB2YXIgc2tpbiA9IG1lZGlhdG9yLnNraW47XHJcbiAgICB2YXIgYnJpZGdlID0gbWVkaWF0b3IuYnJpZGdlO1xyXG4gICAgdmFyIGRlcHRoID0gMDtcclxuICAgIGlmIChicmlkZ2UuaXNNeVNraW4odGFyZ2V0KSkge1xyXG4gICAgICAgIHdoaWxlICh0YXJnZXQgJiYgdGFyZ2V0ICE9PSBza2luKSB7XHJcbiAgICAgICAgICAgIGRlcHRoKys7XHJcbiAgICAgICAgICAgIHRhcmdldCA9IGJyaWRnZS5nZXRQYXJlbnQodGFyZ2V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5aaC5p6c5pi+56S65a+56LGh5piv5rKh5pyJ5qC555qE77yM5oiW6ICF5LiN5Zyoc2tpbueahOaYvuekuuagkeS4re+8jOWImei/lOWbnjBcclxuICAgICAgICBpZiAoIXRhcmdldClcclxuICAgICAgICAgICAgZGVwdGggPSAwO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRlcHRoO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiBzZWFyY2hVSURlcHRoKHZhbHVlcywgbWVkaWF0b3IsIHRhcmdldCwgY2FsbGJhY2ssIGFkZHJlc3NpbmcpIHtcclxuICAgIGlmIChhZGRyZXNzaW5nID09PSB2b2lkIDApIHsgYWRkcmVzc2luZyA9IGZhbHNlOyB9XHJcbiAgICAvLyDojrflj5bmmL7npLrlsYLnuqdcclxuICAgIHZhciBkZXB0aCA9IGdldERlcHRoKG1lZGlhdG9yLCB0YXJnZXQpO1xyXG4gICAgLy8g5aaC5p6c5pyJ5Lit5pat57yW6K+R5YiZ5bCG6YGN5Y6G55qE5bel5L2c5o6o6L+f5Yiw5Lit5pat6YeN5ZCv5ZCO77yM5ZCm5YiZ55u05o6l5byA5aeL6YGN5Y6GXHJcbiAgICB2YXIgc3RvcExlZnRIYW5kbGVycyA9IHRhcmdldC5fX3N0b3BfbGVmdF9oYW5kbGVyc19fO1xyXG4gICAgaWYgKHN0b3BMZWZ0SGFuZGxlcnMpXHJcbiAgICAgICAgc3RvcExlZnRIYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xyXG4gICAgZWxzZVxyXG4gICAgICAgIGhhbmRsZXIodGFyZ2V0LCBtZWRpYXRvci5iaW5kVGFyZ2V0cywgc3RvcExlZnRIYW5kbGVycyk7XHJcbiAgICBmdW5jdGlvbiBoYW5kbGVyKHRhcmdldCwgYmluZFRhcmdldHMsIGxlZnRIYW5kbGVycykge1xyXG4gICAgICAgIHZhciBpbmRleCA9IC0xO1xyXG4gICAgICAgIGlmIChsZWZ0SGFuZGxlcnMpXHJcbiAgICAgICAgICAgIGluZGV4ID0gbGVmdEhhbmRsZXJzLmluZGV4T2YoaGFuZGxlcik7XHJcbiAgICAgICAgLy8g6YGN5Y6G57uR5a6a55qE55uu5qCH77yM5bCG57yW6K+R5oyH5Luk57uR5a6a5Yiw55uu5qCH6Lqr5LiK77yM6ICM5LiN5piv5oyH5Luk5omA5Zyo55qE5pi+56S65a+56LGh6Lqr5LiKXHJcbiAgICAgICAgc2VhcmNoVUkodmFsdWVzLCB0YXJnZXQsIGZ1bmN0aW9uIChjdXJyZW50VGFyZ2V0LCBuYW1lLCBleHAsIGRlcHRoKSB7XHJcbiAgICAgICAgICAgIGlmIChhZGRyZXNzaW5nKVxyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXRbbmFtZV07XHJcbiAgICAgICAgICAgIC8vIOiusOW9leW9k+WJjee8luivkeebruagh+WSjOWRveS7pOacrOS9k+ebruagh+WIsGJpbmRUYXJnZXRz5LitXHJcbiAgICAgICAgICAgIHZhciBkaWN0ID0gYmluZFRhcmdldHNbZGVwdGhdO1xyXG4gICAgICAgICAgICBpZiAoIWRpY3QpXHJcbiAgICAgICAgICAgICAgICBiaW5kVGFyZ2V0c1tkZXB0aF0gPSBkaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICAgICAgZGljdC5zZXQoY3VycmVudFRhcmdldCwgdGFyZ2V0KTtcclxuICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgbmFtZSwgZXhwLCBsZWZ0SGFuZGxlcnMsIGluZGV4KTtcclxuICAgICAgICB9LCBkZXB0aCk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0QmluZFBhcmFtcyhjdXJyZW50VGFyZ2V0KSB7XHJcbiAgICB2YXIgYmluZFBhcmFtcyA9IGN1cnJlbnRUYXJnZXQuX19iaW5kX2NvbW1hbmRzX187XHJcbiAgICBpZiAoIWJpbmRQYXJhbXMpIHtcclxuICAgICAgICBiaW5kUGFyYW1zID0gW107XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGN1cnJlbnRUYXJnZXQsIFwiX19iaW5kX2NvbW1hbmRzX19cIiwge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgdmFsdWU6IGJpbmRQYXJhbXNcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHJldHVybiBiaW5kUGFyYW1zO1xyXG59XHJcbi8qKlxyXG4gKiDmt7vliqDnvJbor5Hlkb3ku6TliLDmmL7npLrlr7nosaHkuIrvvIjmraPlkJHvvIlcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lDb21waWxlVGFyZ2V0fSBjdXJyZW50VGFyZ2V0IOaYvuekuuWvueixoVxyXG4gKiBAcGFyYW0geyp9IHRhcmdldCDnvJbor5Hlkb3ku6TmnKzmnaXmiYDlnKjnmoTlr7nosaFcclxuICogQHBhcmFtIHtJQmluZENvbW1hbmR9IGNtZCDlkb3ku6Tlh73mlbBcclxuICogQHBhcmFtIHsuLi5hbnlbXX0gYXJncyDlkb3ku6Tlj4LmlbDliJfooahcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwdXNoQ29tcGlsZUNvbW1hbmQoY3VycmVudFRhcmdldCwgdGFyZ2V0LCBjbWQpIHtcclxuICAgIHZhciBhcmdzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICB9XHJcbiAgICAvLyDmt7vliqDnvJbor5HmjIfku6RcclxuICAgIGdldEJpbmRQYXJhbXMoY3VycmVudFRhcmdldCkucHVzaCh7IGNtZDogY21kLCB0YXJnZXQ6IHRhcmdldCwgYXJnczogYXJncyB9KTtcclxufVxyXG4vKipcclxuICog5re75Yqg57yW6K+R5ZG95Luk5Yiw5pi+56S65a+56LGh5LiK77yI5Y+N5ZCR77yJXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtJQ29tcGlsZVRhcmdldH0gY3VycmVudFRhcmdldCDmmL7npLrlr7nosaFcclxuICogQHBhcmFtIHsqfSB0YXJnZXQg57yW6K+R5ZG95Luk5pys5p2l5omA5Zyo55qE5a+56LGhXHJcbiAqIEBwYXJhbSB7SUJpbmRDb21tYW5kfSBjbWQg5ZG95Luk5Ye95pWwXHJcbiAqIEBwYXJhbSB7Li4uYW55W119IGFyZ3Mg5ZG95Luk5Y+C5pWw5YiX6KGoXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdW5zaGlmdENvbXBpbGVDb21tYW5kKGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgY21kKSB7XHJcbiAgICB2YXIgYXJncyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBhcmdzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgZ2V0QmluZFBhcmFtcyhjdXJyZW50VGFyZ2V0KS51bnNoaWZ0KHsgY21kOiBjbWQsIHRhcmdldDogdGFyZ2V0LCBhcmdzOiBhcmdzIH0pO1xyXG59XHJcbi8qKlxyXG4gKiDnvJbor5HmmL7npLrlr7nosaHvvIzkvJrlhYjnvJbor5Hoh6rouqvvvIznhLblkI7lho3pgJLlvZLnvJbor5HlrZDlr7nosaFcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0lNZWRpYXRvcn0gbWVkaWF0b3Ig5pi+56S65a+56LGh5omA5bGe55qE5Lit5LuL6ICFXHJcbiAqIEBwYXJhbSB7SUNvbXBpbGVUYXJnZXR9IGN1cnJlbnRUYXJnZXQg5pi+56S65a+56LGhXHJcbiAqIEBwYXJhbSB7YW55W119IFtlbnZNb2RlbHNdIOeOr+Wig+WPmOmHj+aVsOe7hFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGUobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIGVudk1vZGVscykge1xyXG4gICAgLy8g5Y+W5Yiw57yW6K+R5Y+C5pWw5YiX6KGoXHJcbiAgICB2YXIgYmluZFBhcmFtcyA9IGN1cnJlbnRUYXJnZXQuX19iaW5kX2NvbW1hbmRzX187XHJcbiAgICAvLyDnvJbor5FjdXJyZW50VGFyZ2V06Ieq6LqrXHJcbiAgICBpZiAoYmluZFBhcmFtcykge1xyXG4gICAgICAgIC8vIOi/memHjOayoeacieaPkOWJjeivu+WPluWHumxlbmd0aOWxnuaAp++8jOWboOS4uumcgOimgeWKqOaAgeWIpOaWreaVsOe7hOmVv+W6plxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYmluZFBhcmFtcy5sZW5ndGg7KSB7XHJcbiAgICAgICAgICAgIC8vIOS9v+eUqHNoaWZ05oyJ6aG65bqP5Y+W5Ye657yW6K+R5ZG95LukXHJcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBiaW5kUGFyYW1zLnNoaWZ0KCk7XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOe8luivkeWRveS7pO+8jOW5tuS4lOabtOaWsOS4reatoueKtuaAgVxyXG4gICAgICAgICAgICBwYXJhbXMuY21kLmFwcGx5KHBhcmFtcywgW21lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCBwYXJhbXMudGFyZ2V0LCBlbnZNb2RlbHMgfHwgW11dLmNvbmNhdChwYXJhbXMuYXJncykpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICog57yW6K+RYmluZFZhbHVl5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZVZhbHVlKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgbmFtZSwgZXhwKSB7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kVmFsdWUobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lLCBleHApO1xyXG59XHJcbi8qKlxyXG4gKiDnvJbor5FiaW5kRXhw5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZUV4cChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCkge1xyXG4gICAgYmluZE1hbmFnZXIuYmluZEV4cChtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIGV4cCk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRGdW5j5ZG95Luk77yM5LiN5Lya5Lit5q2i57yW6K+RXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZUZ1bmMobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lKSB7XHJcbiAgICB2YXIgYXJnRXhwcyA9IFtdO1xyXG4gICAgZm9yICh2YXIgX2kgPSA1OyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICBhcmdFeHBzW19pIC0gNV0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgfVxyXG4gICAgYmluZE1hbmFnZXIuYmluZEZ1bmMuYXBwbHkoYmluZE1hbmFnZXIsIFttZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIG5hbWVdLmNvbmNhdChhcmdFeHBzKSk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRPbuWRveS7pO+8jOS4jeS8muS4reatoue8luivkVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVPbihtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIHR5cGUsIGV4cCkge1xyXG4gICAgYmluZE1hbmFnZXIuYmluZE9uKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgZXhwKTtcclxufVxyXG5mdW5jdGlvbiBpc1Bvc3Rlcml0eShtZWRpYXRvciwgdGFyZ2V0LCBwYXJlbnQpIHtcclxuICAgIHZhciB0ZW1wUGFyZW50ID0gbWVkaWF0b3IuYnJpZGdlLmdldFBhcmVudCh0YXJnZXQpO1xyXG4gICAgaWYgKCF0ZW1wUGFyZW50KVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIGVsc2UgaWYgKHRlbXBQYXJlbnQgPT09IHBhcmVudClcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIGVsc2VcclxuICAgICAgICByZXR1cm4gaXNQb3N0ZXJpdHkobWVkaWF0b3IsIHRlbXBQYXJlbnQsIHBhcmVudCk7XHJcbn1cclxuZnVuY3Rpb24gZ2V0QWxsU3ViVGFyZ2V0cyhtZWRpYXRvciwgdGFyZ2V0KSB7XHJcbiAgICB2YXIgYmluZFRhcmdldHMgPSBtZWRpYXRvci5iaW5kVGFyZ2V0cztcclxuICAgIHZhciBzdWJUYXJnZXRzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIGJpbmRUYXJnZXRzXzEgPSBiaW5kVGFyZ2V0czsgX2kgPCBiaW5kVGFyZ2V0c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBiaW5kVGFyZ2V0ID0gYmluZFRhcmdldHNfMVtfaV07XHJcbiAgICAgICAgYmluZFRhcmdldCAmJiBiaW5kVGFyZ2V0LmZvckVhY2goZnVuY3Rpb24gKHRlbXBUYXJnZXQpIHtcclxuICAgICAgICAgICAgaWYgKGlzUG9zdGVyaXR5KG1lZGlhdG9yLCB0ZW1wVGFyZ2V0LCB0YXJnZXQpKVxyXG4gICAgICAgICAgICAgICAgc3ViVGFyZ2V0cy5wdXNoKHRlbXBUYXJnZXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN1YlRhcmdldHM7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRJZuWRveS7pO+8jOS8muS4reatoue8luivke+8jOebtOWIsOWIpOaWreadoeS7tuS4unRydWXml7bmiY3kvJrlkK/liqjku6Xnu6fnu63nvJbor5FcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlSWYobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBleHApIHtcclxuICAgIC8vIOWwhuWQjumdoueahOe8luivkeWRveS7pOe8k+WtmOi1t+adpVxyXG4gICAgdmFyIGJpbmRQYXJhbXMgPSBjdXJyZW50VGFyZ2V0Ll9fYmluZF9jb21tYW5kc19fO1xyXG4gICAgdmFyIGNhY2hlcyA9IFt7IHRhcmdldDogY3VycmVudFRhcmdldCwgcGFyYW1zOiBiaW5kUGFyYW1zLnNwbGljZSgwLCBiaW5kUGFyYW1zLmxlbmd0aCkgfV07XHJcbiAgICAvLyDlkI7ku6PoioLngrnnmoTkuZ/opoHnvJPlrZjkvY9cclxuICAgIHZhciBzdWJUYXJnZXRzID0gZ2V0QWxsU3ViVGFyZ2V0cyhtZWRpYXRvciwgY3VycmVudFRhcmdldCk7XHJcbiAgICBmb3IgKHZhciBfaSA9IDAsIHN1YlRhcmdldHNfMSA9IHN1YlRhcmdldHM7IF9pIDwgc3ViVGFyZ2V0c18xLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHZhciBzdWJUYXJnZXQgPSBzdWJUYXJnZXRzXzFbX2ldO1xyXG4gICAgICAgIHZhciBzdWJCaW5kUGFyYW1zID0gc3ViVGFyZ2V0Ll9fYmluZF9jb21tYW5kc19fO1xyXG4gICAgICAgIGNhY2hlcy5wdXNoKHsgdGFyZ2V0OiBzdWJUYXJnZXQsIHBhcmFtczogc3ViQmluZFBhcmFtcy5zcGxpY2UoMCwgc3ViQmluZFBhcmFtcy5sZW5ndGgpIH0pO1xyXG4gICAgfVxyXG4gICAgLy8g57uR5a6aaWblkb3ku6RcclxuICAgIHZhciB0ZXJtaW5hdGVkID0gZmFsc2U7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kSWYobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBleHAsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgIC8vIOWmguaenOadoeS7tuS4unRydWXvvIzliJnlkK/liqjnu6fnu63nvJbor5HvvIzkvYblj6rnvJbor5HkuIDmrKHvvIznvJbor5Hov4flsLHkuI3pnIDopoHlho3nvJbor5HkuoZcclxuICAgICAgICBpZiAoIXRlcm1pbmF0ZWQgJiYgdmFsdWUpIHtcclxuICAgICAgICAgICAgLy8g5oGi5aSN5ZCO6Z2i55qE5ZG95LukXHJcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgY2FjaGVzXzEgPSBjYWNoZXM7IF9pIDwgY2FjaGVzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2FjaGUgPSBjYWNoZXNfMVtfaV07XHJcbiAgICAgICAgICAgICAgICBjYWNoZS50YXJnZXQuX19iaW5kX2NvbW1hbmRzX18gPSBjYWNoZS5wYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAvLyDnu6fnu63nvJbor5FcclxuICAgICAgICAgICAgICAgIGNvbXBpbGUobWVkaWF0b3IsIGNhY2hlLnRhcmdldCwgZW52TW9kZWxzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDorr7nva7lt7Lnu4jnu5PmoIfor4ZcclxuICAgICAgICAgICAgdGVybWluYXRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRGb3Llkb3ku6TvvIzkvJrkuK3mraLnvJbor5HvvIznm7TliLDnlJ/miJDmlrDnmoRyZW5kZXJlcuWunuS+i+aXtuaJjeS8mue7p+e7ree8luivkeaWsOWunuS+i1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVGb3IobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHRhcmdldCwgZW52TW9kZWxzLCBuYW1lLCBleHAsIG1lZGlhdG9yQ2xzLCBkZWNsYXJlZE1lZGlhdG9yQ2xzLCBkYXRhRXhwKSB7XHJcbiAgICAvLyDlsIblkI7pnaLnmoTnvJbor5Hlkb3ku6TnvJPlrZjotbfmnaVcclxuICAgIHZhciBsZWZ0SGFuZGxlcnMgPSB0YXJnZXQuX19zdG9wX2xlZnRfaGFuZGxlcnNfXztcclxuICAgIC8vIOe7keWummZvcuWRveS7pFxyXG4gICAgYmluZE1hbmFnZXIuYmluZEZvcihtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIG5hbWUsIGV4cCwgbWVkaWF0b3JDbHMsIGRlY2xhcmVkTWVkaWF0b3JDbHMsIGRhdGFFeHAsIGZ1bmN0aW9uIChkYXRhLCByZW5kZXJlciwgc3ViRW52TW9kZWxzKSB7XHJcbiAgICAgICAgdmFyIHN1YkxlZnRIYW5kbGVycyA9IGxlZnRIYW5kbGVycy5jb25jYXQoKTtcclxuICAgICAgICB2YXIgYmluZFRhcmdldHMgPSBbXTtcclxuICAgICAgICAvLyDpkojlr7nmr4/kuIDkuKpyZW5kZXJlcui1i+WAvOWQjue7ree8luivkeaMh+S7pFxyXG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgc3ViTGVmdEhhbmRsZXJzXzEgPSBzdWJMZWZ0SGFuZGxlcnM7IF9pIDwgc3ViTGVmdEhhbmRsZXJzXzEubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBsZWZ0SGFuZGxlciA9IHN1YkxlZnRIYW5kbGVyc18xW19pXTtcclxuICAgICAgICAgICAgbGVmdEhhbmRsZXIocmVuZGVyZXIsIGJpbmRUYXJnZXRzLCBzdWJMZWZ0SGFuZGxlcnMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyDnvJbor5FyZW5kZXJlcuWunuS+i1xyXG4gICAgICAgIGZvciAodmFyIGRlcHRoIGluIGJpbmRUYXJnZXRzKSB7XHJcbiAgICAgICAgICAgIHZhciBkaWN0ID0gYmluZFRhcmdldHNbZGVwdGhdO1xyXG4gICAgICAgICAgICBkaWN0LmZvckVhY2goZnVuY3Rpb24gKGN1cnJlbnRUYXJnZXQpIHsgcmV0dXJuIGNvbXBpbGUobWVkaWF0b3IsIGN1cnJlbnRUYXJnZXQsIHN1YkVudk1vZGVscyk7IH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8qKlxyXG4gKiDnvJbor5FiaW5kTWVzc2FnZeWRveS7pO+8jOS4jeS8muS4reatoue8luivkVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVNZXNzYWdlKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgbmFtZSwgZXhwLCBvYnNlcnZhYmxlKSB7XHJcbiAgICBiaW5kTWFuYWdlci5iaW5kTWVzc2FnZShtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIHR5cGUsIG5hbWUsIGV4cCwgb2JzZXJ2YWJsZSk7XHJcbn1cclxuLyoqXHJcbiAqIOe8luivkWJpbmRSZXNwb25zZeWRveS7pO+8jOS4jeS8muS4reatoue8luivkVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVSZXNwb25zZShtZWRpYXRvciwgY3VycmVudFRhcmdldCwgdGFyZ2V0LCBlbnZNb2RlbHMsIHR5cGUsIG5hbWUsIGV4cCwgb2JzZXJ2YWJsZSkge1xyXG4gICAgYmluZE1hbmFnZXIuYmluZFJlc3BvbnNlKG1lZGlhdG9yLCBjdXJyZW50VGFyZ2V0LCB0YXJnZXQsIGVudk1vZGVscywgdHlwZSwgbmFtZSwgZXhwLCBvYnNlcnZhYmxlKTtcclxufVxyXG4vKipcclxuICog5pCc57SiVUnvvIzlj5bliLDnm67moIfoioLngrnvvIzmiafooYzlm57osINcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyp9IHZhbHVlcyDlgLznu5PmnoTlrZflhbhcclxuICogQHBhcmFtIHsqfSB1aSB1aeWunuS9k1xyXG4gKiBAcGFyYW0geyh1aTphbnksIGtleTpzdHJpbmcsIHZhbHVlOmFueSwgZGVwdGg/Om51bWJlcik9PnZvaWR9IGNhbGxiYWNrIOWbnuiwg1xyXG4gKiBAcGFyYW0ge251bWJlcn0gW2RlcHRoPTBdIOmBjeWOhua3seW6pu+8jOaWueazleS8mue7p+e7reWinuWKoOi/meS4qua3seW6plxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNlYXJjaFVJKHZhbHVlcywgdWksIGNhbGxiYWNrLCBkZXB0aCkge1xyXG4gICAgaWYgKGRlcHRoID09PSB2b2lkIDApIHsgZGVwdGggPSAwOyB9XHJcbiAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWVzKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gdmFsdWVzW2tleV07XHJcbiAgICAgICAgdmFyIGluZGV4ID0ga2V5LmluZGV4T2YoXCIuXCIpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIOaYr+ihqOi+vuW8j+Wvu+WdgO+8jOmAkuW9kuWvu+WdgFxyXG4gICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB7fTtcclxuICAgICAgICAgICAgbmV3VmFsdWVba2V5LnN1YnN0cihpbmRleCArIDEpXSA9IHZhbHVlO1xyXG4gICAgICAgICAgICBzZWFyY2hVSShuZXdWYWx1ZSwgdWlba2V5LnN1YnN0cmluZygwLCBpbmRleCldLCBjYWxsYmFjaywgZGVwdGggKyAxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09IFwib2JqZWN0XCIgJiYgISh2YWx1ZSBpbnN0YW5jZW9mIEFycmF5KSkge1xyXG4gICAgICAgICAgICAvLyDmmK/lrZDlr7nosaHlr7vlnYDvvIzpgJLlvZLlr7vlnYBcclxuICAgICAgICAgICAgc2VhcmNoVUkodmFsdWUsIHVpW2tleV0sIGNhbGxiYWNrLCBkZXB0aCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g5piv6KGo6L6+5byP77yM6LCD55So5Zue6LCD77yM5bCG6LCD55So5bGC57qn5Lmf5Lyg6YCS5Zue5Y67XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKHVpLCBrZXksIHZhbHVlLCBkZXB0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9CaW5kVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNjhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCJvbHltcHVzLXIvdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgRE9NQnJpZGdlIGZyb20gXCIuLi8uLi9ET01CcmlkZ2VcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTI1XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTI1XHJcbiAqXHJcbiAqIERPTemBrue9qeWunueOsFxyXG4qL1xyXG52YXIgTWFza0VudGl0eUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNYXNrRW50aXR5SW1wbChwYXJhbXMpIHtcclxuICAgICAgICB0aGlzLl9tYXNrQWxwaGEgPSAwLjU7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ0FscGhhID0gMC41O1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxBbHBoYSA9IDAuNTtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHBhcmFtcyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21hc2tBbHBoYSA9IChwYXJhbXMubWFza0FscGhhICE9IG51bGwgPyBwYXJhbXMubWFza0FscGhhIDogMC41KTtcclxuICAgICAgICAgICAgdGhpcy5fbG9hZGluZ0FscGhhID0gKHBhcmFtcy5sb2FkaW5nQWxwaGEgIT0gbnVsbCA/IHBhcmFtcy5sb2FkaW5nQWxwaGEgOiAwLjUpO1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsQWxwaGEgPSAocGFyYW1zLm1vZGFsUGFuZWxBbHBoYSAhPSBudWxsID8gcGFyYW1zLm1vZGFsUGFuZWxBbHBoYSA6IDAuNSk7XHJcbiAgICAgICAgICAgIC8vIOWIneWni+WMlmxvYWRpbmfnmq7ogqRcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbXMubG9hZGluZ1NraW4gPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgICAgICAgICAgdGVtcC5pbm5lckhUTUwgPSBwYXJhbXMubG9hZGluZ1NraW47XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMubG9hZGluZ1NraW4gPSB0ZW1wO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NraW4gPSBwYXJhbXMubG9hZGluZ1NraW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWFza0RhdGEgPSBwYXJhbXMgfHwge307XHJcbiAgICAgICAgdGhpcy5fbWFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxEaWN0ID0gbmV3IERpY3Rpb25hcnkoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTGlzdCA9IFtdO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5pi+56S66YGu572pXHJcbiAgICAgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5zaG93TWFzayA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zaG93aW5nTWFzaylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdNYXNrID0gdHJ1ZTtcclxuICAgICAgICAvLyDmmL7npLpcclxuICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRE9NQnJpZGdlLlRZUEUpO1xyXG4gICAgICAgIC8vIOe7mOWItumBrue9qVxyXG4gICAgICAgIGlmIChhbHBoYSA9PSBudWxsKVxyXG4gICAgICAgICAgICBhbHBoYSA9IHRoaXMuX21hc2tBbHBoYTtcclxuICAgICAgICB0aGlzLl9tYXNrLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAwMFwiO1xyXG4gICAgICAgIHRoaXMuX21hc2suc3R5bGUub3BhY2l0eSA9IGFscGhhLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5fbWFzay5zdHlsZS53aWR0aCA9IFwiMTAwJVwiO1xyXG4gICAgICAgIHRoaXMuX21hc2suc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgYnJpZGdlLm1hc2tMYXllci5hcHBlbmRDaGlsZCh0aGlzLl9tYXNrKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmakOiXj+mBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaGlkZU1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zaG93aW5nTWFzaylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdNYXNrID0gZmFsc2U7XHJcbiAgICAgICAgLy8g6ZqQ6JePXHJcbiAgICAgICAgaWYgKHRoaXMuX21hc2sucGFyZW50RWxlbWVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLl9tYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fbWFzayk7XHJcbiAgICB9O1xyXG4gICAgLyoq5b2T5YmN5piv5ZCm5Zyo5pi+56S66YGu572pKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5pc1Nob3dpbmdNYXNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaG93aW5nTWFzaztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuWKoOi9veWbvlxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuc2hvd0xvYWRpbmcgPSBmdW5jdGlvbiAoYWxwaGEpIHtcclxuICAgICAgICBpZiAodGhpcy5fc2hvd2luZ0xvYWRpbmcpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTG9hZGluZyA9IHRydWU7XHJcbiAgICAgICAgLy8g5pi+56S6XHJcbiAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKERPTUJyaWRnZS5UWVBFKTtcclxuICAgICAgICAvLyDnu5jliLbpga7nvalcclxuICAgICAgICBpZiAoYWxwaGEgPT0gbnVsbClcclxuICAgICAgICAgICAgYWxwaGEgPSB0aGlzLl9sb2FkaW5nQWxwaGE7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMDAwXCI7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suc3R5bGUub3BhY2l0eSA9IGFscGhhLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcclxuICAgICAgICAvLyDmt7vliqDmmL7npLpcclxuICAgICAgICBicmlkZ2UubWFza0xheWVyLmFwcGVuZENoaWxkKHRoaXMuX2xvYWRpbmdNYXNrKTtcclxuICAgICAgICAvLyDmt7vliqBsb2FkaW5n55qu6IKkXHJcbiAgICAgICAgaWYgKHRoaXMubG9hZGluZ1NraW4pXHJcbiAgICAgICAgICAgIGJyaWRnZS5tYXNrTGF5ZXIuYXBwZW5kQ2hpbGQodGhpcy5sb2FkaW5nU2tpbik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDpmpDol4/liqDovb3lm75cclxuICAgICAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmhpZGVMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5fc2hvd2luZ0xvYWRpbmcpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIC8vIOmakOiXj1xyXG4gICAgICAgIGlmICh0aGlzLl9sb2FkaW5nTWFzay5wYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fbG9hZGluZ01hc2spO1xyXG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmdTa2luICE9IG51bGwgJiYgdGhpcy5sb2FkaW5nU2tpbi5wYXJlbnRFbGVtZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMubG9hZGluZ1NraW4ucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLmxvYWRpbmdTa2luKTtcclxuICAgIH07XHJcbiAgICAvKirlvZPliY3mmK/lkKblnKjmmL7npLpsb2FkaW5nKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5pc1Nob3dpbmdMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaG93aW5nTG9hZGluZztcclxuICAgIH07XHJcbiAgICAvKiog5pi+56S65qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuc2hvd01vZGFsTWFzayA9IGZ1bmN0aW9uIChwYW5lbCwgYWxwaGEpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1Nob3dpbmdNb2RhbE1hc2socGFuZWwpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbERpY3Quc2V0KHBhbmVsLCBwYW5lbCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbExpc3QucHVzaChwYW5lbCk7XHJcbiAgICAgICAgLy8g57uY5Yi26YGu572pXHJcbiAgICAgICAgaWYgKGFscGhhID09IG51bGwpXHJcbiAgICAgICAgICAgIGFscGhhID0gdGhpcy5fbW9kYWxQYW5lbEFscGhhO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiIzAwMFwiO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnN0eWxlLm9wYWNpdHkgPSBhbHBoYS50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnN0eWxlLndpZHRoID0gXCIxMDAlXCI7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2suc3R5bGUuaGVpZ2h0ID0gXCIxMDAlXCI7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgdmFyIGVudGl0eSA9IHBhbmVsLnNraW47XHJcbiAgICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIGlmIChwYXJlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50RWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbFBhbmVsTWFzayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGJyaWRnZSA9IGJyaWRnZU1hbmFnZXIuZ2V0QnJpZGdlKERPTUJyaWRnZS5UWVBFKTtcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gYnJpZGdlLmdldENoaWxkSW5kZXgocGFyZW50LCBlbnRpdHkpO1xyXG4gICAgICAgICAgICBicmlkZ2UuYWRkQ2hpbGRBdChwYXJlbnQsIHRoaXMuX21vZGFsUGFuZWxNYXNrLCBpbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDpmpDol4/mqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5oaWRlTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzU2hvd2luZ01vZGFsTWFzayhwYW5lbCkpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsRGljdC5kZWxldGUocGFuZWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxMaXN0LnNwbGljZSh0aGlzLl9tb2RhbFBhbmVsTGlzdC5pbmRleE9mKHBhbmVsKSwgMSk7XHJcbiAgICAgICAgLy8g5Yik5pat5piv5ZCm6L+Y6ZyA6KaBTWFza1xyXG4gICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTGlzdC5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAvLyDpmpDol49cclxuICAgICAgICAgICAgaWYgKHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudEVsZW1lbnQgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g56e75YqoTWFza1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fbW9kYWxQYW5lbExpc3RbdGhpcy5fbW9kYWxQYW5lbExpc3QubGVuZ3RoIC0gMV0uc2tpbjtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgICAgICBpZiAocGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbFBhbmVsTWFzayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRE9NQnJpZGdlLlRZUEUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gYnJpZGdlLmdldENoaWxkSW5kZXgocGFyZW50LCBlbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgYnJpZGdlLmFkZENoaWxkQXQocGFyZW50LCB0aGlzLl9tb2RhbFBhbmVsTWFzaywgaW5kZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKiDlvZPliY3mmK/lkKblnKjmmL7npLrmqKHmgIHnqpflj6Ppga7nvakgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5pc1Nob3dpbmdNb2RhbE1hc2sgPSBmdW5jdGlvbiAocGFuZWwpIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMuX21vZGFsUGFuZWxEaWN0LmdldChwYW5lbCkgIT0gbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE1hc2tFbnRpdHlJbXBsO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBNYXNrRW50aXR5SW1wbDtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9tYXNrL01hc2tFbnRpdHkuanNcbi8vIG1vZHVsZSBpZCA9IDY5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGFzc2V0c01hbmFnZXIgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9hc3NldHMvQXNzZXRzTWFuYWdlclwiO1xyXG5pbXBvcnQgTWVkaWF0b3JTdGF0dXMgZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3JTdGF0dXNcIjtcclxuaW1wb3J0IHsgbGlzdGVuQXBwbHkgfSBmcm9tICdvbHltcHVzLXIvdXRpbHMvQ29uc3RydWN0VXRpbCc7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0yNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0yNlxyXG4gKlxyXG4gKiDkuLpET03mj5Dkvpvnmq7ogqTovazmjaLnmoTlt6Xlhbfpm4ZcclxuKi9cclxuLyoqXHJcbiAqIOS4uuS4reS7i+iAheWMheijheearuiCpFxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7SU1lZGlhdG9yfSBtZWRpYXRvciDkuK3ku4vogIVcclxuICogQHBhcmFtIHsoSFRNTEVsZW1lbnR8c3RyaW5nfHN0cmluZ1tdKX0gc2tpbiDnmq7ogqTvvIzlj6/ku6XmmK9IVE1MRWxlbWVudO+8jOS5n+WPr+S7peaYr+earuiCpOWtl+espuS4su+8jOS5n+WPr+S7peaYr+earuiCpOaooeadv+WcsOWdgOaIluWcsOWdgOaVsOe7hFxyXG4gKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9IOearuiCpOeahEhUTUxFbGVtZW505b2i5byP77yM5Y+v6IO95Lya56iN5ZCO5YaN5aGr5YWF5YaF5a6577yM5aaC5p6c5oOz5Zyo55qu6IKk5Yqg6L295a6M5q+V5ZCO5YaN5ou/5Yiw55qu6IKk6K+35L2/55SoY29tcGxldGXlj4LmlbBcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB3cmFwU2tpbihtZWRpYXRvciwgc2tpbikge1xyXG4gICAgdmFyIHJlc3VsdCA9IChza2luIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgPyBza2luIDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7XHJcbiAgICAvLyDliKTmlq3kuK3ku4vogIXlvZPliY3nirbmgIFcclxuICAgIGlmIChtZWRpYXRvci5zdGF0dXMgPCBNZWRpYXRvclN0YXR1cy5PUEVOSU5HKSB7XHJcbiAgICAgICAgbGlzdGVuQXBwbHkobWVkaWF0b3IsIFwib25PcGVuXCIsIGRvV3JhcFNraW4pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgLy8g55u05o6l5omn6KGM6KaB5omn6KGM55qEXHJcbiAgICAgICAgZG9XcmFwU2tpbigpO1xyXG4gICAgfVxyXG4gICAgLy8g5ZCM5q2l6L+U5Zue55qu6IKkXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgZnVuY3Rpb24gZG9XcmFwU2tpbigpIHtcclxuICAgICAgICBpZiAoc2tpbiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIC8vIOaLt+i0neW8leeUqFxyXG4gICAgICAgICAgICBkb0NvcHlSZWYocmVzdWx0LCBza2luLmlubmVySFRNTCwgbWVkaWF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g6L2s5o2i55qu6IKkXHJcbiAgICAgICAgICAgIHNraW4gPSBnZXRIVE1MQ29udGVudChza2luKTtcclxuICAgICAgICAgICAgLy8g6LWL5YC855qu6IKk5YaF5a65XHJcbiAgICAgICAgICAgIHJlc3VsdC5pbm5lckhUTUwgPSBza2luO1xyXG4gICAgICAgICAgICAvLyDmi7fotJ3lvJXnlKhcclxuICAgICAgICAgICAgZG9Db3B5UmVmKHJlc3VsdCwgc2tpbiwgbWVkaWF0b3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICog5Yik5pat5piv5ZCm5pivRE9N5a2X56ym5LiyXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0ciDlrZfnrKbkuLJcclxuICogQHJldHVybnMge2Jvb2xlYW59XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNET01TdHIoc3RyKSB7XHJcbiAgICByZXR1cm4gc3RyICYmIChzdHIuaW5kZXhPZihcIjxcIikgPj0gMCAmJiBzdHIuaW5kZXhPZihcIj5cIikgPj0gMCk7XHJcbn1cclxudmFyIHJlZyA9IC8oXFwuaHRtfFxcLmh0bWx8XFwudHBsKSQvO1xyXG4vKipcclxuICog5Yik5pat5piv5ZCm5pivRE9N5qih5p2/6Lev5b6EXHJcbiAqXHJcbiAqIEBleHBvcnRcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGgg6Lev5b6E5a2X56ym5LiyXHJcbiAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRE9NUGF0aChwYXRoKSB7XHJcbiAgICByZXR1cm4gcGF0aCAmJiByZWcudGVzdChwYXRoKTtcclxufVxyXG4vKipcclxuICog5bCGZnJvbeS4reeahOaJgOacieaLpeaciWlk5bGe5oCn55qE6IqC54K55byV55So5aSN5Yi25YiwdG/lr7nosaHkuIpcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBmcm9tIOWkjeWItua6kERPTeiKgueCuVxyXG4gKiBAcGFyYW0geyp9IHRvIOWkjeWItuebruagh+WvueixoVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNvcHlSZWYoZnJvbSwgdG8pIHtcclxuICAgIGRvQ29weVJlZihmcm9tLCBmcm9tLmlubmVySFRNTCwgdG8pO1xyXG59XHJcbmZ1bmN0aW9uIGRvQ29weVJlZihmcm9tRWxlLCBmcm9tU3RyLCB0bykge1xyXG4gICAgLy8g5L2/55So5q2j5YiZ6KGo6L6+5byP5bCG5oul5pyJaWTnmoToioLngrnotYvlgLznu5ltZWRpYXRvclxyXG4gICAgdmFyIHJlZyA9IC9pZD0oXCIoW15cIl0rKVwifCcoW14nXSspJykvZztcclxuICAgIHZhciByZXM7XHJcbiAgICB3aGlsZSAocmVzID0gcmVnLmV4ZWMoZnJvbVN0cikpIHtcclxuICAgICAgICB2YXIgaWQgPSByZXNbMl0gfHwgcmVzWzNdO1xyXG4gICAgICAgIHRvW2lkXSA9IGZyb21FbGUucXVlcnlTZWxlY3RvcihcIiNcIiArIGlkKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICog6L2s5o2i55qu6IKk5Li6SFRNTEVsZW1lbnRcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0geyhIVE1MRWxlbWVudHxzdHJpbmd8c3RyaW5nW10pfSBza2luIOearuiCpFxyXG4gKiBAcmV0dXJucyB7SFRNTEVsZW1lbnR9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9IVE1MRWxlbWVudChza2luKSB7XHJcbiAgICBpZiAoc2tpbiBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIHJldHVybiBza2luO1xyXG4gICAgdmFyIHJlc3VsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICByZXN1bHQuaW5uZXJIVE1MID0gZ2V0SFRNTENvbnRlbnQoc2tpbik7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8qKlxyXG4gKiDlsIbnmq7ogqTlrZfnrKbkuLIv5a2X56ym5Liy5pWw57uE5oiW55qu6IKk6Lev5b6E6L2s5Y+Y5Li6SFRNTOWGheWuueWtl+espuS4slxyXG4gKlxyXG4gKiBAZXhwb3J0XHJcbiAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IHNraW4g5Y+v5Lul5piv55qu6IKk5a2X56ym5Liy44CB55qu6IKk5a2X56ym5Liy5pWw57uE5oiW55qu6IKk6Lev5b6EXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SFRNTENvbnRlbnQoc2tpbikge1xyXG4gICAgaWYgKHNraW4gaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIC8vIOaYr+Wtl+espuS4suaVsOe7hO+8jOaLhuWIhuWQjuearuiCpOWMluWGjei/nuaOpei1t+adpVxyXG4gICAgICAgIHJldHVybiBza2luLm1hcChnZXRIVE1MQ29udGVudCkuam9pbihcIlwiKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGlzRE9NU3RyKHNraW4pKSB7XHJcbiAgICAgICAgLy8g5piv55qu6IKk5a2X56ym5Liy77yM55u05o6l6L+U5ZueXHJcbiAgICAgICAgcmV0dXJuIHNraW47XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyDmmK/nmq7ogqTot6/lvoTmiJbot6/lvoTnn63lkI3np7DvvIzojrflj5blkI7ov5Tlm55cclxuICAgICAgICByZXR1cm4gYXNzZXRzTWFuYWdlci5nZXRBc3NldHMoc2tpbik7XHJcbiAgICB9XHJcbn1cclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS91dGlscy9Ta2luVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gNzBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgVHdlZW4sIEVhc2luZyB9IGZyb20gXCJAdHdlZW5qcy90d2Vlbi5qc1wiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMjJcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMjJcclxuICpcclxuICog5Zue5by55pWI5p6cXHJcbiovXHJcbnZhciBCYWNrUGFuZWxQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCYWNrUGFuZWxQb2xpY3koKSB7XHJcbiAgICAgICAgdGhpcy5fcmVnID0gLyhcXHcqKShcXGQrKShcXHcqKS87XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOaYvuekuuaXtuiwg+eUqFxyXG4gICAgICogQHBhcmFtIHBhbmVsIOW8ueWHuuahhuWvueixoVxyXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIOWujOaIkOWbnuiwg++8jOW/hemhu+iwg+eUqFxyXG4gICAgICogQHBhcmFtIGZyb20g5Yqo55S76LW35aeL54K5XHJcbiAgICAgKi9cclxuICAgIEJhY2tQYW5lbFBvbGljeS5wcm90b3R5cGUucG9wID0gZnVuY3Rpb24gKHBhbmVsLCBjYWxsYmFjaywgZnJvbSkge1xyXG4gICAgICAgIHZhciBlbnRpdHkgPSBwYW5lbC5za2luO1xyXG4gICAgICAgIHZhciBjdXJTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZW50aXR5KTtcclxuICAgICAgICB2YXIgdHdlZW4gPSBuZXcgVHdlZW4oZW50aXR5KS5lbmQoKS5zdG9wKCk7XHJcbiAgICAgICAgZW50aXR5LnN0eWxlLnBvc2l0aW9uID0gXCJmaXhlZFwiO1xyXG4gICAgICAgIGVudGl0eS5zdHlsZS5sZWZ0ID0gXCJjYWxjKDUwJSAtIFwiICsgY3VyU3R5bGUud2lkdGggKyBcIiAqIDAuNSlcIjtcclxuICAgICAgICBlbnRpdHkuc3R5bGUudG9wID0gXCJjYWxjKDUwJSAtIFwiICsgY3VyU3R5bGUuaGVpZ2h0ICsgXCIgKiAwLjUpXCI7XHJcbiAgICAgICAgZW50aXR5LnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoMCwgMClcIjtcclxuICAgICAgICAvLyDlvIDlp4vnvJPliqhcclxuICAgICAgICB2YXIga2V5ID0gXCJfX3R3ZWVuX19zdGVwX19cIjtcclxuICAgICAgICBlbnRpdHlba2V5XSA9IDA7XHJcbiAgICAgICAgdmFyIHByb3BzID0ge307XHJcbiAgICAgICAgcHJvcHNba2V5XSA9IDE7XHJcbiAgICAgICAgdHdlZW4udG8ocHJvcHMsIDMwMCkuZWFzaW5nKEVhc2luZy5CYWNrLk91dCkub25VcGRhdGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBlbnRpdHkuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZShcIiArIGVudGl0eVtrZXldICsgXCIsIFwiICsgZW50aXR5W2tleV0gKyBcIilcIjtcclxuICAgICAgICB9KS5vbkNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZGVsZXRlIGVudGl0eVtrZXldO1xyXG4gICAgICAgICAgICBlbnRpdHkuc3R5bGUudHJhbnNmb3JtID0gXCJcIjtcclxuICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICB9KS5zdGFydCgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet5pe26LCD55SoXHJcbiAgICAgKiBAcGFyYW0gcG9wdXAg5by55Ye65qGG5a+56LGhXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg5a6M5oiQ5Zue6LCD77yM5b+F6aG76LCD55SoXHJcbiAgICAgKiBAcGFyYW0gdG8g5Yqo55S75a6M57uT54K5XHJcbiAgICAgKi9cclxuICAgIEJhY2tQYW5lbFBvbGljeS5wcm90b3R5cGUuZHJvcCA9IGZ1bmN0aW9uIChwYW5lbCwgY2FsbGJhY2ssIHRvKSB7XHJcbiAgICAgICAgdmFyIGVudGl0eSA9IHBhbmVsLnNraW47XHJcbiAgICAgICAgdmFyIHR3ZWVuID0gbmV3IFR3ZWVuKGVudGl0eSkuZW5kKCkuc3RvcCgpO1xyXG4gICAgICAgIGVudGl0eS5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlKDEsIDEpXCI7XHJcbiAgICAgICAgLy8g5byA5aeL57yT5YqoXHJcbiAgICAgICAgdmFyIGtleSA9IFwiX190d2Vlbl9fc3RlcF9fXCI7XHJcbiAgICAgICAgZW50aXR5W2tleV0gPSAxO1xyXG4gICAgICAgIHZhciBwcm9wcyA9IHt9O1xyXG4gICAgICAgIHByb3BzW2tleV0gPSAwO1xyXG4gICAgICAgIHR3ZWVuLnRvKHByb3BzLCAzMDApLmVhc2luZyhFYXNpbmcuQmFjay5Jbikub25VcGRhdGUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBlbnRpdHkuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZShcIiArIGVudGl0eVtrZXldICsgXCIsIFwiICsgZW50aXR5W2tleV0gKyBcIilcIjtcclxuICAgICAgICB9KS5vbkNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZGVsZXRlIGVudGl0eVtrZXldO1xyXG4gICAgICAgICAgICBlbnRpdHkuc3R5bGUudHJhbnNmb3JtID0gXCJcIjtcclxuICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICB9KS5zdGFydCgpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCYWNrUGFuZWxQb2xpY3k7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEJhY2tQYW5lbFBvbGljeTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZG9tL2RvbS9wYW5lbC9CYWNrUGFuZWxQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDcxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IFR3ZWVuLCBFYXNpbmcgfSBmcm9tIFwiQHR3ZWVuanMvdHdlZW4uanNcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTA5LTIyXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTA5LTIyXHJcbiAqXHJcbiAqIOa3oeWFpea3oeWHuuWcuuaZr+WIh+aNouetlueVpVxyXG4qL1xyXG52YXIgRmFkZVNjZW5lUG9saWN5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRmFkZVNjZW5lUG9saWN5KCkge1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiDlh4blpIfliIfmjaLlnLrmma/ml7bosIPluqZcclxuICAgICAqIEBwYXJhbSBmcm9tIOWIh+WHuueahOWcuuaZr1xyXG4gICAgICogQHBhcmFtIHRvIOWIh+WFpeeahOWcuuaZr1xyXG4gICAgICovXHJcbiAgICBGYWRlU2NlbmVQb2xpY3kucHJvdG90eXBlLnByZXBhcmVTd2l0Y2ggPSBmdW5jdGlvbiAoZnJvbSwgdG8pIHtcclxuICAgICAgICBpZiAoZnJvbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOWFi+mahuiKgueCuVxyXG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhZ2VDbG9uZSAmJiB0aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9zdGFnZUNsb25lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDlhYvpmoblvZPliY3lsY/luZVcclxuICAgICAgICAgICAgdmFyIHN0YWdlID0gZnJvbS5icmlkZ2Uuc3RhZ2U7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUgPSBzdGFnZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUuc3R5bGUucG9zaXRpb24gPSBcImZpeGVkXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUuc3R5bGUubGVmdCA9IFwiMCVcIjtcclxuICAgICAgICAgICAgdGhpcy5fc3RhZ2VDbG9uZS5zdHlsZS50b3AgPSBcIjAlXCI7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUuc3R5bGUuekluZGV4ID0gXCIyMTQ3NDgzNjQ3XCI7IC8vIOWxgue6p+imgeacgOmrmFxyXG4gICAgICAgICAgICB0aGlzLl9zdGFnZUNsb25lLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIjsgLy8g6KaB5bGP6JS954K55Ye75LqL5Lu2XHJcbiAgICAgICAgICAgIC8vIOa3u+WKoOWFi+mahuiKgueCuVxyXG4gICAgICAgICAgICBmcm9tLmJyaWRnZS5odG1sV3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLl9zdGFnZUNsb25lKTtcclxuICAgICAgICAgICAgLy8g56e76ZmkZnJvbVxyXG4gICAgICAgICAgICB2YXIgZnJvbURpc3BsYXkgPSBmcm9tLnNraW47XHJcbiAgICAgICAgICAgIGlmIChmcm9tRGlzcGxheS5wYXJlbnRFbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGZyb21EaXNwbGF5LnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoZnJvbURpc3BsYXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv5pe26LCD5bqmXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliIflh7rnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB0byDliIflhaXnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayDliIfmjaLlrozmr5XnmoTlm57osIPmlrnms5VcclxuICAgICAqL1xyXG4gICAgRmFkZVNjZW5lUG9saWN5LnByb3RvdHlwZS5zd2l0Y2ggPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAoZnJvbSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIC8vIOW8gOWni+a3oeWHulxyXG4gICAgICAgICAgICB2YXIga2V5ID0gXCJfX3R3ZWVuX19zdGVwX19cIjtcclxuICAgICAgICAgICAgdGhpcy5fc3RhZ2VDbG9uZVtrZXldID0gMTtcclxuICAgICAgICAgICAgdmFyIHByb3BzID0ge307XHJcbiAgICAgICAgICAgIHByb3BzW2tleV0gPSAwO1xyXG4gICAgICAgICAgICBuZXcgVHdlZW4odGhpcy5fc3RhZ2VDbG9uZSlcclxuICAgICAgICAgICAgICAgIC5lbmQoKVxyXG4gICAgICAgICAgICAgICAgLnN0b3AoKVxyXG4gICAgICAgICAgICAgICAgLnRvKHByb3BzLCAzMDApXHJcbiAgICAgICAgICAgICAgICAuZWFzaW5nKEVhc2luZy5MaW5lYXIuTm9uZSlcclxuICAgICAgICAgICAgICAgIC5vblVwZGF0ZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fc3RhZ2VDbG9uZS5zdHlsZS5vcGFjaXR5ID0gX3RoaXMuX3N0YWdlQ2xvbmVba2V5XTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vbkNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fc3RhZ2VDbG9uZVtrZXldO1xyXG4gICAgICAgICAgICAgICAgLy8g56e76Zmk5oiq5bGPXHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuX3N0YWdlQ2xvbmUucGFyZW50RWxlbWVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3N0YWdlQ2xvbmUucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChfdGhpcy5fc3RhZ2VDbG9uZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuc3RhcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIOenu+mZpOWFi+mahuiKgueCuVxyXG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhZ2VDbG9uZSAmJiB0aGlzLl9zdGFnZUNsb25lLnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWdlQ2xvbmUucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZCh0aGlzLl9zdGFnZUNsb25lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEZhZGVTY2VuZVBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgRmFkZVNjZW5lUG9saWN5O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1kb20vZG9tL3NjZW5lL0ZhZGVTY2VuZVBvbGljeS5qc1xuLy8gbW9kdWxlIGlkID0gNzJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgY29yZSB9IGZyb20gXCIuLi8uLi9jb3JlL0NvcmVcIjtcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCIuLi8uLi9jb3JlL2luamVjdG9yL0luamVjdG9yXCI7XHJcbmltcG9ydCBTaGVsbCBmcm9tIFwiLi4vZW52L1NoZWxsXCI7XHJcbmltcG9ydCBFbmdpbmVNZXNzYWdlIGZyb20gXCIuLi9tZXNzYWdlL0VuZ2luZU1lc3NhZ2VcIjtcclxuaW1wb3J0IEF1ZGlvQ29udGV4dEltcGwgZnJvbSBcIi4vQXVkaW9Db250ZXh0SW1wbFwiO1xyXG5pbXBvcnQgQXVkaW9UYWdJbXBsIGZyb20gXCIuL0F1ZGlvVGFnSW1wbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzBcclxuICpcclxuICog6Z+z6aKR566h55CG5Zmo77yM6Z+z6aKR5o6l5Y+j6KKr5by66KGM5YiG5Li65Lik6YOo5YiG77yaU291bmTlkoxNdXNpY+OAglxyXG4gKiBTb3VuZO+8muS9v+eUqEF1ZGlv5qCH562+5pKt5pS+77yM5Y+v5Lul6Leo5Z+f5pKt5pS+5L2G5Y+v6IO95Lya6KKr5p+Q5Lqb5rWP6KeI5Zmo6ZmQ5Yi277yM5b+F6aG75Zyo54K55Ye75LqL5Lu25aSE55CG5Ye95pWw5Lit5pKt5pS+XHJcbiAqIE11c2lj77ya5L2/55SoQXVkaW9Db250ZXh05pKt5pS+77yM5Y+v5Lul5LiA5a6a56iL5bqm5LiK6LaK6L+H54K55Ye75LqL5Lu25qOA5p+l77yM5L2G5peg5rOV6Leo5Z+f5pKt5pS+77yM6YCC5ZCI5pKt5pS+6IOM5pmv6Z+z5LmQXHJcbiovXHJcbnZhciBBdWRpb01hbmFnZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBdWRpb01hbmFnZXIoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwgPSBuZXcgQXVkaW9UYWdJbXBsKCk7XHJcbiAgICAgICAgLy8g5Li6V2ViQXVkaW/lgZrlhbzlrrnlpITnkIZcclxuICAgICAgICB3aW5kb3dbXCJBdWRpb0NvbnRleHRcIl0gPSB3aW5kb3dbXCJBdWRpb0NvbnRleHRcIl0gfHwgd2luZG93W1wid2Via2l0QXVkaW9Db250ZXh0XCJdIHx8IHdpbmRvd1tcIm1vekF1ZGlvQ29udGV4dFwiXSB8fCB3aW5kb3dbXCJtc0F1ZGlvQ29udGV4dFwiXTtcclxuICAgICAgICAvLyDnlLHkuo5JReWPr+iDveS4jeaUr+aMgUF1ZGlvQ29udGV4dO+8jOWboOatpOWmguaenOaYr0lF5YiZ6KaB5pS555SoQXVkaW/moIfnrb7lrp7njrBcclxuICAgICAgICB0aGlzLl9tdXNpY0ltcGwgPSAod2luZG93W1wiQXVkaW9Db250ZXh0XCJdID8gbmV3IEF1ZGlvQ29udGV4dEltcGwoKSA6IHRoaXMuX3NvdW5kSW1wbCk7XHJcbiAgICAgICAgY29yZS5saXN0ZW4oRW5naW5lTWVzc2FnZS5JTklUSUFMSVpFRCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDor7vlj5bmjIHkuYXljJborrDlvZVcclxuICAgICAgICAgICAgdmFyIHNoZWxsID0gY29yZS5nZXRJbmplY3QoU2hlbGwpO1xyXG4gICAgICAgICAgICBfdGhpcy5tdXRlU291bmQgPSAoc2hlbGwubG9jYWxTdG9yYWdlR2V0KEF1ZGlvTWFuYWdlcl8xLlNUT1JBR0VfS0VZX01VVEVfU09VTkQpID09PSBcInRydWVcIik7XHJcbiAgICAgICAgICAgIF90aGlzLm11dGVNdXNpYyA9IChzaGVsbC5sb2NhbFN0b3JhZ2VHZXQoQXVkaW9NYW5hZ2VyXzEuU1RPUkFHRV9LRVlfTVVURV9NVVNJQykgPT09IFwidHJ1ZVwiKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIEF1ZGlvTWFuYWdlcl8xID0gQXVkaW9NYW5hZ2VyO1xyXG4gICAgLyoqXHJcbiAgICAgKiDms6jlhoxTb3VuZOmfs+mikeWunueOsOWvueixoVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7SUF1ZGlvfSBzb3VuZEltcGwgU291bmTpn7PpopHlrp7njrDlr7nosaFcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5yZWdpc3RlclNvdW5kSW1wbCA9IGZ1bmN0aW9uIChzb3VuZEltcGwpIHtcclxuICAgICAgICBpZiAodGhpcy5fc291bmRJbXBsKVxyXG4gICAgICAgICAgICB0aGlzLl9zb3VuZEltcGwuZGlzcG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX3NvdW5kSW1wbCA9IHNvdW5kSW1wbDtcclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXVkaW9NYW5hZ2VyLnByb3RvdHlwZSwgXCJtdXRlU291bmRcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluaIluiuvue9rlNvdW5k57G75Z6L6Z+z6aKR6Z2Z6Z+z5bGe5oCnXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zb3VuZEltcGwubXV0ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdGhpcy5fc291bmRJbXBsLm11dGUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMuX3NvdW5kSW1wbC5tdXRlID0gdmFsdWU7XHJcbiAgICAgICAgICAgIC8vIOaMgeS5heWMllxyXG4gICAgICAgICAgICB2YXIgc2hlbGwgPSBjb3JlLmdldEluamVjdChTaGVsbCk7XHJcbiAgICAgICAgICAgIHNoZWxsLmxvY2FsU3RvcmFnZVNldChBdWRpb01hbmFnZXJfMS5TVE9SQUdFX0tFWV9NVVRFX1NPVU5ELCB2YWx1ZSArIFwiXCIpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb1Tb3VuZOmfs+mikVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z6aKR5Zyw5Z2AXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUubG9hZFNvdW5kID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX3NvdW5kSW1wbC5sb2FkKHVybCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmkq3mlL5Tb3VuZOmfs+mike+8jOWmguaenOayoeacieWKoOi9veWImeS8muWFiOihjOWKoOi9vVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QXVkaW9QbGF5UGFyYW1zfSBwYXJhbXMg6Z+z6aKR5pKt5pS+5Y+C5pWwXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUucGxheVNvdW5kID0gZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgIC8vIOWIpOaWremdmemfs1xyXG4gICAgICAgIGlmICh0aGlzLm11dGVTb3VuZClcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIC8vIOWBnOatouWFtuS7lumfs+mikVxyXG4gICAgICAgIGlmIChwYXJhbXMuc3RvcE90aGVycykge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3BBbGxTb3VuZCgpO1xyXG4gICAgICAgICAgICB0aGlzLnN0b3BBbGxNdXNpY3MoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsLnBsYXkocGFyYW1zKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOi3s+i9rFNvdW5k6Z+z6aKR6L+b5bqmXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lIOimgei3s+i9rOWIsOeahOmfs+mikeS9jee9ru+8jOavq+enkuWAvFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnNlZWtTb3VuZCA9IGZ1bmN0aW9uICh1cmwsIHRpbWUpIHtcclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwuc2Vlayh1cmwsIHRpbWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2iU291bmTpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikeWcsOWdgFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnN0b3BTb3VuZCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9zb3VuZEltcGwuc3RvcCh1cmwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pqC5YGcU291bmTpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikeWcsOWdgFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnBhdXNlU291bmQgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsLnBhdXNlKHVybCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraLmiYDmnIlTb3VuZOmfs+mikVxyXG4gICAgICpcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zdG9wQWxsU291bmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fc291bmRJbXBsLnN0b3BBbGwoKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOazqOWGjE11c2lj6Z+z6aKR5a6e546w5a+56LGhXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJQXVkaW99IG11c2ljSW1wbCBNdXNpY+mfs+mikeWunueOsOWvueixoVxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnJlZ2lzdGVyTXVzaWNJbXBsID0gZnVuY3Rpb24gKG11c2ljSW1wbCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9tdXNpY0ltcGwpXHJcbiAgICAgICAgICAgIHRoaXMuX211c2ljSW1wbC5kaXNwb3NlKCk7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsID0gbXVzaWNJbXBsO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdWRpb01hbmFnZXIucHJvdG90eXBlLCBcIm11dGVNdXNpY1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5oiW6K6+572uTXVzaWPnsbvlnovpn7PpopHpnZnpn7PlsZ7mgKdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX211c2ljSW1wbC5tdXRlO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLl9tdXNpY0ltcGwubXV0ZSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5fbXVzaWNJbXBsLm11dGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g5oyB5LmF5YyWXHJcbiAgICAgICAgICAgIHZhciBzaGVsbCA9IGNvcmUuZ2V0SW5qZWN0KFNoZWxsKTtcclxuICAgICAgICAgICAgc2hlbGwubG9jYWxTdG9yYWdlU2V0KEF1ZGlvTWFuYWdlcl8xLlNUT1JBR0VfS0VZX01VVEVfTVVTSUMsIHZhbHVlICsgXCJcIik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICAvKipcclxuICAgICAqIOWKoOi9vU11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5sb2FkTXVzaWMgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLmxvYWQodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaSreaUvk11c2lj6Z+z6aKR77yM5aaC5p6c5rKh5pyJ5Yqg6L295YiZ5Lya5YWI6KGM5Yqg6L29XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBdWRpb1BsYXlQYXJhbXN9IFtwYXJhbXNdIOmfs+mikeWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBBdWRpb01hbmFnZXIucHJvdG90eXBlLnBsYXlNdXNpYyA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICAvLyDliKTmlq3pnZnpn7NcclxuICAgICAgICBpZiAodGhpcy5tdXRlTXVzaWMpXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAvLyDlgZzmraLlhbbku5bpn7PpopFcclxuICAgICAgICBpZiAocGFyYW1zLnN0b3BPdGhlcnMpIHtcclxuICAgICAgICAgICAgdGhpcy5zdG9wQWxsU291bmQoKTtcclxuICAgICAgICAgICAgdGhpcy5zdG9wQWxsTXVzaWNzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX211c2ljSW1wbC5wbGF5KHBhcmFtcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7PovaxNdXNpY+mfs+mikei/m+W6plxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwg6Z+z6aKRVVJMXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdGltZSDopoHot7PovazliLDnmoTpn7PpopHkvY3nva7vvIzmr6vnp5LlgLxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zZWVrTXVzaWMgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLnNlZWsodXJsLCB0aW1lKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOWBnOatok11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5zdG9wTXVzaWMgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fbXVzaWNJbXBsLnN0b3AodXJsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOaaguWBnE11c2lj6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb01hbmFnZXJcclxuICAgICAqL1xyXG4gICAgQXVkaW9NYW5hZ2VyLnByb3RvdHlwZS5wYXVzZU11c2ljID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX211c2ljSW1wbC5wYXVzZSh1cmwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i5omA5pyJTXVzaWPpn7PpopFcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9NYW5hZ2VyXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvTWFuYWdlci5wcm90b3R5cGUuc3RvcEFsbE11c2ljcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLl9tdXNpY0ltcGwuc3RvcEFsbCgpO1xyXG4gICAgfTtcclxuICAgIHZhciBBdWRpb01hbmFnZXJfMTtcclxuICAgIEF1ZGlvTWFuYWdlci5TVE9SQUdFX0tFWV9NVVRFX1NPVU5EID0gXCJBdWRpb01hbmFnZXI6Om11dGVTb3VuZFwiO1xyXG4gICAgQXVkaW9NYW5hZ2VyLlNUT1JBR0VfS0VZX01VVEVfTVVTSUMgPSBcIkF1ZGlvTWFuYWdlcjo6bXV0ZU11c2ljXCI7XHJcbiAgICBBdWRpb01hbmFnZXIgPSBBdWRpb01hbmFnZXJfMSA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZSxcclxuICAgICAgICB0c2xpYl8xLl9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbXSlcclxuICAgIF0sIEF1ZGlvTWFuYWdlcik7XHJcbiAgICByZXR1cm4gQXVkaW9NYW5hZ2VyO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBdWRpb01hbmFnZXI7XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrljZXkvosgKi9cclxuZXhwb3J0IHZhciBhdWRpb01hbmFnZXIgPSBjb3JlLmdldEluamVjdChBdWRpb01hbmFnZXIpO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvYXVkaW8vQXVkaW9NYW5hZ2VyLmpzXG4vLyBtb2R1bGUgaWQgPSA3M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgSlNMb2FkTW9kZSB9IGZyb20gJy4uLy4uL2NvcmUvaW50ZXJmYWNlcy9KU0ZpbGUnO1xyXG5pbXBvcnQgeyB2YWxpZGF0ZVByb3RvY29sIH0gZnJvbSAnLi4vLi4vdXRpbHMvVVJMVXRpbCc7XHJcbmltcG9ydCB7IGFzc2V0c01hbmFnZXIgfSBmcm9tIFwiLi4vYXNzZXRzL0Fzc2V0c01hbmFnZXJcIjtcclxuaW1wb3J0IEF1ZGlvVGFnSW1wbCBmcm9tIFwiLi4vYXVkaW8vQXVkaW9UYWdJbXBsXCI7XHJcbmltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIi4vRW52aXJvbm1lbnRcIjtcclxuLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTIzXHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTIzXHJcbiAqXHJcbiAqIOWkluWjs+aOpeWPo++8jOivpeexu+aXouS9nOS4uuWkluWjs+aOpeWPo+eahOazqOWFpeWfuuexu++8jOS5n+S9nOS4uuagh+WHhua1j+iniOWZqOeahOWunueOsOS9v+eUqFxyXG4qL1xyXG52YXIgU2hlbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTaGVsbCgpIHtcclxuICAgIH1cclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTaGVsbC5wcm90b3R5cGUsIFwicHJveHlcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiuvue9ruWkluWjs+S7o+eQhu+8jOWmguaenOadoeS7tuWRveS4reS6huivpeS7o+eQhuexu+Wei++8jOWImeeUn+aIkOivpeS7o+eQhuWunuS+i+W5tuabv+S7o+WkluWjs+ihjOS4ulxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQG1lbWJlcm9mIFNoZWxsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlLmhpdClcclxuICAgICAgICAgICAgICAgIHRoaXMuX3Byb3h5ID0gbmV3IHZhbHVlKCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2hlbGwucHJvdG90eXBlLCBcInR5cGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOiOt+WPluW9k+WJjeWkluWjs+exu+Wei1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHJlYWRvbmx5XHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3Byb3h5KVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3h5LnR5cGU7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHJldHVybiBcIndlYlwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKiDkuIvpnaLmmK/pobXpnaLot7PovazmjqXlj6MgKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xyXG4gICAgLyoqXHJcbiAgICAgKiDliLfmlrDpobXpnaJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3tcclxuICAgICAqICAgICAgICAgZm9yY2VkUmVsb2FkPzpib29sZWFuLCAvLyBmYWxzZeihqOekuuWFgeiuuOS7jue8k+WtmOWPlu+8jHRydWXooajnpLrlvLrliLbku47mnI3liqHlmajlj5bvvIzpu5jorqTmmK9mYWxzZVxyXG4gICAgICogICAgICAgICB1cmw/OnN0cmluZywgLy8g5Lyg6YCS5YiZ5L2/55So5pawVVJM5Yi35paw6aG16Z2iXHJcbiAgICAgKiAgICAgICAgIHJlcGxhY2U/OmJvb2xlYW4gLy8g5aaC5p6c5pyJ5pawdXJs77yM5YiZ6KGo56S65piv5ZCm6KaB5pu/5o2i5b2T5YmN5rWP6KeI5Y6G5Y+yXHJcbiAgICAgKiAgICAgfX0gW3BhcmFtc11cclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUucmVsb2FkID0gZnVuY3Rpb24gKHBhcmFtcykge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSkge1xyXG4gICAgICAgICAgICB0aGlzLl9wcm94eS5yZWxvYWQocGFyYW1zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICghcGFyYW1zKVxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICBlbHNlIGlmICghcGFyYW1zLnVybClcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQocGFyYW1zLmZvcmNlZFJlbG9hZCk7XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFwYXJhbXMucmVwbGFjZSlcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcGFyYW1zLnVybDtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UocGFyYW1zLnVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5omT5byA5LiA5Liq5paw6aG16Z2iXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHt7XHJcbiAgICAgKiAgICAgICAgIHVybD86c3RyaW5nLCAvLyDmlrDpobXpnaLlnLDlnYDvvIzkuI3kvKDliJnkuI3mm7TmlrDlnLDlnYBcclxuICAgICAqICAgICAgICAgbmFtZT86c3RyaW5nLCAvLyDnu5nmlrDpobXpnaLlkb3lkI3vvIzmiJblr7zoiKrliLDlt7LmnInpobXpnaJcclxuICAgICAqICAgICAgICAgcmVwbGFjZT86Ym9vbGVhbiwgLy8g5piv5ZCm5pu/5o2i5b2T5YmN5rWP6KeI5Y6G5Y+y5p2h55uu77yM6buY6K6kZmFsc2VcclxuICAgICAqICAgICAgICAgZmVhdHVyZXM6e1trZXk6c3RyaW5nXTphbnl9IC8vIOWFtuS7luWPr+iDveeahOWPguaVsFxyXG4gICAgICogICAgIH19IFtwYXJhbXNdXHJcbiAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAqL1xyXG4gICAgU2hlbGwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Byb3h5KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3h5Lm9wZW4ocGFyYW1zKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICghcGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdmFyIGZlYXR1cmVzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtcy5mZWF0dXJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZlYXR1cmVzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBhcmFtcy5mZWF0dXJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmZWF0dXJlcy5wdXNoKGtleSArIFwiPVwiICsgcGFyYW1zLmZlYXR1cmVzW2tleV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKHBhcmFtcy51cmwsIHBhcmFtcy5uYW1lLCBmZWF0dXJlcyAmJiBmZWF0dXJlcy5qb2luKFwiLFwiKSwgcGFyYW1zLnJlcGxhY2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet56qX5Y+jXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIFNoZWxsXHJcbiAgICAgKi9cclxuICAgIFNoZWxsLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5fcHJveHkpXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3h5LmNsb3NlKCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB3aW5kb3cuY2xvc2UoKTtcclxuICAgIH07XHJcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqIOS4i+mdouaYr+acrOWcsOWtmOWCqOaOpeWPoyAqKioqKioqKioqKioqKioqKioqKioqKioqKiovXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluacrOWcsOWtmOWCqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkg6KaB6I635Y+W5YC855qE6ZSuXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSDojrflj5bnmoTlgLxcclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUubG9jYWxTdG9yYWdlR2V0ID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSlcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Byb3h5LmxvY2FsU3RvcmFnZUdldChrZXkpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5pys5Zyw5a2Y5YKoXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSDopoHorr7nva7nmoTplK5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB2YWx1ZSDopoHorr7nva7nmoTlgLxcclxuICAgICAqIEBtZW1iZXJvZiBTaGVsbFxyXG4gICAgICovXHJcbiAgICBTaGVsbC5wcm90b3R5cGUubG9jYWxTdG9yYWdlU2V0ID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICBpZiAodGhpcy5fcHJveHkpXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3h5LmxvY2FsU3RvcmFnZVNldChrZXksIHZhbHVlKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOenu+mZpOacrOWcsOWtmOWCqFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkg6KaB56e76Zmk55qE6ZSuXHJcbiAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAqL1xyXG4gICAgU2hlbGwucHJvdG90eXBlLmxvY2FsU3RvcmFnZVJlbW92ZSA9IGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICBpZiAodGhpcy5fcHJveHkpXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb3h5LmxvY2FsU3RvcmFnZVJlbW92ZShrZXkpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmuIXnqbrmnKzlnLDlrZjlgqhcclxuICAgICAqXHJcbiAgICAgKiBAbWVtYmVyb2YgU2hlbGxcclxuICAgICAqL1xyXG4gICAgU2hlbGwucHJvdG90eXBlLmxvY2FsU3RvcmFnZUNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wcm94eSlcclxuICAgICAgICAgICAgdGhpcy5fcHJveHkubG9jYWxTdG9yYWdlQ2xlYXIoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UuY2xlYXIoKTtcclxuICAgIH07XHJcbiAgICBTaGVsbCA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgU2hlbGwpO1xyXG4gICAgcmV0dXJuIFNoZWxsO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBTaGVsbDtcclxuLyoqXHJcbiAqIOi/meaYr1NoZWxs5Zyo5b6u5L+h5rWP6KeI5Zmo5LiL55qE5LiA5Liq5Y+Y5b2i5Luj55CGXHJcbiAqXHJcbiAqIEBjbGFzcyBTaGVsbFdYXHJcbiAqIEBleHRlbmRzIHtTaGVsbH1cclxuICovXHJcbnZhciBTaGVsbFdYID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoU2hlbGxXWCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFNoZWxsV1goKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICAvLyDljrvliqDovb3lvq7kv6Fqc3Nka1xyXG4gICAgICAgIGFzc2V0c01hbmFnZXIubG9hZEpzRmlsZXMoW3tcclxuICAgICAgICAgICAgICAgIHVybDogdmFsaWRhdGVQcm90b2NvbChcImh0dHA6Ly9yZXMud3gucXEuY29tL29wZW4vanMvandlaXhpbi0xLjIuMC5qc1wiKSxcclxuICAgICAgICAgICAgICAgIG1vZGU6IEpTTG9hZE1vZGUuVEFHXHJcbiAgICAgICAgICAgIH1dLCBmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGlmICghZXJyICYmIHdpbmRvd1tcInd4XCJdKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDlj5jlvIJBdWRpb1RhZ0ltcGzvvIzlnKjlvq7kv6Hph4znmoRBdWRpb+agh+etvumcgOimgeS7juW+ruS/oeinpuWPkeWKoOi9vVxyXG4gICAgICAgICAgICAgICAgdmFyIG9yaUxvYWQgPSBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLmxvYWQ7XHJcbiAgICAgICAgICAgICAgICBBdWRpb1RhZ0ltcGwucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAvLyDlpITnkIZ1cmxcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlsJ3or5Xojrflj5bnvJPlrZjmlbDmja5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOayoeaciee8k+WtmOaJjeWOu+WKoOi9vVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSB8fCBkYXRhLl9fZnJvbV9jYWNoZV9fKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWFiOiwg+eUqOWOn+Wni+aWueazle+8jOWQpuWImeihjOS4uuWwseWPmOS6hlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlMb2FkLmNhbGwodGhpcywgdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGRhdGEuX19mcm9tX2NhY2hlX187XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS7juW+ruS/oemHjOinpuWPkeWKoOi9veaTjeS9nFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dbXCJ3eFwiXS5jaGVja0pzQXBpKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpzQXBpTGlzdDogW1wiY2hlY2tKc0FwaVwiXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IF90aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZSA9IGRhdGEubm9kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLmxvYWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkeS6i+S7tlxyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChTaGVsbFdYLkVWRU5UX1dYX1BSRVBBUkVELCB3aW5kb3dbXCJ3eFwiXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2hlbGxXWCwgXCJoaXRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHdpbmRvdy50b3AgPT09IHdpbmRvdyAmJlxyXG4gICAgICAgICAgICAgICAgL01pY3JvTWVzc2VuZ2VyL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2hlbGxXWC5wcm90b3R5cGUsIFwidHlwZVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcIndlaXhpblwiO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgU2hlbGxXWC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgd2luZG93W1wiV2VpeGluSlNCcmlkZ2VcIl0uaW52b2tlKFwiY2xvc2VXaW5kb3dcIik7XHJcbiAgICB9O1xyXG4gICAgU2hlbGxXWC5FVkVOVF9XWF9QUkVQQVJFRCA9IFwiZXZlbnRXWFByZXBhcmVkXCI7XHJcbiAgICByZXR1cm4gU2hlbGxXWDtcclxufShTaGVsbCkpO1xyXG4vKiog5YaN6aKd5aSW5a+85Ye65LiA5Liq5Y2V5L6LICovXHJcbmV4cG9ydCB2YXIgc2hlbGwgPSBjb3JlLmdldEluamVjdChTaGVsbCk7XHJcbi8qKiDlsJ3or5Xmt7vliqDlvq7kv6HlpJblo7Pku6PnkIYgKi9cclxuc2hlbGwucHJveHkgPSBTaGVsbFdYO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvZW52L1NoZWxsLmpzXG4vLyBtb2R1bGUgaWQgPSA3NFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBhc3NldHNNYW5hZ2VyIH0gZnJvbSBcIi4uL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IGVudmlyb25tZW50IH0gZnJvbSBcIi4uL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgeyBzeXN0ZW0gfSBmcm9tIFwiLi4vc3lzdGVtL1N5c3RlbVwiO1xyXG5pbXBvcnQgQXVkaW9NZXNzYWdlIGZyb20gXCIuL0F1ZGlvTWVzc2FnZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMTAtMzBcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMTAtMzBcclxuICpcclxuICog5L2/55SoQXVkaW9Db250ZXh05a6e546wSUF1ZGlv5o6l5Y+j55qE5a6e546w57G7XHJcbiovXHJcbnZhciBBdWRpb0NvbnRleHRJbXBsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXVkaW9Db250ZXh0SW1wbCgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2Rpc3Bvc2VkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbXV0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3BsYXlpbmdEaWN0ID0ge307XHJcbiAgICAgICAgdGhpcy5fYXVkaW9DYWNoZSA9IHt9O1xyXG4gICAgICAgIHRoaXMuX29uSW5pdCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY29udGV4dCA9IG5ldyAod2luZG93W1wiQXVkaW9Db250ZXh0XCJdIHx8IHdpbmRvd1tcIndlYmtpdEF1ZGlvQ29udGV4dFwiXSkoKTtcclxuICAgICAgICB0aGlzLl9vbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBfdGhpcy5fb25Jbml0LCB0cnVlKTtcclxuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgX3RoaXMuX29uSW5pdCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIF90aGlzLl9vbkluaXQgPSBudWxsO1xyXG4gICAgICAgICAgICAvLyDnlJ/miJDkuIDkuKrnqbrnmoTpn7PpopHvvIzmkq3mlL7lubblgZzmraLvvIznlKjku6Xop6PpmaTpmZDliLZcclxuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IF90aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xyXG4gICAgICAgICAgICBzb3VyY2UuYnVmZmVyID0gX3RoaXMuX2NvbnRleHQuY3JlYXRlQnVmZmVyKDEsIDEsIDQ0MTAwKTtcclxuICAgICAgICAgICAgc291cmNlLmNvbm5lY3QoX3RoaXMuX2NvbnRleHQuZGVzdGluYXRpb24pO1xyXG4gICAgICAgICAgICBzb3VyY2Uuc3RhcnQoKTtcclxuICAgICAgICAgICAgc291cmNlLnN0b3AoKTtcclxuICAgICAgICAgICAgLy8g6KaB5YWI5oyC6LW3XHJcbiAgICAgICAgICAgIF90aGlzLl9jb250ZXh0LnN1c3BlbmQoKTtcclxuICAgICAgICAgICAgLy8g5aaC5p6c5b2T5YmN5pyJ5q2j5Zyo5pKt5pS+55qE6Z+z6aKR77yM5YWo6YOo5YaN5pKt5pS+5LiA5qyhXHJcbiAgICAgICAgICAgIGZvciAodmFyIHVybCBpbiBfdGhpcy5fYXVkaW9DYWNoZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfdGhpcy5fYXVkaW9DYWNoZVt1cmxdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IEF1ZGlvU3RhdHVzLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlgZzmraLmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdG9wKGRhdGEucGxheVBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmHjeaWsOaSreaUvlxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnBsYXkoZGF0YS5wbGF5UGFyYW1zKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8g6L+Z6YeM55uR5ZCs6Kem5pG45LqL5Lu277yM5LiA5a6a6KaB5L2/55So5o2V6I636Zi25q6177yM5ZCm5YiZ5Lya6KKr5p+Q5Lqb5qGG5p626Zi75q2i77yM5q+U5aaCZWdyZXRcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgdGhpcy5fb25Jbml0LCB0cnVlKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9vbkluaXQsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLCBcImRpc3Bvc2VkXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Rpc3Bvc2VkO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLCBcIm11dGVcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIOmdmemfs+eKtuaAgVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHR5cGUge2Jvb2xlYW59XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEF1ZGlvVGFnSW1wbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbXV0ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX211dGUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgLy8g6Z2Z6Z+z77yM5pqC5YGc5omA5pyJ5aOw6Z+zXHJcbiAgICAgICAgICAgIGZvciAodmFyIHVybCBpbiB0aGlzLl9wbGF5aW5nRGljdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6Z2Z6Z+z77yM5YGc5q2i6Z+z6aKR77yM5LiN5Y+v6LCD55Soc3RvcOaWueazle+8jOWboOS4uuimgeS/neaMgeaSreaUvuS4reeahOmfs+mikeeKtuaAgVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvU3RvcCh1cmwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6Z2e6Z2Z6Z+z77yM5pKt5pS+6Z+z6aKRXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHRoaXMuX3BsYXlpbmdEaWN0W3VybF07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5KHBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L296Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopHlnLDlnYBcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb0NvbnRleHRJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodXJsKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICAvLyDlsJ3or5Xojrflj5bnvJPlrZjmlbDmja5cclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgIC8vIOWmguaenOayoeaciee8k+WtmOaJjeWOu+WKoOi9vVxyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAvLyDkvb/nlKhBdWRpb0NvbnRleHTliqDovb1cclxuICAgICAgICAgICAgdGhpcy5fYXVkaW9DYWNoZVt0b1VybF0gPSBkYXRhID0geyBidWZmZXI6IG51bGwsIHN0YXR1czogQXVkaW9TdGF0dXMuTE9BRElORywgcGxheVBhcmFtczogbnVsbCwgcHJvZ3Jlc3M6IG51bGwgfTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5Yqg6L295byA5aeL5LqL5Lu2XHJcbiAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX0xPQURfU1RBUlRFRCwgdXJsKTtcclxuICAgICAgICAgICAgLy8g5byA5aeL5Yqg6L29XHJcbiAgICAgICAgICAgIGFzc2V0c01hbmFnZXIubG9hZEFzc2V0cyh0b1VybCwgZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKHJlc3VsdCwgZnVuY3Rpb24gKGJ1ZmZlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmJ1ZmZlciA9IGJ1ZmZlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u54q25oCBXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuc3RhdHVzID0gQXVkaW9TdGF0dXMuUEFVU0VEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5HliqDovb3lrozmr5Xkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fTE9BRF9FTkRFRCwgdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c6Ieq5Yqo5pKt5pS+5YiZ5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnBsYXlQYXJhbXMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5wbGF5KGRhdGEucGxheVBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIFwiYXJyYXlidWZmZXJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pKt5pS+6Z+z6aKR77yM5aaC5p6c6Z+z6aKR5rKh5pyJ5Yqg6L295YiZ5YWI5Yqg6L295YaN5pKt5pS+XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtBdWRpb1BsYXlQYXJhbXN9IHBhcmFtcyDpn7PpopHmkq3mlL7lj4LmlbBcclxuICAgICAqIEByZXR1cm5zIHt2b2lkfVxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTChwYXJhbXMudXJsKTtcclxuICAgICAgICAvLyDlsJ3or5Xojrflj5bnvJPlrZjmlbDmja5cclxuICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX2F1ZGlvQ2FjaGVbdG9VcmxdO1xyXG4gICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAvLyDmsqHmnInliqDovb3ov4fvvIzlvIDlp4vliqDovb3pn7PpopFcclxuICAgICAgICAgICAgdGhpcy5sb2FkKHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAvLyDorr7nva7mkq3mlL7lj4LmlbBcclxuICAgICAgICAgICAgdGhpcy5fYXVkaW9DYWNoZVt0b1VybF0ucGxheVBhcmFtcyA9IHBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5zdGF0dXMpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgQXVkaW9TdGF0dXMuTE9BRElORzpcclxuICAgICAgICAgICAgICAgICAgICAvLyDmraPlnKjliqDovb3kuK3vvIzmm7/mjaLoh6rliqjmkq3mlL7lj4LmlbBcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnBsYXlQYXJhbXMgPSBwYXJhbXM7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIEF1ZGlvU3RhdHVzLlBMQVlJTkc6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g5q2j5Zyo5pKt5pS+77yM5YWz6Zet5ZCO5YaN5pKt5pS+XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdG9wKHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxheShwYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBBdWRpb1N0YXR1cy5QQVVTRUQ6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6K6+572u54q25oCBXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QTEFZSU5HO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiusOW9leaSreaUvuS4rVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYXlpbmdEaWN0W3RvVXJsXSA9IHBhcmFtcztcclxuICAgICAgICAgICAgICAgICAgICAvLyDlt7Lnu4/liqDovb3lrozmr5XvvIznm7TmjqXmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUgPSB0aGlzLl9jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubm9kZS5idWZmZXIgPSBkYXRhLmJ1ZmZlcjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zLmxvb3AgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2RlLmxvb3AgPSBwYXJhbXMubG9vcDtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuY29ubmVjdCh0aGlzLl9jb250ZXh0LmRlc3RpbmF0aW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDnm5HlkKzmkq3mlL7lrozmr5VcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUub25lbmRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlgZzmraLmkq3mlL5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0b3AocGFyYW1zLnVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmkq3mlL7lrozmr5Xkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfRU5ERUQsIHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDopoHmkq3mlL7kuYvliY3opoHotbfnlKhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0LnJlc3VtZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOW8gOWni+aSreaUvu+8jOS8mOWFiOWPluWPguaVsOS4reeahOaXtumXtO+8jOayoeacieWwseWPlum7mOiupOW8gOWni+aXtumXtFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwbGF5VGltZTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zICYmIHBhcmFtcy50aW1lICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlUaW1lID0gcGFyYW1zLnRpbWUgKiAwLjAwMTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXlUaW1lID0gZGF0YS5wbGF5VGltZTtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5wbGF5VGltZTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuc3RhcnQocGxheVRpbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOW8gOWni+aSreaUvui/m+W6puebkea1i1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0VGltZSA9IHRoaXMuX2NvbnRleHQuY3VycmVudFRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1clRpbWUgPSBwbGF5VGltZSB8fCAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEucHJvZ3Jlc3MgPSBzeXN0ZW0uZW50ZXJGcmFtZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3dUaW1lID0gX3RoaXMuX2NvbnRleHQuY3VycmVudFRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YVRpbWUgPSBub3dUaW1lIC0gbGFzdFRpbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RUaW1lID0gbm93VGltZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IEF1ZGlvU3RhdHVzLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clRpbWUgKz0gZGVsdGFUaW1lICogMTAwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbFRpbWUgPSBkYXRhLm5vZGUuYnVmZmVyLmR1cmF0aW9uICogMTAwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUuZGlzcGF0Y2goQXVkaW9NZXNzYWdlLkFVRElPX1BMQVlfUFJPR1JFU1MsIHBhcmFtcy51cmwsIGN1clRpbWUsIHRvdGFsVGltZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hmkq3mlL7lvIDlp4vkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICBjb3JlLmRpc3BhdGNoKEF1ZGlvTWVzc2FnZS5BVURJT19QTEFZX1NUQVJURUQsIHBhcmFtcy51cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLl9kb1N0b3AgPSBmdW5jdGlvbiAodXJsLCB0aW1lKSB7XHJcbiAgICAgICAgdmFyIHRvVXJsID0gZW52aXJvbm1lbnQudG9DRE5Ib3N0VVJMKHVybCk7XHJcbiAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9hdWRpb0NhY2hlW3RvVXJsXTtcclxuICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAvLyDorr7nva7nirbmgIFcclxuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSBBdWRpb1N0YXR1cy5QQVVTRUQ7XHJcbiAgICAgICAgICAgIC8vIOWPlua2iOi/m+W6puebkea1i1xyXG4gICAgICAgICAgICBkYXRhLm5vZGUub25lbmRlZCA9IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLnByb2dyZXNzKVxyXG4gICAgICAgICAgICAgICAgZGF0YS5wcm9ncmVzcy5jYW5jZWwoKTtcclxuICAgICAgICAgICAgLy8g57uT5p2f5pKt5pS+XHJcbiAgICAgICAgICAgIGlmIChkYXRhLm5vZGUpIHtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6L+Z6YeM5Y+v6IO95Lya5oql6ZSZ77yM6ZyA6KaBdHJ5IGNhdGhcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5vZGUuc3RvcCh0aW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDlgZzmraLmkq3pn7PpopHml7bpnIDopoHmjILotbdcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZXh0LnN1c3BlbmQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oZXJyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOa0vuWPkeaSreaUvuWBnOatouS6i+S7tlxyXG4gICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChBdWRpb01lc3NhZ2UuQVVESU9fUExBWV9TVE9QUEVELCB1cmwpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5pqC5YGc6Z+z6aKR77yI5LiN5Lya6YeN572u6L+b5bqm77yJXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDpn7PpopFVUkxcclxuICAgICAqIEBtZW1iZXJvZiBBdWRpb0NvbnRleHRJbXBsXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2RvU3RvcCh1cmwpO1xyXG4gICAgICAgIC8vIOenu+mZpOaSreaUvuS4rVxyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9wbGF5aW5nRGljdFt0b1VybF07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDlgZzmraLpn7PpopHvvIjkvJrph43nva7ov5vluqbvvIlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICB0aGlzLl9kb1N0b3AodXJsLCAwKTtcclxuICAgICAgICAvLyDnp7vpmaTmkq3mlL7kuK1cclxuICAgICAgICB2YXIgdG9VcmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICBkZWxldGUgdGhpcy5fcGxheWluZ0RpY3RbdG9VcmxdO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YGc5q2i5omA5pyJ6Z+z6aKRXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIEF1ZGlvQ29udGV4dEltcGxcclxuICAgICAqL1xyXG4gICAgQXVkaW9Db250ZXh0SW1wbC5wcm90b3R5cGUuc3RvcEFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3IgKHZhciB1cmwgaW4gdGhpcy5fYXVkaW9DYWNoZSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AodXJsKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDot7Povazpn7PpopHov5vluqZcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsIOmfs+mikVVSTFxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHRpbWUg6KaB6Lez6L2s5Yiw55qE6Z+z6aKR5L2N572u77yM5q+r56eS5YC8XHJcbiAgICAgKiBAbWVtYmVyb2YgQXVkaW9Db250ZXh0SW1wbFxyXG4gICAgICovXHJcbiAgICBBdWRpb0NvbnRleHRJbXBsLnByb3RvdHlwZS5zZWVrID0gZnVuY3Rpb24gKHVybCwgdGltZSkge1xyXG4gICAgICAgIHZhciB0b1VybCA9IGVudmlyb25tZW50LnRvQ0ROSG9zdFVSTCh1cmwpO1xyXG4gICAgICAgIHZhciBkYXRhID0gdGhpcy5fYXVkaW9DYWNoZVt0b1VybF07XHJcbiAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IGRhdGEucGxheVBhcmFtcztcclxuICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IEF1ZGlvU3RhdHVzLlBMQVlJTkcpIHtcclxuICAgICAgICAgICAgICAgIC8vIOWBnOatoumHjeaWsOaSreaUvlxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdG9wKHVybCk7XHJcbiAgICAgICAgICAgICAgICBwYXJhbXMudGltZSA9IHRpbWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsYXkocGFyYW1zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGRhdGEucGxheVRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEF1ZGlvQ29udGV4dEltcGwucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kaXNwb3NlZCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fb25Jbml0KSB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNoc3RhcnRcIiwgdGhpcy5fb25Jbml0LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX29uSW5pdCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkluaXQgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcEFsbCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9kaXNwb3NlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBdWRpb0NvbnRleHRJbXBsO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBBdWRpb0NvbnRleHRJbXBsO1xyXG52YXIgQXVkaW9TdGF0dXM7XHJcbihmdW5jdGlvbiAoQXVkaW9TdGF0dXMpIHtcclxuICAgIC8qKlxyXG4gICAgICog5Yqg6L295LitXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvU3RhdHVzW0F1ZGlvU3RhdHVzW1wiTE9BRElOR1wiXSA9IDBdID0gXCJMT0FESU5HXCI7XHJcbiAgICAvKipcclxuICAgICAqIOW3suaaguWBnFxyXG4gICAgICovXHJcbiAgICBBdWRpb1N0YXR1c1tBdWRpb1N0YXR1c1tcIlBBVVNFRFwiXSA9IDFdID0gXCJQQVVTRURcIjtcclxuICAgIC8qKlxyXG4gICAgICog5pKt5pS+5LitXHJcbiAgICAgKi9cclxuICAgIEF1ZGlvU3RhdHVzW0F1ZGlvU3RhdHVzW1wiUExBWUlOR1wiXSA9IDJdID0gXCJQTEFZSU5HXCI7XHJcbn0pKEF1ZGlvU3RhdHVzIHx8IChBdWRpb1N0YXR1cyA9IHt9KSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9hdWRpby9BdWRpb0NvbnRleHRJbXBsLmpzXG4vLyBtb2R1bGUgaWQgPSA3NVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxuZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi4vcmVzcG9uc2UvVGVzdFJlc3BvbnNlXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9uZXQvUmVxdWVzdERhdGFcIiwgXCJvbHltcHVzLXIvZW5naW5lL25ldC9wb2xpY2llcy9IVFRQUmVxdWVzdFBvbGljeVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFRlc3RSZXNwb25zZV8xLCBSZXF1ZXN0RGF0YV8xLCBIVFRQUmVxdWVzdFBvbGljeV8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQGF1dGhvciBUZW1wbGF0ZUdlbmVyYXRvclxyXG4gICAgICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICAgICAqIEBtb2RpZnkgZGF0ZSAxMC85LzIwMTdcclxuICAgICAqXHJcbiAgICAgKiDmtYvor5VcclxuICAgICovXHJcbiAgICB2YXIgVGVzdFJlcXVlc3QgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3RSZXF1ZXN0LCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RSZXF1ZXN0KCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICAgICAgX3RoaXMuX19wb2xpY3kgPSBIVFRQUmVxdWVzdFBvbGljeV8xLmRlZmF1bHQ7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRlc3RSZXF1ZXN0LnByb3RvdHlwZSwgXCJfX3BhcmFtc1wiLCB7XHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIlRlc3RcIixcclxuICAgICAgICAgICAgICAgICAgICBwYXRoOiBcIi90ZXN0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2w6IFwiaHR0cFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiBUZXN0UmVzcG9uc2VfMS5kZWZhdWx0LFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVzdDogdGhpcy50ZXN0IC8vIHN0cmluZyAtIOa1i+ivlVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIDtcclxuICAgICAgICByZXR1cm4gVGVzdFJlcXVlc3Q7XHJcbiAgICB9KFJlcXVlc3REYXRhXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdFJlcXVlc3Q7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEZKbGNYVmxjM1F1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlVaWE4wVW1WeGRXVnpkQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN08wbEJTMEU3T3pzN096dE5RVTFGTzBsQlEwWTdVVUZCZVVNc0swSkJRVmM3VVVGQmNFUTdXVUZCUVN4eFJVRjFRa003V1VGRVZTeGpRVUZSTEVkQlFXdENMREpDUVVGTkxFTkJRVU03TzFGQlF6VkRMRU5CUVVNN1VVRmlSeXh6UWtGQlZ5eHBRMEZCVVR0cFFrRkJia0k3WjBKQlJVa3NUMEZCVHp0dlFrRkRTQ3hKUVVGSkxFVkJRVVVzVFVGQlRUdHZRa0ZEY2tJc1NVRkJTU3hGUVVGRkxFOUJRVTg3YjBKQlEwb3NVVUZCVVN4RlFVRkZMRTFCUVUwN2IwSkJRMmhDTEZGQlFWRXNSVUZCUlN4elFrRkJXVHR2UWtGRGRFSXNTVUZCU1N4RlFVRkZPM2RDUVVOR0xFbEJRVWtzUlVGQlJTeEpRVUZKTEVOQlFVTXNTVUZCU1N4RFFVRkJMR05CUVdNN2NVSkJRMmhETzJsQ1FVTktMRU5CUVVNN1dVRkRUaXhEUVVGRE96czdWMEZCUVR0UlFVRkJMRU5CUVVNN1VVRkZUaXhyUWtGQlF6dEpRVUZFTEVOQlFVTXNRVUYyUWtRc1EwRkJlVU1zY1VKQlFWY3NSMEYxUW01RUluMD1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbmV0L3JlcXVlc3QvVGVzdFJlcXVlc3QudHNcbi8vIG1vZHVsZSBpZCA9IDc2XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJvbHltcHVzLXIvZW5naW5lL25ldC9EYXRhVHlwZVwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIERhdGFUeXBlXzEpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAYXV0aG9yIFRlbXBsYXRlR2VuZXJhdG9yXHJcbiAgICAgKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gICAgICogQG1vZGlmeSBkYXRlIDEwLzkvMjAxN1xyXG4gICAgICpcclxuICAgICAqIOa1i+ivlVxyXG4gICAgKi9cclxuICAgIHZhciBUZXN0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgICAgIF9fZXh0ZW5kcyhUZXN0LCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3QoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgVGVzdC5wcm90b3R5cGUuZG9QYXJzZSA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIHRoaXMudGVzdCA9IGRhdGEudGVzdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFRlc3QucHJvdG90eXBlLnBhY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICB0ZXN0OiB0aGlzLnRlc3RcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBUZXN0O1xyXG4gICAgfShEYXRhVHlwZV8xLmRlZmF1bHQpKTtcclxuICAgIGV4cG9ydHMuZGVmYXVsdCA9IFRlc3Q7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lWR1Z6ZEM1cWN5SXNJbk52ZFhKalpWSnZiM1FpT2lJaUxDSnpiM1Z5WTJWeklqcGJJbFJsYzNRdWRITWlYU3dpYm1GdFpYTWlPbHRkTENKdFlYQndhVzVuY3lJNklqczdPenM3T3pzN096czdPenRKUVVWQk96czdPenM3VFVGTlJUdEpRVU5HTzFGQlFXdERMSGRDUVVGUk8xRkJRVEZET3p0UlFYTkNRU3hEUVVGRE8xRkJXbUVzYzBKQlFVOHNSMEZCYWtJc1ZVRkJhMElzU1VGQlVUdFpRVVYwUWl4SlFVRkhMRWxCUVVrc1NVRkJTU3hKUVVGSk8yZENRVUZGTEU5QlFVODdXVUZEZUVJc1NVRkJTU3hEUVVGRExFbEJRVWtzUjBGQlJ5eEpRVUZKTEVOQlFVTXNTVUZCU1N4RFFVRkRPMUZCUXpGQ0xFTkJRVU03VVVGRlRTeHRRa0ZCU1N4SFFVRllPMWxCUlVrc1QwRkJUenRuUWtGRFNDeEpRVUZKTEVWQlFVVXNTVUZCU1N4RFFVRkRMRWxCUVVrN1lVRkRiRUlzUTBGQlF6dFJRVU5PTEVOQlFVTTdVVUZEVEN4WFFVRkRPMGxCUVVRc1EwRkJReXhCUVhSQ1JDeERRVUZyUXl4clFrRkJVU3hIUVhOQ2VrTWlmUT09XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25ldC90eXBlL1Rlc3QudHNcbi8vIG1vZHVsZSBpZCA9IDc3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGxvYWQgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvSFRUUFV0aWxcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwiLi4vLi4vZW52L0Vudmlyb25tZW50XCI7XHJcbmltcG9ydCB7IG5ldE1hbmFnZXIgfSBmcm9tIFwiLi4vTmV0TWFuYWdlclwiO1xyXG5pbXBvcnQgeyBleHRlbmRPYmplY3QgfSBmcm9tIFwiLi4vLi4vLi4vdXRpbHMvT2JqZWN0VXRpbFwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMTFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMTFcclxuICpcclxuICogSFRUUOivt+axguetlueVpVxyXG4qL1xyXG52YXIgSFRUUFJlcXVlc3RQb2xpY3kgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBIVFRQUmVxdWVzdFBvbGljeSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Y+R6YCB6K+35rGC6YC76L6RXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtSZXF1ZXN0RGF0YX0gcmVxdWVzdCDor7fmsYLmlbDmja5cclxuICAgICAqIEBtZW1iZXJvZiBIVFRQUmVxdWVzdFBvbGljeVxyXG4gICAgICovXHJcbiAgICBIVFRQUmVxdWVzdFBvbGljeS5wcm90b3R5cGUuc2VuZFJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCkge1xyXG4gICAgICAgIC8vIOWPluWIsOWPguaVsFxyXG4gICAgICAgIHZhciBwYXJhbXMgPSByZXF1ZXN0Ll9fcGFyYW1zO1xyXG4gICAgICAgIC8vIOS/ruaUueaVsOaNrlxyXG4gICAgICAgIHZhciBodHRwUGFyYW1zID0gZXh0ZW5kT2JqZWN0KHtcclxuICAgICAgICAgICAgdXJsOiBlbnZpcm9ubWVudC50b0hvc3RVUkwocGFyYW1zLnBhdGgsIHBhcmFtcy5ob3N0SW5kZXgpLFxyXG4gICAgICAgICAgICBvblJlc3BvbnNlOiBmdW5jdGlvbiAocmVzdWx0KSB7IHJldHVybiBuZXRNYW5hZ2VyLl9fb25SZXNwb25zZShyZXF1ZXN0Ll9fcGFyYW1zLnJlc3BvbnNlLCByZXN1bHQsIHJlcXVlc3QpOyB9LFxyXG4gICAgICAgICAgICBvbkVycm9yOiBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBuZXRNYW5hZ2VyLl9fb25FcnJvcihyZXF1ZXN0Ll9fcGFyYW1zLnJlc3BvbnNlLCBlcnIsIHJlcXVlc3QpOyB9LFxyXG4gICAgICAgICAgICBoZWFkZXJEaWN0OiB7fVxyXG4gICAgICAgIH0sIHBhcmFtcyk7XHJcbiAgICAgICAgLy8g5Y+R6YCBXHJcbiAgICAgICAgbG9hZChodHRwUGFyYW1zKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSFRUUFJlcXVlc3RQb2xpY3k7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEhUVFBSZXF1ZXN0UG9saWN5IH07XHJcbi8qKiDlho3pop3lpJblr7zlh7rkuIDkuKrlrp7kvosgKi9cclxuZXhwb3J0IGRlZmF1bHQgbmV3IEhUVFBSZXF1ZXN0UG9saWN5KCk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9uZXQvcG9saWNpZXMvSFRUUFJlcXVlc3RQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDc4XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCJvbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yXCIsIFwib2x5bXB1cy1yLWVncmV0L2VncmV0L2luamVjdG9yL0luamVjdG9yXCJdLCBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgTWVkaWF0b3JfMSwgSW5qZWN0b3JfMSkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbiAgICB2YXIgVGVzdENvbXAgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3RDb21wLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRlc3RDb21wKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFRlc3RDb21wLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2tpbi54ID0gMTAwO1xyXG4gICAgICAgICAgICB0aGlzLnNraW4ueSA9IDEwMDtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2tpbi5hZGRDaGlsZCh0aGlzLnNraW4pO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BhdGNoKFwiVGVzdENvbXBNc2dcIik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBUZXN0Q29tcC5wcm90b3R5cGUub25EaXNwb3NlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5za2luLnJlbW92ZUNoaWxkKHRoaXMuc2tpbik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBUZXN0Q29tcCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkVncmV0TWVkaWF0b3JDbGFzcyhcIlRlc3RDb21wXCIsIFwiVGVzdENvbXBTa2luXCIpXHJcbiAgICAgICAgXSwgVGVzdENvbXApO1xyXG4gICAgICAgIHJldHVybiBUZXN0Q29tcDtcclxuICAgIH0oTWVkaWF0b3JfMS5kZWZhdWx0KSk7XHJcbiAgICBleHBvcnRzLmRlZmF1bHQgPSBUZXN0Q29tcDtcclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVZHVnpkRU52YlhBdWFuTWlMQ0p6YjNWeVkyVlNiMjkwSWpvaUlpd2ljMjkxY21ObGN5STZXeUpVWlhOMFEyOXRjQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN096czdPenM3TzBsQlNVRTdVVUZCYzBNc05FSkJRVkU3VVVGQk9VTTdPMUZCWlVFc1EwRkJRenRSUVdKVkxIbENRVUZOTEVkQlFXSTdXVUZGU1N4SlFVRkpMRU5CUVVNc1NVRkJTU3hEUVVGRExFTkJRVU1zUjBGQlJ5eEhRVUZITEVOQlFVTTdXVUZEYkVJc1NVRkJTU3hEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETEVkQlFVY3NSMEZCUnl4RFFVRkRPMWxCUTJ4Q0xFbEJRVWtzUTBGQlF5eE5RVUZOTEVOQlFVTXNTVUZCU1N4RFFVRkRMRkZCUVZFc1EwRkJReXhKUVVGSkxFTkJRVU1zU1VGQlNTeERRVUZETEVOQlFVTTdXVUZGY2tNc1NVRkJTU3hEUVVGRExGRkJRVkVzUTBGQlF5eGhRVUZoTEVOQlFVTXNRMEZCUXp0UlFVTnFReXhEUVVGRE8xRkJSVTBzTkVKQlFWTXNSMEZCYUVJN1dVRkZTU3hKUVVGSkxFTkJRVU1zVFVGQlRTeERRVUZETEVsQlFVa3NRMEZCUXl4WFFVRlhMRU5CUVVNc1NVRkJTU3hEUVVGRExFbEJRVWtzUTBGQlF5eERRVUZETzFGQlF6VkRMRU5CUVVNN1VVRmtaMElzVVVGQlVUdFpRVVExUWl3MlFrRkJhMElzUTBGQlF5eFZRVUZWTEVWQlFVVXNZMEZCWXl4RFFVRkRPMWRCUXpGQ0xGRkJRVkVzUTBGbE5VSTdVVUZCUkN4bFFVRkRPMHRCUVVFc1FVRm1SQ3hEUVVGelF5eHJRa0ZCVVN4SFFXVTNRenR6UWtGbWIwSXNVVUZCVVNKOVxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9tb2R1bGVzL1Rlc3RDb21wLnRzXG4vLyBtb2R1bGUgaWQgPSA3OVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJ2YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG4gICAgfTtcclxufSkoKTtcclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fbWV0YWRhdGEgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XHJcbn07XHJcbmRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIm9seW1wdXMtci1kb20vZG9tL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yL2VuZ2luZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvbWVkaWF0b3IvTWVkaWF0b3JcIiwgXCJvbHltcHVzLXIvZW5naW5lL21vZHVsZS9Nb2R1bGVNYW5hZ2VyXCIsIFwiLi9UZXN0UGFuZWxcIl0sIGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzLCBJbmplY3Rvcl8xLCBJbmplY3Rvcl8yLCBNZWRpYXRvcl8xLCBNb2R1bGVNYW5hZ2VyXzEsIFRlc3RQYW5lbF8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIHZhciBUZXN0Rm9yTWVkaWF0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRlc3RGb3JNZWRpYXRvciwgX3N1cGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBUZXN0Rm9yTWVkaWF0b3Ioc2tpbikge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgc2tpbikgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgVGVzdEZvck1lZGlhdG9yLnByb3RvdHlwZS5vbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgICAgICBvbkNsaWNrVGV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIE1vZHVsZU1hbmFnZXJfMS5tb2R1bGVNYW5hZ2VyLm9wZW4oVGVzdFBhbmVsXzEuZGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYXNkZmFzZGYgLSBcIiArIGRhdGEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZE9uKFwiY2xpY2tcIiwgXCJvbkNsaWNrVGV4dFwiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE9iamVjdClcclxuICAgICAgICBdLCBUZXN0Rm9yTWVkaWF0b3IucHJvdG90eXBlLCBcInNraW5cIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kVmFsdWUoeyBpbm5lckhUTUw6IFwiJ+i/meaYr+abv+aNouWQjueahOa4suafk+WZqOWGheWxgiAtICcgKyBkYXRhLmZ1Y2sgKyAnPGJyLz4nXCIgfSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIVE1MRWxlbWVudClcclxuICAgICAgICBdLCBUZXN0Rm9yTWVkaWF0b3IucHJvdG90eXBlLCBcImFzZGZcIiwgdm9pZCAwKTtcclxuICAgICAgICBUZXN0Rm9yTWVkaWF0b3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5ET01NZWRpYXRvckNsYXNzKFwiVGVzdEZvck1lZGlhdG9yXCIsIFwiPGRpdj7ov5nmmK/mm7/mjaLlkI7nmoTmuLLmn5PlmajlpJblsYI8ZGl2IGlkPSdhc2RmJz48L2Rpdj48L2Rpdj5cIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246cGFyYW10eXBlc1wiLCBbT2JqZWN0XSlcclxuICAgICAgICBdLCBUZXN0Rm9yTWVkaWF0b3IpO1xyXG4gICAgICAgIHJldHVybiBUZXN0Rm9yTWVkaWF0b3I7XHJcbiAgICB9KE1lZGlhdG9yXzEuZGVmYXVsdCkpO1xyXG4gICAgZXhwb3J0cy5kZWZhdWx0ID0gVGVzdEZvck1lZGlhdG9yO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVkdWemRFWnZjazFsWkdsaGRHOXlMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVZHVnpkRVp2Y2sxbFpHbGhkRzl5TG5SeklsMHNJbTVoYldWeklqcGJYU3dpYldGd2NHbHVaM01pT2lJN096czdPenM3T3pzN096czdPenM3T3pzN096czdTVUZQUVR0UlFVRTJReXh0UTBGQlVUdFJRVkZxUkN4NVFrRkJiVUlzU1VGQlNUdHRRa0ZGYmtJc2EwSkJRVTBzU1VGQlNTeERRVUZETzFGQlEyWXNRMEZCUXp0UlFVVk5MR2REUVVGTkxFZEJRV0lzVlVGQll5eEpRVUZKTzFsQlJXUXNTVUZCU1N4RFFVRkRMRk5CUVZNc1IwRkJSenRuUWtGRFlpeEpRVUZKTEVWQlFVVXNTVUZCU1R0blFrRkRWaXhYUVVGWExFVkJRVVU3YjBKQlExUXNOa0pCUVdFc1EwRkJReXhKUVVGSkxFTkJRVU1zYlVKQlFWTXNRMEZCUXl4RFFVRkRPMmRDUVVOc1F5eERRVUZETzJGQlEwb3NRMEZCUVR0WlFVTkVMRTlCUVU4c1EwRkJReXhIUVVGSExFTkJRVU1zWVVGQllTeEhRVUZITEVsQlFVa3NRMEZCUXl4RFFVRkRPMUZCUTNSRExFTkJRVU03VVVGdVFrUTdXVUZFUXl4cFFrRkJUU3hEUVVGRExFOUJRVThzUlVGQlJTeGhRVUZoTEVOQlFVTTdPM0ZFUVVObU8xRkJSMmhDTzFsQlJFTXNiMEpCUVZNc1EwRkJReXhGUVVGRExGTkJRVk1zUlVGQlJTeDNRMEZCZDBNc1JVRkJReXhEUVVGRE8zTkRRVU55UkN4WFFVRlhPM0ZFUVVGRE8xRkJUbEFzWlVGQlpUdFpRVVJ1UXl3eVFrRkJaMElzUTBGQlF5eHBRa0ZCYVVJc1JVRkJSU3cyUTBGQk5rTXNRMEZCUXpzN1YwRkRPVVFzWlVGQlpTeERRWFZDYmtNN1VVRkJSQ3h6UWtGQlF6dExRVUZCTEVGQmRrSkVMRU5CUVRaRExHdENRVUZSTEVkQmRVSndSRHR6UWtGMlFtOUNMR1ZCUVdVaWZRPT1cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kdWxlcy9UZXN0Rm9yTWVkaWF0b3IudHNcbi8vIG1vZHVsZSBpZCA9IDgwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCBNZWRpYXRvciBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JcIjtcclxuaW1wb3J0IE1lZGlhdG9yTWVzc2FnZSBmcm9tIFwiLi4vbWVkaWF0b3IvTWVkaWF0b3JNZXNzYWdlXCI7XHJcbmltcG9ydCB7IHBhbmVsTWFuYWdlciB9IGZyb20gXCIuL1BhbmVsTWFuYWdlclwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDZcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDZcclxuICogQGV4cG9ydFxyXG4gKiBAY2xhc3MgUGFuZWxNZWRpYXRvclxyXG4gKiBAZXh0ZW5kcyB7TWVkaWF0b3I8UywgT0QsIENEPn1cclxuICogQGltcGxlbWVudHMge0lQYW5lbDxTLCBPRCwgQ0Q+fVxyXG4gKiBAdGVtcGxhdGUgUyDnmq7ogqTnsbvlnotcclxuICogQHRlbXBsYXRlIE9EIOW8gOWQr+WPguaVsOexu+Wei1xyXG4gKiBAdGVtcGxhdGUgQ0Qg5YWz6Zet5Y+C5pWw57G75Z6LXHJcbiAqXHJcbiAqIOWunueOsOS6hklQYW5lbOaOpeWPo+eahOW8ueeql+S4reS7i+iAheWfuuexu1xyXG4qL1xyXG52YXIgUGFuZWxNZWRpYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFBhbmVsTWVkaWF0b3IsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBQYW5lbE1lZGlhdG9yKHNraW4sIHBvbGljeSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHNraW4pIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMucG9saWN5ID0gcG9saWN5O1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIFBhbmVsTWVkaWF0b3IucHJvdG90eXBlLl9fYWZ0ZXJPbk9wZW4gPSBmdW5jdGlvbiAoZGF0YSwgaXNNb2RlbCwgZnJvbSkge1xyXG4gICAgICAgIHBhbmVsTWFuYWdlci5wb3AodGhpcywgZGF0YSwgaXNNb2RlbCwgZnJvbSk7XHJcbiAgICB9O1xyXG4gICAgUGFuZWxNZWRpYXRvci5wcm90b3R5cGUuX19hZnRlck9uQ2xvc2UgPSBmdW5jdGlvbiAoZGF0YSwgdG8pIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8vIOevoeaUuW9uQWZ0ZXJEcm9w77yM562J5b6F5YWz6Zet5Yqo55S757uT5p2f5ZCO5YaN5omn6KGMXHJcbiAgICAgICAgdmFyIG9yaU9uQWZ0ZXJEcm9wID0gdGhpcy5vbkFmdGVyRHJvcDtcclxuICAgICAgICB0aGlzLm9uQWZ0ZXJEcm9wID0gZnVuY3Rpb24gKGRhdGEsIHRvKSB7XHJcbiAgICAgICAgICAgIG9yaU9uQWZ0ZXJEcm9wLmNhbGwoX3RoaXMsIGRhdGEsIHRvKTtcclxuICAgICAgICAgICAgLy8g5rS+5Y+R5YWz6Zet5LqL5Lu2XHJcbiAgICAgICAgICAgIF90aGlzLmRpc3BhdGNoKE1lZGlhdG9yTWVzc2FnZS5NRURJQVRPUl9DTE9TRUQsIF90aGlzKTtcclxuICAgICAgICAgICAgLy8g6LCD55So6ZSA5q+BXHJcbiAgICAgICAgICAgIF90aGlzLmRpc3Bvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHBhbmVsTWFuYWdlci5kcm9wKHRoaXMsIGRhdGEsIHRvKTtcclxuICAgIH07XHJcbiAgICAvKiog5Zyo5by55Ye65YmN6LCD55So55qE5pa55rOVICovXHJcbiAgICBQYW5lbE1lZGlhdG9yLnByb3RvdHlwZS5vbkJlZm9yZVBvcCA9IGZ1bmN0aW9uIChkYXRhLCBpc01vZGVsLCBmcm9tKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqIOWcqOW8ueWHuuWQjuiwg+eUqOeahOaWueazlSAqL1xyXG4gICAgUGFuZWxNZWRpYXRvci5wcm90b3R5cGUub25BZnRlclBvcCA9IGZ1bmN0aW9uIChkYXRhLCBpc01vZGVsLCBmcm9tKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqIOWcqOWFs+mXreWJjeiwg+eUqOeahOaWueazlSAqL1xyXG4gICAgUGFuZWxNZWRpYXRvci5wcm90b3R5cGUub25CZWZvcmVEcm9wID0gZnVuY3Rpb24gKGRhdGEsIHRvKSB7XHJcbiAgICAgICAgLy8g5Y+v6YeN5YaZXHJcbiAgICB9O1xyXG4gICAgLyoqIOWcqOWFs+mXreWQjuiwg+eUqOeahOaWueazlSAqL1xyXG4gICAgUGFuZWxNZWRpYXRvci5wcm90b3R5cGUub25BZnRlckRyb3AgPSBmdW5jdGlvbiAoZGF0YSwgdG8pIHtcclxuICAgICAgICAvLyDlj6/ph43lhplcclxuICAgIH07XHJcbiAgICByZXR1cm4gUGFuZWxNZWRpYXRvcjtcclxufShNZWRpYXRvcikpO1xyXG5leHBvcnQgZGVmYXVsdCBQYW5lbE1lZGlhdG9yO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9lbmdpbmUvcGFuZWwvUGFuZWxNZWRpYXRvci5qc1xuLy8gbW9kdWxlIGlkID0gODFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn07XHJcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xyXG59O1xyXG5kZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCIuL1NlY29uZFwiLCBcIi4uL21vZGVscy9GdWNrTW9kZWxcIiwgXCJvbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3JcIiwgXCJvbHltcHVzLXIvY29yZS9pbmplY3Rvci9JbmplY3RvclwiLCBcIm9seW1wdXMtci9lbmdpbmUvbW9kdWxlL01vZHVsZU1hbmFnZXJcIiwgXCJvbHltcHVzLXIvZW5naW5lL2luamVjdG9yL0luamVjdG9yXCIsIFwib2x5bXB1cy1yLWRvbS9kb20vaW5qZWN0b3IvSW5qZWN0b3JcIiwgXCIuL1Rlc3RQYW5lbFwiXSwgZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMsIFNlY29uZF8xLCBGdWNrTW9kZWxfMSwgU2NlbmVNZWRpYXRvcl8xLCBJbmplY3Rvcl8xLCBNb2R1bGVNYW5hZ2VyXzEsIEluamVjdG9yXzIsIEluamVjdG9yXzMsIFRlc3RQYW5lbF8xKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuICAgIC8qKlxyXG4gICAgICogQGF1dGhvciBSYXlraWRcclxuICAgICAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAgICAgKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gICAgICogQG1vZGlmeSBkYXRlIDIwMTctMDktMThcclxuICAgICAqXHJcbiAgICAgKiDmtYvor5XpppbkuKrmqKHlnZdcclxuICAgICovXHJcbiAgICB2YXIgVGhpcmQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICAgICAgX19leHRlbmRzKFRoaXJkLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFRoaXJkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFRoaXJkXzEgPSBUaGlyZDtcclxuICAgICAgICBUaGlyZC5wcm90b3R5cGUubGlzdEFzc2V0cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtcIi4vbW9kdWxlcy90ZXN0Lmh0bWxcIl07XHJcbiAgICAgICAgfTtcclxuICAgICAgICBUaGlyZC5wcm90b3R5cGUub25PcGVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgICAgICB0aGlzLnZpZXdNb2RlbCA9IHtcclxuICAgICAgICAgICAgICAgIGZ1Y2tMaXN0OiBbMSwgMiwgXCJzaGl0XCIsIFwieW91XCJdLFxyXG4gICAgICAgICAgICAgICAgZnVja1RleHQ6IFwiZnVjayB5b3VcIixcclxuICAgICAgICAgICAgICAgIG9uQ2xpY2tCdG46IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy52aWV3TW9kZWwuZnVja1RleHQgPSBcImNsaWNrZWRcIjtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2R1bGVNYW5hZ2VyLm9wZW4oU2Vjb25kXzEuZGVmYXVsdCwgbnVsbCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb25DbGlja1RleHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2R1bGVNYW5hZ2VyLm9wZW4oVGVzdFBhbmVsXzEuZGVmYXVsdCk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb25DbGlja0Z1Y2s6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2R1bGVNYW5hZ2VyLmNsb3NlKFRoaXJkXzEpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGZ1Y2tNb2RlbDogdGhpcy5mdWNrTW9kZWwxXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgVGhpcmRfMTtcclxuICAgICAgICBUaGlyZC5tb2R1bGVOYW1lID0gXCJUaGlyZFwiO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkluamVjdCxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIE1vZHVsZU1hbmFnZXJfMS5kZWZhdWx0KVxyXG4gICAgICAgIF0sIFRoaXJkLnByb3RvdHlwZSwgXCJtb2R1bGVNYW5hZ2VyXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzEuSW5qZWN0LFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgRnVja01vZGVsXzEuZGVmYXVsdClcclxuICAgICAgICBdLCBUaGlyZC5wcm90b3R5cGUsIFwiZnVja01vZGVsMVwiLCB2b2lkIDApO1xyXG4gICAgICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICBJbmplY3Rvcl8xLkluamVjdCxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEZ1Y2tNb2RlbF8xLklGdWNrTW9kZWwpXHJcbiAgICAgICAgXSwgVGhpcmQucHJvdG90eXBlLCBcImZ1Y2tNb2RlbDJcIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMS5JbmplY3QoMSksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBGdWNrTW9kZWxfMS5JRnVja01vZGVsKVxyXG4gICAgICAgIF0sIFRoaXJkLnByb3RvdHlwZSwgXCJmdWNrTW9kZWwzXCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZE9uKHsgY2xpY2s6IFwib25DbGlja0J0blwiIH0pLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkJpbmRJZihcImZ1Y2tUZXh0ID09ICcxMjM0J1wiKSxcclxuICAgICAgICAgICAgX19tZXRhZGF0YShcImRlc2lnbjp0eXBlXCIsIEhUTUxFbGVtZW50KVxyXG4gICAgICAgIF0sIFRoaXJkLnByb3RvdHlwZSwgXCJidG5cIiwgdm9pZCAwKTtcclxuICAgICAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kRm9yKFwiZnVjayBpbiBmdWNrTGlzdFwiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kVmFsdWUoeyB0ZXh0Q29udGVudDogXCJmdWNrICsgJyAtICcgKyBmdWNrVGV4dCArICcgLSAxJ1wiIH0pLFxyXG4gICAgICAgICAgICBJbmplY3Rvcl8yLkJpbmRPbihcImNsaWNrXCIsIFwib25DbGlja1RleHRcIiksXHJcbiAgICAgICAgICAgIF9fbWV0YWRhdGEoXCJkZXNpZ246dHlwZVwiLCBIVE1MRWxlbWVudClcclxuICAgICAgICBdLCBUaGlyZC5wcm90b3R5cGUsIFwidHh0XCIsIHZvaWQgMCk7XHJcbiAgICAgICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgICAgIEluamVjdG9yXzIuQmluZE9uKFwiY2xpY2tcIiwgXCJvbkNsaWNrRnVja1wiKSxcclxuICAgICAgICAgICAgSW5qZWN0b3JfMi5CaW5kVmFsdWUoXCJ0ZXh0Q29udGVudFwiLCBcImZ1Y2tNb2RlbC5mdWNrXCIpLFxyXG4gICAgICAgICAgICBfX21ldGFkYXRhKFwiZGVzaWduOnR5cGVcIiwgSFRNTEVsZW1lbnQpXHJcbiAgICAgICAgXSwgVGhpcmQucHJvdG90eXBlLCBcImZ1Y2tcIiwgdm9pZCAwKTtcclxuICAgICAgICBUaGlyZCA9IFRoaXJkXzEgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgSW5qZWN0b3JfMy5ET01NZWRpYXRvckNsYXNzKFwiVGhpcmRcIiwgXCIuL21vZHVsZXMvdGVzdC5odG1sXCIpXHJcbiAgICAgICAgXSwgVGhpcmQpO1xyXG4gICAgICAgIHJldHVybiBUaGlyZDtcclxuICAgIH0oU2NlbmVNZWRpYXRvcl8xLmRlZmF1bHQpKTtcclxuICAgIGV4cG9ydHMuZGVmYXVsdCA9IFRoaXJkO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pVkdocGNtUXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lKVWFHbHlaQzUwY3lKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pT3pzN096czdPenM3T3pzN096czdPenM3T3pzN08wbEJZVUU3T3pzN096czdUVUZQUlR0SlFVZEdPMUZCUVcxRExIbENRVUZoTzFGQlFXaEVPenRSUVN0RFFTeERRVUZETzJ0Q1FTOURiMElzUzBGQlN6dFJRWGRDWml3d1FrRkJWU3hIUVVGcVFqdFpRVVZKTEU5QlFVOHNRMEZCUXl4eFFrRkJjVUlzUTBGQlF5eERRVUZETzFGQlEyNURMRU5CUVVNN1VVRkZUU3h6UWtGQlRTeEhRVUZpTzFsQlFVRXNhVUpCYVVKRE8xbEJaa2NzU1VGQlNTeERRVUZETEZOQlFWTXNSMEZCUnp0blFrRkRZaXhSUVVGUkxFVkJRVVVzUTBGQlF5eERRVUZETEVWQlFVVXNRMEZCUXl4RlFVRkZMRTFCUVUwc1JVRkJSU3hMUVVGTExFTkJRVU03WjBKQlF5OUNMRkZCUVZFc1JVRkJSU3hWUVVGVk8yZENRVU53UWl4VlFVRlZMRVZCUVVVN2IwSkJRMUlzUzBGQlNTeERRVUZETEZOQlFWTXNRMEZCUXl4UlFVRlJMRWRCUVVjc1UwRkJVeXhEUVVGRE8yOUNRVU53UXl4TFFVRkpMRU5CUVVNc1lVRkJZU3hEUVVGRExFbEJRVWtzUTBGQlF5eG5Ra0ZCVFN4RlFVRkZMRWxCUVVrc1JVRkJSU3hKUVVGSkxFTkJRVU1zUTBGQlF6dG5Ra0ZEYUVRc1EwRkJRenRuUWtGRFJDeFhRVUZYTEVWQlFVVTdiMEpCUTFRc1MwRkJTU3hEUVVGRExHRkJRV0VzUTBGQlF5eEpRVUZKTEVOQlFVTXNiVUpCUVZNc1EwRkJReXhEUVVGRE8yZENRVU4yUXl4RFFVRkRPMmRDUVVORUxGZEJRVmNzUlVGQlJUdHZRa0ZEVkN4TFFVRkpMRU5CUVVNc1lVRkJZU3hEUVVGRExFdEJRVXNzUTBGQlF5eFBRVUZMTEVOQlFVTXNRMEZCUXp0blFrRkRjRU1zUTBGQlF6dG5Ra0ZEUkN4VFFVRlRMRVZCUVVVc1NVRkJTU3hEUVVGRExGVkJRVlU3WVVGRE4wSXNRMEZCUXp0UlFVTk9MRU5CUVVNN08xRkJOVU5oTEdkQ1FVRlZMRWRCUVZVc1QwRkJUeXhEUVVGRE8xRkJSekZETzFsQlJFTXNhVUpCUVUwN2MwTkJRMlVzZFVKQlFXRTdiMFJCUVVNN1VVRkZjRU03V1VGRVF5eHBRa0ZCVFR0elEwRkRXU3h0UWtGQlV6dHBSRUZCUXp0UlFVVTNRanRaUVVSRExHbENRVUZOTzNORFFVTlpMSE5DUVVGVk8ybEVRVUZETzFGQlJUbENPMWxCUkVNc2FVSkJRVTBzUTBGQlF5eERRVUZETEVOQlFVTTdjME5CUTFNc2MwSkJRVlU3YVVSQlFVTTdVVUZKT1VJN1dVRkdReXhwUWtGQlRTeERRVUZETEVWQlFVTXNTMEZCU3l4RlFVRkZMRmxCUVZrc1JVRkJReXhEUVVGRE8xbEJRemRDTEdsQ1FVRk5MRU5CUVVNc2IwSkJRVzlDTEVOQlFVTTdjME5CUTJ4Q0xGZEJRVmM3TUVOQlFVRTdVVUZKZEVJN1dVRklReXhyUWtGQlR5eERRVUZETEd0Q1FVRnJRaXhEUVVGRE8xbEJRek5DTEc5Q1FVRlRMRU5CUVVNc1JVRkJReXhYUVVGWExFVkJRVVVzYTBOQlFXdERMRVZCUVVNc1EwRkJRenRaUVVNMVJDeHBRa0ZCVFN4RFFVRkRMRTlCUVU4c1JVRkJSU3hoUVVGaExFTkJRVU03YzBOQlEzQkNMRmRCUVZjN01FTkJRVU03VVVGSGRrSTdXVUZHUXl4cFFrRkJUU3hEUVVGRExFOUJRVThzUlVGQlJTeGhRVUZoTEVOQlFVTTdXVUZET1VJc2IwSkJRVk1zUTBGQlF5eGhRVUZoTEVWQlFVVXNaMEpCUVdkQ0xFTkJRVU03YzBOQlF5OUNMRmRCUVZjN01rTkJRVU03VVVGMFFsQXNTMEZCU3p0WlFVUjZRaXd5UWtGQlowSXNRMEZCUXl4UFFVRlBMRVZCUVVVc2NVSkJRWEZDTEVOQlFVTTdWMEZETlVJc1MwRkJTeXhEUVN0RGVrSTdVVUZCUkN4WlFVRkRPMHRCUVVFc1FVRXZRMFFzUTBGQmJVTXNkVUpCUVdFc1IwRXJReTlETzNOQ1FTOURiMElzUzBGQlN5SjlcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3QvbW9kdWxlcy9UaGlyZC50c1xuLy8gbW9kdWxlIGlkID0gODJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgZW5naW5lIH0gZnJvbSBcIi4vZW5naW5lL0VuZ2luZVwiO1xyXG5leHBvcnQgeyBjb3JlIH0gZnJvbSBcIi4vY29yZS9Db3JlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOFxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOFxyXG4gKlxyXG4gKiBPbHltcHVz5qGG5p625L6/5o235ZCv5Yqo5LiO5qGG5p625aSW6KeC5qih5Z2XXHJcbiovXHJcbnZhciBPbHltcHVzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT2x5bXB1cygpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5ZCv5YqoT2x5bXB1c+ahhuaetlxyXG4gICAgICpcclxuICAgICAqIEBzdGF0aWNcclxuICAgICAqIEBwYXJhbSB7SUluaXRQYXJhbXN9IHBhcmFtcyDlkK/liqjlj4LmlbBcclxuICAgICAqIEBtZW1iZXJvZiBPbHltcHVzXHJcbiAgICAgKi9cclxuICAgIE9seW1wdXMuc3RhcnR1cCA9IGZ1bmN0aW9uIChwYXJhbXMpIHtcclxuICAgICAgICAvLyDliJ3lp4vljJblvJXmk47mqKHlnZdcclxuICAgICAgICBlbmdpbmUuaW5pdGlhbGl6ZShwYXJhbXMpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBPbHltcHVzO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBPbHltcHVzO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9PbHltcHVzLmpzXG4vLyBtb2R1bGUgaWQgPSA4M1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IHsgYXNzZXRzTWFuYWdlciB9IGZyb20gXCIuL2Fzc2V0cy9Bc3NldHNNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IGJyaWRnZU1hbmFnZXIgfSBmcm9tIFwiLi9icmlkZ2UvQnJpZGdlTWFuYWdlclwiO1xyXG5pbXBvcnQgQnJpZGdlTWVzc2FnZSBmcm9tIFwiLi9icmlkZ2UvQnJpZGdlTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyBlbnZpcm9ubWVudCB9IGZyb20gXCIuL2Vudi9FbnZpcm9ubWVudFwiO1xyXG5pbXBvcnQgeyBoYXNoIH0gZnJvbSBcIi4vZW52L0hhc2hcIjtcclxuaW1wb3J0IEVuZ2luZU1lc3NhZ2UgZnJvbSBcIi4vbWVzc2FnZS9FbmdpbmVNZXNzYWdlXCI7XHJcbmltcG9ydCB7IG1vZHVsZU1hbmFnZXIgfSBmcm9tIFwiLi9tb2R1bGUvTW9kdWxlTWFuYWdlclwiO1xyXG5pbXBvcnQgTW9kdWxlTWVzc2FnZSBmcm9tIFwiLi9tb2R1bGUvTW9kdWxlTWVzc2FnZVwiO1xyXG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIi4vdmVyc2lvbi9WZXJzaW9uXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0wNlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0wNlxyXG4gKlxyXG4gKiBFbmdpbmXmqKHnu4TmmK/lvIDlj5HmoYbmnrbnmoTlvJXmk47pg6jliIbvvIzljIXmi6zkuJrliqHmqKHlnZfns7vnu5/jgIHlupTnlKjnqIvluo/lkK/liqjlkozliJ3lp4vljJbjgIHlvLnnqpflkozlnLrmma/nrqHnkIblmajnrYnkuI7pobnnm67lvIDlj5Hnm7jlhbPnmoTpgLvovpHpg73lnKjov5nkuKrmqKHnu4TkuK1cclxuICog6L+Z5Liq5qih57uE55qE6YC76L6R6YO96auY5bqm6ZuG5oiQ5Zyo5a2Q5qih57uE5Lit5LqG77yM5Zug5q2k5Lmf5Y+q5piv5pS26ZuG55u45YWz5a2Q5qih57uEXHJcbiovXHJcbmV4cG9ydCB2YXIgSW5pdFN0ZXA7XHJcbihmdW5jdGlvbiAoSW5pdFN0ZXApIHtcclxuICAgIC8qKiDmoYbmnrblsJrmnKrlvIDlp4vliJ3lp4vljJYgKi9cclxuICAgIEluaXRTdGVwW0luaXRTdGVwW1wiVW5pbml0XCJdID0gMF0gPSBcIlVuaW5pdFwiO1xyXG4gICAgLyoqIOahhuaetuW3suWHhuWkh+WlveWIneWni+WMliAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJSZWFkeVRvSW5pdFwiXSA9IDFdID0gXCJSZWFkeVRvSW5pdFwiO1xyXG4gICAgLyoqIOW8gOWni+aJp+ihjOWIneWni+WMliAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJTdGFydEluaXRcIl0gPSAyXSA9IFwiU3RhcnRJbml0XCI7XHJcbiAgICAvKiog54mI5pys5Y+357O757uf5Yid5aeL5YyW5a6M5q+VICovXHJcbiAgICBJbml0U3RlcFtJbml0U3RlcFtcIlZlcnNpb25Jbml0ZWRcIl0gPSAzXSA9IFwiVmVyc2lvbkluaXRlZFwiO1xyXG4gICAgLyoqIOihqOeOsOWxguahpeWIneWni+WMluWujOavlSAqL1xyXG4gICAgSW5pdFN0ZXBbSW5pdFN0ZXBbXCJCcmlkZ2VzSW5pdGVkXCJdID0gNF0gPSBcIkJyaWRnZXNJbml0ZWRcIjtcclxuICAgIC8qKiDpooTliqDovb3vvIzlj6/og73kvJrop6blj5HlpJrmrKHvvIzmr4/mrKHkvKDpgJLkuKTkuKrlj4LmlbDvvJrpooTliqDovb3mlofku7blkI3miJbot6/lvoTjgIHpooTliqDovb3mlofku7blhoXlrrkgKi9cclxuICAgIEluaXRTdGVwW0luaXRTdGVwW1wiUHJlbG9hZFwiXSA9IDVdID0gXCJQcmVsb2FkXCI7XHJcbiAgICAvKiog5byA5aeL5omT5byA6aaW5Liq5qih5Z2XICovXHJcbiAgICBJbml0U3RlcFtJbml0U3RlcFtcIk9wZW5GaXJzdE1vZHVsZVwiXSA9IDZdID0gXCJPcGVuRmlyc3RNb2R1bGVcIjtcclxuICAgIC8qKiDpppbkuKrmqKHlnZfmiZPlvIDlrozmr5XvvIzliJ3lp4vljJbmtYHnqIvlrozmr5UgKi9cclxuICAgIEluaXRTdGVwW0luaXRTdGVwW1wiSW5pdGVkXCJdID0gN10gPSBcIkluaXRlZFwiO1xyXG59KShJbml0U3RlcCB8fCAoSW5pdFN0ZXAgPSB7fSkpO1xyXG52YXIgRW5naW5lID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRW5naW5lKCkge1xyXG4gICAgICAgIHRoaXMuX2luaXRTdGVwID0gSW5pdFN0ZXAuVW5pbml0O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVuZ2luZS5wcm90b3R5cGUsIFwiaW5pdFBhcmFtc1wiLCB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICog6I635Y+W5Yid5aeL5YyW5Y+C5pWwXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmVhZG9ubHlcclxuICAgICAgICAgKiBAdHlwZSB7SUluaXRQYXJhbXN9XHJcbiAgICAgICAgICogQG1lbWJlcm9mIEVuZ2luZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW5pdFBhcmFtcztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFbmdpbmUucHJvdG90eXBlLCBcImluaXRTdGVwXCIsIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDojrflj5bmoYbmnrbliJ3lp4vljJbov5vnqItcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEByZWFkb25seVxyXG4gICAgICAgICAqIEB0eXBlIHtJbml0U3RlcH1cclxuICAgICAgICAgKiBAbWVtYmVyb2YgRW5naW5lXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbml0U3RlcDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5Yid5aeL5YyWRW5naW5lXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtJSW5pdFBhcmFtc30gcGFyYW1zIOWIneWni+WMluWPguaVsFxyXG4gICAgICogQG1lbWJlcm9mIEVuZ2luZVxyXG4gICAgICovXHJcbiAgICBFbmdpbmUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAocGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOWIneWni+WMluS4ujAlXHJcbiAgICAgICAgdGhpcy5faW5pdFN0ZXAgPSBJbml0U3RlcC5SZWFkeVRvSW5pdDtcclxuICAgICAgICBwYXJhbXMub25Jbml0UHJvZ3Jlc3MgJiYgcGFyYW1zLm9uSW5pdFByb2dyZXNzKDAsIHRoaXMuX2luaXRTdGVwKTtcclxuICAgICAgICAvLyDmiafooYzliJ3lp4vljJZcclxuICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSBcImxvYWRpbmdcIilcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlYWR5c3RhdGVjaGFuZ2VcIiwgZG9Jbml0aWFsaXplKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGRvSW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIGZ1bmN0aW9uIGRvSW5pdGlhbGl6ZSgpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So6L+b5bqm5Zue6LCD77yM5byA5aeL5Yid5aeL5YyW5Li6MTAlXHJcbiAgICAgICAgICAgIHNlbGYuX2luaXRTdGVwID0gSW5pdFN0ZXAuU3RhcnRJbml0O1xyXG4gICAgICAgICAgICBwYXJhbXMub25Jbml0UHJvZ3Jlc3MgJiYgcGFyYW1zLm9uSW5pdFByb2dyZXNzKDAuMSwgc2VsZi5faW5pdFN0ZXApO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTkuovku7ZcclxuICAgICAgICAgICAgaWYgKHRoaXMgPT0gZG9jdW1lbnQpXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLCBkb0luaXRpYWxpemUpO1xyXG4gICAgICAgICAgICAvLyDopoHliKTmlq1kb2N1bWVudOaYr+WQpuWIneWni+WMluWujOavlVxyXG4gICAgICAgICAgICBzZWxmLl9pbml0UGFyYW1zID0gcGFyYW1zO1xyXG4gICAgICAgICAgICAvLyDliqDovb3pobVcclxuICAgICAgICAgICAgc2VsZi5fbG9hZEVsZW1lbnQgPSAodHlwZW9mIHBhcmFtcy5sb2FkRWxlbWVudCA9PSBcInN0cmluZ1wiID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYXJhbXMubG9hZEVsZW1lbnQpIDogcGFyYW1zLmxvYWRFbGVtZW50KTtcclxuICAgICAgICAgICAgLy8g55uR5ZCs6ZSZ6K+v5LqL5Lu2XHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMub25FcnJvcilcclxuICAgICAgICAgICAgICAgIHNlbGYubGlzdGVuRXJyb3IocGFyYW1zLm9uRXJyb3IpO1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJbnjq/looPlj4LmlbBcclxuICAgICAgICAgICAgZW52aXJvbm1lbnQuaW5pdGlhbGl6ZShwYXJhbXMuZW52LCBwYXJhbXMuaG9zdHNEaWN0LCBwYXJhbXMuY2Ruc0RpY3QpO1xyXG4gICAgICAgICAgICAvLyDliJ3lp4vljJbniYjmnKzlj7flt6XlhbdcclxuICAgICAgICAgICAgaWYgKHBhcmFtcy5oYXNWZXJzaW9uICE9PSBmYWxzZSlcclxuICAgICAgICAgICAgICAgIHZlcnNpb24uaW5pdGlhbGl6ZShhZnRlckluaXRWZXJzaW9uLCBwYXJhbXMudmVyc2lvbik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIGFmdGVySW5pdFZlcnNpb24oKTtcclxuICAgICAgICAgICAgZnVuY3Rpb24gYWZ0ZXJJbml0VmVyc2lvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOeJiOacrOWPt+WIneWni+WMluWujOavleS4ujIwJVxyXG4gICAgICAgICAgICAgICAgc2VsZi5faW5pdFN0ZXAgPSBJbml0U3RlcC5WZXJzaW9uSW5pdGVkO1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm9uSW5pdFByb2dyZXNzICYmIHBhcmFtcy5vbkluaXRQcm9ncmVzcygwLjIsIHNlbGYuX2luaXRTdGVwKTtcclxuICAgICAgICAgICAgICAgIC8vIOebkeWQrEJyaWRnZeWIneWni+WMluWujOavleS6i+S7tu+8jOaYvuekuuesrOS4gOS4quaooeWdl1xyXG4gICAgICAgICAgICAgICAgY29yZS5saXN0ZW4oQnJpZGdlTWVzc2FnZS5CUklER0VfQUxMX0lOSVQsIHNlbGYub25BbGxCcmlkZ2VzSW5pdCwgc2VsZik7XHJcbiAgICAgICAgICAgICAgICAvLyDms6jlhozlubbliJ3lp4vljJbooajnjrDlsYLmoaXlrp7kvotcclxuICAgICAgICAgICAgICAgIGJyaWRnZU1hbmFnZXIucmVnaXN0ZXJCcmlkZ2UuYXBwbHkoYnJpZGdlTWFuYWdlciwgcGFyYW1zLmJyaWRnZXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5re75Yqg6ZSZ6K+v55uR5ZCs5Ye95pWwXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHsoZXZ0PzpFcnJvckV2ZW50KT0+dm9pZH0gaGFuZGxlciDplJnor6/nm5HlkKzlh73mlbBcclxuICAgICAqIEBtZW1iZXJvZiBFbmdpbmVcclxuICAgICAqL1xyXG4gICAgRW5naW5lLnByb3RvdHlwZS5saXN0ZW5FcnJvciA9IGZ1bmN0aW9uIChoYW5kbGVyKSB7XHJcbiAgICAgICAgaWYgKGhhbmRsZXIpXHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgaGFuZGxlcik7XHJcbiAgICB9O1xyXG4gICAgRW5naW5lLnByb3RvdHlwZS5vbkFsbEJyaWRnZXNJbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0c2xpYl8xLl9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgX2ksIF9hLCBwbHVnaW4sIHByZWxvYWRzLCBjdXJJbmRleCwgdG90YWxDb3VudDtcclxuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjov5vluqblm57osIPvvIzooajnjrDlsYLmoaXliJ3lp4vljJblrozmr5XkuLozMCVcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5pdFN0ZXAgPSBJbml0U3RlcC5CcmlkZ2VzSW5pdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdFByb2dyZXNzICYmIHRoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MoMC4zLCB0aGlzLl9pbml0U3RlcCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOazqOmUgOebkeWQrFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JlLnVubGlzdGVuKEJyaWRnZU1lc3NhZ2UuQlJJREdFX0FMTF9JTklULCB0aGlzLm9uQWxsQnJpZGdlc0luaXQsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2luaXRQYXJhbXMucGx1Z2lucykgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pID0gMCwgX2EgPSB0aGlzLl9pbml0UGFyYW1zLnBsdWdpbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKF9pIDwgX2EubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpbiA9IF9hW19pXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGx1Z2luLmluaXRQbHVnaW4oKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5rOo5YaM55+t5ZCN56ewXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2V0c01hbmFnZXIuY29uZmlnUGF0aCh0aGlzLl9pbml0UGFyYW1zLnBhdGhEaWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlbG9hZHMgPSB0aGlzLl9pbml0UGFyYW1zLnByZWxvYWRzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJlbG9hZHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1ckluZGV4ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQ291bnQgPSBwcmVsb2Fkcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NldHNNYW5hZ2VyLmxvYWRBc3NldHMocHJlbG9hZHMsIHRoaXMub25QcmVsb2FkT0suYmluZCh0aGlzKSwgbnVsbCwgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJJbmRleCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOavj+S4qumihOWKoOi9veaWh+S7tuW5s+WIhjMwJS05MCXnmoTov5vluqZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSAwLjMgKyAwLjYgKiBjdXJJbmRleCAvIHRvdGFsQ291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5L+d55WZMuS9jeWwj+aVsFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzID0gTWF0aC5yb3VuZChwcm9ncmVzcyAqIDEwMCkgKiAwLjAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9pbml0U3RlcCA9IEluaXRTdGVwLlByZWxvYWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MgJiYgX3RoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MocHJvZ3Jlc3MsIF90aGlzLl9pbml0U3RlcCwga2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOayoeaciemihOWKoOi9ve+8jOebtOaOpeWujOaIkFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblByZWxvYWRPSygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgRW5naW5lLnByb3RvdHlwZS5vblByZWxvYWRPSyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIF9hLCBpLCBkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2IubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOaJk+W8gOmmluS4quaooeWdl+S4ujkwJVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbml0U3RlcCA9IEluaXRTdGVwLk9wZW5GaXJzdE1vZHVsZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW5pdFBhcmFtcy5vbkluaXRQcm9ncmVzcyAmJiB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdFByb2dyZXNzKDAuOSwgdGhpcy5faW5pdFN0ZXApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmtL7lj5Hkuovku7ZcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29yZS5kaXNwYXRjaChFbmdpbmVNZXNzYWdlLklOSVRJQUxJWkVEKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g6LCD55So5Yid5aeL5YyW5a6M5oiQ5Zue6LCDXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gdGhpcy5faW5pdFBhcmFtcy5vbkluaXRlZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfYSkgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWIneWni+WMluWujOaIkOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgdGhpcy5faW5pdFBhcmFtcy5vbkluaXRlZCgpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gKF9iLnNlbnQoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWIneWni+WMluWujOaIkOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g55uR5ZCs6aaW5Liq5qih5Z2X5byA5ZCvXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcmUubGlzdGVuKE1vZHVsZU1lc3NhZ2UuTU9EVUxFX0NIQU5HRSwgdGhpcy5vbk1vZHVsZUNoYW5nZSwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaJk+W8gOmmluS4quaooeWdl1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGVNYW5hZ2VyLm9wZW4odGhpcy5faW5pdFBhcmFtcy5maXJzdE1vZHVsZSwgaGFzaC5maXJzdE1vZHVsZVBhcmFtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWmguaenOacieWTiOW4jOaooeWdl+WImeaJk+W8gOS5i1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgaW4gaGFzaC5tb2R1bGVEYXRhcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGhhc2gubW9kdWxlRGF0YXNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDlpoLmnpzmqKHlnZfmsqHmnInlkI3lrZfliJnkuI3ov5vooYzmk43kvZxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlTWFuYWdlci5vcGVuKGRhdGEubmFtZSwgZGF0YS5wYXJhbXMsIGRhdGEuZGlyZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEVuZ2luZS5wcm90b3R5cGUub25Nb2R1bGVDaGFuZ2UgPSBmdW5jdGlvbiAoZnJvbSkge1xyXG4gICAgICAgIC8vIOiwg+eUqOi/m+W6puWbnuiwg++8jOWFqOmDqOi/h+eoi+WujOavle+8jDEwMCVcclxuICAgICAgICB0aGlzLl9pbml0U3RlcCA9IEluaXRTdGVwLkluaXRlZDtcclxuICAgICAgICB0aGlzLl9pbml0UGFyYW1zLm9uSW5pdFByb2dyZXNzICYmIHRoaXMuX2luaXRQYXJhbXMub25Jbml0UHJvZ3Jlc3MoMSwgdGhpcy5faW5pdFN0ZXApO1xyXG4gICAgICAgIC8vIOazqOmUgOebkeWQrFxyXG4gICAgICAgIGNvcmUudW5saXN0ZW4oTW9kdWxlTWVzc2FnZS5NT0RVTEVfQ0hBTkdFLCB0aGlzLm9uTW9kdWxlQ2hhbmdlLCB0aGlzKTtcclxuICAgICAgICAvLyDnp7vpmaRsb2FkRWxlbWVudOaYvuekulxyXG4gICAgICAgIGlmICh0aGlzLl9sb2FkRWxlbWVudCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5fbG9hZEVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICAgICAgcGFyZW50ICYmIHBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9sb2FkRWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEVuZ2luZSA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgRW5naW5lKTtcclxuICAgIHJldHVybiBFbmdpbmU7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEVuZ2luZTtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIGVuZ2luZSA9IGNvcmUuZ2V0SW5qZWN0KEVuZ2luZSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9FbmdpbmUuanNcbi8vIG1vZHVsZSBpZCA9IDg0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0xOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0xOVxyXG4gKlxyXG4gKiDmuLLmn5PmqKHlvI/mnprkuL5cclxuKi9cclxudmFyIFJlbmRlck1vZGU7XHJcbihmdW5jdGlvbiAoUmVuZGVyTW9kZSkge1xyXG4gICAgUmVuZGVyTW9kZVtSZW5kZXJNb2RlW1wiQVVUT1wiXSA9IDBdID0gXCJBVVRPXCI7XHJcbiAgICBSZW5kZXJNb2RlW1JlbmRlck1vZGVbXCJDQU5WQVNcIl0gPSAxXSA9IFwiQ0FOVkFTXCI7XHJcbiAgICBSZW5kZXJNb2RlW1JlbmRlck1vZGVbXCJXRUJHTFwiXSA9IDJdID0gXCJXRUJHTFwiO1xyXG59KShSZW5kZXJNb2RlIHx8IChSZW5kZXJNb2RlID0ge30pKTtcclxuZXhwb3J0IGRlZmF1bHQgUmVuZGVyTW9kZTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvUmVuZGVyTW9kZS5qc1xuLy8gbW9kdWxlIGlkID0gODVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgZW52aXJvbm1lbnQgfSBmcm9tIFwib2x5bXB1cy1yL2VuZ2luZS9lbnYvRW52aXJvbm1lbnRcIjtcclxuaW1wb3J0IHsgcGFuZWxNYW5hZ2VyIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvcGFuZWwvUGFuZWxNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IHBsYXRmb3JtTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3BsYXRmb3JtL1BsYXRmb3JtTWFuYWdlclwiO1xyXG5pbXBvcnQgeyB2ZXJzaW9uIH0gZnJvbSBcIm9seW1wdXMtci9lbmdpbmUvdmVyc2lvbi9WZXJzaW9uXCI7XHJcbnZhciBSZXNvdXJjZVZlcnNpb25Db250cm9sbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoUmVzb3VyY2VWZXJzaW9uQ29udHJvbGxlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgUmVzb3VyY2VWZXJzaW9uQ29udHJvbGxlci5wcm90b3R5cGUuZ2V0VmlydHVhbFVybCA9IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAvLyDmt7vliqBpbWdEb21haW5cclxuICAgICAgICB1cmwgPSBlbnZpcm9ubWVudC50b0NETkhvc3RVUkwodXJsKTtcclxuICAgICAgICAvLyDmt7vliqDniYjmnKzlj7fvvIzmnInlk4jluIzlgLzlsLHnlKjlk4jluIzlgLzliqDovb3vvIzmsqHmnInlsLHnlKjnvJbor5HniYjmnKzlj7fliqDovb1cclxuICAgICAgICB1cmwgPSB2ZXJzaW9uLndyYXBIYXNoVXJsKHVybCk7XHJcbiAgICAgICAgLy8g6L+U5ZuedXJsXHJcbiAgICAgICAgcmV0dXJuIHVybDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gUmVzb3VyY2VWZXJzaW9uQ29udHJvbGxlcjtcclxufShSRVMuVmVyc2lvbkNvbnRyb2xsZXIpKTtcclxuZXhwb3J0IHsgUmVzb3VyY2VWZXJzaW9uQ29udHJvbGxlciB9O1xyXG4vLyDov5nph4znm7TmjqXms6jlhozkuIDkuItcclxuUkVTLnJlZ2lzdGVyVmVyc2lvbkNvbnRyb2xsZXIobmV3IFJlc291cmNlVmVyc2lvbkNvbnRyb2xsZXIoKSk7XHJcbnZhciBBc3NldHNMb2FkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBc3NldHNMb2FkZXIoaGFuZGxlcikge1xyXG4gICAgICAgIHRoaXMuX3JldHJ5RGljdCA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgfVxyXG4gICAgQXNzZXRzTG9hZGVyLnByb3RvdHlwZS5sb2FkR3JvdXBzID0gZnVuY3Rpb24gKGdyb3Vwcykge1xyXG4gICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZXIuc3RhcnQgJiYgdGhpcy5faGFuZGxlci5zdGFydCgpO1xyXG4gICAgICAgIC8vIOe7hOWQjeWmguaenOaYr+epuuWtl+espuS4suWImeS8muWvvOiHtEVncmV05LuA5LmI6YO95LiN5bmy77yM5omA5Lul6KaB56e76Zmk56m65a2X56ym5Liy55qE57uE5ZCNXHJcbiAgICAgICAgZ3JvdXBzID0gZ3JvdXBzICYmIGdyb3Vwcy5maWx0ZXIoZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZ3JvdXAgPT0gXCJzdHJpbmdcIilcclxuICAgICAgICAgICAgICAgIHJldHVybiAoZ3JvdXAgIT0gXCJcIik7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHJldHVybiAoZ3JvdXAubmFtZSAhPSBcIlwiKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyDlvIDlp4vliqDovb1cclxuICAgICAgICB2YXIgZ3JvdXBEaWN0ID0ge307XHJcbiAgICAgICAgdmFyIHBnc0RpY3Q7XHJcbiAgICAgICAgdmFyIGxlbiA9IGdyb3VwcyA/IGdyb3Vwcy5sZW5ndGggOiAwO1xyXG4gICAgICAgIGlmIChsZW4gPT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVyLmNvbXBsZXRlICYmIHRoaXMuX2hhbmRsZXIuY29tcGxldGUoZ3JvdXBEaWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIFJFUy5hZGRFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX1BST0dSRVNTLCBvblByb2dyZXNzLCB0aGlzKTtcclxuICAgICAgICAgICAgUkVTLmFkZEV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfQ09NUExFVEUsIG9uT25lQ29tcGxldGUsIHRoaXMpO1xyXG4gICAgICAgICAgICBSRVMuYWRkRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9MT0FEX0VSUk9SLCBvbk9uZUVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgdmFyIHRlbXAgPSBncm91cHMuY29uY2F0KCk7XHJcbiAgICAgICAgICAgIHBnc0RpY3QgPSB7fTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBncm91cHMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBncm91cCA9IGdyb3Vwc1tpXTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZ3JvdXAgPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHBnc0RpY3RbZ3JvdXBdID0gMDtcclxuICAgICAgICAgICAgICAgICAgICBSRVMubG9hZEdyb3VwKGdyb3VwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBnc0RpY3RbZ3JvdXAubmFtZV0gPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5sb2FkR3JvdXAoZ3JvdXAubmFtZSwgZ3JvdXAucHJpb3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIG9uUHJvZ3Jlc3MoZXZ0KSB7XHJcbiAgICAgICAgICAgIC8vIOWhq+WFhei1hOa6kOWtl+WFuFxyXG4gICAgICAgICAgICB2YXIgaXRlbURpY3QgPSBncm91cERpY3RbZXZ0Lmdyb3VwTmFtZV07XHJcbiAgICAgICAgICAgIGlmICghaXRlbURpY3QpXHJcbiAgICAgICAgICAgICAgICBncm91cERpY3RbZXZ0Lmdyb3VwTmFtZV0gPSBpdGVtRGljdCA9IHt9O1xyXG4gICAgICAgICAgICBpdGVtRGljdFtldnQucmVzSXRlbS5uYW1lXSA9IGV2dC5yZXNJdGVtO1xyXG4gICAgICAgICAgICAvLyDorqHnrpfmgLvov5vluqZcclxuICAgICAgICAgICAgcGdzRGljdFtldnQuZ3JvdXBOYW1lXSA9IGV2dC5pdGVtc0xvYWRlZCAvIGV2dC5pdGVtc1RvdGFsO1xyXG4gICAgICAgICAgICB2YXIgcGdzID0gMDtcclxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHBnc0RpY3QpIHtcclxuICAgICAgICAgICAgICAgIHBncyArPSBwZ3NEaWN0W2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGdzIC89IGxlbjtcclxuICAgICAgICAgICAgLy8g5Zue6LCDXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIucHJvZ3Jlc3MgJiYgdGhpcy5faGFuZGxlci5wcm9ncmVzcyhldnQucmVzSXRlbSwgcGdzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gb25PbmVDb21wbGV0ZShldnQpIHtcclxuICAgICAgICAgICAgLy8g6LCD55So5Y2V5LiA5a6M5q+V5Zue6LCDXHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIub25lQ29tcGxldGUgJiYgdGhpcy5faGFuZGxlci5vbmVDb21wbGV0ZShncm91cERpY3RbZXZ0Lmdyb3VwTmFtZV0pO1xyXG4gICAgICAgICAgICAvLyDmtYvor5XmmK/lkKblhajpg6jlrozmr5VcclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gdGVtcC5pbmRleE9mKGV2dC5ncm91cE5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8g56e76Zmk5Yqg6L2957uE5ZCNXHJcbiAgICAgICAgICAgICAgICB0ZW1wLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAvLyDliKTmlq3mmK/lkKblhajpg6jlrozmiJBcclxuICAgICAgICAgICAgICAgIGlmICh0ZW1wLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g56e76Zmk5LqL5Lu255uR5ZCsXHJcbiAgICAgICAgICAgICAgICAgICAgUkVTLnJlbW92ZUV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfUFJPR1JFU1MsIG9uUHJvZ3Jlc3MsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5yZW1vdmVFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX0NPTVBMRVRFLCBvbk9uZUNvbXBsZXRlLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9MT0FEX0VSUk9SLCBvbk9uZUVycm9yLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyDosIPnlKjlm57osINcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVyLmNvbXBsZXRlICYmIHRoaXMuX2hhbmRsZXIuY29tcGxldGUoZ3JvdXBEaWN0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBvbk9uZUVycm9yKGV2dCkge1xyXG4gICAgICAgICAgICB2YXIgZ3JvdXBOYW1lID0gZXZ0Lmdyb3VwTmFtZTtcclxuICAgICAgICAgICAgdmFyIHJldHJ5VGltZXMgPSB0aGlzLl9yZXRyeURpY3RbZ3JvdXBOYW1lXTtcclxuICAgICAgICAgICAgaWYgKHJldHJ5VGltZXMgPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHJ5VGltZXMgPSAwO1xyXG4gICAgICAgICAgICBpZiAocmV0cnlUaW1lcyA8IDMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JldHJ5RGljdFtncm91cE5hbWVdID0gKytyZXRyeVRpbWVzO1xyXG4gICAgICAgICAgICAgICAgLy8g5omT5Y2w5pel5b+XXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLliqDovb3lpLHotKXvvIzph43or5XnrKxcIiArIHJldHJ5VGltZXMgKyBcIuasoTogXCIgKyBncm91cE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgLy8g5rKh5Yiw5pyA5aSn6YeN6K+V5qyh5pWw77yM5bCG5Li6dXJs5re75Yqg5LiA5Liq6ZqP5py65pe26Ze05oiz6YeN5paw5Yqg5Zue5Yqg6L296Zif5YiXXHJcbiAgICAgICAgICAgICAgICBSRVMubG9hZEdyb3VwKGV2dC5ncm91cE5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8g5omT5Y2w5pel5b+XXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCLliqDovb3lpLHotKUz5qyh77yM5q2j5Zyo5bCd6K+V5YiH5o2iQ0ROLi4uXCIpO1xyXG4gICAgICAgICAgICAgICAgLy8g5bCd6K+V5YiH5o2iQ0ROXHJcbiAgICAgICAgICAgICAgICB2YXIgYWxsRG9uZSA9IGVudmlyb25tZW50Lm5leHRDRE4oKTtcclxuICAgICAgICAgICAgICAgIGlmICghYWxsRG9uZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOmHjeaWsOWKoOi9vVxyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5sb2FkR3JvdXAoZXZ0Lmdyb3VwTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyDnp7vpmaTkuovku7bnm5HlkKxcclxuICAgICAgICAgICAgICAgICAgICBSRVMucmVtb3ZlRXZlbnRMaXN0ZW5lcihSRVMuUmVzb3VyY2VFdmVudC5HUk9VUF9QUk9HUkVTUywgb25Qcm9ncmVzcywgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgUkVTLnJlbW92ZUV2ZW50TGlzdGVuZXIoUkVTLlJlc291cmNlRXZlbnQuR1JPVVBfQ09NUExFVEUsIG9uT25lQ29tcGxldGUsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIFJFUy5yZW1vdmVFdmVudExpc3RlbmVyKFJFUy5SZXNvdXJjZUV2ZW50LkdST1VQX0xPQURfRVJST1IsIG9uT25lRXJyb3IsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOiwg+eUqOaooeadv+aWueazlVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXIub25lRXJyb3IgJiYgdGhpcy5faGFuZGxlci5vbmVFcnJvcihldnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIOWIh+aNokNETuWksei0peS6hu+8jOW8ueWHuuaPkOekuu+8jOS9v+eUqOaIt+WPr+S7peaJi+WKqOWIt+aWsOmhtemdolxyXG4gICAgICAgICAgICAgICAgICAgIHBhbmVsTWFuYWdlci5jb25maXJtKFwi6LWE5rqQ57uE5Yqg6L295aSx6LSlW1wiICsgZ3JvdXBOYW1lICsgXCJd77yM54K55Ye756Gu5a6a5Yi35paw6aG16Z2iXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhdGZvcm1NYW5hZ2VyLnJlbG9hZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBBc3NldHNMb2FkZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IEFzc2V0c0xvYWRlcjtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXItZWdyZXQvZWdyZXQvQXNzZXRzTG9hZGVyLmpzXG4vLyBtb2R1bGUgaWQgPSA4NlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBjb3JlIH0gZnJvbSBcIi4uLy4uL2NvcmUvQ29yZVwiO1xyXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSBcIi4uLy4uL2NvcmUvaW5qZWN0b3IvSW5qZWN0b3JcIjtcclxuaW1wb3J0IFdlYlBsYXRmb3JtIGZyb20gXCIuL1dlYlBsYXRmb3JtXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMVxyXG4gKlxyXG4gKiDlubPlj7DmjqXlj6PnrqHnkIblmajvvIzpgJrov4fmoaXmjqXmqKHlvI/nu5/kuIDkuI3lkIzlubPlj7DnmoTkuI3lkIzmjqXlj6PvvIzku47ogIzlrp7njrDlr7nmoYbmnrblhbbku5bmqKHlnZfpgI/mmI7ljJZcclxuKi9cclxudmFyIFBsYXRmb3JtTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFBsYXRmb3JtTWFuYWdlcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlubPlj7DmjqXlj6Plrp7njrDlr7nosaHvvIzpu5jorqTmmK/mma7pgJrnvZHpobXlubPlj7DvvIzkuZ/lj6/ku6XmoLnmja7pnIDopoHlrprliLZcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtJUGxhdGZvcm19XHJcbiAgICAgICAgICogQG1lbWJlcm9mIFBsYXRmb3JtTWFuYWdlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBuZXcgV2ViUGxhdGZvcm0oKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5Yi35paw5b2T5YmN6aG16Z2iXHJcbiAgICAgKlxyXG4gICAgICogQG1lbWJlcm9mIFBsYXRmb3JtTWFuYWdlclxyXG4gICAgICovXHJcbiAgICBQbGF0Zm9ybU1hbmFnZXIucHJvdG90eXBlLnJlbG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtLnJlbG9hZCgpO1xyXG4gICAgfTtcclxuICAgIFBsYXRmb3JtTWFuYWdlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbXHJcbiAgICAgICAgSW5qZWN0YWJsZVxyXG4gICAgXSwgUGxhdGZvcm1NYW5hZ2VyKTtcclxuICAgIHJldHVybiBQbGF0Zm9ybU1hbmFnZXI7XHJcbn0oKSk7XHJcbmV4cG9ydCBkZWZhdWx0IFBsYXRmb3JtTWFuYWdlcjtcclxuLyoqIOWGjemineWkluWvvOWHuuS4gOS4quWNleS+iyAqL1xyXG5leHBvcnQgdmFyIHBsYXRmb3JtTWFuYWdlciA9IGNvcmUuZ2V0SW5qZWN0KFBsYXRmb3JtTWFuYWdlcik7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yL2VuZ2luZS9wbGF0Zm9ybS9QbGF0Zm9ybU1hbmFnZXIuanNcbi8vIG1vZHVsZSBpZCA9IDg3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMVxyXG4gKlxyXG4gKiDnvZHpobXlubPlj7DmjqXlj6Plrp7njrDnsbvvvIzkuZ/mmK/lubPlj7DmjqXlj6PnmoTpu5jorqTnsbtcclxuKi9cclxudmFyIFdlYlBsYXRmb3JtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gV2ViUGxhdGZvcm0oKSB7XHJcbiAgICB9XHJcbiAgICBXZWJQbGF0Zm9ybS5wcm90b3R5cGUucmVsb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFdlYlBsYXRmb3JtO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBXZWJQbGF0Zm9ybTtcclxuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi90ZXN0L25vZGVfbW9kdWxlcy9vbHltcHVzLXIvZW5naW5lL3BsYXRmb3JtL1dlYlBsYXRmb3JtLmpzXG4vLyBtb2R1bGUgaWQgPSA4OFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJpbXBvcnQgeyB0d2VlbkZyb20sIHR3ZWVuVG8gfSBmcm9tIFwiLi4vdXRpbHMvVHdlZW5VdGlsXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMlxyXG4gKlxyXG4gKiDlm57lvLnmlYjmnpxcclxuKi9cclxudmFyIEJhY2tQYW5lbFBvbGljeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEJhY2tQYW5lbFBvbGljeSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICog5pi+56S65pe26LCD55SoXHJcbiAgICAgKiBAcGFyYW0gcGFuZWwg5by55Ye65qGG5a+56LGhXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg5a6M5oiQ5Zue6LCD77yM5b+F6aG76LCD55SoXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliqjnlLvotbflp4vngrlcclxuICAgICAqL1xyXG4gICAgQmFja1BhbmVsUG9saWN5LnByb3RvdHlwZS5wb3AgPSBmdW5jdGlvbiAocGFuZWwsIGNhbGxiYWNrLCBmcm9tKSB7XHJcbiAgICAgICAgLy8g5byA5aeL5Yqo55S75by55Ye6XHJcbiAgICAgICAgdmFyIGVudGl0eSA9IHBhbmVsLnNraW47XHJcbiAgICAgICAgZWdyZXQuVHdlZW4ucmVtb3ZlVHdlZW5zKGVudGl0eSk7XHJcbiAgICAgICAgLy8g5oGi5aSN5L2T56evXHJcbiAgICAgICAgZW50aXR5LnNjYWxlWCA9IDE7XHJcbiAgICAgICAgZW50aXR5LnNjYWxlWSA9IDE7XHJcbiAgICAgICAgdmFyIGZyb21YID0gMDtcclxuICAgICAgICB2YXIgZnJvbVkgPSAwO1xyXG4gICAgICAgIGlmIChmcm9tICE9IG51bGwpIHtcclxuICAgICAgICAgICAgZnJvbVggPSBmcm9tLng7XHJcbiAgICAgICAgICAgIGZyb21ZID0gZnJvbS55O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZnJvbVggPSBlbnRpdHkuc3RhZ2Uuc3RhZ2VXaWR0aCAqIDAuNTtcclxuICAgICAgICAgICAgZnJvbVkgPSBlbnRpdHkuc3RhZ2Uuc3RhZ2VIZWlnaHQgKiAwLjU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIOabtOaWsOW8ueWHuuWQjuS9jee9rlxyXG4gICAgICAgIGVudGl0eS54ID0gZnJvbVggLSBlbnRpdHkud2lkdGggKiAwLjU7XHJcbiAgICAgICAgZW50aXR5LnkgPSBmcm9tWSAtIGVudGl0eS5oZWlnaHQgKiAwLjU7XHJcbiAgICAgICAgLy8g5byA5aeL57yT5YqoXHJcbiAgICAgICAgdHdlZW5Gcm9tKGVudGl0eSwge1xyXG4gICAgICAgICAgICB4OiBmcm9tWCxcclxuICAgICAgICAgICAgeTogZnJvbVksXHJcbiAgICAgICAgICAgIHNjYWxlWDogMCxcclxuICAgICAgICAgICAgc2NhbGVZOiAwXHJcbiAgICAgICAgfSwgMzAwLCBlZ3JldC5FYXNlLmJhY2tPdXQpLmNhbGwoY2FsbGJhY2spO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YWz6Zet5pe26LCD55SoXHJcbiAgICAgKiBAcGFyYW0gcG9wdXAg5by55Ye65qGG5a+56LGhXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg5a6M5oiQ5Zue6LCD77yM5b+F6aG76LCD55SoXHJcbiAgICAgKiBAcGFyYW0gdG8g5Yqo55S75a6M57uT54K5XHJcbiAgICAgKi9cclxuICAgIEJhY2tQYW5lbFBvbGljeS5wcm90b3R5cGUuZHJvcCA9IGZ1bmN0aW9uIChwYW5lbCwgY2FsbGJhY2ssIHRvKSB7XHJcbiAgICAgICAgLy8g5byA5aeL5Yqo55S75YWz6ZetXHJcbiAgICAgICAgdmFyIGVudGl0eSA9IHBhbmVsLnNraW47XHJcbiAgICAgICAgZWdyZXQuVHdlZW4ucmVtb3ZlVHdlZW5zKGVudGl0eSk7XHJcbiAgICAgICAgdmFyIHRvWCA9IDA7XHJcbiAgICAgICAgdmFyIHRvWSA9IDA7XHJcbiAgICAgICAgaWYgKHRvICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdG9YID0gdG8ueDtcclxuICAgICAgICAgICAgdG9ZID0gdG8ueTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRvWCA9IGVudGl0eS54ICsgZW50aXR5LndpZHRoICogMC41O1xyXG4gICAgICAgICAgICB0b1kgPSBlbnRpdHkueSArIGVudGl0eS5oZWlnaHQgKiAwLjU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHR3ZWVuVG8oZW50aXR5LCB7XHJcbiAgICAgICAgICAgIHg6IHRvWCxcclxuICAgICAgICAgICAgeTogdG9ZLFxyXG4gICAgICAgICAgICBzY2FsZVg6IDAsXHJcbiAgICAgICAgICAgIHNjYWxlWTogMFxyXG4gICAgICAgIH0sIDMwMCwgZWdyZXQuRWFzZS5iYWNrSW4pLmNhbGwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAvLyDmgaLlpI3kvZPnp69cclxuICAgICAgICAgICAgZW50aXR5LnNjYWxlWCA9IDE7XHJcbiAgICAgICAgICAgIGVudGl0eS5zY2FsZVkgPSAxO1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2sgIT0gbnVsbClcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJhY2tQYW5lbFBvbGljeTtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgQmFja1BhbmVsUG9saWN5O1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC9wYW5lbC9CYWNrUGFuZWxQb2xpY3kuanNcbi8vIG1vZHVsZSBpZCA9IDg5XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMlxyXG4gKlxyXG4gKiBFZ3JldOe8k+WKqOW3peWFt+mbhu+8jOeUqOadpeW8peihpUVncmV055qEVHdlZW7nmoTkuI3otrNcclxuKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHR3ZWVuVG8odGFyZ2V0LCBwcm9wcywgZHVyYXRpb24sIGVhc2UpIHtcclxuICAgIHJldHVybiBlZ3JldC5Ud2Vlbi5nZXQodGFyZ2V0KS50byhwcm9wcywgZHVyYXRpb24sIGVhc2UpO1xyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiB0d2VlbkZyb20odGFyZ2V0LCBwcm9wcywgZHVyYXRpb24sIGVhc2UpIHtcclxuICAgIC8vIOWvueaNouWPguaVsOeKtuaAgVxyXG4gICAgdmFyIHRvUHJvcHMgPSB7fTtcclxuICAgIGZvciAodmFyIGtleSBpbiBwcm9wcykge1xyXG4gICAgICAgIHRvUHJvcHNba2V5XSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgIHRhcmdldFtrZXldID0gcHJvcHNba2V5XTtcclxuICAgIH1cclxuICAgIC8vIOW8gOWni+e8k+WKqFxyXG4gICAgcmV0dXJuIGVncmV0LlR3ZWVuLmdldCh0YXJnZXQpLnRvKHRvUHJvcHMsIGR1cmF0aW9uLCBlYXNlKTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9Ud2VlblV0aWwuanNcbi8vIG1vZHVsZSBpZCA9IDkwXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0wOS0yMlxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0wOS0yMlxyXG4gKlxyXG4gKiDmt6HlhaXmt6Hlh7rlnLrmma/liIfmjaLnrZbnlaVcclxuKi9cclxudmFyIEZhZGVTY2VuZVBvbGljeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEZhZGVTY2VuZVBvbGljeSgpIHtcclxuICAgICAgICB0aGlzLl90ZW1wU25hcHNob3QgPSBuZXcgZWdyZXQuQml0bWFwKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOWHhuWkh+WIh+aNouWcuuaZr+aXtuiwg+W6plxyXG4gICAgICogQHBhcmFtIGZyb20g5YiH5Ye655qE5Zy65pmvXHJcbiAgICAgKiBAcGFyYW0gdG8g5YiH5YWl55qE5Zy65pmvXHJcbiAgICAgKi9cclxuICAgIEZhZGVTY2VuZVBvbGljeS5wcm90b3R5cGUucHJlcGFyZVN3aXRjaCA9IGZ1bmN0aW9uIChmcm9tLCB0bykge1xyXG4gICAgICAgIGlmIChmcm9tICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdmFyIHJvb3QgPSBmcm9tLmJyaWRnZS5yb290O1xyXG4gICAgICAgICAgICAvLyDmiKrlj5blvZPliY3lsY/luZVcclxuICAgICAgICAgICAgdmFyIHRleHR1cmUgPSBuZXcgZWdyZXQuUmVuZGVyVGV4dHVyZSgpO1xyXG4gICAgICAgICAgICB0ZXh0dXJlLmRyYXdUb1RleHR1cmUocm9vdCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3RlbXBTbmFwc2hvdC50ZXh0dXJlID0gdGV4dHVyZTtcclxuICAgICAgICAgICAgdGhpcy5fdGVtcFNuYXBzaG90LmFscGhhID0gMTtcclxuICAgICAgICAgICAgcm9vdC5hZGRDaGlsZCh0aGlzLl90ZW1wU25hcHNob3QpO1xyXG4gICAgICAgICAgICAvLyDnp7vpmaRmcm9tXHJcbiAgICAgICAgICAgIHZhciBmcm9tRGlzcGxheSA9IGZyb20uc2tpbjtcclxuICAgICAgICAgICAgaWYgKGZyb21EaXNwbGF5LnBhcmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBmcm9tRGlzcGxheS5wYXJlbnQucmVtb3ZlQ2hpbGQoZnJvbURpc3BsYXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog5YiH5o2i5Zy65pmv5pe26LCD5bqmXHJcbiAgICAgKiBAcGFyYW0gZnJvbSDliIflh7rnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSB0byDliIflhaXnmoTlnLrmma9cclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayDliIfmjaLlrozmr5XnmoTlm57osIPmlrnms5VcclxuICAgICAqL1xyXG4gICAgRmFkZVNjZW5lUG9saWN5LnByb3RvdHlwZS5zd2l0Y2ggPSBmdW5jdGlvbiAoZnJvbSwgdG8sIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgaWYgKGZyb20gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAvLyDlvIDlp4vmt6Hlh7pcclxuICAgICAgICAgICAgZWdyZXQuVHdlZW4ucmVtb3ZlVHdlZW5zKHRoaXMuX3RlbXBTbmFwc2hvdCk7XHJcbiAgICAgICAgICAgIGVncmV0LlR3ZWVuLmdldCh0aGlzLl90ZW1wU25hcHNob3QpLnRvKHtcclxuICAgICAgICAgICAgICAgIGFscGhhOiAwXHJcbiAgICAgICAgICAgIH0sIDMwMCkuY2FsbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAvLyDnp7vpmaTmiKrlsY9cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90ZW1wU25hcHNob3QucGFyZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90ZW1wU25hcHNob3QucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuX3RlbXBTbmFwc2hvdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyDlm57mlLbotYTmupBcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl90ZW1wU25hcHNob3QudGV4dHVyZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVtcFNuYXBzaG90LnRleHR1cmUuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RlbXBTbmFwc2hvdC50ZXh0dXJlID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfSwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyDnp7vpmaTmiKrlsY9cclxuICAgICAgICAgICAgaWYgKHRoaXMuX3RlbXBTbmFwc2hvdC5wYXJlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGVtcFNuYXBzaG90LnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl90ZW1wU25hcHNob3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIOiwg+eUqOWbnuiwg1xyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gRmFkZVNjZW5lUG9saWN5O1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBGYWRlU2NlbmVQb2xpY3k7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3NjZW5lL0ZhZGVTY2VuZVBvbGljeS5qc1xuLy8gbW9kdWxlIGlkID0gOTFcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IHsgYnJpZGdlTWFuYWdlciB9IGZyb20gXCJvbHltcHVzLXIvZW5naW5lL2JyaWRnZS9CcmlkZ2VNYW5hZ2VyXCI7XHJcbmltcG9ydCBEaWN0aW9uYXJ5IGZyb20gXCJvbHltcHVzLXIvdXRpbHMvRGljdGlvbmFyeVwiO1xyXG5pbXBvcnQgRWdyZXRCcmlkZ2UgZnJvbSBcIi4uLy4uL0VncmV0QnJpZGdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0yNVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0yNVxyXG4gKlxyXG4gKiBFZ3JldOmBrue9qeWunueOsFxyXG4qL1xyXG52YXIgTWFza0VudGl0eUltcGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBNYXNrRW50aXR5SW1wbChwYXJhbXMpIHtcclxuICAgICAgICB0aGlzLl9tYXNrQWxwaGEgPSAwLjU7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ0FscGhhID0gMC41O1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxBbHBoYSA9IDAuNTtcclxuICAgICAgICB0aGlzLl9zaG93aW5nTWFzayA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKHBhcmFtcyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21hc2tBbHBoYSA9IChwYXJhbXMubWFza0FscGhhICE9IG51bGwgPyBwYXJhbXMubWFza0FscGhhIDogMC41KTtcclxuICAgICAgICAgICAgdGhpcy5fbG9hZGluZ0FscGhhID0gKHBhcmFtcy5sb2FkaW5nQWxwaGEgIT0gbnVsbCA/IHBhcmFtcy5sb2FkaW5nQWxwaGEgOiAwLjUpO1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsQWxwaGEgPSAocGFyYW1zLm1vZGFsUGFuZWxBbHBoYSAhPSBudWxsID8gcGFyYW1zLm1vZGFsUGFuZWxBbHBoYSA6IDAuNSk7XHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdTa2luRmFjdG9yeSA9IHBhcmFtcy5sb2FkaW5nU2tpbkZhY3Rvcnk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubWFza0RhdGEgPSBwYXJhbXMgfHwge307XHJcbiAgICAgICAgdGhpcy5fbWFzayA9IG5ldyBlZ3JldC5TaGFwZSgpO1xyXG4gICAgICAgIHRoaXMuX21hc2sudG91Y2hFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzayA9IG5ldyBlZ3JldC5TaGFwZSgpO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnRvdWNoRW5hYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbERpY3QgPSBuZXcgRGljdGlvbmFyeSgpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxMaXN0ID0gW107XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2sgPSBuZXcgZWdyZXQuU2hhcGUoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay50b3VjaEVuYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZSwgXCJsb2FkaW5nU2tpblwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIC8vIOWIneWni+WMluearuiCpFxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2xvYWRpbmdTa2luICYmIHRoaXMuX2xvYWRpbmdTa2luRmFjdG9yeSlcclxuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdTa2luID0gdGhpcy5fbG9hZGluZ1NraW5GYWN0b3J5KCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkaW5nU2tpbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIC8qKlxyXG4gICAgICog5pi+56S66YGu572pXHJcbiAgICAgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5zaG93TWFzayA9IGZ1bmN0aW9uIChhbHBoYSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zaG93aW5nTWFzaylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdNYXNrID0gdHJ1ZTtcclxuICAgICAgICAvLyDmmL7npLpcclxuICAgICAgICB2YXIgYnJpZGdlID0gYnJpZGdlTWFuYWdlci5nZXRCcmlkZ2UoRWdyZXRCcmlkZ2UuVFlQRSk7XHJcbiAgICAgICAgLy8g57uY5Yi26YGu572pXHJcbiAgICAgICAgaWYgKGFscGhhID09IG51bGwpXHJcbiAgICAgICAgICAgIGFscGhhID0gdGhpcy5fbWFza0FscGhhO1xyXG4gICAgICAgIHRoaXMuX21hc2suZ3JhcGhpY3MuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLl9tYXNrLmdyYXBoaWNzLmJlZ2luRmlsbCgwLCBhbHBoYSk7XHJcbiAgICAgICAgdGhpcy5fbWFzay5ncmFwaGljcy5kcmF3UmVjdCgwLCAwLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZVdpZHRoLCBicmlkZ2Uucm9vdC5zdGFnZS5zdGFnZUhlaWdodCk7XHJcbiAgICAgICAgdGhpcy5fbWFzay5ncmFwaGljcy5lbmRGaWxsKCk7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgYnJpZGdlLm1hc2tMYXllci5hZGRDaGlsZCh0aGlzLl9tYXNrKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIOmakOiXj+mBrue9qVxyXG4gICAgICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaGlkZU1hc2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zaG93aW5nTWFzaylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Nob3dpbmdNYXNrID0gZmFsc2U7XHJcbiAgICAgICAgLy8g6ZqQ6JePXHJcbiAgICAgICAgaWYgKHRoaXMuX21hc2sucGFyZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMuX21hc2sucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMuX21hc2spO1xyXG4gICAgfTtcclxuICAgIC8qKuW9k+WJjeaYr+WQpuWcqOaYvuekuumBrue9qSovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTWFzayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hvd2luZ01hc2s7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiDmmL7npLrliqDovb3lm75cclxuICAgICAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLnNob3dMb2FkaW5nID0gZnVuY3Rpb24gKGFscGhhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Nob3dpbmdMb2FkaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgIC8vIOaYvuekulxyXG4gICAgICAgIHZhciBicmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZShFZ3JldEJyaWRnZS5UWVBFKTtcclxuICAgICAgICAvLyDnu5jliLbpga7nvalcclxuICAgICAgICBpZiAoYWxwaGEgPT0gbnVsbClcclxuICAgICAgICAgICAgYWxwaGEgPSB0aGlzLl9sb2FkaW5nQWxwaGE7XHJcbiAgICAgICAgdGhpcy5fbG9hZGluZ01hc2suZ3JhcGhpY3MuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5ncmFwaGljcy5iZWdpbkZpbGwoMCwgYWxwaGEpO1xyXG4gICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLmdyYXBoaWNzLmRyYXdSZWN0KDAsIDAsIGJyaWRnZS5yb290LnN0YWdlLnN0YWdlV2lkdGgsIGJyaWRnZS5yb290LnN0YWdlLnN0YWdlSGVpZ2h0KTtcclxuICAgICAgICB0aGlzLl9sb2FkaW5nTWFzay5ncmFwaGljcy5lbmRGaWxsKCk7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgYnJpZGdlLm1hc2tMYXllci5hZGRDaGlsZCh0aGlzLl9sb2FkaW5nTWFzayk7XHJcbiAgICAgICAgLy8g5re75YqgbG9hZGluZ+earuiCpFxyXG4gICAgICAgIGlmICh0aGlzLmxvYWRpbmdTa2luKVxyXG4gICAgICAgICAgICBicmlkZ2UubWFza0xheWVyLmFkZENoaWxkKHRoaXMubG9hZGluZ1NraW4pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICog6ZqQ6JeP5Yqg6L295Zu+XHJcbiAgICAgKi9cclxuICAgIE1hc2tFbnRpdHlJbXBsLnByb3RvdHlwZS5oaWRlTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3Nob3dpbmdMb2FkaW5nKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgdGhpcy5fc2hvd2luZ0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAvLyDpmpDol49cclxuICAgICAgICBpZiAodGhpcy5fbG9hZGluZ01hc2sucGFyZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdNYXNrLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9sb2FkaW5nTWFzayk7XHJcbiAgICAgICAgaWYgKHRoaXMubG9hZGluZ1NraW4gIT0gbnVsbCAmJiB0aGlzLmxvYWRpbmdTa2luLnBhcmVudCAhPSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLmxvYWRpbmdTa2luLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9sb2FkaW5nU2tpbik7XHJcbiAgICB9O1xyXG4gICAgLyoq5b2T5YmN5piv5ZCm5Zyo5pi+56S6bG9hZGluZyovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTG9hZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hvd2luZ0xvYWRpbmc7XHJcbiAgICB9O1xyXG4gICAgLyoqIOaYvuekuuaooeaAgeeql+WPo+mBrue9qSAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLnNob3dNb2RhbE1hc2sgPSBmdW5jdGlvbiAocGFuZWwsIGFscGhhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNTaG93aW5nTW9kYWxNYXNrKHBhbmVsKSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxEaWN0LnNldChwYW5lbCwgcGFuZWwpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxMaXN0LnB1c2gocGFuZWwpO1xyXG4gICAgICAgIC8vIOaYvuekulxyXG4gICAgICAgIHZhciBicmlkZ2UgPSBicmlkZ2VNYW5hZ2VyLmdldEJyaWRnZShFZ3JldEJyaWRnZS5UWVBFKTtcclxuICAgICAgICAvLyDnu5jliLbpga7nvalcclxuICAgICAgICBpZiAoYWxwaGEgPT0gbnVsbClcclxuICAgICAgICAgICAgYWxwaGEgPSB0aGlzLl9tb2RhbFBhbmVsQWxwaGE7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbE1hc2suZ3JhcGhpY3MuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5ncmFwaGljcy5iZWdpbkZpbGwoMCwgYWxwaGEpO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLmdyYXBoaWNzLmRyYXdSZWN0KDAsIDAsIGJyaWRnZS5yb290LnN0YWdlLnN0YWdlV2lkdGgsIGJyaWRnZS5yb290LnN0YWdlLnN0YWdlSGVpZ2h0KTtcclxuICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5ncmFwaGljcy5lbmRGaWxsKCk7XHJcbiAgICAgICAgLy8g5re75Yqg5pi+56S6XHJcbiAgICAgICAgdmFyIGVudGl0eSA9IHBhbmVsLnNraW47XHJcbiAgICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnQ7XHJcbiAgICAgICAgaWYgKHBhcmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbFBhbmVsTWFzayk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGluZGV4ID0gcGFyZW50LmdldENoaWxkSW5kZXgoZW50aXR5KTtcclxuICAgICAgICAgICAgcGFyZW50LmFkZENoaWxkQXQodGhpcy5fbW9kYWxQYW5lbE1hc2ssIGluZGV4KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqIOmakOiXj+aooeaAgeeql+WPo+mBrue9qSAqL1xyXG4gICAgTWFza0VudGl0eUltcGwucHJvdG90eXBlLmhpZGVNb2RhbE1hc2sgPSBmdW5jdGlvbiAocGFuZWwpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNTaG93aW5nTW9kYWxNYXNrKHBhbmVsKSlcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX21vZGFsUGFuZWxEaWN0LmRlbGV0ZShwYW5lbCk7XHJcbiAgICAgICAgdGhpcy5fbW9kYWxQYW5lbExpc3Quc3BsaWNlKHRoaXMuX21vZGFsUGFuZWxMaXN0LmluZGV4T2YocGFuZWwpLCAxKTtcclxuICAgICAgICAvLyDliKTmlq3mmK/lkKbov5jpnIDopoFNYXNrXHJcbiAgICAgICAgaWYgKHRoaXMuX21vZGFsUGFuZWxMaXN0Lmxlbmd0aCA8PSAwKSB7XHJcbiAgICAgICAgICAgIC8vIOmakOiXj1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fbW9kYWxQYW5lbE1hc2sucGFyZW50ICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb2RhbFBhbmVsTWFzay5wYXJlbnQucmVtb3ZlQ2hpbGQodGhpcy5fbW9kYWxQYW5lbE1hc2spO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8g56e75YqoTWFza1xyXG4gICAgICAgICAgICB2YXIgZW50aXR5ID0gdGhpcy5fbW9kYWxQYW5lbExpc3RbdGhpcy5fbW9kYWxQYW5lbExpc3QubGVuZ3RoIC0gMV0uc2tpbjtcclxuICAgICAgICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnQ7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21vZGFsUGFuZWxNYXNrLnBhcmVudC5yZW1vdmVDaGlsZCh0aGlzLl9tb2RhbFBhbmVsTWFzayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBwYXJlbnQuZ2V0Q2hpbGRJbmRleChlbnRpdHkpO1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LmFkZENoaWxkQXQodGhpcy5fbW9kYWxQYW5lbE1hc2ssIGluZGV4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKiog5b2T5YmN5piv5ZCm5Zyo5pi+56S65qih5oCB56qX5Y+j6YGu572pICovXHJcbiAgICBNYXNrRW50aXR5SW1wbC5wcm90b3R5cGUuaXNTaG93aW5nTW9kYWxNYXNrID0gZnVuY3Rpb24gKHBhbmVsKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLl9tb2RhbFBhbmVsRGljdC5nZXQocGFuZWwpICE9IG51bGwpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNYXNrRW50aXR5SW1wbDtcclxufSgpKTtcclxuZXhwb3J0IGRlZmF1bHQgTWFza0VudGl0eUltcGw7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L21hc2svTWFza0VudGl0eS5qc1xuLy8gbW9kdWxlIGlkID0gOTJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiLyoqXHJcbiAqIEBhdXRob3IgUmF5a2lkXHJcbiAqIEBlbWFpbCBpbml0aWFsX3JAcXEuY29tXHJcbiAqIEBjcmVhdGUgZGF0ZSAyMDE3LTEwLTE3XHJcbiAqIEBtb2RpZnkgZGF0ZSAyMDE3LTEwLTE3XHJcbiAqXHJcbiAqIFVJ5bel5YW36ZuGXHJcbiovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbi8qKlxyXG4gKiDljIXoo4VFVUnnmoREYXRhR3JvdXDnu4Tku7bvvIzkvb/nlKjkvKDlhaXnmoTlpITnkIblh73mlbDlpITnkIbmr4/kuKrmuLLmn5Plmajmm7TmlrDnmoTpgLvovpFcclxuICpcclxuICogQGV4cG9ydFxyXG4gKiBAcGFyYW0ge2V1aS5EYXRhR3JvdXB9IGdyb3VwIOiiq+WMheijheeahERhdGFHcm91cOe7hOS7tlxyXG4gKiBAcGFyYW0geyhkYXRhPzphbnksIHJlbmRlcmVyPzphbnkpPT52b2lkfSByZW5kZXJlckhhbmRsZXIg5riy5p+T5Zmo5aSE55CG5Ye95pWw77yM5q+P5qyh5pWw5o2u5pu05paw5pe25Lya6KKr6LCD55So77yM5aSE55CG5Y2V5Liq5riy5p+T5Zmo55qE5riy5p+T6YC76L6RXHJcbiAqIEBwYXJhbSB7KGRhdGFzPzpldWkuSUNvbGxlY3Rpb24sIGdyb3VwPzpldWkuRGF0YUdyb3VwKT0+dm9pZH0gW3VwZGF0ZUhhbmRsZXJdIOaVsOaNruabtOaWsOWkhOeQhuWHveaVsO+8jOavj+asoeaYvuekuuabtOaWsOaXtuS8muiiq+iwg+eUqO+8jOWkhOeQhuWIl+ihqOaYvuekuuabtOaWsOWQjueahOa4suafk+mAu+i+kVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHdyYXBFVUlMaXN0KGdyb3VwLCByZW5kZXJlckhhbmRsZXIsIHVwZGF0ZUhhbmRsZXIpIHtcclxuICAgIGdyb3VwLml0ZW1SZW5kZXJlciA9IEl0ZW1SZW5kZXJlci5iaW5kKG51bGwsIGdyb3VwLml0ZW1SZW5kZXJlclNraW5OYW1lLCByZW5kZXJlckhhbmRsZXIpO1xyXG4gICAgaWYgKHVwZGF0ZUhhbmRsZXIpIHtcclxuICAgICAgICAvLyDnm5HlkKxncm91cOWwuuWvuOaYr+WQpuaUueWPmFxyXG4gICAgICAgIHZhciBlbnRlckZyYW1lSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKGdyb3VwLmNvbnRlbnRXaWR0aCA+IDAgfHwgZ3JvdXAuY29udGVudEhlaWdodCA+IDApIHtcclxuICAgICAgICAgICAgICAgIC8vIOenu+mZpOS6i+S7tuebkeWQrFxyXG4gICAgICAgICAgICAgICAgZ3JvdXAucmVtb3ZlRXZlbnRMaXN0ZW5lcihlZ3JldC5FdmVudC5FTlRFUl9GUkFNRSwgZW50ZXJGcmFtZUhhbmRsZXIsIHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgLy8g6LCD55So5Zue6LCDXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVIYW5kbGVyKGdyb3VwLmRhdGFQcm92aWRlciwgZ3JvdXApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBncm91cC5hZGRFdmVudExpc3RlbmVyKGVncmV0LkV2ZW50LkVOVEVSX0ZSQU1FLCBlbnRlckZyYW1lSGFuZGxlciwgdGhpcyk7XHJcbiAgICB9XHJcbn1cclxudmFyIEl0ZW1SZW5kZXJlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEl0ZW1SZW5kZXJlciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEl0ZW1SZW5kZXJlcihza2luTmFtZSwgcmVuZGVyZXJIYW5kbGVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5za2luTmFtZSA9IHNraW5OYW1lO1xyXG4gICAgICAgIF90aGlzLl9yZW5kZXJlckhhbmRsZXIgPSByZW5kZXJlckhhbmRsZXI7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgSXRlbVJlbmRlcmVyLnByb3RvdHlwZS5kYXRhQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRhdGFDaGFuZ2VkLmNhbGwodGhpcyk7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXJIYW5kbGVyKHRoaXMuZGF0YSwgdGhpcyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEl0ZW1SZW5kZXJlcjtcclxufShldWkuSXRlbVJlbmRlcmVyKSk7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L3V0aWxzL1VJVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gOTNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IENvbW1hbmQgZnJvbSBcIm9seW1wdXMtci9jb3JlL2NvbW1hbmQvQ29tbWFuZFwiO1xyXG5pbXBvcnQgRWdyZXRCcmlkZ2UgZnJvbSBcIi4uLy4uL0VncmV0QnJpZGdlXCI7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxOC0wMi0wNVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxOC0wMi0wNVxyXG4gKlxyXG4gKiDov5nkuKrlkb3ku6TmmK/kuLrkuobkv67lpI1lZ3JldOWcqGRpc3BsYXk9PW5vbmXml7bojrflj5boh6rouqvlsLrlr7jmmK/nqbrlsLrlr7jnmoRidWdcclxuKi9cclxudmFyIFVwZGF0ZVNjcmVlblNpemVDb21tYW5kID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgdHNsaWJfMS5fX2V4dGVuZHMoVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZCgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBVcGRhdGVTY3JlZW5TaXplQ29tbWFuZC5wcm90b3R5cGUuZXhlYyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgcGFyYW1zID0gdGhpcy5tc2cucGFyYW1zO1xyXG4gICAgICAgIHZhciB0byA9IHBhcmFtc1swXTtcclxuICAgICAgICB2YXIgZnJvbSA9IHBhcmFtc1sxXTtcclxuICAgICAgICBpZiAodG8gJiYgdG8uYnJpZGdlLnR5cGUgPT09IEVncmV0QnJpZGdlLlRZUEUgJiYgZnJvbSAmJiBmcm9tLmJyaWRnZS50eXBlICE9PSBFZ3JldEJyaWRnZS5UWVBFKSB7XHJcbiAgICAgICAgICAgIC8vIOaYr+S7juWFtuS7luexu+Wei+WcuuaZr+i3s+i9rOWbnuadpeeahO+8jOS4uuS6humYsuatouWcqOWFtuS7luWcuuaZr+inpuWPkei/h3Jlc2l6ZeWvvOiHtGVncmV05bC65a+45aSx5pWI77yM5pu05paw5LiA5qyh5bGP5bmV5bC65a+4XHJcbiAgICAgICAgICAgIGVncmV0LnVwZGF0ZUFsbFNjcmVlbnMoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFVwZGF0ZVNjcmVlblNpemVDb21tYW5kO1xyXG59KENvbW1hbmQpKTtcclxuZXhwb3J0IGRlZmF1bHQgVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQ7XHJcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vdGVzdC9ub2RlX21vZHVsZXMvb2x5bXB1cy1yLWVncmV0L2VncmV0L2NvbW1hbmQvVXBkYXRlU2NyZWVuU2l6ZUNvbW1hbmQuanNcbi8vIG1vZHVsZSBpZCA9IDk0XG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IGNvcmUgfSBmcm9tIFwiLi4vQ29yZVwiO1xyXG4vKipcclxuICogQGF1dGhvciBSYXlraWRcclxuICogQGVtYWlsIGluaXRpYWxfckBxcS5jb21cclxuICogQGNyZWF0ZSBkYXRlIDIwMTctMDktMDFcclxuICogQG1vZGlmeSBkYXRlIDIwMTctMDktMDFcclxuICpcclxuICog5YaF5qC45ZG95Luk57G777yM5YaF5qC45ZG95Luk5Zyo5rOo5YaM5LqG5raI5oGv5ZCO5Y+v5Lul5Zyo5raI5oGv5rS+5Y+R5pe26KKr5omn6KGMXHJcbiovXHJcbnZhciBDb21tYW5kID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29tbWFuZChtc2cpIHtcclxuICAgICAgICB0aGlzLm1zZyA9IG1zZztcclxuICAgIH1cclxuICAgIENvbW1hbmQucHJvdG90eXBlLmRpc3BhdGNoID0gZnVuY3Rpb24gKHR5cGVPck1zZykge1xyXG4gICAgICAgIHZhciBwYXJhbXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgICAgICBwYXJhbXNbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvcmUuZGlzcGF0Y2guYXBwbHkoY29yZSwgW3R5cGVPck1zZ10uY29uY2F0KHBhcmFtcykpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDb21tYW5kO1xyXG59KCkpO1xyXG5leHBvcnQgZGVmYXVsdCBDb21tYW5kO1xyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci9jb3JlL2NvbW1hbmQvQ29tbWFuZC5qc1xuLy8gbW9kdWxlIGlkID0gOTVcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwiaW1wb3J0IE1lZGlhdG9yU3RhdHVzIGZyb20gXCJvbHltcHVzLXIvZW5naW5lL21lZGlhdG9yL01lZGlhdG9yU3RhdHVzXCI7XHJcbmltcG9ydCBTY2VuZU1lZGlhdG9yIGZyb20gXCJvbHltcHVzLXIvZW5naW5lL3NjZW5lL1NjZW5lTWVkaWF0b3JcIjtcclxuaW1wb3J0IHsgbGlzdGVuQXBwbHkgfSBmcm9tICdvbHltcHVzLXIvdXRpbHMvQ29uc3RydWN0VXRpbCc7XHJcbi8qKlxyXG4gKiBAYXV0aG9yIFJheWtpZFxyXG4gKiBAZW1haWwgaW5pdGlhbF9yQHFxLmNvbVxyXG4gKiBAY3JlYXRlIGRhdGUgMjAxNy0xMC0wOVxyXG4gKiBAbW9kaWZ5IGRhdGUgMjAxNy0xMC0wOVxyXG4gKlxyXG4gKiBFZ3JldOearuiCpOW3peWFt+mbhlxyXG4qL1xyXG5leHBvcnQgZnVuY3Rpb24gd3JhcFNraW4obWVkaWF0b3IsIHNraW4pIHtcclxuICAgIHZhciByZXN1bHQ7XHJcbiAgICB2YXIgY29tcCA9IGdldENvbXBvbmVudChza2luKTtcclxuICAgIGlmICghY29tcCAmJiAhKHNraW4gaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0KSkge1xyXG4gICAgICAgIHZhciBjb21wQ2xzID0gKChtZWRpYXRvci5za2luIGluc3RhbmNlb2YgZXVpLkNvbXBvbmVudCAmJiBtZWRpYXRvci5za2luLmNvbnN0cnVjdG9yKSB8fCBldWkuQ29tcG9uZW50KTtcclxuICAgICAgICBjb21wID0gbmV3IGNvbXBDbHMoKTtcclxuICAgICAgICBjb21wLnNraW5OYW1lID0gc2tpbjtcclxuICAgICAgICByZXN1bHQgPSBjb21wO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmVzdWx0ID0gc2tpbjtcclxuICAgIH1cclxuICAgIC8vIOWIpOaWreS4reS7i+iAheW9k+WJjeeKtuaAgVxyXG4gICAgaWYgKG1lZGlhdG9yLnN0YXR1cyA8IE1lZGlhdG9yU3RhdHVzLk9QRU5JTkcpIHtcclxuICAgICAgICBsaXN0ZW5BcHBseShtZWRpYXRvciwgXCJvbk9wZW5cIiwgZG9XcmFwU2tpbik7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyDnm7TmjqXmiafooYzopoHmiafooYznmoRcclxuICAgICAgICBkb1dyYXBTa2luKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgZnVuY3Rpb24gZG9XcmFwU2tpbigpIHtcclxuICAgICAgICAvLyDlnLrmma/pnIDopoHmi4nkvLjliLDkuI5zdGFnZeWQjOWuvemrmFxyXG4gICAgICAgIGlmIChtZWRpYXRvciBpbnN0YW5jZW9mIFNjZW5lTWVkaWF0b3IpIHtcclxuICAgICAgICAgICAgY29tcC5wZXJjZW50V2lkdGggPSAxMDA7XHJcbiAgICAgICAgICAgIGNvbXAucGVyY2VudEhlaWdodCA9IDEwMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8g5ZCv5Yqo5byV55So6L2s5Y+RXHJcbiAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIGVncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXIgJiYgY29tcCAmJiBjb21wLnNraW4pIHtcclxuICAgICAgICAgICAgLy8g6L2s5Y+RdWnlvJXnlKjvvIzlpoLmnpzkvKDlhaXnmoTmmK/mmL7npLrlr7nosaHvvIzliJnpnIDopoHliKTmlq3nm67moIfmmK/lkKblsZ7kuo7or6Xlr7nosaHnmoTlkI7oo5RcclxuICAgICAgICAgICAgdmFyIG5lZWRKdWRnZURlc2NlbmRhbnQgPSAoc2tpbiBpbnN0YW5jZW9mIGVncmV0LkRpc3BsYXlPYmplY3RDb250YWluZXIpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29tcC5za2luLnNraW5QYXJ0czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gX2FbX2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGNvbXBbbmFtZV07XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5lZWRKdWRnZURlc2NlbmRhbnQgfHwgaXNEZXNjZW5kYW50KHRhcmdldCwgc2tpbikpXHJcbiAgICAgICAgICAgICAgICAgICAgbWVkaWF0b3JbbmFtZV0gPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0Q29tcG9uZW50KHNraW4pIHtcclxuICAgIGlmICghKHNraW4gaW5zdGFuY2VvZiBlZ3JldC5EaXNwbGF5T2JqZWN0KSlcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIGlmIChza2luIGluc3RhbmNlb2YgZXVpLkNvbXBvbmVudCAmJiBza2luLnNraW4pXHJcbiAgICAgICAgcmV0dXJuIHNraW47XHJcbiAgICByZXR1cm4gZ2V0Q29tcG9uZW50KHNraW4ucGFyZW50KTtcclxufVxyXG5mdW5jdGlvbiBpc0Rlc2NlbmRhbnQoZGVzY2VuZGFudCwgYXNjZW5kYW50KSB7XHJcbiAgICByZXR1cm4gKGRlc2NlbmRhbnQgIT09IGFzY2VuZGFudCAmJiBjb250YWlucyhkZXNjZW5kYW50LCBhc2NlbmRhbnQpKTtcclxufVxyXG5mdW5jdGlvbiBjb250YWlucyh0YXJnZXQsIHBhcmVudCkge1xyXG4gICAgaWYgKCF0YXJnZXQgfHwgIXBhcmVudClcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICBpZiAodGFyZ2V0ID09PSBwYXJlbnQpXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gY29udGFpbnModGFyZ2V0LnBhcmVudCwgcGFyZW50KTtcclxufVxyXG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL3Rlc3Qvbm9kZV9tb2R1bGVzL29seW1wdXMtci1lZ3JldC9lZ3JldC91dGlscy9Ta2luVXRpbC5qc1xuLy8gbW9kdWxlIGlkID0gOTZcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==
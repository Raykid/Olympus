var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Reflect;
(function (Reflect) {
    "use strict";
    var hasOwn = Object.prototype.hasOwnProperty;
    // feature test for Symbol support
    var supportsSymbol = typeof Symbol === "function";
    var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== "undefined" ? Symbol.toPrimitive : "@@toPrimitive";
    var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== "undefined" ? Symbol.iterator : "@@iterator";
    var HashMap;
    (function (HashMap) {
        var supportsCreate = typeof Object.create === "function"; // feature test for Object.create support
        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support
        var downLevel = !supportsCreate && !supportsProto;
        // create an object in dictionary mode (a.k.a. "slow" mode in v8)
        HashMap.create = supportsCreate
            ? function () { return MakeDictionary(Object.create(null)); }
            : supportsProto
                ? function () { return MakeDictionary({ __proto__: null }); }
                : function () { return MakeDictionary({}); };
        HashMap.has = downLevel
            ? function (map, key) { return hasOwn.call(map, key); }
            : function (map, key) { return key in map; };
        HashMap.get = downLevel
            ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }
            : function (map, key) { return map[key]; };
    })(HashMap || (HashMap = {}));
    // Load global or shim versions of Map, Set, and WeakMap
    var functionPrototype = Object.getPrototypeOf(Function);
    var usePolyfill = typeof process === "object" && process.env && process.env["REFLECT_METADATA_USE_MAP_POLYFILL"] === "true";
    var _Map = !usePolyfill && typeof Map === "function" && typeof Map.prototype.entries === "function" ? Map : CreateMapPolyfill();
    var _Set = !usePolyfill && typeof Set === "function" && typeof Set.prototype.entries === "function" ? Set : CreateSetPolyfill();
    var _WeakMap = !usePolyfill && typeof WeakMap === "function" ? WeakMap : CreateWeakMapPolyfill();
    // [[Metadata]] internal slot
    // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots
    var Metadata = new _WeakMap();
    /**
      * Applies a set of decorators to a property of a target object.
      * @param decorators An array of decorators.
      * @param target The target object.
      * @param propertyKey (Optional) The property key to decorate.
      * @param attributes (Optional) The property descriptor for the target key.
      * @remarks Decorators are applied in reverse order.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     Example = Reflect.decorate(decoratorsArray, Example);
      *
      *     // property (on constructor)
      *     Reflect.decorate(decoratorsArray, Example, "staticProperty");
      *
      *     // property (on prototype)
      *     Reflect.decorate(decoratorsArray, Example.prototype, "property");
      *
      *     // method (on constructor)
      *     Object.defineProperty(Example, "staticMethod",
      *         Reflect.decorate(decoratorsArray, Example, "staticMethod",
      *             Object.getOwnPropertyDescriptor(Example, "staticMethod")));
      *
      *     // method (on prototype)
      *     Object.defineProperty(Example.prototype, "method",
      *         Reflect.decorate(decoratorsArray, Example.prototype, "method",
      *             Object.getOwnPropertyDescriptor(Example.prototype, "method")));
      *
      */
    function decorate(decorators, target, propertyKey, attributes) {
        if (!IsUndefined(propertyKey)) {
            if (!IsArray(decorators))
                throw new TypeError();
            if (!IsObject(target))
                throw new TypeError();
            if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))
                throw new TypeError();
            if (IsNull(attributes))
                attributes = undefined;
            propertyKey = ToPropertyKey(propertyKey);
            return DecorateProperty(decorators, target, propertyKey, attributes);
        }
        else {
            if (!IsArray(decorators))
                throw new TypeError();
            if (!IsConstructor(target))
                throw new TypeError();
            return DecorateConstructor(decorators, target);
        }
    }
    Reflect.decorate = decorate;
    // 4.1.2 Reflect.metadata(metadataKey, metadataValue)
    // https://rbuckton.github.io/reflect-metadata/#reflect.metadata
    /**
      * A default metadata decorator factory that can be used on a class, class member, or parameter.
      * @param metadataKey The key for the metadata entry.
      * @param metadataValue The value for the metadata entry.
      * @returns A decorator function.
      * @remarks
      * If `metadataKey` is already defined for the target and target key, the
      * metadataValue for that key will be overwritten.
      * @example
      *
      *     // constructor
      *     @Reflect.metadata(key, value)
      *     class Example {
      *     }
      *
      *     // property (on constructor, TypeScript only)
      *     class Example {
      *         @Reflect.metadata(key, value)
      *         static staticProperty;
      *     }
      *
      *     // property (on prototype, TypeScript only)
      *     class Example {
      *         @Reflect.metadata(key, value)
      *         property;
      *     }
      *
      *     // method (on constructor)
      *     class Example {
      *         @Reflect.metadata(key, value)
      *         static staticMethod() { }
      *     }
      *
      *     // method (on prototype)
      *     class Example {
      *         @Reflect.metadata(key, value)
      *         method() { }
      *     }
      *
      */
    function metadata(metadataKey, metadataValue) {
        function decorator(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))
                throw new TypeError();
            OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
        }
        return decorator;
    }
    Reflect.metadata = metadata;
    /**
      * Define a unique metadata entry on the target.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param metadataValue A value that contains attached metadata.
      * @param target The target object on which to define metadata.
      * @param propertyKey (Optional) The property key for the target.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     Reflect.defineMetadata("custom:annotation", options, Example);
      *
      *     // property (on constructor)
      *     Reflect.defineMetadata("custom:annotation", options, Example, "staticProperty");
      *
      *     // property (on prototype)
      *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "property");
      *
      *     // method (on constructor)
      *     Reflect.defineMetadata("custom:annotation", options, Example, "staticMethod");
      *
      *     // method (on prototype)
      *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "method");
      *
      *     // decorator factory as metadata-producing annotation.
      *     function MyAnnotation(options): Decorator {
      *         return (target, key?) => Reflect.defineMetadata("custom:annotation", options, target, key);
      *     }
      *
      */
    function defineMetadata(metadataKey, metadataValue, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
    }
    Reflect.defineMetadata = defineMetadata;
    /**
      * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.hasMetadata("custom:annotation", Example);
      *
      *     // property (on constructor)
      *     result = Reflect.hasMetadata("custom:annotation", Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.hasMetadata("custom:annotation", Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "method");
      *
      */
    function hasMetadata(metadataKey, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryHasMetadata(metadataKey, target, propertyKey);
    }
    Reflect.hasMetadata = hasMetadata;
    /**
      * Gets a value indicating whether the target object has the provided metadata key defined.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.hasOwnMetadata("custom:annotation", Example);
      *
      *     // property (on constructor)
      *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "method");
      *
      */
    function hasOwnMetadata(metadataKey, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);
    }
    Reflect.hasOwnMetadata = hasOwnMetadata;
    /**
      * Gets the metadata value for the provided metadata key on the target object or its prototype chain.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.getMetadata("custom:annotation", Example);
      *
      *     // property (on constructor)
      *     result = Reflect.getMetadata("custom:annotation", Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.getMetadata("custom:annotation", Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "method");
      *
      */
    function getMetadata(metadataKey, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryGetMetadata(metadataKey, target, propertyKey);
    }
    Reflect.getMetadata = getMetadata;
    /**
      * Gets the metadata value for the provided metadata key on the target object.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.getOwnMetadata("custom:annotation", Example);
      *
      *     // property (on constructor)
      *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "method");
      *
      */
    function getOwnMetadata(metadataKey, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);
    }
    Reflect.getOwnMetadata = getOwnMetadata;
    /**
      * Gets the metadata keys defined on the target object or its prototype chain.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns An array of unique metadata keys.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.getMetadataKeys(Example);
      *
      *     // property (on constructor)
      *     result = Reflect.getMetadataKeys(Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.getMetadataKeys(Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.getMetadataKeys(Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.getMetadataKeys(Example.prototype, "method");
      *
      */
    function getMetadataKeys(target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryMetadataKeys(target, propertyKey);
    }
    Reflect.getMetadataKeys = getMetadataKeys;
    /**
      * Gets the unique metadata keys defined on the target object.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns An array of unique metadata keys.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.getOwnMetadataKeys(Example);
      *
      *     // property (on constructor)
      *     result = Reflect.getOwnMetadataKeys(Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.getOwnMetadataKeys(Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.getOwnMetadataKeys(Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.getOwnMetadataKeys(Example.prototype, "method");
      *
      */
    function getOwnMetadataKeys(target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        return OrdinaryOwnMetadataKeys(target, propertyKey);
    }
    Reflect.getOwnMetadataKeys = getOwnMetadataKeys;
    /**
      * Deletes the metadata entry from the target object with the provided key.
      * @param metadataKey A key used to store and retrieve metadata.
      * @param target The target object on which the metadata is defined.
      * @param propertyKey (Optional) The property key for the target.
      * @returns `true` if the metadata entry was found and deleted; otherwise, false.
      * @example
      *
      *     class Example {
      *         // property declarations are not part of ES6, though they are valid in TypeScript:
      *         // static staticProperty;
      *         // property;
      *
      *         constructor(p) { }
      *         static staticMethod(p) { }
      *         method(p) { }
      *     }
      *
      *     // constructor
      *     result = Reflect.deleteMetadata("custom:annotation", Example);
      *
      *     // property (on constructor)
      *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticProperty");
      *
      *     // property (on prototype)
      *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "property");
      *
      *     // method (on constructor)
      *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticMethod");
      *
      *     // method (on prototype)
      *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "method");
      *
      */
    function deleteMetadata(metadataKey, target, propertyKey) {
        if (!IsObject(target))
            throw new TypeError();
        if (!IsUndefined(propertyKey))
            propertyKey = ToPropertyKey(propertyKey);
        var metadataMap = GetOrCreateMetadataMap(target, propertyKey, /*Create*/ false);
        if (IsUndefined(metadataMap))
            return false;
        if (!metadataMap.delete(metadataKey))
            return false;
        if (metadataMap.size > 0)
            return true;
        var targetMetadata = Metadata.get(target);
        targetMetadata.delete(propertyKey);
        if (targetMetadata.size > 0)
            return true;
        Metadata.delete(target);
        return true;
    }
    Reflect.deleteMetadata = deleteMetadata;
    function DecorateConstructor(decorators, target) {
        for (var i = decorators.length - 1; i >= 0; --i) {
            var decorator = decorators[i];
            var decorated = decorator(target);
            if (!IsUndefined(decorated) && !IsNull(decorated)) {
                if (!IsConstructor(decorated))
                    throw new TypeError();
                target = decorated;
            }
        }
        return target;
    }
    function DecorateProperty(decorators, target, propertyKey, descriptor) {
        for (var i = decorators.length - 1; i >= 0; --i) {
            var decorator = decorators[i];
            var decorated = decorator(target, propertyKey, descriptor);
            if (!IsUndefined(decorated) && !IsNull(decorated)) {
                if (!IsObject(decorated))
                    throw new TypeError();
                descriptor = decorated;
            }
        }
        return descriptor;
    }
    function GetOrCreateMetadataMap(O, P, Create) {
        var targetMetadata = Metadata.get(O);
        if (IsUndefined(targetMetadata)) {
            if (!Create)
                return undefined;
            targetMetadata = new _Map();
            Metadata.set(O, targetMetadata);
        }
        var metadataMap = targetMetadata.get(P);
        if (IsUndefined(metadataMap)) {
            if (!Create)
                return undefined;
            metadataMap = new _Map();
            targetMetadata.set(P, metadataMap);
        }
        return metadataMap;
    }
    // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata
    function OrdinaryHasMetadata(MetadataKey, O, P) {
        var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
        if (hasOwn)
            return true;
        var parent = OrdinaryGetPrototypeOf(O);
        if (!IsNull(parent))
            return OrdinaryHasMetadata(MetadataKey, parent, P);
        return false;
    }
    // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata
    function OrdinaryHasOwnMetadata(MetadataKey, O, P) {
        var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
        if (IsUndefined(metadataMap))
            return false;
        return ToBoolean(metadataMap.has(MetadataKey));
    }
    // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata
    function OrdinaryGetMetadata(MetadataKey, O, P) {
        var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
        if (hasOwn)
            return OrdinaryGetOwnMetadata(MetadataKey, O, P);
        var parent = OrdinaryGetPrototypeOf(O);
        if (!IsNull(parent))
            return OrdinaryGetMetadata(MetadataKey, parent, P);
        return undefined;
    }
    // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata
    function OrdinaryGetOwnMetadata(MetadataKey, O, P) {
        var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
        if (IsUndefined(metadataMap))
            return undefined;
        return metadataMap.get(MetadataKey);
    }
    // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata
    function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {
        var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);
        metadataMap.set(MetadataKey, MetadataValue);
    }
    // 3.1.6.1 OrdinaryMetadataKeys(O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys
    function OrdinaryMetadataKeys(O, P) {
        var ownKeys = OrdinaryOwnMetadataKeys(O, P);
        var parent = OrdinaryGetPrototypeOf(O);
        if (parent === null)
            return ownKeys;
        var parentKeys = OrdinaryMetadataKeys(parent, P);
        if (parentKeys.length <= 0)
            return ownKeys;
        if (ownKeys.length <= 0)
            return parentKeys;
        var set = new _Set();
        var keys = [];
        for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {
            var key = ownKeys_1[_i];
            var hasKey = set.has(key);
            if (!hasKey) {
                set.add(key);
                keys.push(key);
            }
        }
        for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {
            var key = parentKeys_1[_a];
            var hasKey = set.has(key);
            if (!hasKey) {
                set.add(key);
                keys.push(key);
            }
        }
        return keys;
    }
    // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)
    // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys
    function OrdinaryOwnMetadataKeys(O, P) {
        var keys = [];
        var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
        if (IsUndefined(metadataMap))
            return keys;
        var keysObj = metadataMap.keys();
        var iterator = GetIterator(keysObj);
        var k = 0;
        while (true) {
            var next = IteratorStep(iterator);
            if (!next) {
                keys.length = k;
                return keys;
            }
            var nextValue = IteratorValue(next);
            try {
                keys[k] = nextValue;
            }
            catch (e) {
                try {
                    IteratorClose(iterator);
                }
                finally {
                    throw e;
                }
            }
            k++;
        }
    }
    // 6 ECMAScript Data Typ0es and Values
    // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values
    function Type(x) {
        if (x === null)
            return 1 /* Null */;
        switch (typeof x) {
            case "undefined": return 0 /* Undefined */;
            case "boolean": return 2 /* Boolean */;
            case "string": return 3 /* String */;
            case "symbol": return 4 /* Symbol */;
            case "number": return 5 /* Number */;
            case "object": return x === null ? 1 /* Null */ : 6 /* Object */;
            default: return 6 /* Object */;
        }
    }
    // 6.1.1 The Undefined Type
    // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type
    function IsUndefined(x) {
        return x === undefined;
    }
    // 6.1.2 The Null Type
    // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type
    function IsNull(x) {
        return x === null;
    }
    // 6.1.5 The Symbol Type
    // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type
    function IsSymbol(x) {
        return typeof x === "symbol";
    }
    // 6.1.7 The Object Type
    // https://tc39.github.io/ecma262/#sec-object-type
    function IsObject(x) {
        return typeof x === "object" ? x !== null : typeof x === "function";
    }
    // 7.1 Type Conversion
    // https://tc39.github.io/ecma262/#sec-type-conversion
    // 7.1.1 ToPrimitive(input [, PreferredType])
    // https://tc39.github.io/ecma262/#sec-toprimitive
    function ToPrimitive(input, PreferredType) {
        switch (Type(input)) {
            case 0 /* Undefined */: return input;
            case 1 /* Null */: return input;
            case 2 /* Boolean */: return input;
            case 3 /* String */: return input;
            case 4 /* Symbol */: return input;
            case 5 /* Number */: return input;
        }
        var hint = PreferredType === 3 /* String */ ? "string" : PreferredType === 5 /* Number */ ? "number" : "default";
        var exoticToPrim = GetMethod(input, toPrimitiveSymbol);
        if (exoticToPrim !== undefined) {
            var result = exoticToPrim.call(input, hint);
            if (IsObject(result))
                throw new TypeError();
            return result;
        }
        return OrdinaryToPrimitive(input, hint === "default" ? "number" : hint);
    }
    // 7.1.1.1 OrdinaryToPrimitive(O, hint)
    // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive
    function OrdinaryToPrimitive(O, hint) {
        if (hint === "string") {
            var toString_1 = O.toString;
            if (IsCallable(toString_1)) {
                var result = toString_1.call(O);
                if (!IsObject(result))
                    return result;
            }
            var valueOf = O.valueOf;
            if (IsCallable(valueOf)) {
                var result = valueOf.call(O);
                if (!IsObject(result))
                    return result;
            }
        }
        else {
            var valueOf = O.valueOf;
            if (IsCallable(valueOf)) {
                var result = valueOf.call(O);
                if (!IsObject(result))
                    return result;
            }
            var toString_2 = O.toString;
            if (IsCallable(toString_2)) {
                var result = toString_2.call(O);
                if (!IsObject(result))
                    return result;
            }
        }
        throw new TypeError();
    }
    // 7.1.2 ToBoolean(argument)
    // https://tc39.github.io/ecma262/2016/#sec-toboolean
    function ToBoolean(argument) {
        return !!argument;
    }
    // 7.1.12 ToString(argument)
    // https://tc39.github.io/ecma262/#sec-tostring
    function ToString(argument) {
        return "" + argument;
    }
    // 7.1.14 ToPropertyKey(argument)
    // https://tc39.github.io/ecma262/#sec-topropertykey
    function ToPropertyKey(argument) {
        var key = ToPrimitive(argument, 3 /* String */);
        if (IsSymbol(key))
            return key;
        return ToString(key);
    }
    // 7.2 Testing and Comparison Operations
    // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations
    // 7.2.2 IsArray(argument)
    // https://tc39.github.io/ecma262/#sec-isarray
    function IsArray(argument) {
        return Array.isArray
            ? Array.isArray(argument)
            : argument instanceof Object
                ? argument instanceof Array
                : Object.prototype.toString.call(argument) === "[object Array]";
    }
    // 7.2.3 IsCallable(argument)
    // https://tc39.github.io/ecma262/#sec-iscallable
    function IsCallable(argument) {
        // NOTE: This is an approximation as we cannot check for [[Call]] internal method.
        return typeof argument === "function";
    }
    // 7.2.4 IsConstructor(argument)
    // https://tc39.github.io/ecma262/#sec-isconstructor
    function IsConstructor(argument) {
        // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.
        return typeof argument === "function";
    }
    // 7.2.7 IsPropertyKey(argument)
    // https://tc39.github.io/ecma262/#sec-ispropertykey
    function IsPropertyKey(argument) {
        switch (Type(argument)) {
            case 3 /* String */: return true;
            case 4 /* Symbol */: return true;
            default: return false;
        }
    }
    // 7.3 Operations on Objects
    // https://tc39.github.io/ecma262/#sec-operations-on-objects
    // 7.3.9 GetMethod(V, P)
    // https://tc39.github.io/ecma262/#sec-getmethod
    function GetMethod(V, P) {
        var func = V[P];
        if (func === undefined || func === null)
            return undefined;
        if (!IsCallable(func))
            throw new TypeError();
        return func;
    }
    // 7.4 Operations on Iterator Objects
    // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects
    function GetIterator(obj) {
        var method = GetMethod(obj, iteratorSymbol);
        if (!IsCallable(method))
            throw new TypeError(); // from Call
        var iterator = method.call(obj);
        if (!IsObject(iterator))
            throw new TypeError();
        return iterator;
    }
    // 7.4.4 IteratorValue(iterResult)
    // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue
    function IteratorValue(iterResult) {
        return iterResult.value;
    }
    // 7.4.5 IteratorStep(iterator)
    // https://tc39.github.io/ecma262/#sec-iteratorstep
    function IteratorStep(iterator) {
        var result = iterator.next();
        return result.done ? false : result;
    }
    // 7.4.6 IteratorClose(iterator, completion)
    // https://tc39.github.io/ecma262/#sec-iteratorclose
    function IteratorClose(iterator) {
        var f = iterator["return"];
        if (f)
            f.call(iterator);
    }
    // 9.1 Ordinary Object Internal Methods and Internal Slots
    // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots
    // 9.1.1.1 OrdinaryGetPrototypeOf(O)
    // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof
    function OrdinaryGetPrototypeOf(O) {
        var proto = Object.getPrototypeOf(O);
        if (typeof O !== "function" || O === functionPrototype)
            return proto;
        // TypeScript doesn't set __proto__ in ES5, as it's non-standard.
        // Try to determine the superclass constructor. Compatible implementations
        // must either set __proto__ on a subclass constructor to the superclass constructor,
        // or ensure each class has a valid `constructor` property on its prototype that
        // points back to the constructor.
        // If this is not the same as Function.[[Prototype]], then this is definately inherited.
        // This is the case when in ES6 or when using __proto__ in a compatible browser.
        if (proto !== functionPrototype)
            return proto;
        // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.
        var prototype = O.prototype;
        var prototypeProto = prototype && Object.getPrototypeOf(prototype);
        if (prototypeProto == null || prototypeProto === Object.prototype)
            return proto;
        // If the constructor was not a function, then we cannot determine the heritage.
        var constructor = prototypeProto.constructor;
        if (typeof constructor !== "function")
            return proto;
        // If we have some kind of self-reference, then we cannot determine the heritage.
        if (constructor === O)
            return proto;
        // we have a pretty good guess at the heritage.
        return constructor;
    }
    // naive Map shim
    function CreateMapPolyfill() {
        var cacheSentinel = {};
        var arraySentinel = [];
        var MapIterator = (function () {
            function MapIterator(keys, values, selector) {
                this._index = 0;
                this._keys = keys;
                this._values = values;
                this._selector = selector;
            }
            MapIterator.prototype["@@iterator"] = function () { return this; };
            MapIterator.prototype[iteratorSymbol] = function () { return this; };
            MapIterator.prototype.next = function () {
                var index = this._index;
                if (index >= 0 && index < this._keys.length) {
                    var result = this._selector(this._keys[index], this._values[index]);
                    if (index + 1 >= this._keys.length) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    else {
                        this._index++;
                    }
                    return { value: result, done: false };
                }
                return { value: undefined, done: true };
            };
            MapIterator.prototype.throw = function (error) {
                if (this._index >= 0) {
                    this._index = -1;
                    this._keys = arraySentinel;
                    this._values = arraySentinel;
                }
                throw error;
            };
            MapIterator.prototype.return = function (value) {
                if (this._index >= 0) {
                    this._index = -1;
                    this._keys = arraySentinel;
                    this._values = arraySentinel;
                }
                return { value: value, done: true };
            };
            return MapIterator;
        }());
        return (function () {
            function Map() {
                this._keys = [];
                this._values = [];
                this._cacheKey = cacheSentinel;
                this._cacheIndex = -2;
            }
            Object.defineProperty(Map.prototype, "size", {
                get: function () { return this._keys.length; },
                enumerable: true,
                configurable: true
            });
            Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };
            Map.prototype.get = function (key) {
                var index = this._find(key, /*insert*/ false);
                return index >= 0 ? this._values[index] : undefined;
            };
            Map.prototype.set = function (key, value) {
                var index = this._find(key, /*insert*/ true);
                this._values[index] = value;
                return this;
            };
            Map.prototype.delete = function (key) {
                var index = this._find(key, /*insert*/ false);
                if (index >= 0) {
                    var size = this._keys.length;
                    for (var i = index + 1; i < size; i++) {
                        this._keys[i - 1] = this._keys[i];
                        this._values[i - 1] = this._values[i];
                    }
                    this._keys.length--;
                    this._values.length--;
                    if (key === this._cacheKey) {
                        this._cacheKey = cacheSentinel;
                        this._cacheIndex = -2;
                    }
                    return true;
                }
                return false;
            };
            Map.prototype.clear = function () {
                this._keys.length = 0;
                this._values.length = 0;
                this._cacheKey = cacheSentinel;
                this._cacheIndex = -2;
            };
            Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };
            Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };
            Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };
            Map.prototype["@@iterator"] = function () { return this.entries(); };
            Map.prototype[iteratorSymbol] = function () { return this.entries(); };
            Map.prototype._find = function (key, insert) {
                if (this._cacheKey !== key) {
                    this._cacheIndex = this._keys.indexOf(this._cacheKey = key);
                }
                if (this._cacheIndex < 0 && insert) {
                    this._cacheIndex = this._keys.length;
                    this._keys.push(key);
                    this._values.push(undefined);
                }
                return this._cacheIndex;
            };
            return Map;
        }());
        function getKey(key, _) {
            return key;
        }
        function getValue(_, value) {
            return value;
        }
        function getEntry(key, value) {
            return [key, value];
        }
    }
    // naive Set shim
    function CreateSetPolyfill() {
        return (function () {
            function Set() {
                this._map = new _Map();
            }
            Object.defineProperty(Set.prototype, "size", {
                get: function () { return this._map.size; },
                enumerable: true,
                configurable: true
            });
            Set.prototype.has = function (value) { return this._map.has(value); };
            Set.prototype.add = function (value) { return this._map.set(value, value), this; };
            Set.prototype.delete = function (value) { return this._map.delete(value); };
            Set.prototype.clear = function () { this._map.clear(); };
            Set.prototype.keys = function () { return this._map.keys(); };
            Set.prototype.values = function () { return this._map.values(); };
            Set.prototype.entries = function () { return this._map.entries(); };
            Set.prototype["@@iterator"] = function () { return this.keys(); };
            Set.prototype[iteratorSymbol] = function () { return this.keys(); };
            return Set;
        }());
    }
    // naive WeakMap shim
    function CreateWeakMapPolyfill() {
        var UUID_SIZE = 16;
        var keys = HashMap.create();
        var rootKey = CreateUniqueKey();
        return (function () {
            function WeakMap() {
                this._key = CreateUniqueKey();
            }
            WeakMap.prototype.has = function (target) {
                var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                return table !== undefined ? HashMap.has(table, this._key) : false;
            };
            WeakMap.prototype.get = function (target) {
                var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                return table !== undefined ? HashMap.get(table, this._key) : undefined;
            };
            WeakMap.prototype.set = function (target, value) {
                var table = GetOrCreateWeakMapTable(target, /*create*/ true);
                table[this._key] = value;
                return this;
            };
            WeakMap.prototype.delete = function (target) {
                var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                return table !== undefined ? delete table[this._key] : false;
            };
            WeakMap.prototype.clear = function () {
                // NOTE: not a real clear, just makes the previous data unreachable
                this._key = CreateUniqueKey();
            };
            return WeakMap;
        }());
        function CreateUniqueKey() {
            var key;
            do
                key = "@@WeakMap@@" + CreateUUID();
            while (HashMap.has(keys, key));
            keys[key] = true;
            return key;
        }
        function GetOrCreateWeakMapTable(target, create) {
            if (!hasOwn.call(target, rootKey)) {
                if (!create)
                    return undefined;
                Object.defineProperty(target, rootKey, { value: HashMap.create() });
            }
            return target[rootKey];
        }
        function FillRandomBytes(buffer, size) {
            for (var i = 0; i < size; ++i)
                buffer[i] = Math.random() * 0xff | 0;
            return buffer;
        }
        function GenRandomBytes(size) {
            if (typeof Uint8Array === "function") {
                if (typeof crypto !== "undefined")
                    return crypto.getRandomValues(new Uint8Array(size));
                if (typeof msCrypto !== "undefined")
                    return msCrypto.getRandomValues(new Uint8Array(size));
                return FillRandomBytes(new Uint8Array(size), size);
            }
            return FillRandomBytes(new Array(size), size);
        }
        function CreateUUID() {
            var data = GenRandomBytes(UUID_SIZE);
            // mark as random - RFC 4122 ยง 4.4
            data[6] = data[6] & 0x4f | 0x40;
            data[8] = data[8] & 0xbf | 0x80;
            var result = "";
            for (var offset = 0; offset < UUID_SIZE; ++offset) {
                var byte = data[offset];
                if (offset === 4 || offset === 6 || offset === 8)
                    result += "-";
                if (byte < 16)
                    result += "0";
                result += byte.toString(16).toLowerCase();
            }
            return result;
        }
    }
    // uses a heuristic used by v8 and chakra to force an object into dictionary mode.
    function MakeDictionary(obj) {
        obj.__ = undefined;
        delete obj.__;
        return obj;
    }
    // patch global Reflect
    (function (__global) {
        if (typeof __global.Reflect !== "undefined") {
            if (__global.Reflect !== Reflect) {
                for (var p in Reflect) {
                    if (hasOwn.call(Reflect, p)) {
                        __global.Reflect[p] = Reflect[p];
                    }
                }
            }
        }
        else {
            __global.Reflect = Reflect;
        }
    })(typeof global !== "undefined" ? global :
        typeof self !== "undefined" ? self :
            Function("return this;")());
})(Reflect || (Reflect = {}));
//# sourceMappingURL=Reflect.js.map 
var __reflect = (this && this.__reflect) || function (p, c, t) {
    p.__class__ = c, t ? t.push(c) : t = [c], p.__types__ = p.__types__ ? t.concat(p.__types__) : t;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="registerClass.ts" />
function __extends(d, b) {
    for (var p in b)
        if (b.hasOwnProperty(p))
            d[p] = b[p];
    function __() {
        this.constructor = d;
    }
    __.prototype = b.prototype;
    d.prototype = new __();
}
var __define = this.__define || function (o, p, g, s) { Object.defineProperty(o, p, { configurable: true, enumerable: true, get: g, set: s }); };
var egret;
(function (egret) {
    /**
     * @private
     * ๅๅธ่ฎกๆฐ
     */
    egret.$hashCount = 1;
    /**
     * The HashObject class is the base class for all objects in the Egret framework.The HashObject
     * class includes a hashCode property, which is a unique identification number of the instance.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Egret้กถ็บงๅฏน่ฑกใๆกๆถๅๆๆๅฏน่ฑก็ๅบ็ฑป๏ผไธบๅฏน่ฑกๅฎไพๆไพๅฏไธ็hashCodeๅผใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var HashObject = (function () {
        /**
         * Initializes a HashObject
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช HashObject ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function HashObject() {
            this.$hashCode = egret.$hashCount++;
        }
        Object.defineProperty(HashObject.prototype, "hashCode", {
            /**
             * a unique identification number assigned to this instance.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฟๅๆญคๅฏน่ฑกๅฏไธ็ๅๅธๅผ,็จไบๅฏไธ็กฎๅฎไธไธชๅฏน่ฑกใhashCodeไธบๅคงไบ็ญไบ1็ๆดๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$hashCode;
            },
            enumerable: true,
            configurable: true
        });
        return HashObject;
    }());
    egret.HashObject = HashObject;
    __reflect(HashObject.prototype, "egret.HashObject", ["egret.IHashObject"]);
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var rectanglePool = [];
    /**
     * A Rectangle object is an area defined by its position, as indicated by its top-left corner point (x, y) and by its
     * width and its height.<br/>
     * The x, y, width, and height properties of the Rectangle class are independent of each other; changing the value of
     * one property has no effect on the others. However, the right and bottom properties are integrally related to those
     * four properties. For example, if you change the value of the right property, the value of the width property changes;
     * if you change the bottom property, the value of the height property changes.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Rectangle.ts
     * @language en_US
     */
    /**
     * Rectangle ๅฏน่ฑกๆฏๆๅถไฝ็ฝฎ๏ผ็ฑๅฎๅทฆไธ่ง็็น (x, y) ็กฎๅฎ๏ผไปฅๅๅฎฝๅบฆๅ้ซๅบฆๅฎไน็ๅบๅใ<br/>
     * Rectangle ็ฑป็ xใyใwidth ๅ height ๅฑๆง็ธไบ็ฌ็ซ๏ผๆดๆนไธไธชๅฑๆง็ๅผไธไผๅฝฑๅๅถไปๅฑๆงใ
     * ไฝๆฏ๏ผright ๅ bottom ๅฑๆงไธ่ฟๅไธชๅฑๆงๆฏๆดไฝ็ธๅณ็ใไพๅฆ๏ผๅฆๆๆดๆน right ๅฑๆง็ๅผ๏ผๅ width
     * ๅฑๆง็ๅผๅฐๅ็ๅๅ๏ผๅฆๆๆดๆน bottom ๅฑๆง๏ผๅ height ๅฑๆง็ๅผๅฐๅ็ๅๅใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Rectangle.ts
     * @language zh_CN
     */
    var Rectangle = (function (_super) {
        __extends(Rectangle, _super);
        /**
         * Creates a new Rectangle object with the top-left corner specified by the x and y parameters and with the specified
         * width and height parameters.
         * @param x The x coordinate of the top-left corner of the rectangle.
         * @param y The y coordinate of the top-left corner of the rectangle.
         * @param width The width of the rectangle, in pixels.
         * @param height The height of the rectangle, in pixels.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๆฐ Rectangle ๅฏน่ฑก๏ผๅถๅทฆไธ่ง็ฑ x ๅ y ๅๆฐๆๅฎ๏ผๅนถๅทๆๆๅฎ็ width ๅ height ๅๆฐใ
         * @param x ็ฉๅฝขๅทฆไธ่ง็ x ๅๆใ
         * @param y ็ฉๅฝขๅทฆไธ่ง็ y ๅๆใ
         * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Rectangle(x, y, width, height) {
            if (x === void 0) {
                x = 0;
            }
            if (y === void 0) {
                y = 0;
            }
            if (width === void 0) {
                width = 0;
            }
            if (height === void 0) {
                height = 0;
            }
            var _this = _super.call(this) || this;
            _this.x = x;
            _this.y = y;
            _this.width = width;
            _this.height = height;
            return _this;
        }
        /**
         * Releases a rectangle instance to the object pool.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพไธไธชRectangleๅฎไพๅฐๅฏน่ฑกๆฑ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.release = function (rect) {
            if (!rect) {
                return;
            }
            rectanglePool.push(rect);
        };
        /**
         * get a rectangle instance from the object pool or create a new one.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฏน่ฑกๆฑไธญๅๅบๆๅๅปบไธไธชๆฐ็Rectangleๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.create = function () {
            var rect = rectanglePool.pop();
            if (!rect) {
                rect = new Rectangle();
            }
            return rect;
        };
        Object.defineProperty(Rectangle.prototype, "right", {
            /**
             * The sum of the x and width properties.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * x ๅ width ๅฑๆง็ๅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.x + this.width;
            },
            set: function (value) {
                this.width = value - this.x;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rectangle.prototype, "bottom", {
            /**
             * The sum of the y and height properties.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * y ๅ height ๅฑๆง็ๅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.y + this.height;
            },
            set: function (value) {
                this.height = value - this.y;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rectangle.prototype, "left", {
            /**
             * The x coordinate of the top-left corner of the rectangle. Changing the left property of a Rectangle object has
             * no effect on the y and height properties. However it does affect the width property, whereas changing the x value
             * does not affect the width property.
             * The value of the left property is equal to the value of the x property.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฉๅฝขๅทฆไธ่ง็ x ๅๆใๆดๆน Rectangle ๅฏน่ฑก็ left ๅฑๆงๅฏน y ๅ height ๅฑๆงๆฒกๆๅฝฑๅใไฝๆฏ๏ผๅฎไผๅฝฑๅ width ๅฑๆง๏ผ่ๆดๆน x ๅผไธไผๅฝฑๅ width ๅฑๆงใ
             * left ๅฑๆง็ๅผ็ญไบ x ๅฑๆง็ๅผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.x;
            },
            set: function (value) {
                this.width += this.x - value;
                this.x = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rectangle.prototype, "top", {
            /**
             * The y coordinate of the top-left corner of the rectangle. Changing the top property of a Rectangle object has
             * no effect on the x and width properties. However it does affect the height property, whereas changing the y
             * value does not affect the height property.<br/>
             * The value of the top property is equal to the value of the y property.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฉๅฝขๅทฆไธ่ง็ y ๅๆใๆดๆน Rectangle ๅฏน่ฑก็ top ๅฑๆงๅฏน x ๅ width ๅฑๆงๆฒกๆๅฝฑๅใไฝๆฏ๏ผๅฎไผๅฝฑๅ height ๅฑๆง๏ผ่ๆดๆน y ๅผไธไผๅฝฑๅ height ๅฑๆงใ<br/>
             * top ๅฑๆง็ๅผ็ญไบ y ๅฑๆง็ๅผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.y;
            },
            set: function (value) {
                this.height += this.y - value;
                this.y = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rectangle.prototype, "topLeft", {
            /**
             * The location of the Rectangle object's top-left corner, determined by the x and y coordinates of the point.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฑ่ฏฅ็น็ x ๅ y ๅๆ็กฎๅฎ็ Rectangle ๅฏน่ฑกๅทฆไธ่ง็ไฝ็ฝฎใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return new egret.Point(this.left, this.top);
            },
            set: function (value) {
                this.top = value.y;
                this.left = value.x;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rectangle.prototype, "bottomRight", {
            /**
             * The location of the Rectangle object's bottom-right corner, determined by the values of the right and bottom properties.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฑ right ๅ bottom ๅฑๆง็ๅผ็กฎๅฎ็ Rectangle ๅฏน่ฑก็ๅณไธ่ง็ไฝ็ฝฎใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return new egret.Point(this.right, this.bottom);
            },
            set: function (value) {
                this.bottom = value.y;
                this.right = value.x;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Copies all of rectangle data from the source Rectangle object into the calling Rectangle object.
         * @param sourceRect The Rectangle object from which to copy the data.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆบ Rectangle ๅฏน่ฑกไธญ็ๆๆ็ฉๅฝขๆฐๆฎๅคๅถๅฐ่ฐ็จๆน Rectangle ๅฏน่ฑกไธญใ
         * @param sourceRect ่ฆไปไธญๅคๅถๆฐๆฎ็ Rectangle ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.copyFrom = function (sourceRect) {
            this.x = sourceRect.x;
            this.y = sourceRect.y;
            this.width = sourceRect.width;
            this.height = sourceRect.height;
            return this;
        };
        /**
         * Sets the members of Rectangle to the specified values
         * @param x The x coordinate of the top-left corner of the rectangle.
         * @param y The y coordinate of the top-left corner of the rectangle.
         * @param width The width of the rectangle, in pixels.
         * @param height The height of the rectangle, in pixels.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ Rectangle ็ๆๅ่ฎพ็ฝฎไธบๆๅฎๅผ
         * @param x ็ฉๅฝขๅทฆไธ่ง็ x ๅๆใ
         * @param y ็ฉๅฝขๅทฆไธ่ง็ y ๅๆใ
         * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.setTo = function (x, y, width, height) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
            return this;
        };
        /**
         * Determines whether the specified point is contained within the rectangular region defined by this Rectangle object.
         * @param x The x coordinate (horizontal position) of the point.
         * @param y The y coordinate (vertical position) of the point.
         * @returns A value of true if the Rectangle object contains the specified point; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎ็ฑๆญค Rectangle ๅฏน่ฑกๅฎไน็็ฉๅฝขๅบๅๅๆฏๅฆๅๅซๆๅฎ็็นใ
         * @param x ๆฃๆต็น็x่ฝด
         * @param y ๆฃๆต็น็y่ฝด
         * @returns ๅฆๆๆฃๆต็นไฝไบ็ฉๅฝขๅ๏ผ่ฟๅtrue๏ผๅฆๅ๏ผ่ฟๅfalse
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.contains = function (x, y) {
            return this.x <= x &&
                this.x + this.width >= x &&
                this.y <= y &&
                this.y + this.height >= y;
        };
        /**
         * If the Rectangle object specified in the toIntersect parameter intersects with this Rectangle object, returns
         * the area of intersection as a Rectangle object. If the rectangles do not intersect, this method returns an empty
         * Rectangle object with its properties set to 0.
         * @param toIntersect The Rectangle object to compare against to see if it intersects with this Rectangle object.
         * @returns A Rectangle object that equals the area of intersection. If the rectangles do not intersect, this method
         * returns an empty Rectangle object; that is, a rectangle with its x, y, width, and height properties set to 0.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆๅจ toIntersect ๅๆฐไธญๆๅฎ็ Rectangle ๅฏน่ฑกไธๆญค Rectangle ๅฏน่ฑก็ธไบค๏ผๅ่ฟๅไบค้ๅบๅไฝไธบ Rectangle ๅฏน่ฑกใๅฆๆ็ฉๅฝขไธ็ธไบค๏ผ
         * ๅๆญคๆนๆณ่ฟๅไธไธช็ฉบ็ Rectangle ๅฏน่ฑก๏ผๅถๅฑๆง่ฎพ็ฝฎไธบ 0ใ
         * @param toIntersect ่ฆๅฏน็งๆฏ่พไปฅๆฅ็ๅถๆฏๅฆไธๆญค Rectangle ๅฏน่ฑก็ธไบค็ Rectangle ๅฏน่ฑกใ
         * @returns ็ญไบไบค้ๅบๅ็ Rectangle ๅฏน่ฑกใๅฆๆ่ฏฅ็ฉๅฝขไธ็ธไบค๏ผๅๆญคๆนๆณ่ฟๅไธไธช็ฉบ็ Rectangle ๅฏน่ฑก๏ผๅณ๏ผๅถ xใyใwidth ๅ
         * height ๅฑๆงๅ่ฎพ็ฝฎไธบ 0 ็็ฉๅฝขใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.intersection = function (toIntersect) {
            return this.clone().$intersectInPlace(toIntersect);
        };
        /**
         * Increases the size of the Rectangle object by the specified amounts, in pixels.
         * The center point of the Rectangle object stays the same, and its size increases to the left and right by the dx value, and to the top and the bottom by the dy value.
         * @param dx The value to be added to the left and the right of the Rectangle object.
         * @param dy The value to be added to the top and the bottom of the Rectangle.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๆๅฎ้ๅขๅ Rectangle ๅฏน่ฑก็ๅคงๅฐ๏ผไปฅๅ็ดไธบๅไฝ๏ผ
         * ไฟๆ Rectangle ๅฏน่ฑก็ไธญๅฟ็นไธๅ๏ผไฝฟ็จ dx ๅผๆจชๅๅขๅๅฎ็ๅคงๅฐ๏ผไฝฟ็จ dy ๅผ็บตๅๅขๅๅฎ็ๅคงๅฐใ
         * @param dx Rectangle ๅฏน่ฑกๆจชๅๅขๅ็ๅผใ
         * @param dy Rectangle ๅฏน่ฑก็บตๅๅขๅ็ๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.inflate = function (dx, dy) {
            this.x -= dx;
            this.width += 2 * dx;
            this.y -= dy;
            this.height += 2 * dy;
        };
        /**
         * @private
         */
        Rectangle.prototype.$intersectInPlace = function (clipRect) {
            var x0 = this.x;
            var y0 = this.y;
            var x1 = clipRect.x;
            var y1 = clipRect.y;
            var l = Math.max(x0, x1);
            var r = Math.min(x0 + this.width, x1 + clipRect.width);
            if (l <= r) {
                var t = Math.max(y0, y1);
                var b = Math.min(y0 + this.height, y1 + clipRect.height);
                if (t <= b) {
                    this.setTo(l, t, r - l, b - t);
                    return this;
                }
            }
            this.setEmpty();
            return this;
        };
        /**
         * Determines whether the object specified in the toIntersect parameter intersects with this Rectangle object.
         * This method checks the x, y, width, and height properties of the specified Rectangle object to see if it
         * intersects with this Rectangle object.
         * @param toIntersect The Rectangle object to compare against this Rectangle object.
         * @returns A value of true if the specified object intersects with this Rectangle object; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎๅจ toIntersect ๅๆฐไธญๆๅฎ็ๅฏน่ฑกๆฏๅฆไธๆญค Rectangle ๅฏน่ฑก็ธไบคใๆญคๆนๆณๆฃๆฅๆๅฎ็ Rectangle
         * ๅฏน่ฑก็ xใyใwidth ๅ height ๅฑๆง๏ผไปฅๆฅ็ๅฎๆฏๅฆไธๆญค Rectangle ๅฏน่ฑก็ธไบคใ
         * @param toIntersect ่ฆไธๆญค Rectangle ๅฏน่ฑกๆฏ่พ็ Rectangle ๅฏน่ฑกใ
         * @returns ๅฆๆไธคไธช็ฉๅฝข็ธไบค๏ผ่ฟๅtrue๏ผๅฆๅ่ฟๅfalse
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.intersects = function (toIntersect) {
            return Math.max(this.x, toIntersect.x) <= Math.min(this.right, toIntersect.right)
                && Math.max(this.y, toIntersect.y) <= Math.min(this.bottom, toIntersect.bottom);
        };
        /**
         * Determines whether or not this Rectangle object is empty.
         * @returns A value of true if the Rectangle object's width or height is less than or equal to 0; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎๆญค Rectangle ๅฏน่ฑกๆฏๅฆไธบ็ฉบใ
         * @returns ๅฆๆ Rectangle ๅฏน่ฑก็ๅฎฝๅบฆๆ้ซๅบฆๅฐไบ็ญไบ 0๏ผๅ่ฟๅ true ๅผ๏ผๅฆๅ่ฟๅ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.isEmpty = function () {
            return this.width <= 0 || this.height <= 0;
        };
        /**
         * Sets all of the Rectangle object's properties to 0. A Rectangle object is empty if its width or height is less than or equal to 0.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ Rectangle ๅฏน่ฑก็ๆๆๅฑๆง่ฎพ็ฝฎไธบ 0ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.setEmpty = function () {
            this.x = 0;
            this.y = 0;
            this.width = 0;
            this.height = 0;
        };
        /**
         * Returns a new Rectangle object with the same values for the x, y, width, and height properties as the original Rectangle object.
         * @returns A new Rectangle object with the same values for the x, y, width, and height properties as the original Rectangle object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅไธไธชๆฐ็ Rectangle ๅฏน่ฑก๏ผๅถ xใyใwidth ๅ height ๅฑๆง็ๅผไธๅๅง Rectangle ๅฏน่ฑก็ๅฏนๅบๅผ็ธๅใ
         * @returns ๆฐ็ Rectangle ๅฏน่ฑก๏ผๅถ xใyใwidth ๅ height ๅฑๆง็ๅผไธๅๅง Rectangle ๅฏน่ฑก็ๅฏนๅบๅผ็ธๅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.clone = function () {
            return new Rectangle(this.x, this.y, this.width, this.height);
        };
        /**
         * Determines whether the specified point is contained within the rectangular region defined by this Rectangle object.
         * This method is similar to the Rectangle.contains() method, except that it takes a Point object as a parameter.
         * @param point The point, as represented by its x and y coordinates.
         * @returns A value of true if the Rectangle object contains the specified point; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎ็ฑๆญค Rectangle ๅฏน่ฑกๅฎไน็็ฉๅฝขๅบๅๅๆฏๅฆๅๅซๆๅฎ็็นใ
         * ๆญคๆนๆณไธ Rectangle.contains() ๆนๆณ็ฑปไผผ๏ผๅชไธ่ฟๅฎ้็จ Point ๅฏน่ฑกไฝไธบๅๆฐใ
         * @param point ๅๅซ็นๅฏน่ฑก
         * @returns ๅฆๆๅๅซ๏ผ่ฟๅtrue๏ผๅฆๅ่ฟๅfalse
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.containsPoint = function (point) {
            if (this.x <= point.x
                && this.x + this.width > point.x
                && this.y <= point.y
                && this.y + this.height > point.y) {
                return true;
            }
            return false;
        };
        /**
         * Determines whether the Rectangle object specified by the rect parameter is contained within this Rectangle object.
         * A Rectangle object is said to contain another if the second Rectangle object falls entirely within the boundaries of the first.
         * @param rect The Rectangle object being checked.
         * @returns A value of true if the Rectangle object that you specify is contained by this Rectangle object; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎๆญค Rectangle ๅฏน่ฑกๅๆฏๅฆๅๅซ็ฑ rect ๅๆฐๆๅฎ็ Rectangle ๅฏน่ฑกใ
         * ๅฆๆไธไธช Rectangle ๅฏน่ฑกๅฎๅจๅจๅฆไธไธช Rectangle ็่พน็ๅ๏ผๆไปฌ่ฏด็ฌฌไบไธช Rectangle ๅๅซ็ฌฌไธไธช Rectangleใ
         * @param rect ๆๆฃๆฅ็ Rectangle ๅฏน่ฑก
         * @returns ๅฆๆๆญค Rectangle ๅฏน่ฑกๅๅซๆจๆๅฎ็ Rectangle ๅฏน่ฑก๏ผๅ่ฟๅ true ๅผ๏ผๅฆๅ่ฟๅ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.containsRect = function (rect) {
            var r1 = rect.x + rect.width;
            var b1 = rect.y + rect.height;
            var r2 = this.x + this.width;
            var b2 = this.y + this.height;
            return (rect.x >= this.x) && (rect.x < r2) && (rect.y >= this.y) && (rect.y < b2) && (r1 > this.x) && (r1 <= r2) && (b1 > this.y) && (b1 <= b2);
        };
        /**
         * Determines whether the object specified in the toCompare parameter is equal to this Rectangle object.
         * This method compares the x, y, width, and height properties of an object against the same properties of this Rectangle object.
         * @param The rectangle to compare to this Rectangle object.
         * @returns A value of true if the object has exactly the same values for the x, y, width, and height properties as this Rectangle object; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎๅจ toCompare ๅๆฐไธญๆๅฎ็ๅฏน่ฑกๆฏๅฆ็ญไบๆญค Rectangle ๅฏน่ฑกใ
         * ๆญคๆนๆณๅฐๆไธชๅฏน่ฑก็ xใyใwidth ๅ height ๅฑๆงไธๆญค Rectangle ๅฏน่ฑกๆๅฏนๅบ็็ธๅๅฑๆง่ฟ่กๆฏ่พใ
         * @param toCompare ่ฆไธๆญค Rectangle ๅฏน่ฑก่ฟ่กๆฏ่พ็็ฉๅฝขใ
         * @returns ๅฆๆๅฏน่ฑกๅทๆไธๆญค Rectangle ๅฏน่ฑกๅฎๅจ็ธๅ็ xใyใwidth ๅ height ๅฑๆงๅผ๏ผๅ่ฟๅ true ๅผ๏ผๅฆๅ่ฟๅ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.equals = function (toCompare) {
            if (this === toCompare) {
                return true;
            }
            return this.x === toCompare.x && this.y === toCompare.y
                && this.width === toCompare.width && this.height === toCompare.height;
        };
        /**
         * Increases the size of the Rectangle object. This method is similar to the Rectangle.inflate() method except it takes a Point object as a parameter.
         * @param point ๆญค Point ๅฏน่ฑก็ x ๅฑๆง็จไบๅขๅ Rectangle ๅฏน่ฑก็ๆฐดๅนณๅฐบๅฏธใy ๅฑๆง็จไบๅขๅ Rectangle ๅฏน่ฑก็ๅ็ดๅฐบๅฏธใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅขๅ Rectangle ๅฏน่ฑก็ๅคงๅฐใๆญคๆนๆณไธ Rectangle.inflate() ๆนๆณ็ฑปไผผ๏ผๅชไธ่ฟๅฎ้็จ Point ๅฏน่ฑกไฝไธบๅๆฐใ
         * @param point The x property of this Point object is used to increase the horizontal dimension of the Rectangle object. The y property is used to increase the vertical dimension of the Rectangle object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.inflatePoint = function (point) {
            this.inflate(point.x, point.y);
        };
        /**
         * Adjusts the location of the Rectangle object, as determined by its top-left corner, by the specified amounts.
         * @param dx Moves the x value of the Rectangle object by this amount.
         * @param dy Moves the y value of the Rectangle object by this amount.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๆๅฎ้่ฐๆด Rectangle ๅฏน่ฑก็ไฝ็ฝฎ๏ผ็ฑๅถๅทฆไธ่ง็กฎๅฎ๏ผใ
         * @param dx ๅฐ Rectangle ๅฏน่ฑก็ x ๅผ็งปๅจๆญคๆฐ้ใ
         * @param dy ๅฐ Rectangle ๅฏน่ฑก็ t ๅผ็งปๅจๆญคๆฐ้ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.offset = function (dx, dy) {
            this.x += dx;
            this.y += dy;
        };
        /**
         * Adjusts the location of the Rectangle object using a Point object as a parameter. This method is similar to the Rectangle.offset() method, except that it takes a Point object as a parameter.
         * @param point A Point object to use to offset this Rectangle object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ Point ๅฏน่ฑก็จไฝๅๆฐๆฅ่ฐๆด Rectangle ๅฏน่ฑก็ไฝ็ฝฎใๆญคๆนๆณไธ Rectangle.offset() ๆนๆณ็ฑปไผผ๏ผๅชไธ่ฟๅฎ้็จ Point ๅฏน่ฑกไฝไธบๅๆฐใ
         * @param point ่ฆ็จไบๅ็งปๆญค Rectangle ๅฏน่ฑก็ Point ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.offsetPoint = function (point) {
            this.offset(point.x, point.y);
        };
        /**
         * Builds and returns a string that lists the horizontal and vertical positions and the width and height of the Rectangle object.
         * @returns A string listing the value of each of the following properties of the Rectangle object: x, y, width, and height.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ๆๅนถ่ฟๅไธไธชๅญ็ฌฆไธฒ๏ผ่ฏฅๅญ็ฌฆไธฒๅๅบ Rectangle ๅฏน่ฑก็ๆฐดๅนณไฝ็ฝฎๅๅ็ดไฝ็ฝฎไปฅๅ้ซๅบฆๅๅฎฝๅบฆใ
         * @returns ไธไธชๅญ็ฌฆไธฒ๏ผๅฎๅๅบไบ Rectangle ๅฏน่ฑก็ไธๅๅไธชๅฑๆง็ๅผ๏ผxใyใwidth ๅ heightใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.toString = function () {
            return "(x=" + this.x + ", y=" + this.y + ", width=" + this.width + ", height=" + this.height + ")";
        };
        /**
         * Adds two rectangles together to create a new Rectangle object, by filling in the horizontal and vertical space between the two rectangles.
         * @param toUnion A Rectangle object to add to this Rectangle object.
         * @returns A new Rectangle object that is the union of the two rectangles.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟๅกซๅไธคไธช็ฉๅฝขไน้ด็ๆฐดๅนณๅๅ็ด็ฉบ้ด๏ผๅฐ่ฟไธคไธช็ฉๅฝข็ปๅๅจไธ่ตทไปฅๅๅปบไธไธชๆฐ็ Rectangle ๅฏน่ฑกใ
         * @param toUnion ่ฆๆทปๅๅฐๆญค Rectangle ๅฏน่ฑก็ Rectangle ๅฏน่ฑกใ
         * @returns ๅๅฝไธคไธช็ฉๅฝข็่ๅ็ๆฐ Rectangle ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Rectangle.prototype.union = function (toUnion) {
            var result = this.clone();
            if (toUnion.isEmpty()) {
                return result;
            }
            if (result.isEmpty()) {
                result.copyFrom(toUnion);
                return result;
            }
            var l = Math.min(result.x, toUnion.x);
            var t = Math.min(result.y, toUnion.y);
            result.setTo(l, t, Math.max(result.right, toUnion.right) - l, Math.max(result.bottom, toUnion.bottom) - t);
            return result;
        };
        /**
         * @private
         */
        Rectangle.prototype.$getBaseWidth = function (angle) {
            var u = Math.abs(Math.cos(angle));
            var v = Math.abs(Math.sin(angle));
            return u * this.width + v * this.height;
        };
        /**
         * @private
         */
        Rectangle.prototype.$getBaseHeight = function (angle) {
            var u = Math.abs(Math.cos(angle));
            var v = Math.abs(Math.sin(angle));
            return v * this.width + u * this.height;
        };
        return Rectangle;
    }(egret.HashObject));
    egret.Rectangle = Rectangle;
    __reflect(Rectangle.prototype, "egret.Rectangle");
    /**
     * @private
     * ไปไพๆกๆถๅๅค็จ๏ผ่ฆ้ฒๆญขๆด้ฒๅผ็จๅฐๅค้จใ
     */
    egret.$TempRectangle = new Rectangle();
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var ONCE_EVENT_LIST = [];
    /**
     * The EventDispatcher class is the base class for all classes that dispatchEvent events. The EventDispatcher class implements
     * the IEventDispatcher interface and is the base class for the DisplayObject class. The EventDispatcher class allows
     * any object on the display list to be an event target and as such, to use the methods of the IEventDispatcher interface.
     * Event targets are an important part of the Egret event model. The event target serves as the focal point for how events
     * flow through the display list hierarchy. When an event such as a touch tap, Egret dispatches an event object into the
     * event flow from the root of the display list. The event object then makes its way through the display list until it
     * reaches the event target, at which point it begins its return trip through the display list. This round-trip journey
     * to the event target is conceptually divided into three phases: <br/>
     * the capture phase comprises the journey from the root to the last node before the event target's node, the target
     * phase comprises only the event target node, and the bubbling phase comprises any subsequent nodes encountered on
     * the return trip to the root of the display list. In general, the easiest way for a user-defined class to gain event
     * dispatching capabilities is to extend EventDispatcher. If this is impossible (that is, if the class is already extending
     * another class), you can instead implement the IEventDispatcher interface, create an EventDispatcher member, and write simple
     * hooks to route calls into the aggregated EventDispatcher.
     * @see egret.IEventDispatcher
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/EventDispatcher.ts
     * @language en_US
     */
    /**
     * EventDispatcher ๆฏ Egret ็ไบไปถๆดพๅๅจ็ฑป๏ผ่ด่ดฃ่ฟ่กไบไปถ็ๅ้ๅไพฆๅฌใ
     * ไบไปถ็ฎๆๆฏไบไปถๅฆไฝ้่ฟๆพ็คบๅ่กจๅฑๆฌก็ปๆ่ฟไธ้ฎ้ข็็ฆ็นใๅฝๅ็้ผๆๅๅปใ่งฆๆธๆๆ้ฎ็ญไบไปถๆถ๏ผ
     * ๆกๆถไผๅฐไบไปถๅฏน่ฑก่ฐๅบฆๅฐไปๆพ็คบๅ่กจๆนๅผๅง็ไบไปถๆตไธญใ็ถๅ่ฏฅไบไปถๅฏน่ฑกๅจๆพ็คบๅ่กจไธญๅ่ฟ๏ผ็ดๅฐๅฐ่พพไบไปถ็ฎๆ๏ผ
     * ็ถๅไป่ฟไธ็นๅผๅงๅถๅจๆพ็คบๅ่กจไธญ็ๅ็จใๅจๆฆๅฟตไธ๏ผๅฐไบไปถ็ฎๆ็ๆญคๅพ่ฟ่ก็จ่ขซๅๅไธบไธไธช้ถๆฎต๏ผ
     * ๆ่ท้ถๆฎตๅๆฌไปๆนๅฐไบไปถ็ฎๆ่็นไนๅ็ๆๅไธไธช่็น็่ก็จ๏ผ็ฎๆ้ถๆฎตไปๅๆฌไบไปถ็ฎๆ่็น๏ผๅๆณก้ถๆฎตๅๆฌๅ็จไธ้ๅฐ็ไปปไฝๅ็ปญ่็นๅฐๆพ็คบๅ่กจ็ๆนใ
     * ้ๅธธ๏ผไฝฟ็จๆทๅฎไน็็ฑป่ฝๅค่ฐๅบฆไบไปถ็ๆ็ฎๅๆนๆณๆฏๆฉๅฑ EventDispatcherใๅฆๆๆๆณๆฉๅฑ๏ผๅณ๏ผๅฆๆ่ฏฅ็ฑปๅทฒ็ปๆฉๅฑไบๅฆไธไธช็ฑป๏ผ๏ผๅๅฏไปฅๅฎ็ฐ
     * IEventDispatcher ๆฅๅฃ๏ผๅๅปบ EventDispatcher ๆๅ๏ผๅนถ็ผๅไธไบ็ฎๅ็ๆๅฐ๏ผๅฐ่ฐ็จ่ฟๆฅๅฐ่ๅ็ EventDispatcher ไธญใ
     * @see egret.IEventDispatcher
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/EventDispatcher.ts
     * @language zh_CN
     */
    var EventDispatcher = (function (_super) {
        __extends(EventDispatcher, _super);
        /**
         * create an instance of the EventDispatcher class.
         * @param target The target object for events dispatched to the EventDispatcher object. This parameter is used when
         * the EventDispatcher instance is aggregated by a class that implements IEventDispatcher; it is necessary so that the
         * containing object can be the target for events. Do not use this parameter in simple cases in which a class extends EventDispatcher.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช EventDispatcher ็ฑป็ๅฎไพ
         * @param target ๆญค EventDispatcher ๆๆๅบไบไปถๅฏน่ฑก็ target ๆๅใๆญคๅๆฐไธป่ฆ็จไบไธไธชๅฎ็ฐไบ IEventDispatcher ๆฅๅฃ็่ชๅฎไน็ฑป๏ผ
         * ไปฅไพฟๆๅบ็ไบไปถๅฏน่ฑก็ target ๅฑๆงๅฏไปฅๆๅ่ชๅฎไน็ฑป่ช่บซใ่ฏทๅฟๅจ็ดๆฅ็ปงๆฟ EventDispatcher ็ๆๅตไธไฝฟ็จๆญคๅๆฐใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function EventDispatcher(target) {
            if (target === void 0) {
                target = null;
            }
            var _this = _super.call(this) || this;
            _this.$EventDispatcher = {
                0: target ? target : _this,
                1: {},
                2: {},
                3: 0
            };
            return _this;
        }
        /**
         * @private
         *
         * @param useCapture
         */
        EventDispatcher.prototype.$getEventMap = function (useCapture) {
            var values = this.$EventDispatcher;
            var eventMap = useCapture ? values[2 /* captureEventsMap */] : values[1 /* eventsMap */];
            return eventMap;
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.addEventListener = function (type, listener, thisObject, useCapture, priority) {
            this.$addListener(type, listener, thisObject, useCapture, priority);
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.once = function (type, listener, thisObject, useCapture, priority) {
            this.$addListener(type, listener, thisObject, useCapture, priority, true);
        };
        /**
         * @private
         */
        EventDispatcher.prototype.$addListener = function (type, listener, thisObject, useCapture, priority, dispatchOnce) {
            if (true && !listener) {
                egret.$error(1003, "listener");
            }
            var values = this.$EventDispatcher;
            var eventMap = useCapture ? values[2 /* captureEventsMap */] : values[1 /* eventsMap */];
            var list = eventMap[type];
            if (!list) {
                list = eventMap[type] = [];
            }
            else if (values[3 /* notifyLevel */] !== 0) {
                eventMap[type] = list = list.concat();
            }
            this.$insertEventBin(list, type, listener, thisObject, useCapture, priority, dispatchOnce);
        };
        EventDispatcher.prototype.$insertEventBin = function (list, type, listener, thisObject, useCapture, priority, dispatchOnce) {
            priority = +priority | 0;
            var insertIndex = -1;
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var bin = list[i];
                if (bin.listener == listener && bin.thisObject == thisObject && bin.target == this) {
                    return false;
                }
                if (insertIndex == -1 && bin.priority < priority) {
                    insertIndex = i;
                }
            }
            var eventBin = {
                type: type, listener: listener, thisObject: thisObject, priority: priority,
                target: this, useCapture: useCapture, dispatchOnce: !!dispatchOnce
            };
            if (insertIndex !== -1) {
                list.splice(insertIndex, 0, eventBin);
            }
            else {
                list.push(eventBin);
            }
            return true;
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.removeEventListener = function (type, listener, thisObject, useCapture) {
            var values = this.$EventDispatcher;
            var eventMap = useCapture ? values[2 /* captureEventsMap */] : values[1 /* eventsMap */];
            var list = eventMap[type];
            if (!list) {
                return;
            }
            if (values[3 /* notifyLevel */] !== 0) {
                eventMap[type] = list = list.concat();
            }
            this.$removeEventBin(list, listener, thisObject);
            if (list.length == 0) {
                eventMap[type] = null;
            }
        };
        EventDispatcher.prototype.$removeEventBin = function (list, listener, thisObject) {
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var bin = list[i];
                if (bin.listener == listener && bin.thisObject == thisObject && bin.target == this) {
                    list.splice(i, 1);
                    return true;
                }
            }
            return false;
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.hasEventListener = function (type) {
            var values = this.$EventDispatcher;
            return !!(values[1 /* eventsMap */][type] || values[2 /* captureEventsMap */][type]);
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.willTrigger = function (type) {
            return this.hasEventListener(type);
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        EventDispatcher.prototype.dispatchEvent = function (event) {
            event.$currentTarget = this.$EventDispatcher[0 /* eventTarget */];
            event.$setTarget(event.$currentTarget);
            return this.$notifyListener(event, false);
        };
        /**
         * @private
         */
        EventDispatcher.prototype.$notifyListener = function (event, capturePhase) {
            var values = this.$EventDispatcher;
            var eventMap = capturePhase ? values[2 /* captureEventsMap */] : values[1 /* eventsMap */];
            var list = eventMap[event.$type];
            if (!list) {
                return true;
            }
            var length = list.length;
            if (length == 0) {
                return true;
            }
            var onceList = ONCE_EVENT_LIST;
            //ๅไธชๆ่ฎฐ๏ผ้ฒๆญขๅค้จไฟฎๆนๅๅงๆฐ็ปๅฏผ่ด้ๅ้่ฏฏใ่ฟ้ไธ็ดๆฅ่ฐ็จlist.concat()ๅไธบdispatch()ๆนๆณ่ฐ็จ้ๅธธๆฏon()็ญๆนๆณ้ข็นใ
            values[3 /* notifyLevel */]++;
            for (var i = 0; i < length; i++) {
                var eventBin = list[i];
                eventBin.listener.call(eventBin.thisObject, event);
                if (eventBin.dispatchOnce) {
                    onceList.push(eventBin);
                }
                if (event.$isPropagationImmediateStopped) {
                    break;
                }
            }
            values[3 /* notifyLevel */]--;
            while (onceList.length) {
                var eventBin = onceList.pop();
                eventBin.target.removeEventListener(eventBin.type, eventBin.listener, eventBin.thisObject, eventBin.useCapture);
            }
            return !event.$isDefaultPrevented;
        };
        /**
         * Distribute a specified event parameters.
         * @param type The type of the event. Event listeners can access this information through the inherited type property.
         * @param bubbles Determines whether the Event object bubbles. Event listeners can access this information through
         * the inherited bubbles property.
         * @param data {any} data
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดพๅไธไธชๆๅฎๅๆฐ็ไบไปถใ
         * @param type {string} ไบไปถ็ฑปๅ
         * @param bubbles {boolean} ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param data {any} ไบไปถdata
         * @param cancelable {boolean} ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        EventDispatcher.prototype.dispatchEventWith = function (type, bubbles, data, cancelable) {
            if (bubbles || this.hasEventListener(type)) {
                var event_1 = egret.Event.create(egret.Event, type, bubbles, cancelable);
                event_1.data = data;
                var result = this.dispatchEvent(event_1);
                egret.Event.release(event_1);
                return result;
            }
            return true;
        };
        return EventDispatcher;
    }(egret.HashObject));
    egret.EventDispatcher = EventDispatcher;
    __reflect(EventDispatcher.prototype, "egret.EventDispatcher", ["egret.IEventDispatcher"]);
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * ๆผๅผๅๆ่ฝฌ่งๅบฆ็ๅผ
     */
    function clampRotation(value) {
        value %= 360;
        if (value > 180) {
            value -= 360;
        }
        else if (value < -180) {
            value += 360;
        }
        return value;
    }
    /**
     * The DisplayObject class is the base class for all objects that can be placed on the display list. The display list
     * manages all objects displayed in the runtime. Use the DisplayObjectContainer class to arrange the display
     * objects in the display list. DisplayObjectContainer objects can have child display objects, while other display objects,
     * such as Shape and TextField objects, are "leaf" nodes that have only parents and siblings, no children.
     * The DisplayObject class supports basic functionality like the x and y position of an object, as well as more advanced
     * properties of the object such as its transformation matrix.<br/>
     * The DisplayObject class contains several broadcast events.Normally, the target of any particular event is a specific
     * DisplayObject instance. For example, the target of an added event is the specific DisplayObject instance that was added
     * to the display list. Having a single target restricts the placement of event listeners to that target and in some cases
     * the target's ancestors on the display list. With broadcast events, however, the target is not a specific DisplayObject
     * instance, but rather all DisplayObject instances, including those that are not on the display list. This means that you
     * can add a listener to any DisplayObject instance to listen for broadcast events.
     *
     * @event egret.Event.ADDED Dispatched when a display object is added to the display list.
     * @event egret.Event.ADDED_TO_STAGE Dispatched when a display object is added to the on stage display list, either directly or through the addition of a sub tree in which the display object is contained.
     * @event egret.Event.REMOVED Dispatched when a display object is about to be removed from the display list.
     * @event egret.Event.REMOVED_FROM_STAGE Dispatched when a display object is about to be removed from the display list, either directly or through the removal of a sub tree in which the display object is contained.
     * @event egret.Event.ENTER_FRAME [broadcast event] Dispatched when the playhead is entering a new frame.
     * @event egret.Event.RENDER [broadcast event] Dispatched when the display list is about to be updated and rendered.
     * @event egret.TouchEvent.TOUCH_MOVE Dispatched when the user touches the device, and is continuously dispatched until the point of contact is removed.
     * @event egret.TouchEvent.TOUCH_BEGIN Dispatched when the user first contacts a touch-enabled device (such as touches a finger to a mobile phone or tablet with a touch screen).
     * @event egret.TouchEvent.TOUCH_END Dispatched when the user removes contact with a touch-enabled device (such as lifts a finger off a mobile phone or tablet with a touch screen).
     * @event egret.TouchEvent.TOUCH_TAP Dispatched when the user lifts the point of contact over the same DisplayObject instance on which the contact was initiated on a touch-enabled device (such as presses and releases a finger from a single point over a display object on a mobile phone or tablet with a touch screen).
     * @event egret.TouchEvent.TOUCH_RELEASE_OUTSIDE Dispatched when the user lifts the point of contact over the different DisplayObject instance on which the contact was initiated on a touch-enabled device (such as presses and releases a finger from a single point over a display object on a mobile phone or tablet with a touch screen).
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/DisplayObject.ts
     * @language en_US
     */
    /**
     * DisplayObject ็ฑปๆฏๅฏๆพๅจๆพ็คบๅ่กจไธญ็ๆๆๅฏน่ฑก็ๅบ็ฑปใ่ฏฅๆพ็คบๅ่กจ็ฎก็่ฟ่กๆถไธญๆพ็คบ็ๆๆๅฏน่ฑกใไฝฟ็จ DisplayObjectContainer ็ฑปๆๅ
     * ๆพ็คบๅ่กจไธญ็ๆพ็คบๅฏน่ฑกใDisplayObjectContainer ๅฏน่ฑกๅฏไปฅๆๅญๆพ็คบๅฏน่ฑก๏ผ่ๅถไปๆพ็คบๅฏน่ฑก๏ผๅฆ Shape ๅ TextField ๅฏน่ฑก๏ผๆฏโๅถโ่็น๏ผๆฒกๆๅญ้กน๏ผๅชๆ็ถ็บงๅ
     * ๅ็บงใDisplayObject ็ฑปๆไธไบๅบๆฌ็ๅฑๆง๏ผๅฆ็กฎๅฎๅๆไฝ็ฝฎ็ x ๅ y ๅฑๆง๏ผ๏ผไนๆไธไบ้ซ็บง็ๅฏน่ฑกๅฑๆง๏ผๅฆ Matrix ็ฉ้ตๅๆข๏ผใ<br/>
     * DisplayObject ็ฑปๅๅซ่ฅๅนฒๅนฟๆญไบไปถใ้ๅธธ๏ผไปปไฝ็นๅฎไบไปถ็็ฎๆๅไธบไธไธช็นๅฎ็ DisplayObject ๅฎไพใไพๅฆ๏ผadded ไบไปถ็็ฎๆๆฏๅทฒๆทปๅๅฐๆพ็คบๅ่กจ
     * ็็ฎๆ DisplayObject ๅฎไพใ่ฅๅชๆไธไธช็ฎๆ๏ผๅไผๅฐไบไปถไพฆๅฌๅจ้ๅถไธบๅช่ฝ็ๅฌๅจ่ฏฅ็ฎๆไธ๏ผๅจๆไบๆๅตไธ๏ผๅฏ็ๅฌๅจๆพ็คบๅ่กจไธญ่ฏฅ็ฎๆ็็ฅไปฃไธ๏ผใ
     * ไฝๆฏๅฏนไบๅนฟๆญไบไปถ๏ผ็ฎๆไธๆฏ็นๅฎ็ DisplayObject ๅฎไพ๏ผ่ๆฏๆๆ DisplayObject ๅฎไพ๏ผๅๆฌ้ฃไบไธๅจๆพ็คบๅ่กจไธญ็ๅฎไพ๏ผใ่ฟๆๅณ็ๆจๅฏไปฅๅไปปไฝ
     * DisplayObject ๅฎไพๆทปๅไพฆๅฌๅจๆฅไพฆๅฌๅนฟๆญไบไปถใ
     *
     * @event egret.Event.ADDED ๅฐๆพ็คบๅฏน่ฑกๆทปๅๅฐๆพ็คบๅ่กจไธญๆถ่ฐๅบฆใ
     * @event egret.Event.ADDED_TO_STAGE ๅจๅฐๆพ็คบๅฏน่ฑก็ดๆฅๆทปๅๅฐ่ๅฐๆพ็คบๅ่กจๆๅฐๅๅซๆพ็คบๅฏน่ฑก็ๅญๆๆทปๅ่ณ่ๅฐๆพ็คบๅ่กจไธญๆถ่ฐๅบฆใ
     * @event egret.Event.REMOVED ๅฐ่ฆไปๆพ็คบๅ่กจไธญๅ้คๆพ็คบๅฏน่ฑกๆถ่ฐๅบฆใ
     * @event egret.Event.REMOVED_FROM_STAGE ๅจไปๆพ็คบๅ่กจไธญ็ดๆฅๅ้คๆพ็คบๅฏน่ฑกๆๅ้คๅๅซๆพ็คบๅฏน่ฑก็ๅญๆๆถ่ฐๅบฆใ
     * @event egret.Event.ENTER_FRAME [ๅนฟๆญไบไปถ] ๆญๆพๅคด่ฟๅฅๆฐๅธงๆถ่ฐๅบฆใ
     * @event egret.Event.RENDER [ๅนฟๆญไบไปถ] ๅฐ่ฆๆดๆฐๅๅ็ฐๆพ็คบๅ่กจๆถ่ฐๅบฆใ
     * @event egret.TouchEvent.TOUCH_MOVE ๅฝ็จๆท่งฆ็ขฐ่ฎพๅคๆถ่ฟ่ก่ฐๅบฆ๏ผ่ไธไผ่ฟ็ปญ่ฐๅบฆ๏ผ็ดๅฐๆฅ่งฆ็น่ขซๅ้คใ
     * @event egret.TouchEvent.TOUCH_BEGIN ๅฝ็จๆท็ฌฌไธๆฌก่งฆๆธๅฏ็จ่งฆๆธ็่ฎพๅคๆถ๏ผไพๅฆ๏ผ็จๆๆ่งฆๆธๆๆบๅฑๅน๏ผ่ฐๅบฆใ
     * @event egret.TouchEvent.TOUCH_END ๅฝ็จๆท็งป้คไธๅฏ็จ่งฆๆธ็่ฎพๅค็ๆฅ่งฆๆถ๏ผไพๅฆ๏ผๅฐๆๆไปๅฑๅนไธๆฌ่ตท๏ผ่ฐๅบฆใ
     * @event egret.TouchEvent.TOUCH_TAP ๅฝ็จๆทๅจๅฏ็จ่งฆๆธ่ฎพๅคไธ็ๅทฒๅฏๅจๆฅ่งฆ็ๅไธ DisplayObject ๅฎไพไธๆฌ่ตทๆฅ่งฆ็นๆถ๏ผไพๅฆ๏ผๆๆบ็นๅปๅฑๅนๅๆฌ่ตท๏ผ่ฐๅบฆใ
     * @event egret.TouchEvent.TOUCH_RELEASE_OUTSIDE ๅฝ็จๆทๅจๅฏ็จ่งฆๆธ่ฎพๅคไธ็ๅทฒๅฏๅจๆฅ่งฆ็ไธๅ DisplayObject ๅฎไพไธๆฌ่ตทๆฅ่งฆ็นๆถ๏ผไพๅฆ๏ผๆไฝๅฑๅนไธ็ๆไธชๅฏน่ฑก,็ถๅไปๅฎไธ้ขๆชๅผๅๅๆพๅผๆๆ๏ผ่ฐๅบฆใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/DisplayObject.ts
     * @language zh_CN
     */
    var DisplayObject = (function (_super) {
        __extends(DisplayObject, _super);
        /**
         * Initializes a DisplayObject object
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๆพ็คบๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function DisplayObject() {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ่ฝๅคๅซๆๅญ้กน็็ฑปๅฐๅญ้กนๅ่กจๅญๅจๅจ่ฟไธชๅฑๆง้ใ
             */
            _this.$children = null;
            /**
             * @private
             */
            _this.$parent = null;
            /**
             * @private
             */
            _this.$stage = null;
            /**
             * @private
             * ่ฟไธชๅฏน่ฑกๅจๆพ็คบๅ่กจไธญ็ๅตๅฅๆทฑๅบฆ๏ผ่ๅฐไธบ1๏ผๅฎ็ๅญ้กนไธบ2๏ผๅญ้กน็ๅญ้กนไธบ3๏ผไปฅๆญค็ฑปๆจใๅฝๅฏน่ฑกไธๅจๆพ็คบๅ่กจไธญๆถๆญคๅฑๆงๅผไธบ0.
             */
            _this.$nestLevel = 0;
            /**
             * @private
             */
            _this.$visible = true;
            /**
             * @private
             * cacheAsBitmapๅๅปบ็็ผๅญไฝๅพ่็นใ
             */
            _this.$displayList = null;
            /**
             * @private
             */
            _this.$alpha = 1;
            _this.$touchEnabled = DisplayObject.defaultTouchEnabled;
            /**
             * @private
             */
            _this.$scrollRect = null;
            /**
             * @private
             */
            _this.$blendMode = 0;
            /**
             * @private
             * ่ขซ้ฎ็ฝฉ็ๅฏน่ฑก
             */
            _this.$maskedObject = null;
            /**
             * @private
             */
            _this.$mask = null;
            /**
             * @private
             */
            _this.$maskRect = null;
            /**
             * @private
             */
            _this.$parentDisplayList = null;
            /**
             * @private
             * ๆธฒๆ่็น,ไธไธบ็ฉบ่กจ็คบ่ช่บซๆ็ปๅถๅฐๅฑๅน็ๅๅฎน
             */
            _this.$renderNode = null;
            _this.$displayFlags = 2032 /* InitFlags */;
            _this.$DisplayObject = {
                0: 1,
                1: 1,
                2: 0,
                3: 0,
                4: 0,
                5: "",
                6: new egret.Matrix(),
                7: new egret.Matrix(),
                8: new egret.Matrix(),
                9: new egret.Rectangle(),
                10: new egret.Rectangle(),
                11: false,
                12: 0,
                13: 0,
                14: NaN,
                15: NaN,
                16: 0,
                17: 0,
                18: 0,
                19: null,
                20: null //filters
            };
            return _this;
        }
        /**
         * @private
         * ๆทปๅไธไธชๆๅฟ้
         */
        DisplayObject.prototype.$setFlags = function (flags) {
            this.$displayFlags |= flags;
        };
        /**
         * @private
         * ็งป้คไธไธชๆๅฟ้
         */
        DisplayObject.prototype.$removeFlags = function (flags) {
            this.$displayFlags &= ~flags;
        };
        /**
         * @private
         * ๆฒฟ็ๆพ็คบๅ่กจๅไธ็งป้คๆๅฟ้๏ผๅฆๆๆๅฟ้ๆฒก่ขซ่ฎพ็ฝฎ่ฟๅฐฑๅๆญข็งป้คใ
         */
        DisplayObject.prototype.$removeFlagsUp = function (flags) {
            if (!this.$hasAnyFlags(flags)) {
                return;
            }
            this.$removeFlags(flags);
            var parent = this.$parent;
            if (parent) {
                parent.$removeFlagsUp(flags);
            }
        };
        /**
         * @private
         * ๆฏๅฆๅซๆๆๅฎ็ๆๆๆๅฟ้
         */
        DisplayObject.prototype.$hasFlags = function (flags) {
            return (this.$displayFlags & flags) == flags;
        };
        /**
         * @private
         * ๆฒฟ็ๆพ็คบๅ่กจๅไธไผ้ๆๅฟ้๏ผๅฆๆๆๅฟ้ๅทฒ็ป่ขซ่ฎพ็ฝฎ่ฟๅฐฑๅๆญขไผ้ใ
         */
        DisplayObject.prototype.$propagateFlagsUp = function (flags) {
            if (this.$hasFlags(flags)) {
                return;
            }
            this.$setFlags(flags);
            var parent = this.$parent;
            if (parent) {
                parent.$propagateFlagsUp(flags);
            }
        };
        /**
         * @private
         * ๆฒฟ็ๆพ็คบๅ่กจๅไธไผ้ๆๅฟ้๏ผ้ๅฎนๅจ็ดๆฅ่ฎพ็ฝฎ่ช่บซ็flag๏ผๆญคๆนๆณไผๅจ DisplayObjectContainer ไธญ่ขซ่ฆ็ใ
         */
        DisplayObject.prototype.$propagateFlagsDown = function (flags) {
            this.$setFlags(flags);
        };
        /**
         * @private
         * ๆฏๅฆๅซๆๅคไธชๆๅฟ้ๅถไธญไนไธใ
         */
        DisplayObject.prototype.$hasAnyFlags = function (flags) {
            return !!(this.$displayFlags & flags);
        };
        /**
         * @private
         * ๆ่ฎฐ็ฉ้ตๅคฑๆ
         */
        DisplayObject.prototype.$invalidateMatrix = function () {
            this.$setFlags(8 /* InvalidMatrix */);
            this.$invalidatePosition();
        };
        /**
         * @private
         * ๆ่ฎฐ่ฟไธชๆพ็คบๅฏน่ฑกๅจ็ถ็บงๅฎนๅจ็ไฝ็ฝฎๅ็ไบๆนๅใ
         */
        DisplayObject.prototype.$invalidatePosition = function () {
            var self = this;
            self.$invalidateTransform();
            self.$propagateFlagsDown(16 /* InvalidConcatenatedMatrix */ |
                32 /* InvalidInvertedConcatenatedMatrix */);
            if (self.$parent) {
                self.$parent.$propagateFlagsUp(4 /* InvalidBounds */);
            }
        };
        Object.defineProperty(DisplayObject.prototype, "name", {
            /**
             * Indicates the instance name of the DisplayObject. The object can be identified in the child list of its parent
             * display object container by calling the getChildByName() method of the display object container.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ DisplayObject ็ๅฎไพๅ็งฐใ
             * ้่ฟ่ฐ็จ็ถๆพ็คบๅฏน่ฑกๅฎนๅจ็ getChildByName() ๆนๆณ๏ผๅฏไปฅๅจ็ถๆพ็คบๅฏน่ฑกๅฎนๅจ็ๅญๅ่กจไธญๆ่ฏ่ฏฅๅฏน่ฑกใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DisplayObject[5 /* name */];
            },
            set: function (value) {
                this.$DisplayObject[5 /* name */] = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DisplayObject.prototype, "parent", {
            /**
             * Indicates the DisplayObjectContainer object that contains this display object. Use the parent property to specify
             * a relative path to display objects that are above the current display object in the display list hierarchy.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๅๅซๆญคๆพ็คบๅฏน่ฑก็ DisplayObjectContainer ๅฏน่ฑกใ
             * ไฝฟ็จ parent ๅฑๆงๅฏไปฅๆๅฎ้ซไบๆพ็คบๅ่กจๅฑๆฌก็ปๆไธญๅฝๅๆพ็คบๅฏน่ฑก็ๆพ็คบๅฏน่ฑก็็ธๅฏน่ทฏๅพใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$parent;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ฎพ็ฝฎ็ถ็บงๆพ็คบๅฏน่ฑก
         */
        DisplayObject.prototype.$setParent = function (parent) {
            if (this.$parent == parent) {
                return false;
            }
            this.$parent = parent;
            return true;
        };
        /**
         * @private
         * ๆพ็คบๅฏน่ฑกๆทปๅๅฐ่ๅฐ
         */
        DisplayObject.prototype.$onAddToStage = function (stage, nestLevel) {
            this.$stage = stage;
            this.$nestLevel = nestLevel;
            this.$hasAddToStage = true;
            egret.DisplayObjectContainer.$EVENT_ADD_TO_STAGE_LIST.push(this);
        };
        /**
         * @private
         * ๆพ็คบๅฏน่ฑกไป่ๅฐ็งป้ค
         */
        DisplayObject.prototype.$onRemoveFromStage = function () {
            this.$nestLevel = 0;
            egret.DisplayObjectContainer.$EVENT_REMOVE_FROM_STAGE_LIST.push(this);
        };
        Object.defineProperty(DisplayObject.prototype, "stage", {
            /**
             * The Stage of the display object. you can create and load multiple display objects into the display list, and
             * the stage property of each display object refers to the same Stage object.<br/>
             * If a display object is not added to the display list, its stage property is set to null.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆพ็คบๅฏน่ฑก็่ๅฐใ
             * ไพๅฆ๏ผๆจๅฏไปฅๅๅปบๅคไธชๆพ็คบๅฏน่ฑกๅนถๅ่ฝฝๅฐๆพ็คบๅ่กจไธญ๏ผๆฏไธชๆพ็คบๅฏน่ฑก็ stage ๅฑๆงๆฏๆๅ็ธๅ็ Stage ๅฏน่ฑกใ<br/>
             * ๅฆๆๆพ็คบๅฏน่ฑกๆชๆทปๅๅฐๆพ็คบๅ่กจ๏ผๅๅถ stage ๅฑๆงไผ่ฎพ็ฝฎไธบ nullใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$stage;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DisplayObject.prototype, "matrix", {
            /**
             * A Matrix object containing values that alter the scaling, rotation, and translation of the display object.<br/>
             * Note: to change the value of a display object's matrix, you must make a copy of the entire matrix object, then copy
             * the new object into the matrix property of the display object.
             * @example the following code increases the tx value of a display object's matrix
             * <pre>
             *     let myMatrix:Matrix = myDisplayObject.matrix;
             *     myMatrix.tx += 10;
             *     myDisplayObject.matrix = myMatrix;
             * </pre>
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธไธช Matrix ๅฏน่ฑก๏ผๅถไธญๅๅซๆดๆนๆพ็คบๅฏน่ฑก็็ผฉๆพใๆ่ฝฌๅๅนณ็งป็ๅผใ<br/>
             * ๆณจๆ๏ผ่ฆๆนๅไธไธชๆพ็คบๅฏน่ฑก็ฉ้ต็ๅผ๏ผๆจๅฟๅผ็จๆดไธช็ฉ้ตๅฏน่ฑก๏ผ็ถๅๅฐๅฎ้ๆฐ่ตๅผ็ปๆพ็คบๅฏน่ฑก็ matrix ๅฑๆงใ
             * @example ไปฅไธไปฃ็ๆนๅไบๆพ็คบๅฏน่ฑก็ฉ้ต็txๅฑๆงๅผ๏ผ
             * <pre>
             *     let myMatrix:Matrix = myDisplayObject.matrix;
             *     myMatrix.tx += 10;
             *     myDisplayObject.matrix = myMatrix;
             * </pre>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getMatrix().clone();
            },
            set: function (value) {
                this.$setMatrix(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅ็ฉ้ต
         */
        DisplayObject.prototype.$getMatrix = function () {
            var values = this.$DisplayObject;
            if (this.$hasFlags(8 /* InvalidMatrix */)) {
                values[6 /* matrix */].$updateScaleAndRotation(values[0 /* scaleX */], values[1 /* scaleY */], values[2 /* skewX */], values[3 /* skewY */]);
                this.$removeFlags(8 /* InvalidMatrix */);
            }
            return values[6 /* matrix */];
        };
        /**
         * @private
         * ่ฎพ็ฝฎ็ฉ้ต
         */
        DisplayObject.prototype.$setMatrix = function (matrix, needUpdateProperties) {
            if (needUpdateProperties === void 0) {
                needUpdateProperties = true;
            }
            var self = this;
            var values = self.$DisplayObject;
            var m = values[6 /* matrix */];
            if (m.equals(matrix)) {
                return false;
            }
            m.copyFrom(matrix);
            if (needUpdateProperties) {
                values[0 /* scaleX */] = m.$getScaleX();
                values[1 /* scaleY */] = m.$getScaleY();
                values[2 /* skewX */] = m.$getSkewX();
                values[3 /* skewY */] = m.$getSkewY();
                values[16 /* skewXdeg */] = clampRotation(values[2 /* skewX */] * 180 / Math.PI);
                values[17 /* skewYdeg */] = clampRotation(values[3 /* skewY */] * 180 / Math.PI);
                values[4 /* rotation */] = clampRotation(values[3 /* skewY */] * 180 / Math.PI);
            }
            self.$removeFlags(8 /* InvalidMatrix */);
            self.$invalidatePosition();
            return true;
        };
        /**
         * @private
         * ่ทๅพ่ฟไธชๆพ็คบๅฏน่ฑกไปฅๅๅฎๆๆ็ถ็บงๅฏน่ฑก็่ฟๆฅ็ฉ้ตใ
         */
        DisplayObject.prototype.$getConcatenatedMatrix = function () {
            var matrix = this.$DisplayObject[7 /* concatenatedMatrix */];
            if (this.$hasFlags(16 /* InvalidConcatenatedMatrix */)) {
                if (this.$parent) {
                    this.$parent.$getConcatenatedMatrix().$preMultiplyInto(this.$getMatrix(), matrix);
                }
                else {
                    matrix.copyFrom(this.$getMatrix());
                }
                var values = this.$DisplayObject;
                var offsetX = values[12 /* anchorOffsetX */];
                var offsetY = values[13 /* anchorOffsetY */];
                var rect = this.$scrollRect;
                if (rect) {
                    matrix.$preMultiplyInto(egret.$TempMatrix.setTo(1, 0, 0, 1, -rect.x - offsetX, -rect.y - offsetY), matrix);
                }
                else if (offsetX != 0 || offsetY != 0) {
                    matrix.$preMultiplyInto(egret.$TempMatrix.setTo(1, 0, 0, 1, -offsetX, -offsetY), matrix);
                }
                if (this.$displayList) {
                    this.$displayList.$renderNode.moved = true;
                }
                if (this.$renderNode) {
                    this.$renderNode.moved = true;
                }
                this.$removeFlags(16 /* InvalidConcatenatedMatrix */);
            }
            return matrix;
        };
        /**
         * @private
         * ่ทๅ้พๆฅ็ฉ้ต
         */
        DisplayObject.prototype.$getInvertedConcatenatedMatrix = function () {
            var values = this.$DisplayObject;
            if (this.$hasFlags(32 /* InvalidInvertedConcatenatedMatrix */)) {
                this.$getConcatenatedMatrix().$invertInto(values[8 /* invertedConcatenatedMatrix */]);
                this.$removeFlags(32 /* InvalidInvertedConcatenatedMatrix */);
            }
            return values[8 /* invertedConcatenatedMatrix */];
        };
        Object.defineProperty(DisplayObject.prototype, "x", {
            /**
             * Indicates the x coordinate of the DisplayObject instance relative to the local coordinates of the parent
             * DisplayObjectContainer.<br/>
             * If the object is inside a DisplayObjectContainer that has transformations, it is in
             * the local coordinate system of the enclosing DisplayObjectContainer. Thus, for a DisplayObjectContainer
             * rotated 90ยฐ counterclockwise, the DisplayObjectContainer's children inherit a coordinate system that is
             * rotated 90ยฐ counterclockwise. The object's coordinates refer to the registration point position.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ DisplayObject ๅฎไพ็ธๅฏนไบ็ถ็บง DisplayObjectContainer ๆฌๅฐๅๆ็ x ๅๆใ<br/>
             * ๅฆๆ่ฏฅๅฏน่ฑกไฝไบๅทๆๅๅฝข็ DisplayObjectContainer ๅ๏ผๅๅฎไนไฝไบๅๅซ DisplayObjectContainer ็ๆฌๅฐๅๆ็ณปไธญใ
             * ๅๆญค๏ผๅฏนไบ้ๆถ้ๆ่ฝฌ 90 ๅบฆ็ DisplayObjectContainer๏ผ่ฏฅ DisplayObjectContainer ็ๅญ็บงๅฐ็ปงๆฟ้ๆถ้ๆ่ฝฌ 90 ๅบฆ็ๅๆ็ณปใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getX();
            },
            set: function (value) {
                this.$setX(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅxๅๆ
         */
        DisplayObject.prototype.$getX = function () {
            return this.$DisplayObject[6 /* matrix */].tx;
        };
        /**
         * @private
         * ่ฎพ็ฝฎxๅๆ
         */
        DisplayObject.prototype.$setX = function (value) {
            value = +value || 0;
            var m = this.$DisplayObject[6 /* matrix */];
            if (value == m.tx) {
                return false;
            }
            m.tx = value;
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "y", {
            /**
             * Indicates the y coordinate of the DisplayObject instance relative to the local coordinates of the parent
             * DisplayObjectContainer. <br/>
             * If the object is inside a DisplayObjectContainer that has transformations, it is in
             * the local coordinate system of the enclosing DisplayObjectContainer. Thus, for a DisplayObjectContainer rotated
             * 90ยฐ counterclockwise, the DisplayObjectContainer's children inherit a coordinate system that is rotated 90ยฐ
             * counterclockwise. The object's coordinates refer to the registration point position.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ DisplayObject ๅฎไพ็ธๅฏนไบ็ถ็บง DisplayObjectContainer ๆฌๅฐๅๆ็ y ๅๆใ<br/>
             * ๅฆๆ่ฏฅๅฏน่ฑกไฝไบๅทๆๅๅฝข็ DisplayObjectContainer ๅ๏ผๅๅฎไนไฝไบๅๅซ DisplayObjectContainer ็ๆฌๅฐๅๆ็ณปไธญใ
             * ๅๆญค๏ผๅฏนไบ้ๆถ้ๆ่ฝฌ 90 ๅบฆ็ DisplayObjectContainer๏ผ่ฏฅ DisplayObjectContainer ็ๅญ็บงๅฐ็ปงๆฟ้ๆถ้ๆ่ฝฌ 90 ๅบฆ็ๅๆ็ณปใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getY();
            },
            set: function (value) {
                this.$setY(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅyๅๆ
         */
        DisplayObject.prototype.$getY = function () {
            return this.$DisplayObject[6 /* matrix */].ty;
        };
        /**
         * @private
         * ่ฎพ็ฝฎyๅๆ
         */
        DisplayObject.prototype.$setY = function (value) {
            value = +value || 0;
            var m = this.$DisplayObject[6 /* matrix */];
            if (value == m.ty) {
                return false;
            }
            m.ty = value;
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "scaleX", {
            /**
             * Indicates the horizontal scale (percentage) of the object as applied from the registration point. <br/>
             * The default 1.0 equals 100% scale.
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบไปๆณจๅ็นๅผๅงๅบ็จ็ๅฏน่ฑก็ๆฐดๅนณ็ผฉๆพๆฏไพ๏ผ็พๅๆฏ๏ผใ<br/>
             * 1.0 ็ญไบ 100% ็ผฉๆพใ
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getScaleX();
            },
            set: function (value) {
                this.$setScaleX(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getScaleX = function () {
            return this.$DisplayObject[0 /* scaleX */];
        };
        /**
         * @private
         * ่ฎพ็ฝฎๆฐดๅนณ็ผฉๆพๅผ
         */
        DisplayObject.prototype.$setScaleX = function (value) {
            value = +value || 0;
            var values = this.$DisplayObject;
            if (value == values[0 /* scaleX */]) {
                return false;
            }
            values[0 /* scaleX */] = value;
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "scaleY", {
            /**
             * Indicates the vertical scale (percentage) of an object as applied from the registration point of the object.
             * 1.0 is 100% scale.
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบไปๅฏน่ฑกๆณจๅ็นๅผๅงๅบ็จ็ๅฏน่ฑก็ๅ็ด็ผฉๆพๆฏไพ๏ผ็พๅๆฏ๏ผใ1.0 ๆฏ 100% ็ผฉๆพใ
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getScaleY();
            },
            set: function (value) {
                this.$setScaleY(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getScaleY = function () {
            return this.$DisplayObject[1 /* scaleY */];
        };
        /**
         * @private
         * ่ฎพ็ฝฎๅ็ด็ผฉๆพๅผ
         */
        DisplayObject.prototype.$setScaleY = function (value) {
            value = +value || 0;
            if (value == this.$DisplayObject[1 /* scaleY */]) {
                return false;
            }
            this.$DisplayObject[1 /* scaleY */] = value;
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "rotation", {
            /**
             * Indicates the rotation of the DisplayObject instance, in degrees, from its original orientation. Values from
             * 0 to 180 represent clockwise rotation; values from 0 to -180 represent counterclockwise rotation. Values outside
             * this range are added to or subtracted from 360 to obtain a value within the range. For example, the statement
             * myDisplayObject.rotation = 450 is the same as myDisplayObject.rotation = 90.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ DisplayObject ๅฎไพ่ทๅถๅๅงๆนๅ็ๆ่ฝฌ็จๅบฆ๏ผไปฅๅบฆไธบๅไฝใ
             * ไป 0 ๅฐ 180 ็ๅผ่กจ็คบ้กบๆถ้ๆนๅๆ่ฝฌ๏ผไป 0 ๅฐ -180 ็ๅผ่กจ็คบ้ๆถ้ๆนๅๆ่ฝฌใๅฏนไบๆญค่ๅดไนๅค็ๅผ๏ผๅฏไปฅ้่ฟๅไธๆ
             * ๅๅป 360 ่ทๅพ่ฏฅ่ๅดๅ็ๅผใไพๅฆ๏ผmyDisplayObject.rotation = 450่ฏญๅฅไธ myDisplayObject.rotation = 90 ๆฏ็ธๅ็ใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getRotation();
            },
            set: function (value) {
                this.$setRotation(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getRotation = function () {
            return this.$DisplayObject[4 /* rotation */];
        };
        DisplayObject.prototype.$setRotation = function (value) {
            value = +value || 0;
            value = clampRotation(value);
            var values = this.$DisplayObject;
            if (value == values[4 /* rotation */]) {
                return false;
            }
            var delta = value - values[4 /* rotation */];
            var angle = delta / 180 * Math.PI;
            values[2 /* skewX */] += angle;
            values[3 /* skewY */] += angle;
            values[4 /* rotation */] = value;
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "skewX", {
            /**
             * ่กจ็คบDisplayObject็xๆนๅๆๅ
             * @member {number} egret.DisplayObject#skewX
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$DisplayObject[16 /* skewXdeg */];
            },
            set: function (value) {
                this.$setSkewX(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DisplayObject.prototype.$setSkewX = function (value) {
            value = +value || 0;
            var values = this.$DisplayObject;
            if (value == values[16 /* skewXdeg */]) {
                return false;
            }
            values[16 /* skewXdeg */] = value;
            value = clampRotation(value);
            value = value / 180 * Math.PI;
            values[2 /* skewX */] = value;
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "skewY", {
            /**
             * ่กจ็คบDisplayObject็yๆนๅๆๅ
             * @member {number} egret.DisplayObject#skewY
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$DisplayObject[17 /* skewYdeg */];
            },
            set: function (value) {
                this.$setSkewY(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DisplayObject.prototype.$setSkewY = function (value) {
            value = +value || 0;
            var values = this.$DisplayObject;
            if (value == values[17 /* skewYdeg */]) {
                return false;
            }
            values[17 /* skewYdeg */] = value;
            value = clampRotation(value);
            value = value / 180 * Math.PI;
            values[3 /* skewY */] = value;
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "width", {
            /**
             * Indicates the width of the display object, in pixels. The width is calculated based on the bounds of the content
             * of the display object.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๆพ็คบๅฏน่ฑก็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝใๅฎฝๅบฆๆฏๆนๆฎๆพ็คบๅฏน่ฑกๅๅฎน็่ๅดๆฅ่ฎก็ฎ็ใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getWidth();
            },
            set: function (value) {
                this.$setWidth(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅๆพ็คบๅฎฝๅบฆ
         */
        DisplayObject.prototype.$getWidth = function () {
            return isNaN(this.$getExplicitWidth()) ? this.$getOriginalBounds().width : this.$getExplicitWidth();
            //return this.$getTransformedBounds(this.$parent, $TempRectangle).width;
        };
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getExplicitWidth = function () {
            return this.$DisplayObject[14 /* explicitWidth */];
        };
        /**
         * @private
         * ่ฎพ็ฝฎๆพ็คบๅฎฝๅบฆ
         */
        DisplayObject.prototype.$setWidth = function (value) {
            this.$DisplayObject[14 /* explicitWidth */] = isNaN(value) ? NaN : value;
            value = +value;
            if (value < 0) {
                return false;
            }
            // if (false) {
            //     let values = this.$DisplayObject;
            //     let originalBounds = this.$getOriginalBounds();
            //     let bounds = this.$getTransformedBounds(this.$parent, $TempRectangle);
            //     let angle = values[Keys.rotation] / 180 * Math.PI;
            //     let baseWidth = originalBounds.$getBaseWidth(angle);
            //     if (!baseWidth) {
            //         return false;
            //     }
            //     let baseHeight = originalBounds.$getBaseHeight(angle);
            //     values[Keys.scaleY] = bounds.height / baseHeight;
            //     values[Keys.scaleX] = value / baseWidth;
            // }
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "height", {
            /**
             * Indicates the height of the display object, in pixels. The height is calculated based on the bounds of the
             * content of the display object.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๆพ็คบๅฏน่ฑก็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝใ้ซๅบฆๆฏๆนๆฎๆพ็คบๅฏน่ฑกๅๅฎน็่ๅดๆฅ่ฎก็ฎ็ใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getHeight();
            },
            set: function (value) {
                this.$setHeight(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅๆพ็คบ้ซๅบฆ
         */
        DisplayObject.prototype.$getHeight = function () {
            return isNaN(this.$getExplicitHeight()) ? this.$getOriginalBounds().height : this.$getExplicitHeight();
            //return this.$getTransformedBounds(this.$parent, $TempRectangle).height;
        };
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getExplicitHeight = function () {
            return this.$DisplayObject[15 /* explicitHeight */];
        };
        /**
         * @private
         * ่ฎพ็ฝฎๆพ็คบ้ซๅบฆ
         */
        DisplayObject.prototype.$setHeight = function (value) {
            this.$DisplayObject[15 /* explicitHeight */] = isNaN(value) ? NaN : value;
            value = +value;
            if (value < 0) {
                return false;
            }
            // if (false) {
            //     let values = this.$DisplayObject;
            //     let originalBounds = this.$getOriginalBounds();
            //     let bounds = this.$getTransformedBounds(this.$parent, $TempRectangle);
            //     let angle = values[Keys.rotation] / 180 * Math.PI;
            //     let baseHeight = originalBounds.$getBaseHeight(angle);
            //     if (!baseHeight) {
            //         return false;
            //     }
            //     let baseWidth = originalBounds.$getBaseWidth(angle);
            //     values[Keys.scaleY] = value / baseHeight;
            //     values[Keys.scaleX] = bounds.width / baseWidth;
            // }
            this.$invalidateMatrix();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "measuredWidth", {
            /**
             * ๆต้ๅฎฝๅบฆ
             * @returns {number}
             * @member {egret.Rectangle} egret.DisplayObject#measuredWidth
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$getOriginalBounds().width;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DisplayObject.prototype, "measuredHeight", {
            /**
             * ๆต้้ซๅบฆ
             * @returns {number}
             * @member {egret.Rectangle} egret.DisplayObject#measuredWidth
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$getOriginalBounds().height;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DisplayObject.prototype, "anchorOffsetX", {
            /**
             * X represents the object of which is the anchor.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบไปๅฏน่ฑก็ปๅฏน้็นXใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DisplayObject[12 /* anchorOffsetX */];
            },
            set: function (value) {
                this.$setAnchorOffsetX(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        DisplayObject.prototype.$getAnchorOffsetX = function () {
            return this.$DisplayObject[12 /* anchorOffsetX */];
        };
        /**
         * @private
         *
         * @param value
         * @returns
         */
        DisplayObject.prototype.$setAnchorOffsetX = function (value) {
            value = +value || 0;
            if (value == this.$DisplayObject[12 /* anchorOffsetX */]) {
                return false;
            }
            this.$DisplayObject[12 /* anchorOffsetX */] = value;
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "anchorOffsetY", {
            /**
             * Y represents the object of which is the anchor.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบไปๅฏน่ฑก็ปๅฏน้็นYใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DisplayObject[13 /* anchorOffsetY */];
            },
            set: function (value) {
                this.$setAnchorOffsetY(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        DisplayObject.prototype.$getAnchorOffsetY = function () {
            return this.$DisplayObject[13 /* anchorOffsetY */];
        };
        /**
         * @private
         *
         * @param value
         * @returns
         */
        DisplayObject.prototype.$setAnchorOffsetY = function (value) {
            value = +value || 0;
            if (value == this.$DisplayObject[13 /* anchorOffsetY */]) {
                return false;
            }
            this.$DisplayObject[13 /* anchorOffsetY */] = value;
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "visible", {
            /**
             * Whether or not the display object is visible. Display objects that are not visible are disabled. For example,
             * if visible=false for an DisplayObject instance, it cannot receive touch or other user input.
             * @default true
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆพ็คบๅฏน่ฑกๆฏๅฆๅฏ่งใไธๅฏ่ง็ๆพ็คบๅฏน่ฑกๅฐ่ขซ็ฆ็จใไพๅฆ๏ผๅฆๆๅฎไพ็ visible ไธบ false๏ผๅๆๆณๆฅๅ่งฆๆธๆ็จๆทไบคไบๆไฝใ
             * @default true
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$visible;
            },
            set: function (value) {
                this.$setVisible(value);
            },
            enumerable: true,
            configurable: true
        });
        DisplayObject.prototype.$setVisible = function (value) {
            value = !!value;
            if (value == this.$visible) {
                return false;
            }
            this.$visible = value;
            this.$propagateFlagsDown(1024 /* InvalidConcatenatedVisible */);
            this.$invalidateTransform();
            return true;
        };
        /**
         * @private
         * ่ทๅ่ฟไธชๆพ็คบๅฏน่ฑก่ทๅฎๆๆ็ถ็บง้ๆๅบฆ็ไน็งฏ
         */
        DisplayObject.prototype.$getConcatenatedVisible = function () {
            var values = this.$DisplayObject;
            if (this.$hasFlags(1024 /* InvalidConcatenatedVisible */)) {
                if (this.$parent) {
                    var parentVisible = this.$parent.$getConcatenatedVisible();
                    values[19 /* concatenatedVisible */] = parentVisible && this.$visible;
                }
                else {
                    values[19 /* concatenatedVisible */] = this.$visible;
                }
                this.$removeFlags(1024 /* InvalidConcatenatedVisible */);
            }
            return values[19 /* concatenatedVisible */];
        };
        Object.defineProperty(DisplayObject.prototype, "cacheAsBitmap", {
            /**
             * If set to true, Egret runtime caches an internal bitmap representation of the display object. This caching can
             * increase performance for display objects that contain complex vector content. After you set the cacheAsBitmap
             * property to true, the rendering does not change, however the display object performs pixel snapping automatically.
             * The execution speed can be significantly faster depending on the complexity of the content.The cacheAsBitmap
             * property is best used with display objects that have mostly static content and that do not scale and rotate frequently.<br/>
             * Note: The display object will not create the bitmap caching when the memory exceeds the upper limit,even if you set it to true.
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆ่ฎพ็ฝฎไธบ true๏ผๅ Egret ่ฟ่กๆถๅฐ็ผๅญๆพ็คบๅฏน่ฑก็ๅ้จไฝๅพ่กจ็คบๅฝขๅผใๆญค็ผๅญๅฏไปฅๆ้ซๅๅซๅคๆ็ข้ๅๅฎน็ๆพ็คบๅฏน่ฑก็ๆง่ฝใ
             * ๅฐ cacheAsBitmap ๅฑๆง่ฎพ็ฝฎไธบ true ๅ๏ผๅ็ฐๅนถไธๆดๆน๏ผไฝๆฏ๏ผๆพ็คบๅฏน่ฑกๅฐ่ชๅจๆง่กๅ็ด่ดด็ดงใๆง่ก้ๅบฆๅฏ่ฝไผๅคงๅคงๅๅฟซ๏ผ
             * ๅทไฝๅๅณไบๆพ็คบๅฏน่ฑกๅๅฎน็ๅคๆๆงใๆๅฅฝๅฐ cacheAsBitmap ๅฑๆงไธไธป่ฆๅทๆ้ๆๅๅฎนไธไธ้ข็น็ผฉๆพๆๆ่ฝฌ็ๆพ็คบๅฏน่ฑกไธ่ตทไฝฟ็จใ<br/>
             * ๆณจๆ๏ผๅจๅๅญ่ถ่ฟไธ้็ๆๅตไธ๏ผๅณไฝฟๅฐ cacheAsBitmap ๅฑๆง่ฎพ็ฝฎไธบ true๏ผๆพ็คบๅฏน่ฑกไนไธไฝฟ็จไฝๅพ็ผๅญใ
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DisplayObject[11 /* cacheAsBitmap */];
            },
            set: function (value) {
                value = !!value;
                this.$DisplayObject[11 /* cacheAsBitmap */] = value;
                this.$setHasDisplayList(value);
            },
            enumerable: true,
            configurable: true
        });
        DisplayObject.prototype.$setHasDisplayList = function (value) {
            var hasDisplayList = !!this.$displayList;
            if (hasDisplayList == value) {
                return;
            }
            if (value) {
                var displayList = egret.sys.DisplayList.create(this);
                if (displayList) {
                    this.$displayList = displayList;
                    if (this.$parentDisplayList) {
                        this.$parentDisplayList.markDirty(displayList);
                    }
                    this.$cacheAsBitmapChanged();
                }
            }
            else {
                this.$displayList = null;
                this.$cacheAsBitmapChanged();
            }
        };
        /**
         * @private
         * cacheAsBitmapๅฑๆงๆนๅ
         */
        DisplayObject.prototype.$cacheAsBitmapChanged = function () {
            var parentCache = this.$displayList || this.$parentDisplayList;
            if (this.$renderNode && parentCache) {
                parentCache.markDirty(this);
            }
            this.$propagateFlagsDown(16 /* InvalidConcatenatedMatrix */ |
                32 /* InvalidInvertedConcatenatedMatrix */);
        };
        Object.defineProperty(DisplayObject.prototype, "alpha", {
            /**
             * Indicates the alpha transparency value of the object specified. Valid values are 0 (fully transparent) to 1 (fully opaque).
             * The default value is 1. Display objects with alpha set to 0 are active, even though they are invisible.
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๆๅฎๅฏน่ฑก็ Alpha ้ๆๅบฆๅผใ
             * ๆๆๅผไธบ 0๏ผๅฎๅจ้ๆ๏ผๅฐ 1๏ผๅฎๅจไธ้ๆ๏ผใalpha ่ฎพ็ฝฎไธบ 0 ็ๆพ็คบๅฏน่ฑกๆฏๅฏ่งฆๆธ็๏ผๅณไฝฟๅฎไปฌไธๅฏ่งใ
             * @default 1
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$alpha;
            },
            set: function (value) {
                this.$setAlpha(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DisplayObject.prototype.$setAlpha = function (value) {
            value = +value || 0;
            if (value == this.$alpha) {
                return false;
            }
            this.$alpha = value;
            this.$propagateFlagsDown(64 /* InvalidConcatenatedAlpha */);
            this.$invalidate();
            return true;
        };
        /**
         * @private
         * ่ทๅ่ฟไธชๆพ็คบๅฏน่ฑก่ทๅฎๆๆ็ถ็บง้ๆๅบฆ็ไน็งฏ
         */
        DisplayObject.prototype.$getConcatenatedAlpha = function () {
            var values = this.$DisplayObject;
            if (this.$hasFlags(64 /* InvalidConcatenatedAlpha */)) {
                if (this.$parent) {
                    var parentAlpha = this.$parent.$getConcatenatedAlpha();
                    values[18 /* concatenatedAlpha */] = parentAlpha * this.$alpha;
                }
                else {
                    values[18 /* concatenatedAlpha */] = this.$alpha;
                }
                this.$removeFlags(64 /* InvalidConcatenatedAlpha */);
            }
            return values[18 /* concatenatedAlpha */];
        };
        Object.defineProperty(DisplayObject.prototype, "touchEnabled", {
            /**
             * Specifies whether this object receives touch or other user input. The default value is false, which means that
             * by default any DisplayObject instance that is on the display list cannot receive touch events. If touchEnabled is
             * set to false, the instance does not receive any touch events (or other user input events). Any children of
             * this instance on the display list are not affected. To change the touchEnabled behavior for all children of
             * an object on the display list, use DisplayObjectContainer.touchChildren.
             * @see egret.DisplayObjectContainer#touchChildren
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฎๆญคๅฏน่ฑกๆฏๅฆๆฅๆถ่งฆๆธๆๅถไป็จๆท่พๅฅใ้ป่ฎคๅผไธบ false๏ผ่ฟ่กจ็คบ้ป่ฎคๆๅตไธ๏ผๆพ็คบๅ่กจไธ็ไปปไฝ DisplayObject ๅฎไพ้ฝไธไผๆฅๆถ่งฆๆธไบไปถๆ
             * ๅถไป็จๆท่พๅฅไบไปถใๅฆๆๅฐ touchEnabled ่ฎพ็ฝฎไธบ false๏ผๅๅฎไพๅฐไธๆฅๆถไปปไฝ่งฆๆธไบไปถ๏ผๆๅถไป็จๆท่พๅฅไบไปถ๏ผใๆพ็คบๅ่กจไธ็่ฏฅๅฎไพ็ไปป
             * ไฝๅญ็บง้ฝไธไผๅๅฐๅฝฑๅใ่ฆๆดๆนๆพ็คบๅ่กจไธๅฏน่ฑก็ๆๆๅญ็บง็ touchEnabled ่กไธบ๏ผ่ฏทไฝฟ็จ DisplayObjectContainer.touchChildrenใ
             * @see egret.DisplayObjectContainer#touchChildren
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getTouchEnabled();
            },
            set: function (value) {
                this.$setTouchEnabled(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        DisplayObject.prototype.$getTouchEnabled = function () {
            return this.$touchEnabled;
        };
        /**
         * @private
         */
        DisplayObject.prototype.$setTouchEnabled = function (value) {
            if (this.$touchEnabled == value) {
                return false;
            }
            this.$touchEnabled = value;
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "scrollRect", {
            /**
             * The scroll rectangle bounds of the display object. The display object is cropped to the size defined by the rectangle,
             * and it scrolls within the rectangle when you change the x and y properties of the scrollRect object. A scrolled display
             * object always scrolls in whole pixel increments.You can scroll an object left and right by setting the x property of
             * the scrollRect Rectangle object. You can scroll an object up and down by setting the y property of the scrollRect
             * Rectangle object. If the display object is rotated 90ยฐ and you scroll it left and right, the display object actually
             * scrolls up and down.<br/>
             *
             * Note: to change the value of a display object's scrollRect, you must make a copy of the entire scrollRect object, then copy
             * the new object into the scrollRect property of the display object.
             * @example the following code increases the x value of a display object's scrollRect
             * <pre>
             *     let myRectangle:Rectangle = myDisplayObject.scrollRect;
             *     myRectangle.x += 10;
             *     myDisplayObject.scrollRect = myRectangle;
             * </pre>
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆพ็คบๅฏน่ฑก็ๆปๅจ็ฉๅฝข่ๅดใๆพ็คบๅฏน่ฑก่ขซ่ฃๅไธบ็ฉๅฝขๅฎไน็ๅคงๅฐ๏ผๅฝๆจๆดๆน scrollRect ๅฏน่ฑก็ x ๅ y ๅฑๆงๆถ๏ผๅฎไผๅจ็ฉๅฝขๅๆปๅจใ
             * ๆปๅจ็ๆพ็คบๅฏน่ฑกๅง็ปไปฅๆดๅ็ดไธบๅข้่ฟ่กๆปๅจใๆจๅฏไปฅ้่ฟ่ฎพ็ฝฎ scrollRect Rectangle ๅฏน่ฑก็ x ๅฑๆงๆฅๅทฆๅณๆปๅจๅฏน่ฑก๏ผ ่ฟๅฏไปฅ้่ฟ่ฎพ็ฝฎ
             * scrollRect ๅฏน่ฑก็ y ๅฑๆงๆฅไธไธๆปๅจๅฏน่ฑกใๅฆๆๆพ็คบๅฏน่ฑกๆ่ฝฌไบ 90 ๅบฆ๏ผๅนถไธๆจๅทฆๅณๆปๅจๅฎ๏ผๅๅฎ้ไธๆพ็คบๅฏน่ฑกไผไธไธๆปๅจใ<br/>
             *
             * ๆณจๆ๏ผ่ฆๆนๅไธไธชๆพ็คบๅฏน่ฑก scrollRect ๅฑๆง็ๅผ๏ผๆจๅฟๅผ็จๆดไธช scrollRect ๅฏน่ฑก๏ผ็ถๅๅฐๅฎ้ๆฐ่ตๅผ็ปๆพ็คบๅฏน่ฑก็ scrollRect ๅฑๆงใ
             * @example ไปฅไธไปฃ็ๆนๅไบๆพ็คบๅฏน่ฑก scrollRect ็ x ๅฑๆงๅผ๏ผ
             * <pre>
             *     let myRectangle:Rectangle = myDisplayObject.scrollRect;
             *     myRectangle.x += 10;
             *     myDisplayObject.scrollRect = myRectangle;//่ฎพ็ฝฎๅฎscrollRect็xใyใwidthใheightๅผไนๅ๏ผไธๅฎ่ฆๅฏนmyDisplayObject้ๆฐ่ตๅผscrollRect๏ผไธ็ถไผๅบ้ฎ้ขใ
             * </pre>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$scrollRect;
            },
            set: function (value) {
                this.$setScrollRect(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DisplayObject.prototype.$setScrollRect = function (value) {
            if (!value && !this.$scrollRect) {
                return false;
            }
            if (value) {
                if (!this.$scrollRect) {
                    this.$scrollRect = new egret.Rectangle();
                }
                this.$scrollRect.copyFrom(value);
            }
            else {
                this.$scrollRect = null;
            }
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "blendMode", {
            /**
             * A value from the BlendMode class that specifies which blend mode to use. Determine how a source image (new one)
             * is drawn on the target image (old one).<br/>
             * If you attempt to set this property to an invalid value, Egret runtime set the value to BlendMode.NORMAL.
             * @default egret.BlendMode.NORMAL
             * @see egret.BlendMode
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * BlendMode ๆไธพไธญ็ไธไธชๅผ๏ผ็จไบๆๅฎ่ฆไฝฟ็จ็ๆททๅๆจกๅผ๏ผ็กฎๅฎๅฆไฝๅฐไธไธชๆบ๏ผๆฐ็๏ผๅพๅ็ปๅถๅฐ็ฎๆ๏ผๅทฒๆ๏ผ็ๅพๅไธ<br/>
             * ๅฆๆๅฐ่ฏๅฐๆญคๅฑๆง่ฎพ็ฝฎไธบๆๆๅผ๏ผๅ่ฟ่กๆถไผๅฐๆญคๅผ่ฎพ็ฝฎไธบ BlendMode.NORMALใ
             * @default egret.BlendMode.NORMAL
             * @see egret.BlendMode
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return egret.sys.numberToBlendMode(this.$blendMode);
            },
            set: function (value) {
                var mode = egret.sys.blendModeToNumber(value);
                if (mode == this.$blendMode) {
                    return;
                }
                this.$blendMode = mode;
                this.$invalidateTransform();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DisplayObject.prototype, "mask", {
            /**
             * The calling display object is masked by the specified mask object. To ensure that masking works when the Stage
             * is scaled, the mask display object must be in an active part of the display list. The mask object itself is not drawn.
             * Set mask to null to remove the mask. To be able to scale a mask object, it must be on the display list. To be
             * able to drag a mask object , it must be on the display list.<br/>
             * Note: A single mask object cannot be used to mask more than one calling display object. When the mask is assigned
             * to a second display object, it is removed as the mask of the first object, and that object's mask property becomes null.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฐ็จๆพ็คบๅฏน่ฑก่ขซๆๅฎ็ mask ๅฏน่ฑก้ฎ็ฝฉใ่ฆ็กฎไฟๅฝ่ๅฐ็ผฉๆพๆถ่็ไป็ถๆๆ๏ผmask ๆพ็คบๅฏน่ฑกๅฟ้กปๅคไบๆพ็คบๅ่กจ็ๆดปๅจ้จๅใ
             * ไฝไธ็ปๅถ mask ๅฏน่ฑกๆฌ่บซใๅฐ mask ่ฎพ็ฝฎไธบ null ๅฏๅ้ค่็ใ่ฆ่ฝๅค็ผฉๆพ้ฎ็ฝฉๅฏน่ฑก๏ผๅฎๅฟ้กปๅจๆพ็คบๅ่กจไธญใ่ฆ่ฝๅคๆๅจ่็
             * ๅฏน่ฑก๏ผๅฎๅฟ้กปๅจๆพ็คบๅ่กจไธญใ<br/>
             * ๆณจๆ๏ผๅไธช mask ๅฏน่ฑกไธ่ฝ็จไบ้ฎ็ฝฉๅคไธชๆง่ก่ฐ็จ็ๆพ็คบๅฏน่ฑกใๅจๅฐ mask ๅ้็ป็ฌฌไบไธชๆพ็คบๅฏน่ฑกๆถ๏ผไผๆคๆถๅถไฝไธบ็ฌฌไธไธชๅฏน่ฑก็้ฎ็ฝฉ๏ผ
             * ่ฏฅๅฏน่ฑก็ mask ๅฑๆงๅฐๅไธบ nullใ
             *
             * ไธ้ขไพๅญไธบ mask ไธบ Rectangle ็ฑปๅๅฏน่ฑก๏ผ่ฟ็งๆๅตไธ๏ผไฟฎๆน mask ็ๅผๅ๏ผไธๅฎ่ฆๅฏน myDisplayObject ้ๆฐ่ตๅผ mask๏ผไธ็ถไผๅบ้ฎ้ขใ
             * @example ไปฅไธไปฃ็ๆนๅไบๆพ็คบๅฏน่ฑก mask ็ x ๅฑๆงๅผ๏ผ
             * <pre>
             *     let myMask:Rectangle = myDisplayObject.mask;
             *     myMask.x += 10;
             *     myDisplayObject.mask = myMask;//่ฎพ็ฝฎๅฎ mask ็xใyใwidthใheightๅผไนๅ๏ผไธๅฎ่ฆๅฏนmyDisplayObject้ๆฐ่ตๅผ mask๏ผไธ็ถไผๅบ้ฎ้ขใ
             * </pre>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$mask ? this.$mask : this.$maskRect;
            },
            set: function (value) {
                if (value === this) {
                    return;
                }
                if (value) {
                    if (value instanceof DisplayObject) {
                        if (value == this.$mask) {
                            return;
                        }
                        if (value.$maskedObject) {
                            value.$maskedObject.mask = null;
                        }
                        value.$maskedObject = this;
                        value.$invalidateTransform();
                        this.$mask = value;
                        this.$maskRect = null;
                    }
                    else {
                        this.$setMaskRect(value);
                        if (this.$mask) {
                            this.$mask.$maskedObject = null;
                            this.$mask.$invalidateTransform();
                        }
                        this.$mask = null;
                    }
                }
                else {
                    if (this.$mask) {
                        this.$mask.$maskedObject = null;
                        this.$mask.$invalidateTransform();
                    }
                    this.$mask = null;
                    this.$maskRect = null;
                }
                this.$invalidateTransform();
            },
            enumerable: true,
            configurable: true
        });
        DisplayObject.prototype.$setMaskRect = function (value) {
            if (!value && !this.$maskRect) {
                return false;
            }
            if (value) {
                if (!this.$maskRect) {
                    this.$maskRect = new egret.Rectangle();
                }
                this.$maskRect.copyFrom(value);
            }
            else {
                this.$maskRect = null;
            }
            this.$invalidatePosition();
            return true;
        };
        Object.defineProperty(DisplayObject.prototype, "filters", {
            /**
             * An indexed array that contains each filter object currently associated with the display object.
             * @version Egret 3.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๅๅซๅฝๅไธๆพ็คบๅฏน่ฑกๅณ่็ๆฏไธชๆปค้ๅฏน่ฑก็็ดขๅผๆฐ็ปใ
             * @version Egret 3.1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$DisplayObject[20 /* filters */];
            },
            set: function (value) {
                var filters = this.$DisplayObject[20 /* filters */];
                if (!filters && !value) {
                    this.$DisplayObject[20 /* filters */] = value;
                    return;
                }
                this.$invalidateContentBounds();
                //้่ฆ้็ฅๅญ้กน
                this.$invalidate(true);
                if (filters && filters.length) {
                    var length_1 = filters.length;
                    for (var i = 0; i < length_1; i++) {
                        filters[i].$removeTarget(this);
                    }
                }
                this.$DisplayObject[20 /* filters */] = value;
                if (value && value.length) {
                    var length_2 = value.length;
                    for (var i = 0; i < length_2; i++) {
                        value[i].$addTarget(this);
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ทๅfilters
         */
        DisplayObject.prototype.$getFilters = function () {
            return this.$DisplayObject[20 /* filters */];
        };
        /**
         * Returns a rectangle that defines the area of the display object relative to the coordinate system of the targetCoordinateSpace object.
         * @param targetCoordinateSpace The display object that defines the coordinate system to use.
         * @param resultRect A reusable instance of Rectangle for saving the results. Passing this parameter can reduce the number of reallocate objects
         *, which allows you to get better code execution performance..
         * @returns The rectangle that defines the area of the display object relative to the targetCoordinateSpace object's coordinate system.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅไธไธช็ฉๅฝข๏ผ่ฏฅ็ฉๅฝขๅฎไน็ธๅฏนไบ targetCoordinateSpace ๅฏน่ฑกๅๆ็ณป็ๆพ็คบๅฏน่ฑกๅบๅใ
         * @param targetCoordinateSpace ๅฎไน่ฆไฝฟ็จ็ๅๆ็ณป็ๆพ็คบๅฏน่ฑกใ
         * @param resultRect ไธไธช็จไบๅญๅจ็ปๆ็ๅฏๅค็จRectangleๅฎไพ๏ผไผๅฅๆญคๅๆฐ่ฝๅคๅๅฐๅ้จๅๅปบๅฏน่ฑก็ๆฌกๆฐ๏ผไป่่ทๅพๆด้ซ็่ฟ่กๆง่ฝใ
         * @returns ๅฎไนไธ targetCoordinateSpace ๅฏน่ฑกๅๆ็ณป็ป็ธๅณ็ๆพ็คบๅฏน่ฑก้ข็งฏ็็ฉๅฝขใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.prototype.getTransformedBounds = function (targetCoordinateSpace, resultRect) {
            targetCoordinateSpace = targetCoordinateSpace || this;
            return this.$getTransformedBounds(targetCoordinateSpace, resultRect);
        };
        /**
         * Obtain measurement boundary of display object
         * @param resultRect {Rectangle} Optional. It is used to import Rectangle object for saving results, preventing duplicate object creation.
         * @param calculateAnchor {boolean} Optional. It is used to determine whether to calculate anchor point.
         * @returns {Rectangle}
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅๆพ็คบๅฏน่ฑก็ๆต้่พน็
         * @param resultRect {Rectangle} ๅฏ้ๅๆฐ๏ผไผๅฅ็จไบไฟๅญ็ปๆ็Rectangleๅฏน่ฑก๏ผ้ฟๅ้ๅคๅๅปบๅฏน่ฑกใ
         * @param calculateAnchor {boolean} ๅฏ้ๅๆฐ๏ผๆฏๅฆไผ่ฎก็ฎ้็นใ
         * @returns {Rectangle}
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.prototype.getBounds = function (resultRect, calculateAnchor) {
            if (calculateAnchor === void 0) {
                calculateAnchor = true;
            }
            resultRect = this.$getTransformedBounds(this, resultRect);
            if (calculateAnchor) {
                var values = this.$DisplayObject;
                if (values[12 /* anchorOffsetX */] != 0 || values[13 /* anchorOffsetY */] != 0) {
                    resultRect.x -= values[12 /* anchorOffsetX */];
                    resultRect.y -= values[13 /* anchorOffsetY */];
                }
            }
            return resultRect;
        };
        /**
         * @private
         */
        DisplayObject.prototype.$getTransformedBounds = function (targetCoordinateSpace, resultRect) {
            var bounds = this.$getOriginalBounds();
            if (!resultRect) {
                resultRect = new egret.Rectangle();
            }
            resultRect.copyFrom(bounds);
            if (targetCoordinateSpace == this) {
                return resultRect;
            }
            var m;
            if (targetCoordinateSpace) {
                m = egret.$TempMatrix;
                var invertedTargetMatrix = targetCoordinateSpace.$getInvertedConcatenatedMatrix();
                invertedTargetMatrix.$preMultiplyInto(this.$getConcatenatedMatrix(), m);
            }
            else {
                m = this.$getConcatenatedMatrix();
            }
            m.$transformBounds(resultRect);
            return resultRect;
        };
        /**
         * Converts the point object from the Stage (global) coordinates to the display object's (local) coordinates.
         * @param stageX the x value in the global coordinates
         * @param stageY the y value in the global coordinates
         * @param resultPoint A reusable instance of Point for saving the results. Passing this parameter can reduce the
         * number of reallocate objects, which allows you to get better code execution performance.
         * @returns A Point object with coordinates relative to the display object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐไป่ๅฐ๏ผๅจๅฑ๏ผๅๆ่ฝฌๆขไธบๆพ็คบๅฏน่ฑก็๏ผๆฌๅฐ๏ผๅๆใ
         * @param stageX ่ๅฐๅๆx
         * @param stageY ่ๅฐๅๆy
         * @param resultPoint ไธไธช็จไบๅญๅจ็ปๆ็ๅฏๅค็จ Point ๅฎไพ๏ผไผๅฅๆญคๅๆฐ่ฝๅคๅๅฐๅ้จๅๅปบๅฏน่ฑก็ๆฌกๆฐ๏ผไป่่ทๅพๆด้ซ็่ฟ่กๆง่ฝใ
         * @returns ๅทๆ็ธๅฏนไบๆพ็คบๅฏน่ฑก็ๅๆ็ Point ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.prototype.globalToLocal = function (stageX, stageY, resultPoint) {
            if (stageX === void 0) {
                stageX = 0;
            }
            if (stageY === void 0) {
                stageY = 0;
            }
            var m = this.$getInvertedConcatenatedMatrix();
            return m.transformPoint(stageX, stageY, resultPoint);
        };
        /**
         * Converts the point object from the display object's (local) coordinates to the Stage (global) coordinates.
         * @param localX the x value in the local coordinates
         * @param localY the x value in the local coordinates
         * @param resultPoint A reusable instance of Point for saving the results. Passing this parameter can reduce the
         * number of reallocate objects, which allows you to get better code execution performance.
         * @returns  A Point object with coordinates relative to the Stage.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆพ็คบๅฏน่ฑก็๏ผๆฌๅฐ๏ผๅๆ่ฝฌๆขไธบ่ๅฐ๏ผๅจๅฑ๏ผๅๆใ
         * @param localX ๆฌๅฐๅๆ x
         * @param localY ๆฌๅฐๅๆ y
         * @param resultPoint ไธไธช็จไบๅญๅจ็ปๆ็ๅฏๅค็จ Point ๅฎไพ๏ผไผๅฅๆญคๅๆฐ่ฝๅคๅๅฐๅ้จๅๅปบๅฏน่ฑก็ๆฌกๆฐ๏ผไป่่ทๅพๆด้ซ็่ฟ่กๆง่ฝใ
         * @returns ไธไธชๅทๆ็ธๅฏนไบ่ๅฐๅๆ็ Point ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.prototype.localToGlobal = function (localX, localY, resultPoint) {
            if (localX === void 0) {
                localX = 0;
            }
            if (localY === void 0) {
                localY = 0;
            }
            var m = this.$getConcatenatedMatrix();
            return m.transformPoint(localX, localY, resultPoint);
        };
        /**
         * @private
         * ๆ่ฎฐ่ช่บซ็ๆต้ๅฐบๅฏธๅคฑๆ
         */
        DisplayObject.prototype.$invalidateContentBounds = function () {
            this.$invalidate();
            this.$setFlags(2 /* InvalidContentBounds */);
            this.$propagateFlagsUp(4 /* InvalidBounds */);
        };
        /**
         * @private
         * ่ทๅๆพ็คบๅฏน่ฑกๅ็จ็็ฉๅฝขๅบๅ้ๅ๏ผ้ๅธธๅๆฌ่ช่บซ็ปๅถ็ๆต้ๅบๅ๏ผๅฆๆๆฏๅฎนๅจ๏ผ่ฟๅๆฌๆๆๅญ้กนๅๆฎ็ๅบๅใ
         */
        DisplayObject.prototype.$getOriginalBounds = function () {
            var bounds = this.$DisplayObject[9 /* bounds */];
            if (this.$hasFlags(4 /* InvalidBounds */)) {
                bounds.copyFrom(this.$getContentBounds());
                this.$measureChildBounds(bounds);
                this.$removeFlags(4 /* InvalidBounds */);
                if (this.$displayList) {
                    this.$displayList.$renderNode.moved = true;
                }
                var offset = this.$measureFiltersOffset(false);
                if (offset) {
                    bounds.x += offset.minX;
                    bounds.y += offset.minY;
                    bounds.width += -offset.minX + offset.maxX;
                    bounds.height += -offset.minY + offset.maxY;
                }
            }
            return bounds;
        };
        /**
         * @private
         * ๆต้ๅญ้กนๅ็จ็็ฉๅฝขๅบๅ
         * @param bounds ๆต้็ปๆๅญๅจๅจ่ฟไธช็ฉๅฝขๅฏน่ฑกๅ
         */
        DisplayObject.prototype.$measureChildBounds = function (bounds) {
        };
        /**
         * @private
         */
        DisplayObject.prototype.$getContentBounds = function () {
            var bounds = this.$DisplayObject[10 /* contentBounds */];
            if (this.$hasFlags(2 /* InvalidContentBounds */)) {
                this.$measureContentBounds(bounds);
                if (this.$renderNode) {
                    this.$renderNode.moved = true;
                }
                this.$removeFlags(2 /* InvalidContentBounds */);
            }
            return bounds;
        };
        /**
         * @private
         * ๆต้่ช่บซๅ็จ็็ฉๅฝขๅบๅ๏ผๆณจๆ๏ผๆญคๆต้็ปๆๅนถไธๅๆฌๅญ้กนๅๆฎ็ๅบๅใ
         * @param bounds ๆต้็ปๆๅญๅจๅจ่ฟไธช็ฉๅฝขๅฏน่ฑกๅ
         */
        DisplayObject.prototype.$measureContentBounds = function (bounds) {
        };
        /**
         * @private
         * ๆ่ฎฐๆญคๆพ็คบๅฏน่ฑก้่ฆ้็ปใๆญคๆนๆณไผ่งฆๅ่ช่บซ็cacheAsBitmap้็ปใๅฆๆๅชๆฏ็ฉ้ตๆนๅ๏ผ่ช่บซๆพ็คบๅๅฎนๅนถไธๆนๅ๏ผๅบ่ฏฅ่ฐ็จ$invalidateTransform().
         * @param notiryChildren ๆฏๅฆๆ่ฎฐๅญ้กนไน้่ฆ้็ปใไผๅฅfalseๆไธไผๅฅ๏ผๅฐๅชๆ่ฎฐ่ช่บซ้่ฆ้็ปใๆณจๆ:ๅฝๅญ้กนcacheๆถไธไผ็ปง็ปญๅไธๆ่ฎฐ
         */
        DisplayObject.prototype.$invalidate = function (notifyChildren) {
            if (!this.$renderNode || this.$hasFlags(256 /* DirtyRender */ | 128 /* InvalidRenderNodes */)) {
                return;
            }
            this.$setFlags(256 /* DirtyRender */ | 128 /* InvalidRenderNodes */);
            var displayList = this.$displayList ? this.$displayList : this.$parentDisplayList;
            if (displayList) {
                displayList.markDirty(this);
            }
        };
        /**
         * @private
         * ๆ่ฎฐ่ช่บซไปฅๅๆๆๅญ้กนๅจ็ถ็บงไธญๅๆขๅๅ็ๆพ็คบๅๅฎนๅคฑๆใๆญคๆนๆณไธไผ่งฆๅ่ช่บซ็cacheAsBitmap้็ปใ
         * ้ๅธธ็จไบ็ฉ้ตๆนๅๆไปๆพ็คบๅ่กจๆทปๅๅ็งป้คๆถใ่ฅ่ช่บซ็ๆพ็คบๅๅฎนๅทฒ็ปๆนๅ้่ฆ้็ป๏ผๅบ่ฏฅ่ฐ็จ$invalidate()ใ
         */
        DisplayObject.prototype.$invalidateTransform = function () {
            var self = this;
            if (self.$hasFlags(512 /* DirtyChildren */)) {
                return;
            }
            self.$setFlags(512 /* DirtyChildren */);
            var displayList = self.$displayList;
            if ((displayList || self.$renderNode) && self.$parentDisplayList) {
                self.$parentDisplayList.markDirty(displayList || self);
            }
        };
        /**
         * @private
         * ่ทๅๆธฒๆ่็น
         */
        DisplayObject.prototype.$getRenderNode = function () {
            var node = this.$renderNode;
            if (!node) {
                return null;
            }
            if (this.$displayFlags & 128 /* InvalidRenderNodes */) {
                node.cleanBeforeRender();
                this.$render();
                this.$removeFlags(128 /* InvalidRenderNodes */);
                node = this.$renderNode;
            }
            return node;
        };
        /**
         * @private
         * ๆดๆฐๅฏน่ฑกๅจ่ๅฐไธ็ๆพ็คบๅบๅ,่ฟๅๆพ็คบๅบๅๆฏๅฆๅ็ๆนๅใ
         */
        DisplayObject.prototype.$update = function (dirtyRegionPolicy, bounds) {
            var self = this;
            self.$removeFlagsUp(768 /* Dirty */);
            var node = self.$renderNode;
            node.renderAlpha = self.$getConcatenatedAlpha();
            //ๅฟ้กปๅจ่ฎฟ้ฎmovedๅฑๆงๅ่ฐ็จไปฅไธไธคไธชๆนๆณ๏ผๅไธบmovedๅฑๆงๅจไปฅไธไธคไธชๆนๆณๅ้็ฝฎใ
            var concatenatedMatrix = self.$getConcatenatedMatrix();
            if (dirtyRegionPolicy == egret.DirtyRegionPolicy.OFF) {
                var displayList = self.$displayList || self.$parentDisplayList;
                if (!displayList) {
                    return false;
                }
                var matrix = node.renderMatrix;
                matrix.copyFrom(concatenatedMatrix);
                var root = displayList.root;
                if (root !== self.$stage) {
                    self.$getConcatenatedMatrixAt(root, matrix);
                }
            }
            else {
                var renderBounds = bounds || self.$getContentBounds();
                node.renderVisible = self.$getConcatenatedVisible();
                var displayList = self.$displayList || self.$parentDisplayList;
                var region = node.renderRegion;
                if (!displayList) {
                    region.setTo(0, 0, 0, 0);
                    node.moved = false;
                    return false;
                }
                if (!node.moved) {
                    return false;
                }
                node.moved = false;
                var matrix = node.renderMatrix;
                matrix.copyFrom(concatenatedMatrix);
                var root = displayList.root;
                if (root !== self.$stage) {
                    self.$getConcatenatedMatrixAt(root, matrix);
                }
                region.updateRegion(renderBounds, matrix);
                var offset = self.$measureFiltersOffset(true);
                if (offset) {
                    region.minX += offset.minX;
                    region.minY += offset.minY;
                    region.maxX += offset.maxX;
                    region.maxY += offset.maxY;
                    region.updateArea();
                }
            }
            return true;
        };
        /**
         * @private
         */
        DisplayObject.prototype.$measureFiltersOffset = function (fromParent) {
            var display = this;
            var minX = 0;
            var minY = 0;
            var maxX = 0;
            var maxY = 0;
            while (display) {
                var filters = display.$DisplayObject[20 /* filters */];
                if (filters && filters.length) {
                    var length_3 = filters.length;
                    for (var i = 0; i < length_3; i++) {
                        var filter = filters[i];
                        //todo ็ผๅญ่ฟไธชๆฐๆฎ
                        if (filter.type == "blur") {
                            var offsetX = filter.blurX;
                            var offsetY = filter.blurY;
                            minX -= offsetX;
                            minY -= offsetY;
                            maxX += offsetX;
                            maxY += offsetY;
                        }
                        else if (filter.type == "glow") {
                            var offsetX = filter.blurX;
                            var offsetY = filter.blurY;
                            minX -= offsetX;
                            minY -= offsetY;
                            maxX += offsetX;
                            maxY += offsetY;
                            var distance = filter.distance || 0;
                            var angle = filter.angle || 0;
                            var distanceX = 0;
                            var distanceY = 0;
                            if (distance != 0) {
                                distanceX = distance * egret.NumberUtils.cos(angle);
                                if (distanceX > 0) {
                                    distanceX = Math.ceil(distanceX);
                                }
                                else {
                                    distanceX = Math.floor(distanceX);
                                }
                                distanceY = distance * egret.NumberUtils.sin(angle);
                                if (distanceY > 0) {
                                    distanceY = Math.ceil(distanceY);
                                }
                                else {
                                    distanceY = Math.floor(distanceY);
                                }
                                minX += distanceX;
                                maxX += distanceX;
                                minY += distanceY;
                                maxY += distanceY;
                            }
                        }
                        else if (filter.type == "custom") {
                            var padding = filter.padding;
                            minX -= padding;
                            minY -= padding;
                            maxX += padding;
                            maxY += padding;
                        }
                    }
                }
                if (fromParent) {
                    display = display.$parent;
                }
                else {
                    display = null;
                }
            }
            minX = Math.min(minX, 0);
            minY = Math.min(minY, 0);
            maxX = Math.max(maxX, 0);
            maxY = Math.max(maxY, 0);
            return { minX: minX, minY: minY, maxX: maxX, maxY: maxY };
        };
        /**
         * @private
         * ่ทๅ็ธๅฏนไบๆๅฎๆน่็น็่ฟๆฅ็ฉ้ตใ
         * @param root ๆน่็นๆพ็คบๅฏน่ฑก
         * @param matrix ็ฎๆๆพ็คบๅฏน่ฑก็ธๅฏนไบ่ๅฐ็ๅฎๆด่ฟๆฅ็ฉ้ตใ
         */
        DisplayObject.prototype.$getConcatenatedMatrixAt = function (root, matrix) {
            var invertMatrix = root.$getInvertedConcatenatedMatrix();
            if (invertMatrix.a === 0 || invertMatrix.d === 0) {
                var target = this;
                var rootLevel = root.$nestLevel;
                matrix.identity();
                while (target.$nestLevel > rootLevel) {
                    var rect = target.$scrollRect;
                    if (rect) {
                        matrix.concat(egret.$TempMatrix.setTo(1, 0, 0, 1, -rect.x, -rect.y));
                    }
                    matrix.concat(target.$getMatrix());
                    target = target.$parent;
                }
            }
            else {
                invertMatrix.$preMultiplyInto(matrix, matrix);
            }
        };
        DisplayObject.prototype.$getConcatenatedAlphaAt = function (root, alpha) {
            var rootAlpha = root.$getConcatenatedAlpha();
            if (rootAlpha === 0) {
                alpha = 1;
                var target = this;
                var rootLevel = root.$nestLevel;
                while (target.$nestLevel > rootLevel) {
                    alpha *= target.$alpha;
                    target = target.$parent;
                }
            }
            else {
                alpha /= rootAlpha;
            }
            return alpha;
        };
        /**
         * @private
         * ๆง่กๆธฒๆ,็ปๅถ่ช่บซๅฐๅฑๅน
         */
        DisplayObject.prototype.$render = function () {
        };
        /**
         * @private
         */
        DisplayObject.prototype.$hitTest = function (stageX, stageY) {
            var values = this.$DisplayObject;
            if (!this.$renderNode || !this.$visible || values[0 /* scaleX */] == 0 || values[1 /* scaleY */] == 0) {
                return null;
            }
            var m = this.$getInvertedConcatenatedMatrix();
            if (m.a == 0 && m.b == 0 && m.c == 0 && m.d == 0) {
                return null;
            }
            var bounds = this.$getContentBounds();
            var localX = m.a * stageX + m.c * stageY + m.tx;
            var localY = m.b * stageX + m.d * stageY + m.ty;
            if (bounds.contains(localX, localY)) {
                if (!this.$children) {
                    var rect = this.$scrollRect ? this.$scrollRect : this.$maskRect;
                    if (rect && !rect.contains(localX, localY)) {
                        return null;
                    }
                    if (this.$mask && !this.$mask.$hitTest(stageX, stageY)) {
                        return null;
                    }
                }
                return this;
            }
            return null;
        };
        /**
         * Calculate the display object to determine whether it overlaps or crosses with the points specified by the x and y parameters. The x and y parameters specify the points in the coordinates of the stage, rather than the points in the display object container that contains display objects (except the situation where the display object container is a stage).
         * Note: Don't use accurate pixel collision detection on a large number of objects. Otherwise, this will cause serious performance deterioration.
         * @param x {number}  x coordinate of the object to be tested.
         * @param y {number}  y coordinate of the object to be tested.
         * @param shapeFlag {boolean} Whether to check the actual pixel of object (true) or check that of border (false).Write realized.
         * @returns {boolean} If display object overlaps or crosses with the specified point, it is true; otherwise, it is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎก็ฎๆพ็คบๅฏน่ฑก๏ผไปฅ็กฎๅฎๅฎๆฏๅฆไธ x ๅ y ๅๆฐๆๅฎ็็น้ๅๆ็ธไบคใx ๅ y ๅๆฐๆๅฎ่ๅฐ็ๅๆ็ฉบ้ดไธญ็็น๏ผ่ไธๆฏๅๅซๆพ็คบๅฏน่ฑก็ๆพ็คบๅฏน่ฑกๅฎนๅจไธญ็็น๏ผ้ค้ๆพ็คบๅฏน่ฑกๅฎนๅจๆฏ่ๅฐ๏ผใ
         * ๆณจๆ๏ผไธ่ฆๅจๅคง้็ฉไฝไธญไฝฟ็จ็ฒพ็กฎ็ขฐๆๅ็ดๆฃๆต๏ผ่ฟๅๅธฆๆฅๅทจๅคง็ๆง่ฝๅผ้
         * @param x {number}  ่ฆๆต่ฏ็ๆญคๅฏน่ฑก็ x ๅๆใ
         * @param y {number}  ่ฆๆต่ฏ็ๆญคๅฏน่ฑก็ y ๅๆใ
         * @param shapeFlag {boolean} ๆฏๆฃๆฅๅฏน่ฑก (true) ็ๅฎ้ๅ็ด๏ผ่ฟๆฏๆฃๆฅ่พนๆก (false) ็ๅฎ้ๅ็ดใ
         * @returns {boolean} ๅฆๆๆพ็คบๅฏน่ฑกไธๆๅฎ็็น้ๅๆ็ธไบค๏ผๅไธบ true๏ผๅฆๅไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.prototype.hitTestPoint = function (x, y, shapeFlag) {
            if (!shapeFlag) {
                var values = this.$DisplayObject;
                if (values[0 /* scaleX */] == 0 || values[1 /* scaleY */] == 0) {
                    return false;
                }
                var m = this.$getInvertedConcatenatedMatrix();
                var bounds = this.getBounds(null, false);
                var localX = m.a * x + m.c * y + m.tx;
                var localY = m.b * x + m.d * y + m.ty;
                if (bounds.contains(localX, localY)) {
                    //่ฟ้ไธ่่่ฎพ็ฝฎmask็ๆๅต
                    var rect = this.$scrollRect ? this.$scrollRect : this.$maskRect;
                    if (rect && !rect.contains(localX, localY)) {
                        return false;
                    }
                    return true;
                }
                return false;
            }
            else {
                var m = this.$getInvertedConcatenatedMatrix();
                var localX = m.a * x + m.c * y + m.tx;
                var localY = m.b * x + m.d * y + m.ty;
                var data = void 0;
                var displayList = this.$displayList;
                if (displayList) {
                    var buffer = displayList.renderBuffer;
                    try {
                        data = buffer.getPixels(localX - displayList.offsetX, localY - displayList.offsetY);
                    }
                    catch (e) {
                        throw new Error(egret.sys.tr(1039));
                    }
                }
                else {
                    var buffer = egret.sys.customHitTestBuffer;
                    buffer.resize(3, 3);
                    var matrix = egret.Matrix.create();
                    matrix.identity();
                    matrix.translate(1 - localX, 1 - localY);
                    egret.sys.systemRenderer.render(this, buffer, matrix, null, true);
                    egret.Matrix.release(matrix);
                    try {
                        data = buffer.getPixels(1, 1);
                    }
                    catch (e) {
                        throw new Error(egret.sys.tr(1039));
                    }
                }
                if (data[3] === 0) {
                    return false;
                }
                return true;
            }
        };
        /**
         * @private
         */
        DisplayObject.prototype.$addListener = function (type, listener, thisObject, useCapture, priority, dispatchOnce) {
            _super.prototype.$addListener.call(this, type, listener, thisObject, useCapture, priority, dispatchOnce);
            var isEnterFrame = (type == egret.Event.ENTER_FRAME);
            if (isEnterFrame || type == egret.Event.RENDER) {
                var list = isEnterFrame ? DisplayObject.$enterFrameCallBackList : DisplayObject.$renderCallBackList;
                if (list.indexOf(this) == -1) {
                    list.push(this);
                }
            }
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        DisplayObject.prototype.removeEventListener = function (type, listener, thisObject, useCapture) {
            _super.prototype.removeEventListener.call(this, type, listener, thisObject, useCapture);
            var isEnterFrame = (type == egret.Event.ENTER_FRAME);
            if ((isEnterFrame || type == egret.Event.RENDER) && !this.hasEventListener(type)) {
                var list = isEnterFrame ? DisplayObject.$enterFrameCallBackList : DisplayObject.$renderCallBackList;
                var index = list.indexOf(this);
                if (index !== -1) {
                    list.splice(index, 1);
                }
            }
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        DisplayObject.prototype.dispatchEvent = function (event) {
            if (!event.$bubbles) {
                return _super.prototype.dispatchEvent.call(this, event);
            }
            var list = this.$getPropagationList(this);
            var targetIndex = list.length * 0.5;
            event.$setTarget(this);
            this.$dispatchPropagationEvent(event, list, targetIndex);
            return !event.$isDefaultPrevented;
        };
        /**
         * @private
         * ่ทๅไบไปถๆตๅ่กจใๆณจๆ๏ผEgretๆกๆถ็ไบไปถๆตไธFlashๅฎ็ฐๅนถไธไธ่ดใ
         *
         * ไบไปถๆตๆไธไธช้ถๆฎต๏ผๆ่ท๏ผ็ฎๆ๏ผๅๆณกใ
         * Flash้้ป่ฎค็็ไบไปถ็ๅฌ่ฅไธๅผๅฏuseCaptureๅฐ็ๅฌ็ฎๆๅๅๆณก้ถๆฎตใ่ฅๅผๅงcaptureๅฐๅช่ฝ็ๅฌๆ่ทๅฝไธๅๆฌ็ฎๆ็ไบไปถใ
         * ๅฏไปฅๅจFlashไธญๅไธไธช็ฎๅ็ๆต่ฏ๏ผๅฎไพๅไธไธช้ๅฎนๅจๆพ็คบๅฏน่ฑก๏ผไพๅฆTextFieldใๅๅซ็ๅฌuseCaptureไธบtrueๅfalseๆถ็้ผๆไบไปถใ
         * ็นๅปๅๅฐๅชๆuseCaptureไธบfalse็ๅ่ฐๅฝๆฐ่พๅบไฟกๆฏใไนๅฐฑๅธฆๆฅไธไธช้ฎ้ขใFlash็ๆ่ท้ถๆฎตไธ่ฝ็ๅฌๅฐๆๅๅฑๅฏน่ฑกๆฌ่บซ๏ผๅชๅจ็ถ็บงๅ่กจๆๆใใ
         *
         * ่HTML้็ไบไปถๆต่ฎพ็ฝฎuseCaptureไธบtrueๆถๆฏ่ฝ็ๅฌๅฐ็ฎๆ้ถๆฎต็๏ผไนๅฐฑๆฏ็ฎๆ้ถๆฎตไผ่ขซ่งฆๅไธคๆฌก๏ผๅจๆ่ทๅๅๆณก่ฟ็จๅ่งฆๅไธๆฌกใ่ฟๆทๅฏไปฅ้ฟๅ
         * ๅ้ขๆๅฐ็็ๅฌๆ่ทๆๆณ็ๅฌ็ฎๆๆฌ่บซ็้ฎ้ขใ
         *
         * Egretๆ็ป้็จไบHTML้็ฎๆ่็น่งฆๅไธคๆฌก็ไบไปถๆตๆนๅผใ
         */
        DisplayObject.prototype.$getPropagationList = function (target) {
            var list = [];
            while (target) {
                list.push(target);
                target = target.$parent;
            }
            var captureList = list.concat();
            captureList.reverse(); //ไฝฟ็จไธๆฌกreverse()ๆนๆณๆฏๅคๆฌก่ฐ็จunshift()ๆง่ฝ้ซใ
            list = captureList.concat(list);
            return list;
        };
        /**
         * @private
         */
        DisplayObject.prototype.$dispatchPropagationEvent = function (event, list, targetIndex) {
            var length = list.length;
            var captureIndex = targetIndex - 1;
            for (var i = 0; i < length; i++) {
                var currentTarget = list[i];
                event.$currentTarget = currentTarget;
                if (i < captureIndex)
                    event.$eventPhase = 1 /* CAPTURING_PHASE */;
                else if (i == targetIndex || i == captureIndex)
                    event.$eventPhase = 2 /* AT_TARGET */;
                else
                    event.$eventPhase = 3 /* BUBBLING_PHASE */;
                currentTarget.$notifyListener(event, i < targetIndex);
                if (event.$isPropagationStopped || event.$isPropagationImmediateStopped) {
                    return;
                }
            }
        };
        /**
         * @inheritDoc
         * @version Egret 2.4
         * @platform Web,Native
         */
        DisplayObject.prototype.willTrigger = function (type) {
            var parent = this;
            while (parent) {
                if (parent.hasEventListener(type))
                    return true;
                parent = parent.$parent;
            }
            return false;
        };
        /**
         * @private
         * The default touchEnabled property of DisplayObject
         * @default false
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * @private
         * ๆพ็คบๅฏน่ฑก้ป่ฎค็ touchEnabled ๅฑๆง
         * @default false
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObject.defaultTouchEnabled = false;
        DisplayObject.boundsForUpdate = new egret.Rectangle();
        /**
         * @private
         */
        DisplayObject.$enterFrameCallBackList = [];
        /**
         * @private
         */
        DisplayObject.$renderCallBackList = [];
        return DisplayObject;
    }(egret.EventDispatcher));
    egret.DisplayObject = DisplayObject;
    __reflect(DisplayObject.prototype, "egret.DisplayObject", ["egret.sys.Renderable"]);
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The DisplayObjectContainer class is a basic display list building block: a display list node that can contain children.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/DisplayObjectContainer.ts
     * @language en_US
     */
    /**
     * DisplayObjectContainer ็ฑปๆฏๅบๆฌๆพ็คบๅ่กจๆ้ๅ๏ผไธไธชๅฏๅๅซๅญ้กน็ๆพ็คบๅ่กจ่็นใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/DisplayObjectContainer.ts
     * @language zh_CN
     */
    var DisplayObjectContainer = (function (_super) {
        __extends(DisplayObjectContainer, _super);
        /**
         * Creates a new DisplayObjectContainer instance.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฎไพๅไธไธชๅฎนๅจ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function DisplayObjectContainer() {
            var _this = _super.call(this) || this;
            _this.$touchChildren = true;
            _this.$children = [];
            return _this;
        }
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$propagateFlagsDown = function (flags) {
            if (this.$hasFlags(flags)) {
                return;
            }
            this.$setFlags(flags);
            var children = this.$children;
            var length = children.length;
            for (var i = 0; i < length; i++) {
                children[i].$propagateFlagsDown(flags);
            }
        };
        Object.defineProperty(DisplayObjectContainer.prototype, "numChildren", {
            /**
             * Returns the number of children of this object.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฟๅๆญคๅฏน่ฑก็ๅญ้กนๆฐ็ฎใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$children.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Adds a child DisplayObject instance to this DisplayObjectContainer instance. The child is added to the front
         * (top) of all other children in this DisplayObjectContainer instance. (To add a child to a specific index position,
         * use the addChildAt() method.)If you add a child object that already has a different display object container
         * as a parent, the object is removed from the child list of the other display object container.
         * @param child The DisplayObject instance to add as a child of this DisplayObjectContainer instance.
         * @returns ๅจ child The DisplayObject instance that you pass in the child parameter.
         * @see #addChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐไธไธช DisplayObject ๅญๅฎไพๆทปๅๅฐ่ฏฅ DisplayObjectContainer ๅฎไพไธญใๅญ้กนๅฐ่ขซๆทปๅๅฐ่ฏฅ DisplayObjectContainer ๅฎไพไธญๅถไป
         * ๆๆๅญ้กน็ๅ๏ผไธ๏ผ้ขใ๏ผ่ฆๅฐๆๅญ้กนๆทปๅๅฐ็นๅฎ็ดขๅผไฝ็ฝฎ๏ผ่ฏทไฝฟ็จ addChildAt() ๆนๆณใ๏ผ
         * @param child ่ฆไฝไธบ่ฏฅ DisplayObjectContainer ๅฎไพ็ๅญ้กนๆทปๅ็ DisplayObject ๅฎไพใ
         * @returns ๅจ child ๅๆฐไธญไผ้็ DisplayObject ๅฎไพใ
         * @see #addChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.addChild = function (child) {
            var index = this.$children.length;
            if (child.$parent == this)
                index--;
            return this.$doAddChild(child, index);
        };
        /**
         * Adds a child DisplayObject instance to this DisplayObjectContainer instance. The child is added at the index position
         * specified. An index of 0 represents the back (bottom) of the display list for this DisplayObjectContainer object.
         * If you add a child object that already has a different display object container as a parent, the object is removed
         * from the child list of the other display object container.
         * @param child The DisplayObject instance to add as a child of this DisplayObjectContainer instance.
         * @param index The index position to which the child is added. If you specify a currently occupied index position,
         * the child object that exists at that position and all higher positions are moved up one position in the child list.
         * @returns The DisplayObject instance that you pass in the child parameter.
         * @see #addChild()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐไธไธช DisplayObject ๅญๅฎไพๆทปๅๅฐ่ฏฅ DisplayObjectContainer ๅฎไพไธญใ่ฏฅๅญ้กนๅฐ่ขซๆทปๅๅฐๆๅฎ็็ดขๅผไฝ็ฝฎใ็ดขๅผไธบ 0 ่กจ็คบ่ฏฅ
         * DisplayObjectContainer ๅฏน่ฑก็ๆพ็คบๅ่กจ็ๅ๏ผๅบ๏ผ้จใๅฆๆๆทปๅไธไธชๅทฒๅฐๅถๅฎๆพ็คบๅฏน่ฑกๅฎนๅจไฝไธบ็ถ้กน็ๅญๅฏน่ฑก๏ผๅไผไปๅถๅฎๆพ็คบๅฏน่ฑกๅฎนๅจ็ๅญๅ่กจไธญๅ้ค่ฏฅๅฏน่ฑกใ
         * @param child ่ฆไฝไธบ่ฏฅ DisplayObjectContainer ๅฎไพ็ๅญ้กนๆทปๅ็ DisplayObject ๅฎไพใ
         * @param index ๆทปๅ่ฏฅๅญ้กน็็ดขๅผไฝ็ฝฎใ ๅฆๆๆๅฎๅฝๅๅ็จ็็ดขๅผไฝ็ฝฎ๏ผๅ่ฏฅไฝ็ฝฎไปฅๅๆๆๆด้ซไฝ็ฝฎไธ็ๅญๅฏน่ฑกไผๅจๅญ็บงๅ่กจไธญไธ็งปไธไธชไฝ็ฝฎใ
         * @returns ๅจ child ๅๆฐไธญไผ้็ DisplayObject ๅฎไพใ
         * @see #addChild()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.addChildAt = function (child, index) {
            index = +index | 0;
            if (index < 0 || index >= this.$children.length) {
                index = this.$children.length;
                if (child.$parent == this) {
                    index--;
                }
            }
            return this.$doAddChild(child, index);
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$doAddChild = function (child, index, notifyListeners) {
            if (notifyListeners === void 0) {
                notifyListeners = true;
            }
            if (true) {
                if (child == this) {
                    egret.$error(1005);
                }
                else if ((child instanceof egret.DisplayObjectContainer) && child.contains(this)) {
                    egret.$error(1004);
                }
            }
            var host = child.$parent;
            if (host == this) {
                this.doSetChildIndex(child, index);
                return child;
            }
            if (host) {
                host.removeChild(child);
            }
            this.$children.splice(index, 0, child);
            child.$setParent(this);
            var stage = this.$stage;
            if (stage) {
                child.$onAddToStage(stage, this.$nestLevel + 1);
            }
            if (notifyListeners) {
                child.dispatchEventWith(egret.Event.ADDED, true);
            }
            if (stage) {
                var list = DisplayObjectContainer.$EVENT_ADD_TO_STAGE_LIST;
                while (list.length) {
                    var childAddToStage = list.shift();
                    if (childAddToStage.$stage && notifyListeners) {
                        childAddToStage.dispatchEventWith(egret.Event.ADDED_TO_STAGE);
                    }
                }
            }
            var displayList = this.$displayList || this.$parentDisplayList;
            this.assignParentDisplayList(child, displayList, displayList);
            child.$propagateFlagsDown(1648 /* DownOnAddedOrRemoved */);
            this.$propagateFlagsUp(4 /* InvalidBounds */);
            this.$childAdded(child, index);
            return child;
        };
        /**
         * Determines whether the specified display object is a child of the DisplayObjectContainer instance or the instance
         * itself. The search includes the entire display list including this DisplayObjectContainer instance. Grandchildren,
         * great-grandchildren, and so on each return true.
         * @param child The child object to test.
         * @returns true if the child object is a child of the DisplayObjectContainer or the container itself; otherwise false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎๆๅฎๆพ็คบๅฏน่ฑกๆฏ DisplayObjectContainer ๅฎไพ็ๅญ้กน่ฟๆฏ่ฏฅๅฎไพๆฌ่บซใๆ็ดขๅๆฌๆดไธชๆพ็คบๅ่กจ๏ผๅถไธญๅๆฌๆญค DisplayObjectContainer ๅฎไพ๏ผใ
         * ๅญ้กนใๆพๅญ้กน็ญ๏ผๆฏ้กน้ฝ่ฟๅ trueใ
         * @param child ่ฆๆต่ฏ็ๅญๅฏน่ฑกใ
         * @returns ๅฆๆๆๅฎ็ๆพ็คบๅฏน่ฑกไธบ DisplayObjectContainer ่ฏฅๅฎไพๆฌ่บซ๏ผๅ่ฟๅtrue๏ผๅฆๆๆๅฎ็ๆพ็คบๅฏน่ฑกไธบๅฝๅๅฎไพๅญ้กน๏ผๅ่ฟๅfalseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.contains = function (child) {
            while (child) {
                if (child == this) {
                    return true;
                }
                child = child.$parent;
            }
            return false;
        };
        /**
         * Returns the child display object instance that exists at the specified index.
         * @param index The index position of the child object.
         * @returns The child display object at the specified index position.
         * @see #getChildByName()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅไฝไบๆๅฎ็ดขๅผๅค็ๅญๆพ็คบๅฏน่ฑกๅฎไพใ
         * @param index ๅญๅฏน่ฑก็็ดขๅผไฝ็ฝฎใ
         * @returns ไฝไบๆๅฎ็ดขๅผไฝ็ฝฎๅค็ๅญๆพ็คบๅฏน่ฑกใ
         * @see #getChildByName()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.getChildAt = function (index) {
            index = +index | 0;
            if (index >= 0 && index < this.$children.length) {
                return this.$children[index];
            }
            else {
                true && egret.$error(1007);
                return null;
            }
        };
        /**
         * Returns the index position of a child DisplayObject instance.
         * @param child The DisplayObject instance to identify.
         * @returns The index position of the child display object to identify.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅ DisplayObject ็ child ๅฎไพ็็ดขๅผไฝ็ฝฎใ
         * @param child ่ฆๆต่ฏ็ๅญๅฏน่ฑกใ
         * @returns ่ฆๆฅๆพ็ๅญๆพ็คบๅฏน่ฑก็็ดขๅผไฝ็ฝฎใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.getChildIndex = function (child) {
            return this.$children.indexOf(child);
        };
        /**
         * Returns the child display object that exists with the specified name. If more that one child display object has
         * the specified name, the method returns the first object in the child list.The getChildAt() method is faster than
         * the getChildByName() method. The getChildAt() method accesses a child from a cached array, whereas the getChildByName()
         * method has to traverse a linked list to access a child.
         * @param name The name of the child to return.
         * @returns The child display object with the specified name.
         * @see #getChildAt()
         * @see egret.DisplayObject#name
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๅทๆๆๅฎๅ็งฐ็ๅญๆพ็คบๅฏน่ฑกใๅฆๆๅคไธชๅญๆพ็คบๅฏน่ฑกๅทๆๆๅฎๅ็งฐ๏ผๅ่ฏฅๆนๆณไผ่ฟๅๅญ็บงๅ่กจไธญ็็ฌฌไธไธชๅฏน่ฑกใ
         * getChildAt() ๆนๆณๆฏ getChildByName() ๆนๆณๅฟซใgetChildAt() ๆนๆณไป็ผๅญๆฐ็ปไธญ่ฎฟ้ฎๅญ้กน๏ผ่ getChildByName() ๆนๆณๅๅฟ้กป้ๅ้พๆฅ็ๅ่กจๆฅ่ฎฟ้ฎๅญ้กนใ
         * @param name ่ฆ่ฟๅ็ๅญ้กน็ๅ็งฐใ
         * @returns ๅทๆๆๅฎๅ็งฐ็ๅญๆพ็คบๅฏน่ฑกใ
         * @see #getChildAt()
         * @see egret.DisplayObject#name
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.getChildByName = function (name) {
            var children = this.$children;
            var length = children.length;
            var displayObject;
            for (var i = 0; i < length; i++) {
                displayObject = children[i];
                if (displayObject.name == name) {
                    return displayObject;
                }
            }
            return null;
        };
        /**
         * Removes the specified child DisplayObject instance from the child list of the DisplayObjectContainer instance.
         * The parent property of the removed child is set to null , and the object is garbage collected if no other references
         * to the child exist. The index positions of any display objects above the child in the DisplayObjectContainer are
         * decreased by 1.
         * @param child The DisplayObject instance to remove.
         * @returns The DisplayObject instance that you pass in the child parameter.
         * @see #removeChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไป DisplayObjectContainer ๅฎไพ็ๅญๅ่กจไธญๅ้คๆๅฎ็ child DisplayObject ๅฎไพใๅฐๅทฒๅ้คๅญ้กน็ parent ๅฑๆง่ฎพ็ฝฎไธบ null๏ผ
         * ๅฆๆไธๅญๅจๅฏน่ฏฅๅญ้กน็ไปปไฝๅถๅฎๅผ็จ๏ผๅๅฐ่ฏฅๅฏน่ฑกไฝไธบๅๅพๅๆถใDisplayObjectContainer ไธญ่ฏฅๅญ้กนไนไธ็ไปปไฝๆพ็คบๅฏน่ฑก็็ดขๅผไฝ็ฝฎ้ฝๅๅป 1ใ
         * @param child ่ฆๅ้ค็ DisplayObject ๅฎไพใ
         * @returns ๅจ child ๅๆฐไธญไผ้็ DisplayObject ๅฎไพใ
         * @see #removeChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.removeChild = function (child) {
            var index = this.$children.indexOf(child);
            if (index >= 0) {
                return this.$doRemoveChild(index);
            }
            else {
                true && egret.$error(1006);
                return null;
            }
        };
        /**
         * Removes a child DisplayObject from the specified index position in the child list of the DisplayObjectContainer.
         * The parent property of the removed child is set to null, and the object is garbage collected if no other references
         * to the child exist. The index positions of any display objects above the child in the DisplayObjectContainer are decreased by 1.
         * @param index The child index of the DisplayObject to remove.
         * @returns The DisplayObject instance that was removed.
         * @see #removeChild()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไป DisplayObjectContainer ็ๅญๅ่กจไธญๆๅฎ็ index ไฝ็ฝฎๅ้คๅญ DisplayObjectใๅฐๅทฒๅ้คๅญ้กน็ parent ๅฑๆง่ฎพ็ฝฎไธบ null๏ผ
         * ๅฆๆๆฒกๆๅฏน่ฏฅๅญ้กน็ไปปไฝๅถไปๅผ็จ๏ผๅๅฐ่ฏฅๅฏน่ฑกไฝไธบๅๅพๅๆถใDisplayObjectContainer ไธญ่ฏฅๅญ้กนไนไธ็ไปปไฝๆพ็คบๅฏน่ฑก็็ดขๅผไฝ็ฝฎ้ฝๅๅป 1ใ
         * @param index ่ฆๅ้ค็ DisplayObject ็ๅญ็ดขๅผใ
         * @returns ๅทฒๅ้ค็ DisplayObject ๅฎไพใ
         * @see #removeChild()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.removeChildAt = function (index) {
            index = +index | 0;
            if (index >= 0 && index < this.$children.length) {
                return this.$doRemoveChild(index);
            }
            else {
                true && egret.$error(1007);
                return null;
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$doRemoveChild = function (index, notifyListeners) {
            if (notifyListeners === void 0) {
                notifyListeners = true;
            }
            index = +index | 0;
            var children = this.$children;
            var child = children[index];
            this.$childRemoved(child, index);
            if (notifyListeners) {
                child.dispatchEventWith(egret.Event.REMOVED, true);
            }
            if (this.$stage) {
                child.$onRemoveFromStage();
                var list = DisplayObjectContainer.$EVENT_REMOVE_FROM_STAGE_LIST;
                while (list.length > 0) {
                    var childAddToStage = list.shift();
                    if (notifyListeners && childAddToStage.$hasAddToStage) {
                        childAddToStage.$hasAddToStage = false;
                        childAddToStage.dispatchEventWith(egret.Event.REMOVED_FROM_STAGE);
                    }
                    childAddToStage.$hasAddToStage = false;
                    childAddToStage.$stage = null;
                }
            }
            var displayList = this.$displayList || this.$parentDisplayList;
            this.assignParentDisplayList(child, displayList, null);
            child.$propagateFlagsDown(1648 /* DownOnAddedOrRemoved */);
            child.$setParent(null);
            var indexNow = children.indexOf(child);
            if (indexNow != -1) {
                children.splice(indexNow, 1);
            }
            this.$propagateFlagsUp(4 /* InvalidBounds */);
            return child;
        };
        /**
         * Changes the position of an existing child in the display object container. This affects the layering of child objects.
         * @param child The child DisplayObject instance for which you want to change the index number.
         * @param index The resulting index number for the child display object.
         * @see #addChildAt()
         * @see #getChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆน็ฐๆๅญ้กนๅจๆพ็คบๅฏน่ฑกๅฎนๅจไธญ็ไฝ็ฝฎใ่ฟไผๅฝฑๅๅญๅฏน่ฑก็ๅๅฑใ
         * @param child ่ฆไธบๅถๆดๆน็ดขๅผ็ผๅท็ DisplayObject ๅญๅฎไพใ
         * @param index ็ๆ็ child ๆพ็คบๅฏน่ฑก็็ดขๅผ็ผๅทใๅฝๆฐ็็ดขๅผ็ผๅทๅฐไบ0ๆๅคงไบๅทฒๆๅญๅไปถๆฐ้ๆถ๏ผๆฐๅๅฅ็DisplayObjectๅฏน่ฑกๅฐไผๆพ็ฝฎไบๆไธๅฑใ
         * @see #addChildAt()
         * @see #getChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.setChildIndex = function (child, index) {
            index = +index | 0;
            if (index < 0 || index >= this.$children.length) {
                index = this.$children.length - 1;
            }
            this.doSetChildIndex(child, index);
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.doSetChildIndex = function (child, index) {
            var lastIndex = this.$children.indexOf(child);
            if (lastIndex < 0) {
                true && egret.$error(1006);
            }
            if (lastIndex == index) {
                return;
            }
            this.$childRemoved(child, lastIndex);
            //ไปๅๆฅ็ไฝ็ฝฎๅ้ค
            this.$children.splice(lastIndex, 1);
            //ๆพๅฐๆฐ็ไฝ็ฝฎ
            this.$children.splice(index, 0, child);
            this.$childAdded(child, index);
            child.$invalidateTransform();
            this.$propagateFlagsUp(4 /* InvalidBounds */);
        };
        /**
         * Swaps the z-order (front-to-back order) of the child objects at the two specified index positions in the child
         * list. All other child objects in the display object container remain in the same index positions.
         * @param index1 The index position of the first child object.
         * @param index2 The index position of the second child object.
         * @see #swapChildren()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ็บงๅ่กจไธญไธคไธชๆๅฎ็็ดขๅผไฝ็ฝฎ๏ผไบคๆขๅญๅฏน่ฑก็ Z ่ฝด้กบๅบ๏ผๅๅ้กบๅบ๏ผใๆพ็คบๅฏน่ฑกๅฎนๅจไธญๆๆๅถไปๅญๅฏน่ฑก็็ดขๅผไฝ็ฝฎไฟๆไธๅใ
         * @param index1 ็ฌฌไธไธชๅญๅฏน่ฑก็็ดขๅผไฝ็ฝฎใ
         * @param index2 ็ฌฌไบไธชๅญๅฏน่ฑก็็ดขๅผไฝ็ฝฎใ
         * @see #swapChildren()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.swapChildrenAt = function (index1, index2) {
            index1 = +index1 | 0;
            index2 = +index2 | 0;
            if (index1 >= 0 && index1 < this.$children.length && index2 >= 0 && index2 < this.$children.length) {
                this.doSwapChildrenAt(index1, index2);
            }
            else {
                true && egret.$error(1007);
            }
        };
        /**
         * Swaps the z-order (front-to-back order) of the two specified child objects. All other child objects in the
         * display object container remain in the same index positions.
         * @param child1 The first child object.
         * @param child2 The second child object.
         * @see #swapChildrenAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไบคๆขไธคไธชๆๅฎๅญๅฏน่ฑก็ Z ่ฝด้กบๅบ๏ผไปๅๅฐๅ้กบๅบ๏ผใๆพ็คบๅฏน่ฑกๅฎนๅจไธญๆๆๅถไปๅญๅฏน่ฑก็็ดขๅผไฝ็ฝฎไฟๆไธๅใ
         * @param child1 ็ฌฌไธไธชๅญๅฏน่ฑกใ
         * @param child2 ็ฌฌไบไธชๅญๅฏน่ฑกใ
         * @see #swapChildrenAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.swapChildren = function (child1, child2) {
            var index1 = this.$children.indexOf(child1);
            var index2 = this.$children.indexOf(child2);
            if (index1 == -1 || index2 == -1) {
                true && egret.$error(1006);
            }
            else {
                this.doSwapChildrenAt(index1, index2);
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.doSwapChildrenAt = function (index1, index2) {
            if (index1 > index2) {
                var temp = index2;
                index2 = index1;
                index1 = temp;
            }
            else if (index1 == index2) {
                return;
            }
            var list = this.$children;
            var child1 = list[index1];
            var child2 = list[index2];
            this.$childRemoved(child1, index1);
            this.$childRemoved(child2, index2);
            list[index1] = child2;
            list[index2] = child1;
            this.$childAdded(child2, index1);
            this.$childAdded(child1, index2);
            child1.$invalidateTransform();
            child2.$invalidateTransform();
            this.$propagateFlagsUp(4 /* InvalidBounds */);
        };
        /**
         * Removes all child DisplayObject instances from the child list of the DisplayObjectContainer instance. The parent
         * property of the removed children is set to null , and the objects are garbage collected if no other references to the children exist.
         * @see #removeChild()
         * @see #removeChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไป DisplayObjectContainer ๅฎไพ็ๅญ็บงๅ่กจไธญๅ้คๆๆ child DisplayObject ๅฎไพใ
         * @see #removeChild()
         * @see #removeChildAt()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        DisplayObjectContainer.prototype.removeChildren = function () {
            var children = this.$children;
            for (var i = children.length - 1; i >= 0; i--) {
                this.$doRemoveChild(i);
            }
        };
        /**
         * @private
         * ไธไธชๅญ้กน่ขซๆทปๅๅฐๅฎนๅจๅ๏ผๆญคๆนๆณไธไปๅจๆไฝaddChild()ๆถไผ่ขซๅ่ฐ๏ผๅจๆไฝsetChildIndex()ๆswapChildrenๆถไนไผๅ่ฐใ
         * ๅฝๅญ้กน็ดขๅผๅ็ๆนๅๆถ๏ผไผๅ่งฆๅ$childRemoved()ๆนๆณ๏ผ็ถๅ่งฆๅ$childAdded()ๆนๆณใ
         */
        DisplayObjectContainer.prototype.$childAdded = function (child, index) {
        };
        /**
         * @private
         * ไธไธชๅญ้กนไปๅฎนๅจๅ็งป้ค๏ผๆญคๆนๆณไธไปๅจๆไฝremoveChild()ๆถไผ่ขซๅ่ฐ๏ผๅจๆไฝsetChildIndex()ๆswapChildrenๆถไนไผๅ่ฐใ
         * ๅฝๅญ้กน็ดขๅผๅ็ๆนๅๆถ๏ผไผๅ่งฆๅ$childRemoved()ๆนๆณ๏ผ็ถๅ่งฆๅ$childAdded()ๆนๆณใ
         */
        DisplayObjectContainer.prototype.$childRemoved = function (child, index) {
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$onAddToStage = function (stage, nestLevel) {
            _super.prototype.$onAddToStage.call(this, stage, nestLevel);
            var children = this.$children;
            var length = children.length;
            nestLevel++;
            for (var i = 0; i < length; i++) {
                var child = this.$children[i];
                child.$onAddToStage(stage, nestLevel);
            }
        };
        /**
         * @private
         *
         */
        DisplayObjectContainer.prototype.$onRemoveFromStage = function () {
            _super.prototype.$onRemoveFromStage.call(this);
            var children = this.$children;
            var length = children.length;
            for (var i = 0; i < length; i++) {
                var child = children[i];
                child.$onRemoveFromStage();
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$measureChildBounds = function (bounds) {
            var children = this.$children;
            var length = children.length;
            if (length == 0) {
                return;
            }
            var xMin = 0, xMax = 0, yMin = 0, yMax = 0;
            var found = false;
            for (var i = -1; i < length; i++) {
                var childBounds = i == -1 ? bounds : children[i].$getTransformedBounds(this, egret.$TempRectangle);
                if (childBounds.isEmpty()) {
                    continue;
                }
                if (found) {
                    xMin = Math.min(xMin, childBounds.x);
                    xMax = Math.max(xMax, childBounds.x + childBounds.width);
                    yMin = Math.min(yMin, childBounds.y);
                    yMax = Math.max(yMax, childBounds.y + childBounds.height);
                }
                else {
                    found = true;
                    xMin = childBounds.x;
                    xMax = xMin + childBounds.width;
                    yMin = childBounds.y;
                    yMax = yMin + childBounds.height;
                }
            }
            bounds.setTo(xMin, yMin, xMax - xMin, yMax - yMin);
        };
        Object.defineProperty(DisplayObjectContainer.prototype, "touchChildren", {
            /**
             * Determines whether or not the children of the object are touch, or user input device, enabled. If an object is
             * enabled, a user can interact with it by using a touch or user input device.
             * @default true
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็กฎๅฎๅฏน่ฑก็ๅญ็บงๆฏๅฆๆฏๆ่งฆๆธๆ็จๆท่พๅฅ่ฎพๅคใๅฆๆๅฏน่ฑกๆฏๆ่งฆๆธๆ็จๆท่พๅฅ่ฎพๅค๏ผ็จๆทๅฏไปฅ้่ฟไฝฟ็จ่งฆๆธๆ็จๆท่พๅฅ่ฎพๅคไธไนไบคไบใ
             * @default true
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getTouchChildren();
            },
            set: function (value) {
                this.$setTouchChildren(!!value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        DisplayObjectContainer.prototype.$getTouchChildren = function () {
            return this.$touchChildren;
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$setTouchChildren = function (value) {
            if (this.$touchChildren == value) {
                return false;
            }
            this.$touchChildren = value;
            return true;
        };
        /**
         * @private
         * ๆ่ฎฐๆญคๆพ็คบๅฏน่ฑก้่ฆ้็ปใๆญคๆนๆณไผ่งฆๅ่ช่บซ็cacheAsBitmap้็ปใๅฆๆๅชๆฏ็ฉ้ตๆนๅ๏ผ่ช่บซๆพ็คบๅๅฎนๅนถไธๆนๅ๏ผๅบ่ฏฅ่ฐ็จ$invalidateTransform().
         * @param notiryChildren ๆฏๅฆๆ่ฎฐๅญ้กนไน้่ฆ้็ปใไผๅฅfalseๆไธไผๅฅ๏ผๅฐๅชๆ่ฎฐ่ช่บซ้่ฆ้็ปใ้ๅธธๅชๆalphaๅฑๆงๆนๅไผ้่ฆ้็ฅๅญ้กน้็ปใ
         */
        DisplayObjectContainer.prototype.$invalidate = function (notifyChildren) {
            _super.prototype.$invalidate.call(this, notifyChildren);
            if (!notifyChildren) {
                return;
            }
            var cacheRoot = this.$displayList || this.$parentDisplayList;
            var children = this.$children;
            if (children) {
                for (var i = children.length - 1; i >= 0; i--) {
                    this.markChildDirty(children[i], cacheRoot);
                }
            }
        };
        /**
         * @private
         * ๆ่ฎฐ่ช่บซไปฅๅๆๆๅญ้กนๅจ็ถ็บงไธญๅๆขๅๅ็ๆพ็คบๅๅฎนๅคฑๆใๆญคๆนๆณไธไผ่งฆๅ่ช่บซ็cacheAsBitmap้็ปใ
         * ้ๅธธ็จไบ็ฉ้ตๆนๅๆไปๆพ็คบๅ่กจๆทปๅๅ็งป้คๆถใ่ฅ่ช่บซ็ๆพ็คบๅๅฎนๅทฒ็ปๆนๅ้่ฆ้็ป๏ผๅบ่ฏฅ่ฐ็จ$invalidate()ใ
         */
        DisplayObjectContainer.prototype.$invalidateTransform = function () {
            this.markChildDirty(this, this.$parentDisplayList);
        };
        /**
         * @private
         * ๆ่ฎฐๆๆๅญ้กนๅคฑๆ,่ฅ้ๅฐcacheAsBitmap็่็น,็ดๆฅๅๆญข็ปง็ปญ้ๅๅถๅญ้กน.
         */
        DisplayObjectContainer.prototype.markChildDirty = function (child, parentCache) {
            if (child.$hasFlags(512 /* DirtyChildren */)) {
                return;
            }
            child.$setFlags(512 /* DirtyChildren */);
            var displayList = child.$displayList;
            if ((displayList || child.$renderNode) && parentCache) {
                parentCache.markDirty(displayList || child);
            }
            if (displayList) {
                return;
            }
            var children = child.$children;
            if (children) {
                for (var i = children.length - 1; i >= 0; i--) {
                    this.markChildDirty(children[i], parentCache);
                }
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$cacheAsBitmapChanged = function () {
            _super.prototype.$cacheAsBitmapChanged.call(this);
            var cacheRoot = this.$displayList || this.$parentDisplayList;
            var children = this.$children;
            for (var i = children.length - 1; i >= 0; i--) {
                this.assignParentDisplayList(children[i], cacheRoot, cacheRoot);
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.assignParentDisplayList = function (child, parentCache, newParent) {
            child.$parentDisplayList = newParent;
            child.$setFlags(512 /* DirtyChildren */);
            var displayList = child.$displayList;
            if ((child.$renderNode || displayList) && parentCache) {
                parentCache.markDirty(displayList || child);
            }
            if (displayList) {
                return;
            }
            var children = child.$children;
            if (children) {
                for (var i = children.length - 1; i >= 0; i--) {
                    this.assignParentDisplayList(children[i], parentCache, newParent);
                }
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.prototype.$hitTest = function (stageX, stageY) {
            if (!this.$visible) {
                return null;
            }
            var m = this.$getInvertedConcatenatedMatrix();
            var localX = m.a * stageX + m.c * stageY + m.tx;
            var localY = m.b * stageX + m.d * stageY + m.ty;
            var rect = this.$scrollRect ? this.$scrollRect : this.$maskRect;
            if (rect && !rect.contains(localX, localY)) {
                return null;
            }
            if (this.$mask && !this.$mask.$hitTest(stageX, stageY)) {
                return null;
            }
            var children = this.$children;
            var found = false;
            var target = null;
            for (var i = children.length - 1; i >= 0; i--) {
                var child = children[i];
                if (child.$maskedObject) {
                    continue;
                }
                target = child.$hitTest(stageX, stageY);
                if (target) {
                    found = true;
                    if (target.$touchEnabled) {
                        break;
                    }
                    else {
                        target = null;
                    }
                }
            }
            if (target) {
                if (this.$touchChildren) {
                    return target;
                }
                return this;
            }
            if (found) {
                return this;
            }
            return _super.prototype.$hitTest.call(this, stageX, stageY);
        };
        /**
         * @private
         * ๅญ้กนๆๅฏ่ฝไผ่ขซcache่ๅฏผ่ดๆ่ฎฐๅคฑๆใ้ๅๆญคๆนๆณ,ไปฅไพฟๅจ่ตๅผๆถๅฏนๅญ้กนๆทฑๅบฆ้ๅๆ่ฎฐ่ๅบๅ
         */
        DisplayObjectContainer.prototype.$setAlpha = function (value) {
            value = +value || 0;
            if (value == this.$alpha) {
                return false;
            }
            this.$alpha = value;
            this.$propagateFlagsDown(64 /* InvalidConcatenatedAlpha */);
            this.$invalidate();
            this.$invalidateAllChildren();
            return true;
        };
        /**
         * @private
         * ๆ่ฎฐๆๆๅญ้กนๅคฑๆ,ไธmarkChildDirtyไธๅ,ๆญคๆนๆณๆ่งๅญ้กนๆฏๅฆๅฏ็จcacheAsBitmap,ๅฟ้กป้ๅๅฎๆๆๅญ้กน.้ๅธธๅชๆalphaๅฑๆงๆนๅ้่ฆ้็จ่ฟ็งๆไฝ.
         */
        DisplayObjectContainer.prototype.$invalidateAllChildren = function () {
            var children = this.$children;
            if (children) {
                for (var i = children.length - 1; i >= 0; i--) {
                    var child = children[i];
                    child.$invalidate();
                    if (child.$children) {
                        child.$invalidateAllChildren();
                    }
                }
            }
        };
        /**
         * @private
         */
        DisplayObjectContainer.$EVENT_ADD_TO_STAGE_LIST = [];
        /**
         * @private
         */
        DisplayObjectContainer.$EVENT_REMOVE_FROM_STAGE_LIST = [];
        return DisplayObjectContainer;
    }(egret.DisplayObject));
    egret.DisplayObjectContainer = DisplayObjectContainer;
    __reflect(DisplayObjectContainer.prototype, "egret.DisplayObjectContainer");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * @version Egret 2.4
     * @platform Web,Native
     */
    var Filter = (function (_super) {
        __extends(Filter, _super);
        function Filter() {
            var _this = _super.call(this) || this;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            _this.type = null;
            _this.$targets = [];
            _this.$uniforms = {};
            return _this;
        }
        Filter.prototype.$addTarget = function (target) {
            var length = this.$targets.length;
            for (var i = 0; i < length; i++) {
                if (this.$targets[i].$hashCode == target.$hashCode) {
                    return;
                }
            }
            this.$targets.push(target);
        };
        Filter.prototype.$removeTarget = function (target) {
            var length = this.$targets.length;
            for (var i = 0; i < length; i++) {
                if (this.$targets[i].$hashCode == target.$hashCode) {
                    this.$targets.splice(i, 1);
                    return;
                }
            }
        };
        Filter.prototype.invalidate = function () {
            var length = this.$targets.length;
            for (var i = 0; i < length; i++) {
                this.$targets[i].$invalidateContentBounds();
            }
        };
        /**
         * @private
         */
        Filter.prototype.$toJson = function () {
            return '';
        };
        return Filter;
    }(egret.HashObject));
    egret.Filter = Filter;
    __reflect(Filter.prototype, "egret.Filter");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    egret.$locale_strings = egret.$locale_strings || {};
    /**
     * @private
     */
    egret.$language = "en_US";
})(egret || (egret = {}));
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๅจๅฑๅค่ฏญ่จ็ฟป่ฏๅฝๆฐ
         * @param code ่ฆๆฅ่ฏข็ๅญ็ฌฆไธฒไปฃ็
         * @param args ๆฟๆขๅญ็ฌฆไธฒไธญ{0}ๆๅฟ็ๅๆฐๅ่กจ
         * @returns ่ฟๅๆผๆฅๅ็ๅญ็ฌฆไธฒ
         */
        function tr(code) {
            var args = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                args[_i - 1] = arguments[_i];
            }
            var text = egret.$locale_strings[egret.$language][code];
            if (!text) {
                return "{" + code + "}";
            }
            var length = args.length;
            for (var i = 0; i < length; i++) {
                text = text.replace("{" + i + "}", args[i]);
            }
            return text;
        }
        sys.tr = tr;
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Event class is used as the base class for the creation of Event objects, which are passed as parameters to event
     * listeners when an event occurs.The properties of the Event class carry basic information about an event, such as
     * the event's type or whether the event's default behavior can be canceled. For many events, such as the events represented
     * by the Event class constants, this basic information is sufficient. Other events, however, may require more detailed
     * information. Events associated with a touch tap, for example, need to include additional information about the
     * location of the touch event. You can pass such additional information to event listeners by extending the Event class,
     * which is what the TouchEvent class does. Egret API defines several Event subclasses for common events that require
     * additional information. Events associated with each of the Event subclasses are described in the documentation for
     * each class.The methods of the Event class can be used in event listener functions to affect the behavior of the event
     * object. Some events have an associated default behavior. Your event listener can cancel this behavior by calling the
     * preventDefault() method. You can also make the current event listener the last one to process an event by calling
     * the stopPropagation() or stopImmediatePropagation() method.
     * @see egret.EventDispatcher
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/Event.ts
     * @see http://edn.egret.com/cn/docs/page/798 ๅๆถ่งฆๆธไบไปถ
     * @language en_US
     */
    /**
     * Event ็ฑปไฝไธบๅๅปบไบไปถๅฎไพ็ๅบ็ฑป๏ผๅฝๅ็ไบไปถๆถ๏ผEvent ๅฎไพๅฐไฝไธบๅๆฐไผ้็ปไบไปถไพฆๅฌๅจใEvent ็ฑป็ๅฑๆงๅๅซๆๅณไบไปถ็ๅบๆฌไฟกๆฏ๏ผไพๅฆไบไปถ
     * ็็ฑปๅๆ่ๆฏๅฆๅฏไปฅๅๆถไบไปถ็้ป่ฎค่กไธบใๅฏนไบ่ฎธๅคไบไปถ๏ผๅฆ็ฑ Event ็ฑปๅธธ้่กจ็คบ็ไบไปถ๏ผ๏ผๆญคๅบๆฌไฟกๆฏๅฐฑ่ถณๅคไบใไฝๅถไปไบไปถๅฏ่ฝ้่ฆๆด่ฏฆ็ป็ไฟกๆฏใ
     * ไพๅฆ๏ผไธ่งฆๆธๅณ่็ไบไปถ้่ฆๅๆฌๆๅณ่งฆๆธไบไปถ็ไฝ็ฝฎไฟกๆฏใๆจๅฏไปฅ้่ฟๆฉๅฑ Event ็ฑป๏ผTouchEvent ็ฑปๆง่ก็ๆไฝ๏ผๅฐๆญค็ฑปๅถไปไฟกๆฏไผ้็ปไบไปถไพฆๅฌๅจใ
     * Egret API ไธบ้่ฆๅถไปไฟกๆฏ็ๅธธ่งไบไปถๅฎไนๅคไธช Event ๅญ็ฑปใไธๆฏไธช Event ๅญ็ฑปๅณ่็ไบไปถๅฐๅจๆฏไธช็ฑป็ๆๆกฃไธญๅไปฅไป็ปใEvent ็ฑป็ๆนๆณๅฏไปฅๅจ
     * ไบไปถไพฆๅฌๅจๅฝๆฐไธญไฝฟ็จไปฅๅฝฑๅไบไปถๅฏน่ฑก็่กไธบใๆไบไบไปถๆๅณ่็้ป่ฎค่กไธบ๏ผ้่ฟ่ฐ็จ preventDefault() ๆนๆณ๏ผๆจ็ไบไปถไพฆๅฌๅจๅฏไปฅๅๆถๆญค่กไธบใ
     * ๅฏไปฅ้่ฟ่ฐ็จ stopPropagation() ๆ stopImmediatePropagation() ๆนๆณ๏ผๅฐๅฝๅไบไปถไพฆๅฌๅจไฝไธบๅค็ไบไปถ็ๆๅไธไธชไบไปถไพฆๅฌๅจใ
     * @see egret.EventDispatcher
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/Event.ts
     * @see http://edn.egret.com/cn/docs/page/798 ๅๆถ่งฆๆธไบไปถ
     * @language zh_CN
     */
    var Event = (function (_super) {
        __extends(Event, _super);
        /**
         * Creates an Event object to pass as a parameter to event listeners.
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @param data the optional data associated with this event
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชไฝไธบๅๆฐไผ้็ปไบไปถไพฆๅฌๅจ็ Event ๅฏน่ฑกใ
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @param data ไธๆญคไบไปถๅฏน่ฑกๅณ่็ๅฏ้ๆฐๆฎใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Event(type, bubbles, cancelable, data) {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$eventPhase = 2;
            /**
             * @private
             */
            _this.$currentTarget = null;
            /**
             * @private
             */
            _this.$target = null;
            /**
             * @private
             */
            _this.$isDefaultPrevented = false;
            /**
             * @private
             */
            _this.$isPropagationStopped = false;
            /**
             * @private
             */
            _this.$isPropagationImmediateStopped = false;
            _this.$type = type;
            _this.$bubbles = !!bubbles;
            _this.$cancelable = !!cancelable;
            _this.data = data;
            return _this;
        }
        Object.defineProperty(Event.prototype, "type", {
            /**
             * The type of event. The type is case-sensitive.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถ็็ฑปๅใ็ฑปๅๅบๅๅคงๅฐๅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$type;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Event.prototype, "bubbles", {
            /**
             * Indicates whether an event is a bubbling event.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบไบไปถๆฏๅฆไธบๅๆณกไบไปถใๅฆๆไบไปถๅฏไปฅๅๆณก๏ผๅๆญคๅผไธบ true๏ผๅฆๅไธบ falseใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$bubbles;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Event.prototype, "cancelable", {
            /**
             * Indicates whether the behavior associated with the event can be prevented. If the behavior can be
             * canceled, this value is true; otherwise it is false.
             * @see #preventDefault()
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๆฏๅฆๅฏไปฅ้ปๆญขไธไบไปถ็ธๅณ่็่กไธบใๅฆๆๅฏไปฅๅๆถ่ฏฅ่กไธบ๏ผๅๆญคๅผไธบ true๏ผๅฆๅไธบ falseใ
             * @see #preventDefault()
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$cancelable;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Event.prototype, "eventPhase", {
            /**
             * The current phase in the event flow. This property can contain the following numeric values:
             * The capture phase (EventPhase.CAPTURING_PHASE).
             * The target phase (EventPhase.AT_TARGET)
             * The bubbling phase (EventPhase.BUBBLING_PHASE).
             * @see egret.EventPhase
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถๆตไธญ็ๅฝๅ้ถๆฎตใๆญคๅฑๆงๅฏไปฅๅๅซไปฅไธๆฐๅผ๏ผ
             * ๆ่ท้ถๆฎต (EventPhase.CAPTURING_PHASE)ใ
             * ็ฎๆ้ถๆฎต (EventPhase.AT_TARGET)ใ
             * ๅๆณก้ถๆฎต (EventPhase.BUBBLING_PHASE)ใ
             * @see egret.EventPhase
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$eventPhase;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Event.prototype, "currentTarget", {
            /**
             * The object that is actively processing the Event object with an event listener. For example, if a
             * user clicks an OK button, the current target could be the node containing that button or one of its ancestors
             * that has registered an event listener for that event.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝๅๆญฃๅจไฝฟ็จๆไธชไบไปถไพฆๅฌๅจๅค็ Event ๅฏน่ฑก็ๅฏน่ฑกใไพๅฆ๏ผๅฆๆ็จๆทๅๅปโ็กฎๅฎโๆ้ฎ๏ผ
             * ๅๅฝๅ็ฎๆๅฏไปฅๆฏๅๅซ่ฏฅๆ้ฎ็่็น๏ผไนๅฏไปฅๆฏๅฎ็ๅทฒไธบ่ฏฅไบไปถๆณจๅไบไบไปถไพฆๅฌๅจ็ๅง็ฅไนไธใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$currentTarget;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Event.prototype, "target", {
            /**
             * The event target. This property contains the target node. For example, if a user clicks an OK button,
             * the target node is the display list node containing that button.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถ็ฎๆใๆญคๅฑๆงๅๅซ็ฎๆ่็นใไพๅฆ๏ผๅฆๆ็จๆทๅๅปโ็กฎๅฎโๆ้ฎ๏ผๅ็ฎๆ่็นๅฐฑๆฏๅๅซ่ฏฅๆ้ฎ็ๆพ็คบๅ่กจ่็นใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$target;
            },
            enumerable: true,
            configurable: true
        });
        Event.prototype.$setTarget = function (target) {
            this.$target = target;
            return true;
        };
        /**
         * Checks whether the preventDefault() method has been called on the event. If the preventDefault() method has been
         * called, returns true; otherwise, returns false.
         * @returns If preventDefault() has been called, returns true; otherwise, returns false.
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฃๆฅๆฏๅฆๅทฒๅฏนไบไปถ่ฐ็จ preventDefault() ๆนๆณใ
         * @returns ๅฆๆๅทฒ่ฐ็จ preventDefault() ๆนๆณ๏ผๅ่ฟๅ true๏ผๅฆๅ่ฟๅ falseใ
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.prototype.isDefaultPrevented = function () {
            return this.$isDefaultPrevented;
        };
        /**
         * Cancels an event's default behavior if that behavior can be canceled.Many events have associated behaviors that
         * are carried out by default. For example, if a user types a character into a text input, the default behavior
         * is that the character is displayed in the text input. Because the TextEvent.TEXT_INPUT event's default behavior
         * can be canceled, you can use the preventDefault() method to prevent the character from appearing.
         * You can use the Event.cancelable property to check whether you can prevent the default behavior associated with
         * a particular event. If the value of Event.cancelable is true, then preventDefault() can be used to cancel the event;
         * otherwise, preventDefault() has no effect.
         * @see #cancelable
         * @see #isDefaultPrevented
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆๅฏไปฅๅๆถไบไปถ็้ป่ฎค่กไธบ๏ผๅๅๆถ่ฏฅ่กไธบใ
         * ่ฎธๅคไบไปถ้ฝๆ้ป่ฎคๆง่ก็ๅณ่่กไธบใไพๅฆ๏ผๅฆๆ็จๆทๅจๆๆฌๅญๆฎตไธญ้ฎๅฅไธไธชๅญ็ฌฆ๏ผๅ้ป่ฎค่กไธบๅฐฑๆฏๅจๆๆฌๅญๆฎตไธญๆพ็คบ่ฏฅๅญ็ฌฆใ
         * ็ฑไบๅฏไปฅๅๆถ TextEvent.TEXT_INPUT ไบไปถ็้ป่ฎค่กไธบ๏ผๅๆญคๆจๅฏไปฅไฝฟ็จ preventDefault() ๆนๆณๆฅ้ฒๆญขๆพ็คบ่ฏฅๅญ็ฌฆใ
         * ๆจๅฏไปฅไฝฟ็จ Event.cancelable ๅฑๆงๆฅๆฃๆฅๆฏๅฆๅฏไปฅ้ฒๆญขไธ็นๅฎไบไปถๅณ่็้ป่ฎค่กไธบใๅฆๆ Event.cancelable ็ๅผไธบ true๏ผ
         * ๅๅฏไปฅไฝฟ็จ preventDefault() ๆฅๅๆถไบไปถ๏ผๅฆๅ๏ผpreventDefault() ๆๆใ
         * @see #cancelable
         * @see #isDefaultPrevented
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.prototype.preventDefault = function () {
            if (this.$cancelable)
                this.$isDefaultPrevented = true;
        };
        /**
         * Prevents processing of any event listeners in nodes subsequent to the current node in the event flow. This method
         * does not affect any event listeners in the current node (currentTarget). In contrast, the stopImmediatePropagation()
         * method prevents processing of event listeners in both the current node and subsequent nodes. Additional calls to this
         * method have no effect. This method can be called in any phase of the event flow.<br/>
         * Note: This method does not cancel the behavior associated with this event; see preventDefault() for that functionality.
         * @see #stopImmediatePropagation()
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ฒๆญขๅฏนไบไปถๆตไธญๅฝๅ่็น็ๅ็ปญ่็นไธญ็ๆๆไบไปถไพฆๅฌๅจ่ฟ่กๅค็ใๆญคๆนๆณไธไผๅฝฑๅๅฝๅ่็น currentTarget ไธญ็ไปปไฝไบไปถไพฆๅฌๅจใ
         * ็ธๆฏไนไธ๏ผstopImmediatePropagation() ๆนๆณๅฏไปฅ้ฒๆญขๅฏนๅฝๅ่็นไธญๅๅ็ปญ่็นไธญ็ไบไปถไพฆๅฌๅจ่ฟ่กๅค็ใ
         * ๅฏนๆญคๆนๆณ็ๅถๅฎ่ฐ็จๆฒกๆไปปไฝๆๆใๅฏไปฅๅจไบไปถๆต็ไปปไฝ้ถๆฎตไธญ่ฐ็จๆญคๆนๆณใ<br/>
         * ๆณจๆ๏ผๆญคๆนๆณไธไผๅๆถไธๆญคไบไปถ็ธๅณ่็่กไธบ๏ผๆๅณๆญคๅ่ฝ็ไฟกๆฏ๏ผ่ฏทๅ้ preventDefault()ใ
         * @see #stopImmediatePropagation()
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.prototype.stopPropagation = function () {
            if (this.$bubbles)
                this.$isPropagationStopped = true;
        };
        /**
         * Prevents processing of any event listeners in the current node and any subsequent nodes in the event flow.
         * This method takes effect immediately, and it affects event listeners in the current node. In contrast, the
         * stopPropagation() method doesn't take effect until all the event listeners in the current node finish processing.<br/>
         * Note: This method does not cancel the behavior associated with this event; see preventDefault() for that functionality.
         * @see #stopPropagation()
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ฒๆญขๅฏนไบไปถๆตไธญๅฝๅ่็นไธญๅๆๆๅ็ปญ่็นไธญ็ไบไปถไพฆๅฌๅจ่ฟ่กๅค็ใๆญคๆนๆณไผ็ซๅณ็ๆ๏ผๅนถไธไผๅฝฑๅๅฝๅ่็นไธญ็ไบไปถไพฆๅฌๅจใ
         * ็ธๆฏไนไธ๏ผๅจๅฝๅ่็นไธญ็ๆๆไบไปถไพฆๅฌๅจ้ฝๅฎๆๅค็ไนๅ๏ผstopPropagation() ๆนๆณไธไผ็ๆใ<br/>
         * ๆณจๆ๏ผๆญคๆนๆณไธไผๅๆถไธๆญคไบไปถ็ธๅณ่็่กไธบ๏ผๆๅณๆญคๅ่ฝ็ไฟกๆฏ๏ผ่ฏทๅ้ preventDefault()ใ
         * @see #stopPropagation()
         * @see #preventDefault()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.prototype.stopImmediatePropagation = function () {
            if (this.$bubbles)
                this.$isPropagationImmediateStopped = true;
        };
        /**
         * This method will be called automatically when you pass the event object as the parameters to the Event.release() method.
         * If your custom event is designed for reusable,you should override this method to make sure all the references to external
         * objects are cleaned. if not,it may cause memory leaking.
         * @see egret.Event.create()
         * @see egret.Event.release()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝไบไปถๅฎไพไผ้็ปEvent.release()้ๆๆนๆณๆถ๏ผๅฎไพไธ็clean()ๆนๆณๅฐไผ่ขซ่ชๅจ่ฐ็จใ
         * ่ฅๆญค่ชๅฎไนไบไปถ็ๅฎไพ่ฎพ่ฎกไธบๅฏไปฅๅพช็ฏๅค็จ็๏ผไธบไบ้ฟๅๅผ่ตทๅๅญๆณ้ฒ๏ผ่ชๅฎไนไบไปถ้่ฆ่ฆ็ๆญคๆนๆณๆฅ็กฎไฟๅฎไพ่ขซ็ผๅญๅๆญๅผๅฏนๅค้จๅฏน่ฑก็ไธๅๅผ็จใ
         * @see egret.Event.create()
         * @see egret.Event.release()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.prototype.clean = function () {
            this.data = this.$currentTarget = null;
            this.$setTarget(null);
        };
        /**
         * EventDispatcher object using the specified event object thrown Event. Objects thrown objects will be cached in the pool for the next round robin.
         * @param target the event target
         * @param type The type of the event. Event listeners can access this information through the inherited type property.
         * @param bubbles Determines whether the Event object bubbles. Event listeners can access this information through
         * the inherited bubbles property.
         * @param data {any} data
         * @method egret.Event.dispatchEvent
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็ EventDispatcher ๅฏน่ฑกๆฅๆๅบ Event ไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target {egret.IEventDispatcher} ๆดพๅไบไปถ็ฎๆ
         * @param type {string} ไบไปถ็ฑปๅ
         * @param bubbles {boolean} ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param data {any} ไบไปถdata
         * @method egret.Event.dispatchEvent
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.dispatchEvent = function (target, type, bubbles, data) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            var event = Event.create(Event, type, bubbles);
            var props = Event._getPropertyData(Event);
            if (data != undefined) {
                props.data = data;
            }
            var result = target.dispatchEvent(event);
            Event.release(event);
            return result;
        };
        /**
         * @private
         *
         * @param EventClass
         * @returns
         */
        Event._getPropertyData = function (EventClass) {
            var props = EventClass._props;
            if (!props)
                props = EventClass._props = {};
            return props;
        };
        /**
         * Gets one event instance from the object pool or create a new one. We highly recommend using the Event.create()
         * and Event.release() methods to create and release an event object,it can reduce the number of reallocate objects,
         * which allows you to get better code execution performance.<br/>
         * Note: If you want to use this method to initialize your custom event object,you must make sure the constructor
         * of your custom event is the same as the constructor of egret.Event.
         * @param EventClass Event Classใ
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @example
         * <pre>
         *    let event = Event.create(Event,type, bubbles);
         *    event.data = data;    //optional,initializes custom data here
         *    this.dispatchEvent(event);
         *    Event.release(event);
         * </pre>
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฏน่ฑกๆฑไธญๅๅบๆๅๅปบไธไธชๆฐ็ไบไปถๅฎไพใๆไปฌๅปบ่ฎฎๆจๅฐฝๅฏ่ฝไฝฟ็จEvent.create()ๅEvent.release() ่ฟไธๅฏนๆนๆณๆฅๅๅปบๅ้ๆพไบไปถๅฏน่ฑก๏ผ
         * ่ฟไธๅฏนๆนๆณไผๅฐไบไปถๅฎไพๅจๅ้จ็ผๅญไธๆฅไพไธๆฌกๅพช็ฏไฝฟ็จ๏ผๅๅฐๅฏน่ฑก็ๅๅปบๆฌกๆฐ,ไป่่ทๅพๆด้ซ็ไปฃ็่ฟ่กๆง่ฝใ<br/>
         * ๆณจๆ๏ผ่ฅไฝฟ็จๆญคๆนๆณๆฅๅๅปบ่ชๅฎไนไบไปถ็ๅฎไพ๏ผ่ชๅฎไน็ๆ้ๅฝๆฐๅๆฐๅ่กจๅฟ้กป่ทEvent็ฑปไธ่ดใ
         * @param EventClass Event็ฑปๅใ
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @example
         * <pre>
         *    let event = Event.create(Event,type, bubbles);
         *    event.data = data;  //ๅฏ้๏ผ่ฅๆๅฎไนไบไปถไธ้่ฆ้ๅๅถไปๅๆฐ๏ผๅฏไปฅๅจ่ทๅๅฎไพๅๅจๆญคๅค่ฎพ็ฝฎใ
         *    this.dispatchEvent(event);
         *    Event.release(event);
         * </pre>
         * @see #clean()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.create = function (EventClass, type, bubbles, cancelable) {
            var eventPool = EventClass.eventPool;
            if (!eventPool) {
                eventPool = EventClass.eventPool = [];
            }
            if (eventPool.length) {
                var event_2 = eventPool.pop();
                event_2.$type = type;
                event_2.$bubbles = !!bubbles;
                event_2.$cancelable = !!cancelable;
                event_2.$isDefaultPrevented = false;
                event_2.$isPropagationStopped = false;
                event_2.$isPropagationImmediateStopped = false;
                event_2.$eventPhase = 2 /* AT_TARGET */;
                return event_2;
            }
            return new EventClass(type, bubbles, cancelable);
        };
        /**
         * Releases an event object and cache it into the object pool.We highly recommend using the Event.create()
         * and Event.release() methods to create and release an event object,it can reduce the number of reallocate objects,
         * which allows you to get better code execution performance.<br/>
         * Note: The parameters of this method only accepts an instance created by the Event.create() method.
         * if not,it may throw an error.
         * @example
         * <pre>
         *    let event = Event.create(Event,type, bubbles);
         *    event.data = data; //optional,initializes custom data here
         *    this.dispatchEvent(event);
         *    Event.release(event);
         * </pre>
         * @see #clean()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพไธไธชไบไปถๅฏน่ฑก๏ผๅนถ็ผๅญๅฐๅฏน่ฑกๆฑใๆไปฌๅปบ่ฎฎๆจๅฐฝๅฏ่ฝไฝฟ็จEvent.create()ๅEvent.release() ่ฟไธๅฏนๆนๆณๆฅๅๅปบๅ้ๆพไบไปถๅฏน่ฑก๏ผ
         * ่ฟไธๅฏนๆนๆณไผๅฐไบไปถๅฎไพๅจๅ้จ็ผๅญไธๆฅไพไธๆฌกๅพช็ฏไฝฟ็จ๏ผๅๅฐๅฏน่ฑก็ๅๅปบๆฌกๆฐ,ไป่่ทๅพๆด้ซ็ไปฃ็่ฟ่กๆง่ฝใ<br/>
         * ๆณจๆ๏ผๆญคๆนๆณๅช่ฝไผๅฅ็ฑEvent.create()ๅๅปบ็ไบไปถๅฎไพ๏ผไผๅฅ้ๆณๅฏน่ฑกๅฎไพๅฏ่ฝไผๅฏผ่ดๆฅ้ใ
         * @example
         * <pre>
         *    let event = Event.create(Event,type, bubbles);
         *    event.data = data;   //ๅฏ้๏ผ่ฅๆๅฎไนไบไปถไธ้่ฆ้ๅๅถไปๅๆฐ๏ผๅฏไปฅๅจ่ทๅๅฎไพๅๅจๆญคๅค่ฎพ็ฝฎใ
         *    this.dispatchEvent(event);
         *    Event.release(event);
         * </pre>
         * @see #clean()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.release = function (event) {
            event.clean();
            var EventClass = Object.getPrototypeOf(event).constructor;
            EventClass.eventPool.push(event);
        };
        /**
         * Dispatched when a display object is added to the on stage display list, either directly or through the addition
         * of a sub tree in which the display object is contained.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅฐๆพ็คบๅฏน่ฑก็ดๆฅๆทปๅๅฐ่ๅฐๆพ็คบๅ่กจๆๅฐๅๅซๆพ็คบๅฏน่ฑก็ๅญๆๆทปๅ่ณ่ๅฐๆพ็คบๅ่กจไธญๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.ADDED_TO_STAGE = "addedToStage";
        /**
         * Dispatched when a display object is about to be removed from the display list, either directly or through the removal
         * of a sub tree in which the display object is contained.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจไปๆพ็คบๅ่กจไธญ็ดๆฅๅ้คๆพ็คบๅฏน่ฑกๆๅ้คๅๅซๆพ็คบๅฏน่ฑก็ๅญๆๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.REMOVED_FROM_STAGE = "removedFromStage";
        /**
         * Dispatched when a display object is added to the display list.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆพ็คบๅฏน่ฑกๆทปๅๅฐๆพ็คบๅ่กจไธญๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.ADDED = "added";
        /**
         * Dispatched when a display object is about to be removed from the display list.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ่ฆไปๆพ็คบๅ่กจไธญๅ้คๆพ็คบๅฏน่ฑกๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.REMOVED = "removed";
        /**
         * [broadcast event] Dispatched when the playhead is entering a new frame.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * [ๅนฟๆญไบไปถ] ่ฟๅฅๆฐ็ไธๅธง,็ๅฌๆญคไบไปถๅฐไผๅจไธไธๅธงๅผๅงๆถ่งฆๅไธๆฌกๅ่ฐใ่ฟๆฏไธไธชๅนฟๆญไบไปถ๏ผๅฏไปฅๅจไปปไฝไธไธชๆพ็คบๅฏน่ฑกไธ็ๅฌ๏ผๆ่ฎบๅฎๆฏๅฆๅจๆพ็คบๅ่กจไธญใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.ENTER_FRAME = "enterFrame";
        /**
         * Dispatched when the display list is about to be updated and rendered.
         * Note: Every time you want to receive a render event,you must call the stage.invalidate() method.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆธฒๆไบไปถ๏ผ็ๅฌๆญคไบไปถๅฐไผๅจๆฌๅธงๆซๅณๅฐๅผๅงๆธฒๆ็ๅไธๅป่งฆๅๅ่ฐ๏ผ่ฟๆฏไธไธชๅนฟๆญไบไปถ๏ผๅฏไปฅๅจไปปไฝไธไธชๆพ็คบๅฏน่ฑกไธ็ๅฌ๏ผๆ่ฎบๅฎๆฏๅฆๅจๆพ็คบๅ่กจไธญใ
         * ๆณจๆ๏ผๆฏๆฌกๆจๅธๆ Egret ๅ้ Event.RENDER ไบไปถๆถ๏ผ้ฝๅฟ้กป่ฐ็จ stage.invalidate() ๆนๆณ๏ผ็ฑไบๆฏๅธงๅชไผ่งฆๅไธๆฌกๅฑๅนๅทๆฐ๏ผ
         * ่ฅๅจ Event.RENDER ๅ่ฐๅฝๆฐๆง่กๆ้ดๅๆฌก่ฐ็จstage.invalidate()๏ผๅฐไผ่ขซๅฟฝ็ฅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.RENDER = "render";
        /**
         * Dispatched when the size of stage or UIComponent is changed.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ๅฐๅฐบๅฏธๆUI็ปไปถๅฐบๅฏธๅ็ๆนๅ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.RESIZE = "resize";
        /**
         * Dispatched when the value or selection of a property is chaned.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฑๆงๅผๆ็ถๆๅ็ๆนๅใ้ๅธธๆฏๆ้ฎ็้ไธญ็ถๆ๏ผๆ่ๅ่กจ็้ไธญ้กน็ดขๅผๆนๅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.CHANGE = "change";
        /**
         * Dispatched when the value or selection of a property is going to change.you can cancel this by calling the
         * preventDefault() method.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฑๆงๅผๆ็ถๆๅณๅฐๅ็ๆนๅ,้ๅธธๆฏๆ้ฎ็้ไธญ็ถๆ๏ผๆ่ๅ่กจ็้ไธญ้กน็ดขๅผๆนๅใๅฏไปฅ้่ฟ่ฐ็จ preventDefault() ๆนๆณ้ปๆญข็ดขๅผๅ็ๆดๆนใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.CHANGING = "changing";
        /**
         * Dispatched when the net request is complete.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฝ็ป่ฏทๆฑๅ่ฝฝๅฎๆ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.COMPLETE = "complete";
        /**
         * Dispatched when loop completed.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅพช็ฏๅฎๆใๅพช็ฏๆๅไธๆฌกๅชๆดพๅ COMPLETE ไบไปถ๏ผไธๆดพๅ LOOP_COMPLETE ไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.LOOP_COMPLETE = "loopComplete";
        /**
         * Dispatched when the TextInput instance gets focus.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * TextInputๅฎไพ่ทๅพ็ฆ็น
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.FOCUS_IN = "focusIn";
        /**
         * Dispatched when the TextInput instance loses focus.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * TextInputๅฎไพๅคฑๅป็ฆ็น
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.FOCUS_OUT = "focusOut";
        /**
         * Dispatched when the playback is ended.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจ็ปๅฃฐ้ณ็ญๆญๆพๅฎๆ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Event.ENDED = "ended";
        /**
         * ๆธธๆๆฟๆดป
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.ACTIVATE = "activate";
        /**
         * ๅๆถๆฟๆดป
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.DEACTIVATE = "deactivate";
        /**
         * Event.CLOSE ๅธธ้ๅฎไน close ไบไปถๅฏน่ฑก็ type ๅฑๆง็ๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.CLOSE = "close";
        /**
         * Event.CONNECT ๅธธ้ๅฎไน connect ไบไปถๅฏน่ฑก็ type ๅฑๆง็ๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.CONNECT = "connect";
        /**
         * Event.LEAVE_STAGE ๅธธ้ๅฎไน leaveStage ไบไปถๅฏน่ฑก็ type ๅฑๆง็ๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.LEAVE_STAGE = "leaveStage";
        /**
         * Event.SOUND_COMPLETE ๅธธ้ๅฎไน ๅจๅฃฐ้ณๅฎๆๆญๆพๅ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Event.SOUND_COMPLETE = "soundComplete";
        return Event;
    }(egret.HashObject));
    egret.Event = Event;
    __reflect(Event.prototype, "egret.Event");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var pointPool = [];
    var DEG_TO_RAD = Math.PI / 180;
    /**
     * The Point object represents a location in a two-dimensional coordinate system, where x represents the horizontal
     * axis and y represents the vertical axis.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Point.ts
     * @language en_US
     */
    /**
     * Point ๅฏน่ฑก่กจ็คบไบ็ปดๅๆ็ณป็ปไธญ็ๆไธชไฝ็ฝฎ๏ผๅถไธญ x ่กจ็คบๆฐดๅนณ่ฝด๏ผy ่กจ็คบๅ็ด่ฝดใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Point.ts
     * @language zh_CN
     */
    var Point = (function (_super) {
        __extends(Point, _super);
        /**
         * Creates a new point. If you pass no parameters to this method, a point is created at (0,0).
         * @param x The horizontal coordinate.
         * @param y The vertical coordinate.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.Point ๅฏน่ฑก.่ฅไธไผๅฅไปปไฝๅๆฐ๏ผๅฐไผๅๅปบไธไธชไฝไบ๏ผ0๏ผ0๏ผไฝ็ฝฎ็็นใ
         * @param x ่ฏฅๅฏน่ฑก็xๅฑๆงๅผ๏ผ้ป่ฎคไธบ0
         * @param y ่ฏฅๅฏน่ฑก็yๅฑๆงๅผ๏ผ้ป่ฎคไธบ0
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Point(x, y) {
            if (x === void 0) {
                x = 0;
            }
            if (y === void 0) {
                y = 0;
            }
            var _this = _super.call(this) || this;
            _this.x = x;
            _this.y = y;
            return _this;
        }
        /**
         * Releases a point instance to the object pool
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพไธไธชPointๅฎไพๅฐๅฏน่ฑกๆฑ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.release = function (point) {
            if (!point) {
                return;
            }
            pointPool.push(point);
        };
        /**
         * get a point instance from the object pool or create a new one.
         * @param x The horizontal coordinate.
         * @param y The vertical coordinate.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฏน่ฑกๆฑไธญๅๅบๆๅๅปบไธไธชๆฐ็Pointๅฏน่ฑกใ
         * @param x ่ฏฅๅฏน่ฑก็xๅฑๆงๅผ๏ผ้ป่ฎคไธบ0
         * @param y ่ฏฅๅฏน่ฑก็yๅฑๆงๅผ๏ผ้ป่ฎคไธบ0
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.create = function (x, y) {
            var point = pointPool.pop();
            if (!point) {
                point = new Point();
            }
            return point.setTo(x, y);
        };
        Object.defineProperty(Point.prototype, "length", {
            /**
             * The length of the line segment from (0,0) to this point.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไป (0,0) ๅฐๆญค็น็็บฟๆฎต้ฟๅบฆใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Sets the members of Point to the specified values
         * @param x The horizontal coordinate.
         * @param y The vertical coordinate.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ Point ็ๆๅ่ฎพ็ฝฎไธบๆๅฎๅผ
         * @param x ่ฏฅๅฏน่ฑก็xๅฑๆงๅผ
         * @param y ่ฏฅๅฏน่ฑก็yๅฑๆงๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.setTo = function (x, y) {
            this.x = x;
            this.y = y;
            return this;
        };
        /**
         * Creates a copy of this Point object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้็นๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.clone = function () {
            return new Point(this.x, this.y);
        };
        /**
         * Determines whether two points are equal. Two points are equal if they have the same x and y values.
         * @param toCompare The point to be compared.
         * @returns A value of true if the object is equal to this Point object; false if it is not equal.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎไธคไธช็นๆฏๅฆ็ธๅใๅฆๆไธคไธช็นๅทๆ็ธๅ็ x ๅ y ๅผ๏ผๅๅฎไปฌๆฏ็ธๅ็็นใ
         * @param toCompare ่ฆๆฏ่พ็็นใ
         * @returns ๅฆๆ่ฏฅๅฏน่ฑกไธๆญค Point ๅฏน่ฑก็ธๅ๏ผๅไธบ true ๅผ๏ผๅฆๆไธ็ธๅ๏ผๅไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.equals = function (toCompare) {
            return this.x == toCompare.x && this.y == toCompare.y;
        };
        /**
         * Returns the distance between pt1 and pt2.
         * @param p1 The first point.
         * @param p2 The second point.
         * @returns The distance between the first and second points.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅ pt1 ๅ pt2 ไน้ด็่ท็ฆปใ
         * @param p1 ็ฌฌไธไธช็น
         * @param p2 ็ฌฌไบไธช็น
         * @returns ็ฌฌไธไธช็นๅ็ฌฌไบไธช็นไน้ด็่ท็ฆปใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.distance = function (p1, p2) {
            return Math.sqrt((p1.x - p2.x) * (p1.x - p2.x) + (p1.y - p2.y) * (p1.y - p2.y));
        };
        /**
         * Copies all of the point data from the source Point object into the calling Point object.
         * @param sourcePoint The Point object from which to copy the data.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆบ Point ๅฏน่ฑกไธญ็ๆๆ็นๆฐๆฎๅคๅถๅฐ่ฐ็จๆน Point ๅฏน่ฑกไธญใ
         * @param sourcePoint ่ฆไปไธญๅคๅถๆฐๆฎ็ Point ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.copyFrom = function (sourcePoint) {
            this.x = sourcePoint.x;
            this.y = sourcePoint.y;
        };
        /**
         * Adds the coordinates of another point to the coordinates of this point to create a new point.
         * @param v The point to be added.
         * @returns The new point.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅฆไธไธช็น็ๅๆๆทปๅๅฐๆญค็น็ๅๆไปฅๅๅปบไธไธชๆฐ็นใ
         * @param v ่ฆๆทปๅ็็นใ
         * @returns ๆฐ็นใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.add = function (v) {
            return new Point(this.x + v.x, this.y + v.y);
        };
        /**
         * Determines a point between two specified points.
         * The parameter f determines where the new interpolated point is located relative to the two end points specified by parameters pt1 and pt2. The closer the value of the parameter f is to 1.0, the closer the interpolated point is to the first point (parameter pt1). The closer the value of the parameter f is to 0, the closer the interpolated point is to the second point (parameter pt2).
         * @param pt1 The first point.
         * @param pt2 The second point.
         * @param f The level of interpolation between the two points. Indicates where the new point will be, along the line between pt1 and pt2. If f=1, pt1 is returned; if f=0, pt2 is returned.
         * @returns The new interpolated point.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็กฎๅฎไธคไธชๆๅฎ็นไน้ด็็นใ
         * ๅๆฐ f ็กฎๅฎๆฐ็ๅๆ็น็ธๅฏนไบๅๆฐ pt1 ๅ pt2 ๆๅฎ็ไธคไธช็ซฏ็นๆๅค็ไฝ็ฝฎใๅๆฐ f ็ๅผ่ถๆฅ่ฟ 1.0๏ผๅๅๆ็นๅฐฑ่ถๆฅ่ฟ็ฌฌไธไธช็น๏ผๅๆฐ pt1๏ผใๅๆฐ f ็ๅผ่ถๆฅ่ฟ 0๏ผๅๅๆ็นๅฐฑ่ถๆฅ่ฟ็ฌฌไบไธช็น๏ผๅๆฐ pt2๏ผใ
         * @param pt1 ็ฌฌไธไธช็นใ
         * @param pt2 ็ฌฌไบไธช็นใ
         * @param f ไธคไธช็นไน้ด็ๅๆ็บงๅซใ่กจ็คบๆฐ็นๅฐไฝไบ pt1 ๅ pt2 ่ฟๆ็็ด็บฟไธ็ไปไนไฝ็ฝฎใๅฆๆ f=1๏ผๅ่ฟๅ pt1๏ผๅฆๆ f=0๏ผๅ่ฟๅ pt2ใ
         * @returns ๆฐ็ๅๆ็นใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.interpolate = function (pt1, pt2, f) {
            var f1 = 1 - f;
            return new Point(pt1.x * f + pt2.x * f1, pt1.y * f + pt2.y * f1);
        };
        /**
         * Scales the line segment between (0,0) and the current point to a set length.
         * @param thickness The scaling value. For example, if the current point is (0,5), and you normalize it to 1, the point returned is at (0,1).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ (0,0) ๅๅฝๅ็นไน้ด็็บฟๆฎต็ผฉๆพไธบ่ฎพๅฎ็้ฟๅบฆใ
         * @param thickness ็ผฉๆพๅผใไพๅฆ๏ผๅฆๆๅฝๅ็นไธบ (0,5) ๅนถไธๆจๅฐๅฎ่ง่ๅไธบ 1๏ผๅ่ฟๅ็็นไฝไบ (0,1) ๅคใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.normalize = function (thickness) {
            if (this.x != 0 || this.y != 0) {
                var relativeThickness = thickness / this.length;
                this.x *= relativeThickness;
                this.y *= relativeThickness;
            }
        };
        /**
         * Offsets the Point object by the specified amount. The value of dx is added to the original value of x to create the new x value. The value of dy is added to the original value of y to create the new y value.
         * @param dx The amount by which to offset the horizontal coordinate, x.
         * @param dy The amount by which to offset the vertical coordinate, y.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๆๅฎ้ๅ็งป Point ๅฏน่ฑกใdx ็ๅผๅฐๆทปๅๅฐ x ็ๅๅงๅผไธญไปฅๅๅปบๆฐ็ x ๅผใdy ็ๅผๅฐๆทปๅๅฐ y ็ๅๅงๅผไธญไปฅๅๅปบๆฐ็ y ๅผใ
         * @param dx ๆฐดๅนณๅๆ x ็ๅ็งป้ใ
         * @param dy ๆฐดๅนณๅๆ y ็ๅ็งป้ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.offset = function (dx, dy) {
            this.x += dx;
            this.y += dy;
        };
        /**
         * Converts a pair of polar coordinates to a Cartesian point coordinate.
         * @param len The length coordinate of the polar pair.
         * @param angle The angle, in radians, of the polar pair.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐไธๅฏนๆๅๆ่ฝฌๆขไธบ็ฌๅกๅฐ็นๅๆใ
         * @param len ๆๅๆๅฏน็้ฟๅบฆใ
         * @param angle ๆๅๆๅฏน็่งๅบฆ๏ผไปฅๅผงๅบฆ่กจ็คบ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.polar = function (len, angle) {
            return new Point(len * egret.NumberUtils.cos(angle / DEG_TO_RAD), len * egret.NumberUtils.sin(angle / DEG_TO_RAD));
        };
        /**
         * Subtracts the coordinates of another point from the coordinates of this point to create a new point.
         * @param v The point to be subtracted.
         * @returns The new point.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๆญค็น็ๅๆไธญๅๅปๅฆไธไธช็น็ๅๆไปฅๅๅปบไธไธชๆฐ็นใ
         * @param v ่ฆๅๅป็็นใ
         * @returns ๆฐ็นใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.subtract = function (v) {
            return new Point(this.x - v.x, this.y - v.y);
        };
        /**
         * Returns a string that contains the values of the x and y coordinates. The string has the form "(x=x, y=y)", so calling the toString() method for a point at 23,17 would return "(x=23, y=17)".
         * @returns The string representation of the coordinates.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๅๅซ x ๅ y ๅๆ็ๅผ็ๅญ็ฌฆไธฒใ่ฏฅๅญ็ฌฆไธฒ็ๆผๅผไธบ "(x=x, y=y)"๏ผๅๆญคไธบ็น 23,17 ่ฐ็จ toString() ๆนๆณๅฐ่ฟๅ "(x=23, y=17)"ใ
         * @returns ๅๆ็ๅญ็ฌฆไธฒ่กจ็คบๅฝขๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Point.prototype.toString = function () {
            return "(x=" + this.x + ", y=" + this.y + ")";
        };
        return Point;
    }(egret.HashObject));
    egret.Point = Point;
    __reflect(Point.prototype, "egret.Point");
    /**
     * @private
     * ไปไพๆกๆถๅๅค็จ๏ผ่ฆ้ฒๆญขๆด้ฒๅผ็จๅฐๅค้จใ
     */
    egret.$TempPoint = new Point();
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * SpriteSheet is a mosaic of multiple sub-bitmaps, comprising a plurality of Texture objects.
     * Each Texture object shares the set bitmap of SpriteSheet, but it points to its different areas.
     * On WebGL / OpenGL, this operation can significantly improve performance.
     * At the same time, SpriteSheet can carry out material integration easily to reduce the number of HTTP requests
     * For specification of the SpriteSheet format, see the document https://github.com/egret-labs/egret-core/wiki/Egret-SpriteSheet-Specification
     * @see http://edn.egret.com/cn/docs/page/135 The use of texture packs
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/SpriteSheet.ts
     * @language en_US
     */
    /**
     * SpriteSheet ๆฏไธๅผ็ฑๅคไธชๅญไฝๅพๆผๆฅ่ๆ็้ๅไฝๅพ๏ผๅฎๅๅซๅคไธช Texture ๅฏน่ฑกใ
     * ๆฏไธไธช Texture ้ฝๅฑไบซ SpriteSheet ็้ๅไฝๅพ๏ผไฝๆฏๆๅๅฎ็ไธๅ็ๅบๅใ
     * ๅจWebGL / OpenGLไธ๏ผ่ฟ็งๅๆณๅฏไปฅๆพ่ๆๅๆง่ฝ
     * ๅๆถ๏ผSpriteSheetๅฏไปฅๅพๆนไพฟ็่ฟ่ก็ดๆๆดๅ๏ผ้ไฝHTTP่ฏทๆฑๆฐ้
     * SpriteSheet ๆผๅผ็ๅทไฝ่ง่ๅฏไปฅๅ่งๆญคๆๆกฃ  https://github.com/egret-labs/egret-core/wiki/Egret-SpriteSheet-Specification
     * @see http://edn.egret.com/cn/docs/page/135 ็บน็้็ไฝฟ็จ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/SpriteSheet.ts
     * @language zh_CN
     */
    var SpriteSheet = (function (_super) {
        __extends(SpriteSheet, _super);
        /**
         * Create an egret.SpriteSheet object
         * @param texture {Texture} Texture
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.SpriteSheet ๅฏน่ฑก
         * @param texture {Texture} ็บน็
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function SpriteSheet(texture) {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ่กจ็คบ่ฟไธชSpriteSheet็ไฝๅพๅบๅๅจbitmapDataไธ็่ตทๅงไฝ็ฝฎxใ
             */
            _this._bitmapX = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธชSpriteSheet็ไฝๅพๅบๅๅจbitmapDataไธ็่ตทๅงไฝ็ฝฎyใ
             */
            _this._bitmapY = 0;
            /**
             * @private
             * ็บน็็ผๅญๅญๅธ
             */
            _this._textureMap = egret.createMap();
            _this.$texture = texture;
            _this._bitmapX = texture._bitmapX - texture._offsetX;
            _this._bitmapY = texture._bitmapY - texture._offsetY;
            return _this;
        }
        /**
         * Obtain a cached Texture object according to the specified texture name
         * @param name {string} Cache the name of this Texture object
         * @returns {egret.Texture} The Texture object
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆนๆฎๆๅฎ็บน็ๅ็งฐ่ทๅไธไธช็ผๅญ็ Texture ๅฏน่ฑก
         * @param name {string} ็ผๅญ่ฟไธช Texture ๅฏน่ฑกๆไฝฟ็จ็ๅ็งฐ
         * @returns {egret.Texture} Texture ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        SpriteSheet.prototype.getTexture = function (name) {
            return this._textureMap[name];
        };
        /**
         * Create a new Texture object for the specified area on SpriteSheet and cache it
         * @param name {string} Cache the name of this Texture object. If the name already exists, the previous Texture object will be overwrited.
         * @param bitmapX {number} Starting coordinate x of texture area on bitmapData
         * @param bitmapY {number} Starting coordinate y of texture area on bitmapData
         * @param bitmapWidth {number} Width of texture area on bitmapData
         * @param bitmapHeight {number} Height of texture area on bitmapData
         * @param offsetX {number} Starting point x for a non-transparent area of the original bitmap
         * @param offsetY {number} Starting point y for a non-transparent area of the original bitmap
         * @param textureWidth {number} Width of the original bitmap. If it is not passed, use the bitmapWidth  value.
         * @param textureHeight {number} Height of the original bitmap. If it is not passed, use the bitmapHeight value.
         * @returns {egret.Texture} The created Texture object
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธบ SpriteSheet ไธ็ๆๅฎๅบๅๅๅปบไธไธชๆฐ็ Texture ๅฏน่ฑกๅนถ็ผๅญๅฎ
         * @param name {string} ็ผๅญ่ฟไธช Texture ๅฏน่ฑกๆไฝฟ็จ็ๅ็งฐ๏ผๅฆๆๅ็งฐๅทฒๅญๅจ๏ผๅฐไผ่ฆ็ไนๅ็ Texture ๅฏน่ฑก
         * @param bitmapX {number} ็บน็ๅบๅๅจ bitmapData ไธ็่ตทๅงๅๆx
         * @param bitmapY {number} ็บน็ๅบๅๅจ bitmapData ไธ็่ตทๅงๅๆy
         * @param bitmapWidth {number} ็บน็ๅบๅๅจ bitmapData ไธ็ๅฎฝๅบฆ
         * @param bitmapHeight {number} ็บน็ๅบๅๅจ bitmapData ไธ็้ซๅบฆ
         * @param offsetX {number} ๅๅงไฝๅพ็้้ๆๅบๅ x ่ตทๅง็น
         * @param offsetY {number} ๅๅงไฝๅพ็้้ๆๅบๅ y ่ตทๅง็น
         * @param textureWidth {number} ๅๅงไฝๅพ็้ซๅบฆ๏ผ่ฅไธไผๅฅ๏ผๅไฝฟ็จ bitmapWidth ็ๅผใ
         * @param textureHeight {number} ๅๅงไฝๅพ็ๅฎฝๅบฆ๏ผ่ฅไธไผๅฅ๏ผๅไฝฟ็จ bitmapHeight ็ๅผใ
         * @returns {egret.Texture} ๅๅปบ็ Texture ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        SpriteSheet.prototype.createTexture = function (name, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight) {
            if (offsetX === void 0) {
                offsetX = 0;
            }
            if (offsetY === void 0) {
                offsetY = 0;
            }
            if (textureWidth === void 0) {
                textureWidth = offsetX + bitmapWidth;
            }
            if (textureHeight === void 0) {
                textureHeight = offsetY + bitmapHeight;
            }
            var texture = new egret.Texture();
            texture._bitmapData = this.$texture._bitmapData;
            texture.$initData(this._bitmapX + bitmapX, this._bitmapY + bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, this.$texture._sourceWidth, this.$texture._sourceHeight);
            this._textureMap[name] = texture;
            return texture;
        };
        /**
         * dispose texture
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพ็บน็
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        SpriteSheet.prototype.dispose = function () {
            if (this.$texture) {
                this.$texture.dispose();
            }
        };
        return SpriteSheet;
    }(egret.HashObject));
    egret.SpriteSheet = SpriteSheet;
    __reflect(SpriteSheet.prototype, "egret.SpriteSheet");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @class egret.GlowFilter
     * @classdesc
     * ไฝฟ็จ GlowFilter ็ฑปๅฏไปฅๅฏนๆพ็คบๅฏน่ฑกๅบ็จๅๅๆๆใๅจๆๅฝฑๆปค้็ distance ๅ angle ๅฑๆง่ฎพ็ฝฎไธบ 0 ๆถ๏ผๅๅๆปค้ไธๆๅฝฑๆปค้ๆไธบ็ธไผผใ
     * @extends egret.Filter
     * @version Egret 3.1.4
     * @platform Web,Native
     */
    var GlowFilter = (function (_super) {
        __extends(GlowFilter, _super);
        /**
         * Initializes a new GlowFilter instance.
         * @method egret.GlowFilter#constructor
         * @param color {number} The color of the glow. Valid values are in the hexadecimal format 0xRRGGBB. The default value is 0xFF0000.
         * @param alpha {number} The alpha transparency value for the color. Valid values are 0 to 1. For example, .25 sets a transparency value of 25%. The default value is 1.
         * @param blurX {number} The amount of horizontal blur. Valid values are 0 to 255 (floating point).
         * @param blurY {number} The amount of vertical blur. Valid values are 0 to 255 (floating point).
         * @param strength {number} The strength of the imprint or spread. The higher the value, the more color is imprinted and the stronger the contrast between the glow and the background. Valid values are 0 to 255.
         * @param quality {number} The number of times to apply the filter.
         * @param inner {boolean} Specifies whether the glow is an inner glow. The value true indicates an inner glow. The default is false, an outer glow (a glow around the outer edges of the object).
         * @param knockout {number} Specifies whether the object has a knockout effect. A value of true makes the object's fill transparent and reveals the background color of the document. The default value is false (no knockout effect).
         * @version Egret 3.1.4
         * @platform Web
         * @language en_US
         */
        /**
         * ๅๅงๅ GlowFilter ๅฏน่ฑก
         * @method egret.GlowFilter#constructor
         * @param color {number} ๅๆ้ข่ฒ๏ผ้็จๅๅญ่ฟๅถๆผๅผ 0xRRGGBBใ้ป่ฎคๅผไธบ 0xFF0000ใ
         * @param alpha {number} ้ข่ฒ็ Alpha ้ๆๅบฆๅผใๆๆๅผไธบ 0 ๅฐ 1ใไพๅฆ๏ผ0.25 ่ฎพ็ฝฎ้ๆๅบฆๅผไธบ 25%ใ
         * @param blurX {number} ๆฐดๅนณๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param blurY {number} ๅ็ดๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param strength {number} ๅฐ่ฎฐๆ่ทจ้กต็ๅผบๅบฆใ่ฏฅๅผ่ถ้ซ๏ผๅๅฐ็้ข่ฒ่ถๆทฑ๏ผ่ไธๅๅไธ่ๆฏไน้ด็ๅฏนๆฏๅบฆไน่ถๅผบใๆๆๅผไธบ 0 ๅฐ 255ใ
         * @param quality {number} ๅบ็จๆปค้็ๆฌกๆฐใๆๆชๅฎ็ฐใ
         * @param inner {boolean} ๆๅฎๅๅๆฏๅฆไธบๅไพงๅๅใๅผ true ๆๅฎๅๅๆฏๅไพงๅๅใๅผ false ๆๅฎๅๅๆฏๅคไพงๅๅ๏ผๅฏน่ฑกๅค็ผๅจๅด็ๅๅ๏ผใ
         * @param knockout {number} ๆๅฎๅฏน่ฑกๆฏๅฆๅทๆๆ็ฉบๆๆใๅผไธบ true ๅฐไฝฟๅฏน่ฑก็ๅกซๅๅไธบ้ๆ๏ผๅนถๆพ็คบๆๆกฃ็่ๆฏ้ข่ฒใ
         * @version Egret 3.1.4
         * @platform Web
         * @language zh_CN
         */
        function GlowFilter(color, alpha, blurX, blurY, strength, quality, inner, knockout) {
            if (color === void 0) {
                color = 0xFF0000;
            }
            if (alpha === void 0) {
                alpha = 1.0;
            }
            if (blurX === void 0) {
                blurX = 6.0;
            }
            if (blurY === void 0) {
                blurY = 6.0;
            }
            if (strength === void 0) {
                strength = 2;
            }
            if (quality === void 0) {
                quality = 1;
            }
            if (inner === void 0) {
                inner = false;
            }
            if (knockout === void 0) {
                knockout = false;
            }
            var _this = _super.call(this) || this;
            _this.type = "glow";
            _this.$color = color;
            _this.$blue = color & 0x0000FF;
            _this.$green = (color & 0x00ff00) >> 8;
            _this.$red = color >> 16;
            _this.$alpha = alpha;
            _this.$blurX = blurX;
            _this.$blurY = blurY;
            _this.$strength = strength;
            _this.$quality = quality;
            _this.$inner = inner;
            _this.$knockout = knockout;
            _this.$uniforms.color = { x: _this.$red / 255, y: _this.$green / 255, z: _this.$blue / 255, w: 1 };
            _this.$uniforms.alpha = alpha;
            _this.$uniforms.blurX = blurX;
            _this.$uniforms.blurY = blurY;
            _this.$uniforms.strength = strength;
            // this.$uniforms.quality = quality;
            _this.$uniforms.inner = inner ? 1 : 0;
            _this.$uniforms.knockout = knockout ? 0 : 1;
            return _this;
        }
        Object.defineProperty(GlowFilter.prototype, "color", {
            /**
             * The color of the glow.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๅๆ้ข่ฒใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$color;
            },
            set: function (value) {
                if (this.$color == value) {
                    return;
                }
                this.$color = value;
                this.$blue = value & 0x0000FF;
                this.$green = (value & 0x00ff00) >> 8;
                this.$red = value >> 16;
                this.$uniforms.color.x = this.$red / 255;
                this.$uniforms.color.y = this.$green / 255;
                this.$uniforms.color.z = this.$blue / 255;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "alpha", {
            /**
             * The alpha transparency value for the color.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ้ข่ฒ็ Alpha ้ๆๅบฆๅผใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$alpha;
            },
            set: function (value) {
                if (this.$alpha == value) {
                    return;
                }
                this.$alpha = value;
                this.$uniforms.alpha = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "blurX", {
            /**
             * The amount of horizontal blur.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๆฐดๅนณๆจก็ณ้ใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$blurX;
            },
            set: function (value) {
                if (this.$blurX == value) {
                    return;
                }
                this.$blurX = value;
                this.$uniforms.blurX = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "blurY", {
            /**
             * The amount of vertical blur.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๅ็ดๆจก็ณ้ใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$blurY;
            },
            set: function (value) {
                if (this.$blurY == value) {
                    return;
                }
                this.$blurY = value;
                this.$uniforms.blurY = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "strength", {
            /**
             * The strength of the imprint or spread.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๅฐ่ฎฐๆ่ทจ้กต็ๅผบๅบฆใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$strength;
            },
            set: function (value) {
                if (this.$strength == value) {
                    return;
                }
                this.$strength = value;
                this.$uniforms.strength = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "quality", {
            /**
             * The number of times to apply the filter.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๅบ็จๆปค้็ๆฌกๆฐใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$quality;
            },
            set: function (value) {
                if (this.$quality == value) {
                    return;
                }
                this.$quality = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "inner", {
            /**
             * Specifies whether the glow is an inner glow.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๆๅฎๅๅๆฏๅฆไธบๅไพงๅๅใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$inner;
            },
            set: function (value) {
                if (this.$inner == value) {
                    return;
                }
                this.$inner = value;
                this.$uniforms.inner = value ? 1 : 0;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(GlowFilter.prototype, "knockout", {
            /**
             * Specifies whether the object has a knockout effect.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๆๅฎๅฏน่ฑกๆฏๅฆๅทๆๆ็ฉบๆๆใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$knockout;
            },
            set: function (value) {
                if (this.$knockout == value) {
                    return;
                }
                this.$knockout = value;
                this.$uniforms.knockout = value ? 0 : 1;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        GlowFilter.prototype.$toJson = function () {
            return '{"color": ' + this.$color + ', "red": ' + this.$red + ', "green": ' + this.$green + ', "blue": ' + this.$blue + ', "alpha": ' + this.$alpha + ', "blurX": ' + this.$blurX + ', "blurY": ' + this.blurY + ', "strength": ' + this.$strength + ', "quality": ' + this.$quality + ', "inner": ' + this.$inner + ', "knockout": ' + this.$knockout + '}';
        };
        return GlowFilter;
    }(egret.Filter));
    egret.GlowFilter = GlowFilter;
    __reflect(GlowFilter.prototype, "egret.GlowFilter");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Sprite class is a basic display list building block: a display list node that can contain children.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Sprite.ts
     * @language en_US
     */
    /**
     * Sprite ็ฑปๆฏๅบๆฌๆพ็คบๅ่กจๆ้ๅ๏ผไธไธชๅฏๅๅซๅญ้กน็ๆพ็คบๅ่กจ่็นใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Sprite.ts
     * @language zh_CN
     */
    var Sprite = (function (_super) {
        __extends(Sprite, _super);
        /**
         * Creates a new Sprite instance.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฎไพๅไธไธชๅฎนๅจ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Sprite() {
            var _this = _super.call(this) || this;
            _this.$graphics = new egret.Graphics();
            _this.$graphics.$setTarget(_this);
            return _this;
        }
        Object.defineProperty(Sprite.prototype, "graphics", {
            /**
             * Specifies the Graphics object belonging to this Shape object, where vector drawing commands can occur.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅ Shape ไธญ็ Graphics ๅฏน่ฑกใๅฏ้่ฟๆญคๅฏน่ฑกๆง่ก็ข้็ปๅพๅฝไปคใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$graphics;
            },
            enumerable: true,
            configurable: true
        });
        Sprite.prototype.$hitTest = function (stageX, stageY) {
            if (!this.$visible) {
                return null;
            }
            var m = this.$getInvertedConcatenatedMatrix();
            var localX = m.a * stageX + m.c * stageY + m.tx;
            var localY = m.b * stageX + m.d * stageY + m.ty;
            var rect = this.$scrollRect ? this.$scrollRect : this.$maskRect;
            if (rect && !rect.contains(localX, localY)) {
                return null;
            }
            if (this.$mask && !this.$mask.$hitTest(stageX, stageY)) {
                return null;
            }
            var children = this.$children;
            var found = false;
            var target = null;
            for (var i = children.length - 1; i >= 0; i--) {
                var child = children[i];
                if (child.$maskedObject) {
                    continue;
                }
                target = child.$hitTest(stageX, stageY);
                if (target) {
                    found = true;
                    if (target.$touchEnabled) {
                        break;
                    }
                    else {
                        target = null;
                    }
                }
            }
            if (target) {
                if (this.$touchChildren) {
                    return target;
                }
                return this;
            }
            if (found) {
                return this;
            }
            target = egret.DisplayObject.prototype.$hitTest.call(this, stageX, stageY);
            if (target) {
                target = this.$graphics.$hitTest(stageX, stageY);
            }
            return target;
        };
        /**
         * @private
         */
        Sprite.prototype.$measureContentBounds = function (bounds) {
            this.$graphics.$measureContentBounds(bounds);
        };
        /**
         * @private
         */
        Sprite.prototype.$onRemoveFromStage = function () {
            _super.prototype.$onRemoveFromStage.call(this);
            if (this.$graphics) {
                this.$graphics.$onRemoveFromStage();
            }
        };
        return Sprite;
    }(egret.DisplayObjectContainer));
    egret.Sprite = Sprite;
    __reflect(Sprite.prototype, "egret.Sprite");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    egret.$TextureScaleFactor = 1;
    /**
     * The Texture class encapsulates different image resources on different platforms.
     * In HTML5, resource is an HTMLElement object
     * In OpenGL / WebGL, resource is a texture ID obtained after the GPU is submitted
     * The Texture class encapsulates the details implemented on the underlayer. Developers just need to focus on interfaces
     * @see http://edn.egret.com/cn/docs/page/135 The use of texture packs
     * @see http://edn.egret.com/cn/docs/page/123 Several ways of access to resources
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Texture.ts
     * @language en_US
     */
    /**
     * ็บน็็ฑปๆฏๅฏนไธๅๅนณๅฐไธๅ็ๅพ็่ตๆบ็ๅฐ่ฃ
     * ๅจHTML5ไธญ๏ผ่ตๆบๆฏไธไธชHTMLElementๅฏน่ฑก
     * ๅจOpenGL / WebGLไธญ๏ผ่ตๆบๆฏไธไธชๆไบคGPUๅ่ทๅ็็บน็id
     * Texture็ฑปๅฐ่ฃไบ่ฟไบๅบๅฑๅฎ็ฐ็็ป่๏ผๅผๅ่ๅช้่ฆๅณๅฟๆฅๅฃๅณๅฏ
     * @see http://edn.egret.com/cn/docs/page/135 ็บน็้็ไฝฟ็จ
     * @see http://edn.egret.com/cn/docs/page/123 ่ทๅ่ตๆบ็ๅ็งๆนๅผ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Texture.ts
     * @language zh_CN
     */
    var Texture = (function (_super) {
        __extends(Texture, _super);
        /**
         * Create an egret.Texture object
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.Texture ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Texture() {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๅจ bitmapData ไธ็ x ่ตทๅงไฝ็ฝฎ
             */
            _this._bitmapX = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๅจ bitmapData ไธ็ y ่ตทๅงไฝ็ฝฎ
             */
            _this._bitmapY = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๅจ bitmapData ไธ็ๅฎฝๅบฆ
             */
            _this._bitmapWidth = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๅจ bitmapData ไธ็้ซๅบฆ
             */
            _this._bitmapHeight = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๆพ็คบไบไนๅๅจ x ๆนๅ็ๆธฒๆๅ็งป้
             */
            _this._offsetX = 0;
            /**
             * @private
             * ่กจ็คบ่ฟไธช็บน็ๆพ็คบไบไนๅๅจ y ๆนๅ็ๆธฒๆๅ็งป้
             */
            _this._offsetY = 0;
            /**
             * @private
             * ็บน็ๅฎฝๅบฆ
             */
            _this._textureWidth = 0;
            /**
             * @private
             * ็บน็้ซๅบฆ
             */
            _this._textureHeight = 0;
            /**
             * @private
             * ่กจ็คบbitmapData.width
             */
            _this._sourceWidth = 0;
            /**
             * @private
             * ่กจ็คบbitmapData.height
             */
            _this._sourceHeight = 0;
            /**
             * @private
             */
            _this._bitmapData = null;
            /**
             * @private
             */
            _this.$rotated = false;
            return _this;
        }
        Object.defineProperty(Texture.prototype, "textureWidth", {
            /**
             * Texture width, read only
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็บน็ๅฎฝๅบฆ๏ผๅช่ฏปๅฑๆง๏ผไธๅฏไปฅ่ฎพ็ฝฎ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getTextureWidth();
            },
            enumerable: true,
            configurable: true
        });
        Texture.prototype.$getTextureWidth = function () {
            return this._textureWidth;
        };
        Object.defineProperty(Texture.prototype, "textureHeight", {
            /**
             * Texture height, read only
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็บน็้ซๅบฆ๏ผๅช่ฏปๅฑๆง๏ผไธๅฏไปฅ่ฎพ็ฝฎ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getTextureHeight();
            },
            enumerable: true,
            configurable: true
        });
        Texture.prototype.$getTextureHeight = function () {
            return this._textureHeight;
        };
        Texture.prototype.$getScaleBitmapWidth = function () {
            return this._bitmapWidth * egret.$TextureScaleFactor;
        };
        Texture.prototype.$getScaleBitmapHeight = function () {
            return this._bitmapHeight * egret.$TextureScaleFactor;
        };
        Object.defineProperty(Texture.prototype, "bitmapData", {
            /**
             * The BitmapData object being referenced.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ขซๅผ็จ็ BitmapData ๅฏน่ฑกใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._bitmapData;
            },
            set: function (value) {
                this._setBitmapData(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
        * Set the BitmapData object.
        * @version Egret 3.2.1
        * @platform Web,Native
        * @language en_US
        */
        /**
         * ่ฎพ็ฝฎ BitmapData ๅฏน่ฑกใ
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language zh_CN
         */
        Texture.prototype._setBitmapData = function (value) {
            this._bitmapData = value;
            var scale = egret.$TextureScaleFactor;
            var w = value.width * scale;
            var h = value.height * scale;
            this.$initData(0, 0, w, h, 0, 0, w, h, value.width, value.height);
        };
        /**
         * @private
         * ่ฎพ็ฝฎTextureๆฐๆฎ
         * @param bitmapX
         * @param bitmapY
         * @param bitmapWidth
         * @param bitmapHeight
         * @param offsetX
         * @param offsetY
         * @param textureWidth
         * @param textureHeight
         * @param sourceWidth
         * @param sourceHeight
         */
        Texture.prototype.$initData = function (bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, sourceWidth, sourceHeight, rotated) {
            if (rotated === void 0) {
                rotated = false;
            }
            var scale = egret.$TextureScaleFactor;
            this._bitmapX = bitmapX / scale;
            this._bitmapY = bitmapY / scale;
            this._bitmapWidth = bitmapWidth / scale;
            this._bitmapHeight = bitmapHeight / scale;
            this._offsetX = offsetX;
            this._offsetY = offsetY;
            this._textureWidth = textureWidth;
            this._textureHeight = textureHeight;
            this._sourceWidth = sourceWidth;
            this._sourceHeight = sourceHeight;
            this.$rotated = rotated;
            //todo
            egret.BitmapData.$invalidate(this);
        };
        /**
         * @deprecated
         */
        Texture.prototype.getPixel32 = function (x, y) {
            throw new Error();
        };
        /**
         * Obtain the color value for the specified pixel region
         * @param x  The x coordinate of the pixel region
         * @param y  The y coordinate of the pixel region
         * @param width  The width of the pixel region
         * @param height  The height of the pixel region
         * @returns  Specifies the color value for the pixel region
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅๆๅฎๅ็ดๅบๅ็้ข่ฒๅผ
         * @param x  ๅ็ดๅบๅ็X่ฝดๅๆ
         * @param y  ๅ็ดๅบๅ็Y่ฝดๅๆ
         * @param width  ๅ็ด็น็Y่ฝดๅๆ
         * @param height  ๅ็ด็น็Y่ฝดๅๆ
         * @returns  ๆๅฎๅ็ดๅบๅ็้ข่ฒๅผ
         * @version Egret 3.2.1
         * @platform Web
         * @language zh_CN
         */
        Texture.prototype.getPixels = function (x, y, width, height) {
            if (width === void 0) {
                width = 1;
            }
            if (height === void 0) {
                height = 1;
            }
            throw new Error();
        };
        /**
         * Convert base64 string, if the picture (or pictures included) cross-border or null
         * @param type Type conversions, such as "image / png"
         * @param rect The need to convert the area
         * @param smoothing Whether to convert data to the smoothing process
         * @returns {any} base64 string
         * @version Egret 2.4
         * @language en_US
         */
        /**
         * ่ฝฌๆขๆbase64ๅญ็ฌฆไธฒ๏ผๅฆๆๅพ็๏ผๆ่ๅๅซ็ๅพ็๏ผ่ทจๅ๏ผๅ่ฟๅnull
         * @param type ่ฝฌๆข็็ฑปๅ๏ผๅฆ  "image/png"
         * @param rect ้่ฆ่ฝฌๆข็ๅบๅ
         * @param {any} encoderOptions ็ผ็็จ็ๅๆฐ
         * @returns {any} base64ๅญ็ฌฆไธฒ
         * @version Egret 2.4
         * @language zh_CN
         */
        Texture.prototype.toDataURL = function (type, rect, encoderOptions) {
            throw new Error();
        };
        /**
         * Crop designated area and save it as image.
         * native support only "image / png" and "image / jpeg"; Web browser because of the various implementations are not the same, it is recommended to use only these two kinds.
         * @param type Type conversions, such as "image / png"
         * @param filePath The path name of the image (the home directory for the game's private space, the path can not have "../",Web supports only pass names.)
         * @param rect The need to convert the area
         * @version Egret 2.4
         * @platform Native
         * @language en_US
         */
        /**
         * ่ฃๅชๆๅฎๅบๅๅนถไฟๅญๆๅพ็ใ
         * nativeๅชๆฏๆ "image/png" ๅ "image/jpeg"๏ผWebไธญ็ฑไบๅไธชๆต่งๅจ็ๅฎ็ฐไธไธๆท๏ผๅๆญคๅปบ่ฎฎไนๅช็จ่ฟ2็งใ
         * @param type ่ฝฌๆข็็ฑปๅ๏ผๅฆ  "image/png"
         * @param filePath ๅพ็็ๅ็งฐ็่ทฏๅพ๏ผไธป็ฎๅฝไธบๆธธๆ็็งๆ็ฉบ้ด๏ผ่ทฏๅพไธญไธ่ฝๆ "../"๏ผWebๅชๆฏๆไผๅ็งฐใ๏ผ
         * @param rect ้่ฆ่ฝฌๆข็ๅบๅ
         * @version Egret 2.4
         * @platform Native
         * @language zh_CN
         */
        Texture.prototype.saveToFile = function (type, filePath, rect) {
            throw new Error();
        };
        /**
         * dispose texture
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพ็บน็
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Texture.prototype.dispose = function () {
            if (this._bitmapData) {
                this._bitmapData.$dispose();
                this._bitmapData = null;
            }
        };
        return Texture;
    }(egret.HashObject));
    egret.Texture = Texture;
    __reflect(Texture.prototype, "egret.Texture");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Bitmap class represents display objects that represent bitmap images.
     * The Bitmap() constructor allows you to create a Bitmap object that contains a reference to a BitmapData object.
     * After you create a Bitmap object, use the addChild() or addChildAt() method of the parent DisplayObjectContainer
     * instance to place the bitmap on the display list.A Bitmap object can share its texture reference among several
     * Bitmap objects, independent of translation or rotation properties. Because you can create multiple Bitmap objects
     * that reference the same texture object, multiple display objects can use the same complex texture object
     * without incurring the memory overhead of a texture object for each display object instance.
     *
     * @see egret.Texture
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Bitmap.ts
     * @language en_US
     */
    /**
     * Bitmap ็ฑป่กจ็คบ็จไบๆพ็คบไฝๅพๅพ็็ๆพ็คบๅฏน่ฑกใ
     * ๅฉ็จ Bitmap() ๆ้ๅฝๆฐ๏ผๅฏไปฅๅๅปบๅๅซๅฏน BitmapData ๅฏน่ฑกๅผ็จ็ Bitmap ๅฏน่ฑกใๅๅปบไบ Bitmap ๅฏน่ฑกๅ๏ผ
     * ไฝฟ็จ็ถ็บง DisplayObjectContainer ๅฎไพ็ addChild() ๆ addChildAt() ๆนๆณๅฏไปฅๅฐไฝๅพๆพๅจๆพ็คบๅ่กจไธญใ
     * ไธไธช Bitmap ๅฏน่ฑกๅฏๅจ่ฅๅนฒ Bitmap ๅฏน่ฑกไนไธญๅฑไบซๅถ texture ๅผ็จ๏ผไธ็ผฉๆพๆๆ่ฝฌๅฑๆงๆๅณใ
     * ็ฑไบ่ฝๅคๅๅปบๅผ็จ็ธๅ texture ๅฏน่ฑก็ๅคไธช Bitmap ๅฏน่ฑก๏ผๅๆญค๏ผๅคไธชๆพ็คบๅฏน่ฑกๅฏไปฅไฝฟ็จ็ธๅ็ texture ๅฏน่ฑก๏ผ
     * ่ไธไผๅไธบๆฏไธชๆพ็คบๅฏน่ฑกๅฎไพไฝฟ็จไธไธช texture ๅฏน่ฑก่ไบง็้ขๅคๅๅญๅผ้ใ
     *
     * @see egret.Texture
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Bitmap.ts
     * @language zh_CN
     */
    var Bitmap = (function (_super) {
        __extends(Bitmap, _super);
        /**
         * Initializes a Bitmap object to refer to the specified BitmapData|Texture object.
         * @param value The BitmapData|Texture object being referenced.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๅผ็จๆๅฎ BitmapData|Texture ๅฎไพ็ Bitmap ๅฏน่ฑก
         * @param value ่ขซๅผ็จ็ BitmapData|Texture ๅฎไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Bitmap(value) {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$scale9Grid = null;
            /**
             * @private
             */
            _this.$fillMode = "scale";
            _this._pixelHitTest = false;
            _this.$renderNode = new egret.sys.BitmapNode();
            _this.$Bitmap = {
                0: null,
                1: null,
                2: 0,
                3: 0,
                4: 0,
                5: 0,
                6: 0,
                7: 0,
                8: 0,
                9: 0,
                10: Bitmap.defaultSmoothing,
                11: NaN,
                12: NaN,
                13: NaN,
                14: NaN,
            };
            _this.$setBitmapData(value);
            if (value instanceof egret.Texture) {
                _this.$renderNode.rotated = value.$rotated;
            }
            return _this;
        }
        /**
         * @private
         * ๆพ็คบๅฏน่ฑกๆทปๅๅฐ่ๅฐ
         */
        Bitmap.prototype.$onAddToStage = function (stage, nestLevel) {
            _super.prototype.$onAddToStage.call(this, stage, nestLevel);
            var bitmapData = this.$Bitmap[0 /* bitmapData */];
            if (bitmapData) {
                egret.BitmapData.$addDisplayObject(this, bitmapData);
            }
        };
        /**
         * @private
         * ๆพ็คบๅฏน่ฑกไป่ๅฐ็งป้ค
         */
        Bitmap.prototype.$onRemoveFromStage = function () {
            _super.prototype.$onRemoveFromStage.call(this);
            var bitmapData = this.$Bitmap[0 /* bitmapData */];
            if (bitmapData) {
                egret.BitmapData.$removeDisplayObject(this, bitmapData);
            }
        };
        Object.defineProperty(Bitmap.prototype, "bitmapData", {
            /**
             * The BitmapData object being referenced.
             * If you pass the constructor of type Texture or last set for texture, this value returns null.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ขซๅผ็จ็ BitmapData ๅฏน่ฑกใ
             * ๅฆๆไผๅฅๆ้ๅฝๆฐ็็ฑปๅไธบ Texture ๆ่ๆๅ่ฎพ็ฝฎ็ไธบ texture๏ผๅๆญคๅผ่ฟๅ nullใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var value = this.$Bitmap[0 /* bitmapData */];
                if (value instanceof egret.Texture) {
                    return null;
                }
                else {
                    return value;
                }
            },
            set: function (value) {
                this.$setBitmapData(value);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Bitmap.prototype, "texture", {
            /**
             * The Texture object being referenced.
             * If you pass the constructor of type BitmapData or last set for bitmapData, this value returns null.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ขซๅผ็จ็ Texture ๅฏน่ฑกใ
             * ๅฆๆไผๅฅๆ้ๅฝๆฐ็็ฑปๅไธบ BitmapData ๆ่ๆๅ่ฎพ็ฝฎ็ไธบ bitmapData๏ผๅๆญคๅผ่ฟๅ nullใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var value = this.$Bitmap[0 /* bitmapData */];
                if (value instanceof egret.Texture) {
                    return value;
                }
                else {
                    return null;
                }
            },
            set: function (value) {
                var self = this;
                self.$setBitmapData(value);
                if (value && self.$renderNode) {
                    self.$renderNode.rotated = value.$rotated;
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Bitmap.prototype.$setBitmapData = function (value) {
            var values = this.$Bitmap;
            var oldBitmapData = values[0 /* bitmapData */];
            if (value == oldBitmapData) {
                return false;
            }
            values[0 /* bitmapData */] = value;
            if (value) {
                this.$refreshImageData();
            }
            else {
                if (oldBitmapData) {
                    egret.BitmapData.$removeDisplayObject(this, oldBitmapData);
                }
                this.setImageData(null, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
                this.$invalidateContentBounds();
                return true;
            }
            if (this.$stage) {
                if (oldBitmapData) {
                    var oldHashCode = void 0;
                    if (oldBitmapData._bitmapData && oldBitmapData._bitmapData.hashCode) {
                        oldHashCode = oldBitmapData._bitmapData.hashCode;
                    }
                    else {
                        oldHashCode = oldBitmapData.hashCode;
                    }
                    var newHashCode = void 0;
                    if (value._bitmapData && value._bitmapData.hashCode) {
                        newHashCode = value._bitmapData.hashCode;
                    }
                    else {
                        newHashCode = value.hashCode;
                    }
                    if (oldHashCode == newHashCode) {
                        this.$invalidateContentBounds();
                        return true;
                    }
                    egret.BitmapData.$removeDisplayObject(this, oldBitmapData);
                }
                egret.BitmapData.$addDisplayObject(this, value);
            }
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         */
        Bitmap.prototype.$refreshImageData = function () {
            var values = this.$Bitmap;
            var bitmapData = values[0 /* bitmapData */];
            if (bitmapData) {
                if (bitmapData instanceof egret.Texture) {
                    this.setImageData(bitmapData._bitmapData, bitmapData._bitmapX, bitmapData._bitmapY, bitmapData._bitmapWidth, bitmapData._bitmapHeight, bitmapData._offsetX, bitmapData._offsetY, bitmapData.$getTextureWidth(), bitmapData.$getTextureHeight(), bitmapData._sourceWidth, bitmapData._sourceHeight);
                }
                else {
                    var width = bitmapData.width;
                    var height = bitmapData.height;
                    this.setImageData(bitmapData, 0, 0, width, height, 0, 0, width, height, width, height);
                }
            }
        };
        /**
         * @private
         */
        Bitmap.prototype.setImageData = function (image, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, sourceWidth, sourceHeight) {
            var values = this.$Bitmap;
            values[1 /* image */] = image;
            values[2 /* bitmapX */] = bitmapX;
            values[3 /* bitmapY */] = bitmapY;
            values[4 /* bitmapWidth */] = bitmapWidth;
            values[5 /* bitmapHeight */] = bitmapHeight;
            values[6 /* offsetX */] = offsetX;
            values[7 /* offsetY */] = offsetY;
            values[8 /* textureWidth */] = textureWidth;
            values[9 /* textureHeight */] = textureHeight;
            values[13 /* sourceWidth */] = sourceWidth;
            values[14 /* sourceHeight */] = sourceHeight;
        };
        Object.defineProperty(Bitmap.prototype, "scale9Grid", {
            /**
             * Represent a Rectangle Area that the 9 scale area of Image.
             * Notice: This property is valid only when <code>fillMode</code>
             * is <code>BitmapFillMode.SCALE</code>.
             *
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฉๅฝขๅบๅ๏ผๅฎๅฎไน็ดๆๅฏน่ฑก็ไนไธช็ผฉๆพๅบๅใ
             * ๆณจๆ:ๆญคๅฑๆงไปๅจ<code>fillMode</code>ไธบ<code>BitmapFillMode.SCALE</code>ๆถๆๆใ
             *
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$scale9Grid;
            },
            set: function (value) {
                this.$scale9Grid = value;
                this.$invalidateContentBounds();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Bitmap.prototype, "fillMode", {
            /**
             * Determines how the bitmap fills in the dimensions.
             * <p>When set to <code>BitmapFillMode.REPEAT</code>, the bitmap
             * repeats to fill the region.</p>
             * <p>When set to <code>BitmapFillMode.SCALE</code>, the bitmap
             * stretches to fill the region.</p>
             *
             * @default <code>BitmapFillMode.SCALE</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ็กฎๅฎไฝๅพๅกซๅๅฐบๅฏธ็ๆนๅผใ
             * <p>่ฎพ็ฝฎไธบ <code>BitmapFillMode.REPEAT</code>ๆถ๏ผไฝๅพๅฐ้ๅคไปฅๅกซๅๅบๅใ</p>
             * <p>่ฎพ็ฝฎไธบ <code>BitmapFillMode.SCALE</code>ๆถ๏ผไฝๅพๅฐๆไผธไปฅๅกซๅๅบๅใ</p>
             *
             * @default <code>BitmapFillMode.SCALE</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$fillMode;
            },
            set: function (value) {
                this.$setFillMode(value);
            },
            enumerable: true,
            configurable: true
        });
        Bitmap.prototype.$setFillMode = function (value) {
            if (value == this.$fillMode) {
                return false;
            }
            this.$fillMode = value;
            return true;
        };
        Object.defineProperty(Bitmap.prototype, "smoothing", {
            /**
             * Whether or not the bitmap is smoothed when scaled.
             * @version Egret 2.4
             * @platform Web
             * @language en_US
             */
            /**
             * ๆงๅถๅจ็ผฉๆพๆถๆฏๅฆๅฏนไฝๅพ่ฟ่กๅนณๆปๅค็ใ
             * @version Egret 2.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                var values = this.$Bitmap;
                return values[10 /* smoothing */];
            },
            set: function (value) {
                value = !!value;
                var values = this.$Bitmap;
                if (value == values[10 /* smoothing */]) {
                    return;
                }
                values[10 /* smoothing */] = value;
                this.$invalidate();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        Bitmap.prototype.$setWidth = function (value) {
            //value = +value || 0;
            var values = this.$Bitmap;
            if (value < 0 || value == values[11 /* explicitBitmapWidth */]) {
                return false;
            }
            values[11 /* explicitBitmapWidth */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         *
         * @param value
         */
        Bitmap.prototype.$setHeight = function (value) {
            //value = +value || 0;
            var values = this.$Bitmap;
            if (value < 0 || value == values[12 /* explicitBitmapHeight */]) {
                return false;
            }
            values[12 /* explicitBitmapHeight */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         * ่ทๅๆพ็คบๅฎฝๅบฆ
         */
        Bitmap.prototype.$getWidth = function () {
            var values = this.$Bitmap;
            return isNaN(values[11 /* explicitBitmapWidth */]) ? this.$getContentBounds().width : values[11 /* explicitBitmapWidth */];
        };
        /**
         * @private
         * ่ทๅๆพ็คบๅฎฝๅบฆ
         */
        Bitmap.prototype.$getHeight = function () {
            var values = this.$Bitmap;
            return isNaN(values[12 /* explicitBitmapHeight */]) ? this.$getContentBounds().height : values[12 /* explicitBitmapHeight */];
        };
        /**
         * @private
         */
        Bitmap.prototype.$measureContentBounds = function (bounds) {
            var values = this.$Bitmap;
            if (values[1 /* image */]) {
                var values_1 = this.$Bitmap;
                var w = !isNaN(values_1[11 /* explicitBitmapWidth */]) ? values_1[11 /* explicitBitmapWidth */] : values_1[8 /* textureWidth */];
                var h = !isNaN(values_1[12 /* explicitBitmapHeight */]) ? values_1[12 /* explicitBitmapHeight */] : values_1[9 /* textureHeight */];
                bounds.setTo(0, 0, w, h);
            }
            else {
                var w = !isNaN(values[11 /* explicitBitmapWidth */]) ? values[11 /* explicitBitmapWidth */] : 0;
                var h = !isNaN(values[12 /* explicitBitmapHeight */]) ? values[12 /* explicitBitmapHeight */] : 0;
                bounds.setTo(0, 0, w, h);
            }
        };
        /**
         * @private
         */
        Bitmap.prototype.$render = function () {
            var values = this.$Bitmap;
            if (values[1 /* image */]) {
                var destW = !isNaN(values[11 /* explicitBitmapWidth */]) ? values[11 /* explicitBitmapWidth */] : values[8 /* textureWidth */];
                var destH = !isNaN(values[12 /* explicitBitmapHeight */]) ? values[12 /* explicitBitmapHeight */] : values[9 /* textureHeight */];
                egret.sys.BitmapNode.$updateTextureData(this.$renderNode, values[1 /* image */], values[2 /* bitmapX */], values[3 /* bitmapY */], values[4 /* bitmapWidth */], values[5 /* bitmapHeight */], values[6 /* offsetX */], values[7 /* offsetY */], values[8 /* textureWidth */], values[9 /* textureHeight */], destW, destH, values[13 /* sourceWidth */], values[14 /* sourceHeight */], this.scale9Grid || values[0 /* bitmapData */]["scale9Grid"], this.fillMode, values[10 /* smoothing */]);
            }
        };
        Object.defineProperty(Bitmap.prototype, "pixelHitTest", {
            /**
             * Specifies whether this object use precise hit testing by checking the alpha value of each pixel.If pixelHitTest
             * is set to true,the transparent area of the bitmap will be touched through.<br/>
             * Note:If the image is loaded from cross origin,that we can't access to the pixel data,so it might cause
             * the pixelHitTest property invalid.
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฏๅฆๅผๅฏ็ฒพ็กฎๅ็ด็ขฐๆใ่ฎพ็ฝฎไธบtrueๆพ็คบๅฏน่ฑกๆฌ่บซ็้ๆๅบๅๅฐ่ฝๅค่ขซ็ฉฟ้ใ<br/>
             * ๆณจๆ๏ผ่ฅๅพ็่ตๆบๆฏไปฅ่ทจๅๆนๅผไปๅค้จๆๅกๅจๅ่ฝฝ็๏ผๅฐๆๆณ่ฎฟ้ฎๅพ็็ๅ็ดๆฐๆฎ๏ผ่ๅฏผ่ดๆญคๅฑๆงๅคฑๆใ
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._pixelHitTest;
            },
            set: function (value) {
                this._pixelHitTest = !!value;
            },
            enumerable: true,
            configurable: true
        });
        Bitmap.prototype.$hitTest = function (stageX, stageY) {
            var target = _super.prototype.$hitTest.call(this, stageX, stageY);
            if (target && this._pixelHitTest) {
                target = this.hitTestPixel(stageX, stageY);
            }
            return target;
        };
        /**
         * @private
         */
        Bitmap.prototype.hitTestPixel = function (stageX, stageY) {
            var m = this.$getInvertedConcatenatedMatrix();
            var localX = m.a * stageX + m.c * stageY + m.tx;
            var localY = m.b * stageX + m.d * stageY + m.ty;
            var data;
            var displayList = this.$displayList;
            if (displayList) {
                var buffer = displayList.renderBuffer;
                try {
                    data = buffer.getPixels(localX - displayList.offsetX, localY - displayList.offsetY);
                }
                catch (e) {
                    console.log(this.$Bitmap[0 /* bitmapData */]);
                    throw new Error(egret.sys.tr(1039));
                }
            }
            else {
                var buffer = egret.sys.customHitTestBuffer;
                buffer.resize(3, 3);
                var node = this.$getRenderNode();
                var matrix = egret.Matrix.create();
                matrix.identity();
                matrix.translate(1 - localX, 1 - localY);
                egret.sys.systemRenderer.drawNodeToBuffer(node, buffer, matrix, true);
                egret.Matrix.release(matrix);
                try {
                    data = buffer.getPixels(1, 1);
                }
                catch (e) {
                    console.log(this.$Bitmap[0 /* bitmapData */]);
                    throw new Error(egret.sys.tr(1039));
                }
            }
            if (data[3] === 0) {
                return null;
            }
            return this;
        };
        Bitmap.$drawImage = function (node, image, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, destW, destH, sourceWidth, sourceHeight, scale9Grid, fillMode, smoothing) {
            console.warn('deprecated method : Bitmap.$drawImage,use egret.sys.BitmapNode.$drawImage instead of it');
            egret.sys.BitmapNode.$updateTextureData(node, image, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, destW, destH, sourceWidth, sourceHeight, scale9Grid, fillMode, smoothing);
        };
        /**
         * The default value of whether or not is smoothed when scaled.
         * When object such as Bitmap is created,smoothing property will be set to this value.
         * @default trueใ
         * @version Egret 3.0
         * @platform Web
         * @language en_US
         */
        /**
         * ๆงๅถๅจ็ผฉๆพๆถๆฏๅฆ่ฟ่กๅนณๆปๅค็็้ป่ฎคๅผใ
         * ๅจ Bitmap ็ญๅฏน่ฑกๅๅปบๆถ,smoothing ๅฑๆงไผ่ขซ่ฎพ็ฝฎไธบ่ฏฅๅผใ
         * @default trueใ
         * @version Egret 3.0
         * @platform Web
         * @language zh_CN
         */
        Bitmap.defaultSmoothing = true;
        return Bitmap;
    }(egret.DisplayObject));
    egret.Bitmap = Bitmap;
    __reflect(Bitmap.prototype, "egret.Bitmap");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๆธฒๆ่็นๅบ็ฑป
         */
        var RenderNode = (function () {
            function RenderNode() {
                /**
                 * ่็น็ฑปๅ..
                 */
                this.type = 0;
                /**
                 * ๆฏๅฆ้่ฆ้็ป็ๆๅฟใ
                 */
                this.needRedraw = false;
                /**
                 * ่ฟไธชๅฏน่ฑกๅจ่ๅฐไธ็ๆดไฝ้ๆๅบฆ
                 */
                this.renderAlpha = 1;
                /**
                 * ่ฟไธชๅฏน่ฑกๅจ่ๅฐไธ็้ๆๅบฆ
                 */
                this.renderVisible = true;
                /**
                 * ็ธๅฏนไบๆพ็คบๅ่กจๆน่็นๆไฝๅพ็ผๅญๆน่็นไธ็็ฉ้ตๅฏน่ฑก
                 */
                this.renderMatrix = new egret.Matrix();
                /**
                 * ๆญคๆพ็คบๅฏน่ฑก่ช่บซ๏ผไธๅๆฌๅญ้กน๏ผๅจๆพ็คบๅ่กจๆน่็นๆไฝๅพ็ผๅญๆน่็นไธ็ๆพ็คบๅฐบๅฏธใ
                 */
                this.renderRegion = new sys.Region();
                /**
                 * ๆฏๅฆๅ็็งปๅจ
                 */
                this.moved = false;
                /**
                 * ็ปๅถๆฐๆฎ
                 */
                this.drawData = [];
                /**
                 * ็ปๅถๆฌกๆฐ
                 */
                this.renderCount = 0;
            }
            /**
             * ๅจๆพ็คบๅฏน่ฑก็$render()ๆนๆณ่ขซ่ฐ็จๅ๏ผ่ชๅจๆธ็ฉบ่ช่บซ็drawDataๆฐๆฎใ
             */
            RenderNode.prototype.cleanBeforeRender = function () {
                this.drawData.length = 0;
                this.renderCount = 0;
            };
            RenderNode.prototype.$getRenderCount = function () {
                return this.renderCount;
            };
            return RenderNode;
        }());
        sys.RenderNode = RenderNode;
        __reflect(RenderNode.prototype, "egret.sys.RenderNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * 2D่ทฏๅพ
         */
        var Path2D = (function () {
            function Path2D() {
                /**
                 * ่ทฏๅพ็ฑปๅ
                 */
                this.type = 0;
                this.$commands = [];
                this.$data = [];
                this.commandPosition = 0;
                this.dataPosition = 0;
                /**
                 * ๅฝๅ็งปๅจๅฐ็ๅๆX
                 * ๆณจๆ๏ผ็ฎๅๅชๆdrawArcไนๅไผ่ขซ่ตๅผ
                 */
                this.$lastX = 0;
                /**
                 * ๅฝๅ็งปๅจๅฐ็ๅๆY
                 * ๆณจๆ๏ผ็ฎๅๅชๆdrawArcไนๅไผ่ขซ่ตๅผ
                 */
                this.$lastY = 0;
            }
            /**
             * ๅฐๅฝๅ็ปๅพไฝ็ฝฎ็งปๅจๅฐ (x, y)ใๅฆๆ็ผบๅฐไปปไฝไธไธชๅๆฐ๏ผๅๆญคๆนๆณๅฐๅคฑ่ดฅ๏ผๅนถไธๅฝๅ็ปๅพไฝ็ฝฎไธๆนๅใ
             * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             */
            Path2D.prototype.moveTo = function (x, y) {
                this.$commands[this.commandPosition++] = 1 /* MoveTo */;
                var pos = this.dataPosition;
                this.$data[pos++] = x;
                this.$data[pos++] = y;
                this.dataPosition = pos;
            };
            /**
             * ไฝฟ็จๅฝๅ็บฟๆกๆทๅผ็ปๅถไธๆกไปๅฝๅ็ปๅพไฝ็ฝฎๅผๅงๅฐ (x, y) ็ปๆ็็ด็บฟ๏ผๅฝๅ็ปๅพไฝ็ฝฎ้ๅไผ่ฎพ็ฝฎไธบ (x, y)ใ
             * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             */
            Path2D.prototype.lineTo = function (x, y) {
                this.$commands[this.commandPosition++] = 2 /* LineTo */;
                var pos = this.dataPosition;
                this.$data[pos++] = x;
                this.$data[pos++] = y;
                this.dataPosition = pos;
            };
            /**
             * ไฝฟ็จๅฝๅ็บฟๆกๆทๅผๅ็ฑ (controlX, controlY) ๆๅฎ็ๆงๅถ็น็ปๅถไธๆกไปๅฝๅ็ปๅพไฝ็ฝฎๅผๅงๅฐ (anchorX, anchorY) ็ปๆ็ไบๆฌก่ดๅกๅฐๆฒ็บฟใๅฝๅ็ปๅพไฝ็ฝฎ้ๅ่ฎพ็ฝฎไธบ (anchorX, anchorY)ใ
             * ๅฆๆๅจ่ฐ็จ moveTo() ๆนๆณไนๅ่ฐ็จไบ curveTo() ๆนๆณ๏ผๅๅฝๅ็ปๅพไฝ็ฝฎ็้ป่ฎคๅผไธบ (0, 0)ใๅฆๆ็ผบๅฐไปปไฝไธไธชๅๆฐ๏ผๅๆญคๆนๆณๅฐๅคฑ่ดฅ๏ผๅนถไธๅฝๅ็ปๅพไฝ็ฝฎไธๆนๅใ
             * ็ปๅถ็ๆฒ็บฟๆฏไบๆฌก่ดๅกๅฐๆฒ็บฟใไบๆฌก่ดๅกๅฐๆฒ็บฟๅๅซไธคไธช้็นๅไธไธชๆงๅถ็นใ่ฏฅๆฒ็บฟๅๆ่ฟไธคไธช้็น๏ผๅนถๅๆงๅถ็นๅผฏๆฒใ
             * @param controlX ไธไธชๆฐๅญ๏ผๆๅฎๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
             * @param controlY ไธไธชๆฐๅญ๏ผๆๅฎๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
             * @param anchorX ไธไธชๆฐๅญ๏ผๆๅฎไธไธไธช้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
             * @param anchorY ไธไธชๆฐๅญ๏ผๆๅฎไธไธไธช้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
             */
            Path2D.prototype.curveTo = function (controlX, controlY, anchorX, anchorY) {
                this.$commands[this.commandPosition++] = 3 /* CurveTo */;
                var pos = this.dataPosition;
                this.$data[pos++] = controlX;
                this.$data[pos++] = controlY;
                this.$data[pos++] = anchorX;
                this.$data[pos++] = anchorY;
                this.dataPosition = pos;
            };
            /**
             * ไปๅฝๅ็ปๅพไฝ็ฝฎๅฐๆๅฎ็้็น็ปๅถไธๆกไธๆฌก่ดๅกๅฐๆฒ็บฟใไธๆฌก่ดๅกๅฐๆฒ็บฟ็ฑไธคไธช้็นๅไธคไธชๆงๅถ็น็ปๆใ่ฏฅๆฒ็บฟๅๆ่ฟไธคไธช้็น๏ผๅนถๅไธคไธชๆงๅถ็นๅผฏๆฒใ
             * @param controlX1 ๆๅฎ้ฆไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
             * @param controlY1 ๆๅฎ้ฆไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
             * @param controlX2 ๆๅฎ็ฌฌไบไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
             * @param controlY2 ๆๅฎ็ฌฌไบไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
             * @param anchorX ๆๅฎ้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
             * @param anchorY ๆๅฎ้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
             */
            Path2D.prototype.cubicCurveTo = function (controlX1, controlY1, controlX2, controlY2, anchorX, anchorY) {
                this.$commands[this.commandPosition++] = 4 /* CubicCurveTo */;
                var pos = this.dataPosition;
                this.$data[pos++] = controlX1;
                this.$data[pos++] = controlY1;
                this.$data[pos++] = controlX2;
                this.$data[pos++] = controlY2;
                this.$data[pos++] = anchorX;
                this.$data[pos++] = anchorY;
                this.dataPosition = pos;
            };
            /**
             * ็ปๅถไธไธช็ฉๅฝข
             * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             */
            Path2D.prototype.drawRect = function (x, y, width, height) {
                var x2 = x + width;
                var y2 = y + height;
                this.moveTo(x, y);
                this.lineTo(x2, y);
                this.lineTo(x2, y2);
                this.lineTo(x, y2);
                this.lineTo(x, y);
            };
            /**
             * ็ปๅถไธไธชๅ่ง็ฉๅฝขใ
             * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param ellipseWidth ็จไบ็ปๅถๅ่ง็ๆคญๅ็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param ellipseHeight ็จไบ็ปๅถๅ่ง็ๆคญๅ็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ ๏ผๅฏ้๏ผๅฆๆๆชๆๅฎๅผ๏ผๅ้ป่ฎคๅผไธไธบ ellipseWidth ๅๆฐๆไพ็ๅผ็ธๅน้ใ
             */
            Path2D.prototype.drawRoundRect = function (x, y, width, height, ellipseWidth, ellipseHeight) {
                var radiusX = (ellipseWidth * 0.5) | 0;
                var radiusY = ellipseHeight ? (ellipseHeight * 0.5) | 0 : radiusX;
                if (!radiusX || !radiusY) {
                    this.drawRect(x, y, width, height);
                    return;
                }
                var hw = width * 0.5;
                var hh = height * 0.5;
                if (radiusX > hw) {
                    radiusX = hw;
                }
                if (radiusY > hh) {
                    radiusY = hh;
                }
                if (hw === radiusX && hh === radiusY) {
                    if (radiusX === radiusY) {
                        this.drawCircle(x + radiusX, y + radiusY, radiusX);
                    }
                    else {
                        this.drawEllipse(x, y, radiusX * 2, radiusY * 2);
                    }
                    return;
                }
                //    A-----B
                //  H         C
                //  G         D
                //    F-----E
                // ไปD็นๅผๅง๏ผ็ปๆๅจD็น
                var right = x + width;
                var bottom = y + height;
                var xlw = x + radiusX;
                var xrw = right - radiusX;
                var ytw = y + radiusY;
                var ybw = bottom - radiusY;
                this.moveTo(right, ybw);
                this.curveTo(right, bottom, xrw, bottom);
                this.lineTo(xlw, bottom);
                this.curveTo(x, bottom, x, ybw);
                this.lineTo(x, ytw);
                this.curveTo(x, y, xlw, y);
                this.lineTo(xrw, y);
                this.curveTo(right, y, right, ytw);
                this.lineTo(right, ybw);
            };
            /**
             * ็ปๅถไธไธชๅใ
             * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param radius ๅ็ๅๅพ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             */
            Path2D.prototype.drawCircle = function (x, y, radius) {
                this.arcToBezier(x, y, radius, radius, 0, Math.PI * 2);
            };
            /**
             * ็ปๅถไธไธชๆคญๅใ
             * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             */
            Path2D.prototype.drawEllipse = function (x, y, width, height) {
                var radiusX = width * 0.5;
                var radiusY = height * 0.5;
                // ็งปๅจxๅyๅฐๆคญๅ็ไธญๅฟ.
                x += radiusX;
                y += radiusY;
                this.arcToBezier(x, y, radiusX, radiusY, 0, Math.PI * 2);
            };
            /**
             * ็ปๅถไธๆฎตๅๅผง่ทฏๅพใๅๅผง่ทฏๅพ็ๅๅฟๅจ (x, y) ไฝ็ฝฎ๏ผๅๅพไธบ r ๏ผๆนๆฎanticlockwise ๏ผ้ป่ฎคไธบ้กบๆถ้๏ผๆๅฎ็ๆนๅไป startAngle ๅผๅง็ปๅถ๏ผๅฐ endAngle ็ปๆใ
             * @param x ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ x ่ฝดๅๆใ
             * @param y ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ y ่ฝดๅๆใ
             * @param radius ๅๅผง็ๅๅพใ
             * @param startAngle ๅๅผง็่ตทๅง็น๏ผ x่ฝดๆนๅๅผๅง่ฎก็ฎ๏ผๅไฝไปฅๅผงๅบฆ่กจ็คบใ
             * ๆณจๆ๏ผๅฟ้กปๅจ0~2ฯไน้ดใ
             * @param endAngle ๅๅผง็็ป็น๏ผ ๅไฝไปฅๅผงๅบฆ่กจ็คบใ
             * ๆณจๆ๏ผๅฟ้กปๅจ0~2ฯไน้ดใ
             * @param anticlockwise ๅฆๆไธบ true๏ผ้ๆถ้็ปๅถๅๅผง๏ผๅไน๏ผ้กบๆถ้็ปๅถใ
             */
            Path2D.prototype.drawArc = function (x, y, radius, startAngle, endAngle, anticlockwise) {
                if (anticlockwise) {
                    if (endAngle >= startAngle) {
                        endAngle -= Math.PI * 2;
                    }
                }
                else {
                    if (endAngle <= startAngle) {
                        endAngle += Math.PI * 2;
                    }
                }
                this.arcToBezier(x, y, radius, radius, startAngle, endAngle, anticlockwise);
            };
            /**
             * ็ปๅถไธๆฎตๅๅผง่ทฏๅพ
             * @param x ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ x ่ฝดๅๆใ
             * @param y ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ y ่ฝดๅๆใ
             * @param radiusX ๅๅผง็ๅๅพ xใ
             * @param radiusY ๅๅผง็ๅๅพ yใ
             * @param startAngle ๅๅผง็่ตทๅง็น๏ผ x่ฝดๆนๅๅผๅง่ฎก็ฎ๏ผๅไฝไปฅๅผงๅบฆ่กจ็คบใ
             * ๆณจๆ๏ผๅฟ้กปไธบๆญฃๆฐใ
             * @param endAngle ๅๅผง็็ป็น๏ผ ๅไฝไปฅๅผงๅบฆ่กจ็คบใ
             * ๆณจๆ๏ผไธstartAngleๅทฎๅผๅฟ้กปๅจ0~2ฯไน้ดใ
             * @param anticlockwise ๅฆๆไธบ true๏ผ้ๆถ้็ปๅถๅๅผง๏ผๅไน๏ผ้กบๆถ้็ปๅถใ
             * ๆณจๆ๏ผๅฆๆไธบtrue๏ผendAngleๅฟ้กปๅฐไบstartAngle๏ผๅไนๅฟ้กปๅคงไบใ
             */
            Path2D.prototype.arcToBezier = function (x, y, radiusX, radiusY, startAngle, endAngle, anticlockwise) {
                var halfPI = Math.PI * 0.5;
                var start = startAngle;
                var end = start;
                if (anticlockwise) {
                    end += -halfPI - (start % halfPI);
                    if (end < endAngle) {
                        end = endAngle;
                    }
                }
                else {
                    end += halfPI - (start % halfPI);
                    if (end > endAngle) {
                        end = endAngle;
                    }
                }
                var currentX = x + Math.cos(start) * radiusX;
                var currentY = y + Math.sin(start) * radiusY;
                if (this.$lastX != currentX || this.$lastY != currentY) {
                    this.moveTo(currentX, currentY);
                }
                var u = Math.cos(start);
                var v = Math.sin(start);
                for (var i = 0; i < 4; i++) {
                    var addAngle = end - start;
                    var a = 4 * Math.tan(addAngle / 4) / 3;
                    var x1 = currentX - v * a * radiusX;
                    var y1 = currentY + u * a * radiusY;
                    u = Math.cos(end);
                    v = Math.sin(end);
                    currentX = x + u * radiusX;
                    currentY = y + v * radiusY;
                    var x2 = currentX + v * a * radiusX;
                    var y2 = currentY - u * a * radiusY;
                    this.cubicCurveTo(x1, y1, x2, y2, currentX, currentY);
                    if (end === endAngle) {
                        break;
                    }
                    start = end;
                    if (anticlockwise) {
                        end = start - halfPI;
                        if (end < endAngle) {
                            end = endAngle;
                        }
                    }
                    else {
                        end = start + halfPI;
                        if (end > endAngle) {
                            end = endAngle;
                        }
                    }
                }
            };
            return Path2D;
        }());
        sys.Path2D = Path2D;
        __reflect(Path2D.prototype, "egret.sys.Path2D");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    function createMap() {
        var obj = Object.create(null);
        obj.__v8__ = undefined;
        delete obj.__v8__;
        return obj;
    }
    egret.createMap = createMap;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
this["DEBUG"] = true;
this["RELEASE"] = false;
var egret;
(function (egret) {
    /**
     * @private
     */
    function _getString(code) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        return egret.sys.tr.apply(egret.sys, arguments);
    }
    egret.getString = _getString;
    function _error(code) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        var text = egret.sys.tr.apply(null, arguments);
        if (true) {
            egret.sys.$logToFPS("Error #" + code + ": " + text);
        }
        throw new Error("#" + code + ": " + text); //ไฝฟ็จ่ฟ็งๆนๅผๆฅ้่ฝๅค็ปๆญขๅ็ปญไปฃ็็ปง็ปญ่ฟ่ก
    }
    egret.$error = _error;
    function _warn(code) {
        var params = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            params[_i - 1] = arguments[_i];
        }
        var text = egret.sys.tr.apply(null, arguments);
        if (true) {
            egret.sys.$logToFPS("Warning #" + code + ": " + text);
        }
        egret.warn("Warning #" + code + ": " + text);
    }
    egret.$warn = _warn;
    function _markReadOnly(instance, property, isProperty) {
        if (isProperty === void 0) {
            isProperty = true;
        }
        var data = Object.getOwnPropertyDescriptor(isProperty ? instance.prototype : instance, property);
        if (data == null) {
            console.log(instance);
            return;
        }
        data.set = function (value) {
            if (isProperty) {
                egret.$warn(1010, egret.getQualifiedClassName(instance), property);
            }
            else {
                egret.$warn(1014, egret.getQualifiedClassName(instance), property);
            }
        };
        Object.defineProperty(instance.prototype, property, data);
    }
    function markCannotUse(instance, property, defaultValue) {
        Object.defineProperty(instance.prototype, property, {
            get: function () {
                egret.$warn(1009, egret.getQualifiedClassName(instance), property);
                return defaultValue;
            },
            set: function (value) {
                egret.$error(1009, egret.getQualifiedClassName(instance), property);
            },
            enumerable: true,
            configurable: true
        });
    }
    egret.$markCannotUse = markCannotUse;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The CapsStyle class is an enumeration of constant values that specify the caps style to use in drawing lines.
     * The constants are provided for use as values in the caps parameter of the egret.Graphics.lineStyle() method.
     * @see egret.Graphics#lineStyle()
     * @version Egret 2.5
     * @platform Web,Native
     * @language en_US
     */
    /**
     * CapsStyle ็ฑปๆฏๅฏๆๅฎๅจ็ปๅถ็บฟๆกไธญไฝฟ็จ็็ซฏ็นๆทๅผ็ๅธธ้ๅผๆไธพใๅธธ้ๅฏ็จไฝ egret.Graphics.lineStyle() ๆนๆณ็ caps ๅๆฐไธญ็ๅผใ
     * @see egret.Graphics#lineStyle()
     * @version Egret 2.5
     * @platform Web,Native
     * @language zh_CN
     */
    egret.CapsStyle = {
        /**
         * Used to specify no caps in the caps parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๅจ egret.Graphics.lineStyle() ๆนๆณ็ caps ๅๆฐไธญๆๅฎๆฒกๆ็ซฏ็นใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        NONE: "none",
        /**
         * Used to specify round caps in the caps parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๅจ egret.Graphics.lineStyle() ๆนๆณ็ caps ๅๆฐไธญๆๅฎๅๅคด็ซฏ็นใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        ROUND: "round",
        /**
         * Used to specify square caps in the caps parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๅจ egret.Graphics.lineStyle() ๆนๆณ็ caps ๅๆฐไธญๆๅฎๆนๅคด็ซฏ็นใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        SQUARE: "square"
    };
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Values for the dirty region policy
     * @version Egret 2.5
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่็ฉๅฝข็ญ็ฅๅธธ้ใ
     * @version Egret 3.0
     * @platform Web,Native
     * @language zh_CN
     */
    egret.DirtyRegionPolicy = {
        /**
         * Close automatic detection of dirty region
         * @version Egret 3.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅณ้ญ่ชๅจ่็ฉๅฝขๆฃๆต
         * @version Egret 3.0
         * @platform Web,Native
         * @language zh_CN
         */
        OFF: "off",
        /**
         * Open automatic detection of dirty region
         * @version Egret 3.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅผๅฏ่ชๅจ่็ฉๅฝขๆฃๆต
         * @version Egret 3.0
         * @platform Web,Native
         * @language zh_CN
         */
        ON: "on"
    };
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    var WebGLUtils = (function () {
        function WebGLUtils() {
        }
        WebGLUtils.compileProgram = function (gl, vertexSrc, fragmentSrc) {
            var fragmentShader = WebGLUtils.compileFragmentShader(gl, fragmentSrc);
            var vertexShader = WebGLUtils.compileVertexShader(gl, vertexSrc);
            var shaderProgram = gl.createProgram();
            gl.attachShader(shaderProgram, vertexShader);
            gl.attachShader(shaderProgram, fragmentShader);
            gl.linkProgram(shaderProgram);
            if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
                egret.$warn(1020);
            }
            return shaderProgram;
        };
        WebGLUtils.compileFragmentShader = function (gl, shaderSrc) {
            return WebGLUtils._compileShader(gl, shaderSrc, gl.FRAGMENT_SHADER);
        };
        WebGLUtils.compileVertexShader = function (gl, shaderSrc) {
            return WebGLUtils._compileShader(gl, shaderSrc, gl.VERTEX_SHADER);
        };
        WebGLUtils._compileShader = function (gl, shaderSrc, shaderType) {
            var shader = gl.createShader(shaderType);
            gl.shaderSource(shader, shaderSrc);
            gl.compileShader(shader);
            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                //egret.info(gl.getShaderInfoLog(shader));
                return null;
            }
            return shader;
        };
        WebGLUtils.checkCanUseWebGL = function () {
            if (WebGLUtils.canUseWebGL == undefined) {
                try {
                    var canvas = document.createElement("canvas");
                    WebGLUtils.canUseWebGL = !!window["WebGLRenderingContext"]
                        && !!(canvas.getContext("webgl") || canvas.getContext("experimental-webgl"));
                }
                catch (e) {
                    WebGLUtils.canUseWebGL = false;
                }
            }
            return WebGLUtils.canUseWebGL;
        };
        WebGLUtils.deleteWebGLTexture = function (bitmapData) {
            if (bitmapData) {
                var gl = bitmapData.glContext;
                if (gl) {
                    gl.deleteTexture(bitmapData);
                }
            }
        };
        return WebGLUtils;
    }());
    egret.WebGLUtils = WebGLUtils;
    __reflect(WebGLUtils.prototype, "egret.WebGLUtils");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    // export interface TextField{
    //     addEventListener<Z>(type: "focusIn" |
    //                               "focusOut"
    //         , listener: (this: Z, e: FocusEvent) => void, thisObject: Z, useCapture?: boolean, priority?: number);
    //     addEventListener(type: string, listener: Function, thisObject: any, useCapture?: boolean, priority?: number);
    // }
    /**
     * When the user changes the focus from one object in the display list to another object, the object dispatches a FocusEvent object. Currently only supports input text.
     * Focus events: FocusEvent.FOCUS_IN FocusEvent.FOCUS_OUT
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ็จๆทๅฐ็ฆ็นไปๆพ็คบๅ่กจไธญ็ไธไธชๅฏน่ฑกๆดๆนๅฐๅฆไธไธชๅฏน่ฑกๆถ๏ผๅฏน่ฑกๅฐ่ฐๅบฆ FocusEvent ๅฏน่ฑกใ็ฎๅๅชๆฏๆ่พๅฅๆๆฌใ
     * ็ฆ็นไบไปถ๏ผFocusEvent.FOCUS_IN FocusEvent.FOCUS_OUT
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var FocusEvent = (function (_super) {
        __extends(FocusEvent, _super);
        /**
         * Create a egret.FocusEvent objects
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.FocusEvent ๅฏน่ฑก
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function FocusEvent(type, bubbles, cancelable) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            return _super.call(this, type, bubbles, cancelable) || this;
        }
        /**
         * Gets focus
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅพ็ฆ็น
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        FocusEvent.FOCUS_IN = "focusIn";
        /**
         * Loses focus
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅคฑๅป็ฆ็น
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        FocusEvent.FOCUS_OUT = "focusOut";
        return FocusEvent;
    }(egret.Event));
    egret.FocusEvent = FocusEvent;
    __reflect(FocusEvent.prototype, "egret.FocusEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The GeolocationEvent represents the position and altitude of the device on Earth,
     * and show errors occurred while getting the location of the device.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/Geolocation.ts
     * @see http://edn.egret.com/cn/docs/page/662 ่ทๅไฝ็ฝฎไฟกๆฏ
     * @language en_US
     */
    /**
     * GeolocationEvent ๆไพ่ฎพๅค็ๅฐ็ไฝ็ฝฎไฟกๆฏๅ่ทๅไฝ็ฝฎๆถๅ็็้่ฏฏไฟกๆฏ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/Geolocation.ts
     * @see http://edn.egret.com/cn/docs/page/662 ่ทๅไฝ็ฝฎไฟกๆฏ
     * @language zh_CN
     */
    var GeolocationEvent = (function (_super) {
        __extends(GeolocationEvent, _super);
        function GeolocationEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        /**
         * The acquisition of the location information failed because of app don't have permission.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฑไบ็จๆทๆ็ป่ฎฟ้ฎไฝ็ฝฎไฟกๆฏ๏ผ่ทๅไฝ็ฝฎไฟกๆฏๅคฑ่ดฅ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        GeolocationEvent.PERMISSION_DENIED = "permissionDenied";
        /**
         * The acquisition of the location failed because at least one internal source of position returned an internal error.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพๅคไฝ็ฝฎๆๅกไธๅฏ็จๆ่่ถๆถ็ญๅๅๆฒกๆๅพๅฐไฝ็ฝฎไฟกๆฏ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        GeolocationEvent.UNAVAILABLE = "unavailable";
        return GeolocationEvent;
    }(egret.Event));
    egret.GeolocationEvent = GeolocationEvent;
    __reflect(GeolocationEvent.prototype, "egret.GeolocationEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * When a network request returns an HTTP status code, the application dispatches HTTPStatusEvent objects.
     * Before error or completion events will always send HTTPStatusEvent object. HTTPStatusEvent object does not necessarily indicate an error condition; it simply reflects the HTTP status code provided by the network stack (if any).
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅจ็ฝ็ป่ฏทๆฑ่ฟๅ HTTP ็ถๆไปฃ็ๆถ๏ผๅบ็จ็จๅบๅฐ่ฐๅบฆ HTTPStatusEvent ๅฏน่ฑกใ
     * ๅจ้่ฏฏๆๅฎๆไบไปถไนๅ๏ผๅฐๅง็ปๅ้ HTTPStatusEvent ๅฏน่ฑกใHTTPStatusEvent ๅฏน่ฑกไธไธๅฎ่กจ็คบ้่ฏฏๆกไปถ๏ผๅฎไปๅๆ็ฝ็ปๅๆๆไพ็ HTTP ็ถๆไปฃ็๏ผๅฆๆๆ็่ฏ๏ผใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var HTTPStatusEvent = (function (_super) {
        __extends(HTTPStatusEvent, _super);
        /**
         * Create a egret.HTTPStatusEvent objects
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.HTTPStatusEvent ๅฏน่ฑก
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function HTTPStatusEvent(type, bubbles, cancelable) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            /**
             * @private
             */
            _this._status = 0;
            return _this;
        }
        Object.defineProperty(HTTPStatusEvent.prototype, "status", {
            /**
             * he server returns the HTTP status code.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฑๆๅกๅจ่ฟๅ็ HTTP ็ถๆไปฃ็ใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._status;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * EventDispatcher object using the specified event object thrown Event. The objects will be thrown in the object cache pool for the next round robin.
         * @param target {egret.IEventDispatcher} Distribute event target
         * @param status {number} The server returns the HTTP status code
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบEventไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target {egret.IEventDispatcher} ๆดพๅไบไปถ็ฎๆ
         * @param status {number} ็ฑๆๅกๅจ่ฟๅ็ HTTP ็ถๆไปฃ็
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HTTPStatusEvent.dispatchHTTPStatusEvent = function (target, status) {
            var event = egret.Event.create(HTTPStatusEvent, HTTPStatusEvent.HTTP_STATUS);
            event._status = status;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * HTTPStatusEvent.HTTP_STATUS constant defines the value of the type property httpStatus event object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * HTTPStatusEvent.HTTP_STATUS ๅธธ้ๅฎไน httpStatus ไบไปถๅฏน่ฑก็ type ๅฑๆงๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HTTPStatusEvent.HTTP_STATUS = "httpStatus";
        return HTTPStatusEvent;
    }(egret.Event));
    egret.HTTPStatusEvent = HTTPStatusEvent;
    __reflect(HTTPStatusEvent.prototype, "egret.HTTPStatusEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @classdesc IOๆตไบไปถ๏ผๅฝ้่ฏฏๅฏผ่ด่พๅฅๆ่พๅบๆไฝๅคฑ่ดฅๆถ่ฐๅบฆ IOErrorEvent ๅฏน่ฑกใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/IOErrorEvent.ts
     * @language en_US
     */
    /**
     * @classdesc IOๆตไบไปถ๏ผๅฝ้่ฏฏๅฏผ่ด่พๅฅๆ่พๅบๆไฝๅคฑ่ดฅๆถ่ฐๅบฆ IOErrorEvent ๅฏน่ฑกใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/IOErrorEvent.ts
     * @language zh_CN
     */
    var IOErrorEvent = (function (_super) {
        __extends(IOErrorEvent, _super);
        /**
         * Create a egret.IOErrorEvent objects
         * @param type {string} Type of event, accessible as Event.type.
         * @param bubbles {boolean} Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable {boolean} Determine whether the Event object can be canceled. The default value is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.IOErrorEvent ๅฏน่ฑก
         * @param type {string} ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles {boolean} ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable {boolean} ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function IOErrorEvent(type, bubbles, cancelable) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            return _super.call(this, type, bubbles, cancelable) || this;
        }
        /**
         * EventDispatcher object using the specified event object thrown Event. The objects will be thrown in the object cache pool for the next round robin.
         * @param target {egret.IEventDispatcher} Distribute event target
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบEventไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target {egret.IEventDispatcher} ๆดพๅไบไปถ็ฎๆ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        IOErrorEvent.dispatchIOErrorEvent = function (target) {
            var event = egret.Event.create(IOErrorEvent, IOErrorEvent.IO_ERROR);
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * io error
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ioๅ็้่ฏฏ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        IOErrorEvent.IO_ERROR = "ioError";
        return IOErrorEvent;
    }(egret.Event));
    egret.IOErrorEvent = IOErrorEvent;
    __reflect(IOErrorEvent.prototype, "egret.IOErrorEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * MotionEvent represents the device's movement
     * Acceleration and accelerationIncludingGravity to represents the device's acceleration
     * RotationRate to represents the device's rotation
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/Motion.ts
     * @language en_US
     */
    /**
     * MotionEvent ็ฑปๅ็ฐ่ฎพๅค่ฟๅจ็ๅทไฝไฟกๆฏ
     * Acceleration ๅ accelerationIncludingGravity ๅ็ฐ่ฎพๅคไธไธช็ปดๅบฆ็ๅ้ๅบฆไฟกๆฏ
     * RotationRate ๅ็ฐ่ฎพๅค็ๆ่ฝฌ็ถๆไฟกๆฏ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/Motion.ts
     * @language zh_CN
     */
    var MotionEvent = (function (_super) {
        __extends(MotionEvent, _super);
        function MotionEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return MotionEvent;
    }(egret.Event));
    egret.MotionEvent = MotionEvent;
    __reflect(MotionEvent.prototype, "egret.MotionEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The OrientationEvent provides information from the physical orientation of the device.
     * Note: Currently, Browsers on the iOS and Android does not handle the coordinates the same way.
     * Take care about this while using them.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/DeviceOrientation.ts
     * @language en_US
     */
    /**
     * OrientationEvent ๆไพ่ฎพๅค็ๆนๅไฟกๆฏ
     * ๆณจๆ: ็ฎๅๅไธชๆต่งๅจๅๆไฝ็ณป็ปๅค็ๆนๅ็ๆนๅผไธๅฎๅจ็ธๅ๏ผ่ฏทๆนๆฎไฝฟ็จๅบๆฏๅ็ธๅบ็ๆกๆญฃ๏ผ
     * ๆฏๅฆไฝฟ็จไธคๆฌกๆนๅๆฐๆฎ็ๅๅ่ไธๆฏ็ดๆฅไฝฟ็จๆนๅ็ๅผ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/sensor/DeviceOrientation.ts
     * @language zh_CN
     */
    var OrientationEvent = (function (_super) {
        __extends(OrientationEvent, _super);
        function OrientationEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return OrientationEvent;
    }(egret.Event));
    egret.OrientationEvent = OrientationEvent;
    __reflect(OrientationEvent.prototype, "egret.OrientationEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * When a load operation has begun or a socket has received data, ProgressEvent object is dispatched.
     * There are two types of progress events: ProgressEvent.PROGRESS and ProgressEvent.SOCKET_DATA.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅฝๅ่ฝฝๆไฝๅทฒๅผๅงๆๅฅๆฅๅญๅทฒๆฅๆถๅฐๆฐๆฎๆถ๏ผๅฐ่ฐๅบฆ ProgressEvent ๅฏน่ฑกใ
     * ๆไธค็ง็ฑปๅ็่ฟ็จไบไปถ๏ผProgressEvent.PROGRESS ๅ ProgressEvent.SOCKET_DATAใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var ProgressEvent = (function (_super) {
        __extends(ProgressEvent, _super);
        /**
         * ๅๅปบไธไธช egret.ProgressEvent ๅฏน่ฑก
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @param bytesLoaded {number} Number of items or bytes loaded
         * @param bytesTotal {number} The total number of items or bytes loaded
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.ProgressEvent ๅฏน่ฑก
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @param bytesLoaded {number} ๅ่ฝฝ็้กนๆฐๆๅญ่ๆฐ
         * @param bytesTotal {number} ๅ่ฝฝ็ๆป้กนๆฐๆๆปๅญ่ๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function ProgressEvent(type, bubbles, cancelable, bytesLoaded, bytesTotal) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            if (bytesLoaded === void 0) {
                bytesLoaded = 0;
            }
            if (bytesTotal === void 0) {
                bytesTotal = 0;
            }
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            /**
             * Number of items or bytes when the listener processes the eventใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅจไพฆๅฌๅจๅค็ไบไปถๆถๅ่ฝฝ็้กนๆฐๆๅญ่ๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.bytesLoaded = 0;
            /**
             * If the loading process succeeds, the total number or the total number of bytes that will be loaded term.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆๅ่ฝฝ่ฟ็จๆๅ๏ผๅฐๅ่ฝฝ็ๆป้กนๆฐๆๆปๅญ่ๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.bytesTotal = 0;
            _this.bytesLoaded = bytesLoaded;
            _this.bytesTotal = bytesTotal;
            return _this;
        }
        /**
         * EventDispatcher object using the specified event object thrown Event. The objects will be thrown in the object cache pool for the next round robin.
         * @param target {egret.IEventDispatcher} Distribute event target
         * @param type  The type of the event, accessible as Event.type.
         * @param bytesLoaded {number} Number of items or bytes loaded
         * @param bytesTotal {number} The total number of items or bytes loaded
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบEventไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target {egret.IEventDispatcher} ๆดพๅไบไปถ็ฎๆ
         * @param type {string} ไบไปถ็ฑปๅ
         * @param bytesLoaded {number} ๅ่ฝฝ็้กนๆฐๆๅญ่ๆฐ
         * @param bytesTotal {number} ๅ่ฝฝ็ๆป้กนๆฐๆๆปๅญ่ๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ProgressEvent.dispatchProgressEvent = function (target, type, bytesLoaded, bytesTotal) {
            if (bytesLoaded === void 0) {
                bytesLoaded = 0;
            }
            if (bytesTotal === void 0) {
                bytesTotal = 0;
            }
            var event = egret.Event.create(ProgressEvent, type);
            event.bytesLoaded = bytesLoaded;
            event.bytesTotal = bytesTotal;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Changes in the loading progress
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ่ฝฝ่ฟๅบฆๅ็ๅๅ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ProgressEvent.PROGRESS = "progress";
        /**
         * Get the data
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅๅฐๆฐๆฎ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ProgressEvent.SOCKET_DATA = "socketData";
        return ProgressEvent;
    }(egret.Event));
    egret.ProgressEvent = ProgressEvent;
    __reflect(ProgressEvent.prototype, "egret.ProgressEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * When the direction of the stage of change, Stage object dispatches StageOrientationEvent object.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/StageOrientationEvent.ts
     * @language en_US
     */
    /**
     * ๅฝ่ๅฐ็ๆนๅๆดๆนๆถ๏ผStage ๅฏน่ฑกๅฐ่ฐๅบฆ StageOrientationEvent ๅฏน่ฑกใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/StageOrientationEvent.ts
     * @language zh_CN
     */
    var StageOrientationEvent = (function (_super) {
        __extends(StageOrientationEvent, _super);
        /**
         * Creating contains specific information related to the event and the stage direction of StageOrientationEvent object.
         * @param type Event types:StageOrientationEvent.ORIENTATION_CHANGE
         * @param bubbles It indicates whether the Event object participates in the bubbling stage of the event flow.
         * @param cancelable It indicates whether the Event object can be canceled.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบๅๅซไธ่ๅฐๆนๅไบไปถ็ธๅณ็็นๅฎไฟกๆฏ็ StageOrientationEvent ๅฏน่ฑกใ
         * @param type ไบไปถ็็ฑปๅ๏ผStageOrientationEvent.ORIENTATION_CHANGE
         * @param bubbles ่กจ็คบ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ
         * @param cancelable ่กจ็คบๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function StageOrientationEvent(type, bubbles, cancelable) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            return _super.call(this, type, bubbles, cancelable) || this;
        }
        /**
         * ๆดพๅไธไธชๅฑๅนๆ่ฝฌ็ไบไปถใ
         * @param target {egret.IEventDispatcher} ๆดพๅไบไปถ็ฎๆ
         * @param type {egret.IEventDispatcher} ๆดพๅไบไปถ็ฑปๅ
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดพๅไธไธชๅฑๅนๆ่ฝฌ็ไบไปถใ
         * @param target {egret.IEventDispatcher} Distribute event target
         * @param type {egret.IEventDispatcher} Distribute event type
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        StageOrientationEvent.dispatchStageOrientationEvent = function (target, type) {
            var event = egret.Event.create(StageOrientationEvent, type);
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * After screen rotation distribute events.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฑๅนๆ่ฝฌๅๆดพๅ็ไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        StageOrientationEvent.ORIENTATION_CHANGE = "orientationChange";
        return StageOrientationEvent;
    }(egret.Event));
    egret.StageOrientationEvent = StageOrientationEvent;
    __reflect(StageOrientationEvent.prototype, "egret.StageOrientationEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    // export interface TextField{
    //     addEventListener<Z>(type: "link"
    //         , listener: (this: Z, e: TextEvent) => void, thisObject: Z, useCapture?: boolean, priority?: number);
    //     addEventListener(type: string, listener: Function, thisObject: any, useCapture?: boolean, priority?: number);
    // }
    /**
     * When a user clicks a hyperlink rich text object dispatches TextEvent object. Text Event Type: TextEvent.LINK.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TextEvent.ts
     * @language en_US
     */
    /**
     * ็จๆทๅจๅฏๆๆฌไธญๅๅป่ถ้พๆฅๆถ๏ผๅฏน่ฑกๅฐ่ฐๅบฆ TextEvent ๅฏน่ฑกใๆๆฌไบไปถ็ฑปๅ๏ผTextEvent.LINKใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TextEvent.ts
     * @language zh_CN
     */
    var TextEvent = (function (_super) {
        __extends(TextEvent, _super);
        /**
         * TextEvent create an object that contains information about text events.
         * @param type Type of event, you can access the TextEvent.type.
         * @param bubbles Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determine whether the Event object can be canceled. The default value is false.
         * @param text One or more characters of text entered by the user. Event listeners can access this information through the text property.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช TextEvent ๅฏน่ฑก๏ผๅถไธญๅๅซๆๅณๆๆฌไบไปถ็ไฟกๆฏใ
         * @param type ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ TextEvent.type ่ฎฟ้ฎใ
         * @param bubbles ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @param text ็จๆท่พๅฅ็ไธไธชๆๅคไธชๆๆฌๅญ็ฌฆใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ text ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function TextEvent(type, bubbles, cancelable, text) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            if (text === void 0) {
                text = "";
            }
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            _this.text = text;
            return _this;
        }
        /**
         * EventDispatcher object using the specified event object thrown TextEvent. The objects will be thrown in the object cache pool for the next round robin.
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param text  Text TextEvent object assignment
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบTextEventไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target ๆดพๅไบไปถ็ฎๆ
         * @param type  ไบไปถ็ฑปๅ
         * @param text  TextEventๅฏน่ฑก็text่ตๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TextEvent.dispatchTextEvent = function (target, type, text) {
            var event = egret.Event.create(TextEvent, type);
            event.text = text;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * It defines the value of the type property of a link event object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฎไน link ไบไปถๅฏน่ฑก็ type ๅฑๆงๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TextEvent.LINK = "link";
        return TextEvent;
    }(egret.Event));
    egret.TextEvent = TextEvent;
    __reflect(TextEvent.prototype, "egret.TextEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * A Timer object dispatches a TimerEvent objects whenever the Timer object reaches the interval specified by the Timer.delay property.
     * @see egret.Timer
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TimerEvent.ts
     * @language en_US
     */
    /**
     * ๆฏๅฝ Timer ๅฏน่ฑก่พพๅฐ็ฑ Timer.delay ๅฑๆงๆๅฎ็้ด้ๆถ๏ผTimer ๅฏน่ฑกๅณไผ่ฐๅบฆ TimerEvent ๅฏน่ฑกใ
     * @see egret.Timer
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TimerEvent.ts
     * @language zh_CN
     */
    var TimerEvent = (function (_super) {
        __extends(TimerEvent, _super);
        /**
         * Creates an Event object with specific information relevant to timer events.
         * @param type The type of the event. Event listeners can access this information through the inherited type property.
         * @param bubbles Determines whether the Event object bubbles. Event listeners can access this information through
         * the inherited bubbles property.
         * @param cancelable Determines whether the Event object can be canceled. Event listeners can access this information
         * through the inherited cancelable property.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช Event ๅฏน่ฑก๏ผๅถไธญๅๅซๆๅณ timer ไบไปถ็็นๅฎไฟกๆฏใ
         * @param type ไบไปถ็็ฑปๅใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ type ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @param bubbles ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅๆณกใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ bubbles ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ cancelable ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function TimerEvent(type, bubbles, cancelable) {
            return _super.call(this, type, bubbles, cancelable) || this;
        }
        /**
         * Instructs Egret runtime to render after processing of this event completes, if the display list has been modified.
         * @example
         * <pre>
         *    function onTimer(event:TimerEvent):void {
         *        if (40 < mySp.x && mySp.x < 375) {
         *            mySp.x-= 50;
         *        } else {
         *            mySp.x=374;
         *        }
         *        event.updateAfterEvent();
         *    }
         *
         *    let moveTimer:Timer=new Timer(50,250);
         *    moveTimer.addEventListener(TimerEvent.TIMER,onTimer);
         *    moveTimer.start();
         * </pre>
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆๅทฒไฟฎๆนๆพ็คบๅ่กจ๏ผ่ฐ็จๆญคๆนๆณๅฐไผๅฟฝ็ฅๅธง้ข้ๅถ๏ผๅจๆญคไบไปถๅค็ๅฎๆๅ็ซๅณ้็ปๅฑๅนใ
         * @example
         * <pre>
         *    function onTimer(event:TimerEvent):void {
         *        if (40 < mySp.x && mySp.x < 375) {
         *            mySp.x-= 50;
         *        } else {
         *            mySp.x=374;
         *        }
         *        event.updateAfterEvent();
         *    }
         *
         *    let moveTimer:Timer=new Timer(50,250);
         *    moveTimer.addEventListener(TimerEvent.TIMER,onTimer);
         *    moveTimer.start();
         * </pre>
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TimerEvent.prototype.updateAfterEvent = function () {
            egret.sys.$requestRenderingFlag = true;
        };
        /**
         * uses a specified target to dispatchEvent an event. Using this method can reduce the number of
         * reallocate event objects, which allows you to get better code execution performance.
         * @param target the event target
         * @param type The type of the event. Event listeners can access this information through the inherited type property.
         * @param bubbles Determines whether the Event object bubbles. Event listeners can access this information through
         * the inherited bubbles property.
         * @param cancelable Determines whether the Event object can be canceled. Event listeners can access this information
         * through the inherited cancelable property.
         * @see egret.Event.create()
         * @see egret.Event.release()
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target ไบไปถๆดพๅ็ฎๆ
         * @param type ไบไปถ็็ฑปๅใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ type ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @param bubbles ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅๆณกใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ bubbles ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใไบไปถไพฆๅฌๅจๅฏไปฅ้่ฟ็ปงๆฟ็ cancelable ๅฑๆง่ฎฟ้ฎๆญคไฟกๆฏใ
         * @see egret.Event.create()
         * @see egret.Event.release()
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TimerEvent.dispatchTimerEvent = function (target, type, bubbles, cancelable) {
            var event = egret.Event.create(TimerEvent, type, bubbles, cancelable);
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Dispatched whenever a Timer object reaches an interval specified according to the Timer.delay property.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฏๅฝ Timer ๅฏน่ฑก่พพๅฐๆนๆฎ Timer.delay ๅฑๆงๆๅฎ็้ด้ๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TimerEvent.TIMER = "timer";
        /**
         * Dispatched whenever it has completed the number of requests set by Timer.repeatCount.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฏๅฝๅฎๅฎๆ Timer.repeatCount ่ฎพ็ฝฎ็่ฏทๆฑๆฐๅ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TimerEvent.TIMER_COMPLETE = "timerComplete";
        return TimerEvent;
    }(egret.Event));
    egret.TimerEvent = TimerEvent;
    __reflect(TimerEvent.prototype, "egret.TimerEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * A BitmapData object contains an array of pixel data. This data can represent either a fully opaque bitmap or a
     * transparent bitmap that contains alpha channel data. Either type of BitmapData object is stored as a buffer of 32-bit
     * integers. Each 32-bit integer determines the properties of a single pixel in the bitmap.<br/>
     * Each 32-bit integer is a combination of four 8-bit channel values (from 0 to 255) that describe the alpha transparency
     * and the red, green, and blue (ARGB) values of the pixel. (For ARGB values, the most significant byte represents the
     * alpha channel value, followed by red, green, and blue.)
     * @see egret.Bitmap
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * BitmapData ๅฏน่ฑกๆฏไธไธชๅๅซๅ็ดๆฐๆฎ็ๆฐ็ปใๆญคๆฐๆฎๅฏไปฅ่กจ็คบๅฎๅจไธ้ๆ็ไฝๅพ๏ผๆ่กจ็คบๅๅซ Alpha ้้ๆฐๆฎ็้ๆไฝๅพใ
     * ไปฅไธไปปไธ็ฑปๅ็ BitmapData ๅฏน่ฑก้ฝไฝไธบ 32 ไฝๆดๆฐ็็ผๅฒๅบ่ฟ่กๅญๅจใๆฏไธช 32 ไฝๆดๆฐ็กฎๅฎไฝๅพไธญๅไธชๅ็ด็ๅฑๆงใ<br/>
     * ๆฏไธช 32 ไฝๆดๆฐ้ฝๆฏๅไธช 8 ไฝ้้ๅผ๏ผไป 0 ๅฐ 255๏ผ็็ปๅ๏ผ่ฟไบๅผๆ่ฟฐๅ็ด็ Alpha ้ๆๅบฆไปฅๅ็บข่ฒใ็ปฟ่ฒใ่่ฒ (ARGB) ๅผใ
     * ๏ผๅฏนไบ ARGB ๅผ๏ผๆ้ซๆๆๅญ่ไปฃ่กจ Alpha ้้ๅผ๏ผๅถๅ็ๆๆๅญ่ๅๅซไปฃ่กจ็บข่ฒใ็ปฟ่ฒๅ่่ฒ้้ๅผใ๏ผ
     * @see egret.Bitmap
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var BitmapData = (function (_super) {
        __extends(BitmapData, _super);
        /**
         * Initializes a BitmapData object to refer to the specified source object.
         * @param source The source object being referenced.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๅผ็จๆๅฎ source ๅฎไพ็ BitmapData ๅฏน่ฑก
         * @param source ่ขซๅผ็จ็ source ๅฎไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function BitmapData(source) {
            var _this = _super.call(this) || this;
            /**
             * Texture format.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็บน็ๆผๅผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.format = "image";
            /**
             * @private
             * webgl็บน็็ๆๅ๏ผๆฏๅฆๅๆๅๅงๅพๅๆฐๆฎ
             */
            _this.$deleteSource = true;
            _this.source = source;
            _this.width = source.width;
            _this.height = source.height;
            return _this;
        }
        BitmapData.create = function (type, data) {
            if (egret.Capabilities.runtimeType === egret.RuntimeType.WEB) {
                var base64 = "";
                if (type === "arraybuffer") {
                    base64 = egret.Base64Util.encode(data);
                }
                else {
                    base64 = data;
                }
                var imageType = "image/png"; //default value
                if (base64.charAt(0) === '/') {
                    imageType = "image/jpeg";
                }
                else if (base64.charAt(0) === 'R') {
                    imageType = "image/gif";
                }
                else if (base64.charAt(0) === 'i') {
                    imageType = "image/png";
                }
                var img_1 = new Image();
                img_1.src = "data:" + imageType + ";base64," + base64;
                img_1.crossOrigin = '*';
                var bitmapData_1 = new BitmapData(img_1);
                img_1.onload = function () {
                    img_1.onload = undefined;
                    bitmapData_1.source = img_1;
                    bitmapData_1.height = img_1.height;
                    bitmapData_1.width = img_1.width;
                };
                return bitmapData_1;
            }
            else {
                var buffer = null;
                if (type === "arraybuffer") {
                    buffer = data;
                }
                else {
                    buffer = egret.Base64Util.decode(data);
                }
                var native_texture = egret_native.Texture.createTextureFromArrayBuffer(buffer);
                return new BitmapData(native_texture);
            }
        };
        BitmapData.prototype.$dispose = function () {
            if (egret.Capabilities.runtimeType == egret.RuntimeType.WEB && egret.Capabilities.renderMode == "webgl" && this.webGLTexture) {
                egret.WebGLUtils.deleteWebGLTexture(this.webGLTexture);
                this.webGLTexture = null;
            }
            //native
            if (this.source && this.source.dispose) {
                this.source.dispose();
            }
            this.source = null;
            BitmapData.$dispose(this);
        };
        BitmapData.$addDisplayObject = function (displayObject, bitmapData) {
            var hashCode;
            if (bitmapData._bitmapData && bitmapData._bitmapData.hashCode) {
                hashCode = bitmapData._bitmapData.hashCode;
            }
            else {
                hashCode = bitmapData.hashCode;
            }
            if (!hashCode) {
                return;
            }
            if (!BitmapData._displayList[hashCode]) {
                BitmapData._displayList[hashCode] = [displayObject];
                return;
            }
            var tempList = BitmapData._displayList[hashCode];
            if (tempList.indexOf(displayObject) < 0) {
                tempList.push(displayObject);
            }
        };
        BitmapData.$removeDisplayObject = function (displayObject, bitmapData) {
            var hashCode;
            if (bitmapData._bitmapData && bitmapData._bitmapData.hashCode) {
                hashCode = bitmapData._bitmapData.hashCode;
            }
            else {
                hashCode = bitmapData.hashCode;
            }
            if (!hashCode) {
                return;
            }
            if (!BitmapData._displayList[hashCode]) {
                return;
            }
            var tempList = BitmapData._displayList[hashCode];
            var index = tempList.indexOf(displayObject);
            if (index >= 0) {
                tempList.splice(index);
            }
        };
        BitmapData.$invalidate = function (bitmapData) {
            var hashCode;
            if (bitmapData._bitmapData && bitmapData._bitmapData.hashCode) {
                hashCode = bitmapData._bitmapData.hashCode;
            }
            else {
                hashCode = bitmapData.hashCode;
            }
            if (!hashCode) {
                return;
            }
            if (!BitmapData._displayList[hashCode]) {
                return;
            }
            var tempList = BitmapData._displayList[hashCode];
            for (var i = 0; i < tempList.length; i++) {
                if (tempList[i] instanceof egret.Bitmap) {
                    tempList[i].$refreshImageData();
                }
                tempList[i].$invalidateContentBounds();
            }
        };
        BitmapData.$dispose = function (bitmapData) {
            var hashCode;
            if (bitmapData._bitmapData && bitmapData._bitmapData.hashCode) {
                hashCode = bitmapData._bitmapData.hashCode;
            }
            else {
                hashCode = bitmapData.hashCode;
            }
            if (!hashCode) {
                return;
            }
            if (!BitmapData._displayList[hashCode]) {
                return;
            }
            var tempList = BitmapData._displayList[hashCode];
            for (var _i = 0, tempList_1 = tempList; _i < tempList_1.length; _i++) {
                var node = tempList_1[_i];
                if (node instanceof egret.Bitmap) {
                    node.$Bitmap[1 /* image */] = null;
                }
                node.$invalidateContentBounds();
            }
            delete BitmapData._displayList[hashCode];
        };
        BitmapData._displayList = egret.createMap();
        return BitmapData;
    }(egret.HashObject));
    egret.BitmapData = BitmapData;
    __reflect(BitmapData.prototype, "egret.BitmapData");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../geom/Point.ts" />
var egret;
(function (egret) {
    var localPoint = new egret.Point();
    /**
     * The TouchEvent class lets you handle events on devices that detect user contact with the device (such as a finger
     * on a touch screen).When a user interacts with a device such as a mobile phone or tablet with a touch screen, the
     * user typically touches the screen with his or her fingers or a pointing device. You can develop applications that
     * respond to basic touch events (such as a single finger tap) with the TouchEvent class. Create event listeners using
     * the event types defined in this class.
     * Note: When objects are nested on the display list, touch events target the deepest possible nested object that is
     * visible in the display list. This object is called the target node. To have a target node's ancestor (an object
     * containing the target node in the display list) receive notification of a touch event, use EventDispatcher.addEventListener()
     * on the ancestor node with the type parameter set to the specific touch event you want to detect.
     *
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TouchEvent.ts
     * @language en_US
     */
    /**
     * ไฝฟ็จ TouchEvent ็ฑป๏ผๆจๅฏไปฅๅค็่ฎพๅคไธ้ฃไบๆฃๆต็จๆทไธ่ฎพๅคไน้ด็ๆฅ่งฆ็ไบไปถใ
     * ๅฝ็จๆทไธๅธฆๆ่งฆๆธๅฑ็็งปๅจ็ต่ฏๆๅนณๆฟ็ต่็ญ่ฎพๅคไบคไบๆถ๏ผ็จๆท้ๅธธไฝฟ็จๆๆๆๆ้่ฎพๅคๆฅ่งฆๅฑๅนใๅฏไฝฟ็จ TouchEvent
     * ็ฑปๅผๅๅๅบๅบๆฌ่งฆๆธไบไปถ๏ผๅฆๅไธชๆๆ็นๅป๏ผ็ๅบ็จ็จๅบใไฝฟ็จๆญค็ฑปไธญๅฎไน็ไบไปถ็ฑปๅๅๅปบไบไปถไพฆๅฌๅจใ
     * ๆณจๆ๏ผๅฝๅฏน่ฑกๅตๅฅๅจๆพ็คบๅ่กจไธญๆถ๏ผ่งฆๆธไบไปถ็็ฎๆๅฐๆฏๆพ็คบๅ่กจไธญๅฏ่ง็ๆๆทฑ็ๅฏ่ฝๅตๅฅๅฏน่ฑกใ
     * ๆญคๅฏน่ฑก็งฐไธบ็ฎๆ่็นใ่ฆไฝฟ็ฎๆ่็น็็ฅไปฃ๏ผ็ฅไปฃๆฏไธไธชๅๅซๆพ็คบๅ่กจไธญๆๆ็ฎๆ่็น็ๅฏน่ฑก๏ผไป่ๅฐๅฐ็ฎๆ่็น็็ถ่็นๅๅๆฌๅจๅ๏ผ
     * ๆฅๆถ่งฆๆธไบไปถ็้็ฅ๏ผ่ฏทๅฏน็ฅไปฃ่็นไฝฟ็จ EventDispatcher.on() ๅนถๅฐ type ๅๆฐ่ฎพ็ฝฎไธบ่ฆๆฃๆต็็นๅฎ่งฆๆธไบไปถใ
     *
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/events/TouchEvent.ts
     * @language zh_CN
     */
    var TouchEvent = (function (_super) {
        __extends(TouchEvent, _super);
        /**
         * Creates an Event object that contains information about touch events.
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @param stageX The horizontal coordinate at which the event occurred in global Stage coordinates.
         * @param stageY The vertical coordinate at which the event occurred in global Stage coordinates.
         * @param touchPointID A unique identification number assigned to the touch point.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช TouchEvent ๅฏน่ฑก๏ผๅถไธญๅๅซๆๅณTouchไบไปถ็ไฟกๆฏ
         * @param type ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @param stageX ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆ็ณปไธญ็ๆฐดๅนณๅๆ
         * @param stageY ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆ็ณปไธญ็ๅ็ดๅๆ
         * @param touchPointID ๅ้็ป่งฆๆธ็น็ๅฏไธๆ่ฏๅท
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function TouchEvent(type, bubbles, cancelable, stageX, stageY, touchPointID) {
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            _this.targetChanged = true;
            /**
             * Whether the touch is pressed (true) or not pressed (false).
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ่งฆๆธๅทฒๆไธ (true) ่ฟๆฏๆชๆไธ (false)ใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.touchDown = false;
            _this.$initTo(stageX, stageY, touchPointID);
            return _this;
        }
        /**
         * @private
         */
        TouchEvent.prototype.$initTo = function (stageX, stageY, touchPointID) {
            this.touchPointID = +touchPointID || 0;
            this.$stageX = +stageX || 0;
            this.$stageY = +stageY || 0;
        };
        Object.defineProperty(TouchEvent.prototype, "stageX", {
            /**
             * The horizontal coordinate at which the event occurred in global Stage coordinates.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆไธญ็ๆฐดๅนณๅๆใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$stageX;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TouchEvent.prototype, "stageY", {
            /**
             * The vertical coordinate at which the event occurred in global Stage coordinates.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆไธญ็ๅ็ดๅๆใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$stageY;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TouchEvent.prototype, "localX", {
            /**
             * The horizontal coordinate at which the event occurred relative to the display object.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถๅ็็น็ธๅฏนไบๆๅฑๆพ็คบๅฏน่ฑก็ๆฐดๅนณๅๆใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (this.targetChanged) {
                    this.getLocalXY();
                }
                return this._localX;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TouchEvent.prototype, "localY", {
            /**
             * The vertical coordinate at which the event occurred relative to the display object.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไบไปถๅ็็น็ธๅฏนไบๆๅฑๆพ็คบๅฏน่ฑก็ๅ็ดๅๆใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (this.targetChanged) {
                    this.getLocalXY();
                }
                return this._localY;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        TouchEvent.prototype.getLocalXY = function () {
            this.targetChanged = false;
            var m = this.$target.$getInvertedConcatenatedMatrix();
            m.transformPoint(this.$stageX, this.$stageY, localPoint);
            this._localX = localPoint.x;
            this._localY = localPoint.y;
        };
        TouchEvent.prototype.$setTarget = function (target) {
            this.$target = target;
            this.targetChanged = !!target;
            return true;
        };
        /**
         * Instructs Egret runtime to render after processing of this event completes, if the display list has been modified.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆๅทฒไฟฎๆนๆพ็คบๅ่กจ๏ผ่ฐ็จๆญคๆนๆณๅฐไผๅฟฝ็ฅๅธง้ข้ๅถ๏ผๅจๆญคไบไปถๅค็ๅฎๆๅ็ซๅณ้็ปๅฑๅนใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.prototype.updateAfterEvent = function () {
            egret.sys.$requestRenderingFlag = true;
        };
        /**
         * uses a specified target to dispatchEvent an event. Using this method can reduce the number of
         * reallocate event objects, which allows you to get better code execution performance.
         * @param target the event target
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @param stageX The horizontal coordinate at which the event occurred in global Stage coordinates.
         * @param stageY The vertical coordinate at which the event occurred in global Stage coordinates.
         * @param touchPointID A unique identification number (as an int) assigned to the touch point.
         *
         * @see egret.Event.create()
         * @see egret.Event.release()
         *
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบEventไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @param target ๆดพๅไบไปถ็ฎๆ
         * @param type ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @param stageX ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆ็ณปไธญ็ๆฐดๅนณๅๆ
         * @param stageY ไบไปถๅ็็นๅจๅจๅฑ่ๅฐๅๆ็ณปไธญ็ๅ็ดๅๆ
         * @param touchPointID ๅ้็ป่งฆๆธ็น็ๅฏไธๆ่ฏๅท
         *
         * @see egret.Event.create()
         * @see egret.Event.release()
         *
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.dispatchTouchEvent = function (target, type, bubbles, cancelable, stageX, stageY, touchPointID, touchDown) {
            if (touchDown === void 0) {
                touchDown = false;
            }
            if (!bubbles && !target.hasEventListener(type)) {
                return true;
            }
            var event = egret.Event.create(TouchEvent, type, bubbles, cancelable);
            event.$initTo(stageX, stageY, touchPointID);
            event.touchDown = touchDown;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Dispatched when the user touches the device, and is continuously dispatched until the point of contact is removed.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ็จๆท่งฆ็ขฐ่ฎพๅคๆถ่ฟ่ก่ฐๅบฆ๏ผ่ไธไผ่ฟ็ปญ่ฐๅบฆ๏ผ็ดๅฐๆฅ่งฆ็น่ขซๅ้คใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_MOVE = "touchMove";
        /**
         * Dispatched when the user first contacts a touch-enabled device (such as touches a finger to a mobile phone or tablet with a touch screen).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ็จๆท็ฌฌไธๆฌก่งฆๆธๅฏ็จ่งฆๆธ็่ฎพๅคๆถ๏ผไพๅฆ๏ผ็จๆๆ่งฆๆธ้ๆ่งฆๆธๅฑ็็งปๅจ็ต่ฏๆๅนณๆฟ็ต่๏ผ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_BEGIN = "touchBegin";
        /**
         * Dispatched when the user removes contact with a touch-enabled device (such as lifts a finger off a mobile phone
         * or tablet with a touch screen).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ็จๆท็งป้คไธๅฏ็จ่งฆๆธ็่ฎพๅค็ๆฅ่งฆๆถ๏ผไพๅฆ๏ผๅฐๆๆไป้ๆ่งฆๆธๅฑ็็งปๅจ็ต่ฏๆๅนณๆฟ็ต่ไธๆฌ่ตท๏ผ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_END = "touchEnd";
        /**
         * Dispatched when an event of some kind occurred that canceled the touch.
         * Such as the eui.Scroller will dispatch 'TOUCH_CANCEL' when it start move, the 'TOUCH_END' and 'TOUCH_TAP' will not be triggered.
         * @version Egret 3.0.1
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฑไบๆไธชไบไปถๅๆถไบ่งฆๆธๆถ่งฆๅใๆฏๅฆ eui.Scroller ๅจๅผๅงๆปๅจๅไผ่งฆๅ 'TOUCH_CANCEL' ไบไปถ๏ผไธๅ่งฆๅๅ็ปญ็ 'TOUCH_END' ๅ 'TOUCH_TAP' ไบไปถ
         * @version Egret 3.0.1
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_CANCEL = "touchCancel";
        /**
         * Dispatched when the user lifts the point of contact over the same DisplayObject instance on which the contact
         * was initiated on a touch-enabled device.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ็จๆทๅจ่งฆๆธ่ฎพๅคไธไธๅผๅง่งฆๆธ็ๅไธ DisplayObject ๅฎไพไธๆฌ่ตทๆฅ่งฆ็นๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_TAP = "touchTap";
        /**
         * Dispatched when the user lifts the point of contact over the different DisplayObject instance on which the contact
         * was initiated on a touch-enabled device (such as presses and releases a finger from a single point over a display
         * object on a mobile phone or tablet with a touch screen).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ็จๆทๅจ่งฆๆธ่ฎพๅคไธไธๅผๅง่งฆๆธ็ไธๅ DisplayObject ๅฎไพไธๆฌ่ตทๆฅ่งฆ็นๆถ่ฐๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TouchEvent.TOUCH_RELEASE_OUTSIDE = "touchReleaseOutside";
        return TouchEvent;
    }(egret.Event));
    egret.TouchEvent = TouchEvent;
    __reflect(TouchEvent.prototype, "egret.TouchEvent");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The BlurFilter class lets you apply a blur visual effect to display objects. A blur effect softens the details of an image.
     * You can produce blurs that range from a softly unfocused look to a Gaussian blur, a hazy appearance like viewing an image through semi-opaque glass.
     * @version Egret 3.0.1
     * @platform Web
     * @see http://edn.egret.com/cn/docs/page/947#ๆจก็ณๆปค้ ๆจก็ณๆปค้
     * @language en_US
     */
    /**
     * ๅฏไฝฟ็จ BlurFilter ็ฑปๅฐๆจก็ณ่ง่งๆๆๅบ็จไบๆพ็คบๅฏน่ฑกใๆจก็ณๆๆๅฏไปฅๆๅๅพๅ็็ป่ใ
     * ๆจๅฏไปฅ็ๆไธไบๆจก็ณๆๆ๏ผ่ๅดไปๅๅปบไธไธชๆๅ็ใๆช่็ฆ็ๅค่งๅฐ้ซๆฏๆจก็ณ๏ผๅฐฑๅ้่ฟๅ้ๆ็ป็ๆฅ็ๅพๅไธๆท็ๆฆ่ง็ๅค่ง๏ผใ
     * @version Egret 3.1.0
     * @platform Web
     * @see http://edn.egret.com/cn/docs/page/947#ๆจก็ณๆปค้ ๆจก็ณๆปค้
     * @language zh_CN
     */
    var BlurFilter = (function (_super) {
        __extends(BlurFilter, _super);
        /**
         * Initializes a BlurFilter object.
         * @param blurX {number} The amount of horizontal blur. Valid values are 0 to 255 (floating point).
         * @param blurY {number} The amount of vertical blur. Valid values are 0 to 255 (floating point).
         * @param quality {number} The number of times to apply the filter.
         * @version Egret 3.1.0
         * @platform Web
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช BlurFilter ๅฏน่ฑกใ
         * @param blurX {number} ๆฐดๅนณๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param blurY {number} ๅ็ดๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param quality {number} ๅบ็จๆปค้็ๆฌกๆฐใๆๆชๅฎ็ฐใ
         * @version Egret 3.1.0
         * @platform Web
         * @language zh_CN
         */
        function BlurFilter(blurX, blurY, quality) {
            if (blurX === void 0) {
                blurX = 4;
            }
            if (blurY === void 0) {
                blurY = 4;
            }
            if (quality === void 0) {
                quality = 1;
            }
            var _this = _super.call(this) || this;
            _this.type = "blur";
            _this.$blurX = blurX;
            _this.$blurY = blurY;
            _this.$quality = quality;
            _this.blurXFilter = new BlurXFilter(blurX);
            _this.blurYFilter = new BlurYFilter(blurY);
            return _this;
        }
        Object.defineProperty(BlurFilter.prototype, "blurX", {
            /**
             * The amount of horizontal blur.
             * @version Egret 3.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๆฐดๅนณๆจก็ณ้ใ
             * @version Egret 3.1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$blurX;
            },
            set: function (value) {
                if (this.$blurX == value) {
                    return;
                }
                this.$blurX = value;
                this.blurXFilter.blurX = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BlurFilter.prototype, "blurY", {
            /**
             * The amount of vertical blur.
             * @version Egret 3.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๅ็ดๆจก็ณ้ใ
             * @version Egret 3.1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$blurY;
            },
            set: function (value) {
                if (this.$blurY == value) {
                    return;
                }
                this.$blurY = value;
                this.blurYFilter.blurY = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        BlurFilter.prototype.$toJson = function () {
            return '{"blurX": ' + this.$blurX + ', "blurY": ' + this.$blurY + ', "quality": 1}';
        };
        return BlurFilter;
    }(egret.Filter));
    egret.BlurFilter = BlurFilter;
    __reflect(BlurFilter.prototype, "egret.BlurFilter");
    var BlurXFilter = (function (_super) {
        __extends(BlurXFilter, _super);
        function BlurXFilter(blurX) {
            if (blurX === void 0) {
                blurX = 4;
            }
            var _this = _super.call(this) || this;
            _this.type = "blurX";
            _this.$uniforms.blur = { x: blurX, y: 0 };
            return _this;
        }
        Object.defineProperty(BlurXFilter.prototype, "blurX", {
            get: function () {
                return this.$uniforms.blur.x;
            },
            set: function (value) {
                this.$uniforms.blur.x = value;
            },
            enumerable: true,
            configurable: true
        });
        return BlurXFilter;
    }(egret.Filter));
    __reflect(BlurXFilter.prototype, "BlurXFilter", ["egret.IBlurXFilter"]);
    var BlurYFilter = (function (_super) {
        __extends(BlurYFilter, _super);
        function BlurYFilter(blurY) {
            if (blurY === void 0) {
                blurY = 4;
            }
            var _this = _super.call(this) || this;
            _this.type = "blurY";
            _this.$uniforms.blur = { x: 0, y: blurY };
            return _this;
        }
        Object.defineProperty(BlurYFilter.prototype, "blurY", {
            get: function () {
                return this.$uniforms.blur.y;
            },
            set: function (value) {
                this.$uniforms.blur.y = value;
            },
            enumerable: true,
            configurable: true
        });
        return BlurYFilter;
    }(egret.Filter));
    __reflect(BlurYFilter.prototype, "BlurYFilter", ["egret.IBlurYFilter"]);
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The ColorMatrixFilter class lets you apply a 4 x 5 matrix transformation on the RGBA color and alpha values of every pixel in the input image to produce a result with a new set of RGBA color and alpha values.
     * It allows saturation changes, hue rotation, luminance to alpha, and various other effects.
     * @version Egret 3.1.0
     * @platform Web
     * @see http://edn.egret.com/cn/docs/page/947 ้ข่ฒ็ฉ้ตๆปค้
     * @language en_US
     */
    /**
     * ไฝฟ็จ ColorMatrixFilter ็ฑปๅฏไปฅๅฐ 4 x 5 ็ฉ้ต่ฝฌๆขๅบ็จไบ่พๅฅๅพๅไธ็ๆฏไธชๅ็ด็ RGBA ้ข่ฒๅ Alpha ๅผ๏ผไปฅ็ๆๅทๆไธ็ปๆฐ็ RGBA ้ข่ฒๅ Alpha ๅผ็็ปๆใ
     * ่ฏฅ็ฑปๅ่ฎธ้ฅฑๅๅบฆๆดๆนใ่ฒ็ธๆ่ฝฌใไบฎๅบฆไธบ Alpha ไปฅๅๅ็งๅถไปๆๆใ
     * @version Egret 3.1.0
     * @platform Web
     * @see http://edn.egret.com/cn/docs/page/947 ้ข่ฒ็ฉ้ตๆปค้
     * @language zh_CN
     */
    var ColorMatrixFilter = (function (_super) {
        __extends(ColorMatrixFilter, _super);
        /**
         * Initializes a ColorMatrixFilter object.
         * @version Egret 3.1.0
         * @platform Web
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช ColorMatrixFilter ๅฏน่ฑกใ
         * @version Egret 3.1.0
         * @platform Web
         * @language zh_CN
         */
        function ColorMatrixFilter(matrix) {
            if (matrix === void 0) {
                matrix = null;
            }
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$matrix = [];
            /**
             * @private
             */
            _this.matrix2 = [];
            _this.type = "colorTransform";
            _this.$uniforms.matrix = [
                1, 0, 0, 0,
                0, 1, 0, 0,
                0, 0, 1, 0,
                0, 0, 0, 1
            ];
            _this.$uniforms.colorAdd = { x: 0, y: 0, z: 0, w: 0 };
            _this.setMatrix(matrix);
            return _this;
        }
        Object.defineProperty(ColorMatrixFilter.prototype, "matrix", {
            /**
             * A comma delimited list of 20 doubles that comprise a 4x5 matrix applied to the rendered element.
             * The matrix is in row major order -- that is, the first five elements are multipled by the vector [srcR,srcG,srcB,srcA,1] to determine the output red value, the second five determine the output green value, etc.
             * The value must either be an array or comma delimited string of 20 numbers.
             * @version Egret 3.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๆๆๅบ็จไบๆๅ็คบ็ๅ็ด็ไธไธช 4x5 ็ฉ้ต็ใไปฅ้ๅทๅ้็ 20 ไธชๅ็ฒพๅบฆๆฐ็ๅ่กจใ
             * ็ฉ้ตไปฅ่กไฝไธบไธป่ฆ้กบๅบ๏ผๅณ็จ็ฌฌไธ่กไบไธชๅ็ดไนไปฅ็ข้ [srcR,srcG,srcB,srcA,1] ไปฅ็กฎๅฎ่พๅบ็็บข่ฒๅผ๏ผ็จ็ฌฌไบ่ก็ไบไธชๅ็ด็กฎๅฎ่พๅบ็็ปฟ่ฒๅผ๏ผ็ญ็ญใ
             * ่ฏฅๅผๅฟ้กปไธบ 20 ไธชๆฐๅญ็ปๆ็ๆฐ็ปๆไปฅ้ๅทๅ้็ๅญ็ฌฆไธฒใ
             * @version Egret 3.1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                for (var i = 0; i < 20; i++) {
                    this.matrix2[i] = this.$matrix[i];
                }
                return this.matrix2;
            },
            set: function (value) {
                this.setMatrix(value);
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        ColorMatrixFilter.prototype.setMatrix = function (value) {
            if (value) {
                for (var i = 0; i < 20; i++) {
                    this.$matrix[i] = value[i];
                }
            }
            else {
                for (var i = 0; i < 20; i++) {
                    this.$matrix[i] = (i == 0 || i == 6 || i == 12 || i == 18) ? 1 : 0;
                }
            }
            var $matrix = this.$matrix;
            var matrix = this.$uniforms.matrix;
            var colorAdd = this.$uniforms.colorAdd;
            for (var i = 0, j = 0; i < $matrix.length; i++) {
                if (i === 4) {
                    colorAdd.x = $matrix[i] / 255;
                }
                else if (i === 9) {
                    colorAdd.y = $matrix[i] / 255;
                }
                else if (i === 14) {
                    colorAdd.z = $matrix[i] / 255;
                }
                else if (i === 19) {
                    colorAdd.w = $matrix[i] / 255;
                }
                else {
                    matrix[j] = $matrix[i];
                    j++;
                }
            }
        };
        /**
         * @private
         */
        ColorMatrixFilter.prototype.$toJson = function () {
            return '{"matrix": [' + this.$matrix.toString() + ']}';
        };
        return ColorMatrixFilter;
    }(egret.Filter));
    egret.ColorMatrixFilter = ColorMatrixFilter;
    __reflect(ColorMatrixFilter.prototype, "egret.ColorMatrixFilter");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var SOURCE_KEY_MAP = {};
    var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
    var uuid = new Array(36);
    var rnd = 0, r;
    /**
     * generate uuid
     * http://www.broofa.com/Tools/Math.uuid.htm
     */
    var generateUUID = function () {
        for (var i = 0; i < 36; i++) {
            if (i === 8 || i === 13 || i === 18 || i === 23) {
                uuid[i] = '-';
            }
            else if (i === 14) {
                uuid[i] = '4';
            }
            else {
                if (rnd <= 0x02)
                    rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;
                r = rnd & 0xf;
                rnd = rnd >> 4;
                uuid[i] = chars[(i === 19) ? (r & 0x3) | 0x8 : r];
            }
        }
        return uuid.join('');
    };
    /**
     * custom filter, now support WebGL mode only.
     * @version Egret 4.1.0
     * @platform Web
     * @language en_US
     */
    /**
     * ่ชๅฎไนๆปค้๏ผ็ฎๅไปๆฏๆWebGLๆจกๅผ
     * @version Egret 4.1.0
     * @platform Web
     * @language zh_CN
     */
    var CustomFilter = (function (_super) {
        __extends(CustomFilter, _super);
        /**
         * Initialize the CustomFilter object.
         * @param vertexSrc Custom vertex shader program.
         * @param fragmentSrc Custom fragment shader program.
         * @param uniforms The initial value of the uniform in the shader (key, value one-to-one correspondence), currently only supports numbers and arrays.
         * @version Egret 4.1.0
         * @platform Web
         * @language en_US
         */
        /**
         * ๅๅงๅ CustomFilter ๅฏน่ฑก
         * @param vertexSrc ่ชๅฎไน็้กถ็น็่ฒๅจ็จๅบใ
         * @param fragmentSrc ่ชๅฎไน็็ๆฎต็่ฒๅจ็จๅบใ
         * @param uniforms ็่ฒๅจไธญuniform็ๅๅงๅผ๏ผkey๏ผvalueไธไธๅฏนๅบ๏ผ๏ผ็ฎๅไปๆฏๆๆฐๅญๅๆฐ็ปใ
         * @version Egret 4.1.0
         * @platform Web
         * @language zh_CN
         */
        function CustomFilter(vertexSrc, fragmentSrc, uniforms) {
            if (uniforms === void 0) {
                uniforms = {};
            }
            var _this = _super.call(this) || this;
            /**
             * The inner margin of the filter.
             * If the desired area of the custom filter is larger than the original area (stroke, etc.), you need to set it manually.
             * @version Egret 4.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๆปค้็ๅ่พน่ท
             * ๅฆๆ่ชๅฎไนๆปค้ๆ้ๅบๅๆฏๅๅบๅๅคง๏ผๆ่พน็ญ๏ผ๏ผ้่ฆๆๅจ่ฎพ็ฝฎ
             * @version Egret 4.1.0
             * @platform Web
             * @language zh_CN
             */
            _this.padding = 0;
            _this.$vertexSrc = vertexSrc;
            _this.$fragmentSrc = fragmentSrc;
            var tempKey = vertexSrc + fragmentSrc;
            if (!SOURCE_KEY_MAP[tempKey]) {
                SOURCE_KEY_MAP[tempKey] = generateUUID();
            }
            _this.$shaderKey = SOURCE_KEY_MAP[tempKey];
            _this.$uniforms = uniforms;
            _this.type = "custom";
            return _this;
        }
        Object.defineProperty(CustomFilter.prototype, "uniforms", {
            /**
             * The initial value of the uniform in the shader (key, value one-to-one correspondence), currently only supports numbers and arrays.
             * @version Egret 4.1.0
             * @platform Web
             * @language en_US
             */
            /**
             * ็่ฒๅจไธญuniform็ๅๅงๅผ๏ผkey๏ผvalueไธไธๅฏนๅบ๏ผ๏ผ็ฎๅไปๆฏๆๆฐๅญๅๆฐ็ปใ
             * @version Egret 4.1.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$uniforms;
            },
            enumerable: true,
            configurable: true
        });
        return CustomFilter;
    }(egret.Filter));
    egret.CustomFilter = CustomFilter;
    __reflect(CustomFilter.prototype, "egret.CustomFilter");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @class egret.DropShadowFilter
     * @classdesc
     * ๅฏไฝฟ็จ DropShadowFilter ็ฑปๅๆพ็คบๅฏน่ฑกๆทปๅๆๅฝฑใ
     * @extends egret.GlowFilter
     * @version Egret 3.1.4
     * @platform Web,Native
     */
    var DropShadowFilter = (function (_super) {
        __extends(DropShadowFilter, _super);
        /**
         * Initializes a new DropShadowFilter instance.
         * @method egret.DropShadowFilter#constructor
         * @param distance {number} The offset distance of the bevel. Valid values are in pixels (floating point).
         * @param angle {number} The angle of the bevel. Valid values are from 0 to 360ยฐ.
         * @param color {number} The color of the glow. Valid values are in the hexadecimal format 0xRRGGBB. The default value is 0xFF0000.
         * @param alpha {number} The alpha transparency value for the color. Valid values are 0 to 1. For example, .25 sets a transparency value of 25%. The default value is 1.
         * @param blurX {number} The amount of horizontal blur. Valid values are 0 to 255 (floating point).
         * @param blurY {number} The amount of vertical blur. Valid values are 0 to 255 (floating point).
         * @param strength {number} The strength of the imprint or spread. The higher the value, the more color is imprinted and the stronger the contrast between the glow and the background. Valid values are 0 to 255.
         * @param quality {number} The number of times to apply the filter.
         * @param inner {boolean} Specifies whether the glow is an inner glow. The value true indicates an inner glow. The default is false, an outer glow (a glow around the outer edges of the object).
         * @param knockout {number} Specifies whether the object has a knockout effect. A value of true makes the object's fill transparent and reveals the background color of the document. The default value is false (no knockout effect).
         * @param hideObject {number} Indicates whether or not the object is hidden. The value true indicates that the object itself is not drawn; only the shadow is visible. The default is false, meaning that the object is shown.
         * @version Egret 3.1.4
         * @platform Web
         * @language en_US
         */
        /**
         * ๅๅงๅ DropShadowFilter ๅฏน่ฑก
         * @method egret.DropShadowFilter#constructor
         * @param distance {number} ้ดๅฝฑ็ๅ็งป่ท็ฆป๏ผไปฅๅ็ดไธบๅไฝใ
         * @param angle {number} ้ดๅฝฑ็่งๅบฆ๏ผ0 ๅฐ 360 ๅบฆ๏ผๆตฎ็น๏ผใ
         * @param color {number} ๅๆ้ข่ฒ๏ผ้็จๅๅญ่ฟๅถๆผๅผ 0xRRGGBBใ้ป่ฎคๅผไธบ 0xFF0000ใ
         * @param alpha {number} ้ข่ฒ็ Alpha ้ๆๅบฆๅผใๆๆๅผไธบ 0 ๅฐ 1ใไพๅฆ๏ผ0.25 ่ฎพ็ฝฎ้ๆๅบฆๅผไธบ 25%ใ
         * @param blurX {number} ๆฐดๅนณๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param blurY {number} ๅ็ดๆจก็ณ้ใๆๆๅผไธบ 0 ๅฐ 255๏ผๆตฎ็น๏ผใ
         * @param strength {number} ๅฐ่ฎฐๆ่ทจ้กต็ๅผบๅบฆใ่ฏฅๅผ่ถ้ซ๏ผๅๅฐ็้ข่ฒ่ถๆทฑ๏ผ่ไธๅๅไธ่ๆฏไน้ด็ๅฏนๆฏๅบฆไน่ถๅผบใๆๆๅผไธบ 0 ๅฐ 255ใ
         * @param quality {number} ๅบ็จๆปค้็ๆฌกๆฐใๆๆชๅฎ็ฐใ
         * @param inner {boolean} ๆๅฎๅๅๆฏๅฆไธบๅไพงๅๅใๅผ true ๆๅฎๅๅๆฏๅไพงๅๅใๅผ false ๆๅฎๅๅๆฏๅคไพงๅๅ๏ผๅฏน่ฑกๅค็ผๅจๅด็ๅๅ๏ผใ
         * @param knockout {number} ๆๅฎๅฏน่ฑกๆฏๅฆๅทๆๆ็ฉบๆๆใๅผไธบ true ๅฐไฝฟๅฏน่ฑก็ๅกซๅๅไธบ้ๆ๏ผๅนถๆพ็คบๆๆกฃ็่ๆฏ้ข่ฒใ
         * @param hideObject {number} ่กจ็คบๆฏๅฆ้่ๅฏน่ฑกใๅฆๆๅผไธบ true๏ผๅ่กจ็คบๆฒกๆ็ปๅถๅฏน่ฑกๆฌ่บซ๏ผๅชๆ้ดๅฝฑๆฏๅฏ่ง็ใ้ป่ฎคๅผไธบ false๏ผๆพ็คบๅฏน่ฑก๏ผใ
         * @version Egret 3.1.4
         * @platform Web
         * @language zh_CN
         */
        function DropShadowFilter(distance, angle, color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject) {
            if (distance === void 0) {
                distance = 4.0;
            }
            if (angle === void 0) {
                angle = 45;
            }
            if (color === void 0) {
                color = 0;
            }
            if (alpha === void 0) {
                alpha = 1.0;
            }
            if (blurX === void 0) {
                blurX = 4.0;
            }
            if (blurY === void 0) {
                blurY = 4.0;
            }
            if (strength === void 0) {
                strength = 1.0;
            }
            if (quality === void 0) {
                quality = 1;
            }
            if (inner === void 0) {
                inner = false;
            }
            if (knockout === void 0) {
                knockout = false;
            }
            if (hideObject === void 0) {
                hideObject = false;
            }
            var _this = _super.call(this, color, alpha, blurX, blurY, strength, quality, inner, knockout) || this;
            _this.$distance = distance;
            _this.$angle = angle;
            _this.$hideObject = hideObject;
            _this.$uniforms.dist = distance;
            _this.$uniforms.angle = angle / 180 * Math.PI;
            _this.$uniforms.hideObject = hideObject ? 1 : 0;
            return _this;
        }
        Object.defineProperty(DropShadowFilter.prototype, "distance", {
            /**
             * The offset distance of the bevel.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ้ดๅฝฑ็ๅ็งป่ท็ฆป๏ผไปฅๅ็ดไธบๅไฝใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$distance;
            },
            set: function (value) {
                if (this.$distance == value) {
                    return;
                }
                this.$distance = value;
                this.$uniforms.dist = value;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DropShadowFilter.prototype, "angle", {
            /**
             * The angle of the bevel.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ้ดๅฝฑ็่งๅบฆใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$angle;
            },
            set: function (value) {
                if (this.$angle == value) {
                    return;
                }
                this.$angle = value;
                this.$uniforms.angle = value / 180 * Math.PI;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DropShadowFilter.prototype, "hideObject", {
            /**
             * Indicates whether or not the object is hidden.
             * @version Egret 3.1.4
             * @platform Web
             * @language en_US
             */
            /**
             * ่กจ็คบๆฏๅฆ้่ๅฏน่ฑกใ
             * @version Egret 3.1.4
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                return this.$hideObject;
            },
            set: function (value) {
                if (this.$hideObject == value) {
                    return;
                }
                this.$hideObject = value;
                this.$uniforms.hideObject = value ? 1 : 0;
                this.invalidate();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        DropShadowFilter.prototype.$toJson = function () {
            return '{"distance": ' + this.$distance + ', "angle": ' + this.$angle + ', "color": ' + this.$color + ', "red": ' + this.$red + ', "green": ' + this.$green + ', "blue": ' + this.$blue + ', "alpha": ' + this.$alpha + ', "blurX": ' + this.$blurX + ', "blurY": ' + this.blurY + ', "strength": ' + this.$strength + ', "quality": ' + this.$quality + ', "inner": ' + this.$inner + ', "knockout": ' + this.$knockout + ', "hideObject": ' + this.$hideObject + '}';
        };
        return DropShadowFilter;
    }(egret.GlowFilter));
    egret.DropShadowFilter = DropShadowFilter;
    __reflect(DropShadowFilter.prototype, "egret.DropShadowFilter");
})(egret || (egret = {}));
var egret;
(function (egret) {
    /**
     * The GradientType class provides values for the type parameter in the beginGradientFill() methods of the egret.Graphics class.
     *
     * @see egret.Graphics#beginGradientFill()
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * GradientType ็ฑปไธบ egret.Graphics ็ฑป็ beginGradientFill() ๆนๆณไธญ็ type ๅๆฐๆไพๅผใ
     *
     * @see egret.Graphics#beginGradientFill()
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var GradientType = (function () {
        function GradientType() {
        }
        /**
         * Value used to specify a linear gradient fill.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๆๅฎ็บฟๆงๆธๅๅกซๅ็ๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        GradientType.LINEAR = "linear";
        /**
         * Value used to specify a radial gradient fill.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๆๅฎๆพๅฐ็ถๆธๅๅกซๅ็ๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        GradientType.RADIAL = "radial";
        return GradientType;
    }());
    egret.GradientType = GradientType;
    __reflect(GradientType.prototype, "egret.GradientType");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * ๆผๅผๅๅผง็บฟ่งๅบฆ็ๅผ
     */
    function clampAngle(value) {
        value %= Math.PI * 2;
        if (value < 0) {
            value += Math.PI * 2;
        }
        return value;
    }
    /**
     * The Graphics class contains a set of methods for creating vector shape. Display objects that support drawing include Sprite and Shape objects. Each class in these classes includes the graphics attribute that is a Graphics object.
     * The following auxiliary functions are provided for ease of use: drawRect(), drawRoundRect(), drawCircle(), and drawEllipse().
     * @see http://edn.egret.com/cn/docs/page/136 Draw Rectangle
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Graphics.ts
     * @language en_US
     */
    /**
     * Graphics ็ฑปๅๅซไธ็ปๅฏ็จๆฅๅๅปบ็ข้ๅฝข็ถ็ๆนๆณใๆฏๆ็ปๅถ็ๆพ็คบๅฏน่ฑกๅๆฌ Sprite ๅ Shape ๅฏน่ฑกใ่ฟไบ็ฑปไธญ็ๆฏไธไธช็ฑป้ฝๅๆฌ graphics ๅฑๆง๏ผ่ฏฅๅฑๆงๆฏไธไธช Graphics ๅฏน่ฑกใ
     * ไปฅไธๆฏไธบไพฟไบไฝฟ็จ่ๆไพ็ไธไบ่พๅฉๅฝๆฐ๏ผdrawRect()ใdrawRoundRect()ใdrawCircle() ๅ drawEllipse()ใ
     * @see http://edn.egret.com/cn/docs/page/136 ็ปๅถ็ฉๅฝข
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Graphics.ts
     * @language zh_CN
     */
    var Graphics = (function (_super) {
        __extends(Graphics, _super);
        /**
         * Initializes a Graphics object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช Graphics ๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Graphics() {
            var _this = _super.call(this) || this;
            /**
             * ๅฝๅ็งปๅจๅฐ็ๅๆX
             */
            _this.lastX = 0;
            /**
             * ๅฝๅ็งปๅจๅฐ็ๅๆY
             */
            _this.lastY = 0;
            /**
             * ๅฝๅๆญฃๅจ็ปๅถ็ๅกซๅ
             */
            _this.fillPath = null;
            /**
             * ๅฝๅๆญฃๅจ็ปๅถ็็บฟๆก
             */
            _this.strokePath = null;
            /**
             * ็บฟๆก็ๅทฆไธๆนๅฎฝๅบฆ
             */
            _this.topLeftStrokeWidth = 0;
            /**
             * ็บฟๆก็ๅณไธๆนๅฎฝๅบฆ
             */
            _this.bottomRightStrokeWidth = 0;
            /**
             * @private
             */
            _this.minX = Infinity;
            /**
             * @private
             */
            _this.minY = Infinity;
            /**
             * @private
             */
            _this.maxX = -Infinity;
            /**
             * @private
             */
            _this.maxY = -Infinity;
            /**
             * ๆฏๅฆๅทฒ็ปๅๅซไธไธๆฌกmoveTo็ๅๆ็น
             */
            _this.includeLastPosition = true;
            _this.$renderNode = new egret.sys.GraphicsNode();
            return _this;
        }
        /**
         * @private
         * ่ฎพ็ฝฎ็ปๅฎๅฐ็็ฎๆๆพ็คบๅฏน่ฑก
         */
        Graphics.prototype.$setTarget = function (target) {
            if (this.targetDisplay) {
                this.targetDisplay.$renderNode = null;
            }
            target.$renderNode = this.$renderNode;
            this.targetDisplay = target;
        };
        /**
         * ๅฏน1ๅ็ดๅ3ๅ็ด็นๆฎๅค็๏ผๅๅณไธ่งๅ็งป0.5ๅ็ด๏ผไปฅๆพ็คบๆธๆฐ้ๅฉ็็บฟๆกใ
         */
        Graphics.prototype.setStrokeWidth = function (width) {
            switch (width) {
                case 1:
                    this.topLeftStrokeWidth = 0;
                    this.bottomRightStrokeWidth = 1;
                    break;
                case 3:
                    this.topLeftStrokeWidth = 1;
                    this.bottomRightStrokeWidth = 2;
                    break;
                default:
                    var half = Math.ceil(width * 0.5) | 0;
                    this.topLeftStrokeWidth = half;
                    this.bottomRightStrokeWidth = half;
                    break;
            }
        };
        /**
         * Specify a simple single color fill that will be used for subsequent calls to other Graphics methods (for example, lineTo() and drawCircle()) when drawing.
         * Calling the clear() method will clear the fill.
         * @param color Filled color
         * @param alpha Filled Alpha value
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๅฎไธ็ง็ฎๅ็ๅไธ้ข่ฒๅกซๅ๏ผๅจ็ปๅถๆถ่ฏฅๅกซๅๅฐๅจ้ๅๅฏนๅถไป Graphics ๆนๆณ๏ผๅฆ lineTo() ๆ drawCircle()๏ผ็่ฐ็จไธญไฝฟ็จใ
         * ่ฐ็จ clear() ๆนๆณไผๆธ้คๅกซๅใ
         * @param color ๅกซๅ็้ข่ฒ
         * @param alpha ๅกซๅ็ Alpha ๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.beginFill = function (color, alpha) {
            if (alpha === void 0) {
                alpha = 1;
            }
            color = +color || 0;
            alpha = +alpha || 0;
            this.fillPath = this.$renderNode.beginFill(color, alpha, this.strokePath);
            if (this.$renderNode.drawData.length > 1) {
                this.fillPath.moveTo(this.lastX, this.lastY);
            }
        };
        /**
         * Specifies a gradient fill used by subsequent calls to other Graphics methods (such as lineTo() or drawCircle()) for the object.
         * Calling the clear() method clears the fill.
         * @param type A value from the GradientType class that specifies which gradient type to use: GradientType.LINEAR or GradientType.RADIAL.
         * @param colors An array of RGB hexadecimal color values used in the gradient; for example, red is 0xFF0000, blue is 0x0000FF, and so on. You can specify up to 15 colors. For each color, specify a corresponding value in the alphas and ratios parameters.
         * @param alphas An array of alpha values for the corresponding colors in the colors array;
         * @param ratios An array of color distribution ratios; valid values are 0-255.
         * @param matrix A transformation matrix as defined by the egret.Matrix class. The egret.Matrix class includes a createGradientBox() method, which lets you conveniently set up the matrix for use with the beginGradientFill() method.
         * @platform Web,Native
         * @version Egret 2.4
         * @language en_US
         */
        /**
         * ๆๅฎไธ็งๆธๅๅกซๅ๏ผ็จไบ้ๅ่ฐ็จๅฏน่ฑก็ๅถไป Graphics ๆนๆณ๏ผๅฆ lineTo() ๆ drawCircle()๏ผใ
         * ่ฐ็จ clear() ๆนๆณไผๆธ้คๅกซๅใ
         * @param type ็จไบๆๅฎ่ฆไฝฟ็จๅช็งๆธๅ็ฑปๅ็ GradientType ็ฑป็ๅผ๏ผGradientType.LINEAR ๆ GradientType.RADIALใ
         * @param colors ๆธๅไธญไฝฟ็จ็ RGB ๅๅญ่ฟๅถ้ข่ฒๅผ็ๆฐ็ป๏ผไพๅฆ๏ผ็บข่ฒไธบ 0xFF0000๏ผ่่ฒไธบ 0x0000FF๏ผ็ญ็ญ๏ผใๅฏนไบๆฏ็ง้ข่ฒ๏ผ่ฏทๅจ alphas ๅ ratios ๅๆฐไธญๆๅฎๅฏนๅบๅผใ
         * @param alphas colors ๆฐ็ปไธญๅฏนๅบ้ข่ฒ็ alpha ๅผๆฐ็ปใ
         * @param ratios ้ข่ฒๅๅธๆฏ็็ๆฐ็ปใๆๆๅผไธบ 0 ๅฐ 255ใ
         * @param matrix ไธไธช็ฑ egret.Matrix ็ฑปๅฎไน็่ฝฌๆข็ฉ้ตใegret.Matrix ็ฑปๅๆฌ createGradientBox() ๆนๆณ๏ผ้่ฟ่ฏฅๆนๆณๅฏไปฅๆนไพฟๅฐ่ฎพ็ฝฎ็ฉ้ต๏ผไปฅไพฟไธ beginGradientFill() ๆนๆณไธ่ตทไฝฟ็จ
         * @platform Web,Native
         * @version Egret 2.4
         * @language zh_CN
         */
        Graphics.prototype.beginGradientFill = function (type, colors, alphas, ratios, matrix) {
            if (matrix === void 0) {
                matrix = null;
            }
            this.fillPath = this.$renderNode.beginGradientFill(type, colors, alphas, ratios, matrix, this.strokePath);
            if (this.$renderNode.drawData.length > 1) {
                this.fillPath.moveTo(this.lastX, this.lastY);
            }
        };
        /**
         * Apply fill to the lines and curves added after the previous calling to the beginFill() method.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฏนไปไธไธๆฌก่ฐ็จ beginFill()ๆนๆณไนๅๆทปๅ็็ด็บฟๅๆฒ็บฟๅบ็จๅกซๅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.endFill = function () {
            this.fillPath = null;
        };
        /**
         * Specify a line style that will be used for subsequent calls to Graphics methods such as lineTo() and drawCircle().
         * @param thickness An integer, indicating the thickness of the line in points. Valid values are 0 to 255. If a number is not specified, or if the parameter is undefined, a line is not drawn. If a value less than 0 is passed, the default value is 0. Value 0 indicates hairline thickness; the maximum thickness is 255. If a value greater than 255 is passed, the default value is 255.
         * @param color A hexadecimal color value of the line (for example, red is 0xFF0000, and blue is 0x0000FF, etc.). If no value is specified, the default value is 0x000000 (black). Optional.
         * @param alpha Indicates Alpha value of the line's color. Valid values are 0 to 1. If no value is specified, the default value is 1 (solid). If the value is less than 0, the default value is 0. If the value is greater than 1, the default value is 1.
         * @param pixelHinting A boolean value that specifies whether to hint strokes to full pixels. This affects both the position of anchors of a curve and the line stroke size itself. With pixelHinting set to true, the line width is adjusted to full pixel width. With pixelHinting set to false, disjoints can appear for curves and straight lines.
         * @param scaleMode Specifies the scale mode to be used
         * @param caps Specifies the value of the CapsStyle class of the endpoint type at the end of the line. (default = CapsStyle.ROUND)
         * @param joints Specifies the type of joint appearance of corner.  (default = JointStyle.ROUND)
         * @param miterLimit Indicates the limit number of cut miter.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๅฎไธ็ง็บฟๆกๆทๅผไปฅ็จไบ้ๅๅฏน lineTo() ๆ drawCircle() ็ญ Graphics ๆนๆณ็่ฐ็จใ
         * @param thickness ไธไธชๆดๆฐ๏ผไปฅ็นไธบๅไฝ่กจ็คบ็บฟๆก็็ฒ็ป๏ผๆๆๅผไธบ 0 ๅฐ 255ใๅฆๆๆชๆๅฎๆฐๅญ๏ผๆ่ๆชๅฎไน่ฏฅๅๆฐ๏ผๅไธ็ปๅถ็บฟๆกใๅฆๆไผ้็ๅผๅฐไบ 0๏ผๅ้ป่ฎคๅผไธบ 0ใๅผ 0 ่กจ็คบๆ็ป็็ฒ็ป๏ผๆๅคง็ฒ็ปไธบ 255ใๅฆๆไผ้็ๅผๅคงไบ 255๏ผๅ้ป่ฎคๅผไธบ 255ใ
         * @param color ็บฟๆก็ๅๅญ่ฟๅถ้ข่ฒๅผ๏ผไพๅฆ๏ผ็บข่ฒไธบ 0xFF0000๏ผ่่ฒไธบ 0x0000FF ็ญ๏ผใๅฆๆๆชๆๆๅผ๏ผๅ้ป่ฎคๅผไธบ 0x000000๏ผ้ป่ฒ๏ผใๅฏ้ใ
         * @param alpha ่กจ็คบ็บฟๆก้ข่ฒ็ Alpha ๅผ็ๆฐๅญ๏ผๆๆๅผไธบ 0 ๅฐ 1ใๅฆๆๆชๆๆๅผ๏ผๅ้ป่ฎคๅผไธบ 1๏ผ็บฏ่ฒ๏ผใๅฆๆๅผๅฐไบ 0๏ผๅ้ป่ฎคๅผไธบ 0ใๅฆๆๅผๅคงไบ 1๏ผๅ้ป่ฎคๅผไธบ 1ใ
         * @param pixelHinting ๅธๅฐๅๅผ๏ผๆๅฎๆฏๅฆๆ็คบ็ฌ่งฆ้็จๅฎๆดๅ็ดใๅฎๅๆถๅฝฑๅๆฒ็บฟ้็น็ไฝ็ฝฎไปฅๅ็บฟๆก็ฌ่งฆๅคงๅฐๆฌ่บซใๅจ pixelHinting ่ฎพ็ฝฎไธบ true ็ๆๅตไธ๏ผ็บฟๆกๅฎฝๅบฆไผ่ฐๆดๅฐๅฎๆดๅ็ดๅฎฝๅบฆใๅจ pixelHinting ่ฎพ็ฝฎไธบ false ็ๆๅตไธ๏ผๅฏนไบๆฒ็บฟๅ็ด็บฟๅฏ่ฝไผๅบ็ฐ่ฑ่ใ
         * @param scaleMode ็จไบๆๅฎ่ฆไฝฟ็จ็ๆฏไพๆจกๅผ
         * @param caps ็จไบๆๅฎ็บฟๆกๆซ็ซฏๅค็ซฏ็น็ฑปๅ็ CapsStyle ็ฑป็ๅผใ้ป่ฎคๅผ๏ผCapsStyle.ROUND
         * @param joints ๆๅฎ็จไบๆ่ง็่ฟๆฅๅค่ง็็ฑปๅใ้ป่ฎคๅผ๏ผJointStyle.ROUND
         * @param miterLimit ็จไบ่กจ็คบๅชๅๆๆฅ็ๆ้ๅผ็ๆฐๅญใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.lineStyle = function (thickness, color, alpha, pixelHinting, scaleMode, caps, joints, miterLimit) {
            if (thickness === void 0) {
                thickness = NaN;
            }
            if (color === void 0) {
                color = 0;
            }
            if (alpha === void 0) {
                alpha = 1.0;
            }
            if (pixelHinting === void 0) {
                pixelHinting = false;
            }
            if (scaleMode === void 0) {
                scaleMode = "normal";
            }
            if (caps === void 0) {
                caps = null;
            }
            if (joints === void 0) {
                joints = null;
            }
            if (miterLimit === void 0) {
                miterLimit = 3;
            }
            thickness = +thickness || 0;
            if (thickness <= 0) {
                this.strokePath = null;
                this.setStrokeWidth(0);
            }
            else {
                color = +color || 0;
                alpha = +alpha || 0;
                miterLimit = +miterLimit || 0;
                this.setStrokeWidth(thickness);
                this.strokePath = this.$renderNode.lineStyle(thickness, color, alpha, caps, joints, miterLimit);
                if (this.$renderNode.drawData.length > 1) {
                    this.strokePath.moveTo(this.lastX, this.lastY);
                }
            }
        };
        /**
         * Draw a rectangle
         * @param x x position of the center, relative to the registration point of the parent display object (in pixels).
         * @param y y position of the center, relative to the registration point of the parent display object (in pixels).
         * @param width Width of the rectangle (in pixels).
         * @param height Height of the rectangle (in pixels).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถไธไธช็ฉๅฝข
         * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.drawRect = function (x, y, width, height) {
            x = +x || 0;
            y = +y || 0;
            width = +width || 0;
            height = +height || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.drawRect(x, y, width, height);
            strokePath && strokePath.drawRect(x, y, width, height);
            this.extendBoundsByPoint(x + width, y + height);
            this.updatePosition(x, y);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draw a rectangle with rounded corners.
         * @param x x position of the center, relative to the registration point of the parent display object (in pixels).
         * @param y y position of the center, relative to the registration point of the parent display object (in pixels).
         * @param width Width of the rectangle (in pixels).
         * @param height Height of the rectangle (in pixels).
         * @param ellipseWidth Width used to draw an ellipse with rounded corners (in pixels).
         * @param ellipseHeight Height used to draw an ellipse with rounded corners (in pixels). (Optional) If no value is specified, the default value matches the value of the ellipseWidth parameter.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถไธไธชๅ่ง็ฉๅฝขใ
         * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param ellipseWidth ็จไบ็ปๅถๅ่ง็ๆคญๅ็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param ellipseHeight ็จไบ็ปๅถๅ่ง็ๆคญๅ็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ ๏ผๅฏ้๏ผๅฆๆๆชๆๅฎๅผ๏ผๅ้ป่ฎคๅผไธไธบ ellipseWidth ๅๆฐๆไพ็ๅผ็ธๅน้ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.drawRoundRect = function (x, y, width, height, ellipseWidth, ellipseHeight) {
            x = +x || 0;
            y = +y || 0;
            width = +width || 0;
            height = +height || 0;
            ellipseWidth = +ellipseWidth || 0;
            ellipseHeight = +ellipseHeight || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.drawRoundRect(x, y, width, height, ellipseWidth, ellipseHeight);
            strokePath && strokePath.drawRoundRect(x, y, width, height, ellipseWidth, ellipseHeight);
            var radiusX = (ellipseWidth * 0.5) | 0;
            var radiusY = ellipseHeight ? (ellipseHeight * 0.5) | 0 : radiusX;
            var right = x + width;
            var bottom = y + height;
            var ybw = bottom - radiusY;
            this.extendBoundsByPoint(x, y);
            this.extendBoundsByPoint(right, bottom);
            this.updatePosition(right, ybw);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draw a circle.
         * @param x x position of the center, relative to the registration point of the parent display object (in pixels).
         * @param y y position of the center, relative to the registration point of the parent display object (in pixels).
         * @param r Radius of the circle (in pixels).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถไธไธชๅใ
         * @param x ๅๅฟ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ x ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅๅฟ็ y ไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param radius ๅ็ๅๅพ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.drawCircle = function (x, y, radius) {
            x = +x || 0;
            y = +y || 0;
            radius = +radius || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.drawCircle(x, y, radius);
            strokePath && strokePath.drawCircle(x, y, radius);
            this.extendBoundsByPoint(x - radius, y - radius);
            this.extendBoundsByPoint(x + radius, y + radius);
            this.updatePosition(x + radius, y);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draw an ellipse.
         * @param x A number indicating the horizontal position, relative to the registration point of the parent display object (in pixels).
         * @param y A number indicating the vertical position, relative to the registration point of the parent display object (in pixels).
         * @param width Width of the rectangle (in pixels).
         * @param height Height of the rectangle (in pixels).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถไธไธชๆคญๅใ
         * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param width ็ฉๅฝข็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param height ็ฉๅฝข็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.drawEllipse = function (x, y, width, height) {
            x = +x || 0;
            y = +y || 0;
            width = +width || 0;
            height = +height || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.drawEllipse(x, y, width, height);
            strokePath && strokePath.drawEllipse(x, y, width, height);
            this.extendBoundsByPoint(x, y);
            this.extendBoundsByPoint(x + width, y + height);
            this.updatePosition(x + width, y + height * 0.5);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Move the current drawing position to (x, y). If any of these parameters is missed, calling this method will fail and the current drawing position keeps unchanged.
         * @param x A number indicating the horizontal position, relative to the registration point of the parent display object (in pixels).
         * @param y A number indicating the vertical position, relative to the registration point of the parent display object (in pixels).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅฝๅ็ปๅพไฝ็ฝฎ็งปๅจๅฐ (x, y)ใๅฆๆ็ผบๅฐไปปไฝไธไธชๅๆฐ๏ผๅๆญคๆนๆณๅฐๅคฑ่ดฅ๏ผๅนถไธๅฝๅ็ปๅพไฝ็ฝฎไธๆนๅใ
         * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.moveTo = function (x, y) {
            x = +x || 0;
            y = +y || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.moveTo(x, y);
            strokePath && strokePath.moveTo(x, y);
            this.includeLastPosition = false;
            this.lastX = x;
            this.lastY = y;
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draw a straight line from the current drawing position to (x, y) using the current line style; the current drawing position is then set to (x, y).
         * @param x A number indicating the horizontal position, relative to the registration point of the parent display object (in pixels).
         * @param y A number indicating the vertical position, relative to the registration point of the parent display object (in pixels).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๅฝๅ็บฟๆกๆทๅผ็ปๅถไธๆกไปๅฝๅ็ปๅพไฝ็ฝฎๅผๅงๅฐ (x, y) ็ปๆ็็ด็บฟ๏ผๅฝๅ็ปๅพไฝ็ฝฎ้ๅไผ่ฎพ็ฝฎไธบ (x, y)ใ
         * @param x ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param y ไธไธช่กจ็คบ็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎ็ๆฐๅญ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.lineTo = function (x, y) {
            x = +x || 0;
            y = +y || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.lineTo(x, y);
            strokePath && strokePath.lineTo(x, y);
            this.updatePosition(x, y);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draw a quadratic Bezier curve from the current drawing position to (anchorX, anchorY) using the current line style according to the control points specified by (controlX, controlY). The current drawing position is then set to (anchorX, anchorY).
         * If the curveTo() method is called before the moveTo() method, the default value of the current drawing position is (0, 0). If any of these parameters is missed, calling this method will fail and the current drawing position keeps unchanged.
         * The drawn curve is a quadratic Bezier curve. A quadratic Bezier curve contains two anchor points and one control point. The curve interpolates the two anchor points and bends to the control point.
         * @param controlX A number indicating the horizontal position of the control point, relative to the registration point of the parent display object.
         * @param controlY A number indicating the vertical position of the control point, relative to the registration point of the parent display object.
         * @param anchorX A number indicating the horizontal position of the next anchor point, relative to the registration point of the parent display object.
         * @param anchorY A number indicating the vertical position of the next anchor point, relative to the registration point of the parent display object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๅฝๅ็บฟๆกๆทๅผๅ็ฑ (controlX, controlY) ๆๅฎ็ๆงๅถ็น็ปๅถไธๆกไปๅฝๅ็ปๅพไฝ็ฝฎๅผๅงๅฐ (anchorX, anchorY) ็ปๆ็ไบๆฌก่ดๅกๅฐๆฒ็บฟใๅฝๅ็ปๅพไฝ็ฝฎ้ๅ่ฎพ็ฝฎไธบ (anchorX, anchorY)ใ
         * ๅฆๆๅจ่ฐ็จ moveTo() ๆนๆณไนๅ่ฐ็จไบ curveTo() ๆนๆณ๏ผๅๅฝๅ็ปๅพไฝ็ฝฎ็้ป่ฎคๅผไธบ (0, 0)ใๅฆๆ็ผบๅฐไปปไฝไธไธชๅๆฐ๏ผๅๆญคๆนๆณๅฐๅคฑ่ดฅ๏ผๅนถไธๅฝๅ็ปๅพไฝ็ฝฎไธๆนๅใ
         * ็ปๅถ็ๆฒ็บฟๆฏไบๆฌก่ดๅกๅฐๆฒ็บฟใไบๆฌก่ดๅกๅฐๆฒ็บฟๅๅซไธคไธช้็นๅไธไธชๆงๅถ็นใ่ฏฅๆฒ็บฟๅๆ่ฟไธคไธช้็น๏ผๅนถๅๆงๅถ็นๅผฏๆฒใ
         * @param controlX ไธไธชๆฐๅญ๏ผๆๅฎๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
         * @param controlY ไธไธชๆฐๅญ๏ผๆๅฎๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
         * @param anchorX ไธไธชๆฐๅญ๏ผๆๅฎไธไธไธช้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
         * @param anchorY ไธไธชๆฐๅญ๏ผๆๅฎไธไธไธช้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑกๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.curveTo = function (controlX, controlY, anchorX, anchorY) {
            controlX = +controlX || 0;
            controlY = +controlY || 0;
            anchorX = +anchorX || 0;
            anchorY = +anchorY || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.curveTo(controlX, controlY, anchorX, anchorY);
            strokePath && strokePath.curveTo(controlX, controlY, anchorX, anchorY);
            this.extendBoundsByPoint(controlX, controlY);
            this.extendBoundsByPoint(anchorX, anchorY);
            this.updatePosition(anchorX, anchorY);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * Draws a cubic Bezier curve from the current drawing position to the specified anchor. Cubic Bezier curves consist of two anchor points and two control points. The curve interpolates the two anchor points and two control points to the curve.
         * @param controlX1 Specifies the first control point relative to the registration point of the parent display the horizontal position of the object.
         * @param controlY1 Specifies the first control point relative to the registration point of the parent display the vertical position of the object.
         * @param controlX2 Specify the second control point relative to the registration point of the parent display the horizontal position of the object.
         * @param controlY2 Specify the second control point relative to the registration point of the parent display the vertical position of the object.
         * @param anchorX Specifies the anchor point relative to the registration point of the parent display the horizontal position of the object.
         * @param anchorY Specifies the anchor point relative to the registration point of the parent display the vertical position of the object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฝๅ็ปๅพไฝ็ฝฎๅฐๆๅฎ็้็น็ปๅถไธๆกไธๆฌก่ดๅกๅฐๆฒ็บฟใไธๆฌก่ดๅกๅฐๆฒ็บฟ็ฑไธคไธช้็นๅไธคไธชๆงๅถ็น็ปๆใ่ฏฅๆฒ็บฟๅๆ่ฟไธคไธช้็น๏ผๅนถๅไธคไธชๆงๅถ็นๅผฏๆฒใ
         * @param controlX1 ๆๅฎ้ฆไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
         * @param controlY1 ๆๅฎ้ฆไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
         * @param controlX2 ๆๅฎ็ฌฌไบไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
         * @param controlY2 ๆๅฎ็ฌฌไบไธชๆงๅถ็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
         * @param anchorX ๆๅฎ้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๆฐดๅนณไฝ็ฝฎใ
         * @param anchorY ๆๅฎ้็น็ธๅฏนไบ็ถๆพ็คบๅฏน่ฑก็ๆณจๅ็น็ๅ็ดไฝ็ฝฎใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.cubicCurveTo = function (controlX1, controlY1, controlX2, controlY2, anchorX, anchorY) {
            controlX1 = +controlX1 || 0;
            controlY1 = +controlY1 || 0;
            controlX2 = +controlX2 || 0;
            controlY2 = +controlY2 || 0;
            anchorX = +anchorX || 0;
            anchorY = +anchorY || 0;
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            fillPath && fillPath.cubicCurveTo(controlX1, controlY1, controlX2, controlY2, anchorX, anchorY);
            strokePath && strokePath.cubicCurveTo(controlX1, controlY1, controlX2, controlY2, anchorX, anchorY);
            this.extendBoundsByPoint(controlX1, controlY1);
            this.extendBoundsByPoint(controlX2, controlY2);
            this.extendBoundsByPoint(anchorX, anchorY);
            this.updatePosition(anchorX, anchorY);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * adds an arc to the path which is centered at (x, y) position with radius r starting at startAngle and ending
         * at endAngle going in the given direction by anticlockwise (defaulting to clockwise).
         * @param x The x coordinate of the arc's center.
         * @param y The y coordinate of the arc's center.
         * @param radius The arc's radius.
         * @param startAngle The angle at which the arc starts, measured clockwise from the positive x axis and expressed in radians.
         * @param endAngle The angle at which the arc ends, measured clockwise from the positive x axis and expressed in radians.
         * @param anticlockwise if true, causes the arc to be drawn counter-clockwise between the two angles. By default it is drawn clockwise.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถไธๆฎตๅๅผง่ทฏๅพใๅๅผง่ทฏๅพ็ๅๅฟๅจ (x, y) ไฝ็ฝฎ๏ผๅๅพไธบ r ๏ผๆนๆฎanticlockwise ๏ผ้ป่ฎคไธบ้กบๆถ้๏ผๆๅฎ็ๆนๅไป startAngle ๅผๅง็ปๅถ๏ผๅฐ endAngle ็ปๆใ
         * @param x ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ x ่ฝดๅๆใ
         * @param y ๅๅผงไธญๅฟ๏ผๅๅฟ๏ผ็ y ่ฝดๅๆใ
         * @param radius ๅๅผง็ๅๅพใ
         * @param startAngle ๅๅผง็่ตทๅง็น๏ผ x่ฝดๆนๅๅผๅง่ฎก็ฎ๏ผๅไฝไปฅๅผงๅบฆ่กจ็คบใ
         * @param endAngle ๅๅผง็็ป็น๏ผ ๅไฝไปฅๅผงๅบฆ่กจ็คบใ
         * @param anticlockwise ๅฆๆไธบ true๏ผ้ๆถ้็ปๅถๅๅผง๏ผๅไน๏ผ้กบๆถ้็ปๅถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.drawArc = function (x, y, radius, startAngle, endAngle, anticlockwise) {
            if (radius < 0 || startAngle === endAngle) {
                return;
            }
            x = +x || 0;
            y = +y || 0;
            radius = +radius || 0;
            startAngle = +startAngle || 0;
            endAngle = +endAngle || 0;
            anticlockwise = !!anticlockwise;
            startAngle = clampAngle(startAngle);
            endAngle = clampAngle(endAngle);
            var fillPath = this.fillPath;
            var strokePath = this.strokePath;
            if (fillPath) {
                fillPath.$lastX = this.lastX;
                fillPath.$lastY = this.lastY;
                fillPath.drawArc(x, y, radius, startAngle, endAngle, anticlockwise);
            }
            if (strokePath) {
                strokePath.$lastX = this.lastX;
                strokePath.$lastY = this.lastY;
                strokePath.drawArc(x, y, radius, startAngle, endAngle, anticlockwise);
            }
            if (anticlockwise) {
                this.arcBounds(x, y, radius, endAngle, startAngle);
            }
            else {
                this.arcBounds(x, y, radius, startAngle, endAngle);
            }
            var endX = x + Math.cos(endAngle) * radius;
            var endY = y + Math.sin(endAngle) * radius;
            this.updatePosition(endX, endY);
            this.$renderNode.dirtyRender = true;
        };
        /**
         * @private
         * ๆต้ๅๅผง็็ฉๅฝขๅคงๅฐ
         */
        Graphics.prototype.arcBounds = function (x, y, radius, startAngle, endAngle) {
            var PI = Math.PI;
            if (Math.abs(startAngle - endAngle) < 0.01) {
                this.extendBoundsByPoint(x - radius, y - radius);
                this.extendBoundsByPoint(x + radius, y + radius);
                return;
            }
            if (startAngle > endAngle) {
                endAngle += PI * 2;
            }
            var startX = Math.cos(startAngle) * radius;
            var endX = Math.cos(endAngle) * radius;
            var xMin = Math.min(startX, endX);
            var xMax = Math.max(startX, endX);
            var startY = Math.sin(startAngle) * radius;
            var endY = Math.sin(endAngle) * radius;
            var yMin = Math.min(startY, endY);
            var yMax = Math.max(startY, endY);
            var startRange = startAngle / (PI * 0.5);
            var endRange = endAngle / (PI * 0.5);
            for (var i = Math.ceil(startRange); i <= endRange; i++) {
                switch (i % 4) {
                    case 0:
                        xMax = radius;
                        break;
                    case 1:
                        yMax = radius;
                        break;
                    case 2:
                        xMin = -radius;
                        break;
                    case 3:
                        yMin = -radius;
                        break;
                }
            }
            xMin = Math.floor(xMin);
            yMin = Math.floor(yMin);
            xMax = Math.ceil(xMax);
            yMax = Math.ceil(yMax);
            this.extendBoundsByPoint(xMin + x, yMin + y);
            this.extendBoundsByPoint(xMax + x, yMax + y);
        };
        /**
         * Clear graphics that are drawn to this Graphics object, and reset fill and line style settings.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆธ้ค็ปๅถๅฐๆญค Graphics ๅฏน่ฑก็ๅพๅฝข๏ผๅนถ้็ฝฎๅกซๅๅ็บฟๆกๆทๅผ่ฎพ็ฝฎใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Graphics.prototype.clear = function () {
            this.$renderNode.clear();
            this.updatePosition(0, 0);
            this.minX = Infinity;
            this.minY = Infinity;
            this.maxX = -Infinity;
            this.maxY = -Infinity;
        };
        /**
         * @private
         */
        Graphics.prototype.extendBoundsByPoint = function (x, y) {
            this.extendBoundsByX(x);
            this.extendBoundsByY(y);
        };
        /**
         * @private
         */
        Graphics.prototype.extendBoundsByX = function (x) {
            this.minX = Math.min(this.minX, x - this.topLeftStrokeWidth);
            this.maxX = Math.max(this.maxX, x + this.bottomRightStrokeWidth);
            this.updateNodeBounds();
        };
        /**
         * @private
         */
        Graphics.prototype.extendBoundsByY = function (y) {
            this.minY = Math.min(this.minY, y - this.topLeftStrokeWidth);
            this.maxY = Math.max(this.maxY, y + this.bottomRightStrokeWidth);
            this.updateNodeBounds();
        };
        /**
         * @private
         */
        Graphics.prototype.updateNodeBounds = function () {
            var node = this.$renderNode;
            node.x = this.minX;
            node.y = this.minY;
            node.width = Math.ceil(this.maxX - this.minX);
            node.height = Math.ceil(this.maxY - this.minY);
        };
        /**
         * ๆดๆฐๅฝๅ็lineXๅlineYๅผ๏ผๅนถๆ่ฎฐๅฐบๅฏธๅคฑๆใ
         * @private
         */
        Graphics.prototype.updatePosition = function (x, y) {
            if (!this.includeLastPosition) {
                this.extendBoundsByPoint(this.lastX, this.lastY);
                this.includeLastPosition = true;
            }
            this.lastX = x;
            this.lastY = y;
            this.extendBoundsByPoint(x, y);
            this.targetDisplay.$invalidateContentBounds();
        };
        /**
         * @private
         */
        Graphics.prototype.$measureContentBounds = function (bounds) {
            if (this.minX === Infinity) {
                bounds.setEmpty();
            }
            else {
                bounds.setTo(this.minX, this.minY, this.maxX - this.minX, this.maxY - this.minY);
            }
        };
        /**
         * @private
         *
         */
        Graphics.prototype.$hitTest = function (stageX, stageY) {
            var target = this.targetDisplay;
            var m = target.$getInvertedConcatenatedMatrix();
            var localX = m.a * stageX + m.c * stageY + m.tx;
            var localY = m.b * stageX + m.d * stageY + m.ty;
            var buffer = egret.sys.canvasHitTestBuffer;
            buffer.resize(3, 3);
            var node = this.$renderNode;
            var matrix = egret.Matrix.create();
            matrix.identity();
            matrix.translate(1 - localX, 1 - localY);
            egret.sys.canvasRenderer.drawNodeToBuffer(node, buffer, matrix, true);
            egret.Matrix.release(matrix);
            try {
                var data = buffer.getPixels(1, 1);
                if (data[3] === 0) {
                    return null;
                }
            }
            catch (e) {
                throw new Error(egret.sys.tr(1039));
            }
            return target;
        };
        /**
         * @private
         */
        Graphics.prototype.$onRemoveFromStage = function () {
            if (this.$renderNode) {
                this.$renderNode.clean();
            }
        };
        return Graphics;
    }(egret.HashObject));
    egret.Graphics = Graphics;
    __reflect(Graphics.prototype, "egret.Graphics");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var PI = Math.PI;
    var TwoPI = PI * 2;
    var DEG_TO_RAD = PI / 180;
    var matrixPool = [];
    /**
     * The Matrix class represents a transformation matrix that determines how to map points from one coordinate space to
     * another. You can perform various graphical transformations on a display object by setting the properties of a Matrix
     * object, applying that Matrix object to the matrix property of a display object, These transformation functions include
     * translation (x and y repositioning), rotation, scaling, and skewing.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Matrix.ts
     * @language en_US
     */
    /**
     * Matrix ็ฑป่กจ็คบไธไธช่ฝฌๆข็ฉ้ต๏ผๅฎ็กฎๅฎๅฆไฝๅฐ็นไปไธไธชๅๆ็ฉบ้ดๆๅฐๅฐๅฆไธไธชๅๆ็ฉบ้ดใ
     * ๆจๅฏไปฅๅฏนไธไธชๆพ็คบๅฏน่ฑกๆง่กไธๅ็ๅพๅฝข่ฝฌๆข๏ผๆนๆณๆฏ่ฎพ็ฝฎ Matrix ๅฏน่ฑก็ๅฑๆง๏ผๅฐ่ฏฅ Matrix
     * ๅฏน่ฑกๅบ็จไบๆพ็คบๅฏน่ฑก็ matrix ๅฑๆงใ่ฟไบ่ฝฌๆขๅฝๆฐๅๆฌๅนณ็งป๏ผx ๅ y ้ๆฐๅฎไฝ๏ผใๆ่ฝฌใ็ผฉๆพๅๅพๆใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/geom/Matrix.ts
     * @language zh_CN
     */
    var Matrix = (function (_super) {
        __extends(Matrix, _super);
        /**
         * Creates a new Matrix object with the specified parameters.
         * @param a The value that affects the positioning of pixels along the x axis when scaling or rotating an image.
         * @param b The value that affects the positioning of pixels along the y axis when rotating or skewing an image.
         * @param c The value that affects the positioning of pixels along the x axis when rotating or skewing an image.
         * @param d The value that affects the positioning of pixels along the y axis when scaling or rotating an image..
         * @param tx The distance by which to translate each point along the x axis.
         * @param ty The distance by which to translate each point along the y axis.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎๅๆฐๅๅปบไธไธช Matrix ๅฏน่ฑก
         * @param a ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผใ
         * @param b ๆ่ฝฌๆๅพๆๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผใ
         * @param c ๆ่ฝฌๆๅพๆๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผใ
         * @param d ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผใ
         * @param tx ๆฒฟ x ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆปใ
         * @param ty ๆฒฟ y ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆปใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Matrix(a, b, c, d, tx, ty) {
            if (a === void 0) {
                a = 1;
            }
            if (b === void 0) {
                b = 0;
            }
            if (c === void 0) {
                c = 0;
            }
            if (d === void 0) {
                d = 1;
            }
            if (tx === void 0) {
                tx = 0;
            }
            if (ty === void 0) {
                ty = 0;
            }
            var _this = _super.call(this) || this;
            _this.a = a;
            _this.b = b;
            _this.c = c;
            _this.d = d;
            _this.tx = tx;
            _this.ty = ty;
            return _this;
        }
        /**
         * Releases a matrix instance to the object pool
         * @param matrix matrix that Needs to be recycled
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๆพไธไธชMatrixๅฎไพๅฐๅฏน่ฑกๆฑ
         * @param matrix ้่ฆๅๆถ็ matrix
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.release = function (matrix) {
            if (!matrix) {
                return;
            }
            matrixPool.push(matrix);
        };
        /**
         * get a matrix instance from the object pool or create a new one.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฏน่ฑกๆฑไธญๅๅบๆๅๅปบไธไธชๆฐ็Matrixๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.create = function () {
            var matrix = matrixPool.pop();
            if (!matrix) {
                matrix = new Matrix();
            }
            return matrix;
        };
        /**
         * Returns a new Matrix object that is a clone of this matrix, with an exact copy of the contained object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅไธไธชๆฐ็ Matrix ๅฏน่ฑก๏ผๅฎๆฏๆญค็ฉ้ต็ๅ้๏ผๅธฆๆไธๆๅซๅฏน่ฑกๅฎๅจ็ธๅ็ๅฏๆฌใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.clone = function () {
            return new Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty);
        };
        /**
         * Concatenates a matrix with the current matrix, effectively combining the geometric effects of the two. In mathematical
         * terms, concatenating two matrixes is the same as combining them using matrix multiplication.
         * @param other The matrix to be concatenated to the source matrix.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆไธช็ฉ้ตไธๅฝๅ็ฉ้ต่ฟๆฅ๏ผไป่ๅฐ่ฟไธคไธช็ฉ้ต็ๅไฝๆๆๆๆๅฐ็ปๅๅจไธ่ตทใๅจๆฐๅญฆๆฏ่ฏญไธญ๏ผๅฐไธคไธช็ฉ้ต่ฟๆฅ่ตทๆฅไธไฝฟ็จ็ฉ้ตไนๆณๅฐๅฎไปฌ็ปๅ่ตทๆฅๆฏ็ธๅ็ใ
         * @param other ่ฆ่ฟๆฅๅฐๆบ็ฉ้ต็็ฉ้ตใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.concat = function (other) {
            var a = this.a * other.a;
            var b = 0.0;
            var c = 0.0;
            var d = this.d * other.d;
            var tx = this.tx * other.a + other.tx;
            var ty = this.ty * other.d + other.ty;
            if (this.b !== 0.0 || this.c !== 0.0 || other.b !== 0.0 || other.c !== 0.0) {
                a += this.b * other.c;
                d += this.c * other.b;
                b += this.a * other.b + this.b * other.d;
                c += this.c * other.a + this.d * other.c;
                tx += this.ty * other.c;
                ty += this.tx * other.b;
            }
            this.a = a;
            this.b = b;
            this.c = c;
            this.d = d;
            this.tx = tx;
            this.ty = ty;
        };
        /**
         * Copies all of the matrix data from the source Point object into the calling Matrix object.
         * @param other  The Matrix object from which to copy the data.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆบ Matrix ๅฏน่ฑกไธญ็ๆๆ็ฉ้ตๆฐๆฎๅคๅถๅฐ่ฐ็จๆน Matrix ๅฏน่ฑกไธญใ
         * @param other ่ฆๆท่ด็็ฎๆ็ฉ้ต
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.copyFrom = function (other) {
            this.a = other.a;
            this.b = other.b;
            this.c = other.c;
            this.d = other.d;
            this.tx = other.tx;
            this.ty = other.ty;
            return this;
        };
        /**
         * Sets each matrix property to a value that causes a null transformation. An object transformed by applying an
         * identity matrix will be identical to the original. After calling the identity() method, the resulting matrix
         * has the following properties: a=1, b=0, c=0, d=1, tx=0, ty=0.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธบๆฏไธช็ฉ้ตๅฑๆง่ฎพ็ฝฎไธไธชๅผ๏ผ่ฏฅๅผๅฐๅฏผ่ด็ฉ้ตๆ่ฝฌๆขใ้่ฟๅบ็จๆ็ญ็ฉ้ต่ฝฌๆข็ๅฏน่ฑกๅฐไธๅๅงๅฏน่ฑกๅฎๅจ็ธๅใ
         * ่ฐ็จ identity() ๆนๆณๅ๏ผ็ๆ็็ฉ้ตๅทๆไปฅไธๅฑๆง๏ผa=1ใb=0ใc=0ใd=1ใtx=0 ๅ ty=0ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.identity = function () {
            this.a = this.d = 1;
            this.b = this.c = this.tx = this.ty = 0;
        };
        /**
         * Performs the opposite transformation of the original matrix. You can apply an inverted matrix to an object to
         * undo the transformation performed when applying the original matrix.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆง่กๅๅง็ฉ้ต็้่ฝฌๆขใ
         * ๆจๅฏไปฅๅฐไธไธช้็ฉ้ตๅบ็จไบๅฏน่ฑกๆฅๆคๆถๅจๅบ็จๅๅง็ฉ้ตๆถๆง่ก็่ฝฌๆขใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.invert = function () {
            this.$invertInto(this);
        };
        /**
         * @private
         */
        Matrix.prototype.$invertInto = function (target) {
            var a = this.a;
            var b = this.b;
            var c = this.c;
            var d = this.d;
            var tx = this.tx;
            var ty = this.ty;
            if (b == 0 && c == 0) {
                target.b = target.c = 0;
                if (a == 0 || d == 0) {
                    target.a = target.d = target.tx = target.ty = 0;
                }
                else {
                    a = target.a = 1 / a;
                    d = target.d = 1 / d;
                    target.tx = -a * tx;
                    target.ty = -d * ty;
                }
                return;
            }
            var determinant = a * d - b * c;
            if (determinant == 0) {
                target.identity();
                return;
            }
            determinant = 1 / determinant;
            var k = target.a = d * determinant;
            b = target.b = -b * determinant;
            c = target.c = -c * determinant;
            d = target.d = a * determinant;
            target.tx = -(k * tx + c * ty);
            target.ty = -(b * tx + d * ty);
        };
        /**
         * Applies a rotation transformation to the Matrix object.
         * The rotate() method alters the a, b, c, and d properties of the Matrix object.
         * @param angle The rotation angle in radians.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฏน Matrix ๅฏน่ฑกๅบ็จๆ่ฝฌ่ฝฌๆขใ
         * rotate() ๆนๆณๅฐๆดๆน Matrix ๅฏน่ฑก็ aใbใc ๅ d ๅฑๆงใ
         * @param angle ไปฅๅผงๅบฆไธบๅไฝ็ๆ่ฝฌ่งๅบฆใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.rotate = function (angle) {
            angle = +angle;
            if (angle !== 0) {
                angle = angle / DEG_TO_RAD;
                var u = egret.NumberUtils.cos(angle);
                var v = egret.NumberUtils.sin(angle);
                var ta = this.a;
                var tb = this.b;
                var tc = this.c;
                var td = this.d;
                var ttx = this.tx;
                var tty = this.ty;
                this.a = ta * u - tb * v;
                this.b = ta * v + tb * u;
                this.c = tc * u - td * v;
                this.d = tc * v + td * u;
                this.tx = ttx * u - tty * v;
                this.ty = ttx * v + tty * u;
            }
        };
        /**
         * Applies a scaling transformation to the matrix. The x axis is multiplied by sx, and the y axis it is multiplied by sy.
         * The scale() method alters the a and d properties of the Matrix object.
         * @param sx A multiplier used to scale the object along the x axis.
         * @param sy A multiplier used to scale the object along the y axis.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฏน็ฉ้ตๅบ็จ็ผฉๆพ่ฝฌๆขใx ่ฝดไนไปฅ sx๏ผy ่ฝดไนไปฅ syใ
         * scale() ๆนๆณๅฐๆดๆน Matrix ๅฏน่ฑก็ a ๅ d ๅฑๆงใ
         * @param sx ็จไบๆฒฟ x ่ฝด็ผฉๆพๅฏน่ฑก็ไนๆฐใ
         * @param sy ็จไบๆฒฟ y ่ฝด็ผฉๆพๅฏน่ฑก็ไนๆฐใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.scale = function (sx, sy) {
            if (sx !== 1) {
                this.a *= sx;
                this.c *= sx;
                this.tx *= sx;
            }
            if (sy !== 1) {
                this.b *= sy;
                this.d *= sy;
                this.ty *= sy;
            }
        };
        /**
         * Sets the members of Matrix to the specified values
         * @param a The value that affects the positioning of pixels along the x axis when scaling or rotating an image.
         * @param b The value that affects the positioning of pixels along the y axis when rotating or skewing an image.
         * @param c The value that affects the positioning of pixels along the x axis when rotating or skewing an image.
         * @param d The value that affects the positioning of pixels along the y axis when scaling or rotating an image..
         * @param tx The distance by which to translate each point along the x axis.
         * @param ty The distance by which to translate each point along the y axis.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ Matrix ็ๆๅ่ฎพ็ฝฎไธบๆๅฎๅผ
         * @param a ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผใ
         * @param b ๆ่ฝฌๆๅพๆๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผใ
         * @param c ๆ่ฝฌๆๅพๆๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผใ
         * @param d ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผใ
         * @param tx ๆฒฟ x ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆปใ
         * @param ty ๆฒฟ y ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆปใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.setTo = function (a, b, c, d, tx, ty) {
            this.a = a;
            this.b = b;
            this.c = c;
            this.d = d;
            this.tx = tx;
            this.ty = ty;
            return this;
        };
        /**
         * Returns the result of applying the geometric transformation represented by the Matrix object to the specified point.
         * @param pointX The x coordinate for which you want to get the result of the Matrix transformation.
         * @param pointY The y coordinate for which you want to get the result of the Matrix transformation.
         * @param resultPoint A reusable instance of Point for saving the results. Passing this parameter can reduce the
         * number of reallocate objects, which allows you to get better code execution performance.
         * @returns The point resulting from applying the Matrix transformation.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๅฐ Matrix ๅฏน่ฑก่กจ็คบ็ๅไฝ่ฝฌๆขๅบ็จไบๆๅฎ็นๆไบง็็็ปๆใ
         * @param pointX ๆณ่ฆ่ทๅพๅถ็ฉ้ต่ฝฌๆข็ปๆ็็น็xๅๆใ
         * @param pointY ๆณ่ฆ่ทๅพๅถ็ฉ้ต่ฝฌๆข็ปๆ็็น็yๅๆใ
         * @param resultPoint ๆกๆถๅปบ่ฎฎๅฐฝๅฏ่ฝๅๅฐๅๅปบๅฏน่ฑกๆฌกๆฐๆฅไผๅๆง่ฝ๏ผๅฏไปฅไปๅค้จไผๅฅไธไธชๅค็จ็Pointๅฏน่ฑกๆฅๅญๅจ็ปๆ๏ผ่ฅไธไผๅฅๅฐๅๅปบไธไธชๆฐ็Pointๅฏน่ฑก่ฟๅใ
         * @returns ็ฑๅบ็จ็ฉ้ต่ฝฌๆขๆไบง็็็นใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.transformPoint = function (pointX, pointY, resultPoint) {
            var x = this.a * pointX + this.c * pointY + this.tx;
            var y = this.b * pointX + this.d * pointY + this.ty;
            if (resultPoint) {
                resultPoint.setTo(x, y);
                return resultPoint;
            }
            return new egret.Point(x, y);
        };
        /**
         * Translates the matrix along the x and y axes, as specified by the dx and dy parameters.
         * @param dx The amount of movement along the x axis to the right, in pixels.
         * @param dy The amount of movement down along the y axis, in pixels.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฒฟ x ๅ y ่ฝดๅนณ็งป็ฉ้ต๏ผ็ฑ dx ๅ dy ๅๆฐๆๅฎใ
         * @param dx ๆฒฟ x ่ฝดๅๅณ็งปๅจ็้๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param dy ๆฒฟ y ่ฝดๅไธ็งปๅจ็้๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.translate = function (dx, dy) {
            this.tx += dx;
            this.ty += dy;
        };
        /**
         * Determines whether two matrixes are equal.
         * @param other The matrix to be compared.
         * @returns A value of true if the object is equal to this Matrix object; false if it is not equal.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฏๅฆไธๅฆไธไธช็ฉ้ตๆฐๆฎ็ธ็ญ
         * @param other ่ฆๆฏ่พ็ๅฆไธไธช็ฉ้ตๅฏน่ฑกใ
         * @returns ๆฏๅฆ็ธ็ญ๏ผture่กจ็คบ็ธ็ญใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.equals = function (other) {
            return this.a == other.a && this.b == other.b &&
                this.c == other.c && this.d == other.d &&
                this.tx == other.tx && this.ty == other.ty;
        };
        /**
         * prepend matrix
         * @param a The value that affects the positioning of pixels along the x axis when scaling or rotating an image.
         * @param b The value that affects the positioning of pixels along the y axis when rotating or skewing an image.
         * @param c The value that affects the positioning of pixels along the x axis when rotating or skewing an image.
         * @param d The value that affects the positioning of pixels along the y axis when scaling or rotating an image..
         * @param tx The distance by which to translate each point along the x axis.
         * @param ty The distance by which to translate each point along the y axis.
         * @returns matrix
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ็ฝฎ็ฉ้ต
         * @param a ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผ
         * @param b ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผ
         * @param c ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผ
         * @param d ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผ
         * @param tx ๆฒฟ x ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆป
         * @param ty ๆฒฟ y ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆป
         * @returns ็ฉ้ต่ช่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.prepend = function (a, b, c, d, tx, ty) {
            var tx1 = this.tx;
            if (a != 1 || b != 0 || c != 0 || d != 1) {
                var a1 = this.a;
                var c1 = this.c;
                this.a = a1 * a + this.b * c;
                this.b = a1 * b + this.b * d;
                this.c = c1 * a + this.d * c;
                this.d = c1 * b + this.d * d;
            }
            this.tx = tx1 * a + this.ty * c + tx;
            this.ty = tx1 * b + this.ty * d + ty;
            return this;
        };
        /**
         * append matrix
         * @param a The value that affects the positioning of pixels along the x axis when scaling or rotating an image.
         * @param b The value that affects the positioning of pixels along the y axis when rotating or skewing an image.
         * @param c The value that affects the positioning of pixels along the x axis when rotating or skewing an image.
         * @param d The value that affects the positioning of pixels along the y axis when scaling or rotating an image..
         * @param tx The distance by which to translate each point along the x axis.
         * @param ty The distance by which to translate each point along the y axis.
         * @returns matrix
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ็ฝฎ็ฉ้ต
         * @param a ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผ
         * @param b ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผ
         * @param c ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ x ่ฝดๅฎไฝ็ๅผ
         * @param d ็ผฉๆพๆๆ่ฝฌๅพๅๆถๅฝฑๅๅ็ดๆฒฟ y ่ฝดๅฎไฝ็ๅผ
         * @param tx ๆฒฟ x ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆป
         * @param ty ๆฒฟ y ่ฝดๅนณ็งปๆฏไธช็น็่ท็ฆป
         * @returns ็ฉ้ต่ช่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.append = function (a, b, c, d, tx, ty) {
            var a1 = this.a;
            var b1 = this.b;
            var c1 = this.c;
            var d1 = this.d;
            if (a != 1 || b != 0 || c != 0 || d != 1) {
                this.a = a * a1 + b * c1;
                this.b = a * b1 + b * d1;
                this.c = c * a1 + d * c1;
                this.d = c * b1 + d * d1;
            }
            this.tx = tx * a1 + ty * c1 + this.tx;
            this.ty = tx * b1 + ty * d1 + this.ty;
            return this;
        };
        /**
         * Given a point in the pretransform coordinate space, returns the coordinates of that point after the transformation occurs.
         * Unlike the standard transformation applied using the transformPoint() method, the deltaTransformPoint() method's transformation does not consider the translation parameters tx and ty.
         * @param point The point for which you want to get the result of the matrix transformation.
         * @returns The point resulting from applying the matrix transformation.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆ็ปๅฎ้ข่ฝฌๆขๅๆ็ฉบ้ดไธญ็็น๏ผๅๆญคๆนๆณ่ฟๅๅ็่ฝฌๆขๅ่ฏฅ็น็ๅๆใ
         * ไธไฝฟ็จ transformPoint() ๆนๆณๅบ็จ็ๆๅ่ฝฌๆขไธๅ๏ผdeltaTransformPoint() ๆนๆณ็่ฝฌๆขไธ่่่ฝฌๆขๅๆฐ tx ๅ tyใ
         * @param point ๆณ่ฆ่ทๅพๅถ็ฉ้ต่ฝฌๆข็ปๆ็็น
         * @returns ็ฑๅบ็จ็ฉ้ต่ฝฌๆขๆไบง็็็น
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.deltaTransformPoint = function (point) {
            var self = this;
            var x = self.a * point.x + self.c * point.y;
            var y = self.b * point.x + self.d * point.y;
            return new egret.Point(x, y);
        };
        /**
         * Returns a text value listing the properties of the Matrix object.
         * @returns A string containing the values of the properties of the Matrix object: a, b, c, d, tx, and ty.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๅฐ Matrix ๅฏน่ฑก่กจ็คบ็ๅไฝ่ฝฌๆขๅบ็จไบๆๅฎ็นๆไบง็็็ปๆใ
         * @returns ไธไธชๅญ็ฌฆไธฒ๏ผๅฎๅๅซ Matrix ๅฏน่ฑก็ๅฑๆงๅผ๏ผaใbใcใdใtx ๅ tyใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.toString = function () {
            return "(a=" + this.a + ", b=" + this.b + ", c=" + this.c + ", d=" + this.d + ", tx=" + this.tx + ", ty=" + this.ty + ")";
        };
        /**
         * Includes parameters for scaling, rotation, and translation. When applied to a matrix it sets the matrix's values based on those parameters.
         * @param scaleX The factor by which to scale horizontally.
         * @param scaleY The factor by which scale vertically.
         * @param rotation The amount to rotate, in radians.
         * @param tx The number of pixels to translate (move) to the right along the x axis.
         * @param ty The number of pixels to translate (move) down along the y axis.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๆฌ็จไบ็ผฉๆพใๆ่ฝฌๅ่ฝฌๆข็ๅๆฐใๅฝๅบ็จไบ็ฉ้ตๆถ๏ผ่ฏฅๆนๆณไผๅบไบ่ฟไบๅๆฐ่ฎพ็ฝฎ็ฉ้ต็ๅผใ
         * @param scaleX ๆฐดๅนณ็ผฉๆพๆ็จ็็ณปๆฐ
         * @param scaleY ๅ็ด็ผฉๆพๆ็จ็็ณปๆฐ
         * @param rotation ๆ่ฝฌ้๏ผไปฅๅผงๅบฆไธบๅไฝ๏ผ
         * @param tx ๆฒฟ x ่ฝดๅๅณๅนณ็งป๏ผ็งปๅจ๏ผ็ๅ็ดๆฐ
         * @param ty ๆฒฟ y ่ฝดๅไธๅนณ็งป๏ผ็งปๅจ๏ผ็ๅ็ดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.createBox = function (scaleX, scaleY, rotation, tx, ty) {
            if (rotation === void 0) {
                rotation = 0;
            }
            if (tx === void 0) {
                tx = 0;
            }
            if (ty === void 0) {
                ty = 0;
            }
            var self = this;
            if (rotation !== 0) {
                rotation = rotation / DEG_TO_RAD;
                var u = egret.NumberUtils.cos(rotation);
                var v = egret.NumberUtils.sin(rotation);
                self.a = u * scaleX;
                self.b = v * scaleY;
                self.c = -v * scaleX;
                self.d = u * scaleY;
            }
            else {
                self.a = scaleX;
                self.b = 0;
                self.c = 0;
                self.d = scaleY;
            }
            self.tx = tx;
            self.ty = ty;
        };
        /**
         * Creates the specific style of matrix expected by the beginGradientFill() and lineGradientStyle() methods of the Graphics class.
         * Width and height are scaled to a scaleX/scaleY pair and the tx/ty values are offset by half the width and height.
         * @param width The width of the gradient box.
         * @param height The height of the gradient box.
         * @param rotation The amount to rotate, in radians.
         * @param tx The distance, in pixels, to translate to the right along the x axis. This value is offset by half of the width parameter.
         * @param ty The distance, in pixels, to translate down along the y axis. This value is offset by half of the height parameter.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบ Graphics ็ฑป็ beginGradientFill() ๅ lineGradientStyle() ๆนๆณๆ้็็ฉ้ต็็นๅฎๆทๅผใ
         * ๅฎฝๅบฆๅ้ซๅบฆ่ขซ็ผฉๆพไธบ scaleX/scaleY ๅฏน๏ผ่ tx/ty ๅผๅ็งปไบๅฎฝๅบฆๅ้ซๅบฆ็ไธๅใ
         * @param width ๆธๅๆก็ๅฎฝๅบฆ
         * @param height ๆธๅๆก็้ซๅบฆ
         * @param rotation ๆ่ฝฌ้๏ผไปฅๅผงๅบฆไธบๅไฝ๏ผ
         * @param tx ๆฒฟ x ่ฝดๅๅณๅนณ็งป็่ท็ฆป๏ผไปฅๅ็ดไธบๅไฝ๏ผใๆญคๅผๅฐๅ็งป width ๅๆฐ็ไธๅ
         * @param ty ๆฒฟ y ่ฝดๅไธๅนณ็งป็่ท็ฆป๏ผไปฅๅ็ดไธบๅไฝ๏ผใๆญคๅผๅฐๅ็งป height ๅๆฐ็ไธๅ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Matrix.prototype.createGradientBox = function (width, height, rotation, tx, ty) {
            if (rotation === void 0) {
                rotation = 0;
            }
            if (tx === void 0) {
                tx = 0;
            }
            if (ty === void 0) {
                ty = 0;
            }
            this.createBox(width / 1638.4, height / 1638.4, rotation, tx + width / 2, ty + height / 2);
        };
        /**
         * @private
         */
        Matrix.prototype.$transformBounds = function (bounds) {
            var a = this.a;
            var b = this.b;
            var c = this.c;
            var d = this.d;
            var tx = this.tx;
            var ty = this.ty;
            var x = bounds.x;
            var y = bounds.y;
            var xMax = x + bounds.width;
            var yMax = y + bounds.height;
            var x0 = a * x + c * y + tx;
            var y0 = b * x + d * y + ty;
            var x1 = a * xMax + c * y + tx;
            var y1 = b * xMax + d * y + ty;
            var x2 = a * xMax + c * yMax + tx;
            var y2 = b * xMax + d * yMax + ty;
            var x3 = a * x + c * yMax + tx;
            var y3 = b * x + d * yMax + ty;
            var tmp = 0;
            if (x0 > x1) {
                tmp = x0;
                x0 = x1;
                x1 = tmp;
            }
            if (x2 > x3) {
                tmp = x2;
                x2 = x3;
                x3 = tmp;
            }
            bounds.x = Math.floor(x0 < x2 ? x0 : x2);
            bounds.width = Math.ceil((x1 > x3 ? x1 : x3) - bounds.x);
            if (y0 > y1) {
                tmp = y0;
                y0 = y1;
                y1 = tmp;
            }
            if (y2 > y3) {
                tmp = y2;
                y2 = y3;
                y3 = tmp;
            }
            bounds.y = Math.floor(y0 < y2 ? y0 : y2);
            bounds.height = Math.ceil((y1 > y3 ? y1 : y3) - bounds.y);
        };
        /**
         * @private
         */
        Matrix.prototype.getDeterminant = function () {
            return this.a * this.d - this.b * this.c;
        };
        /**
         * @private
         */
        Matrix.prototype.$getScaleX = function () {
            var m = this;
            if (m.a == 1 && m.b == 0) {
                return 1;
            }
            var result = Math.sqrt(m.a * m.a + m.b * m.b);
            return this.getDeterminant() < 0 ? -result : result;
        };
        /**
         * @private
         */
        Matrix.prototype.$getScaleY = function () {
            var m = this;
            if (m.c == 0 && m.d == 1) {
                return 1;
            }
            var result = Math.sqrt(m.c * m.c + m.d * m.d);
            return this.getDeterminant() < 0 ? -result : result;
        };
        /**
         * @private
         */
        Matrix.prototype.$getSkewX = function () {
            return Math.atan2(this.d, this.c) - (PI / 2);
        };
        /**
         * @private
         */
        Matrix.prototype.$getSkewY = function () {
            return Math.atan2(this.b, this.a);
        };
        /**
         * @private
         */
        Matrix.prototype.$updateScaleAndRotation = function (scaleX, scaleY, skewX, skewY) {
            if ((skewX == 0 || skewX == TwoPI) && (skewY == 0 || skewY == TwoPI)) {
                this.a = scaleX;
                this.b = this.c = 0;
                this.d = scaleY;
                return;
            }
            skewX = skewX / DEG_TO_RAD;
            skewY = skewY / DEG_TO_RAD;
            var u = egret.NumberUtils.cos(skewX);
            var v = egret.NumberUtils.sin(skewX);
            if (skewX == skewY) {
                this.a = u * scaleX;
                this.b = v * scaleX;
            }
            else {
                this.a = egret.NumberUtils.cos(skewY) * scaleX;
                this.b = egret.NumberUtils.sin(skewY) * scaleX;
            }
            this.c = -v * scaleY;
            this.d = u * scaleY;
        };
        /**
         * @private
         * target = other * this
         */
        Matrix.prototype.$preMultiplyInto = function (other, target) {
            var a = other.a * this.a;
            var b = 0.0;
            var c = 0.0;
            var d = other.d * this.d;
            var tx = other.tx * this.a + this.tx;
            var ty = other.ty * this.d + this.ty;
            if (other.b !== 0.0 || other.c !== 0.0 || this.b !== 0.0 || this.c !== 0.0) {
                a += other.b * this.c;
                d += other.c * this.b;
                b += other.a * this.b + other.b * this.d;
                c += other.c * this.a + other.d * this.c;
                tx += other.ty * this.c;
                ty += other.tx * this.b;
            }
            target.a = a;
            target.b = b;
            target.c = c;
            target.d = d;
            target.tx = tx;
            target.ty = ty;
        };
        return Matrix;
    }(egret.HashObject));
    egret.Matrix = Matrix;
    __reflect(Matrix.prototype, "egret.Matrix");
    /**
     * @private
     * ไปไพๆกๆถๅๅค็จ๏ผ่ฆ้ฒๆญขๆด้ฒๅผ็จๅฐๅค้จใ
     */
    egret.$TempMatrix = new Matrix();
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The JointStyle class is an enumeration of constant values that specify the joint style to use in drawing lines.
     * These constants are provided for use as values in the joints parameter of the egret.Graphics.lineStyle() method.
     * @see egret.Graphics#lineStyle()
     * @version Egret 2.5
     * @platform Web,Native
     * @language en_US
     */
    /**
     * JointStyle ็ฑปๆฏๆๅฎ่ฆๅจ็ปๅถ็บฟๆกไธญไฝฟ็จ็่ๆฅ็นๆทๅผ็ๅธธ้ๅผๆไธพใๆไพ็่ฟไบๅธธ้็จไฝ egret.Graphics.lineStyle() ๆนๆณ็ joints ๅๆฐไธญ็ๅผใ
     * @see egret.Graphics#lineStyle()
     * @version Egret 2.5
     * @platform Web,Native
     * @language zh_CN
     */
    egret.JointStyle = {
        /**
         * Specifies beveled joints in the joints parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจ egret.Graphics.lineStyle() ๆนๆณ็ joints ๅๆฐไธญๆๅฎๆ่ง่ฟๆฅใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        BEVEL: "bevel",
        /**
         * Specifies mitered joints in the joints parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจ egret.Graphics.lineStyle() ๆนๆณ็ joints ๅๆฐไธญๆๅฎๅฐ่ง่ฟๆฅใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        MITER: "miter",
        /**
         * Specifies round joints in the joints parameter of the egret.Graphics.lineStyle() method.
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจ egret.Graphics.lineStyle() ๆนๆณ็ joints ๅๆฐไธญๆๅฎๅ่ง่ฟๆฅใ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        ROUND: "round"
    };
})(egret || (egret = {}));
var egret;
(function (egret) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["en_US"] = egret.$locale_strings["en_US"] || {};
    var locale_strings = egret.$locale_strings["en_US"];
    //core  1000-1999
    locale_strings[1001] = "Could not find Egret entry class: {0}ใ";
    locale_strings[1002] = "Egret entry class '{0}' must inherit from egret.DisplayObject.";
    locale_strings[1003] = "Parameter {0} must be non-null.";
    locale_strings[1004] = "An object cannot be added as a child to one of it's children (or children's children, etc.).";
    locale_strings[1005] = "An object cannot be added as a child of itself.";
    locale_strings[1006] = "The supplied DisplayObject must be a child of the caller.";
    locale_strings[1007] = "An index specified for a parameter was out of range.";
    locale_strings[1008] = "Instantiate singleton error๏ผsingleton class {0} can not create multiple instances.";
    locale_strings[1009] = "the Class {0} cannot use the property \"{1}\"";
    locale_strings[1010] = "the property \"{1}\" of the Class \"{0}\" is readonly";
    locale_strings[1011] = "Stream Error. URL: {0}";
    locale_strings[1012] = "The type of parameter {0} must be Class.";
    locale_strings[1013] = "Variable assignment is NaN, please see the code!";
    locale_strings[1014] = "the constant \"{1}\" of the Class \"{0}\" is read-only";
    locale_strings[1015] = "xml not found!";
    locale_strings[1016] = "{0}has been obsoleted";
    locale_strings[1017] = "The format of JSON file is incorrect: {0}\ndata: {1}";
    locale_strings[1018] = "the scale9Grid is not correct";
    locale_strings[1019] = "Network ab:{0}";
    locale_strings[1020] = "Cannot initialize Shader";
    locale_strings[1021] = "Current browser does not support webgl";
    locale_strings[1022] = "{0} ArgumentError";
    locale_strings[1023] = "This method is not available in the ScrollView!";
    locale_strings[1025] = "end of the file";
    locale_strings[1026] = "! EncodingError The code point {0} could not be encoded.";
    locale_strings[1027] = "DecodingError";
    locale_strings[1028] = ". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.";
    locale_strings[1029] = "Function.prototype.bind - what is trying to be bound is not callable";
    locale_strings[1033] = "Photos can not be used across domains toDataURL to convert base64";
    locale_strings[1034] = "Music file decoding failed: \"{0}\", please use the standard conversion tool reconversion under mp3.";
    locale_strings[1035] = "Native does not support this feature!";
    locale_strings[1036] = "Sound has stopped, please recall Sound.play () to play the sound!";
    locale_strings[1037] = "Non-load the correct blob!";
    locale_strings[1038] = "XML format error!";
    locale_strings[1039] = "Cross domains pictures can not get pixel information!";
    locale_strings[1040] = "hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.";
    locale_strings[1041] = "{0} is deprecated, please use {1} replace";
    locale_strings[1042] = "The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.";
    locale_strings[1043] = "Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.";
    locale_strings[1044] = "The current version of the Runtime does not support video playback, please use the latest version";
    locale_strings[1045] = "The resource url is not found";
    locale_strings[1046] = "BitmapText no corresponding characters: {0}, please check the configuration file";
    locale_strings[1047] = "egret.localStorage.setItem save failed,key={0}&value={1}";
    locale_strings[1048] = "Video loading failed";
    locale_strings[1049] = "In the absence of sound is not allowed to play after loading";
    locale_strings[1050] = "ExternalInterface calls the method without js registration: {0}";
    //gui  3000-3099
    locale_strings[3000] = "Theme configuration file failed to load: {0}";
    locale_strings[3001] = "Cannot find the skin name which is configured in Theme: {0}";
    locale_strings[3002] = "Index:\"{0}\" is out of the collection element index range";
    locale_strings[3003] = "Cannot be available in this component. If this component is container, please continue to use";
    locale_strings[3004] = "addChild(){0}addElement() replace";
    locale_strings[3005] = "addChildAt(){0}addElementAt() replace";
    locale_strings[3006] = "removeChild(){0}removeElement() replace";
    locale_strings[3007] = "removeChildAt(){0}removeElementAt() replace";
    locale_strings[3008] = "setChildIndex(){0}setElementIndex() replace";
    locale_strings[3009] = "swapChildren(){0}swapElements() replace";
    locale_strings[3010] = "swapChildrenAt(){0}swapElementsAt() replace";
    locale_strings[3011] = "Index:\"{0}\" is out of the visual element index range";
    locale_strings[3012] = "This method is not available in Scroller component!";
    locale_strings[3013] = "UIStage is GUI root container, and only one such instant is in the display list๏ผ";
    locale_strings[3014] = "set fullscreen error";
    //socket 3100-3199
    locale_strings[3100] = "Current browser does not support WebSocket";
    locale_strings[3101] = "Please connect Socket firstly";
    locale_strings[3102] = "Please set the type of binary type";
    //db 4000-4299
    locale_strings[4000] = "An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)";
    locale_strings[4001] = "Abstract class can not be instantiated!";
    locale_strings[4002] = "Unnamed data!";
    locale_strings[4003] = "Nonsupport version!";
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    var Mesh = (function (_super) {
        __extends(Mesh, _super);
        function Mesh(value) {
            var _this = _super.call(this, value) || this;
            /**
             * @private
             */
            _this._verticesDirty = true;
            _this._bounds = new egret.Rectangle();
            _this.$renderNode = new egret.sys.MeshNode();
            return _this;
        }
        /**
         * @private
         */
        Mesh.prototype.$render = function () {
            var values = this.$Bitmap;
            var image = values[1 /* image */];
            if (!image) {
                return;
            }
            var scale = egret.$TextureScaleFactor;
            var node = this.$renderNode;
            node.smoothing = values[10 /* smoothing */];
            node.image = image;
            node.imageWidth = values[13 /* sourceWidth */];
            node.imageHeight = values[14 /* sourceHeight */];
            var destW = !isNaN(values[11 /* explicitBitmapWidth */]) ? values[11 /* explicitBitmapWidth */] : values[8 /* textureWidth */];
            var destH = !isNaN(values[12 /* explicitBitmapHeight */]) ? values[12 /* explicitBitmapHeight */] : values[9 /* textureHeight */];
            var tsX = destW / values[8 /* textureWidth */];
            var tsY = destH / values[9 /* textureHeight */];
            var bitmapWidth = values[4 /* bitmapWidth */];
            var bitmapHeight = values[5 /* bitmapHeight */];
            node.drawMesh(values[2 /* bitmapX */], values[3 /* bitmapY */], bitmapWidth, bitmapHeight, values[6 /* offsetX */] * tsX, values[7 /* offsetY */] * tsY, tsX * bitmapWidth, tsY * bitmapHeight);
        };
        /**
         * @private
         */
        Mesh.prototype.$updateVertices = function () {
            this._verticesDirty = true;
            this.$invalidateContentBounds();
        };
        /**
         * @private
         */
        Mesh.prototype.$measureContentBounds = function (bounds) {
            if (this._verticesDirty) {
                this._verticesDirty = false;
                var node = this.$renderNode;
                var vertices = node.vertices;
                if (vertices.length) {
                    this._bounds.setTo(Number.MAX_VALUE, Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE);
                    for (var i = 0, l = vertices.length; i < l; i += 2) {
                        var x = vertices[i];
                        var y = vertices[i + 1];
                        if (this._bounds.x > x)
                            this._bounds.x = x;
                        if (this._bounds.width < x)
                            this._bounds.width = x;
                        if (this._bounds.y > y)
                            this._bounds.y = y;
                        if (this._bounds.height < y)
                            this._bounds.height = y;
                    }
                    this._bounds.width -= this._bounds.x;
                    this._bounds.height -= this._bounds.y;
                }
                else {
                    this._bounds.setTo(0, 0, 0, 0);
                }
                node.bounds.copyFrom(this._bounds);
            }
            bounds.copyFrom(this._bounds);
        };
        return Mesh;
    }(egret.Bitmap));
    egret.Mesh = Mesh;
    __reflect(Mesh.prototype, "egret.Mesh");
})(egret || (egret = {}));
var egret;
(function (egret) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["zh_CN"] = egret.$locale_strings["zh_CN"] || {};
    var locale_strings = egret.$locale_strings["zh_CN"];
    //eui 2000-2999
    //RES 3200-3299
    //core  1000-1999
    locale_strings[1001] = "ๆพไธๅฐEgretๅฅๅฃ็ฑป: {0}ใ";
    locale_strings[1002] = "Egretๅฅๅฃ็ฑป {0} ๅฟ้กป็ปงๆฟ่ชegret.DisplayObjectใ";
    locale_strings[1003] = "ๅๆฐ {0} ไธ่ฝไธบ nullใ";
    locale_strings[1004] = "ๆๆณๅฐๅฏน่ฑกๆทปๅไธบๅฎ็ไธไธชๅญๅฏน่ฑก๏ผๆๅญๅฏน่ฑก็ๅญๅฏน่ฑก็ญ๏ผ็ๅญๅฏน่ฑกใ";
    locale_strings[1005] = "ไธ่ฝๅฐๅฏน่ฑกๆทปๅไธบๅถ่ช่บซ็ๅญๅฏน่ฑกใ";
    locale_strings[1006] = "ๆไพ็ DisplayObject ๅฟ้กปๆฏ่ฐ็จ่็ๅญ็บงใ";
    locale_strings[1007] = "ไธบๅๆฐๆๅฎ็็ดขๅผไธๅจ่ๅดๅใ";
    locale_strings[1008] = "ๅฎไพๅๅไพๅบ้๏ผไธๅ่ฎธๅฎไพๅๅคไธช {0} ๅฏน่ฑกใ";
    locale_strings[1009] = "็ฑป {0} ไธๅฏไปฅไฝฟ็จๅฑๆง {1}";
    locale_strings[1010] = "็ฑป {0} ๅฑๆง {1} ๆฏๅช่ฏป็";
    locale_strings[1011] = "ๆต้่ฏฏใURL: {0}";
    locale_strings[1012] = "ๅๆฐ {0} ็็ฑปๅๅฟ้กปไธบ Classใ";
    locale_strings[1013] = "ๅ้่ตๅผไธบNaN๏ผ่ฏทๆฅ็ไปฃ็๏ผ";
    locale_strings[1014] = "็ฑป {0} ๅธธ้ {1} ๆฏๅช่ฏป็";
    locale_strings[1015] = "xml not found!";
    locale_strings[1016] = "{0}ๅทฒ็ปๅบๅผ";
    locale_strings[1017] = "JSONๆไปถๆผๅผไธๆญฃ็กฎ: {0}\ndata: {1}";
    locale_strings[1018] = "9ๅฎซๆผ่ฎพ็ฝฎ้่ฏฏ";
    locale_strings[1019] = "็ฝ็ปๅผๅธธ:{0}";
    locale_strings[1020] = "ๆๆณๅๅงๅ็่ฒๅจ";
    locale_strings[1021] = "ๅฝๅๆต่งๅจไธๆฏๆwebgl";
    locale_strings[1022] = "{0} ArgumentError";
    locale_strings[1023] = "ๆญคๆนๆณๅจScrollViewๅไธๅฏ็จ!";
    locale_strings[1025] = "้ๅฐๆไปถๅฐพ";
    locale_strings[1026] = "EncodingError! The code point {0} could not be encoded.";
    locale_strings[1027] = "DecodingError";
    locale_strings[1028] = "่ฐ็จไบๆช้็ฝฎ็ๆณจๅฅ่งๅ:{0}ใ ่ฏทๅๅจ้กน็ฎๅๅงๅ้้็ฝฎๆๅฎ็ๆณจๅฅ่งๅ๏ผๅ่ฐ็จๅฏนๅบๅไพใ";
    locale_strings[1029] = "Function.prototype.bind - what is trying to be bound is not callable";
    locale_strings[1033] = "่ทจๅๅพ็ไธๅฏไปฅไฝฟ็จtoDataURLๆฅ่ฝฌๆขๆbase64";
    locale_strings[1034] = "้ณไนๆไปถ่งฃ็ๅคฑ่ดฅ๏ผ\"{0}\"๏ผ่ฏทไฝฟ็จๆๅ็่ฝฌๆขๅทฅๅท้ๆฐ่ฝฌๆขไธmp3ใ";
    locale_strings[1035] = "Native ไธๆๆชๅฎ็ฐๆญคๅ่ฝ๏ผ";
    locale_strings[1036] = "ๅฃฐ้ณๅทฒๅๆญข๏ผ่ฏท้ๆฐ่ฐ็จ Sound.play() ๆฅๆญๆพๅฃฐ้ณ๏ผ";
    locale_strings[1037] = "้ๆญฃ็กฎ็blobๅ่ฝฝ๏ผ";
    locale_strings[1038] = "XML ๆผๅผ้่ฏฏ!";
    locale_strings[1039] = "่ทจๅๅพ็ไธ่ฝ่ทๅๅ็ดไฟกๆฏ!";
    locale_strings[1040] = "hitTestPoint ไธ่ฝๅฏน่ทจๅๅพ็่ฟ่กๆฃๆต! ่ฏทๆฃๆฅ่ฏฅๆพ็คบๅฏน่ฑกๅๆฏๅฆๅซๆ่ทจๅๅ็ด";
    locale_strings[1041] = "{0} ๅทฒๅบๅผ,่ฏทไฝฟ็จ {1} ไปฃๆฟ";
    locale_strings[1042] = "drawToTextureๆนๆณไผๅฅ็ๅบๅๅไธชๅๆฐ้่ฆไธบๆดๆฐ,ๅฆๅๆไบๆต่งๅจ็ปๅถไผๅบ็ฐๅผๅธธ";
    locale_strings[1043] = "{0} ไธญๅญๅจ็ผ่ฏ้่ฏฏ๏ผๅฑๆงๅ : {1}๏ผๅฑๆงๅผ : {2}";
    locale_strings[1044] = "ๅฝๅ็ runtime ็ๆฌไธๆฏๆ่ง้ขๆญๆพ,่ฏทไฝฟ็จๆๆฐ็็ๆฌ";
    locale_strings[1045] = "ๆฒกๆ่ฎพ็ฝฎ่ฆๅ่ฝฝ็่ตๆบๅฐๅ";
    locale_strings[1046] = "BitmapText ๆพไธๅฐๅฏนๅบๅญ็ฌฆ:{0}๏ผ่ฏทๆฃๆฅ้็ฝฎๆไปถ";
    locale_strings[1047] = "egret.localStorage.setItemไฟๅญๅคฑ่ดฅ,key={0}&value={1}";
    locale_strings[1048] = "่ง้ขๅ่ฝฝๅคฑ่ดฅ";
    locale_strings[1049] = "ๅฃฐ้ณๅจๆฒกๆๅ่ฝฝๅฎไนๅไธๅ่ฎธๆญๆพ";
    locale_strings[1050] = "ExternalInterface่ฐ็จไบjsๆฒกๆๆณจๅ็ๆนๆณ: {0}";
    //gui  3000-3099
    locale_strings[3000] = "ไธป้ข้็ฝฎๆไปถๅ่ฝฝๅคฑ่ดฅ: {0}";
    locale_strings[3001] = "ๆพไธๅฐไธป้ขไธญๆ้็ฝฎ็็ฎ่ค็ฑปๅ: {0}";
    locale_strings[3002] = "็ดขๅผ:\"{0}\"่ถๅบ้ๅๅ็ด็ดขๅผ่ๅด";
    locale_strings[3003] = "ๅจๆญค็ปไปถไธญไธๅฏ็จ๏ผ่ฅๆญค็ปไปถไธบๅฎนๅจ็ฑป๏ผ่ฏทไฝฟ็จ";
    locale_strings[3004] = "addChild(){0}addElement()ไปฃๆฟ";
    locale_strings[3005] = "addChildAt(){0}addElementAt()ไปฃๆฟ";
    locale_strings[3006] = "removeChild(){0}removeElement()ไปฃๆฟ";
    locale_strings[3007] = "removeChildAt(){0}removeElementAt()ไปฃๆฟ";
    locale_strings[3008] = "setChildIndex(){0}setElementIndex()ไปฃๆฟ";
    locale_strings[3009] = "swapChildren(){0}swapElements()ไปฃๆฟ";
    locale_strings[3010] = "swapChildrenAt(){0}swapElementsAt()ไปฃๆฟ";
    locale_strings[3011] = "็ดขๅผ:\"{0}\"่ถๅบๅฏ่งๅ็ด็ดขๅผ่ๅด";
    locale_strings[3012] = "ๆญคๆนๆณๅจScroller็ปไปถๅไธๅฏ็จ!";
    locale_strings[3013] = "UIStageๆฏGUIๆนๅฎนๅจ๏ผๅช่ฝๆไธไธชๆญคๅฎไพๅจๆพ็คบๅ่กจไธญ๏ผ";
    locale_strings[3014] = "่ฎพ็ฝฎๅจๅฑๆจกๅผๅคฑ่ดฅ";
    //socket 3100-3199
    locale_strings[3100] = "ๅฝๅๆต่งๅจไธๆฏๆWebSocket";
    locale_strings[3101] = "่ฏทๅ่ฟๆฅWebSocket";
    locale_strings[3102] = "่ฏทๅ่ฎพ็ฝฎtypeไธบไบ่ฟๅถ็ฑปๅ";
    //db 4000-4299
    locale_strings[4000] = "An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)";
    locale_strings[4001] = "Abstract class can not be instantiated!";
    locale_strings[4002] = "Unnamed data!";
    locale_strings[4003] = "Nonsupport version!";
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/**
 * @version Egret 2.4
 * @platform Web,Native
 * @includeExample egret/localStorage/localStorage.ts
 */
var egret;
(function (egret) {
    var localStorage;
    (function (localStorage) {
    })(localStorage = egret.localStorage || (egret.localStorage = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        var usingChannel = [];
        /**
         * @private
         * @param channel
         */
        function $pushSoundChannel(channel) {
            if (usingChannel.indexOf(channel) < 0) {
                usingChannel.push(channel);
            }
        }
        sys.$pushSoundChannel = $pushSoundChannel;
        /**
         * @private
         * @param channel
         */
        function $popSoundChannel(channel) {
            var index = usingChannel.indexOf(channel);
            if (index >= 0) {
                usingChannel.splice(index, 1);
                return true;
            }
            return false;
        }
        sys.$popSoundChannel = $popSoundChannel;
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * @version Egret 2.4
     * @platform Web,Native
     */
    var PromiseObject = (function () {
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function PromiseObject() {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onSuccessFunc = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onSuccessThisObject = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onErrorFunc = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onErrorThisObject = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.downloadingSizeFunc = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.downloadingSizeThisObject = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onResponseHeaderFunc = null;
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            this.onResponseHeaderThisObject = null;
        }
        /**
         *
         * @version Egret 2.4
         * @platform Web,Native
         */
        PromiseObject.create = function () {
            if (PromiseObject.promiseObjectList.length) {
                return PromiseObject.promiseObjectList.pop();
            }
            else {
                return new egret.PromiseObject();
            }
        };
        /**
         * @private
         *
         * @param args
         */
        PromiseObject.prototype.onSuccess = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.onSuccessFunc) {
                this.onSuccessFunc.apply(this.onSuccessThisObject, args);
            }
            this.destroy();
        };
        /**
         * @private
         *
         * @param args
         */
        PromiseObject.prototype.onError = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.onErrorFunc) {
                this.onErrorFunc.apply(this.onErrorThisObject, args);
            }
            this.destroy();
        };
        /**
         * @private
         *
         * @param args
         */
        PromiseObject.prototype.downloadingSize = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.downloadingSizeFunc) {
                this.downloadingSizeFunc.apply(this.downloadingSizeThisObject, args);
            }
        };
        /**
         * @private
         *
         * @param args
         */
        PromiseObject.prototype.onResponseHeader = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (this.onResponseHeaderFunc) {
                this.onResponseHeaderFunc.apply(this.onResponseHeaderThisObject, args);
            }
        };
        /**
         * @private
         *
         */
        PromiseObject.prototype.destroy = function () {
            this.onSuccessFunc = undefined;
            this.onSuccessThisObject = undefined;
            this.onErrorFunc = undefined;
            this.onErrorThisObject = undefined;
            this.downloadingSizeFunc = undefined;
            this.downloadingSizeThisObject = undefined;
            this.onResponseHeaderFunc = undefined;
            this.onResponseHeaderThisObject = undefined;
            PromiseObject.promiseObjectList.push(this);
        };
        /**
         * @private
         */
        PromiseObject.promiseObjectList = [];
        return PromiseObject;
    }());
    egret.PromiseObject = PromiseObject;
    __reflect(PromiseObject.prototype, "egret.PromiseObject");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The HttpMethod class provides values that specify whether the HttpRequest object should use the POST method
     * or the GET method when sending data to a server.
     * @see egret.HttpRequest
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * HttpRequestMethod ็ฑปๆไพไบไธไบๅผ๏ผ่ฟไบๅผๅฏๆๅฎๅจๅฐๆฐๆฎๅ้ๅฐๆๅกๅจๆถ๏ผ
     * HttpRequest ๅฏน่ฑกๅบไฝฟ็จ POST ๆนๆณ่ฟๆฏ GET ๆนๆณใ
     * @see egret.HttpRequest
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var HttpMethod = (function () {
        function HttpMethod() {
        }
        /**
         * Specifies that the HttpRequest object is a GET.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบ HttpRequest ๅฏน่ฑกๆฏไธไธช GETใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HttpMethod.GET = "GET";
        /**
         * Specifies that the HttpRequest object is a POST.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบ HttpRequest ๅฏน่ฑกๆฏไธไธช POSTใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HttpMethod.POST = "POST";
        return HttpMethod;
    }());
    egret.HttpMethod = HttpMethod;
    __reflect(HttpMethod.prototype, "egret.HttpMethod");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The HttpResponseType class provides values that specify how downloaded data is received.
     * @see egret.HttpRequest
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * URLLoaderDataFormat ็ฑปๆไพไบไธไบ็จไบๆๅฎๅฆไฝๆฅๆถๅทฒไธ่ฝฝๆฐๆฎ็ๅผใ
     * @see egret.HttpRequest
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var HttpResponseType = (function () {
        function HttpResponseType() {
        }
        /**
         * Specifies that downloaded data is received as text. This is the default value of HttpRequest.responseType
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๅญ็ฌฆไธฒใHttpRequest.responseTypeๅฑๆง็้ป่ฎคๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HttpResponseType.TEXT = "text";
        /**
         * Specifies that downloaded data is received as raw binary data.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅไบ่ฟๅถ็ArrayBufferๅฏน่ฑกใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HttpResponseType.ARRAY_BUFFER = "arraybuffer";
        return HttpResponseType;
    }());
    egret.HttpResponseType = HttpResponseType;
    __reflect(HttpResponseType.prototype, "egret.HttpResponseType");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        if (true) {
            function isF(num) {
                return num % 1 !== 0;
            }
        }
        /**
         * @private
         */
        function unionArea(r1, r2) {
            var minX = r1.minX < r2.minX ? r1.minX : r2.minX;
            var minY = r1.minY < r2.minY ? r1.minY : r2.minY;
            var maxX = r1.maxX > r2.maxX ? r1.maxX : r2.maxX;
            var maxY = r1.maxY > r2.maxY ? r1.maxY : r2.maxY;
            return (maxX - minX) * (maxY - minY);
        }
        /**
         * @private
         * ่็ฉๅฝข่ฎก็ฎๅทฅๅท็ฑป
         */
        var DirtyRegion = (function () {
            function DirtyRegion(root) {
                /**
                 * @private
                 */
                this.dirtyList = [];
                /**
                 * @private
                 */
                this.hasClipRect = false;
                /**
                 * @private
                 */
                this.clipWidth = 0;
                /**
                 * @private
                 */
                this.clipHeight = 0;
                /**
                 * @private
                 */
                this.clipArea = 0;
                /**
                 * @private
                 */
                this.clipRectChanged = false;
                this.$dirtyRegionPolicy = egret.DirtyRegionPolicy.ON;
                this.root = root;
            }
            /**
             * @private
             * ่ฎพ็ฝฎๅช่ฃ่พน็๏ผ่ถ่ฟ่พน็็่็นๅฐ่ทณ่ฟ็ปๅถใ
             */
            DirtyRegion.prototype.setClipRect = function (width, height) {
                this.hasClipRect = true;
                this.clipRectChanged = true;
                this.clipWidth = Math.ceil(width);
                this.clipHeight = Math.ceil(height);
                this.clipArea = this.clipWidth * this.clipHeight;
            };
            /**
             * @private
             * ๆทปๅไธไธช่็ฉๅฝขๅบๅ๏ผ่ฟๅๆฏๅฆๆทปๅๆๅ๏ผๅฝ็ฉๅฝขไธบ็ฉบๆ่ๅจๅฑๅนไนๅคๆถ่ฟๅfalseใ
             */
            DirtyRegion.prototype.addRegion = function (target) {
                var minX = target.minX, minY = target.minY, maxX = target.maxX, maxY = target.maxY;
                if (this.hasClipRect) {
                    if (minX < 0) {
                        minX = 0;
                    }
                    if (minY < 0) {
                        minY = 0;
                    }
                    if (maxX > this.clipWidth) {
                        maxX = this.clipWidth;
                    }
                    if (maxY > this.clipHeight) {
                        maxY = this.clipHeight;
                    }
                }
                if (minX >= maxX || minY >= maxY) {
                    return false;
                }
                if (this.clipRectChanged) {
                    return true;
                }
                var dirtyList = this.dirtyList;
                var region = sys.Region.create();
                dirtyList.push(region.setTo(minX, minY, maxX, maxY));
                if (this.$dirtyRegionPolicy != egret.DirtyRegionPolicy.OFF) {
                    this.mergeDirtyList(dirtyList);
                }
                return true;
            };
            /**
             * @private
             */
            DirtyRegion.prototype.clear = function () {
                var dirtyList = this.dirtyList;
                var length = dirtyList.length;
                for (var i = 0; i < length; i++) {
                    sys.Region.release(dirtyList[i]);
                }
                dirtyList.length = 0;
            };
            /**
             * @private
             * ่ทๅๆ็ป็่็ฉๅฝขๅ่กจ
             */
            DirtyRegion.prototype.getDirtyRegions = function () {
                var dirtyList = this.dirtyList;
                if (this.$dirtyRegionPolicy == egret.DirtyRegionPolicy.OFF) {
                    this.clipRectChanged = true; //้ปๆญขๆๆ็addRegion()
                    this.clear();
                    var region = sys.Region.create();
                    if (this.hasClipRect) {
                        dirtyList.push(region.setTo(0, 0, this.clipWidth, this.clipHeight));
                    }
                    else {
                        var bounds = this.root.$getOriginalBounds();
                        dirtyList.push(region.setTo(bounds.x, bounds.y, bounds.width, bounds.height));
                    }
                }
                else if (this.clipRectChanged) {
                    this.clipRectChanged = false;
                    this.clear();
                    var region = sys.Region.create();
                    dirtyList.push(region.setTo(0, 0, this.clipWidth, this.clipHeight));
                }
                else {
                    while (this.mergeDirtyList(dirtyList)) {
                    }
                }
                var numDirty = this.dirtyList.length;
                if (numDirty > 0) {
                    for (var i = 0; i < numDirty; i++) {
                        this.dirtyList[i].intValues();
                    }
                }
                return this.dirtyList;
            };
            /**
             * @private
             * ๅๅนถ่็ฉๅฝขๅ่กจ
             */
            DirtyRegion.prototype.mergeDirtyList = function (dirtyList) {
                var length = dirtyList.length;
                if (length < 2) {
                    return false;
                }
                var hasClipRect = this.hasClipRect;
                var bestDelta = length > 3 ? Number.POSITIVE_INFINITY : 0;
                var mergeA = 0;
                var mergeB = 0;
                var totalArea = 0;
                for (var i = 0; i < length - 1; i++) {
                    var regionA = dirtyList[i];
                    hasClipRect && (totalArea += regionA.area);
                    for (var j = i + 1; j < length; j++) {
                        var regionB = dirtyList[j];
                        var delta = unionArea(regionA, regionB) - regionA.area - regionB.area;
                        if (bestDelta > delta) {
                            mergeA = i;
                            mergeB = j;
                            bestDelta = delta;
                        }
                    }
                }
                if (hasClipRect && (totalArea / this.clipArea) > 0.95) {
                    this.clipRectChanged = true;
                }
                if (mergeA != mergeB) {
                    var region = dirtyList[mergeB];
                    dirtyList[mergeA].union(region);
                    sys.Region.release(region);
                    dirtyList.splice(mergeB, 1);
                    return true;
                }
                return false;
            };
            DirtyRegion.prototype.setDirtyRegionPolicy = function (policy) {
                this.$dirtyRegionPolicy = policy;
            };
            return DirtyRegion;
        }());
        sys.DirtyRegion = DirtyRegion;
        __reflect(DirtyRegion.prototype, "egret.sys.DirtyRegion");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        var displayListPool = [];
        var blendModes = ["source-over", "lighter", "destination-out"];
        var defaultCompositeOp = "source-over";
        /**
         * @private
         * ๆพ็คบๅ่กจ
         */
        var DisplayList = (function (_super) {
            __extends(DisplayList, _super);
            /**
             * @private
             * ๅๅปบไธไธชDisplayListๅฏน่ฑก
             */
            function DisplayList(root) {
                var _this = _super.call(this) || this;
                _this.isStage = false;
                /**
                 * ไฝๅพๆธฒๆ่็น
                 */
                _this.$renderNode = new sys.BitmapNode();
                /**
                 * @private
                 */
                _this.renderBuffer = null;
                /**
                 * @private
                 */
                _this.offsetX = 0;
                /**
                 * @private
                 */
                _this.offsetY = 0;
                /**
                 * @private
                 */
                _this.offsetMatrix = new egret.Matrix();
                /**
                 * @private
                 */
                _this.isDirty = false;
                _this.needUpdateRegions = false;
                /**
                 * @private
                 */
                _this.dirtyNodeList = [];
                /**
                 * @private
                 */
                _this.dirtyList = null;
                /**
                 * @private
                 */
                _this.sizeChanged = false;
                _this.$dirtyRegionPolicy = egret.DirtyRegionPolicy.ON;
                _this.root = root;
                _this.dirtyRegion = new sys.DirtyRegion(root);
                _this.isStage = (root instanceof egret.Stage);
                _this.dirtyNodes = egret.createMap();
                _this.offsetMatrix.a = _this.offsetMatrix.d = DisplayList.$pixelRatio;
                return _this;
            }
            /**
             * ๅๅปบไธไธชDisplayListๅฏน่ฑก๏ผ่ฅๅๅญไธ่ถณๆๆๆณๅๅปบRenderBuffer๏ผๅฐไผ่ฟๅnullใ
             */
            DisplayList.create = function (target) {
                var displayList = new egret.sys.DisplayList(target);
                try {
                    var buffer = new sys.RenderBuffer();
                    displayList.renderBuffer = buffer;
                }
                catch (e) {
                    return null;
                }
                displayList.root = target;
                if (egret.Capabilities.$renderMode == "webgl") {
                    var policy = egret.DirtyRegionPolicy.OFF;
                    displayList.$dirtyRegionPolicy = policy;
                    displayList.dirtyRegion.setDirtyRegionPolicy(policy);
                    displayList.renderBuffer.setDirtyRegionPolicy(policy);
                }
                return displayList;
            };
            /**
             * @private
             * ่ทๅๆธฒๆ่็น
             */
            DisplayList.prototype.$getRenderNode = function () {
                return this.$renderNode;
            };
            /**
             * @private
             * ๆดๆฐๅฏน่ฑกๅจ่ๅฐไธ็ๆพ็คบๅบๅๅ้ๆๅบฆ,่ฟๅๆพ็คบๅบๅๆฏๅฆๅ็ๆนๅใ
             */
            DisplayList.prototype.$update = function (dirtyRegionPolicy) {
                var target = this.root;
                //ๅฝcacheๅฏน่ฑก็ๆพ็คบๅ่กจๅทฒ็ปๅๅฅdirtyList๏ผๅฏน่ฑกๅๅๆถcache็ๆถๅ๏ผrootไธบ็ฉบ
                if (target == null) {
                    return false;
                }
                target.$removeFlagsUp(768 /* Dirty */);
                var node = this.$renderNode;
                //ๅฟ้กปๅจ่ฎฟ้ฎmovedๅฑๆงๅ่ฐ็จไปฅไธไธคไธชๆนๆณ๏ผๅไธบmovedๅฑๆงๅจไปฅไธไธคไธชๆนๆณๅ้็ฝฎใ
                var concatenatedMatrix = target.$getConcatenatedMatrix();
                var displayList = target.$parentDisplayList;
                if (dirtyRegionPolicy == egret.DirtyRegionPolicy.OFF) {
                    if (this.needUpdateRegions) {
                        this.updateDirtyRegions();
                    }
                    if (!displayList) {
                        return false;
                    }
                    var matrix = node.renderMatrix;
                    matrix.copyFrom(concatenatedMatrix);
                    var root = displayList.root;
                    if (root !== target.$stage) {
                        target.$getConcatenatedMatrixAt(root, matrix);
                    }
                    node.renderAlpha = target.$getConcatenatedAlpha();
                }
                else {
                    var bounds = target.$getOriginalBounds();
                    var region = node.renderRegion;
                    if (this.needUpdateRegions) {
                        this.updateDirtyRegions();
                    }
                    if (!displayList) {
                        region.setTo(0, 0, 0, 0);
                        node.moved = false;
                        return false;
                    }
                    if (!node.moved) {
                        return false;
                    }
                    node.moved = false;
                    var matrix = node.renderMatrix;
                    matrix.copyFrom(concatenatedMatrix);
                    var root = displayList.root;
                    if (root !== target.$stage) {
                        target.$getConcatenatedMatrixAt(root, matrix);
                    }
                    region.updateRegion(bounds, matrix);
                    node.renderAlpha = target.$getConcatenatedAlpha();
                }
                return true;
            };
            /**
             * @private
             * ่ฎพ็ฝฎๅช่ฃ่พน็๏ผไธๅ็ปๅถๅฎๆด็ฎๆๅฏน่ฑก๏ผ็ปๅธๅฐบๅฏธ็ฑๅค้จๅณๅฎ๏ผ่ถ่ฟ่พน็็่็นๅฐ่ทณ่ฟ็ปๅถใ
             */
            DisplayList.prototype.setClipRect = function (width, height) {
                this.dirtyRegion.setClipRect(width, height);
                width *= DisplayList.$pixelRatio;
                height *= DisplayList.$pixelRatio;
                this.renderBuffer.resize(width, height);
            };
            /**
             * @private
             * ๆ่ฎฐไธไธช่็น้่ฆ้ๆฐๆธฒๆ
             */
            DisplayList.prototype.markDirty = function (node) {
                var key = node.$hashCode;
                if (this.dirtyNodes[key]) {
                    return;
                }
                this.dirtyNodes[key] = true;
                this.dirtyNodeList.push(node);
                if (!this.needUpdateRegions) {
                    this.needUpdateRegions = true;
                    this.isDirty = true;
                    var parentCache = this.root.$parentDisplayList;
                    if (parentCache) {
                        parentCache.markDirty(this);
                    }
                }
            };
            /**
             * @private
             * ๆดๆฐ่็นๅฑๆงๅนถ่ฟๅ่็ฉๅฝขๅ่กจใ
             */
            DisplayList.prototype.updateDirtyRegions = function () {
                var dirtyNodeList = this.dirtyNodeList;
                this.dirtyNodeList = [];
                this.dirtyNodes = egret.createMap();
                this.needUpdateRegions = false;
                var dirtyRegion = this.dirtyRegion;
                var length = dirtyNodeList.length;
                for (var i = 0; i < length; i++) {
                    var display = dirtyNodeList[i];
                    var node = display.$getRenderNode();
                    //ๆๅฏ่ฝ markDirty ไนๅ๏ผๆพ็คบๅฏน่ฑก่ช่บซๆนๅ๏ผๅ็ๆฒกๆrenderNode
                    if (node) {
                        node.needRedraw = false; //ๅๆธ็ฉบไธๆฌก็ผๅญ็ๆ่ฎฐ,้ฒๆญขไธๆฌกๆฒก้ๅๅฐ็่็น needRedraw ๅง็ปไธบ true.
                        if (this.isStage) {
                            if (node.renderAlpha > 0 && node.renderVisible) {
                                if (dirtyRegion.addRegion(node.renderRegion)) {
                                    node.needRedraw = true;
                                }
                            }
                            var moved = display.$update(this.$dirtyRegionPolicy);
                            if (node.renderAlpha > 0 && node.renderVisible && (moved || !node.needRedraw)) {
                                if (dirtyRegion.addRegion(node.renderRegion)) {
                                    node.needRedraw = true;
                                }
                            }
                        }
                        else {
                            if (dirtyRegion.addRegion(node.renderRegion)) {
                                node.needRedraw = true;
                            }
                            var moved = display.$update(this.$dirtyRegionPolicy);
                            if (moved || !node.needRedraw) {
                                if (dirtyRegion.addRegion(node.renderRegion)) {
                                    node.needRedraw = true;
                                }
                            }
                        }
                    }
                }
                this.dirtyList = dirtyRegion.getDirtyRegions();
                return this.dirtyList;
            };
            /**
             * @private
             * ็ปๅถๆน่็นๆพ็คบๅฏน่ฑกๅฐ็ฎๆ็ปๅธ๏ผ่ฟๅdraw็ๆฌกๆฐใ
             */
            DisplayList.prototype.drawToSurface = function () {
                var drawCalls = 0;
                var dirtyList = this.dirtyList;
                if (dirtyList && dirtyList.length > 0) {
                    if (!this.isStage) {
                        this.changeSurfaceSize();
                    }
                    var buffer = this.renderBuffer;
                    buffer.beginClip(this.dirtyList, this.offsetX, this.offsetY);
                    dirtyList = this.$dirtyRegionPolicy == egret.DirtyRegionPolicy.OFF ? null : this.dirtyList;
                    drawCalls = sys.systemRenderer.render(this.root, buffer, this.offsetMatrix, dirtyList, !this.isStage);
                    buffer.endClip();
                    if (!this.isStage) {
                        var surface = buffer.surface;
                        var renderNode = this.$renderNode;
                        renderNode.drawData.length = 0;
                        var width = surface.width;
                        var height = surface.height;
                        if (!this.bitmapData) {
                            this.bitmapData = new egret.BitmapData(surface);
                        }
                        else {
                            this.bitmapData.source = surface;
                            this.bitmapData.width = width;
                            this.bitmapData.height = height;
                        }
                        renderNode.image = this.bitmapData;
                        renderNode.imageWidth = width;
                        renderNode.imageHeight = height;
                        renderNode.drawImage(0, 0, width, height, -this.offsetX / DisplayList.$pixelRatio, -this.offsetY / DisplayList.$pixelRatio, width / DisplayList.$pixelRatio, height / DisplayList.$pixelRatio);
                    }
                }
                this.dirtyList = null;
                this.dirtyRegion.clear();
                this.isDirty = false;
                return drawCalls;
            };
            /**
             * @private
             * ๆนๅ็ปๅธ็ๅฐบๅฏธ๏ผ็ฑไบ็ปๅธๅฐบๅฏธไฟฎๆนไผๆธ็ฉบๅๅง็ปๅธใๆไปฅ่ฟ้ๅฐๅๅง็ปๅธ็ปๅถๅฐไธไธชๆฐ็ปๅธไธ๏ผๅไธๅๅง็ปๅธไบคๆขใ
             */
            DisplayList.prototype.changeSurfaceSize = function () {
                var root = this.root;
                var oldOffsetX = this.offsetX;
                var oldOffsetY = this.offsetY;
                var bounds = this.root.$getOriginalBounds();
                var scaleX = DisplayList.$pixelRatio;
                var scaleY = DisplayList.$pixelRatio;
                this.offsetX = -bounds.x * DisplayList.$pixelRatio;
                this.offsetY = -bounds.y * DisplayList.$pixelRatio;
                this.offsetMatrix.setTo(this.offsetMatrix.a, 0, 0, this.offsetMatrix.d, this.offsetX, this.offsetY);
                var buffer = this.renderBuffer;
                //ๅจchrome้๏ผๅฐ็ญไบ256*256็canvasไผไธๅฏ็จGPUๅ้ใ
                var width = Math.max(257, bounds.width * scaleX);
                var height = Math.max(257, bounds.height * scaleY);
                if (this.offsetX == oldOffsetX &&
                    this.offsetY == oldOffsetY &&
                    buffer.surface.width == width &&
                    buffer.surface.height == height) {
                    return;
                }
                if (!this.sizeChanged) {
                    this.sizeChanged = true;
                    buffer.resize(width, height);
                }
                else {
                    buffer.resizeTo(width, height, this.offsetX - oldOffsetX, this.offsetY - oldOffsetY);
                }
            };
            DisplayList.prototype.setDirtyRegionPolicy = function (policy) {
                //todo ่ฟ้่ฟๅฏไปฅๅๆดๅคไผๅ
                this.$dirtyRegionPolicy = policy;
                this.dirtyRegion.setDirtyRegionPolicy(policy);
                this.renderBuffer.setDirtyRegionPolicy(policy);
            };
            /**
             * @private
             */
            DisplayList.$setDevicePixelRatio = function (ratio) {
                if (DisplayList.$pixelRatio == ratio) {
                    return;
                }
                DisplayList.$pixelRatio = ratio;
            };
            DisplayList.$preMultiplyInto = function (other) {
                var pixelRatio = DisplayList.$pixelRatio;
                var a = other.a * pixelRatio;
                var b = 0.0;
                var c = 0.0;
                var d = other.d * pixelRatio;
                var tx = other.tx * pixelRatio;
                var ty = other.ty * pixelRatio;
                if (other.b !== 0.0 || other.c !== 0.0) {
                    b += other.b * pixelRatio;
                    c += other.c * pixelRatio;
                }
                other.a = a;
                other.b = b;
                other.c = c;
                other.d = d;
                other.tx = tx;
                other.ty = ty;
            };
            /**
             * @private
             */
            DisplayList.$pixelRatio = 1;
            return DisplayList;
        }(egret.HashObject));
        sys.DisplayList = DisplayList;
        __reflect(DisplayList.prototype, "egret.sys.DisplayList", ["egret.sys.Renderable"]);
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../display/Sprite.ts" />
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * Egretๆญๆพๅจ
         */
        var Player = (function (_super) {
            __extends(Player, _super);
            /**
             * @private
             * ๅฎไพๅไธไธชๆญๆพๅจๅฏน่ฑกใ
             */
            function Player(buffer, stage, entryClassName) {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.isPlaying = false;
                if (true && !buffer) {
                    egret.$error(1003, "buffer");
                }
                _this.entryClassName = entryClassName;
                _this.stage = stage;
                _this.screenDisplayList = _this.createDisplayList(stage, buffer);
                _this.showFPS = false;
                _this.showLog = false;
                _this._showPaintRect = false;
                _this.stageDisplayList = null;
                _this.paintList = [];
                _this.displayFPS = displayFPS;
                _this.showPaintRect = showPaintRect;
                _this.drawPaintRect = drawPaintRect;
                _this.drawDirtyRect = drawDirtyRect;
                return _this;
            }
            /**
             * @private
             */
            Player.prototype.createDisplayList = function (stage, buffer) {
                var displayList = new sys.DisplayList(stage);
                displayList.renderBuffer = buffer;
                stage.$displayList = displayList;
                //displayList.setClipRect(stage.$stageWidth, stage.$stageHeight);
                return displayList;
            };
            /**
             * @private
             * ๅฏๅจๆญๆพๅจ
             */
            Player.prototype.start = function () {
                if (this.isPlaying || !this.stage) {
                    return;
                }
                sys.$TempStage = sys.$TempStage || this.stage;
                this.isPlaying = true;
                if (!this.root) {
                    this.initialize();
                }
                egret.ticker.$addPlayer(this);
            };
            /**
             * @private
             *
             */
            Player.prototype.initialize = function () {
                var rootClass;
                if (this.entryClassName) {
                    rootClass = egret.getDefinitionByName(this.entryClassName);
                }
                if (rootClass) {
                    var rootContainer = new rootClass();
                    this.root = rootContainer;
                    if (rootContainer instanceof egret.DisplayObject) {
                        this.stage.addChild(rootContainer);
                    }
                    else {
                        true && egret.$error(1002, this.entryClassName);
                    }
                }
                else {
                    true && egret.$error(1001, this.entryClassName);
                }
            };
            /**
             * @private
             * ๅๆญขๆญๆพๅจ๏ผๅๆญขๅๅฐไธ่ฝ้ๆฐๅฏๅจใ
             */
            Player.prototype.stop = function () {
                this.pause();
                this.stage = null;
            };
            /**
             * @private
             * ๆๅๆญๆพๅจ๏ผๅ็ปญๅฏไปฅ้่ฟ่ฐ็จstart()้ๆฐๅฏๅจๆญๆพๅจใ
             */
            Player.prototype.pause = function () {
                if (!this.isPlaying) {
                    return;
                }
                this.isPlaying = false;
                egret.ticker.$removePlayer(this);
            };
            /**
             * @private
             * ๆธฒๆๅฑๅน
             */
            Player.prototype.$render = function (triggerByFrame, costTicker) {
                if (this.showFPS || this.showLog) {
                    this.stage.addChild(this.fps);
                }
                var stage = this.stage;
                var t = egret.getTimer();
                var dirtyList = stage.$displayList.updateDirtyRegions();
                var t1 = egret.getTimer();
                dirtyList = dirtyList.concat();
                var drawCalls = stage.$displayList.drawToSurface();
                if (this._showPaintRect) {
                    this.drawPaintRect(dirtyList);
                }
                var t2 = egret.getTimer();
                if (triggerByFrame && this.showFPS) {
                    var dirtyRatio = 0;
                    if (drawCalls > 0) {
                        var length_4 = dirtyList.length;
                        var dirtyArea = 0;
                        for (var i = 0; i < length_4; i++) {
                            dirtyArea += dirtyList[i].area;
                        }
                        dirtyRatio = Math.ceil(dirtyArea * 1000 / (stage.stageWidth * stage.stageHeight)) / 10;
                    }
                    this.fps.update(drawCalls, dirtyRatio, t1 - t, t2 - t1, costTicker);
                }
            };
            /**
             * @private
             * ๆดๆฐ่ๅฐๅฐบๅฏธ
             * @param stageWidth ่ๅฐๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผ
             * @param stageHeight ่ๅฐ้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผ
             */
            Player.prototype.updateStageSize = function (stageWidth, stageHeight) {
                var stage = this.stage;
                //if (stageWidth !== stage.$stageWidth || stageHeight !== stage.$stageHeight) {
                stage.$stageWidth = stageWidth;
                stage.$stageHeight = stageHeight;
                this.screenDisplayList.setClipRect(stageWidth, stageHeight);
                if (this.stageDisplayList) {
                    this.stageDisplayList.setClipRect(stageWidth, stageHeight);
                }
                stage.dispatchEventWith(egret.Event.RESIZE);
                stage.$invalidate(true);
                //}
            };
            return Player;
        }(egret.HashObject));
        sys.Player = Player;
        __reflect(Player.prototype, "egret.sys.Player");
        var infoLines = [];
        var fpsDisplay;
        var fpsStyle;
        sys.$logToFPS = function (info) {
            if (!fpsDisplay) {
                infoLines.push(info);
                return;
            }
            fpsDisplay.updateInfo(info);
        };
        function displayFPS(showFPS, showLog, logFilter, styles) {
            if (showLog) {
                egret.log = function () {
                    var length = arguments.length;
                    var info = "";
                    for (var i = 0; i < length; i++) {
                        info += arguments[i] + " ";
                    }
                    sys.$logToFPS(info);
                    console.log.apply(console, toArray(arguments));
                };
            }
            fpsStyle = styles ? {} : styles;
            showLog = !!showLog;
            this.showFPS = !!showFPS;
            this.showLog = showLog;
            if (!this.fps) {
                var x = styles["x"] === undefined ? 0 : styles["x"];
                var y = styles["y"] === undefined ? 0 : styles["y"];
                fpsDisplay = this.fps = new FPS(this.stage, showFPS, showLog, logFilter, styles);
                fpsDisplay.x = x;
                fpsDisplay.y = y;
                var length_5 = infoLines.length;
                for (var i = 0; i < length_5; i++) {
                    fpsDisplay.updateInfo(infoLines[i]);
                }
                infoLines = null;
            }
        }
        function showPaintRect(value) {
            value = !!value;
            if (this._showPaintRect == value) {
                return;
            }
            this._showPaintRect = value;
            if (value) {
                if (!this.stageDisplayList) {
                    this.stageDisplayList = sys.DisplayList.create(this.stage);
                }
                this.stage.$displayList = this.stageDisplayList;
            }
            else {
                this.stage.$displayList = this.screenDisplayList;
            }
        }
        function drawPaintRect(dirtyList) {
            var length = dirtyList.length;
            var list = [];
            for (var i = 0; i < length; i++) {
                var region = dirtyList[i];
                list[i] = [region.minX, region.minY, region.width, region.height];
                region.width -= 1;
                region.height -= 1;
            }
            var repaintList = this.paintList;
            repaintList.push(list);
            if (repaintList.length > 1) {
                repaintList.shift();
            }
            var renderBuffer = this.screenDisplayList.renderBuffer;
            var context = renderBuffer.context;
            context.setTransform(1, 0, 0, 1, 0, 0);
            context.clearRect(0, 0, renderBuffer.surface.width, renderBuffer.surface.height);
            context.drawImage(this.stageDisplayList.renderBuffer.surface, 0, 0);
            length = repaintList.length;
            for (var i = 0; i < length; i++) {
                list = repaintList[i];
                for (var j = list.length - 1; j >= 0; j--) {
                    var r = list[j];
                    this.drawDirtyRect(r[0], r[1], r[2], r[3], context);
                }
            }
            context.save();
            context.beginPath();
            length = dirtyList.length;
            for (var i = 0; i < length; i++) {
                var region = dirtyList[i];
                var pixelRatio = sys.DisplayList.$pixelRatio;
                context.clearRect(region.minX * pixelRatio, region.minY * pixelRatio, region.width * pixelRatio, region.height * pixelRatio);
                context.rect(region.minX * pixelRatio, region.minY * pixelRatio, region.width * pixelRatio, region.height * pixelRatio);
            }
            context.clip();
            context.drawImage(this.stageDisplayList.renderBuffer.surface, 0, 0);
            context.restore();
        }
        /**
         * ็ปๅถไธไธช่็ฉๅฝขๆพ็คบๅบๅ๏ผๅจๆพ็คบ้็ปๅบๅ่ฝๅผๅฏๆถ่ฐ็จใ
         */
        function drawDirtyRect(x, y, width, height, context) {
            context.strokeStyle = 'rgb(255,0,0)';
            context.lineWidth = 5;
            var pixelRatio = sys.DisplayList.$pixelRatio;
            context.strokeRect(x * pixelRatio - 0.5, y * pixelRatio - 0.5, width * pixelRatio, height * pixelRatio);
        }
        /**
         * FPSๆพ็คบๅฏน่ฑก
         */
        FPS = (function (_super) {
            __extends(FPSImpl, _super);
            function FPSImpl(stage, showFPS, showLog, logFilter, styles) {
                _super.call(this);
                this["isFPS"] = true;
                this.infoLines = [];
                this.totalTime = 0;
                this.totalTick = 0;
                this.lastTime = 0;
                this.drawCalls = 0;
                this.dirtyRatio = 0;
                this.costDirty = 0;
                this.costRender = 0;
                this.costTicker = 0;
                this._stage = stage;
                this.showFPS = showFPS;
                this.showLog = showLog;
                this.logFilter = logFilter;
                this.touchChildren = false;
                this.touchEnabled = false;
                this.styles = styles;
                this.fpsDisplay = new egret.FPSDisplay(stage, showFPS, showLog, logFilter, styles);
                this.addChild(this.fpsDisplay);
                var logFilterRegExp;
                try {
                    logFilterRegExp = logFilter ? new RegExp(logFilter) : null;
                }
                catch (e) {
                    egret.log(e);
                }
                this.filter = function (message) {
                    if (logFilterRegExp)
                        return logFilterRegExp.test(message);
                    return !logFilter || message.indexOf(logFilter) == 0;
                };
            }
            FPSImpl.prototype.update = function (drawCalls, dirtyRatio, costDirty, costRender, costTicker) {
                var current = egret.getTimer();
                this.totalTime += current - this.lastTime;
                this.lastTime = current;
                this.totalTick++;
                this.drawCalls += drawCalls;
                this.dirtyRatio += dirtyRatio;
                this.costDirty += costDirty;
                this.costRender += costRender;
                this.costTicker += costTicker;
                if (this.totalTime >= 1000) {
                    var lastFPS = Math.min(Math.ceil(this.totalTick * 1000 / this.totalTime), egret.ticker.$frameRate);
                    var lastDrawCalls = Math.round(this.drawCalls / this.totalTick);
                    var lastDirtyRatio = Math.round(this.dirtyRatio / this.totalTick);
                    var lastCostDirty = Math.round(this.costDirty / this.totalTick);
                    var lastCostRender = Math.round(this.costRender / this.totalTick);
                    var lastCostTicker = Math.round(this.costTicker / this.totalTick);
                    this.fpsDisplay.update({
                        fps: lastFPS,
                        draw: lastDrawCalls,
                        dirty: lastDirtyRatio,
                        costTicker: lastCostTicker,
                        costDirty: lastCostDirty,
                        costRender: lastCostRender
                    });
                    this.totalTick = 0;
                    this.totalTime = this.totalTime % 1000;
                    this.drawCalls = 0;
                    this.dirtyRatio = 0;
                    this.costDirty = 0;
                    this.costRender = 0;
                    this.costTicker = 0;
                }
            };
            FPSImpl.prototype.updateInfo = function (info) {
                if (!info) {
                    return;
                }
                if (!this.showLog) {
                    return;
                }
                if (!this.filter(info)) {
                    return;
                }
                this.fpsDisplay.updateInfo(info);
            };
            return FPSImpl;
        })(egret.Sprite);
        function toArray(argument) {
            var args = [];
            for (var i = 0; i < argument.length; i++) {
                args.push(argument[i]);
            }
            return args;
        }
        egret.warn = function () {
            console.warn.apply(console, toArray(arguments));
        };
        egret.error = function () {
            console.error.apply(console, toArray(arguments));
        };
        egret.assert = function () {
            console.assert.apply(console, toArray(arguments));
        };
        egret.log = function () {
            console.log.apply(console, toArray(arguments));
        };
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * OrientationMode ็ฑปไธบ่ๅฐๅๅงๆ่ฝฌๆจกๅผๆไพๅผใ
     */
    egret.OrientationMode = {
        /**
         * ้้ๅฑๅน
         */
        AUTO: "auto",
        /**
         * ้ป่ฎค็ซๅฑ
         */
        PORTRAIT: "portrait",
        /**
         * ้ป่ฎคๆจชๅฑ๏ผ่ๅฐ้กบๆถ้ๆ่ฝฌ90ๅบฆ
         */
        LANDSCAPE: "landscape",
        /**
         * ้ป่ฎคๆจชๅฑ๏ผ่ๅฐ้ๆถ้ๆ่ฝฌ90ๅบฆ
         */
        LANDSCAPE_FLIPPED: "landscapeFlipped"
    };
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        var regionPool = [];
        /**
         * @private
         */
        var Region = (function () {
            function Region() {
                /**
                 * @private
                 */
                this.minX = 0;
                /**
                 * @private
                 */
                this.minY = 0;
                /**
                 * @private
                 */
                this.maxX = 0;
                /**
                 * @private
                 */
                this.maxY = 0;
                /**
                 * @private
                 */
                this.width = 0;
                /**
                 * @private
                 */
                this.height = 0;
                /**
                 * @private
                 */
                this.area = 0;
                /**
                 * @private
                 * ๆฏๅฆๅ็็งปๅจ
                 */
                this.moved = false;
            }
            /**
             * @private
             * ้ๆพไธไธชRegionๅฎไพๅฐๅฏน่ฑกๆฑ
             */
            Region.release = function (region) {
                regionPool.push(region);
            };
            /**
             * @private
             * ไปๅฏน่ฑกๆฑไธญๅๅบๆๅๅปบไธไธชๆฐ็Regionๅฏน่ฑกใ
             * ๅปบ่ฎฎๅฏนไบไธๆฌกๆงไฝฟ็จ็ๅฏน่ฑก๏ผๅไฝฟ็จๆญคๆนๆณๅๅปบ๏ผ่ไธๆฏ็ดๆฅnewไธไธชใ
             * ไฝฟ็จๅฎๅ่ฐ็จๅฏนๅบ็release()้ๆๆนๆณๅๆถๅฏน่ฑก๏ผ่ฝๆๆๅๅฐๅฏน่ฑกๅๅปบๆฐ้้ๆ็ๆง่ฝๅผ้ใ
             */
            Region.create = function () {
                var region = regionPool.pop();
                if (!region) {
                    region = new Region();
                }
                return region;
            };
            /**
             * @private
             */
            Region.prototype.setTo = function (minX, minY, maxX, maxY) {
                this.minX = minX;
                this.minY = minY;
                this.maxX = maxX;
                this.maxY = maxY;
                this.updateArea();
                return this;
            };
            /**
             * @private
             * ๆๆๆๅผ้ฝๅๆด
             */
            Region.prototype.intValues = function () {
                this.minX = Math.floor(this.minX);
                this.minY = Math.floor(this.minY);
                this.maxX = Math.ceil(this.maxX);
                this.maxY = Math.ceil(this.maxY);
                this.updateArea();
            };
            /**
             * @private
             */
            Region.prototype.updateArea = function () {
                this.width = this.maxX - this.minX;
                this.height = this.maxY - this.minY;
                this.area = this.width * this.height;
            };
            /**
             * @private
             * ๆณจๆ๏ผ็ฑไบๆง่ฝไผๅ๏ผๆญคๆนๆณไธๅคๆญ่ช่บซๆฏๅฆไธบ็ฉบ๏ผๅฟ้กปๅจๅค้จ็กฎ่ฎค่ช่บซๅ็ฎๆๅบๅ้ฝไธไธบ็ฉบๅ่ฐ็จๅๅนถใๅฆๅ็ปๆๅง็ปไป0๏ผ0็นๅผๅงใ
             */
            Region.prototype.union = function (target) {
                if (this.minX > target.minX) {
                    this.minX = target.minX;
                }
                if (this.minY > target.minY) {
                    this.minY = target.minY;
                }
                if (this.maxX < target.maxX) {
                    this.maxX = target.maxX;
                }
                if (this.maxY < target.maxY) {
                    this.maxY = target.maxY;
                }
                this.updateArea();
            };
            /**
             * @private
             * ๆณจๆ๏ผ็ฑไบๆง่ฝไผๅ๏ผๆญคๆนๆณไธๅคๆญ่ช่บซๆฏๅฆไธบ็ฉบ๏ผๅฟ้กปๅจๅค้จ็กฎ่ฎค่ช่บซๅ็ฎๆๅบๅ้ฝไธไธบ็ฉบๅ่ฐ็จๅๅนถใๅฆๅ็ปๆๅง็ปไป0๏ผ0็นๅผๅงใ
             */
            Region.prototype.intersect = function (target) {
                if (this.minX < target.minX) {
                    this.minX = target.minX;
                }
                if (this.maxX > target.maxX) {
                    this.maxX = target.maxX;
                }
                if (this.minX >= this.maxX) {
                    this.setEmpty();
                    return;
                }
                if (this.minY < target.minY) {
                    this.minY = target.minY;
                }
                if (this.maxY > target.maxY) {
                    this.maxY = target.maxY;
                }
                if (this.minY >= this.maxY) {
                    this.setEmpty();
                    return;
                }
                this.updateArea();
            };
            /**
             * @private
             */
            Region.prototype.setEmpty = function () {
                this.minX = 0;
                this.minY = 0;
                this.maxX = 0;
                this.maxY = 0;
                this.width = 0;
                this.height = 0;
                this.area = 0;
            };
            /**
             * @private
             * ็กฎๅฎๆญค Region ๅฏน่ฑกๆฏๅฆไธบ็ฉบใ
             */
            Region.prototype.isEmpty = function () {
                return this.width <= 0 || this.height <= 0;
            };
            /**
             * @private
             */
            Region.prototype.intersects = function (target) {
                if (this.isEmpty()) {
                    return false;
                }
                var max = this.minX > target.minX ? this.minX : target.minX;
                var min = this.maxX < target.maxX ? this.maxX : target.maxX;
                if (max > min) {
                    return false;
                }
                max = this.minY > target.minY ? this.minY : target.minY;
                min = this.maxY < target.maxY ? this.maxY : target.maxY;
                return max <= min;
            };
            /**
             * @private
             */
            Region.prototype.updateRegion = function (bounds, matrix) {
                if (bounds.width == 0 || bounds.height == 0) {
                    //todo ็่ฎบไธๅบ่ฏฅๆฏ็ฉบ
                    this.setEmpty();
                    return;
                }
                var m = matrix;
                var a = m.a;
                var b = m.b;
                var c = m.c;
                var d = m.d;
                var tx = m.tx;
                var ty = m.ty;
                var x = bounds.x;
                var y = bounds.y;
                var xMax = x + bounds.width;
                var yMax = y + bounds.height;
                var minX, minY, maxX, maxY;
                //ไผๅ๏ผ้ๅธธๆๅตไธไธ็ผฉๆพๆ่ฝฌ็ๅฏน่ฑกๅๅคๆฐ๏ผ็ดๆฅๅไธๅ็งป้ๅณๅฏใ
                if (a == 1.0 && b == 0.0 && c == 0.0 && d == 1.0) {
                    minX = x + tx - 1;
                    minY = y + ty - 1;
                    maxX = xMax + tx + 1;
                    maxY = yMax + ty + 1;
                }
                else {
                    var x0 = a * x + c * y + tx;
                    var y0 = b * x + d * y + ty;
                    var x1 = a * xMax + c * y + tx;
                    var y1 = b * xMax + d * y + ty;
                    var x2 = a * xMax + c * yMax + tx;
                    var y2 = b * xMax + d * yMax + ty;
                    var x3 = a * x + c * yMax + tx;
                    var y3 = b * x + d * yMax + ty;
                    var tmp = 0;
                    if (x0 > x1) {
                        tmp = x0;
                        x0 = x1;
                        x1 = tmp;
                    }
                    if (x2 > x3) {
                        tmp = x2;
                        x2 = x3;
                        x3 = tmp;
                    }
                    minX = (x0 < x2 ? x0 : x2) - 1;
                    maxX = (x1 > x3 ? x1 : x3) + 1;
                    if (y0 > y1) {
                        tmp = y0;
                        y0 = y1;
                        y1 = tmp;
                    }
                    if (y2 > y3) {
                        tmp = y2;
                        y2 = y3;
                        y3 = tmp;
                    }
                    minY = (y0 < y2 ? y0 : y2) - 1;
                    maxY = (y1 > y3 ? y1 : y3) + 1;
                }
                this.minX = minX;
                this.minY = minY;
                this.maxX = maxX;
                this.maxY = maxY;
                this.width = maxX - minX;
                this.height = maxY - minY;
                this.area = this.width * this.height;
            };
            return Region;
        }());
        sys.Region = Region;
        __reflect(Region.prototype, "egret.sys.Region");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๅฑๅน้้ๅจ้ป่ฎคๅฎ็ฐ๏ผๅผๅ่ๅฏไปฅๅฎ็ฐ่ชๅฎไน่งๅ็ๅฑๅน้้ๅจใๅนถๅจๅๅงๅๅ่ฝฝๆถๅฐ้้ๅจ็ๅฎไพ่ตๅผ็ปegret.sys.screenAdapterไธ๏ผไป่ๆฟๆขๆ้ป่ฎค้้ๅจใ
         */
        var DefaultScreenAdapter = (function (_super) {
            __extends(DefaultScreenAdapter, _super);
            /**
             * @private
             */
            function DefaultScreenAdapter() {
                return _super.call(this) || this;
            }
            /**
             * @private
             * ่ฎก็ฎ่ๅฐๆพ็คบๅฐบๅฏธ
             * @param scaleMode ๅฝๅ็็ผฉๆพๆจกๅผ
             * @param screenWidth ๆญๆพๅจ่งๅฃๅฎฝๅบฆ
             * @param screenHeight ๆญๆพๅจ่งๅฃ้ซๅบฆ
             * @param contentWidth ๅๅงๅๅๅฎนๅฎฝๅบฆ
             * @param contentHeight ๅๅงๅๅๅฎน้ซๅบฆ
             */
            DefaultScreenAdapter.prototype.calculateStageSize = function (scaleMode, screenWidth, screenHeight, contentWidth, contentHeight) {
                var displayWidth = screenWidth;
                var displayHeight = screenHeight;
                var stageWidth = contentWidth;
                var stageHeight = contentHeight;
                var scaleX = (screenWidth / stageWidth) || 0;
                var scaleY = (screenHeight / stageHeight) || 0;
                switch (scaleMode) {
                    case egret.StageScaleMode.EXACT_FIT:
                        break;
                    case egret.StageScaleMode.FIXED_HEIGHT:
                        stageWidth = Math.round(screenWidth / scaleY);
                        break;
                    case egret.StageScaleMode.FIXED_WIDTH:
                        stageHeight = Math.round(screenHeight / scaleX);
                        break;
                    case egret.StageScaleMode.NO_BORDER:
                        if (scaleX > scaleY) {
                            displayHeight = Math.round(stageHeight * scaleX);
                        }
                        else {
                            displayWidth = Math.round(stageWidth * scaleY);
                        }
                        break;
                    case egret.StageScaleMode.SHOW_ALL:
                        if (scaleX > scaleY) {
                            displayWidth = Math.round(stageWidth * scaleY);
                        }
                        else {
                            displayHeight = Math.round(stageHeight * scaleX);
                        }
                        break;
                    case egret.StageScaleMode.FIXED_NARROW:
                        if (scaleX > scaleY) {
                            stageWidth = Math.round(screenWidth / scaleY);
                        }
                        else {
                            stageHeight = Math.round(screenHeight / scaleX);
                        }
                        break;
                    case egret.StageScaleMode.FIXED_WIDE:
                        if (scaleX > scaleY) {
                            stageHeight = Math.round(screenHeight / scaleX);
                        }
                        else {
                            stageWidth = Math.round(screenWidth / scaleY);
                        }
                        break;
                    default:
                        stageWidth = screenWidth;
                        stageHeight = screenHeight;
                        break;
                }
                //ๅฎฝ้ซไธๆฏ2็ๆดๆฐๅไผๅฏผ่ดๅพ็็ปๅถๅบ็ฐ้ฎ้ข
                if (stageWidth % 2 != 0) {
                    stageWidth += 1;
                }
                if (stageHeight % 2 != 0) {
                    stageHeight += 1;
                }
                if (displayWidth % 2 != 0) {
                    displayWidth += 1;
                }
                if (displayHeight % 2 != 0) {
                    displayHeight += 1;
                }
                return {
                    stageWidth: stageWidth,
                    stageHeight: stageHeight,
                    displayWidth: displayWidth,
                    displayHeight: displayHeight
                };
            };
            return DefaultScreenAdapter;
        }(egret.HashObject));
        sys.DefaultScreenAdapter = DefaultScreenAdapter;
        __reflect(DefaultScreenAdapter.prototype, "egret.sys.DefaultScreenAdapter", ["egret.sys.IScreenAdapter"]);
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * StageScaleMode class provides values for the stage zoom mode.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/player/StageScaleMode.ts
     * @language en_US
     */
    /**
     * StageScaleMode ็ฑปไธบ่ๅฐ็ผฉๆพๆจกๅผๆไพๅผใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/player/StageScaleMode.ts
     * @language zh_CN
     */
    var StageScaleMode = (function () {
        function StageScaleMode() {
        }
        /**
         * Do not scale application content. Even when you change the player viewport size, it remains unchanged. If the player is smaller than the viewport content, possibly with some cropping.<br/>
         * In this mode, the stage size (Stage.stageWidth, Stage.stageHeight) always with the player viewport size consistent.
         * @language en_US
         */
        /**
         * ไธ็ผฉๆพๅบ็จ็จๅบๅๅฎนใๅณไฝฟๅจๆดๆนๆญๆพๅจ่งๅฃๅคงๅฐๆถ๏ผๅฎไป็ถไฟๆไธๅใๅฆๆๆญๆพๅจ่งๅฃๆฏๅๅฎนๅฐ๏ผๅๅฏ่ฝ่ฟ่กไธไบ่ฃๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐๅฐบๅฏธ๏ผStage.stageWidth,Stage.stageHeight๏ผๅง็ป่ทๆญๆพๅจ่งๅฃๅคงๅฐไฟๆไธ่ดใ
         * @language zh_CN
         */
        StageScaleMode.NO_SCALE = "noScale";
        /**
         * Keep the original aspect ratio scaling application content, after scaling a wide directions application content to fill the viewport players on both sides in the other direction may not be wide enough and left black bars.<br/>
         * In this mode, the stage size (Stage.stageWidth, Stage.stageHeight) is always equal to the initialization incoming external application content size.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎน็่พๅฎฝๆนๅๅกซๆปกๆญๆพๅจ่งๅฃ๏ผๅฆไธไธชๆนๅ็ไธคไพงๅฏ่ฝไผไธๅคๅฎฝ่็ๆ้ป่พนใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐๅฐบๅฏธ(Stage.stageWidth,Stage.stageHeight)ๅง็ป็ญไบๅๅงๅๆถๅค้จไผๅฅ็ๅบ็จ็จๅบๅๅฎนๅฐบๅฏธใ
         * @language zh_CN
         */
        StageScaleMode.SHOW_ALL = "showAll";
        /**
         * Keep the original aspect ratio scaling application content, after scaling a narrow direction of application content to fill the viewport players on both sides in the other direction may exceed the viewport and the player is cut.<br/>
         * In this mode, the stage size (Stage.stageWidth, Stage.stageHeight) is always equal to the initialization incoming external application content size.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎน็่พ็ชๆนๅๅกซๆปกๆญๆพๅจ่งๅฃ๏ผๅฆไธไธชๆนๅ็ไธคไพงๅฏ่ฝไผ่ถๅบๆญๆพๅจ่งๅฃ่่ขซ่ฃๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐๅฐบๅฏธ(Stage.stageWidth,Stage.stageHeight)ๅง็ป็ญไบๅๅงๅๆถๅค้จไผๅฅ็ๅบ็จ็จๅบๅๅฎนๅฐบๅฏธใ
         * @language zh_CN
         */
        StageScaleMode.NO_BORDER = "noBorder";
        /**
         * Do not keep the original aspect ratio scaling application content, after scaling application content just fill the player viewport.<br/>
         * In this mode, the stage size (Stage.stageWidth, Stage.stageHeight) is always equal to the initialization incoming external application content size.
         * @language en_US
         */
        /**
         * ไธไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๆญฃๅฅฝๅกซๆปกๆญๆพๅจ่งๅฃใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐๅฐบๅฏธ(Stage.stageWidth,Stage.stageHeight)ๅง็ป็ญไบๅๅงๅๆถๅค้จไผๅฅ็ๅบ็จ็จๅบๅๅฎนๅฐบๅฏธใ
         * @language zh_CN
         */
        StageScaleMode.EXACT_FIT = "exactFit";
        /**
         * Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player, but only to keep the contents of the original application constant width, height may change.<br/>
         * In this mode, the stage width (Stage.stageWidth) is always equal to initialize external incoming application content width. Stage height (Stage.stageHeight) by the current scale with the player viewport height decision.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผไฝๅชไฟๆๅบ็จ็จๅบๅๅฎน็ๅๅงๅฎฝๅบฆไธๅ๏ผ้ซๅบฆๅฏ่ฝไผๆนๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐๅฎฝๅบฆ(Stage.stageWidth)ๅง็ป็ญไบๅๅงๅๆถๅค้จไผๅฅ็ๅบ็จ็จๅบๅๅฎนๅฎฝๅบฆใ่ๅฐ้ซๅบฆ(Stage.stageHeight)็ฑๅฝๅ็็ผฉๆพๆฏไพไธๆญๆพๅจ่งๅฃ้ซๅบฆๅณๅฎใ
         * @language zh_CN
         */
        StageScaleMode.FIXED_WIDTH = "fixedWidth";
        /**
         * Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player, but only to keep the contents of the original application constant height, width may change.<br/>
         * In this mode, the stage height (Stage.stageHeight) is always equal to initialize external incoming application content height. Stage width (Stage.stageWidth) by the current scale with the player viewport width decision.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผไฝๅชไฟๆๅบ็จ็จๅบๅๅฎน็ๅๅง้ซๅบฆไธๅ๏ผๅฎฝๅบฆๅฏ่ฝไผๆนๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐ้ซๅบฆ(Stage.stageHeight)ๅง็ป็ญไบๅๅงๅๆถๅค้จไผๅฅ็ๅบ็จ็จๅบๅๅฎน้ซๅบฆใ่ๅฐๅฎฝๅบฆ(Stage.stageWidth)็ฑๅฝๅ็็ผฉๆพๆฏไพไธๆญๆพๅจ่งๅฃๅฎฝๅบฆๅณๅฎใ
         * @language zh_CN
         */
        StageScaleMode.FIXED_HEIGHT = "fixedHeight";
        /**
         * Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player,a narrow direction may not be wide enough and fill.<br/>
         * In this mode, the stage height (Stage.stageHeight) and the stage width (Stage.stageWidth) by the current scale with the player viewport size.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผๅบ็จ็จๅบๅๅฎน็่พ็ชๆนๅๅฏ่ฝไผไธๅคๅฎฝ่ๅกซๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐ้ซๅบฆ(Stage.stageHeight)ๅ่ๅฐๅฎฝๅบฆ(Stage.stageWidth)็ฑๅฝๅ็็ผฉๆพๆฏไพไธๆญๆพๅจ่งๅฃๅฎฝ้ซๅณๅฎใ
         * @language zh_CN
         */
        StageScaleMode.FIXED_NARROW = "fixedNarrow";
        /**
         * Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player, a wide direction may exceed the viewport and the player is cut.<br/>
         * In this mode, the stage height (Stage.stageHeight) and the stage width (Stage.stageWidth) by the current scale with the player viewport size.
         * @language en_US
         */
        /**
         * ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผๅบ็จ็จๅบๅๅฎน็่พๅฎฝๆนๅ็ไธคไพงๅฏ่ฝไผ่ถๅบๆญๆพๅจ่งๅฃ่่ขซ่ฃๅใ<br/>
         * ๅจๆญคๆจกๅผไธ๏ผ่ๅฐ้ซๅบฆ(Stage.stageHeight)ๅ่ๅฐๅฎฝๅบฆ(Stage.stageWidth)็ฑๅฝๅ็็ผฉๆพๆฏไพไธๆญๆพๅจ่งๅฃๅฎฝ้ซๅณๅฎใ
         * @language zh_CN
         */
        StageScaleMode.FIXED_WIDE = "fixedWide";
        return StageScaleMode;
    }());
    egret.StageScaleMode = StageScaleMode;
    __reflect(StageScaleMode.prototype, "egret.StageScaleMode");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         */
        sys.$START_TIME = 0;
        /**
         * @private
         * ๆฏๅฆ่ฆๅนฟๆญEvent.RENDERไบไปถ็ๆๅฟใ
         */
        sys.$invalidateRenderFlag = false;
        /**
         * @private
         * ้่ฆ็ซๅณๅทๆฐๅฑๅน็ๆๅฟ
         */
        sys.$requestRenderingFlag = false;
        /**
         * Egretๅฟ่ทณ่ฎกๆถๅจ
         */
        var SystemTicker = (function () {
            /**
             * @private
             */
            function SystemTicker() {
                /**
                 * @private
                 */
                this.playerList = [];
                /**
                 * @private
                 */
                this.callBackList = [];
                /**
                 * @private
                 */
                this.thisObjectList = [];
                /**
                 * @private
                 * ๅจๅฑๅธง็
                 */
                this.$frameRate = 30;
                /**
                 * @private
                 */
                this.lastTimeStamp = 0;
                /**
                 * @private
                 * ticker ่ฑ้็ๆถ้ด
                 */
                this.costEnterFrame = 0;
                /**
                 * @private
                 * ๆฏๅฆ่ขซๆๅ
                 */
                this.isPaused = false;
                if (true && egret.ticker) {
                    egret.$error(1008, "egret.sys.SystemTicker");
                }
                sys.$START_TIME = Date.now();
                this.frameDeltaTime = 1000 / this.$frameRate;
                this.lastCount = this.frameInterval = Math.round(60000 / this.$frameRate);
            }
            /**
             * @private
             * ๆณจๅไธไธชๆญๆพๅจๅฎไพๅนถ่ฟ่ก
             */
            SystemTicker.prototype.$addPlayer = function (player) {
                if (this.playerList.indexOf(player) != -1) {
                    return;
                }
                if (true) {
                    egret_stages.push(player.stage);
                }
                this.playerList = this.playerList.concat();
                this.playerList.push(player);
            };
            /**
             * @private
             * ๅๆญขไธไธชๆญๆพๅจๅฎไพ็่ฟ่กใ
             */
            SystemTicker.prototype.$removePlayer = function (player) {
                var index = this.playerList.indexOf(player);
                if (index !== -1) {
                    if (true) {
                        var i = egret_stages.indexOf(player.stage);
                        egret_stages.splice(i, 1);
                    }
                    this.playerList = this.playerList.concat();
                    this.playerList.splice(index, 1);
                }
            };
            /**
             * @private
             */
            SystemTicker.prototype.$startTick = function (callBack, thisObject) {
                var index = this.getTickIndex(callBack, thisObject);
                if (index != -1) {
                    return;
                }
                this.concatTick();
                this.callBackList.push(callBack);
                this.thisObjectList.push(thisObject);
            };
            /**
             * @private
             */
            SystemTicker.prototype.$stopTick = function (callBack, thisObject) {
                var index = this.getTickIndex(callBack, thisObject);
                if (index == -1) {
                    return;
                }
                this.concatTick();
                this.callBackList.splice(index, 1);
                this.thisObjectList.splice(index, 1);
            };
            /**
             * @private
             */
            SystemTicker.prototype.getTickIndex = function (callBack, thisObject) {
                var callBackList = this.callBackList;
                var thisObjectList = this.thisObjectList;
                for (var i = callBackList.length - 1; i >= 0; i--) {
                    if (callBackList[i] == callBack &&
                        thisObjectList[i] == thisObject) {
                        return i;
                    }
                }
                return -1;
            };
            /**
             * @private
             *
             */
            SystemTicker.prototype.concatTick = function () {
                this.callBackList = this.callBackList.concat();
                this.thisObjectList = this.thisObjectList.concat();
            };
            /**
             * @private
             * ่ฎพ็ฝฎๅจๅฑๅธง็
             */
            SystemTicker.prototype.$setFrameRate = function (value) {
                value = +value || 0;
                if (value <= 0) {
                    return false;
                }
                if (this.$frameRate == value) {
                    return false;
                }
                this.$frameRate = value;
                if (value > 60) {
                    value = 60;
                }
                //todo
                if (egret.Capabilities.runtimeType == egret.RuntimeType.NATIVE) {
                    egret_native.setFrameRate(value);
                    value = 60;
                }
                this.frameDeltaTime = 1000 / value;
                //่ฟ้็จ60*1000ๆฅ้ฟๅๆตฎ็นๆฐ่ฎก็ฎไธๅ็กฎ็้ฎ้ขใ
                this.lastCount = this.frameInterval = Math.round(60000 / value);
                return true;
            };
            /**
             * Pause the ticker.
             * @version Egret 5.0.2
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅๅฟ่ทณ
             * @version Egret 5.0.2
             * @platform Web,Native
             * @language zh_CN
             */
            SystemTicker.prototype.pause = function () {
                this.isPaused = true;
            };
            /**
             * Resume the ticker.
             * @version Egret 5.0.2
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆขๅคๅฟ่ทณ
             * @version Egret 5.0.2
             * @platform Web,Native
             * @language zh_CN
             */
            SystemTicker.prototype.resume = function () {
                this.isPaused = false;
            };
            /**
             * @private
             * ๆง่กไธๆฌกๅทๆฐ
             */
            SystemTicker.prototype.update = function () {
                var t1 = egret.getTimer();
                var callBackList = this.callBackList;
                var thisObjectList = this.thisObjectList;
                var length = callBackList.length;
                var requestRenderingFlag = sys.$requestRenderingFlag;
                var timeStamp = egret.getTimer();
                var contexts = egret.lifecycle.contexts;
                for (var _i = 0, contexts_1 = contexts; _i < contexts_1.length; _i++) {
                    var c = contexts_1[_i];
                    if (c.onUpdate) {
                        c.onUpdate();
                    }
                }
                if (this.isPaused) {
                    this.lastTimeStamp = timeStamp;
                    return;
                }
                this.callLaterAsyncs();
                for (var i = 0; i < length; i++) {
                    if (callBackList[i].call(thisObjectList[i], timeStamp)) {
                        requestRenderingFlag = true;
                    }
                }
                var t2 = egret.getTimer();
                var deltaTime = timeStamp - this.lastTimeStamp;
                this.lastTimeStamp = timeStamp;
                if (deltaTime >= this.frameDeltaTime) {
                    this.lastCount = this.frameInterval;
                }
                else {
                    this.lastCount -= 1000;
                    if (this.lastCount > 0) {
                        if (requestRenderingFlag) {
                            this.render(false, this.costEnterFrame + t2 - t1);
                        }
                        return;
                    }
                    this.lastCount += this.frameInterval;
                }
                this.render(true, this.costEnterFrame + t2 - t1);
                var t3 = egret.getTimer();
                this.broadcastEnterFrame();
                var t4 = egret.getTimer();
                this.costEnterFrame = t4 - t3;
            };
            /**
             * @private
             * ๆง่กไธๆฌกๅฑๅนๆธฒๆ
             */
            SystemTicker.prototype.render = function (triggerByFrame, costTicker) {
                var playerList = this.playerList;
                var length = playerList.length;
                if (length == 0) {
                    return;
                }
                this.callLaters();
                if (sys.$invalidateRenderFlag) {
                    this.broadcastRender();
                    sys.$invalidateRenderFlag = false;
                }
                for (var i = 0; i < length; i++) {
                    playerList[i].$render(triggerByFrame, costTicker);
                }
                sys.$requestRenderingFlag = false;
            };
            /**
             * @private
             * ๅนฟๆญEnterFrameไบไปถใ
             */
            SystemTicker.prototype.broadcastEnterFrame = function () {
                var list = egret.DisplayObject.$enterFrameCallBackList;
                var length = list.length;
                if (length == 0) {
                    return;
                }
                list = list.concat();
                for (var i = 0; i < length; i++) {
                    list[i].dispatchEventWith(egret.Event.ENTER_FRAME);
                }
            };
            /**
             * @private
             * ๅนฟๆญRenderไบไปถใ
             */
            SystemTicker.prototype.broadcastRender = function () {
                var list = egret.DisplayObject.$renderCallBackList;
                var length = list.length;
                if (length == 0) {
                    return;
                }
                list = list.concat();
                for (var i = 0; i < length; i++) {
                    list[i].dispatchEventWith(egret.Event.RENDER);
                }
            };
            /**
             * @private
             */
            SystemTicker.prototype.callLaters = function () {
                var functionList;
                var thisList;
                var argsList;
                if (egret.$callLaterFunctionList.length > 0) {
                    functionList = egret.$callLaterFunctionList;
                    egret.$callLaterFunctionList = [];
                    thisList = egret.$callLaterThisList;
                    egret.$callLaterThisList = [];
                    argsList = egret.$callLaterArgsList;
                    egret.$callLaterArgsList = [];
                }
                if (functionList) {
                    var length_6 = functionList.length;
                    for (var i = 0; i < length_6; i++) {
                        var func = functionList[i];
                        if (func != null) {
                            func.apply(thisList[i], argsList[i]);
                        }
                    }
                }
            };
            /**
             * @private
             */
            SystemTicker.prototype.callLaterAsyncs = function () {
                if (egret.$callAsyncFunctionList.length > 0) {
                    var locCallAsyncFunctionList = egret.$callAsyncFunctionList;
                    var locCallAsyncThisList = egret.$callAsyncThisList;
                    var locCallAsyncArgsList = egret.$callAsyncArgsList;
                    egret.$callAsyncFunctionList = [];
                    egret.$callAsyncThisList = [];
                    egret.$callAsyncArgsList = [];
                    for (var i = 0; i < locCallAsyncFunctionList.length; i++) {
                        var func = locCallAsyncFunctionList[i];
                        if (func != null) {
                            func.apply(locCallAsyncThisList[i], locCallAsyncArgsList[i]);
                        }
                    }
                }
            };
            return SystemTicker;
        }());
        sys.SystemTicker = SystemTicker;
        __reflect(SystemTicker.prototype, "egret.sys.SystemTicker");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
(function (egret) {
    /**
     * ๅฟ่ทณ่ฎกๆถๅจๅไพ
     */
    egret.$ticker = new egret.sys.SystemTicker();
    var lifecycle;
    (function (lifecycle) {
        /**
         * @private
         */
        lifecycle.contexts = [];
        var isActivate = true;
        var LifecycleContext = (function () {
            function LifecycleContext() {
            }
            LifecycleContext.prototype.pause = function () {
                if (isActivate) {
                    isActivate = false;
                    lifecycle.stage.dispatchEvent(new egret.Event(egret.Event.DEACTIVATE));
                    if (lifecycle.onPause) {
                        lifecycle.onPause();
                    }
                }
            };
            LifecycleContext.prototype.resume = function () {
                if (!isActivate) {
                    isActivate = true;
                    lifecycle.stage.dispatchEvent(new egret.Event(egret.Event.ACTIVATE));
                    if (lifecycle.onResume) {
                        lifecycle.onResume();
                    }
                }
            };
            return LifecycleContext;
        }());
        lifecycle.LifecycleContext = LifecycleContext;
        __reflect(LifecycleContext.prototype, "egret.lifecycle.LifecycleContext");
        function addLifecycleListener(plugin) {
            var context = new LifecycleContext();
            lifecycle.contexts.push(context);
            plugin(context);
        }
        lifecycle.addLifecycleListener = addLifecycleListener;
    })(lifecycle = egret.lifecycle || (egret.lifecycle = {}));
    egret.ticker = new egret.sys.SystemTicker();
})(egret || (egret = {}));
if (true) {
    egret_stages = [];
}
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ็จๆทไบคไบๆไฝ็ฎก็ๅจ
         */
        var TouchHandler = (function (_super) {
            __extends(TouchHandler, _super);
            /**
             * @private
             */
            function TouchHandler(stage) {
                var _this = _super.call(this) || this;
                _this.maxTouches = 0;
                _this.useTouchesCount = 0;
                /**
                 * @private
                 */
                _this.touchDownTarget = {};
                /**
                 * @private
                 */
                _this.lastTouchX = -1;
                /**
                 * @private
                 */
                _this.lastTouchY = -1;
                _this.stage = stage;
                return _this;
            }
            /**
             * @private
             * ่ฎพ็ฝฎๅๆถ่งฆๆธๆฐ้
             */
            TouchHandler.prototype.$initMaxTouches = function () {
                this.maxTouches = this.stage.$maxTouches;
            };
            /**
             * @private
             * ่งฆๆธๅผๅง๏ผๆไธ๏ผ
             * @param x ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆx
             * @param y ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆy
             * @param touchPointID ๅ้็ป่งฆๆธ็น็ๅฏไธๆ่ฏๅท
             */
            TouchHandler.prototype.onTouchBegin = function (x, y, touchPointID) {
                if (this.useTouchesCount >= this.maxTouches) {
                    return;
                }
                this.lastTouchX = x;
                this.lastTouchY = y;
                var target = this.findTarget(x, y);
                if (this.touchDownTarget[touchPointID] == null) {
                    this.touchDownTarget[touchPointID] = target;
                    this.useTouchesCount++;
                }
                egret.TouchEvent.dispatchTouchEvent(target, egret.TouchEvent.TOUCH_BEGIN, true, true, x, y, touchPointID, true);
            };
            /**
             * @private
             * ่งฆๆธ็งปๅจ
             * @param x ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆx
             * @param y ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆy
             * @param touchPointID ๅ้็ป่งฆๆธ็น็ๅฏไธๆ่ฏๅท
             */
            TouchHandler.prototype.onTouchMove = function (x, y, touchPointID) {
                if (this.touchDownTarget[touchPointID] == null) {
                    return;
                }
                if (this.lastTouchX == x && this.lastTouchY == y) {
                    return;
                }
                this.lastTouchX = x;
                this.lastTouchY = y;
                var target = this.findTarget(x, y);
                egret.TouchEvent.dispatchTouchEvent(target, egret.TouchEvent.TOUCH_MOVE, true, true, x, y, touchPointID, true);
            };
            /**
             * @private
             * ่งฆๆธ็ปๆ๏ผๅผน่ตท๏ผ
             * @param x ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆx
             * @param y ไบไปถๅ็ๅค็ธๅฏนไบ่ๅฐ็ๅๆy
             * @param touchPointID ๅ้็ป่งฆๆธ็น็ๅฏไธๆ่ฏๅท
             */
            TouchHandler.prototype.onTouchEnd = function (x, y, touchPointID) {
                if (this.touchDownTarget[touchPointID] == null) {
                    return;
                }
                var target = this.findTarget(x, y);
                var oldTarget = this.touchDownTarget[touchPointID];
                delete this.touchDownTarget[touchPointID];
                this.useTouchesCount--;
                egret.TouchEvent.dispatchTouchEvent(target, egret.TouchEvent.TOUCH_END, true, true, x, y, touchPointID, false);
                if (oldTarget == target) {
                    egret.TouchEvent.dispatchTouchEvent(target, egret.TouchEvent.TOUCH_TAP, true, true, x, y, touchPointID, false);
                }
                else {
                    egret.TouchEvent.dispatchTouchEvent(oldTarget, egret.TouchEvent.TOUCH_RELEASE_OUTSIDE, true, true, x, y, touchPointID, false);
                }
            };
            /**
             * @private
             * ่ทๅ่ๅฐๅๆไธ็่งฆๆธๅฏน่ฑก
             */
            TouchHandler.prototype.findTarget = function (stageX, stageY) {
                var target = this.stage.$hitTest(stageX, stageY);
                if (!target) {
                    target = this.stage;
                }
                return target;
            };
            return TouchHandler;
        }(egret.HashObject));
        sys.TouchHandler = TouchHandler;
        __reflect(TouchHandler.prototype, "egret.sys.TouchHandler");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ไฝๅพๆธฒๆ่็น
         */
        var BitmapNode = (function (_super) {
            __extends(BitmapNode, _super);
            function BitmapNode() {
                var _this = _super.call(this) || this;
                /**
                 * ่ฆ็ปๅถ็ไฝๅพ
                 */
                _this.image = null;
                /**
                 * ๆงๅถๅจ็ผฉๆพๆถๆฏๅฆๅฏนไฝๅพ่ฟ่กๅนณๆปๅค็ใ
                 */
                _this.smoothing = true;
                /**
                 * ไฝฟ็จ็ๆททๅๆจกๅผ
                 */
                _this.blendMode = null;
                /**
                 * ็ธๅฏน้ๆๅบฆ
                 */
                _this.alpha = NaN;
                /**
                 * ้ข่ฒๅๆขๆปค้
                 */
                _this.filter = null;
                /**
                 * ็ฟป่ฝฌ
                 */
                _this.rotated = false;
                _this.type = 1 /* BitmapNode */;
                return _this;
            }
            /**
             * ็ปๅถไธๆฌกไฝๅพ
             */
            BitmapNode.prototype.drawImage = function (sourceX, sourceY, sourceW, sourceH, drawX, drawY, drawW, drawH) {
                this.drawData.push(sourceX, sourceY, sourceW, sourceH, drawX, drawY, drawW, drawH);
                this.renderCount++;
            };
            /**
             * ๅจๆพ็คบๅฏน่ฑก็$render()ๆนๆณ่ขซ่ฐ็จๅ๏ผ่ชๅจๆธ็ฉบ่ช่บซ็drawDataๆฐๆฎใ
             */
            BitmapNode.prototype.cleanBeforeRender = function () {
                _super.prototype.cleanBeforeRender.call(this);
                this.image = null;
                this.matrix = null;
                this.blendMode = null;
                this.alpha = NaN;
                this.filter = null;
            };
            BitmapNode.$updateTextureData = function (node, image, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, destW, destH, sourceWidth, sourceHeight, scale9Grid, fillMode, smoothing) {
                if (!image) {
                    return;
                }
                var scale = egret.$TextureScaleFactor;
                node.smoothing = smoothing;
                node.image = image;
                node.imageWidth = sourceWidth;
                node.imageHeight = sourceHeight;
                if (scale9Grid) {
                    BitmapNode.$updateTextureDataWithScale9Grid(node, scale9Grid, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, destW, destH);
                }
                else if (fillMode == egret.BitmapFillMode.SCALE) {
                    var tsX = destW / textureWidth * scale;
                    var tsY = destH / textureHeight * scale;
                    node.drawImage(bitmapX, bitmapY, bitmapWidth, bitmapHeight, tsX * offsetX, tsY * offsetY, tsX * bitmapWidth, tsY * bitmapHeight);
                }
                else if (fillMode == egret.BitmapFillMode.CLIP) {
                    var displayW = Math.min(textureWidth, destW);
                    var displayH = Math.min(textureHeight, destH);
                    var scaledBitmapW = bitmapWidth * scale;
                    var scaledBitmapH = bitmapHeight * scale;
                    BitmapNode.drawClipImage(node, scale, bitmapX, bitmapY, scaledBitmapW, scaledBitmapH, offsetX, offsetY, displayW, displayH);
                }
                else {
                    var scaledBitmapW = bitmapWidth * scale;
                    var scaledBitmapH = bitmapHeight * scale;
                    for (var startX = 0; startX < destW; startX += textureWidth) {
                        for (var startY = 0; startY < destH; startY += textureHeight) {
                            var displayW = Math.min(destW - startX, textureWidth);
                            var displayH = Math.min(destH - startY, textureHeight);
                            BitmapNode.drawClipImage(node, scale, bitmapX, bitmapY, scaledBitmapW, scaledBitmapH, offsetX, offsetY, displayW, displayH, startX, startY);
                        }
                    }
                }
            };
            /**
             * @private
             * ็ปๅถไนๅฎซๆผไฝๅพ
             */
            BitmapNode.$updateTextureDataWithScale9Grid = function (node, scale9Grid, bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, textureWidth, textureHeight, destW, destH) {
                var imageWidth = bitmapWidth;
                var imageHeight = bitmapHeight;
                destW = destW - (textureWidth - bitmapWidth * egret.$TextureScaleFactor);
                destH = destH - (textureHeight - bitmapHeight * egret.$TextureScaleFactor);
                var targetW0 = scale9Grid.x - offsetX;
                var targetH0 = scale9Grid.y - offsetY;
                var sourceW0 = targetW0 / egret.$TextureScaleFactor;
                var sourceH0 = targetH0 / egret.$TextureScaleFactor;
                var sourceW1 = scale9Grid.width / egret.$TextureScaleFactor;
                var sourceH1 = scale9Grid.height / egret.$TextureScaleFactor;
                //้ฒๆญข็ฉบๅฟ็ๆๅตๅบ็ฐใ
                if (sourceH1 == 0) {
                    sourceH1 = 1;
                    if (sourceH0 >= imageHeight) {
                        sourceH0--;
                    }
                }
                if (sourceW1 == 0) {
                    sourceW1 = 1;
                    if (sourceW0 >= imageWidth) {
                        sourceW0--;
                    }
                }
                var sourceX0 = bitmapX;
                var sourceX1 = sourceX0 + sourceW0;
                var sourceX2 = sourceX1 + sourceW1;
                var sourceW2 = imageWidth - sourceW0 - sourceW1;
                var sourceY0 = bitmapY;
                var sourceY1 = sourceY0 + sourceH0;
                var sourceY2 = sourceY1 + sourceH1;
                var sourceH2 = imageHeight - sourceH0 - sourceH1;
                var targetW2 = sourceW2 * egret.$TextureScaleFactor;
                var targetH2 = sourceH2 * egret.$TextureScaleFactor;
                if ((sourceW0 + sourceW2) * egret.$TextureScaleFactor > destW || (sourceH0 + sourceH2) * egret.$TextureScaleFactor > destH) {
                    node.drawImage(bitmapX, bitmapY, bitmapWidth, bitmapHeight, offsetX, offsetY, destW, destH);
                    return;
                }
                var targetX0 = offsetX;
                var targetX1 = targetX0 + targetW0;
                var targetX2 = targetX0 + (destW - targetW2);
                var targetW1 = destW - targetW0 - targetW2;
                var targetY0 = offsetY;
                var targetY1 = targetY0 + targetH0;
                var targetY2 = targetY0 + destH - targetH2;
                var targetH1 = destH - targetH0 - targetH2;
                //
                //             x0     x1     x2
                //          y0 +------+------+------+
                //             |      |      |      | h0
                //             |      |      |      |
                //          y1 +------+------+------+
                //             |      |      |      | h1
                //             |      |      |      |
                //          y2 +------+------+------+
                //             |      |      |      | h2
                //             |      |      |      |
                //             +------+------+------+
                //                w0     w1     w2
                //
                if (sourceH0 > 0) {
                    if (sourceW0 > 0)
                        node.drawImage(sourceX0, sourceY0, sourceW0, sourceH0, targetX0, targetY0, targetW0, targetH0);
                    if (sourceW1 > 0)
                        node.drawImage(sourceX1, sourceY0, sourceW1, sourceH0, targetX1, targetY0, targetW1, targetH0);
                    if (sourceW2 > 0)
                        node.drawImage(sourceX2, sourceY0, sourceW2, sourceH0, targetX2, targetY0, targetW2, targetH0);
                }
                if (sourceH1 > 0) {
                    if (sourceW0 > 0)
                        node.drawImage(sourceX0, sourceY1, sourceW0, sourceH1, targetX0, targetY1, targetW0, targetH1);
                    if (sourceW1 > 0)
                        node.drawImage(sourceX1, sourceY1, sourceW1, sourceH1, targetX1, targetY1, targetW1, targetH1);
                    if (sourceW2 > 0)
                        node.drawImage(sourceX2, sourceY1, sourceW2, sourceH1, targetX2, targetY1, targetW2, targetH1);
                }
                if (sourceH2 > 0) {
                    if (sourceW0 > 0)
                        node.drawImage(sourceX0, sourceY2, sourceW0, sourceH2, targetX0, targetY2, targetW0, targetH2);
                    if (sourceW1 > 0)
                        node.drawImage(sourceX1, sourceY2, sourceW1, sourceH2, targetX1, targetY2, targetW1, targetH2);
                    if (sourceW2 > 0)
                        node.drawImage(sourceX2, sourceY2, sourceW2, sourceH2, targetX2, targetY2, targetW2, targetH2);
                }
            };
            /**
      * @private
      */
            BitmapNode.drawClipImage = function (node, scale, bitmapX, bitmapY, scaledBitmapW, scaledBitmapH, offsetX, offsetY, destW, destH, startX, startY) {
                if (startX === void 0) {
                    startX = 0;
                }
                if (startY === void 0) {
                    startY = 0;
                }
                var offset = offsetX + scaledBitmapW - destW;
                if (offset > 0) {
                    scaledBitmapW -= offset;
                }
                offset = offsetY + scaledBitmapH - destH;
                if (offset > 0) {
                    scaledBitmapH -= offset;
                }
                node.drawImage(bitmapX, bitmapY, scaledBitmapW / scale, scaledBitmapH / scale, startX + offsetX, startY + offsetY, scaledBitmapW, scaledBitmapH);
            };
            return BitmapNode;
        }(sys.RenderNode));
        sys.BitmapNode = BitmapNode;
        __reflect(BitmapNode.prototype, "egret.sys.BitmapNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        var CAPS_STYLES = ["none", "round", "square"];
        var JOINT_STYLES = ["bevel", "miter", "round"];
        /**
         * @private
         * ็ข้ๆธฒๆ่็น
         */
        var GraphicsNode = (function (_super) {
            __extends(GraphicsNode, _super);
            function GraphicsNode() {
                var _this = _super.call(this) || this;
                /**
                 * ่ๆธฒๆๆ่ฎฐ
                 * ๆๆถ่ฐ็จlineStyle,beginFill,beginGradientFillๆ่ฎฐ,ๅฎ้ๅบ่ฏฅdrawๆถๅๆ่ฎฐๅจPath2D
                 */
                _this.dirtyRender = true;
                _this.type = 3 /* GraphicsNode */;
                return _this;
            }
            /**
             * ๆๅฎไธ็ง็ฎๅ็ๅไธ้ข่ฒๅกซๅ๏ผๅจ็ปๅถๆถ่ฏฅๅกซๅๅฐๅจ้ๅๅฏนๅถไป Graphics ๆนๆณ๏ผๅฆ lineTo() ๆ drawCircle()๏ผ็่ฐ็จไธญไฝฟ็จใ
             * @param color ๅกซๅ็้ข่ฒ
             * @param alpha ๅกซๅ็ Alpha ๅผ
             * @param beforePath ๆๅฅๅจๆๅฎ็่ทฏๅพๅฝไปคไนๅ็ปๅถ๏ผ้ๅธธๆฏๆๅฅๅฐๅฝๅๆญฃๅจ็ปๅถ็็บฟๆก่ทฏๅพไนๅ๏ผไปฅ็กฎไฟ็บฟๆกๆปๅจๅกซๅ็ไธๆนใ
             */
            GraphicsNode.prototype.beginFill = function (color, alpha, beforePath) {
                if (alpha === void 0) {
                    alpha = 1;
                }
                var path = new sys.FillPath();
                path.fillColor = color;
                path.fillAlpha = alpha;
                if (beforePath) {
                    var index = this.drawData.lastIndexOf(beforePath);
                    this.drawData.splice(index, 0, path);
                }
                else {
                    this.drawData.push(path);
                }
                return path;
            };
            /**
             * ๆๅฎไธ็ง็ฎๅ็ๅไธ้ข่ฒๅกซๅ๏ผๅจ็ปๅถๆถ่ฏฅๅกซๅๅฐๅจ้ๅๅฏนๅถไป Graphics ๆนๆณ๏ผๅฆ lineTo() ๆ drawCircle()๏ผ็่ฐ็จไธญไฝฟ็จใ
             * ่ฐ็จ clear() ๆนๆณไผๆธ้คๅกซๅใ
             * @param type ็จไบๆๅฎ่ฆไฝฟ็จๅช็งๆธๅ็ฑปๅ็ GradientType ็ฑป็ๅผ๏ผGradientType.LINEAR ๆ GradientType.RADIALใ
             * @param colors ๆธๅไธญไฝฟ็จ็ RGB ๅๅญ่ฟๅถ้ข่ฒๅผ็ๆฐ็ป๏ผไพๅฆ๏ผ็บข่ฒไธบ 0xFF0000๏ผ่่ฒไธบ 0x0000FF๏ผ็ญ็ญ๏ผใๅฏนไบๆฏ็ง้ข่ฒ๏ผ่ฏทๅจ alphas ๅ ratios ๅๆฐไธญๆๅฎๅฏนๅบๅผใ
             * @param alphas colors ๆฐ็ปไธญๅฏนๅบ้ข่ฒ็ alpha ๅผๆฐ็ปใ
             * @param ratios ้ข่ฒๅๅธๆฏ็็ๆฐ็ปใๆๆๅผไธบ 0 ๅฐ 255ใ
             * @param matrix ไธไธช็ฑ egret.Matrix ็ฑปๅฎไน็่ฝฌๆข็ฉ้ตใegret.Matrix ็ฑปๅๆฌ createGradientBox() ๆนๆณ๏ผ้่ฟ่ฏฅๆนๆณๅฏไปฅๆนไพฟๅฐ่ฎพ็ฝฎ็ฉ้ต๏ผไปฅไพฟไธ beginGradientFill() ๆนๆณไธ่ตทไฝฟ็จ
             * @param beforePath ๆๅฅๅจๆๅฎ็่ทฏๅพๅฝไปคไนๅ็ปๅถ๏ผ้ๅธธๆฏๆๅฅๅฐๅฝๅๆญฃๅจ็ปๅถ็็บฟๆก่ทฏๅพไนๅ๏ผไปฅ็กฎไฟ็บฟๆกๆปๅจๅกซๅ็ไธๆนใ
             */
            GraphicsNode.prototype.beginGradientFill = function (type, colors, alphas, ratios, matrix, beforePath) {
                var m = new egret.Matrix();
                if (matrix) {
                    m.a = matrix.a * 819.2;
                    m.b = matrix.b * 819.2;
                    m.c = matrix.c * 819.2;
                    m.d = matrix.d * 819.2;
                    m.tx = matrix.tx;
                    m.ty = matrix.ty;
                }
                else {
                    //้ป่ฎคๅผ
                    m.a = 100;
                    m.d = 100;
                }
                var path = new sys.GradientFillPath();
                path.gradientType = type;
                path.colors = colors;
                path.alphas = alphas;
                path.ratios = ratios;
                path.matrix = m;
                if (beforePath) {
                    var index = this.drawData.lastIndexOf(beforePath);
                    this.drawData.splice(index, 0, path);
                }
                else {
                    this.drawData.push(path);
                }
                return path;
            };
            /**
             * ๆๅฎไธ็ง็บฟๆกๆทๅผไปฅ็จไบ้ๅๅฏน lineTo() ๆ drawCircle() ็ญ Graphics ๆนๆณ็่ฐ็จใ
             * @param thickness ไธไธชๆดๆฐ๏ผไปฅ็นไธบๅไฝ่กจ็คบ็บฟๆก็็ฒ็ป๏ผๆๆๅผไธบ 0 ๅฐ 255ใๅฆๆๆชๆๅฎๆฐๅญ๏ผๆ่ๆชๅฎไน่ฏฅๅๆฐ๏ผๅไธ็ปๅถ็บฟๆกใๅฆๆไผ้็ๅผๅฐไบ 0๏ผๅ้ป่ฎคๅผไธบ 0ใๅผ 0 ่กจ็คบๆ็ป็็ฒ็ป๏ผๆๅคง็ฒ็ปไธบ 255ใๅฆๆไผ้็ๅผๅคงไบ 255๏ผๅ้ป่ฎคๅผไธบ 255ใ
             * @param color ็บฟๆก็ๅๅญ่ฟๅถ้ข่ฒๅผ๏ผไพๅฆ๏ผ็บข่ฒไธบ 0xFF0000๏ผ่่ฒไธบ 0x0000FF ็ญ๏ผใๅฆๆๆชๆๆๅผ๏ผๅ้ป่ฎคๅผไธบ 0x000000๏ผ้ป่ฒ๏ผใๅฏ้ใ
             * @param alpha ่กจ็คบ็บฟๆก้ข่ฒ็ Alpha ๅผ็ๆฐๅญ๏ผๆๆๅผไธบ 0 ๅฐ 1ใๅฆๆๆชๆๆๅผ๏ผๅ้ป่ฎคๅผไธบ 1๏ผ็บฏ่ฒ๏ผใๅฆๆๅผๅฐไบ 0๏ผๅ้ป่ฎคๅผไธบ 0ใๅฆๆๅผๅคงไบ 1๏ผๅ้ป่ฎคๅผไธบ 1ใ
             * @param caps ็จไบๆๅฎ็บฟๆกๆซ็ซฏๅค็ซฏ็น็ฑปๅ็ CapsStyle ็ฑป็ๅผใ้ป่ฎคๅผ๏ผCapsStyle.ROUND
             * @param joints ๆๅฎ็จไบๆ่ง็่ฟๆฅๅค่ง็็ฑปๅใ้ป่ฎคๅผ๏ผJointStyle.ROUND
             * @param miterLimit ็จไบ่กจ็คบๅชๅๆๆฅ็ๆ้ๅผ็ๆฐๅญใ
             */
            GraphicsNode.prototype.lineStyle = function (thickness, color, alpha, caps, joints, miterLimit) {
                if (alpha === void 0) {
                    alpha = 1;
                }
                if (miterLimit === void 0) {
                    miterLimit = 3;
                }
                if (CAPS_STYLES.indexOf(caps) == -1) {
                    caps = "round";
                }
                if (JOINT_STYLES.indexOf(joints) == -1) {
                    joints = "round";
                }
                var path = new sys.StrokePath();
                path.lineWidth = thickness;
                path.lineColor = color;
                path.lineAlpha = alpha;
                path.caps = caps || egret.CapsStyle.ROUND;
                path.joints = joints;
                path.miterLimit = miterLimit;
                this.drawData.push(path);
                return path;
            };
            /**
             * ๆธ็ฉบๆๆ็ผๅญ็็ปๅถๆฐๆฎ
             */
            GraphicsNode.prototype.clear = function () {
                this.drawData.length = 0;
                this.dirtyRender = true;
            };
            /**
             * ่ฆ็็ถ็ฑปๆนๆณ๏ผไธ่ชๅจๆธ็ฉบ็ผๅญ็็ปๅพๆฐๆฎ๏ผๆนไธบๆๅจ่ฐ็จclear()ๆนๆณๆธ็ฉบใ
             */
            GraphicsNode.prototype.cleanBeforeRender = function () {
            };
            /**
             * ๆธ้ค้็ปๅถ็็ผๅญๆฐๆฎ
             */
            GraphicsNode.prototype.clean = function () {
                if (this.$texture) {
                    egret.WebGLUtils.deleteWebGLTexture(this.$texture);
                    this.$texture = null;
                    this.dirtyRender = true;
                }
            };
            return GraphicsNode;
        }(sys.RenderNode));
        sys.GraphicsNode = GraphicsNode;
        __reflect(GraphicsNode.prototype, "egret.sys.GraphicsNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ็ปๆธฒๆ่็น,็จไบ็ปๅๅคไธชๆธฒๆ่็น
         */
        var GroupNode = (function (_super) {
            __extends(GroupNode, _super);
            function GroupNode() {
                var _this = _super.call(this) || this;
                _this.type = 4 /* GroupNode */;
                return _this;
            }
            GroupNode.prototype.addNode = function (node) {
                this.drawData.push(node);
            };
            /**
             * ่ฆ็็ถ็ฑปๆนๆณ๏ผไธ่ชๅจๆธ็ฉบ็ผๅญ็็ปๅพๆฐๆฎ๏ผๆนไธบๆๅจ่ฐ็จclear()ๆนๆณๆธ็ฉบใ
             * ่ฟ้ๅชๆฏๆณๆธ็ฉบ็ปๅถๅฝไปค๏ผๅๆญคไธ่ฐ็จsuper
             */
            GroupNode.prototype.cleanBeforeRender = function () {
                var data = this.drawData;
                for (var i = data.length - 1; i >= 0; i--) {
                    data[i].cleanBeforeRender();
                }
            };
            GroupNode.prototype.$getRenderCount = function () {
                var result = 0;
                var data = this.drawData;
                for (var i = data.length - 1; i >= 0; i--) {
                    result += data[i].$getRenderCount();
                }
                return result;
            };
            return GroupNode;
        }(sys.RenderNode));
        sys.GroupNode = GroupNode;
        __reflect(GroupNode.prototype, "egret.sys.GroupNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * Mesh ๆธฒๆ่็น
         */
        var MeshNode = (function (_super) {
            __extends(MeshNode, _super);
            function MeshNode() {
                var _this = _super.call(this) || this;
                /**
                 * ่ฆ็ปๅถ็ไฝๅพ
                 */
                _this.image = null;
                /**
                 * ๆงๅถๅจ็ผฉๆพๆถๆฏๅฆๅฏนไฝๅพ่ฟ่กๅนณๆปๅค็ใ
                 */
                _this.smoothing = true;
                /**
                 * ้กถ็น็ดขๅผใ
                 */
                _this.bounds = new egret.Rectangle();
                /**
                 * ไฝฟ็จ็ๆททๅๆจกๅผ
                 */
                _this.blendMode = null;
                /**
                 * ็ธๅฏน้ๆๅบฆ
                 */
                _this.alpha = NaN;
                /**
                 * ้ข่ฒๅๆขๆปค้
                 */
                _this.filter = null;
                _this.type = 7 /* MeshNode */;
                _this.vertices = [];
                _this.uvs = [];
                _this.indices = [];
                return _this;
            }
            /**
             * ็ปๅถไธๆฌกไฝๅพ
             */
            MeshNode.prototype.drawMesh = function (sourceX, sourceY, sourceW, sourceH, drawX, drawY, drawW, drawH) {
                this.drawData.push(sourceX, sourceY, sourceW, sourceH, drawX, drawY, drawW, drawH);
                this.renderCount++;
            };
            /**
             * ๅจๆพ็คบๅฏน่ฑก็$render()ๆนๆณ่ขซ่ฐ็จๅ๏ผ่ชๅจๆธ็ฉบ่ช่บซ็drawDataๆฐๆฎใ
             */
            MeshNode.prototype.cleanBeforeRender = function () {
                _super.prototype.cleanBeforeRender.call(this);
                this.image = null;
                this.matrix = null;
            };
            return MeshNode;
        }(sys.RenderNode));
        sys.MeshNode = MeshNode;
        __reflect(MeshNode.prototype, "egret.sys.MeshNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * RenderTexture is a dynamic texture
     * @extends egret.Texture
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/RenderTexture.ts
     * @language en_US
     */
    /**
     * RenderTexture ๆฏๅจๆ็บน็็ฑป๏ผไปๅฎ็ฐไบๅฐๆพ็คบๅฏน่ฑกๅๅถๅญๅฏน่ฑก็ปๅถๆไธบไธไธช็บน็็ๅ่ฝ
     * @extends egret.Texture
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/RenderTexture.ts
     * @language zh_CN
     */
    var RenderTexture = (function (_super) {
        __extends(RenderTexture, _super);
        function RenderTexture() {
            var _this = _super.call(this) || this;
            _this.$renderBuffer = new egret.sys.RenderBuffer();
            var bitmapData = new egret.BitmapData(_this.$renderBuffer.surface);
            bitmapData.$deleteSource = false;
            _this._setBitmapData(bitmapData);
            return _this;
        }
        /**
         * The specified display object is drawn as a texture
         * @param displayObject {egret.DisplayObject} the display to draw
         * @param clipBounds {egret.Rectangle} clip rect
         * @param scale {number} scale factor
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆๅฎๆพ็คบๅฏน่ฑก็ปๅถไธบไธไธช็บน็
         * @param displayObject {egret.DisplayObject} ้่ฆ็ปๅถ็ๆพ็คบๅฏน่ฑก
         * @param clipBounds {egret.Rectangle} ็ปๅถ็ฉๅฝขๅบๅ
         * @param scale {number} ็ผฉๆพๆฏไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        RenderTexture.prototype.drawToTexture = function (displayObject, clipBounds, scale) {
            if (scale === void 0) {
                scale = 1;
            }
            if (clipBounds && (clipBounds.width == 0 || clipBounds.height == 0)) {
                return false;
            }
            var bounds = clipBounds || displayObject.$getOriginalBounds();
            if (bounds.width == 0 || bounds.height == 0) {
                return false;
            }
            scale /= egret.$TextureScaleFactor;
            var width = (bounds.x + bounds.width) * scale;
            var height = (bounds.y + bounds.height) * scale;
            if (clipBounds) {
                width = bounds.width * scale;
                height = bounds.height * scale;
            }
            var renderBuffer = this.$renderBuffer;
            if (!renderBuffer) {
                return false;
            }
            renderBuffer.resize(width, height);
            this._bitmapData.width = width;
            this._bitmapData.height = height;
            var matrix = egret.Matrix.create();
            matrix.identity();
            //ๅบ็จ่ฃๅ
            if (clipBounds) {
                matrix.translate(-clipBounds.x, -clipBounds.y);
            }
            matrix.scale(scale, scale);
            egret.sys.systemRenderer.render(displayObject, renderBuffer, matrix, null, true);
            egret.Matrix.release(matrix);
            //่ฎพ็ฝฎ็บน็ๅๆฐ
            this.$initData(0, 0, width, height, 0, 0, width, height, width, height);
            return true;
        };
        /**
         * @inheritDoc
         */
        RenderTexture.prototype.getPixel32 = function (x, y) {
            var data;
            if (this.$renderBuffer) {
                var scale = egret.$TextureScaleFactor;
                x = Math.round(x / scale);
                y = Math.round(y / scale);
                data = this.$renderBuffer.getPixels(x, y, 1, 1);
            }
            return data;
        };
        /**
         * @inheritDoc
         */
        RenderTexture.prototype.dispose = function () {
            _super.prototype.dispose.call(this);
            this.$renderBuffer = null;
        };
        return RenderTexture;
    }(egret.Texture));
    egret.RenderTexture = RenderTexture;
    __reflect(RenderTexture.prototype, "egret.RenderTexture");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ไฝๅพๆธฒๆ่็น
         */
        var SetAlphaNode = (function (_super) {
            __extends(SetAlphaNode, _super);
            function SetAlphaNode() {
                var _this = _super.call(this) || this;
                _this.type = 6 /* SetAlphaNode */;
                return _this;
            }
            /**
             * ็ปๅถไธๆฌกไฝๅพ
             */
            SetAlphaNode.prototype.setAlpha = function (alpha) {
                if (this.drawData.length != 0) {
                    this.drawData.length = 0;
                }
                this.drawData.push(alpha);
                this.renderCount++;
            };
            return SetAlphaNode;
        }(sys.RenderNode));
        sys.SetAlphaNode = SetAlphaNode;
        __reflect(SetAlphaNode.prototype, "egret.sys.SetAlphaNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๆๆฌๆธฒๆ่็น
         */
        var TextNode = (function (_super) {
            __extends(TextNode, _super);
            function TextNode() {
                var _this = _super.call(this) || this;
                /**
                 * ้ข่ฒๅผ
                 */
                _this.textColor = 0xFFFFFF;
                /**
                 * ๆ่พน้ข่ฒๅผ
                 */
                _this.strokeColor = 0x000000;
                /**
                 * ๅญๅท
                 */
                _this.size = 30;
                /**
                 * ๆ่พนๅคงๅฐ
                 */
                _this.stroke = 0;
                /**
                 * ๆฏๅฆๅ็ฒ
                 */
                _this.bold = false;
                /**
                 * ๆฏๅฆๅพๆ
                 */
                _this.italic = false;
                /**
                 * ๅญไฝๅ็งฐ
                 */
                _this.fontFamily = "Arial";
                /**
                 * ่ๆธฒๆๆ่ฎฐ
                 */
                _this.dirtyRender = true;
                _this.type = 2 /* TextNode */;
                return _this;
            }
            /**
             * ็ปๅถไธ่กๆๆฌ
             */
            TextNode.prototype.drawText = function (x, y, text, format) {
                this.drawData.push(x, y, text, format);
                this.renderCount++;
                this.dirtyRender = true;
            };
            /**
             * ๅจๆพ็คบๅฏน่ฑก็$render()ๆนๆณ่ขซ่ฐ็จๅ๏ผ่ชๅจๆธ็ฉบ่ช่บซ็drawDataๆฐๆฎใ
             */
            TextNode.prototype.cleanBeforeRender = function () {
                _super.prototype.cleanBeforeRender.call(this);
            };
            /**
             * ๆธ้ค้็ปๅถ็็ผๅญๆฐๆฎ
             */
            TextNode.prototype.clean = function () {
                if (this.$texture) {
                    egret.WebGLUtils.deleteWebGLTexture(this.$texture);
                    this.$texture = null;
                    this.dirtyRender = true;
                }
            };
            return TextNode;
        }(sys.RenderNode));
        sys.TextNode = TextNode;
        __reflect(TextNode.prototype, "egret.sys.TextNode");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๅกซๅ่ทฏๅพ
         */
        var FillPath = (function (_super) {
            __extends(FillPath, _super);
            function FillPath() {
                var _this = _super.call(this) || this;
                _this.type = 1 /* Fill */;
                return _this;
            }
            return FillPath;
        }(sys.Path2D));
        sys.FillPath = FillPath;
        __reflect(FillPath.prototype, "egret.sys.FillPath");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๆธๅๅกซๅ่ทฏๅพ
         */
        var GradientFillPath = (function (_super) {
            __extends(GradientFillPath, _super);
            function GradientFillPath() {
                var _this = _super.call(this) || this;
                _this.type = 2 /* GradientFill */;
                return _this;
            }
            return GradientFillPath;
        }(sys.Path2D));
        sys.GradientFillPath = GradientFillPath;
        __reflect(GradientFillPath.prototype, "egret.sys.GradientFillPath");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * This class is used to create lightweight shapes using the drawing application program interface (API). The Shape
     * class includes a graphics property, which lets you access methods from the Graphics class.
     * @see egret.Graphics
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Shape.ts
     * @language en_US
     */
    /**
     * ๆญค็ฑป็จไบไฝฟ็จ็ปๅพๅบ็จ็จๅบ็ผ็จๆฅๅฃ (API) ๅๅปบ็ฎๅๅฝข็ถใShape ็ฑปๅซๆ graphics ๅฑๆง๏ผ้่ฟ่ฏฅๅฑๆงๆจๅฏไปฅ่ฎฟ้ฎๅ็ง็ข้็ปๅพๆนๆณใ
     * @see egret.Graphics
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Shape.ts
     * @language zh_CN
     */
    var Shape = (function (_super) {
        __extends(Shape, _super);
        /**
         * Creates a new Shape object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช Shape ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Shape() {
            var _this = _super.call(this) || this;
            _this.$graphics = new egret.Graphics();
            _this.$graphics.$setTarget(_this);
            return _this;
        }
        Object.defineProperty(Shape.prototype, "graphics", {
            /**
             * Specifies the Graphics object belonging to this Shape object, where vector drawing commands can occur.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅ Shape ไธญ็ Graphics ๅฏน่ฑกใๅฏ้่ฟๆญคๅฏน่ฑกๆง่ก็ข้็ปๅพๅฝไปคใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$graphics;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Shape.prototype.$measureContentBounds = function (bounds) {
            this.$graphics.$measureContentBounds(bounds);
        };
        Shape.prototype.$hitTest = function (stageX, stageY) {
            var target = _super.prototype.$hitTest.call(this, stageX, stageY);
            if (target == this) {
                target = this.$graphics.$hitTest(stageX, stageY);
            }
            return target;
        };
        /**
         * @private
         */
        Shape.prototype.$onRemoveFromStage = function () {
            _super.prototype.$onRemoveFromStage.call(this);
            if (this.$graphics) {
                this.$graphics.$onRemoveFromStage();
            }
        };
        return Shape;
    }(egret.DisplayObject));
    egret.Shape = Shape;
    __reflect(Shape.prototype, "egret.Shape");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ็บฟๆก่ทฏๅพใ
         * ๆณจๆ๏ผๅฝ็บฟๆกๅฎฝๅบฆ๏ผlineWidth๏ผไธบ1ๆ3ๅ็ดๆถ๏ผ้่ฆ็นๆฎๅค็๏ผๅพๅณไธ่งๅ็งป0.5ๅ็ด๏ผไปฅๆพ็คบๆธๆฐ้ๅฉ็็บฟๆกใ
         */
        var StrokePath = (function (_super) {
            __extends(StrokePath, _super);
            function StrokePath() {
                var _this = _super.call(this) || this;
                _this.type = 3 /* Stroke */;
                return _this;
            }
            return StrokePath;
        }(sys.Path2D));
        sys.StrokePath = StrokePath;
        __reflect(StrokePath.prototype, "egret.sys.StrokePath");
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var blendModes = ["source-over", "lighter", "destination-out"];
    var defaultCompositeOp = "source-over";
    var BLACK_COLOR = "#000000";
    var CAPS_STYLES = { none: 'butt', square: 'square', round: 'round' };
    var renderBufferPool = []; //ๆธฒๆ็ผๅฒๅบๅฏน่ฑกๆฑ
    var renderBufferPool_Filters = []; //ๆปค้็ผๅฒๅบๅฏน่ฑกๆฑ
    /**
     * @private
     * Canvasๆธฒๆๅจ
     */
    var CanvasRenderer = (function () {
        function CanvasRenderer() {
            this.nestLevel = 0; //ๆธฒๆ็ๅตๅฅๅฑๆฌก๏ผ0่กจ็คบๅจ่ฐ็จๅๆ็ๆๅคๅฑใ
            this.renderingMask = false;
        }
        /**
         * ๆธฒๆไธไธชๆพ็คบๅฏน่ฑก
         * @param displayObject ่ฆๆธฒๆ็ๆพ็คบๅฏน่ฑก
         * @param buffer ๆธฒๆ็ผๅฒ
         * @param matrix ่ฆๅฏนๆพ็คบๅฏน่ฑกๆดไฝๅๅ็ๅๆข็ฉ้ต
         * @param dirtyList ่็ฉๅฝขๅ่กจ
         * @param forRenderTexture ็ปๅถ็ฎๆๆฏRenderTexture็ๆๅฟ
         * @returns drawCall่งฆๅ็ปๅถ็ๆฌกๆฐ
         */
        CanvasRenderer.prototype.render = function (displayObject, buffer, matrix, dirtyList, forRenderTexture) {
            this.nestLevel++;
            var context = buffer.context;
            var root = forRenderTexture ? displayObject : null;
            //็ปๅถๆพ็คบๅฏน่ฑก
            var drawCall = this.drawDisplayObject(displayObject, context, dirtyList, matrix, null, null, root);
            this.nestLevel--;
            if (this.nestLevel === 0) {
                //ๆๅคง็ผๅญ6ไธชๆธฒๆ็ผๅฒ
                if (renderBufferPool.length > 6) {
                    renderBufferPool.length = 6;
                }
                var length_7 = renderBufferPool.length;
                for (var i = 0; i < length_7; i++) {
                    renderBufferPool[i].resize(0, 0);
                }
                if (renderBufferPool_Filters.length > 1) {
                    renderBufferPool_Filters.length = 1;
                    renderBufferPool_Filters[0].resize(0, 0);
                }
            }
            return drawCall;
        };
        /**
         * @private
         * ็ปๅถไธไธชๆพ็คบๅฏน่ฑก
         */
        CanvasRenderer.prototype.drawDisplayObject = function (displayObject, context, dirtyList, matrix, displayList, clipRegion, root) {
            var drawCalls = 0;
            var node;
            if (displayList && !root) {
                if (displayList.isDirty) {
                    drawCalls += displayList.drawToSurface();
                }
                node = displayList.$renderNode;
            }
            else {
                node = displayObject.$getRenderNode();
            }
            if (node) {
                if (dirtyList) {
                    var renderRegion = node.renderRegion;
                    if (clipRegion && !clipRegion.intersects(renderRegion)) {
                        node.needRedraw = false;
                    }
                    else if (!node.needRedraw) {
                        var l = dirtyList.length;
                        for (var j = 0; j < l; j++) {
                            if (renderRegion.intersects(dirtyList[j])) {
                                node.needRedraw = true;
                                break;
                            }
                        }
                    }
                }
                else {
                    node.needRedraw = true;
                }
                if (node.needRedraw) {
                    var renderAlpha = void 0;
                    var m = void 0;
                    if (root) {
                        renderAlpha = displayObject.$getConcatenatedAlphaAt(root, displayObject.$getConcatenatedAlpha());
                        m = egret.Matrix.create().copyFrom(displayObject.$getConcatenatedMatrix());
                        displayObject.$getConcatenatedMatrixAt(root, m);
                    }
                    else {
                        renderAlpha = node.renderAlpha;
                        m = egret.Matrix.create().copyFrom(node.renderMatrix);
                    }
                    matrix.$preMultiplyInto(m, m);
                    context.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                    egret.Matrix.release(m);
                    context.globalAlpha = renderAlpha;
                    drawCalls += this.renderNode(node, context);
                    node.needRedraw = false;
                }
            }
            if (displayList && !root) {
                return drawCalls;
            }
            var children = displayObject.$children;
            if (children) {
                var length_8 = children.length;
                for (var i = 0; i < length_8; i++) {
                    var child = children[i];
                    if (!child.$visible || child.$alpha <= 0 || child.$maskedObject) {
                        continue;
                    }
                    var filters = child.$getFilters();
                    if (filters && filters.length > 0) {
                        drawCalls += this.drawWithFilter(child, context, dirtyList, matrix, clipRegion, root);
                    }
                    else if ((child.$blendMode !== 0 ||
                        (child.$mask && (child.$mask.$parentDisplayList || root)))) {
                        drawCalls += this.drawWithClip(child, context, dirtyList, matrix, clipRegion, root);
                    }
                    else if (child.$scrollRect || child.$maskRect) {
                        drawCalls += this.drawWithScrollRect(child, context, dirtyList, matrix, clipRegion, root);
                    }
                    else {
                        if (child["isFPS"]) {
                            this.drawDisplayObject(child, context, dirtyList, matrix, child.$displayList, clipRegion, root);
                        }
                        else {
                            drawCalls += this.drawDisplayObject(child, context, dirtyList, matrix, child.$displayList, clipRegion, root);
                        }
                    }
                }
            }
            return drawCalls;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.drawWithFilter = function (displayObject, context, dirtyList, matrix, clipRegion, root) {
            if (egret.Capabilities.runtimeType == egret.RuntimeType.NATIVE) {
                var drawCalls_1 = 0;
                var filters_1 = displayObject.$getFilters();
                var hasBlendMode_1 = (displayObject.$blendMode !== 0);
                var compositeOp_1;
                if (hasBlendMode_1) {
                    compositeOp_1 = blendModes[displayObject.$blendMode];
                    if (!compositeOp_1) {
                        compositeOp_1 = defaultCompositeOp;
                    }
                }
                if (filters_1.length == 1 && filters_1[0].type == "colorTransform" && !displayObject.$children) {
                    if (hasBlendMode_1) {
                        context.globalCompositeOperation = compositeOp_1;
                    }
                    context.setGlobalShader(filters_1[0]);
                    if (displayObject.$mask && (displayObject.$mask.$parentDisplayList || root)) {
                        drawCalls_1 += this.drawWithClip(displayObject, context, dirtyList, matrix, clipRegion, root);
                    }
                    else if (displayObject.$scrollRect || displayObject.$maskRect) {
                        drawCalls_1 += this.drawWithScrollRect(displayObject, context, dirtyList, matrix, clipRegion, root);
                    }
                    else {
                        drawCalls_1 += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                    }
                    context.setGlobalShader(null);
                    if (hasBlendMode_1) {
                        context.globalCompositeOperation = defaultCompositeOp;
                    }
                    return drawCalls_1;
                }
                // ่ทๅๆพ็คบๅฏน่ฑก็้พๆฅ็ฉ้ต
                var displayMatrix_1 = egret.Matrix.create();
                displayMatrix_1.copyFrom(displayObject.$getConcatenatedMatrix());
                if (root) {
                    displayObject.$getConcatenatedMatrixAt(root, displayMatrix_1);
                }
                // ่ทๅๆพ็คบๅฏน่ฑก็็ฉๅฝขๅบๅ
                var region_1;
                region_1 = egret.sys.Region.create();
                var bounds_1 = displayObject.$getOriginalBounds();
                region_1.updateRegion(bounds_1, displayMatrix_1);
                // ไธบๆพ็คบๅฏน่ฑกๅๅปบไธไธชๆฐ็buffer
                // todo ่ฟ้ๅบ่ฏฅ่ฎก็ฎ region.x region.y
                var displayBuffer_1 = this.createRenderBuffer(region_1.width, region_1.height);
                displayBuffer_1.context.setTransform(1, 0, 0, 1, -region_1.minX, -region_1.minY);
                var offsetM_1 = egret.Matrix.create().setTo(1, 0, 0, 1, -region_1.minX, -region_1.minY);
                if (displayObject.$mask && (displayObject.$mask.$parentDisplayList || root)) {
                    drawCalls_1 += this.drawWithClip(displayObject, displayBuffer_1.context, dirtyList, offsetM_1, region_1, root);
                }
                else if (displayObject.$scrollRect || displayObject.$maskRect) {
                    drawCalls_1 += this.drawWithScrollRect(displayObject, displayBuffer_1.context, dirtyList, offsetM_1, region_1, root);
                }
                else {
                    drawCalls_1 += this.drawDisplayObject(displayObject, displayBuffer_1.context, dirtyList, offsetM_1, displayObject.$displayList, region_1, root);
                }
                egret.Matrix.release(offsetM_1);
                //็ปๅถ็ปๆๅฐๅฑๅน
                if (drawCalls_1 > 0) {
                    if (hasBlendMode_1) {
                        context.globalCompositeOperation = compositeOp_1;
                    }
                    drawCalls_1++;
                    context.globalAlpha = 1;
                    context.setTransform(1, 0, 0, 1, region_1.minX + matrix.tx, region_1.minY + matrix.ty);
                    // ็ปๅถ็ปๆ็ๆถๅ๏ผๅบ็จๆปค้
                    context.setGlobalShader(filters_1[0]);
                    context.drawImage(displayBuffer_1.surface, 0, 0, displayBuffer_1.width, displayBuffer_1.height, 0, 0, displayBuffer_1.width, displayBuffer_1.height);
                    context.setGlobalShader(null);
                    if (hasBlendMode_1) {
                        context.globalCompositeOperation = defaultCompositeOp;
                    }
                }
                renderBufferPool.push(displayBuffer_1);
                egret.sys.Region.release(region_1);
                egret.Matrix.release(displayMatrix_1);
                return drawCalls_1;
            }
            var drawCalls = 0;
            var filters = displayObject.$getFilters();
            var filtersLen = filters.length;
            var hasBlendMode = (displayObject.$blendMode !== 0);
            var compositeOp;
            if (hasBlendMode) {
                compositeOp = blendModes[displayObject.$blendMode];
                if (!compositeOp) {
                    compositeOp = defaultCompositeOp;
                }
            }
            // ่ทๅๆพ็คบๅฏน่ฑก็้พๆฅ็ฉ้ต
            var displayMatrix = egret.Matrix.create();
            displayMatrix.copyFrom(displayObject.$getConcatenatedMatrix());
            if (root) {
                displayObject.$getConcatenatedMatrixAt(root, displayMatrix);
            }
            // ่ทๅๆพ็คบๅฏน่ฑก็็ฉๅฝขๅบๅ
            var region;
            region = egret.sys.Region.create();
            var bounds = displayObject.$getOriginalBounds();
            region.updateRegion(bounds, displayMatrix);
            // ไธบๆพ็คบๅฏน่ฑกๅๅปบไธไธชๆฐ็buffer
            // todo ่ฟ้ๅบ่ฏฅ่ฎก็ฎ region.x region.y
            var displayBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d, true);
            var displayContext = displayBuffer.context;
            displayContext.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
            var offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
            //todo ๅฏไปฅไผๅๅๅฐdrawๆฌกๆฐ
            if (displayObject.$mask && (displayObject.$mask.$parentDisplayList || root)) {
                drawCalls += this.drawWithClip(displayObject, displayContext, dirtyList, offsetM, region, root);
            }
            else if (displayObject.$scrollRect || displayObject.$maskRect) {
                drawCalls += this.drawWithScrollRect(displayObject, displayContext, dirtyList, offsetM, region, root);
            }
            else {
                drawCalls += this.drawDisplayObject(displayObject, displayContext, dirtyList, offsetM, displayObject.$displayList, region, root);
            }
            egret.Matrix.release(offsetM);
            //็ปๅถ็ปๆๅฐๅฑๅน
            if (drawCalls > 0) {
                if (hasBlendMode) {
                    context.globalCompositeOperation = compositeOp;
                }
                drawCalls++;
                // ๅบ็จๆปค้
                var imageData = displayContext.getImageData(0, 0, displayBuffer.surface.width, displayBuffer.surface.height);
                for (var i = 0; i < filtersLen; i++) {
                    var filter = filters[i];
                    if (filter.type == "colorTransform") {
                        colorFilter(imageData.data, displayBuffer.surface.width, displayBuffer.surface.height, filter.$matrix);
                    }
                    else if (filter.type == "blur") {
                        blurFilter(imageData.data, displayBuffer.surface.width, displayBuffer.surface.height, filter.$blurX, filter.$blurY);
                    }
                    else if (filter.type == "glow") {
                        var r = filter.$red;
                        var g = filter.$green;
                        var b = filter.$blue;
                        var a = filter.$alpha;
                        if (filter.$inner || filter.$knockout || filter.$hideObject) {
                            dropShadowFilter2(imageData.data, displayBuffer.surface.width, displayBuffer.surface.height, [r / 255, g / 255, b / 255, a], filter.$blurX, filter.$blurY, filter.$angle ? (filter.$angle / 180 * Math.PI) : 0, filter.$distance || 0, filter.$strength, filter.$inner ? 1 : 0, filter.$knockout ? 0 : 1, filter.$hideObject ? 1 : 0);
                        }
                        else {
                            // ๅฆๆๆฒกๆ้ซ็บงๆๆ๏ผไฝฟ็จๆง่ฝๆฏ่พ้ซ็ๆนๅผ
                            dropShadowFilter(imageData.data, displayBuffer.surface.width, displayBuffer.surface.height, [r / 255, g / 255, b / 255, a], filter.$blurX, filter.$blurY, filter.$angle ? (filter.$angle / 180 * Math.PI) : 0, filter.$distance || 0, filter.$strength);
                        }
                    }
                    else if (filter.type == "custom") {
                        // ็ฎๅcanvasๆธฒๆไธๆฏๆ่ชๅฎไนๆปค้
                    }
                }
                displayContext.putImageData(imageData, 0, 0);
                context.globalAlpha = 1;
                context.setTransform(1, 0, 0, 1, (region.minX + matrix.tx) * matrix.a, (region.minY + matrix.ty) * matrix.d);
                // ็ปๅถ็ปๆ็ๆถๅ๏ผๅบ็จๆปค้
                context.drawImage(displayBuffer.surface, 0, 0);
                if (hasBlendMode) {
                    context.globalCompositeOperation = defaultCompositeOp;
                }
            }
            renderBufferPool_Filters.push(displayBuffer);
            egret.sys.Region.release(region);
            egret.Matrix.release(displayMatrix);
            return drawCalls;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.drawWithClip = function (displayObject, context, dirtyList, matrix, clipRegion, root) {
            var drawCalls = 0;
            var hasBlendMode = (displayObject.$blendMode !== 0);
            var compositeOp;
            if (hasBlendMode) {
                compositeOp = blendModes[displayObject.$blendMode];
                if (!compositeOp) {
                    compositeOp = defaultCompositeOp;
                }
            }
            var scrollRect = displayObject.$scrollRect ? displayObject.$scrollRect : displayObject.$maskRect;
            var mask = displayObject.$mask;
            var maskRenderNode;
            if (mask) {
                maskRenderNode = mask.$getRenderNode();
                if (maskRenderNode) {
                    var maskRenderMatrix = maskRenderNode.renderMatrix;
                    //้ฎ็ฝฉscaleXๆscaleYไธบ0๏ผๆพๅผ็ปๅถ
                    if ((maskRenderMatrix.a == 0 && maskRenderMatrix.b == 0) || (maskRenderMatrix.c == 0 && maskRenderMatrix.d == 0)) {
                        return drawCalls;
                    }
                }
            }
            //if (mask && !mask.$parentDisplayList) {
            //    mask = null; //ๅฆๆ้ฎ็ฝฉไธๅจๆพ็คบๅ่กจไธญ๏ผๆพๅผ็ปๅถ้ฎ็ฝฉใ
            //}
            //่ฎก็ฎscrollRectๅmask็clipๅบๅๆฏๅฆ้่ฆ็ปๅถ๏ผไธ้่ฆๅฐฑ็ดๆฅ่ฟๅ๏ผ่ทณ่ฟๆๆๅญ้กน็้ๅใ
            var maskRegion;
            var displayMatrix = egret.Matrix.create();
            displayMatrix.copyFrom(displayObject.$getConcatenatedMatrix());
            if (root) {
                displayObject.$getConcatenatedMatrixAt(root, displayMatrix);
            }
            else if (displayObject.$parentDisplayList) {
                var displayRoot = displayObject.$parentDisplayList.root;
                if (displayRoot !== displayObject.$stage) {
                    displayObject.$getConcatenatedMatrixAt(displayRoot, displayMatrix);
                }
            }
            var bounds;
            if (mask) {
                bounds = mask.$getOriginalBounds();
                maskRegion = egret.sys.Region.create();
                var m = egret.Matrix.create();
                m.copyFrom(mask.$getConcatenatedMatrix());
                if (root) {
                    mask.$getConcatenatedMatrixAt(root, m);
                }
                maskRegion.updateRegion(bounds, m);
                egret.Matrix.release(m);
            }
            var region;
            if (scrollRect) {
                region = egret.sys.Region.create();
                region.updateRegion(scrollRect, displayMatrix);
            }
            if (region && maskRegion) {
                region.intersect(maskRegion);
                egret.sys.Region.release(maskRegion);
            }
            else if (!region && maskRegion) {
                region = maskRegion;
            }
            if (region) {
                if (region.isEmpty() || (clipRegion && !clipRegion.intersects(region))) {
                    egret.sys.Region.release(region);
                    egret.Matrix.release(displayMatrix);
                    return drawCalls;
                }
            }
            else {
                region = egret.sys.Region.create();
                bounds = displayObject.$getOriginalBounds();
                region.updateRegion(bounds, displayMatrix);
            }
            var found = false;
            if (!dirtyList) {
                found = true;
            }
            else {
                var l = dirtyList.length;
                for (var j = 0; j < l; j++) {
                    if (region.intersects(dirtyList[j])) {
                        found = true;
                        break;
                    }
                }
            }
            if (!found) {
                egret.sys.Region.release(region);
                egret.Matrix.release(displayMatrix);
                return drawCalls;
            }
            //ๆฒกๆ้ฎ็ฝฉ,ๅๆถๆพ็คบๅฏน่ฑกๆฒกๆๅญ้กน
            if (!mask && (!displayObject.$children || displayObject.$children.length == 0)) {
                if (scrollRect) {
                    var m = displayMatrix;
                    context.save();
                    matrix.$preMultiplyInto(m, m);
                    context.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                    context.beginPath();
                    context.rect(scrollRect.x, scrollRect.y, scrollRect.width, scrollRect.height);
                    context.clip();
                }
                if (hasBlendMode) {
                    context.globalCompositeOperation = compositeOp;
                }
                drawCalls += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                if (hasBlendMode) {
                    context.globalCompositeOperation = defaultCompositeOp;
                }
                if (scrollRect) {
                    context.restore();
                }
                egret.sys.Region.release(region);
                egret.Matrix.release(displayMatrix);
                return drawCalls;
            }
            //้ฎ็ฝฉๆฏๅ็บฏ็ๅกซๅๅพๅฝข,ไธalphaไธบ1,ๆง่ฝไผๅ
            //todo ๅนณๅฐๅทฎๅผ
            if (mask && egret.Capabilities.$runtimeType == egret.RuntimeType.WEB && (!mask.$children || mask.$children.length == 0) &&
                maskRenderNode && maskRenderNode.type == 3 /* GraphicsNode */ &&
                maskRenderNode.drawData.length == 1 &&
                maskRenderNode.drawData[0].type == 1 /* Fill */ &&
                maskRenderNode.drawData[0].fillAlpha == 1) {
                this.renderingMask = true;
                context.save();
                var calls = this.drawDisplayObject(mask, context, dirtyList, matrix, mask.$displayList, clipRegion, root);
                this.renderingMask = false;
                if (scrollRect) {
                    var m = displayMatrix;
                    matrix.$preMultiplyInto(m, m);
                    context.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                    context.beginPath();
                    context.rect(scrollRect.x, scrollRect.y, scrollRect.width, scrollRect.height);
                    context.clip();
                }
                calls += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                context.restore();
                egret.sys.Region.release(region);
                egret.Matrix.release(displayMatrix);
                return calls;
            }
            //todo ่ฅๆพ็คบๅฏน่ฑกๆฏๅฎนๅจ๏ผๅๆถๅญ้กนๆๆททๅๆจกๅผ๏ผๅ้่ฆๅ็ปๅถ่ๆฏๅฐdisplayBufferๅนถๆธ้ค่ๆฏๅบๅ
            //็ปๅถๆพ็คบๅฏน่ฑก่ช่บซ๏ผ่ฅๆscrollRect๏ผๅบ็จclip
            var displayBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d);
            var displayContext = displayBuffer.context;
            if (!displayContext) {
                drawCalls += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                egret.sys.Region.release(region);
                egret.Matrix.release(displayMatrix);
                return drawCalls;
            }
            displayContext.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
            var offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
            drawCalls += this.drawDisplayObject(displayObject, displayContext, dirtyList, offsetM, displayObject.$displayList, region, root);
            //็ปๅถ้ฎ็ฝฉ
            if (mask) {
                //ๅฆๆๅชๆไธๆฌก็ปๅถๆๆฏๅทฒ็ป่ขซcache็ดๆฅ็ปๅถๅฐdisplayContext
                if (egret.Capabilities.$runtimeType == egret.RuntimeType.WEB && maskRenderNode && maskRenderNode.$getRenderCount() == 1 || mask.$displayList) {
                    displayContext.globalCompositeOperation = "destination-in";
                    drawCalls += this.drawDisplayObject(mask, displayContext, dirtyList, offsetM, mask.$displayList, region, root);
                }
                else {
                    var maskBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d);
                    var maskContext = maskBuffer.context;
                    if (!maskContext) {
                        drawCalls += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                        renderBufferPool.push(displayBuffer);
                        egret.sys.Region.release(region);
                        egret.Matrix.release(displayMatrix);
                        return drawCalls;
                    }
                    maskContext.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                    offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                    drawCalls += this.drawDisplayObject(mask, maskContext, dirtyList, offsetM, mask.$displayList, region, root);
                    displayContext.globalCompositeOperation = "destination-in";
                    displayContext.setTransform(1, 0, 0, 1, 0, 0);
                    displayContext.globalAlpha = 1;
                    displayContext.drawImage(maskBuffer.surface, 0, 0);
                    renderBufferPool.push(maskBuffer);
                }
            }
            egret.Matrix.release(offsetM);
            //็ปๅถ็ปๆๅฐๅฑๅน
            if (drawCalls > 0) {
                drawCalls++;
                if (hasBlendMode) {
                    context.globalCompositeOperation = compositeOp;
                }
                if (scrollRect) {
                    var m = displayMatrix;
                    context.save();
                    matrix.$preMultiplyInto(m, m);
                    context.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                    context.beginPath();
                    context.rect(scrollRect.x, scrollRect.y, scrollRect.width, scrollRect.height);
                    context.clip();
                }
                context.globalAlpha = 1;
                context.setTransform(1, 0, 0, 1, (region.minX + matrix.tx) * matrix.a, (region.minY + matrix.ty) * matrix.d);
                context.drawImage(displayBuffer.surface, 0, 0);
                if (scrollRect) {
                    context.restore();
                }
                if (hasBlendMode) {
                    context.globalCompositeOperation = defaultCompositeOp;
                }
            }
            renderBufferPool.push(displayBuffer);
            egret.sys.Region.release(region);
            egret.Matrix.release(displayMatrix);
            return drawCalls;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.drawWithScrollRect = function (displayObject, context, dirtyList, matrix, clipRegion, root) {
            var drawCalls = 0;
            var scrollRect = displayObject.$scrollRect ? displayObject.$scrollRect : displayObject.$maskRect;
            if (scrollRect.isEmpty()) {
                return drawCalls;
            }
            var m = egret.Matrix.create();
            m.copyFrom(displayObject.$getConcatenatedMatrix());
            if (root) {
                displayObject.$getConcatenatedMatrixAt(root, m);
            }
            else if (displayObject.$parentDisplayList) {
                var displayRoot = displayObject.$parentDisplayList.root;
                if (displayRoot !== displayObject.$stage) {
                    displayObject.$getConcatenatedMatrixAt(displayRoot, m);
                }
            }
            var region = egret.sys.Region.create();
            region.updateRegion(scrollRect, m);
            if (region.isEmpty() || (clipRegion && !clipRegion.intersects(region))) {
                egret.sys.Region.release(region);
                egret.Matrix.release(m);
                return drawCalls;
            }
            var found = false;
            if (!dirtyList) {
                found = true;
            }
            else {
                var l = dirtyList.length;
                for (var j = 0; j < l; j++) {
                    if (region.intersects(dirtyList[j])) {
                        found = true;
                        break;
                    }
                }
            }
            if (!found) {
                egret.sys.Region.release(region);
                egret.Matrix.release(m);
                return drawCalls;
            }
            //็ปๅถๆพ็คบๅฏน่ฑก่ช่บซ
            context.save();
            matrix.$preMultiplyInto(m, m);
            context.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
            context.beginPath();
            context.rect(scrollRect.x, scrollRect.y, scrollRect.width, scrollRect.height);
            context.clip();
            drawCalls += this.drawDisplayObject(displayObject, context, dirtyList, matrix, displayObject.$displayList, region, root);
            context.restore();
            egret.sys.Region.release(region);
            egret.Matrix.release(m);
            return drawCalls;
        };
        /**
         * ๅฐไธไธชRenderNodeๅฏน่ฑก็ปๅถๅฐๆธฒๆ็ผๅฒ
         * @param node ่ฆ็ปๅถ็่็น
         * @param buffer ๆธฒๆ็ผๅฒ
         * @param matrix ่ฆๅๅ็็ฉ้ต
         * @param forHitTest ็ปๅถ็ปๆๆฏ็จไบ็ขฐๆๆฃๆตใ่ฅไธบtrue๏ผๅฝๆธฒๆGraphicsNodeๆถ๏ผไผๅฟฝ็ฅ้ๆๅบฆๆทๅผ่ฎพ็ฝฎ๏ผๅจ้ฝ็ปๅถไธบไธ้ๆ็ใ
         */
        CanvasRenderer.prototype.drawNodeToBuffer = function (node, buffer, matrix, forHitTest) {
            var context = buffer.context;
            context.setTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);
            this.renderNode(node, context, forHitTest);
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.renderNode = function (node, context, forHitTest) {
            var drawCalls = 0;
            switch (node.type) {
                case 1 /* BitmapNode */:
                    drawCalls = this.renderBitmap(node, context);
                    break;
                case 2 /* TextNode */:
                    drawCalls = 1;
                    this.renderText(node, context);
                    break;
                case 3 /* GraphicsNode */:
                    drawCalls = this.renderGraphics(node, context, forHitTest);
                    break;
                case 4 /* GroupNode */:
                    drawCalls = this.renderGroup(node, context);
                    break;
                case 6 /* SetAlphaNode */:
                    context.globalAlpha = node.drawData[0];
                    break;
                case 7 /* MeshNode */:
                    drawCalls = this.renderMesh(node, context);
                    break;
            }
            return drawCalls;
        };
        /**
         * render mesh
         */
        CanvasRenderer.prototype.renderMesh = function (node, context) {
            if (egret.Capabilities.runtimeType != egret.RuntimeType.NATIVE) {
                return 0;
            }
            var image = node.image;
            var data = node.drawData;
            var length = data.length;
            var pos = 0;
            var m = node.matrix;
            var blendMode = node.blendMode;
            var alpha = node.alpha;
            var saved = false;
            if (m) {
                context.saveTransform();
                context.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
            }
            if (blendMode) {
                context.globalCompositeOperation = blendModes[blendMode];
            }
            var originAlpha;
            if (alpha == alpha) {
                originAlpha = context.globalAlpha;
                context.globalAlpha *= alpha;
            }
            var drawCalls = 0;
            var filter = node.filter;
            if (filter) {
                egret_native.Graphics.setGlobalShader(filter);
                while (pos < length) {
                    drawCalls++;
                    context.drawMesh(image.source, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.uvs, node.vertices, node.indices, node.bounds);
                }
                egret_native.Graphics.setGlobalShader(null);
            }
            else {
                while (pos < length) {
                    drawCalls++;
                    context.drawMesh(image.source, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.uvs, node.vertices, node.indices, node.bounds);
                }
            }
            if (m) {
                context.restoreTransform();
            }
            if (blendMode) {
                context.globalCompositeOperation = defaultCompositeOp;
            }
            if (alpha == alpha) {
                context.globalAlpha = originAlpha;
            }
            return 1;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.renderBitmap = function (node, context) {
            var image = node.image;
            if (!image || !image.source) {
                return 0;
            }
            if (context.$imageSmoothingEnabled != node.smoothing) {
                context.imageSmoothingEnabled = node.smoothing;
                context.$imageSmoothingEnabled = node.smoothing;
            }
            var data = node.drawData;
            var length = data.length;
            var pos = 0;
            var m = node.matrix;
            var blendMode = node.blendMode;
            var alpha = node.alpha;
            var saved = false;
            if (m) {
                if (context.saveTransform) {
                    context.saveTransform();
                }
                else {
                    context.save();
                }
                saved = true;
                context.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
            }
            //่ฟ้ไธ่่ๅตๅฅ
            if (blendMode) {
                context.globalCompositeOperation = blendModes[blendMode];
            }
            var originAlpha;
            if (alpha == alpha) {
                originAlpha = context.globalAlpha;
                context.globalAlpha *= alpha;
            }
            var drawCalls = 0;
            var filter = node.filter;
            //todo ๆๆถๅช่่็ปๅถไธๆฌก็ๆๅต
            if (filter && length == 8) {
                if (egret.Capabilities.runtimeType == egret.RuntimeType.NATIVE) {
                    egret_native.Graphics.setGlobalShader(filter);
                    drawCalls++;
                    if (node.rotated) {
                        var sourceX = data[0];
                        var sourceY = data[1];
                        var sourceHeight = data[2];
                        var sourceWidth = data[3];
                        var offsetX = data[4];
                        var offsetY = data[5];
                        var destHeight = data[6];
                        var destWidth = data[7];
                        if (context.saveTransform) {
                            context.saveTransform();
                        }
                        else {
                            context.save();
                        }
                        context.transform(0, -1, 1, 0, 0, destWidth);
                        context.drawImage(image.source, sourceX, sourceY, sourceWidth, sourceHeight, offsetX, offsetY, destWidth, destHeight);
                        if (context.restoreTransform) {
                            context.restoreTransform();
                        }
                        else {
                            context.restore();
                        }
                    }
                    else {
                        context.drawImage(image.source, data[0], data[1], data[2], data[3], data[4], data[5], data[6], data[7]);
                    }
                    egret_native.Graphics.setGlobalShader(null);
                }
                else {
                    var sourceX = data[0];
                    var sourceY = data[1];
                    var sourceWidth = data[2];
                    var sourceHeight = data[3];
                    var offsetX = data[4];
                    var offsetY = data[5];
                    var destWidth = data[6];
                    var destHeight = data[7];
                    if (node.rotated) {
                        sourceWidth = data[3];
                        sourceHeight = data[2];
                        destWidth = data[7];
                        destHeight = data[6];
                    }
                    var displayBuffer = this.createRenderBuffer(destWidth, destHeight);
                    var displayContext = displayBuffer.context;
                    drawCalls++;
                    if (node.rotated) {
                        context.transform(0, -1, 1, 0, 0, destWidth);
                    }
                    displayContext.drawImage(image.source, sourceX, sourceY, sourceWidth, sourceHeight, 0, 0, destWidth, destHeight);
                    //็ปๅถ็ปๆๅฐๅฑๅน
                    drawCalls++;
                    // ๅบ็จๆปค้
                    var imageData = displayContext.getImageData(0, 0, destWidth, destHeight);
                    colorFilter(imageData.data, destWidth, destHeight, filter.$matrix);
                    displayContext.putImageData(imageData, 0, 0);
                    // ็ปๅถ็ปๆ็ๆถๅ๏ผๅบ็จๆปค้
                    context.drawImage(displayBuffer.surface, 0, 0, destWidth, destHeight, offsetX, offsetY, destWidth, destHeight);
                    renderBufferPool.push(displayBuffer);
                }
            }
            else {
                while (pos < length) {
                    drawCalls++;
                    if (node.rotated) {
                        var sourceX = data[pos++];
                        var sourceY = data[pos++];
                        var sourceHeight = data[pos++];
                        var sourceWidth = data[pos++];
                        var offsetX = data[pos++];
                        var offsetY = data[pos++];
                        var destHeight = data[pos++];
                        var destWidth = data[pos++];
                        if (context.saveTransform) {
                            context.saveTransform();
                        }
                        else {
                            context.save();
                        }
                        context.transform(0, -1, 1, 0, 0, destWidth);
                        context.drawImage(image.source, sourceX, sourceY, sourceWidth, sourceHeight, offsetX, offsetY, destWidth, destHeight);
                        if (context.restoreTransform) {
                            context.restoreTransform();
                        }
                        else {
                            context.restore();
                        }
                    }
                    else {
                        context.drawImage(image.source, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++]);
                    }
                }
            }
            if (saved) {
                if (context.restoreTransform) {
                    context.restoreTransform();
                    if (blendMode) {
                        context.globalCompositeOperation = defaultCompositeOp;
                    }
                    if (alpha == alpha) {
                        context.globalAlpha = originAlpha;
                    }
                }
                else {
                    context.restore();
                }
            }
            else {
                if (blendMode) {
                    context.globalCompositeOperation = defaultCompositeOp;
                }
                if (alpha == alpha) {
                    context.globalAlpha = originAlpha;
                }
            }
            return drawCalls;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.renderText = function (node, context) {
            context.textAlign = "left";
            context.textBaseline = "middle";
            context.lineJoin = "round"; //็กฎไฟๆ่พนๆทๅผๆฏๅ่ง
            var drawData = node.drawData;
            var length = drawData.length;
            var pos = 0;
            while (pos < length) {
                var x = drawData[pos++];
                var y = drawData[pos++];
                var text = drawData[pos++];
                var format = drawData[pos++];
                context.font = getFontString(node, format);
                var textColor = format.textColor == null ? node.textColor : format.textColor;
                var strokeColor = format.strokeColor == null ? node.strokeColor : format.strokeColor;
                var stroke = format.stroke == null ? node.stroke : format.stroke;
                context.fillStyle = egret.toColorString(textColor);
                context.strokeStyle = egret.toColorString(strokeColor);
                if (stroke) {
                    context.lineWidth = stroke * 2;
                    context.strokeText(text, x, y);
                }
                context.fillText(text, x, y);
            }
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.renderGraphics = function (node, context, forHitTest) {
            var drawData = node.drawData;
            var length = drawData.length;
            forHitTest = !!forHitTest;
            for (var i = 0; i < length; i++) {
                var path = drawData[i];
                switch (path.type) {
                    case 1 /* Fill */:
                        var fillPath = path;
                        context.fillStyle = forHitTest ? BLACK_COLOR : getRGBAString(fillPath.fillColor, fillPath.fillAlpha);
                        this.renderPath(path, context);
                        if (this.renderingMask) {
                            context.clip();
                        }
                        else {
                            context.fill();
                        }
                        break;
                    case 2 /* GradientFill */:
                        var g = path;
                        context.fillStyle = forHitTest ? BLACK_COLOR : getGradient(context, g.gradientType, g.colors, g.alphas, g.ratios, g.matrix);
                        context.save();
                        var m = g.matrix;
                        this.renderPath(path, context);
                        context.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                        context.fill();
                        context.restore();
                        break;
                    case 3 /* Stroke */:
                        var strokeFill = path;
                        var lineWidth = strokeFill.lineWidth;
                        context.lineWidth = lineWidth;
                        context.strokeStyle = forHitTest ? BLACK_COLOR : getRGBAString(strokeFill.lineColor, strokeFill.lineAlpha);
                        context.lineCap = CAPS_STYLES[strokeFill.caps];
                        context.lineJoin = strokeFill.joints;
                        context.miterLimit = strokeFill.miterLimit;
                        //ๅฏน1ๅ็ดๅ3ๅ็ด็นๆฎๅค็๏ผๅๅณไธ่งๅ็งป0.5ๅ็ด๏ผไปฅๆพ็คบๆธๆฐ้ๅฉ็็บฟๆกใ
                        var isSpecialCaseWidth = lineWidth === 1 || lineWidth === 3;
                        if (isSpecialCaseWidth) {
                            context.translate(0.5, 0.5);
                        }
                        this.renderPath(path, context);
                        context.stroke();
                        if (isSpecialCaseWidth) {
                            context.translate(-0.5, -0.5);
                        }
                        break;
                }
            }
            return length == 0 ? 0 : 1;
        };
        CanvasRenderer.prototype.renderPath = function (path, context) {
            context.beginPath();
            var data = path.$data;
            var commands = path.$commands;
            var commandCount = commands.length;
            var pos = 0;
            for (var commandIndex = 0; commandIndex < commandCount; commandIndex++) {
                var command = commands[commandIndex];
                switch (command) {
                    case 4 /* CubicCurveTo */:
                        context.bezierCurveTo(data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++]);
                        break;
                    case 3 /* CurveTo */:
                        context.quadraticCurveTo(data[pos++], data[pos++], data[pos++], data[pos++]);
                        break;
                    case 2 /* LineTo */:
                        context.lineTo(data[pos++], data[pos++]);
                        break;
                    case 1 /* MoveTo */:
                        context.moveTo(data[pos++], data[pos++]);
                        break;
                }
            }
        };
        CanvasRenderer.prototype.renderGroup = function (groupNode, context) {
            var m = groupNode.matrix;
            var saved = false;
            if (m) {
                if (context.saveTransform) {
                    context.saveTransform();
                }
                else {
                    context.save();
                }
                saved = true;
                context.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
            }
            var drawCalls = 0;
            var children = groupNode.drawData;
            var length = children.length;
            for (var i = 0; i < length; i++) {
                var node = children[i];
                drawCalls += this.renderNode(node, context);
            }
            if (saved) {
                if (context.restoreTransform) {
                    context.restoreTransform();
                }
                else {
                    context.restore();
                }
            }
            return drawCalls;
        };
        /**
         * @private
         */
        CanvasRenderer.prototype.createRenderBuffer = function (width, height, useForFilters) {
            var buffer = useForFilters ? renderBufferPool_Filters.pop() : renderBufferPool.pop();
            if (buffer) {
                buffer.resize(width, height, true);
            }
            else {
                buffer = new egret.sys.CanvasRenderBuffer(width, height);
            }
            return buffer;
        };
        return CanvasRenderer;
    }());
    egret.CanvasRenderer = CanvasRenderer;
    __reflect(CanvasRenderer.prototype, "egret.CanvasRenderer", ["egret.sys.SystemRenderer"]);
    /**
     * @private
     * ่ทๅๅญไฝๅญ็ฌฆไธฒ
     */
    function getFontString(node, format) {
        var italic = format.italic == null ? node.italic : format.italic;
        var bold = format.bold == null ? node.bold : format.bold;
        var size = format.size == null ? node.size : format.size;
        var fontFamily = format.fontFamily || node.fontFamily;
        var font = italic ? "italic " : "normal ";
        font += bold ? "bold " : "normal ";
        font += size + "px " + fontFamily;
        return font;
    }
    /**
     * @private
     * ่ทๅRGBAๅญ็ฌฆไธฒ
     */
    function getRGBAString(color, alpha) {
        var red = color >> 16;
        var green = (color >> 8) & 0xFF;
        var blue = color & 0xFF;
        return "rgba(" + red + "," + green + "," + blue + "," + alpha + ")";
    }
    /**
     * @private
     * ่ทๅๆธๅๅกซๅๆทๅผๅฏน่ฑก
     */
    function getGradient(context, type, colors, alphas, ratios, matrix) {
        var gradient;
        if (type == egret.GradientType.LINEAR) {
            gradient = context.createLinearGradient(-1, 0, 1, 0);
        }
        else {
            gradient = context.createRadialGradient(0, 0, 0, 0, 0, 1);
        }
        //todo colors alphas ratiosๆฐ้ไธไธ่ดๆๅตๅค็
        var l = colors.length;
        for (var i = 0; i < l; i++) {
            gradient.addColorStop(ratios[i] / 255, getRGBAString(colors[i], alphas[i]));
        }
        return gradient;
    }
    // ๅคๆญๆต่งๅจๆฏๅฆๆฏๆ Uint8ClampedArray
    var use8Clamp = false;
    try {
        use8Clamp = (typeof Uint8ClampedArray !== undefined);
    }
    catch (e) { }
    function setArray(a, b, index) {
        if (index === void 0) {
            index = 0;
        }
        for (var i = 0, l = b.length; i < l; i++) {
            a[i + index] = b[i];
        }
    }
    /**
     * @private
     */
    function colorFilter(buffer, w, h, matrix) {
        var r0 = matrix[0], r1 = matrix[1], r2 = matrix[2], r3 = matrix[3], r4 = matrix[4];
        var g0 = matrix[5], g1 = matrix[6], g2 = matrix[7], g3 = matrix[8], g4 = matrix[9];
        var b0 = matrix[10], b1 = matrix[11], b2 = matrix[12], b3 = matrix[13], b4 = matrix[14];
        var a0 = matrix[15], a1 = matrix[16], a2 = matrix[17], a3 = matrix[18], a4 = matrix[19];
        for (var p = 0, e = w * h * 4; p < e; p += 4) {
            var r = buffer[p + 0];
            var g = buffer[p + 1];
            var b = buffer[p + 2];
            var a = buffer[p + 3];
            buffer[p + 0] = r0 * r + r1 * g + r2 * b + r3 * a + r4;
            buffer[p + 1] = g0 * r + g1 * g + g2 * b + g3 * a + g4;
            buffer[p + 2] = b0 * r + b1 * g + b2 * b + b3 * a + b4;
            buffer[p + 3] = a0 * r + a1 * g + a2 * b + a3 * a + a4;
        }
    }
    /**
     * @private
     */
    function blurFilter(buffer, w, h, blurX, blurY) {
        blurFilterH(buffer, w, h, blurX);
        blurFilterV(buffer, w, h, blurY);
    }
    /**
     * @private
     */
    function blurFilterH(buffer, w, h, blurX) {
        var lineBuffer;
        if (use8Clamp) {
            lineBuffer = new Uint8ClampedArray(w * 4);
        }
        else {
            lineBuffer = new Array(w * 4);
        }
        var lineSize = w * 4;
        var windowLength = (blurX * 2) + 1;
        var windowSize = windowLength * 4;
        for (var y = 0; y < h; y++) {
            var pLineStart = y * lineSize;
            var rs = 0, gs = 0, bs = 0, _as = 0, alpha = 0, alpha2 = 0;
            // Fill window
            for (var ptr = -blurX * 4, end = blurX * 4 + 4; ptr < end; ptr += 4) {
                var key = pLineStart + ptr;
                if (key < pLineStart || key >= pLineStart + lineSize) {
                    continue;
                }
                alpha = buffer[key + 3];
                rs += buffer[key + 0] * alpha;
                gs += buffer[key + 1] * alpha;
                bs += buffer[key + 2] * alpha;
                _as += alpha;
            }
            // Slide window
            for (var ptr = pLineStart, end = pLineStart + lineSize, linePtr = 0, lastPtr = ptr - blurX * 4, nextPtr = ptr + (blurX + 1) * 4; ptr < end; ptr += 4, linePtr += 4, nextPtr += 4, lastPtr += 4) {
                if (_as === 0) {
                    lineBuffer[linePtr + 0] = 0;
                    lineBuffer[linePtr + 1] = 0;
                    lineBuffer[linePtr + 2] = 0;
                    lineBuffer[linePtr + 3] = 0;
                }
                else {
                    lineBuffer[linePtr + 0] = rs / _as;
                    lineBuffer[linePtr + 1] = gs / _as;
                    lineBuffer[linePtr + 2] = bs / _as;
                    lineBuffer[linePtr + 3] = _as / windowLength;
                }
                alpha = buffer[nextPtr + 3];
                alpha2 = buffer[lastPtr + 3];
                if (alpha || alpha == 0) {
                    if (alpha2 || alpha2 == 0) {
                        rs += buffer[nextPtr + 0] * alpha - buffer[lastPtr + 0] * alpha2;
                        gs += buffer[nextPtr + 1] * alpha - buffer[lastPtr + 1] * alpha2;
                        bs += buffer[nextPtr + 2] * alpha - buffer[lastPtr + 2] * alpha2;
                        _as += alpha - alpha2;
                    }
                    else {
                        rs += buffer[nextPtr + 0] * alpha;
                        gs += buffer[nextPtr + 1] * alpha;
                        bs += buffer[nextPtr + 2] * alpha;
                        _as += alpha;
                    }
                }
                else {
                    if (alpha2 || alpha2 == 0) {
                        rs += -buffer[lastPtr + 0] * alpha2;
                        gs += -buffer[lastPtr + 1] * alpha2;
                        bs += -buffer[lastPtr + 2] * alpha2;
                        _as += -alpha2;
                    }
                    else {
                        // do nothing
                    }
                }
            }
            // Copy line
            if (use8Clamp) {
                buffer.set(lineBuffer, pLineStart);
            }
            else {
                setArray(buffer, lineBuffer, pLineStart);
            }
        }
    }
    /**
     * @private
     */
    function blurFilterV(buffer, w, h, blurY) {
        var columnBuffer;
        if (use8Clamp) {
            columnBuffer = new Uint8ClampedArray(h * 4);
        }
        else {
            columnBuffer = new Array(h * 4);
        }
        var stride = w * 4;
        var windowLength = (blurY * 2) + 1;
        for (var x = 0; x < w; x++) {
            var pColumnStart = x * 4;
            var rs = 0, gs = 0, bs = 0, _as = 0, alpha = 0, alpha2 = 0;
            // Fill window
            for (var ptr = -blurY * stride, end = blurY * stride + stride; ptr < end; ptr += stride) {
                var key = pColumnStart + ptr;
                if (key < pColumnStart || key >= pColumnStart + h * stride) {
                    continue;
                }
                alpha = buffer[key + 3];
                rs += buffer[key + 0] * alpha;
                gs += buffer[key + 1] * alpha;
                bs += buffer[key + 2] * alpha;
                _as += alpha;
            }
            // Slide window
            for (var ptr = pColumnStart, end = pColumnStart + h * stride, columnPtr = 0, lastPtr = pColumnStart - blurY * stride, nextPtr = pColumnStart + ((blurY + 1) * stride); ptr < end; ptr += stride, columnPtr += 4, nextPtr += stride, lastPtr += stride) {
                if (_as === 0) {
                    columnBuffer[columnPtr + 0] = 0;
                    columnBuffer[columnPtr + 1] = 0;
                    columnBuffer[columnPtr + 2] = 0;
                    columnBuffer[columnPtr + 3] = 0;
                }
                else {
                    columnBuffer[columnPtr + 0] = rs / _as;
                    columnBuffer[columnPtr + 1] = gs / _as;
                    columnBuffer[columnPtr + 2] = bs / _as;
                    columnBuffer[columnPtr + 3] = _as / windowLength;
                }
                alpha = buffer[nextPtr + 3];
                alpha2 = buffer[lastPtr + 3];
                if (alpha || alpha == 0) {
                    if (alpha2 || alpha2 == 0) {
                        rs += buffer[nextPtr + 0] * alpha - buffer[lastPtr + 0] * alpha2;
                        gs += buffer[nextPtr + 1] * alpha - buffer[lastPtr + 1] * alpha2;
                        bs += buffer[nextPtr + 2] * alpha - buffer[lastPtr + 2] * alpha2;
                        _as += alpha - alpha2;
                    }
                    else {
                        rs += buffer[nextPtr + 0] * alpha;
                        gs += buffer[nextPtr + 1] * alpha;
                        bs += buffer[nextPtr + 2] * alpha;
                        _as += alpha;
                    }
                }
                else {
                    if (alpha2 || alpha2 == 0) {
                        rs += -buffer[lastPtr + 0] * alpha2;
                        gs += -buffer[lastPtr + 1] * alpha2;
                        bs += -buffer[lastPtr + 2] * alpha2;
                        _as += -alpha2;
                    }
                    else {
                        // do nothing
                    }
                }
            }
            // Copy column
            for (var i = x * 4, end = i + h * stride, j = 0; i < end; i += stride, j += 4) {
                buffer[i + 0] = columnBuffer[j + 0];
                buffer[i + 1] = columnBuffer[j + 1];
                buffer[i + 2] = columnBuffer[j + 2];
                buffer[i + 3] = columnBuffer[j + 3];
            }
        }
    }
    // function glowFilter(buffer, w, h, color, blurX, blurY, strength) {
    //     dropShadowFilter(buffer, w, h, color, blurX, blurY, 0, 0, strength)
    // }
    function dropShadowFilter(buffer, w, h, color, blurX, blurY, angle, distance, strength) {
        var tmp = alphaFilter(buffer, color);
        panFilter(tmp, w, h, angle, distance);
        blurFilter(tmp, w, h, blurX, blurY);
        scaleAlphaChannel(tmp, strength);
        compositeSourceOver(tmp, buffer);
        buffer.set(tmp);
        if (use8Clamp) {
            buffer.set(tmp);
        }
        else {
            setArray(buffer, tmp);
        }
    }
    function alphaFilter(buffer, color) {
        if (!color) {
            color = [0, 0, 0, 0];
        }
        var plane;
        if (use8Clamp) {
            plane = new Uint8ClampedArray(buffer);
        }
        else {
            plane = new Array(buffer.length);
            setArray(plane, buffer);
        }
        var colorR = color[0];
        var colorG = color[1];
        var colorB = color[2];
        var colorA = color[3];
        for (var ptr = 0, end = plane.length; ptr < end; ptr += 4) {
            var alpha = plane[ptr + 3];
            plane[ptr + 0] = colorR * alpha;
            plane[ptr + 1] = colorG * alpha;
            plane[ptr + 2] = colorB * alpha;
            plane[ptr + 3] = colorA * alpha;
        }
        return plane;
    }
    function panFilter(buffer, w, h, angle, distance) {
        var dy = (Math.sin(angle) * distance) | 0;
        var dx = (Math.cos(angle) * distance) | 0;
        var oldBuffer, newBuffer;
        if (use8Clamp) {
            oldBuffer = new Int32Array(buffer.buffer);
            newBuffer = new Int32Array(oldBuffer.length);
            for (var oy = 0; oy < h; oy++) {
                var ny = oy + dy;
                if (ny < 0 || ny > h) {
                    continue;
                }
                for (var ox = 0; ox < w; ox++) {
                    var nx = ox + dx;
                    if (nx < 0 || nx > w) {
                        continue;
                    }
                    newBuffer[ny * w + nx] = oldBuffer[oy * w + ox];
                }
            }
            oldBuffer.set(newBuffer);
        }
        else {
            oldBuffer = buffer;
            newBuffer = new Array(oldBuffer.length);
            for (var oy = 0; oy < h; oy++) {
                var ny = oy + dy;
                if (ny < 0 || ny > h) {
                    continue;
                }
                for (var ox = 0; ox < w; ox++) {
                    var nx = ox + dx;
                    if (nx < 0 || nx > w) {
                        continue;
                    }
                    newBuffer[(ny * w + nx) * 4 + 0] = oldBuffer[(oy * w + ox) * 4 + 0];
                    newBuffer[(ny * w + nx) * 4 + 1] = oldBuffer[(oy * w + ox) * 4 + 1];
                    newBuffer[(ny * w + nx) * 4 + 2] = oldBuffer[(oy * w + ox) * 4 + 2];
                    newBuffer[(ny * w + nx) * 4 + 3] = oldBuffer[(oy * w + ox) * 4 + 3];
                }
            }
            setArray(oldBuffer, newBuffer);
        }
    }
    function scaleAlphaChannel(buffer, value) {
        for (var ptr = 0, end = buffer.length; ptr < end; ptr += 4) {
            buffer[ptr + 3] *= value;
        }
    }
    function compositeSourceOver(dst, src) {
        for (var ptr = 0, end = dst.length; ptr < end; ptr += 4) {
            var Dr = dst[ptr + 0];
            var Dg = dst[ptr + 1];
            var Db = dst[ptr + 2];
            var Da = dst[ptr + 3] / 255;
            var Sr = src[ptr + 0];
            var Sg = src[ptr + 1];
            var Sb = src[ptr + 2];
            var Sa = src[ptr + 3] / 255;
            dst[ptr + 0] = Sr + Dr * (1 - Sa);
            dst[ptr + 1] = Sg + Dg * (1 - Sa);
            dst[ptr + 2] = Sb + Db * (1 - Sa);
            dst[ptr + 3] = (Sa + Da * (1 - Sa)) * 255;
        }
    }
    function getPixelKey(w, x, y) {
        return y * w * 4 + x * 4;
    }
    function mix(v1, v2, rate) {
        return v1 * (1 - rate) + v2 * rate;
    }
    // dropShadowFilter2
    // ๆจกๆshaderไธญ็็ฎๆณ๏ผๅฏไปฅๅฎ็ฐๅๅๅ๏ผๆ็ฉบ็ญ้ซ็บงๆๆ
    function dropShadowFilter2(buffer, w, h, color, blurX, blurY, angle, distance, strength, inner, knockout, hideObject) {
        var plane;
        if (use8Clamp) {
            plane = new Uint8ClampedArray(buffer.length);
        }
        else {
            plane = new Array(buffer.length);
        }
        var alpha = color[3];
        var curDistanceX = 0;
        var curDistanceY = 0;
        var offsetX = distance * Math.cos(angle);
        var offsetY = distance * Math.sin(angle);
        var linearSamplingTimes = 7.0;
        var circleSamplingTimes = 12.0;
        var PI = 3.14159265358979323846264;
        var cosAngle;
        var sinAngle;
        var stepX = blurX / linearSamplingTimes;
        var stepY = blurY / linearSamplingTimes;
        // ้ๅๅ็ด
        for (var u = 0; u < w; u++) {
            for (var v = 0; v < h; v++) {
                // ๆญคๅคไธบไบ้ฟๅๆฏๅบๅฏไปฅๆทปๅไธไธช้ๆบๅผ
                var offset = 0;
                // ๅค็ๅไธชๅ็ด
                var key = v * w * 4 + u * 4;
                var totalAlpha = 0;
                var maxTotalAlpha = 0;
                // ้ๆทๅบๆฅ็่ฒๅผ
                var _r = buffer[key + 0] / 255;
                var _g = buffer[key + 1] / 255;
                var _b = buffer[key + 2] / 255;
                var _a = buffer[key + 3] / 255;
                for (var a = 0; a <= PI * 2; a += PI * 2 / circleSamplingTimes) {
                    cosAngle = Math.cos(a + offset);
                    sinAngle = Math.sin(a + offset);
                    for (var i = 0; i < linearSamplingTimes; i++) {
                        curDistanceX = i * stepX * cosAngle;
                        curDistanceY = i * stepY * sinAngle;
                        var _u = Math.round(u + curDistanceX - offsetX);
                        var _v = Math.round(v + curDistanceY - offsetY);
                        var __a = 0;
                        if (_u >= w || _u < 0 || _v < 0 || _v >= h) {
                            __a = 0;
                        }
                        else {
                            var _key = _v * w * 4 + _u * 4;
                            __a = buffer[_key + 3] / 255;
                        }
                        totalAlpha += (linearSamplingTimes - i) * __a;
                        maxTotalAlpha += (linearSamplingTimes - i);
                    }
                }
                _a = Math.max(_a, 0.0001);
                // 'ownColor.rgb = ownColor.rgb / ownColor.a;',
                var outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * Math.max(Math.min(hideObject, knockout), 1. - _a);
                var innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * _a;
                _a = Math.max(_a * knockout * (1 - hideObject), 0.0001);
                var rate1 = innerGlowAlpha / (innerGlowAlpha + _a);
                var r1 = mix(_r, color[0], rate1);
                var g1 = mix(_g, color[1], rate1);
                var b1 = mix(_b, color[2], rate1);
                var rate2 = outerGlowAlpha / (innerGlowAlpha + _a + outerGlowAlpha);
                var r2 = mix(r1, color[0], rate2);
                var g2 = mix(g1, color[1], rate2);
                var b2 = mix(b1, color[2], rate2);
                var resultAlpha = Math.min(_a + outerGlowAlpha + innerGlowAlpha, 1);
                // ่ตๅผ้ข่ฒ
                plane[key + 0] = r2 * 255;
                plane[key + 1] = g2 * 255;
                plane[key + 2] = b2 * 255;
                plane[key + 3] = resultAlpha * 255;
            }
        }
        if (use8Clamp) {
            buffer.set(plane);
        }
        else {
            setArray(buffer, plane);
        }
    }
})(egret || (egret = {}));
var egret;
(function (egret) {
    /**
     * @copy egret.Orientation
     */
    egret.DeviceOrientation = null;
})(egret || (egret = {}));
var egret;
(function (egret) {
})(egret || (egret = {}));
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Type of operation.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ฟ่ก็ฑปๅ็็ฑปๅใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var RuntimeType = (function () {
        function RuntimeType() {
        }
        /**
         * Running on Web
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟ่กๅจWebไธ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        RuntimeType.WEB = "web";
        /**
         * Running on NATIVE
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟ่กๅจNATIVEไธ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        RuntimeType.NATIVE = "native";
        return RuntimeType;
    }());
    egret.RuntimeType = RuntimeType;
    __reflect(RuntimeType.prototype, "egret.RuntimeType");
    /**
     * The Capabilities class provides properties that describe the system and runtime that are hosting the application.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/system/Capabilities.ts
     * @language en_US
     */
    /**
     * Capabilities ็ฑปๆไพไธไบๅฑๆง๏ผ่ฟไบๅฑๆงๆ่ฟฐไบๆฟ่ฝฝๅบ็จ็จๅบ็็ณป็ปๅ่ฟ่กๆถใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/system/Capabilities.ts
     * @language zh_CN
     */
    var Capabilities = (function () {
        function Capabilities() {
        }
        Object.defineProperty(Capabilities, "language", {
            /**
             * Specifies the language code of the system on which the content is running. The language is specified as a lowercase
             * two-letter language code from ISO 639-1. For Chinese, an additional uppercase two-letter country code from ISO 3166
             * distinguishes between Simplified and Traditional Chinese.<br/>
             * The following table lists the possible values,but not limited to them:
             * <ul>
             * <li>Simplified    Chinese  zh-CN</li>
             * <li>Traditional   Chinese  zh-TW</li>
             * <li>English       en</li>
             * <li>Japanese      ja</li>
             * <li>Korean        ko</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ่ฟ่กๅๅฎน็็ณป็ป็่ฏญ่จไปฃ็ใ่ฏญ่จๆๅฎไธบ ISO 639-1 ไธญ็ๅฐๅๅๅญๆฏ่ฏญ่จไปฃ็ใ
             * ๅฏนไบไธญๆ๏ผๅฆๅคไฝฟ็จ ISO 3166 ไธญ็ๅคงๅๅๅญๆฏๅฝๅฎถ/ๅฐๅบไปฃ็๏ผไปฅๅบๅ็ฎไฝไธญๆๅ็นไฝไธญๆใ<br/>
             * ไปฅไธๆฏๅฏ่ฝไฝไธ้ไบ็่ฏญ่จๅๅผ๏ผ
             * <ul>
             * <li>็ฎไฝไธญๆ  zh-CN</li>
             * <li>็นไฝไธญๆ  zh-TW</li>
             * <li>่ฑ่ฏญ      en</li>
             * <li>ๆฅ่ฏญ      ja</li>
             * <li>้ฉ่ฏญ      ko</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$language;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "isMobile", {
            /**
             * Specifies whether the system is running in a mobile device.(such as a mobile phone or tablet)
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบ็จๅบๅๅฎนๆฏๅฆ่ฟ่กๅจ็งปๅจ่ฎพๅคไธญ๏ผไพๅฆ็งปๅจ็ต่ฏๆๅนณๆฟ็ต่๏ผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$isMobile;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "os", {
            /**
             * Specifies the current operating system. The os property can return the following strings:
             * <ul>
             * <li>iPhone            "iOS"</li>
             * <li>Android Phone     "Android"</li>
             * <li>Windows Phone     "Windows Phone"</li>
             * <li>Windows Desktop   "Windows PC"</li>
             * <li>Mac Desktop       "Mac OS"</li>
             * <li>Unknown OS        "Unknown"</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ็คบๅฝๅ็ๆไฝ็ณป็ปใos ๅฑๆง่ฟๅไธๅๅญ็ฌฆไธฒ๏ผ
             * <ul>
             * <li>่นๆๆๆบๆไฝ็ณป็ป     "iOS"</li>
             * <li>ๅฎๅๆๆบๆไฝ็ณป็ป     "Android"</li>
             * <li>ๅพฎ่ฝฏๆๆบๆไฝ็ณป็ป     "Windows Phone"</li>
             * <li>ๅพฎ่ฝฏๆก้ขๆไฝ็ณป็ป     "Windows PC"</li>
             * <li>่นๆๆก้ขๆไฝ็ณป็ป     "Mac OS"</li>
             * <li>ๆช็ฅๆไฝ็ณป็ป        "Unknown"</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$os;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "runtimeType", {
            /**
             * It indicates the current type of operation. runtimeType property returns the following string:
             * <ul>
             * <li>Run on Web     egret.RuntimeType.WEB</li>
             * <li>Run on Native     egret.RuntimeType.NATIVE</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ็คบๅฝๅ็่ฟ่ก็ฑปๅใruntimeType ๅฑๆง่ฟๅไธๅๅญ็ฌฆไธฒ๏ผ
             * <ul>
             * <li>่ฟ่กๅจWebไธ     egret.RuntimeType.WEB</li>
             * <li>่ฟ่กๅจNativeไธ     egret.RuntimeType.NATIVE</li>
             * </ul>
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$runtimeType;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "supportVersion", {
            /***
             * version of the native support.
             * @type {string}
             * @version Egret 2.5
             * @platform Web,Native
             * @language en_US
             */
            /***
             * native support ็็ๆฌๅทใ
             * @type {string}
             * @version Egret 2.5
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$supportVersion;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "engineVersion", {
            /***
             * version of Egret.
             * @type {string}
             * @version Egret 3.2.0
             * @platform Web,Native
             * @language en_US
             */
            /***
             * Egret ็็ๆฌๅทใ
             * @type {string}
             * @version Egret 3.2.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return "5.0.7";
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ฎพ็ฝฎ็ณป็ปไฟกๆฏ
         */
        Capabilities.$setNativeCapabilities = function (value) {
            var arr = value.split("-");
            if (arr.length <= 4) {
                //todo ๆชๆฅๅปๆๆฐ้ๅคๆญ๏ผ2.5.4็ๆฌไนๅ็ๅๆฐๅคงไบ4ไธช
                var osType = arr[0];
                switch (osType) {
                    case "android":
                        osType = "Android";
                        break;
                    case "ios":
                        osType = 'iOS';
                        break;
                }
                Capabilities.$os = osType;
                var version = arr[2].substring(1, arr[2].length);
                Capabilities.$supportVersion = version;
            }
        };
        Object.defineProperty(Capabilities, "renderMode", {
            /***
             * current render mode.
             * @type {string}
             * @version Egret 3.0.7
             * @platform Web,Native
             * @language en_US
             */
            /***
             * ๅฝๅๆธฒๆๆจกๅผใ
             * @type {string}
             * @version Egret 3.0.7
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$renderMode;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "boundingClientWidth", {
            /***
             * Clients border width.
             * The value before the document class initialization is always 0.
             * This value will change after the distribution Event.RESIZE and StageOrientationEvent.ORIENTATION_CHANGE.
             * @version Egret 3.1.3
             * @platform Web,Native
             * @language en_US
             */
            /***
             * ๅฎขๆท็ซฏ่พน็ๅฎฝๅบฆใ
             * ่ฏฅๅผๅจๆๆกฃ็ฑปๅๅงๅไนๅๅง็ปๆฏ0ใ
             * ่ฏฅๅผๅจๆดพๅ Event.RESIZE ไปฅๅ StageOrientationEvent.ORIENTATION_CHANGE ไนๅไผๅ็ๆนๅใ
             * @version Egret 3.1.3
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$boundingClientWidth;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Capabilities, "boundingClientHeight", {
            /***
             * Clients border height.
             * The value before the document class initialization is always 0.
             * This value will change after the distribution Event.RESIZE and StageOrientationEvent.ORIENTATION_CHANGE.
             * @version Egret 3.1.3
             * @platform Web,Native
             * @language en_US
             */
            /***
             * ๅฎขๆท็ซฏ่พน็้ซๅบฆใ
             * ่ฏฅๅผๅจๆๆกฃ็ฑปๅๅงๅไนๅๅง็ปๆฏ0ใ
             * ่ฏฅๅผๅจๆดพๅ Event.RESIZE ไปฅๅ StageOrientationEvent.ORIENTATION_CHANGE ไนๅไผๅ็ๆนๅใ
             * @version Egret 3.1.3
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return Capabilities.$boundingClientHeight;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Capabilities.$language = "zh-CN";
        /**
         * @private
         */
        Capabilities.$os = "Unknown";
        /**
         * @private
         */
        Capabilities.$runtimeType = "Unknown";
        Capabilities.$supportVersion = "Unknown";
        Capabilities.$renderMode = "Unknown";
        Capabilities.$boundingClientWidth = 0;
        Capabilities.$boundingClientHeight = 0;
        return Capabilities;
    }());
    egret.Capabilities = Capabilities;
    __reflect(Capabilities.prototype, "egret.Capabilities");
})(egret || (egret = {}));
/**
 * @private
 */
var testDeviceType = function () {
    if (!this["navigator"]) {
        return true;
    }
    var ua = navigator.userAgent.toLowerCase();
    return (ua.indexOf('mobile') != -1 || ua.indexOf('android') != -1);
};
/**
 * @private
 */
var testRuntimeType = function () {
    if (this["navigator"]) {
        return true;
    }
    return false;
};
egret.Capabilities.$isMobile = testDeviceType();
egret.Capabilities.$runtimeType = testRuntimeType() ? egret.RuntimeType.WEB : egret.RuntimeType.NATIVE;
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The BitmapFillMode class defines the image fill mode of Bitmap.
     * The BitmapFillMode class defines a pattern enumeration for adjusting size. These patterns determine how Bitmap fill the size designated by the layout system.
     * @see http://edn.egret.com/cn/docs/page/134 Texture filling way
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/BitmapFillMode.ts
     * @language en_US
     */
    /**
     * BitmapFillMode ็ฑปๅฎไนBitmap็ๅพๅๅกซๅๆนๅผใ
     * BitmapFillMode ็ฑปๅฎไนไบ่ฐๆดๅคงๅฐๆจกๅผ็ไธไธชๆไธพ๏ผ่ฟไบๆจกๅผ็กฎๅฎ Bitmap ๅฆไฝๅกซๅ็ฑๅธๅฑ็ณป็ปๆๅฎ็ๅฐบๅฏธใ
     * @see http://edn.egret.com/cn/docs/page/134 ็บน็็ๅกซๅๆนๅผ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/BitmapFillMode.ts
     * @language zh_CN
     */
    egret.BitmapFillMode = {
        /**
         * Repeat the bitmap to fill area.
         * @version Egret 2.4
         * @platform Web
         * @language en_US
         */
        /**
         * ้ๅคไฝๅพไปฅๅกซๅๅบๅใ
         * @version Egret 2.4
         * @platform Web
         * @language zh_CN
         */
        REPEAT: "repeat",
        /**
         * Scale bitmap fill to fill area.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝๅพๅกซๅๆไผธไปฅๅกซๅๅบๅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        SCALE: "scale",
        /**
         * The bitmap ends at the edge of the region.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅบๅ็่พน็ผๅคๆชๆญไธๆพ็คบไฝๅพใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        CLIP: "clip"
    };
})(egret || (egret = {}));
var egret;
(function (egret) {
    /**
    * @private
    */
    var implMap = {};
    /**
     * Adds an interface-name-to-implementation-class mapping to the registry.
     * @param interfaceName the interface name to register. For example๏ผ"eui.IAssetAdapter","eui.Theme"
     * @param instance the instance to register.
     * @version Egret 3.2.1
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆณจๅไธไธชๆฅๅฃๅฎ็ฐใ
     * @param interfaceName ๆณจๅฅ็ๆฅๅฃๅ็งฐใไพๅฆ๏ผ"eui.IAssetAdapter","eui.Theme"
     * @param instance ๅฎ็ฐๆญคๆฅๅฃ็ๅฎไพใ
     * @version Egret 3.2.1
     * @platform Web,Native
     * @language zh_CN
     */
    function registerImplementation(interfaceName, instance) {
        implMap[interfaceName] = instance;
    }
    egret.registerImplementation = registerImplementation;
    /**
     * Returns the singleton instance of the implementation class that was registered for the specified interface.
     * This method is usually called by egret framework.
     * @param interfaceName The interface name to identify. For example๏ผ"eui.IAssetAdapter","eui.Theme"
     * @returns the singleton instance of the implementation class
     * @version Egret 3.2.1
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ทๅไธไธชๆฅๅฃๅฎ็ฐใๆญคๆนๆณ้ๅธธ็ฑๆกๆถๅ้จ่ฐ็จใ่ทๅ้กน็ฎๆณจๅฅ็่ชๅฎไนๅฎ็ฐๅฎไพใ
     * @param interfaceName ่ฆ่ทๅ็ๆฅๅฃๅ็งฐใไพๅฆ๏ผ"eui.IAssetAdapter","eui.Theme"
     * @returns ่ฟๅๅฎ็ฐๆญคๆฅๅฃ็ๅฎไพใ
     * @version Egret 3.2.1
     * @platform Web,Native
     * @language zh_CN
     */
    function getImplementation(interfaceName) {
        return implMap[interfaceName];
    }
    egret.getImplementation = getImplementation;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Bitmap font, texture set of a font. It is generally used as the value of the BitmapText.font attribute.
     * @see http://bbs.egret-labs.org/thread-918-1-1.html TextureMerger
     * @see http://bbs.egret-labs.org/forum.php?mod=viewthread&tid=251 Text(Containing the specific usage of the bitmap font )
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/BitmapFont.ts
     * @language en_US
     */
    /**
     * ไฝๅพๅญไฝ,ๆฏไธไธชๅญไฝ็็บน็้๏ผ้ๅธธไฝไธบBitmapText.fontๅฑๆง็ๅผใ
     * @see http://bbs.egret-labs.org/thread-918-1-1.html TextureMerger
     * @see http://bbs.egret-labs.org/forum.php?mod=viewthread&tid=251 ๆๆฌ(ๅซไฝๅพๅญไฝๅทไฝ็จๆณ)
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/BitmapFont.ts
     * @language zh_CN
     */
    var BitmapFont = (function (_super) {
        __extends(BitmapFont, _super);
        /**
         * Create an egret.BitmapFont object
         * @param texture {egret.Texture} Texture set that use TextureMerger create
         * @param config {any} Configure data that use TextureMerger create
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.BitmapFont ๅฏน่ฑก
         * @param texture {egret.Texture} ไฝฟ็จTextureMerger็ๆ็็บน็้
         * @param config {any} ไฝฟ็จTextureMerger็ๆ็้็ฝฎๆฐๆฎ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function BitmapFont(texture, config) {
            var _this = _super.call(this, texture) || this;
            /**
             * @private
             */
            _this.firstCharHeight = 0;
            if (typeof (config) == "string") {
                _this.charList = _this.parseConfig(config);
            }
            else if (config && config.hasOwnProperty("frames")) {
                _this.charList = config.frames;
            }
            else {
                _this.charList = {};
            }
            return _this;
        }
        /**
         * Obtain corresponding texture through the name attribute
         * @param name {string} name Attribute
         * @returns {egret.Texture}
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟ name ๅฑๆง่ทๅๅฏนๅบ็บน็
         * @param name {string} nameๅฑๆง
         * @returns {egret.Texture}
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        BitmapFont.prototype.getTexture = function (name) {
            var texture = this._textureMap[name];
            if (!texture) {
                var c = this.charList[name];
                if (!c) {
                    return null;
                }
                texture = this.createTexture(name, c.x, c.y, c.w, c.h, c.offX, c.offY, c.sourceW, c.sourceH);
                this._textureMap[name] = texture;
            }
            return texture;
        };
        /**
         * @private
         */
        BitmapFont.prototype.getConfig = function (name, key) {
            if (!this.charList[name]) {
                return 0;
            }
            return this.charList[name][key];
        };
        /**
         * @private
         *
         * @returns
         */
        BitmapFont.prototype._getFirstCharHeight = function () {
            if (this.firstCharHeight == 0) {
                for (var str in this.charList) {
                    var c = this.charList[str];
                    if (c) {
                        var sourceH = c.sourceH;
                        if (sourceH === undefined) {
                            var h = c.h;
                            if (h === undefined) {
                                h = 0;
                            }
                            var offY = c.offY;
                            if (offY === undefined) {
                                offY = 0;
                            }
                            sourceH = h + offY;
                        }
                        if (sourceH <= 0) {
                            continue;
                        }
                        this.firstCharHeight = sourceH;
                        break;
                    }
                }
            }
            return this.firstCharHeight;
        };
        /**
         * @private
         *
         * @param fntText
         * @returns
         */
        BitmapFont.prototype.parseConfig = function (fntText) {
            fntText = fntText.split("\r\n").join("\n");
            var lines = fntText.split("\n");
            var charsCount = this.getConfigByKey(lines[3], "count");
            var chars = {};
            for (var i = 4; i < 4 + charsCount; i++) {
                var charText = lines[i];
                var letter = String.fromCharCode(this.getConfigByKey(charText, "id"));
                var c = {};
                chars[letter] = c;
                c["x"] = this.getConfigByKey(charText, "x");
                c["y"] = this.getConfigByKey(charText, "y");
                c["w"] = this.getConfigByKey(charText, "width");
                c["h"] = this.getConfigByKey(charText, "height");
                c["offX"] = this.getConfigByKey(charText, "xoffset");
                c["offY"] = this.getConfigByKey(charText, "yoffset");
                c["xadvance"] = this.getConfigByKey(charText, "xadvance");
            }
            return chars;
        };
        /**
         * @private
         *
         * @param configText
         * @param key
         * @returns
         */
        BitmapFont.prototype.getConfigByKey = function (configText, key) {
            var itemConfigTextList = configText.split(" ");
            for (var i = 0, length_9 = itemConfigTextList.length; i < length_9; i++) {
                var itemConfigText = itemConfigTextList[i];
                if (key == itemConfigText.substring(0, key.length)) {
                    var value = itemConfigText.substring(key.length + 1);
                    return parseInt(value);
                }
            }
            return 0;
        };
        return BitmapFont;
    }(egret.SpriteSheet));
    egret.BitmapFont = BitmapFont;
    __reflect(BitmapFont.prototype, "egret.BitmapFont");
})(egret || (egret = {}));
var egret;
(function (egret) {
    /**
     * Bitmap font adopts the Bitmap+SpriteSheet mode to render text.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/BitmapText.ts
     * @language en_US
     */
    /**
     * ไฝๅพๅญไฝ้็จไบBitmap+SpriteSheet็ๆนๅผๆฅๆธฒๆๆๅญใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/BitmapText.ts
     * @language zh_CN
     */
    var BitmapText = (function (_super) {
        __extends(BitmapText, _super);
        /**
         * Create an egret.BitmapText object
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช egret.BitmapText ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function BitmapText() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$textOffsetX = 0;
            /**
             * @private
             */
            _this.$textOffsetY = 0;
            /**
             * @private
             */
            _this.$textStartX = 0;
            /**
             * @private
             */
            _this.$textStartY = 0;
            /**
             * @private
             */
            _this.textLines = [];
            /**
             * @private
             */
            _this.$lineHeights = [];
            _this.$renderNode = new egret.sys.BitmapNode();
            //this.cacheAsBitmap = true;
            _this.$BitmapText = {
                0: NaN,
                1: NaN,
                2: "",
                3: 0,
                4: 0,
                5: null,
                6: false,
                7: false,
                8: false,
                9: false,
                10: "left",
                11: "top",
                12: egret.Bitmap.defaultSmoothing //smoothing
            };
            return _this;
        }
        Object.defineProperty(BitmapText.prototype, "smoothing", {
            /**
             * Whether or not is smoothed when scaled.
             * @default trueใ
             * @version Egret 3.0
             * @platform Web
             * @language en_US
             */
            /**
             * ๆงๅถๅจ็ผฉๆพๆถๆฏๅฆ่ฟ่กๅนณๆปๅค็ใ
             * @default trueใ
             * @version Egret 3.0
             * @platform Web
             * @language zh_CN
             */
            get: function () {
                var values = this.$BitmapText;
                return values[12 /* smoothing */];
            },
            set: function (value) {
                value = !!value;
                var values = this.$BitmapText;
                if (value == values[12 /* smoothing */]) {
                    return;
                }
                values[12 /* smoothing */] = value;
                this.$invalidate();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BitmapText.prototype, "text", {
            /**
             * A string to display in the text field.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๆพ็คบ็ๆๆฌๅๅฎน
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[2 /* text */];
            },
            set: function (value) {
                this.$setText(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        BitmapText.prototype.$setText = function (value) {
            if (value == null) {
                value = "";
            }
            value = String(value);
            var values = this.$BitmapText;
            if (value == values[2 /* text */])
                return false;
            values[2 /* text */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         */
        BitmapText.prototype.$getWidth = function () {
            var w = this.$BitmapText[0 /* textFieldWidth */];
            return isNaN(w) ? this.$getContentBounds().width : w;
        };
        /**
         * @private
         */
        BitmapText.prototype.$setWidth = function (value) {
            //value = +value || 0;
            var values = this.$BitmapText;
            if (value < 0 || value == values[0 /* textFieldWidth */]) {
                return false;
            }
            values[0 /* textFieldWidth */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         */
        BitmapText.prototype.$invalidateContentBounds = function () {
            _super.prototype.$invalidateContentBounds.call(this);
            this.$BitmapText[7 /* textLinesChanged */] = true;
        };
        /**
         * @private
         */
        BitmapText.prototype.$getHeight = function () {
            var h = this.$BitmapText[1 /* textFieldHeight */];
            return isNaN(h) ? this.$getContentBounds().height : h;
        };
        /**
         * @private
         */
        BitmapText.prototype.$setHeight = function (value) {
            //value = +value || 0;
            var values = this.$BitmapText;
            if (value < 0 || value == values[1 /* textFieldHeight */]) {
                return false;
            }
            values[1 /* textFieldHeight */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        Object.defineProperty(BitmapText.prototype, "font", {
            /**
             * The name of the font to use, or a comma-separated list of font names, the type of value must be BitmapFont.
             * @default null
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆไฝฟ็จ็ๅญไฝ็ๅ็งฐๆ็จ้ๅทๅ้็ๅญไฝๅ็งฐๅ่กจ๏ผ็ฑปๅๅฟ้กปๆฏ BitmapFontใ
             * @default null
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[5 /* font */];
            },
            set: function (value) {
                this.$setFont(value);
            },
            enumerable: true,
            configurable: true
        });
        BitmapText.prototype.$setFont = function (value) {
            var values = this.$BitmapText;
            if (values[5 /* font */] == value) {
                return false;
            }
            values[5 /* font */] = value;
            this.$BitmapText[6 /* fontStringChanged */] = true;
            this.$invalidateContentBounds();
            return true;
        };
        Object.defineProperty(BitmapText.prototype, "lineSpacing", {
            /**
             /**
             * An integer representing the amount of vertical space between lines.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธไธชๆดๆฐ๏ผ่กจ็คบ่กไธ่กไน้ด็ๅ็ด้ด่ท้
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[3 /* lineSpacing */];
            },
            set: function (value) {
                this.$setLineSpacing(value);
            },
            enumerable: true,
            configurable: true
        });
        BitmapText.prototype.$setLineSpacing = function (value) {
            value = +value || 0;
            var values = this.$BitmapText;
            if (values[3 /* lineSpacing */] == value)
                return false;
            values[3 /* lineSpacing */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        Object.defineProperty(BitmapText.prototype, "letterSpacing", {
            /**
             * An integer representing the amount of distance between characters.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธไธชๆดๆฐ๏ผ่กจ็คบๅญ็ฌฆไน้ด็่ท็ฆปใ
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[4 /* letterSpacing */];
            },
            set: function (value) {
                this.$setLetterSpacing(value);
            },
            enumerable: true,
            configurable: true
        });
        BitmapText.prototype.$setLetterSpacing = function (value) {
            value = +value || 0;
            var values = this.$BitmapText;
            if (values[4 /* letterSpacing */] == value)
                return false;
            values[4 /* letterSpacing */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        Object.defineProperty(BitmapText.prototype, "textAlign", {
            /**
             * Horizontal alignment of text.
             * @default๏ผegret.HorizontalAlign.LEFT
             * @version Egret 2.5.6
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌ็ๆฐดๅนณๅฏน้ฝๆนๅผใ
             * @default๏ผegret.HorizontalAlign.LEFT
             * @version Egret 2.5.6
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[10 /* textAlign */];
            },
            set: function (value) {
                this.$setTextAlign(value);
            },
            enumerable: true,
            configurable: true
        });
        BitmapText.prototype.$setTextAlign = function (value) {
            var values = this.$BitmapText;
            if (values[10 /* textAlign */] == value)
                return false;
            values[10 /* textAlign */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        Object.defineProperty(BitmapText.prototype, "verticalAlign", {
            /**
             * Vertical alignment of text.
             * @default๏ผegret.VerticalAlign.TOP
             * @version Egret 2.5.6
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅญ็ๅ็ดๅฏน้ฝๆนๅผใ
             * @default๏ผegret.VerticalAlign.TOP
             * @version Egret 2.5.6
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$BitmapText[11 /* verticalAlign */];
            },
            set: function (value) {
                this.$setVerticalAlign(value);
            },
            enumerable: true,
            configurable: true
        });
        BitmapText.prototype.$setVerticalAlign = function (value) {
            var values = this.$BitmapText;
            if (values[11 /* verticalAlign */] == value)
                return false;
            values[11 /* verticalAlign */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @private
         */
        BitmapText.prototype.$render = function () {
            var values = this.$BitmapText;
            var textLines = this.$getTextLines();
            var length = textLines.length;
            if (length == 0) {
                return;
            }
            var textLinesWidth = this.$textLinesWidth;
            var bitmapFont = values[5 /* font */];
            var node = this.$renderNode;
            if (bitmapFont.$texture) {
                node.image = bitmapFont.$texture._bitmapData;
            }
            node.smoothing = values[12 /* smoothing */];
            var emptyHeight = bitmapFont._getFirstCharHeight();
            var emptyWidth = Math.ceil(emptyHeight * BitmapText.EMPTY_FACTOR);
            var hasSetHeight = !isNaN(values[1 /* textFieldHeight */]);
            var textWidth = values[8 /* textWidth */];
            var textFieldWidth = values[0 /* textFieldWidth */];
            var textFieldHeight = values[1 /* textFieldHeight */];
            var align = values[10 /* textAlign */];
            var yPos = this.$textOffsetY + this.$textStartY;
            var lineHeights = this.$lineHeights;
            for (var i = 0; i < length; i++) {
                var lineHeight = lineHeights[i];
                if (hasSetHeight && i > 0 && yPos + lineHeight > textFieldHeight) {
                    break;
                }
                var line = textLines[i];
                var len = line.length;
                var xPos = this.$textOffsetX;
                if (align != egret.HorizontalAlign.LEFT) {
                    var countWidth = textFieldWidth > textWidth ? textFieldWidth : textWidth;
                    if (align == egret.HorizontalAlign.RIGHT) {
                        xPos += countWidth - textLinesWidth[i];
                    }
                    else if (align == egret.HorizontalAlign.CENTER) {
                        xPos += Math.floor((countWidth - textLinesWidth[i]) / 2);
                    }
                }
                for (var j = 0; j < len; j++) {
                    var character = line.charAt(j);
                    var texture = bitmapFont.getTexture(character);
                    if (!texture) {
                        if (character == " ") {
                            xPos += emptyWidth;
                        }
                        else {
                            egret.$warn(1046, character);
                        }
                        continue;
                    }
                    var bitmapWidth = texture._bitmapWidth;
                    var bitmapHeight = texture._bitmapHeight;
                    node.imageWidth = texture._sourceWidth;
                    node.imageHeight = texture._sourceHeight;
                    node.drawImage(texture._bitmapX, texture._bitmapY, bitmapWidth, bitmapHeight, xPos + texture._offsetX, yPos + texture._offsetY, texture.$getScaleBitmapWidth(), texture.$getScaleBitmapHeight());
                    xPos += (bitmapFont.getConfig(character, "xadvance") || texture.$getTextureWidth()) + values[4 /* letterSpacing */];
                }
                yPos += lineHeight + values[3 /* lineSpacing */];
            }
        };
        /**
         * @private
         */
        BitmapText.prototype.$measureContentBounds = function (bounds) {
            var lines = this.$getTextLines();
            if (lines.length == 0) {
                bounds.setEmpty();
            }
            else {
                bounds.setTo(this.$textOffsetX + this.$textStartX, this.$textOffsetY + this.$textStartY, this.$BitmapText[8 /* textWidth */] - this.$textOffsetX, this.$BitmapText[9 /* textHeight */] - this.$textOffsetY);
            }
        };
        Object.defineProperty(BitmapText.prototype, "textWidth", {
            /**
             * Get the BitmapText measured width
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅไฝๅพๆๆฌๆต้ๅฎฝๅบฆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getTextLines();
                return this.$BitmapText[8 /* textWidth */];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(BitmapText.prototype, "textHeight", {
            /**
             * Get Text BitmapText height
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅไฝๅพๆๆฌๆต้้ซๅบฆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getTextLines();
                return this.$BitmapText[9 /* textHeight */];
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        BitmapText.prototype.$getTextLines = function () {
            var values = this.$BitmapText;
            if (!values[7 /* textLinesChanged */]) {
                return this.textLines;
            }
            var textLines = [];
            this.textLines = textLines;
            var textLinesWidth = [];
            this.$textLinesWidth = textLinesWidth;
            values[7 /* textLinesChanged */] = false;
            var lineHeights = [];
            this.$lineHeights = lineHeights;
            if (!values[2 /* text */] || !values[5 /* font */]) {
                return textLines;
            }
            var lineSpacing = values[3 /* lineSpacing */];
            var letterSpacing = values[4 /* letterSpacing */];
            var textWidth = 0;
            var textHeight = 0;
            var textOffsetX = 0;
            var textOffsetY = 0;
            var hasWidthSet = !isNaN(values[0 /* textFieldWidth */]);
            var textFieldWidth = values[0 /* textFieldWidth */];
            var textFieldHeight = values[1 /* textFieldHeight */];
            var bitmapFont = values[5 /* font */];
            var emptyHeight = bitmapFont._getFirstCharHeight();
            var emptyWidth = Math.ceil(emptyHeight * BitmapText.EMPTY_FACTOR);
            var text = values[2 /* text */];
            var textArr = text.split(/(?:\r\n|\r|\n)/);
            var length = textArr.length;
            var isFirstLine = true;
            var isFirstChar;
            var isLastChar;
            var lineHeight;
            var xPos;
            for (var i = 0; i < length; i++) {
                var line = textArr[i];
                var len = line.length;
                lineHeight = 0;
                xPos = 0;
                isFirstChar = true;
                isLastChar = false;
                for (var j = 0; j < len; j++) {
                    if (!isFirstChar) {
                        xPos += letterSpacing;
                    }
                    var character = line.charAt(j);
                    var texureWidth = void 0;
                    var textureHeight = void 0;
                    var offsetX = 0;
                    var offsetY = 0;
                    var texture = bitmapFont.getTexture(character);
                    if (!texture) {
                        if (character == " ") {
                            texureWidth = emptyWidth;
                            textureHeight = emptyHeight;
                        }
                        else {
                            egret.$warn(1046, character);
                            if (isFirstChar) {
                                isFirstChar = false;
                            }
                            continue;
                        }
                    }
                    else {
                        texureWidth = texture.$getTextureWidth();
                        textureHeight = texture.$getTextureHeight();
                        offsetX = texture._offsetX;
                        offsetY = texture._offsetY;
                    }
                    if (isFirstChar) {
                        isFirstChar = false;
                        textOffsetX = Math.min(offsetX, textOffsetX);
                    }
                    if (isFirstLine) {
                        isFirstLine = false;
                        textOffsetY = Math.min(offsetY, textOffsetY);
                    }
                    if (hasWidthSet && j > 0 && xPos + texureWidth > textFieldWidth) {
                        if (!setLineData(line.substring(0, j)))
                            break;
                        line = line.substring(j);
                        len = line.length;
                        j = 0;
                        //ๆๅไธไธชๅญ็ฌฆ่ฆ่ฎก็ฎ็บน็ๅฎฝๅบฆ๏ผ่ไธๆฏxadvance
                        if (j == len - 1) {
                            xPos = texureWidth;
                        }
                        else {
                            xPos = bitmapFont.getConfig(character, "xadvance") || texureWidth;
                        }
                        lineHeight = textureHeight;
                        continue;
                    }
                    //ๆๅไธไธชๅญ็ฌฆ่ฆ่ฎก็ฎ็บน็ๅฎฝๅบฆ๏ผ่ไธๆฏxadvance
                    if (j == len - 1) {
                        xPos += texureWidth;
                    }
                    else {
                        xPos += bitmapFont.getConfig(character, "xadvance") || texureWidth;
                    }
                    lineHeight = Math.max(textureHeight, lineHeight);
                }
                if (textFieldHeight && i > 0 && textHeight > textFieldHeight) {
                    break;
                }
                isLastChar = true;
                if (!setLineData(line))
                    break;
            }
            function setLineData(str) {
                if (textFieldHeight && textLines.length > 0 && textHeight > textFieldHeight) {
                    return false;
                }
                textHeight += lineHeight + lineSpacing;
                if (!isFirstChar && !isLastChar) {
                    xPos -= letterSpacing;
                }
                textLines.push(str);
                lineHeights.push(lineHeight);
                textLinesWidth.push(xPos);
                textWidth = Math.max(xPos, textWidth);
                return true;
            }
            textHeight -= lineSpacing;
            values[8 /* textWidth */] = textWidth;
            values[9 /* textHeight */] = textHeight;
            this.$textOffsetX = textOffsetX;
            this.$textOffsetY = textOffsetY;
            this.$textStartX = 0;
            this.$textStartY = 0;
            var alignType;
            if (textFieldWidth > textWidth) {
                alignType = values[10 /* textAlign */];
                if (alignType == egret.HorizontalAlign.RIGHT) {
                    this.$textStartX = textFieldWidth - textWidth;
                }
                else if (alignType == egret.HorizontalAlign.CENTER) {
                    this.$textStartX = Math.floor((textFieldWidth - textWidth) / 2);
                }
            }
            if (textFieldHeight > textHeight) {
                alignType = values[11 /* verticalAlign */];
                if (alignType == egret.VerticalAlign.BOTTOM) {
                    this.$textStartY = textFieldHeight - textHeight;
                }
                else if (alignType == egret.VerticalAlign.MIDDLE) {
                    this.$textStartY = Math.floor((textFieldHeight - textHeight) / 2);
                }
            }
            return textLines;
        };
        /**
         * A ratio of the width of the space character. This value is multiplied by the height of the first character is the space character width.
         * @default 0.33
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธไธช็ฉบๆผๅญ็ฌฆ็ๅฎฝๅบฆๆฏไพใ่ฟไธชๆฐๅผไนไปฅ็ฌฌไธไธชๅญ็ฌฆ็้ซๅบฆๅณไธบ็ฉบๆผๅญ็ฌฆ็ๅฎฝใ
         * @default 0.33
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        BitmapText.EMPTY_FACTOR = 0.33;
        return BitmapText;
    }(egret.DisplayObject));
    egret.BitmapText = BitmapText;
    __reflect(BitmapText.prototype, "egret.BitmapText");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The HorizontalAlign class defines the possible values for the horizontal alignment.
     * @see egret.TextField#textAlign
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * HorizontalAlign ็ฑปไธบๆฐดๅนณๅฏน้ฝๆนๅผๅฎไนๅฏ่ฝ็ๅผใ
     * @see egret.TextField#textAlign
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var HorizontalAlign = (function () {
        function HorizontalAlign() {
        }
        /**
         * Horizontally align content to the left of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅๅฎนไธๅฎนๅจ็ๅทฆไพงๅฏน้ฝใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HorizontalAlign.LEFT = "left";
        /**
         * Horizontally align content to the right of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅๅฎนไธๅฎนๅจ็ๅณไพงๅฏน้ฝใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HorizontalAlign.RIGHT = "right";
        /**
         * Horizontally align content in the center of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅฎนๅจ็ๆฐดๅนณไธญๅฟๅฏน้ฝๅๅฎนใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HorizontalAlign.CENTER = "center";
        /**
         * Horizontal alignment with both edges.
         * Note: TextFiled does not support this alignment method.
         * @constant egret.HorizontalAlign.JUSTIFY
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐดๅนณไธค็ซฏๅฏน้ฝใ
         * ๆณจๆ๏ผTextFiledไธๆฏๆๆญคๅฏน้ฝๆนๅผใ
         * @constant egret.HorizontalAlign.JUSTIFY
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HorizontalAlign.JUSTIFY = "justify";
        /**
         * Align the content of the child items, relative to the container. This operation will adjust uniformly the size of all the child items to be the Content Width \" of the container \".
         * The Content Width \" of the container \" is the size of the max. child item. If the size of all child items are less than the width of the container, they will be adjusted to the width of the container.
         * Note: TextFiled does not support this alignment method.
         * @constant egret.HorizontalAlign.CONTENT_JUSTIFY
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ธๅฏนไบๅฎนๅจๅฏนๅญ้กน่ฟ่กๅๅฎนๅฏน้ฝใ่ฟไผๅฐๆๆๅญ้กน็ๅคงๅฐ็ปไธ่ฐๆดไธบๅฎนๅจ็"ๅๅฎนๅฎฝๅบฆ"ใ
         * ๅฎนๅจ็"ๅๅฎนๅฎฝๅบฆ"ๆฏๆๅคงๅญ้กน็ๅคงๅฐ,ๅฆๆๆๆๅญ้กน้ฝๅฐไบๅฎนๅจ็ๅฎฝๅบฆ๏ผๅไผๅฐๆๆๅญ้กน็ๅคงๅฐ่ฐๆดไธบๅฎนๅจ็ๅฎฝๅบฆใ
         * ๆณจๆ๏ผTextFiledไธๆฏๆๆญคๅฏน้ฝๆนๅผใ
         * @constant egret.HorizontalAlign.CONTENT_JUSTIFY
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HorizontalAlign.CONTENT_JUSTIFY = "contentJustify";
        return HorizontalAlign;
    }());
    egret.HorizontalAlign = HorizontalAlign;
    __reflect(HorizontalAlign.prototype, "egret.HorizontalAlign");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Convert the text in html format to the object that can be assigned to the egret.TextField#textFlow property
     * @see http://edn.egret.com/cn/docs/page/146 Text mixed in a variety of style
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/HtmlTextParser.ts
     * @language en_US
     */
    /**
     * ๅฐhtmlๆผๅผๆๆฌ่ฝฌๆขไธบๅฏ่ตๅผ็ป egret.TextField#textFlow ๅฑๆง็ๅฏน่ฑก
     * @see http://edn.egret.com/cn/docs/page/146 ๅค็งๆทๅผๆๆฌๆททๅ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/HtmlTextParser.ts
     * @language zh_CN
     */
    var HtmlTextParser = (function () {
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function HtmlTextParser() {
            this.replaceArr = [];
            /**
             * @private
             */
            this.resutlArr = [];
            this.initReplaceArr();
        }
        HtmlTextParser.prototype.initReplaceArr = function () {
            this.replaceArr = [];
            this.replaceArr.push([/&lt;/g, "<"]);
            this.replaceArr.push([/&gt;/g, ">"]);
            this.replaceArr.push([/&amp;/g, "&"]);
            this.replaceArr.push([/&quot;/g, "\""]);
            this.replaceArr.push([/&apos;/g, "\'"]);
        };
        /**
         * @private
         *
         * @param value
         * @returns
         */
        HtmlTextParser.prototype.replaceSpecial = function (value) {
            for (var i = 0; i < this.replaceArr.length; i++) {
                var k = this.replaceArr[i][0];
                var v = this.replaceArr[i][1];
                value = value.replace(k, v);
            }
            return value;
        };
        /**
         * Convert the text in html format to the object that can be assigned to the egret.TextField#textFlow property
         * @param htmltext {string} Text in html
         * @returns {Array<egret.ITextElement>} ๅฏ่ตๅผ็ป egret.TextField#textFlow Object that can be assigned to the egret.TextField#textFlow property
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐhtmlๆผๅผๆๆฌ่ฝฌๆขไธบๅฏ่ตๅผ็ป egret.TextField#textFlow ๅฑๆง็ๅฏน่ฑก
         * @param htmltext {string} htmlๆๆฌ
         * @returns {Array<egret.ITextElement>} ๅฏ่ตๅผ็ป egret.TextField#textFlow ๅฑๆง็ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        HtmlTextParser.prototype.parse = function (htmltext) {
            this.stackArray = [];
            this.resutlArr = [];
            var firstIdx = 0; //ๆๆฌๆฎตๅผๅงไฝ็ฝฎ
            var length = htmltext.length;
            while (firstIdx < length) {
                var starIdx = htmltext.indexOf("<", firstIdx);
                if (starIdx < 0) {
                    this.addToResultArr(htmltext.substring(firstIdx));
                    firstIdx = length;
                }
                else {
                    this.addToResultArr(htmltext.substring(firstIdx, starIdx));
                    var fontEnd = htmltext.indexOf(">", starIdx);
                    if (fontEnd == -1) {
                        egret.$error(1038);
                        fontEnd = starIdx;
                    }
                    else if (htmltext.charAt(starIdx + 1) == "\/") {
                        this.stackArray.pop();
                    }
                    else {
                        this.addToArray(htmltext.substring(starIdx + 1, fontEnd));
                    }
                    firstIdx = fontEnd + 1;
                }
            }
            return this.resutlArr;
        };
        HtmlTextParser.prototype.parser = function (htmltext) {
            return this.parse(htmltext);
        };
        /**
         * @private
         *
         * @param value
         */
        HtmlTextParser.prototype.addToResultArr = function (value) {
            if (value == "") {
                return;
            }
            value = this.replaceSpecial(value);
            if (this.stackArray.length > 0) {
                this.resutlArr.push({ text: value, style: this.stackArray[this.stackArray.length - 1] });
            }
            else {
                this.resutlArr.push({ text: value });
            }
        };
        //ๅฐๅญ็ฌฆๆฐๆฎ่ฝฌๆJsonๆฐๆฎ
        HtmlTextParser.prototype.changeStringToObject = function (str) {
            str = str.trim();
            var info = {};
            var header = [];
            if (str.charAt(0) == "i" || str.charAt(0) == "b" || str.charAt(0) == "u") {
                this.addProperty(info, str, "true");
            }
            else if (header = str.match(/^(font|a)\s/)) {
                str = str.substring(header[0].length).trim();
                var next = 0;
                var titles = void 0;
                while (titles = str.match(this.getHeadReg())) {
                    var title = titles[0];
                    var value = "";
                    str = str.substring(title.length).trim();
                    if (str.charAt(0) == "\"") {
                        next = str.indexOf("\"", 1);
                        value = str.substring(1, next);
                        next += 1;
                    }
                    else if (str.charAt(0) == "\'") {
                        next = str.indexOf("\'", 1);
                        value = str.substring(1, next);
                        next += 1;
                    }
                    else {
                        value = str.match(/(\S)+/)[0];
                        next = value.length;
                    }
                    this.addProperty(info, title.substring(0, title.length - 1).trim(), value.trim());
                    str = str.substring(next).trim();
                }
            }
            return info;
        };
        /**
         * @private
         *
         * @returns
         */
        HtmlTextParser.prototype.getHeadReg = function () {
            return /^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/;
        };
        /**
         * @private
         *
         * @param info
         * @param head
         * @param value
         */
        HtmlTextParser.prototype.addProperty = function (info, head, value) {
            switch (head.toLowerCase()) {
                case "color":
                case "textcolor":
                    value = value.replace(/#/, "0x");
                    info.textColor = parseInt(value);
                    break;
                case "strokecolor":
                    value = value.replace(/#/, "0x");
                    info.strokeColor = parseInt(value);
                    break;
                case "stroke":
                    info.stroke = parseInt(value);
                    break;
                case "b":
                case "bold":
                    info.bold = value == "true";
                    break;
                case "u":
                    info.underline = value == "true";
                    break;
                case "i":
                case "italic":
                    info.italic = value == "true";
                    break;
                case "size":
                    info.size = parseInt(value);
                    break;
                case "fontfamily":
                    info.fontFamily = value;
                    break;
                case "href":
                    info.href = this.replaceSpecial(value);
                    break;
                case "target":
                    info.target = this.replaceSpecial(value);
                    break;
            }
        };
        /**
         * @private
         *
         * @param infoStr
         */
        HtmlTextParser.prototype.addToArray = function (infoStr) {
            var info = this.changeStringToObject(infoStr);
            if (this.stackArray.length == 0) {
                this.stackArray.push(info);
            }
            else {
                var lastInfo = this.stackArray[this.stackArray.length - 1];
                for (var key in lastInfo) {
                    if (info[key] == null) {
                        info[key] = lastInfo[key];
                    }
                }
                this.stackArray.push(info);
            }
        };
        return HtmlTextParser;
    }());
    egret.HtmlTextParser = HtmlTextParser;
    __reflect(HtmlTextParser.prototype, "egret.HtmlTextParser");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * @version Egret 2.4
     * @platform Web,Native
     */
    var InputController = (function (_super) {
        __extends(InputController, _super);
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function InputController() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.stageTextAdded = false;
            /**
             * @private
             */
            _this._text = null;
            /**
             * @private
             */
            _this._isFocus = false;
            return _this;
        }
        /**
         *
         * @param text
         * @version Egret 2.4
         * @platform Web,Native
         */
        InputController.prototype.init = function (text) {
            this._text = text;
            this.stageText = new egret.StageText();
            this.stageText.$setTextField(this._text);
        };
        /**
         * @private
         *
         */
        InputController.prototype._addStageText = function () {
            if (this.stageTextAdded) {
                return;
            }
            if (!this._text.$inputEnabled) {
                this._text.$touchEnabled = true;
            }
            this.tempStage = this._text.stage;
            this.stageText.$addToStage();
            this.stageText.addEventListener("updateText", this.updateTextHandler, this);
            this._text.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onMouseDownHandler, this);
            this.stageText.addEventListener("blur", this.blurHandler, this);
            this.stageText.addEventListener("focus", this.focusHandler, this);
            this.stageTextAdded = true;
        };
        /**
         * @private
         *
         */
        InputController.prototype._removeStageText = function () {
            if (!this.stageTextAdded) {
                return;
            }
            if (!this._text.$inputEnabled) {
                this._text.$touchEnabled = false;
            }
            this.stageText.$removeFromStage();
            this.stageText.removeEventListener("updateText", this.updateTextHandler, this);
            this._text.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onMouseDownHandler, this);
            this.tempStage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onStageDownHandler, this);
            this.stageText.removeEventListener("blur", this.blurHandler, this);
            this.stageText.removeEventListener("focus", this.focusHandler, this);
            this.stageTextAdded = false;
        };
        /**
         * @private
         *
         * @returns
         */
        InputController.prototype._getText = function () {
            return this.stageText.$getText();
        };
        /**
         * @private
         *
         * @param value
         */
        InputController.prototype._setText = function (value) {
            this.stageText.$setText(value);
        };
        /**
         * @private
         */
        InputController.prototype._setColor = function (value) {
            this.stageText.$setColor(value);
        };
        /**
         * @private
         *
         * @param event
         */
        InputController.prototype.focusHandler = function (event) {
            //ไธๅๆพ็คบ็ซ็บฟ๏ผๅนถไธ่พๅฅๆกๆพ็คบๆๅผๅง
            if (!this._isFocus) {
                this._isFocus = true;
                if (!event["showing"]) {
                    this._text.$isTyping = true;
                }
                this._text.$invalidateContentBounds();
                this._text.dispatchEvent(new egret.FocusEvent(egret.FocusEvent.FOCUS_IN, true));
            }
        };
        /**
         * @private
         *
         * @param event
         */
        InputController.prototype.blurHandler = function (event) {
            if (this._isFocus) {
                //ไธๅๆพ็คบ็ซ็บฟ๏ผๅนถไธ่พๅฅๆกๆพ็คบๆๅผๅง
                this._isFocus = false;
                this.tempStage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onStageDownHandler, this);
                this._text.$isTyping = false;
                this._text.$invalidateContentBounds();
                //ๅคฑๅป็ฆ็นๅ่ฐ็จ
                this.stageText.$onBlur();
                this._text.dispatchEvent(new egret.FocusEvent(egret.FocusEvent.FOCUS_OUT, true));
            }
        };
        //็นไธญๆๆฌ
        InputController.prototype.onMouseDownHandler = function (event) {
            this.$onFocus();
        };
        InputController.prototype.$onFocus = function () {
            var _this = this;
            var self = this;
            if (!this._text.visible) {
                return;
            }
            if (this._isFocus) {
                return;
            }
            this.tempStage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onStageDownHandler, this);
            egret.callLater(function () {
                _this.tempStage.addEventListener(egret.TouchEvent.TOUCH_BEGIN, _this.onStageDownHandler, _this);
            }, this);
            //ๅผบๅถๆดๆฐ่พๅฅๆกไฝ็ฝฎ
            this.stageText.$show();
        };
        //ๆช็นไธญๆๆฌ
        InputController.prototype.onStageDownHandler = function (event) {
            if (event.$target != this._text) {
                this.stageText.$hide();
            }
        };
        /**
         * @private
         *
         * @param event
         */
        InputController.prototype.updateTextHandler = function (event) {
            var values = this._text.$TextField;
            var textValue = this.stageText.$getText();
            var isChanged = false;
            var reg;
            var result;
            if (values[35 /* restrictAnd */] != null) {
                reg = new RegExp("[" + values[35 /* restrictAnd */] + "]", "g");
                result = textValue.match(reg);
                if (result) {
                    textValue = result.join("");
                }
                else {
                    textValue = "";
                }
                isChanged = true;
            }
            if (values[36 /* restrictNot */] != null) {
                reg = new RegExp("[^" + values[36 /* restrictNot */] + "]", "g");
                result = textValue.match(reg);
                if (result) {
                    textValue = result.join("");
                }
                else {
                    textValue = "";
                }
                isChanged = true;
            }
            if (isChanged && this.stageText.$getText() != textValue) {
                this.stageText.$setText(textValue);
            }
            this.resetText();
            //ๆๅบchangeไบไปถ
            this._text.dispatchEvent(new egret.Event(egret.Event.CHANGE, true));
        };
        /**
         * @private
         *
         */
        InputController.prototype.resetText = function () {
            this._text.$setBaseText(this.stageText.$getText());
        };
        /**
         * @private
         *
         */
        InputController.prototype._hideInput = function () {
            this.stageText.$removeFromStage();
        };
        /**
         * @private
         *
         */
        InputController.prototype.updateInput = function () {
            if (!this._text.$visible && this.stageText) {
                this._hideInput();
            }
        };
        /**
         * @private
         *
         */
        InputController.prototype._updateProperties = function () {
            if (this._isFocus) {
                //ๆดไฝไฟฎๆน
                this.stageText.$resetStageText();
                this.updateInput();
                return;
            }
            var stage = this._text.$stage;
            if (stage == null) {
            }
            else {
                var item = this._text;
                var visible = item.$visible;
                while (true) {
                    if (!visible) {
                        break;
                    }
                    item = item.parent;
                    if (item == stage) {
                        break;
                    }
                    visible = item.$visible;
                }
            }
            this.stageText.$setText(this._text.$TextField[13 /* text */]);
            //ๆดไฝไฟฎๆน
            this.stageText.$resetStageText();
            this.updateInput();
        };
        return InputController;
    }(egret.HashObject));
    egret.InputController = InputController;
    __reflect(InputController.prototype, "egret.InputController");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var SplitRegex = new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![ใ๏ผ๏ผใใโฆ๏ผ)}โใ\\.\\,\\!\\?\\]\\:])");
    /**
     * @private
     * ๆนๆฎๆทๅผๆต้ๆๆฌๅฎฝๅบฆ
     */
    function measureTextWidth(text, values, style) {
        style = style || {};
        var italic = style.italic == null ? values[16 /* italic */] : style.italic;
        var bold = style.bold == null ? values[15 /* bold */] : style.bold;
        var size = style.size == null ? values[0 /* fontSize */] : style.size;
        var fontFamily = style.fontFamily || values[8 /* fontFamily */] || TextField.default_fontFamily;
        return egret.sys.measureText(text, fontFamily, size, bold, italic);
    }
    /**
     * TextField is the text rendering class of egret. It conducts rendering by using the browser / device API. Due to different ways of font rendering in different browsers / devices, there may be differences in the rendering
     * If developers expect  no differences among all platforms, please use BitmapText
     * @see http://edn.egret.com/cn/docs/page/141 Create Text
     *
     * @event egret.Event.CHANGE Dispatched when entering text user inputใ
     * @event egret.FocusEvent.FOCUS_IN Dispatched after the focus to enter text.
     * @event egret.FocusEvent.FOCUS_OUT Enter the text loses focus after dispatch.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/TextField.ts
     * @language en_US
     */
    /**
     * TextFieldๆฏegret็ๆๆฌๆธฒๆ็ฑป๏ผ้็จๆต่งๅจ/่ฎพๅค็API่ฟ่กๆธฒๆ๏ผๅจไธๅ็ๆต่งๅจ/่ฎพๅคไธญ็ฑไบๅญไฝๆธฒๆๆนๅผไธไธ๏ผๅฏ่ฝไผๆๆธฒๆๅทฎๅผ
     * ๅฆๆๅผๅ่ๅธๆๆๆๅนณๅฐๅฎๅจๆๅทฎๅผ๏ผ่ฏทไฝฟ็จBitmapText
     * @see http://edn.egret.com/cn/docs/page/141 ๅๅปบๆๆฌ
     *
     * @event egret.Event.CHANGE ่พๅฅๆๆฌๆ็จๆท่พๅฅๆถ่ฐๅบฆใ
     * @event egret.FocusEvent.FOCUS_IN ่็ฆ่พๅฅๆๆฌๅ่ฐๅบฆใ
     * @event egret.FocusEvent.FOCUS_OUT ่พๅฅๆๆฌๅคฑๅป็ฆ็นๅ่ฐๅบฆใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/text/TextField.ts
     * @language zh_CN
     */
    var TextField = (function (_super) {
        __extends(TextField, _super);
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function TextField() {
            var _this = _super.call(this) || this;
            _this.$inputEnabled = false;
            /**
             * @private
             */
            _this.inputUtils = null;
            /**
             * @private
             */
            _this.graphicsNode = null;
            /**
             * @private
             */
            _this.isFlow = false;
            /**
             * @private
             */
            _this.textArr = [];
            /**
             * @private
             */
            _this.linesArr = [];
            /**
             * @private
             */
            _this.$isTyping = false;
            var textNode = new egret.sys.TextNode();
            textNode.fontFamily = TextField.default_fontFamily;
            _this.textNode = textNode;
            _this.$renderNode = textNode;
            _this.$TextField = {
                0: TextField.default_size,
                1: 0,
                2: TextField.default_textColor,
                3: NaN,
                4: NaN,
                5: 0,
                6: 0,
                7: 0,
                8: TextField.default_fontFamily,
                9: "left",
                10: "top",
                11: "#ffffff",
                12: "",
                13: "",
                14: [],
                15: false,
                16: false,
                17: true,
                18: false,
                19: false,
                20: false,
                21: 0,
                22: 0,
                23: 0,
                24: egret.TextFieldType.DYNAMIC,
                25: 0x000000,
                26: "#000000",
                27: 0,
                28: -1,
                29: 0,
                30: false,
                31: false,
                32: 0x000000,
                33: false,
                34: 0xffffff,
                35: null,
                36: null,
                37: egret.TextFieldInputType.TEXT //inputType
            };
            return _this;
        }
        /**
         * @private
         */
        TextField.prototype.isInput = function () {
            return this.$TextField[24 /* type */] == egret.TextFieldType.INPUT;
        };
        TextField.prototype.$setTouchEnabled = function (value) {
            var result = _super.prototype.$setTouchEnabled.call(this, value);
            if (this.isInput()) {
                this.$inputEnabled = true;
            }
            return result;
        };
        Object.defineProperty(TextField.prototype, "fontFamily", {
            /**
             * The name of the font to use, or a comma-separated list of font names.
             * @default "Arial"
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆไฝฟ็จ็ๅญไฝ็ๅ็งฐๆ็จ้ๅทๅ้็ๅญไฝๅ็งฐๅ่กจใ
             * @default "Arial"
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[8 /* fontFamily */];
            },
            set: function (value) {
                this.$setFontFamily(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setFontFamily = function (value) {
            var values = this.$TextField;
            if (values[8 /* fontFamily */] == value) {
                return false;
            }
            values[8 /* fontFamily */] = value;
            this.invalidateFontString();
            return true;
        };
        Object.defineProperty(TextField.prototype, "size", {
            /**
             * The size in pixels of text
             * @default 30
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌ็ๅญๅทๅคงๅฐใ
             * @default 30
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[0 /* fontSize */];
            },
            set: function (value) {
                this.$setSize(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setSize = function (value) {
            value = +value || 0;
            var values = this.$TextField;
            if (values[0 /* fontSize */] == value) {
                return false;
            }
            values[0 /* fontSize */] = value;
            this.invalidateFontString();
            return true;
        };
        Object.defineProperty(TextField.prototype, "bold", {
            /**
             * Specifies whether the text is boldface.
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฏๅฆๆพ็คบไธบ็ฒไฝใ
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[15 /* bold */];
            },
            set: function (value) {
                this.$setBold(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setBold = function (value) {
            value = !!value;
            var values = this.$TextField;
            if (value == values[15 /* bold */]) {
                return false;
            }
            values[15 /* bold */] = value;
            this.invalidateFontString();
            return true;
        };
        Object.defineProperty(TextField.prototype, "italic", {
            /**
             * Determines whether the text is italic font.
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฏๅฆๆพ็คบไธบๆไฝใ
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[16 /* italic */];
            },
            set: function (value) {
                this.$setItalic(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setItalic = function (value) {
            value = !!value;
            var values = this.$TextField;
            if (value == values[16 /* italic */]) {
                return false;
            }
            values[16 /* italic */] = value;
            this.invalidateFontString();
            return true;
        };
        /**
         * @private
         *
         */
        TextField.prototype.invalidateFontString = function () {
            this.$TextField[17 /* fontStringChanged */] = true;
            this.$invalidateTextField();
        };
        Object.defineProperty(TextField.prototype, "textAlign", {
            /**
             * Horizontal alignment of text.
             * @default๏ผegret.HorizontalAlign.LEFT
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌ็ๆฐดๅนณๅฏน้ฝๆนๅผใ
             * @default๏ผegret.HorizontalAlign.LEFT
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[9 /* textAlign */];
            },
            set: function (value) {
                this.$setTextAlign(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setTextAlign = function (value) {
            var values = this.$TextField;
            if (values[9 /* textAlign */] == value) {
                return false;
            }
            values[9 /* textAlign */] = value;
            this.$invalidateTextField();
            return true;
        };
        Object.defineProperty(TextField.prototype, "verticalAlign", {
            /**
             * Vertical alignment of text.
             * @default๏ผegret.VerticalAlign.TOP
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅญ็ๅ็ดๅฏน้ฝๆนๅผใ
             * @default๏ผegret.VerticalAlign.TOP
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[10 /* verticalAlign */];
            },
            set: function (value) {
                this.$setVerticalAlign(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setVerticalAlign = function (value) {
            var values = this.$TextField;
            if (values[10 /* verticalAlign */] == value) {
                return false;
            }
            values[10 /* verticalAlign */] = value;
            this.$invalidateTextField();
            return true;
        };
        Object.defineProperty(TextField.prototype, "lineSpacing", {
            /**
             * An integer representing the amount of vertical space between lines.
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธไธชๆดๆฐ๏ผ่กจ็คบ่กไธ่กไน้ด็ๅ็ด้ด่ท้
             * @default 0
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[1 /* lineSpacing */];
            },
            set: function (value) {
                this.$setLineSpacing(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setLineSpacing = function (value) {
            value = +value || 0;
            var values = this.$TextField;
            if (values[1 /* lineSpacing */] == value)
                return false;
            values[1 /* lineSpacing */] = value;
            this.$invalidateTextField();
            return true;
        };
        Object.defineProperty(TextField.prototype, "textColor", {
            /**
             * Color of the text.
             * @default 0x000000
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌ้ข่ฒ
             * @default 0x000000
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[2 /* textColor */];
            },
            set: function (value) {
                this.$setTextColor(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setTextColor = function (value) {
            value = +value | 0;
            var values = this.$TextField;
            if (values[2 /* textColor */] == value) {
                return false;
            }
            values[2 /* textColor */] = value;
            if (this.inputUtils) {
                this.inputUtils._setColor(this.$TextField[2 /* textColor */]);
            }
            this.$invalidate();
            return true;
        };
        Object.defineProperty(TextField.prototype, "wordWrap", {
            /**
             * A Boolean value that indicates whether the text field word wrap. If the value is true, then the text field by word wrap;
             * if the value is false, the text field by newline characters.
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธไธชๅธๅฐๅผ๏ผ่กจ็คบๆๆฌๅญๆฎตๆฏๅฆๆๅ่ฏๆข่กใๅฆๆๅผไธบ true๏ผๅ่ฏฅๆๆฌๅญๆฎตๆๅ่ฏๆข่ก๏ผ
             * ๅฆๆๅผไธบ false๏ผๅ่ฏฅๆๆฌๅญๆฎตๆๅญ็ฌฆๆข่กใ
             * @default false
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[19 /* wordWrap */];
            },
            set: function (value) {
                this.$setWordWrap(value);
            },
            enumerable: true,
            configurable: true
        });
        TextField.prototype.$setWordWrap = function (value) {
            value = !!value;
            var values = this.$TextField;
            if (value == values[19 /* wordWrap */]) {
                return;
            }
            if (values[20 /* displayAsPassword */]) {
                return;
            }
            values[19 /* wordWrap */] = value;
            this.$invalidateTextField();
        };
        Object.defineProperty(TextField.prototype, "type", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[24 /* type */];
            },
            /**
             * Type of the text field.
             * Any one of the following TextFieldType constants: TextFieldType.DYNAMIC (specifies the dynamic text field that users can not edit), or TextFieldType.INPUT (specifies the dynamic text field that users can edit).
             * @default egret.TextFieldType.DYNAMIC
             * @language en_US
             */
            /**
             * ๆๆฌๅญๆฎต็็ฑปๅใ
             * ไปฅไธ TextFieldType ๅธธ้ไธญ็ไปปไธไธช๏ผTextFieldType.DYNAMIC๏ผๆๅฎ็จๆทๆๆณ็ผ่พ็ๅจๆๆๆฌๅญๆฎต๏ผ๏ผๆ TextFieldType.INPUT๏ผๆๅฎ็จๆทๅฏไปฅ็ผ่พ็่พๅฅๆๆฌๅญๆฎต๏ผใ
             * @default egret.TextFieldType.DYNAMIC
             * @language zh_CN
             */
            set: function (value) {
                this.$setType(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setType = function (value) {
            var values = this.$TextField;
            if (values[24 /* type */] != value) {
                values[24 /* type */] = value;
                if (value == egret.TextFieldType.INPUT) {
                    if (isNaN(values[3 /* textFieldWidth */])) {
                        this.$setWidth(100);
                    }
                    if (isNaN(values[4 /* textFieldHeight */])) {
                        this.$setHeight(30);
                    }
                    this.$setTouchEnabled(true);
                    //ๅๅปบstageText
                    if (this.inputUtils == null) {
                        this.inputUtils = new egret.InputController();
                    }
                    this.inputUtils.init(this);
                    this.$invalidateTextField();
                    if (this.$stage) {
                        this.inputUtils._addStageText();
                    }
                }
                else {
                    if (this.inputUtils) {
                        this.inputUtils._removeStageText();
                        this.inputUtils = null;
                    }
                    this.$setTouchEnabled(false);
                }
                return true;
            }
            return false;
        };
        Object.defineProperty(TextField.prototype, "inputType", {
            /**
             * @version Egret 3.1.2
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[37 /* inputType */];
            },
            /**
             * Pop-up keyboard type.
             * Any of a TextFieldInputType constants.
             * @language en_US
             */
            /**
             * ๅผนๅบ้ฎ็็็ฑปๅใ
             * TextFieldInputType ๅธธ้ไธญ็ไปปไธไธชใ
             * @language zh_CN
             */
            set: function (value) {
                this.$TextField[37 /* inputType */] = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "text", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$getText();
            },
            /**
             * Serve as a string of the current text field in the text
             * @language en_US
             */
            /**
             * ไฝไธบๆๆฌๅญๆฎตไธญๅฝๅๆๆฌ็ๅญ็ฌฆไธฒ
             * @language zh_CN
             */
            set: function (value) {
                this.$setText(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        TextField.prototype.$getText = function () {
            if (this.$TextField[24 /* type */] == egret.TextFieldType.INPUT) {
                return this.inputUtils._getText();
            }
            return this.$TextField[13 /* text */];
        };
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setBaseText = function (value) {
            if (value == null) {
                value = "";
            }
            value = value.toString();
            this.isFlow = false;
            var values = this.$TextField;
            if (values[13 /* text */] != value) {
                this.$invalidateTextField();
                values[13 /* text */] = value;
                var text = "";
                if (values[20 /* displayAsPassword */]) {
                    text = this.changeToPassText(value);
                }
                else {
                    text = value;
                }
                this.setMiddleStyle([{ text: text }]);
                return true;
            }
            return false;
        };
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setText = function (value) {
            if (value == null) {
                value = "";
            }
            var result = this.$setBaseText(value);
            if (this.inputUtils) {
                this.inputUtils._setText(this.$TextField[13 /* text */]);
            }
            return result;
        };
        Object.defineProperty(TextField.prototype, "displayAsPassword", {
            /**
             * Specify whether the text field is a password text field.
             * If the value of this property is true, the text field is treated as a password text field and hides the input characters using asterisks instead of the actual characters. If false, the text field is not treated as a password text field.
             * @default false
             * @language en_US
             */
            /**
             * ๆๅฎๆๆฌๅญๆฎตๆฏๅฆๆฏๅฏ็ๆๆฌๅญๆฎตใ
             * ๅฆๆๆญคๅฑๆง็ๅผไธบ true๏ผๅๆๆฌๅญๆฎต่ขซ่งไธบๅฏ็ๆๆฌๅญๆฎต๏ผๅนถไฝฟ็จๆๅท่ไธๆฏๅฎ้ๅญ็ฌฆๆฅ้่่พๅฅ็ๅญ็ฌฆใๅฆๆไธบ false๏ผๅไธไผๅฐๆๆฌๅญๆฎต่งไธบๅฏ็ๆๆฌๅญๆฎตใ
             * @default false
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[20 /* displayAsPassword */];
            },
            set: function (value) {
                this.$setDisplayAsPassword(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setDisplayAsPassword = function (value) {
            var values = this.$TextField;
            if (values[20 /* displayAsPassword */] != value) {
                values[20 /* displayAsPassword */] = value;
                this.$invalidateTextField();
                var text = "";
                if (value) {
                    text = this.changeToPassText(values[13 /* text */]);
                }
                else {
                    text = values[13 /* text */];
                }
                this.setMiddleStyle([{ text: text }]);
                return true;
            }
            return false;
        };
        Object.defineProperty(TextField.prototype, "strokeColor", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[25 /* strokeColor */];
            },
            /**
             * Represent the stroke color of the text.
             * Contain three 8-bit numbers with RGB color components; for example, 0xFF0000 is red, 0x00FF00 is green.
             * @default 0x000000
             * @language en_US
             */
            /**
             * ่กจ็คบๆๆฌ็ๆ่พน้ข่ฒใ
             * ๅๅซไธไธช 8 ไฝ RGB ้ข่ฒๆๅ็ๆฐๅญ๏ผไพๅฆ๏ผ0xFF0000 ไธบ็บข่ฒ๏ผ0x00FF00 ไธบ็ปฟ่ฒใ
             * @default 0x000000
             * @language zh_CN
             */
            set: function (value) {
                value = +value || 0;
                this.$setStrokeColor(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setStrokeColor = function (value) {
            var values = this.$TextField;
            if (values[25 /* strokeColor */] != value) {
                this.$invalidateTextField();
                values[25 /* strokeColor */] = value;
                values[26 /* strokeColorString */] = egret.toColorString(value);
                return true;
            }
            return false;
        };
        Object.defineProperty(TextField.prototype, "stroke", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[27 /* stroke */];
            },
            /**
             * Indicate the stroke width.
             * 0 means no stroke.
             * @default 0
             * @language en_US
             */
            /**
             * ่กจ็คบๆ่พนๅฎฝๅบฆใ
             * 0ไธบๆฒกๆๆ่พนใ
             * @default 0
             * @language zh_CN
             */
            set: function (value) {
                this.$setStroke(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setStroke = function (value) {
            if (this.$TextField[27 /* stroke */] != value) {
                this.$invalidateTextField();
                this.$TextField[27 /* stroke */] = value;
                return true;
            }
            return false;
        };
        Object.defineProperty(TextField.prototype, "maxChars", {
            /**
             * The maximum number of characters that the text field can contain, as entered by a user. \n A script can insert more text than maxChars allows; the maxChars property indicates only how much text a user can enter. If the value of this property is 0, a user can enter an unlimited amount of text.
             * The default value is 0.
             * @default 0
             * @language en_US
             */
            /**
             * ๆๆฌๅญๆฎตไธญๆๅคๅฏๅๅซ็ๅญ็ฌฆๆฐ๏ผๅณ็จๆท่พๅฅ็ๅญ็ฌฆๆฐ๏ผใ
             * ่ๆฌๅฏไปฅๆๅฅๆฏ maxChars ๅ่ฎธ็ๅญ็ฌฆๆฐๆดๅค็ๆๆฌ๏ผmaxChars ๅฑๆงไป่กจ็คบ็จๆทๅฏไปฅ่พๅฅๅคๅฐๆๆฌใๅฆๆๆญคๅฑๆง็ๅผไธบ 0๏ผๅ็จๆทๅฏไปฅ่พๅฅๆ้ๆฐ้็ๆๆฌใ
             * @default 0
             * @language zh_CN
             */
            get: function () {
                return this.$TextField[21 /* maxChars */];
            },
            set: function (value) {
                this.$setMaxChars(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setMaxChars = function (value) {
            if (this.$TextField[21 /* maxChars */] != value) {
                this.$TextField[21 /* maxChars */] = value;
                return true;
            }
            return false;
        };
        Object.defineProperty(TextField.prototype, "scrollV", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return Math.min(Math.max(this.$TextField[28 /* scrollV */], 1), this.maxScrollV);
            },
            /**
             * Vertical position of text in a text field. scrollV property helps users locate specific passages in a long article, and create scrolling text fields.
             * Vertically scrolling units are lines, and horizontal scrolling unit is pixels.
             * If the first displayed line is the first line in the text field, scrollV is set to 1 (instead of 0).
             * @language en_US
             */
            /**
             * ๆๆฌๅจๆๆฌๅญๆฎตไธญ็ๅ็ดไฝ็ฝฎใscrollV ๅฑๆงๅฏๅธฎๅฉ็จๆทๅฎไฝๅฐ้ฟ็ฏๆ็ซ็็นๅฎๆฎต่ฝ๏ผ่ฟๅฏ็จไบๅๅปบๆปๅจๆๆฌๅญๆฎตใ
             * ๅ็ดๆปๅจ็ๅไฝๆฏ่ก๏ผ่ๆฐดๅนณๆปๅจ็ๅไฝๆฏๅ็ดใ
             * ๅฆๆๆพ็คบ็็ฌฌไธ่กๆฏๆๆฌๅญๆฎตไธญ็็ฌฌไธ่ก๏ผๅ scrollV ่ฎพ็ฝฎไธบ 1๏ผ่้ 0๏ผใ
             * @language zh_CN
             */
            set: function (value) {
                this.$TextField[28 /* scrollV */] = Math.max(value, 1);
                this.$invalidateTextField();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "maxScrollV", {
            /**
             * The maximum value of scrollV
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * scrollV ็ๆๅคงๅผ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getLinesArr();
                return Math.max(this.$TextField[29 /* numLines */] - egret.TextFieldUtils.$getScrollNum(this) + 1, 1);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "selectionBeginIndex", {
            /**
             * @private
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return 0;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "selectionEndIndex", {
            /**
             * @private
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return 0;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "caretIndex", {
            /**
             * @private
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return 0;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param beginIndex
         * @param endIndex
         */
        TextField.prototype.$setSelection = function (beginIndex, endIndex) {
            return false;
        };
        /**
         * @private
         *
         * @returns
         */
        TextField.prototype.$getLineHeight = function () {
            return this.$TextField[1 /* lineSpacing */] + this.$TextField[0 /* fontSize */];
        };
        Object.defineProperty(TextField.prototype, "numLines", {
            /**
             * Number of lines of text.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌ่กๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getLinesArr();
                return this.$TextField[29 /* numLines */];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "multiline", {
            get: function () {
                return this.$TextField[30 /* multiline */];
            },
            /**
             * Indicate whether field is a multiline text field. Note that this property is valid only when the type is TextFieldType.INPUT.
             * If the value is true, the text field is multiline; if the value is false, the text field is a single-line text field. In a field of type TextFieldType.INPUT, the multiline value determines whether the Enter key creates a new line (a value of false, and the Enter key is ignored).
             * @default false
             * @language en_US
             */
            /**
             * ่กจ็คบๅญๆฎตๆฏๅฆไธบๅค่กๆๆฌๅญๆฎตใๆณจๆ๏ผๆญคๅฑๆงไปๅจtypeไธบTextFieldType.INPUTๆถๆๆๆใ
             * ๅฆๆๅผไธบ true๏ผๅๆๆฌๅญๆฎตไธบๅค่กๆๆฌๅญๆฎต๏ผๅฆๆๅผไธบ false๏ผๅๆๆฌๅญๆฎตไธบๅ่กๆๆฌๅญๆฎตใๅจ็ฑปๅไธบ TextFieldType.INPUT ็ๅญๆฎตไธญ๏ผmultiline ๅผๅฐ็กฎๅฎ Enter ้ฎๆฏๅฆๅๅปบๆฐ่ก๏ผๅฆๆๅผไธบ false๏ผๅๅฐๅฟฝ็ฅ Enter ้ฎ๏ผใ
             * @default false
             * @language zh_CN
             */
            set: function (value) {
                this.$setMultiline(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setMultiline = function (value) {
            this.$TextField[30 /* multiline */] = value;
            this.$invalidateTextField();
            return true;
        };
        Object.defineProperty(TextField.prototype, "restrict", {
            get: function () {
                var values = this.$TextField;
                var str = null;
                if (values[35 /* restrictAnd */] != null) {
                    str = values[35 /* restrictAnd */];
                }
                if (values[36 /* restrictNot */] != null) {
                    if (str == null) {
                        str = "";
                    }
                    str += "^" + values[36 /* restrictNot */];
                }
                return str;
            },
            /**
             * Indicates a user can enter into the text field character set. If you restrict property is null, you can enter any character. If you restrict property is an empty string, you can not enter any character. If you restrict property is a string of characters, you can enter only characters in the string in the text field. The string is scanned from left to right. You can use a hyphen (-) to specify a range. Only restricts user interaction; a script may put any text into the text field. <br/>
                      * If the string of characters caret (^) at the beginning, all characters are initially accepted, then the string are excluded from receiving ^ character. If the string does not begin with a caret (^) to, any characters are initially accepted and then a string of characters included in the set of accepted characters. <br/>
                      * The following example allows only uppercase characters, spaces, and numbers in the text field: <br/>
                      * My_txt.restrict = "A-Z 0-9"; <br/>
                      * The following example includes all characters except lowercase letters: <br/>
                      * My_txt.restrict = "^ a-z"; <br/>
                      * If you need to enter characters \ ^, use two backslash "\\ -" "\\ ^": <br/>
                      * Can be used anywhere in the string ^ to rule out including characters and switch between characters, but can only be used to exclude a ^. The following code includes only uppercase letters except uppercase Q: <br/>
                      * My_txt.restrict = "A-Z ^ Q"; <br/>
             * @version Egret 2.4
             * @platform Web,Native
             * @default null
             * @language en_US
             */
            /**
             * ่กจ็คบ็จๆทๅฏ่พๅฅๅฐๆๆฌๅญๆฎตไธญ็ๅญ็ฌฆ้ใๅฆๆ restrict ๅฑๆง็ๅผไธบ null๏ผๅๅฏไปฅ่พๅฅไปปไฝๅญ็ฌฆใๅฆๆ restrict ๅฑๆง็ๅผไธบ็ฉบๅญ็ฌฆไธฒ๏ผๅไธ่ฝ่พๅฅไปปไฝๅญ็ฌฆใๅฆๆ restrict ๅฑๆง็ๅผไธบไธไธฒๅญ็ฌฆ๏ผๅๅช่ฝๅจๆๆฌๅญๆฎตไธญ่พๅฅ่ฏฅๅญ็ฌฆไธฒไธญ็ๅญ็ฌฆใไปๅทฆๅๅณๆซๆ่ฏฅๅญ็ฌฆไธฒใๅฏไปฅไฝฟ็จ่ฟๅญ็ฌฆ (-) ๆๅฎไธไธช่ๅดใๅช้ๅถ็จๆทไบคไบ๏ผ่ๆฌๅฏๅฐไปปไฝๆๆฌๆพๅฅๆๆฌๅญๆฎตไธญใ<br/>
             * ๅฆๆๅญ็ฌฆไธฒไปฅๅฐๅท (^) ๅผๅคด๏ผๅๅๆฅๅๆๆๅญ็ฌฆ๏ผ็ถๅไปๆฅๅๅญ็ฌฆ้ไธญๆ้คๅญ็ฌฆไธฒไธญ ^ ไนๅ็ๅญ็ฌฆใๅฆๆๅญ็ฌฆไธฒไธไปฅๅฐๅท (^) ๅผๅคด๏ผๅๆๅไธๆฅๅไปปไฝๅญ็ฌฆ๏ผ็ถๅๅฐๅญ็ฌฆไธฒไธญ็ๅญ็ฌฆๅๆฌๅจๆฅๅๅญ็ฌฆ้ไธญใ<br/>
             * ไธไพไปๅ่ฎธๅจๆๆฌๅญๆฎตไธญ่พๅฅๅคงๅๅญ็ฌฆใ็ฉบๆผๅๆฐๅญ๏ผ<br/>
             * my_txt.restrict = "A-Z 0-9";<br/>
             * ไธไพๅๅซ้คๅฐๅๅญๆฏไนๅค็ๆๆๅญ็ฌฆ๏ผ<br/>
             * my_txt.restrict = "^a-z";<br/>
             * ๅฆๆ้่ฆ่พๅฅๅญ็ฌฆ \ ^๏ผ่ฏทไฝฟ็จ2ไธชๅๆๆ "\\-" "\\^" ๏ผ<br/>
             * ๅฏๅจๅญ็ฌฆไธฒไธญ็ไปปไฝไฝ็ฝฎไฝฟ็จ ^๏ผไปฅๅจๅๅซๅญ็ฌฆไธๆ้คๅญ็ฌฆไน้ด่ฟ่กๅๆข๏ผไฝๆฏๆๅคๅช่ฝๆไธไธช ^ ็จๆฅๆ้คใไธ้ข็ไปฃ็ๅชๅๅซ้คๅคงๅๅญๆฏ Q ไนๅค็ๅคงๅๅญๆฏ๏ผ<br/>
             * my_txt.restrict = "A-Z^Q";<br/>
             * @version Egret 2.4
             * @platform Web,Native
             * @default null
             * @language zh_CN
             */
            set: function (value) {
                var values = this.$TextField;
                if (value == null) {
                    values[35 /* restrictAnd */] = null;
                    values[36 /* restrictNot */] = null;
                }
                else {
                    var index = -1;
                    while (index < value.length) {
                        index = value.indexOf("^", index);
                        if (index == 0) {
                            break;
                        }
                        else if (index > 0) {
                            if (value.charAt(index - 1) != "\\") {
                                break;
                            }
                            index++;
                        }
                        else {
                            break;
                        }
                    }
                    if (index == 0) {
                        values[35 /* restrictAnd */] = null;
                        values[36 /* restrictNot */] = value.substring(index + 1);
                    }
                    else if (index > 0) {
                        values[35 /* restrictAnd */] = value.substring(0, index);
                        values[36 /* restrictNot */] = value.substring(index + 1);
                    }
                    else {
                        values[35 /* restrictAnd */] = value;
                        values[36 /* restrictNot */] = null;
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setWidth = function (value) {
            var values = this.$TextField;
            if (isNaN(value)) {
                if (isNaN(values[3 /* textFieldWidth */])) {
                    return false;
                }
                values[3 /* textFieldWidth */] = NaN;
            }
            else {
                if (values[3 /* textFieldWidth */] == value) {
                    return false;
                }
                values[3 /* textFieldWidth */] = value;
            }
            value = +value;
            if (value < 0) {
                return false;
            }
            this.$invalidateTextField();
            return true;
        };
        /**
         * @private
         *
         * @param value
         */
        TextField.prototype.$setHeight = function (value) {
            var values = this.$TextField;
            if (isNaN(value)) {
                if (isNaN(values[4 /* textFieldHeight */])) {
                    return false;
                }
                values[4 /* textFieldHeight */] = NaN;
            }
            else {
                if (values[4 /* textFieldHeight */] == value) {
                    return false;
                }
                values[4 /* textFieldHeight */] = value;
            }
            value = +value;
            if (value < 0) {
                return false;
            }
            this.$invalidateTextField();
            return true;
        };
        /**
         * @private
         * ่ทๅๆพ็คบๅฎฝๅบฆ
         */
        TextField.prototype.$getWidth = function () {
            var values = this.$TextField;
            return isNaN(values[3 /* textFieldWidth */]) ? this.$getContentBounds().width : values[3 /* textFieldWidth */];
        };
        /**
         * @private
         * ่ทๅๆพ็คบๅฎฝๅบฆ
         */
        TextField.prototype.$getHeight = function () {
            var values = this.$TextField;
            return isNaN(values[4 /* textFieldHeight */]) ? this.$getContentBounds().height : values[4 /* textFieldHeight */];
        };
        Object.defineProperty(TextField.prototype, "border", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[31 /* border */];
            },
            /**
             * Specifies whether the text field has a border.
             * If true, the text field has a border. If false, the text field has no border.
             * Use borderColor property to set the border color.
             * @default false
             * @language en_US
             */
            /**
             * ๆๅฎๆๆฌๅญๆฎตๆฏๅฆๅทๆ่พนๆกใ
             * ๅฆๆไธบ true๏ผๅๆๆฌๅญๆฎตๅทๆ่พนๆกใๅฆๆไธบ false๏ผๅๆๆฌๅญๆฎตๆฒกๆ่พนๆกใ
             * ไฝฟ็จ borderColor ๅฑๆงๆฅ่ฎพ็ฝฎ่พนๆก้ข่ฒใ
             * @default false
             * @language zh_CN
             */
            set: function (value) {
                this.$setBorder(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        TextField.prototype.$setBorder = function (value) {
            this.$TextField[31 /* border */] = !!value;
            this.$invalidate();
        };
        Object.defineProperty(TextField.prototype, "borderColor", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[32 /* borderColor */];
            },
            /**
             * The color of the text field border.
             * Even currently is no border can be retrieved or set this property, but only if the text field has the border property is set to true, the color is visible.
             * @default 0x000000
             * @language en_US
             */
            /**
             * ๆๆฌๅญๆฎต่พนๆก็้ข่ฒใ
             * ๅณไฝฟๅฝๅๆฒกๆ่พนๆก๏ผไนๅฏๆฃ็ดขๆ่ฎพ็ฝฎๆญคๅฑๆง๏ผไฝๅชๆๅฝๆๆฌๅญๆฎตๅทฒๅฐ border ๅฑๆง่ฎพ็ฝฎไธบ true ๆถ๏ผๆๅฏไปฅ็ๅฐ้ข่ฒใ
             * @default 0x000000
             * @language zh_CN
             */
            set: function (value) {
                this.$setBorderColor(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        TextField.prototype.$setBorderColor = function (value) {
            this.$TextField[32 /* borderColor */] = +value || 0;
            this.$invalidate();
        };
        Object.defineProperty(TextField.prototype, "background", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[33 /* background */];
            },
            /**
             * Specifies whether the text field has a background fill.
             * If true, the text field has a background fill. If false, the text field has no background fill.
             * Use the backgroundColor property to set the background color of the text field.
             * @default false
             * @language en_US
             */
            /**
             * ๆๅฎๆๆฌๅญๆฎตๆฏๅฆๅทๆ่ๆฏๅกซๅใ
             * ๅฆๆไธบ true๏ผๅๆๆฌๅญๆฎตๅทๆ่ๆฏๅกซๅใๅฆๆไธบ false๏ผๅๆๆฌๅญๆฎตๆฒกๆ่ๆฏๅกซๅใ
             * ไฝฟ็จ backgroundColor ๅฑๆงๆฅ่ฎพ็ฝฎๆๆฌๅญๆฎต็่ๆฏ้ข่ฒใ
             * @default false
             * @language zh_CN
             */
            set: function (value) {
                this.$setBackground(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        TextField.prototype.$setBackground = function (value) {
            this.$TextField[33 /* background */] = value;
            this.$invalidate();
        };
        Object.defineProperty(TextField.prototype, "backgroundColor", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.$TextField[34 /* backgroundColor */];
            },
            /**
             * Color of the text field background.
             * Even currently is no background, can be retrieved or set this property, but only if the text field has the background property set to true, the color is visible.
             * @default 0xFFFFFF
             * @language en_US
             */
            /**
             * ๆๆฌๅญๆฎต่ๆฏ็้ข่ฒใ
             * ๅณไฝฟๅฝๅๆฒกๆ่ๆฏ๏ผไนๅฏๆฃ็ดขๆ่ฎพ็ฝฎๆญคๅฑๆง๏ผไฝๅชๆๅฝๆๆฌๅญๆฎตๅทฒๅฐ background ๅฑๆง่ฎพ็ฝฎไธบ true ๆถ๏ผๆๅฏไปฅ็ๅฐ้ข่ฒใ
             * @default 0xFFFFFF
             * @language zh_CN
             */
            set: function (value) {
                this.$setBackgroundColor(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        TextField.prototype.$setBackgroundColor = function (value) {
            this.$TextField[34 /* backgroundColor */] = value;
            this.$invalidate();
        };
        /**
         * @private
         *
         */
        TextField.prototype.fillBackground = function (lines) {
            var graphics = this.graphicsNode;
            if (graphics) {
                graphics.clear();
            }
            var values = this.$TextField;
            if (values[33 /* background */] || values[31 /* border */] || (lines && lines.length > 0)) {
                if (!graphics) {
                    graphics = this.graphicsNode = new egret.sys.GraphicsNode();
                    var groupNode = new egret.sys.GroupNode();
                    groupNode.addNode(graphics);
                    groupNode.addNode(this.textNode);
                    this.$renderNode = groupNode;
                }
                var fillPath = void 0;
                var strokePath = void 0;
                //ๆธฒๆ่ๆฏ
                if (values[33 /* background */]) {
                    fillPath = graphics.beginFill(values[34 /* backgroundColor */]);
                    fillPath.drawRect(0, 0, this.$getWidth(), this.$getHeight());
                }
                //ๆธฒๆ่พนๆก
                if (values[31 /* border */]) {
                    strokePath = graphics.lineStyle(1, values[32 /* borderColor */]);
                    //1ๅ็ดๅ3ๅ็ด็บฟๆกๅฎฝๅบฆ็ๆๅต๏ผไผๅๅณไธ่งๅ็งป0.5ๅ็ด็ปๅถใๅฐ็ปไธๅ็ดๅฎฝๅบฆ๏ผๆญฃๅฅฝ่ฝไธ่ถๅบๆๆฌๆต้่พน็ใ
                    strokePath.drawRect(0, 0, this.$getWidth() - 1, this.$getHeight() - 1);
                }
                //ๆธฒๆไธๅ็บฟ
                if (lines && lines.length > 0) {
                    var textColor = values[2 /* textColor */];
                    var lastColor = -1;
                    var length_10 = lines.length;
                    for (var i = 0; i < length_10; i += 4) {
                        var x = lines[i];
                        var y = lines[i + 1];
                        var w = lines[i + 2];
                        var color = lines[i + 3] || textColor;
                        if (lastColor < 0 || lastColor != color) {
                            lastColor = color;
                            strokePath = graphics.lineStyle(2, color, 1, egret.CapsStyle.NONE);
                        }
                        strokePath.moveTo(x, y);
                        strokePath.lineTo(x + w, y);
                    }
                }
            }
            if (graphics) {
                var bounds = this.$getRenderBounds();
                graphics.x = bounds.x;
                graphics.y = bounds.y;
                graphics.width = bounds.width;
                graphics.height = bounds.height;
                egret.Rectangle.release(bounds);
            }
        };
        /**
         * Enter the text automatically entered into the input state, the input type is text only and may only be invoked in the user interaction.
         * @version Egret 3.0.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่พๅฅๆๆฌ่ชๅจ่ฟๅฅๅฐ่พๅฅ็ถๆ๏ผไปๅจ็ฑปๅๆฏ่พๅฅๆๆฌๅนถไธๆฏๅจ็จๆทไบคไบไธๆๅฏไปฅ่ฐ็จใ
         * @version Egret 3.0.8
         * @platform Web,Native
         * @language zh_CN
         */
        TextField.prototype.setFocus = function () {
            if (this.type == egret.TextFieldType.INPUT && this.$stage) {
                this.inputUtils.$onFocus();
            }
        };
        /**
         * @private
         *
         */
        TextField.prototype.$onRemoveFromStage = function () {
            _super.prototype.$onRemoveFromStage.call(this);
            this.removeEvent();
            if (this.$TextField[24 /* type */] == egret.TextFieldType.INPUT) {
                this.inputUtils._removeStageText();
            }
            if (this.textNode) {
                this.textNode.clean();
            }
        };
        /**
         * @private
         *
         * @param stage
         * @param nestLevel
         */
        TextField.prototype.$onAddToStage = function (stage, nestLevel) {
            _super.prototype.$onAddToStage.call(this, stage, nestLevel);
            this.addEvent();
            if (this.$TextField[24 /* type */] == egret.TextFieldType.INPUT) {
                this.inputUtils._addStageText();
            }
        };
        /**
         * ไธ่ฝ้ๅ$invalidateContentBounds๏ผๅไธบๅ้จgraphics่ฐ็จclearๆถไผ่งฆๅ$invalidateContentBounds่ฟไธชๆนๆณ๏ผไป่ๅฏผ่ดๆญปๅพช็ฏใ
         */
        TextField.prototype.$invalidateTextField = function () {
            this.$invalidateContentBounds();
            this.$TextField[18 /* textLinesChanged */] = true;
        };
        TextField.prototype.$update = function (dirtyRegionPolicy, bounds) {
            var tmpBounds = this.$getRenderBounds();
            var result = _super.prototype.$update.call(this, dirtyRegionPolicy, tmpBounds);
            egret.Rectangle.release(tmpBounds);
            return result;
        };
        TextField.prototype.$getRenderBounds = function () {
            var bounds = this.$getContentBounds();
            var tmpBounds = egret.Rectangle.create();
            tmpBounds.copyFrom(bounds);
            if (this.$TextField[31 /* border */]) {
                tmpBounds.width += 2;
                tmpBounds.height += 2;
            }
            var _strokeDouble = this.$TextField[27 /* stroke */] * 2;
            if (_strokeDouble > 0) {
                tmpBounds.width += _strokeDouble * 2;
                tmpBounds.height += _strokeDouble * 2;
            }
            tmpBounds.x -= _strokeDouble + 2; //+2ๅ+4 ๆฏไธบไบ่งฃๅณ่ๅบๅ็้ฎ้ข
            tmpBounds.y -= _strokeDouble + 2;
            tmpBounds.width = Math.ceil(tmpBounds.width) + 4;
            tmpBounds.height = Math.ceil(tmpBounds.height) + 4;
            return tmpBounds;
        };
        /**
         * @private
         */
        TextField.prototype.$measureContentBounds = function (bounds) {
            this.$getLinesArr();
            var w = !isNaN(this.$TextField[3 /* textFieldWidth */]) ? this.$TextField[3 /* textFieldWidth */] : this.$TextField[5 /* textWidth */];
            var h = !isNaN(this.$TextField[4 /* textFieldHeight */]) ? this.$TextField[4 /* textFieldHeight */] : egret.TextFieldUtils.$getTextHeight(this);
            bounds.setTo(0, 0, w, h);
        };
        /**
         * @private
         * @see egret.DisplayObject._render
         * @param renderContext
         */
        TextField.prototype.$render = function () {
            if (this.$TextField[24 /* type */] == egret.TextFieldType.INPUT) {
                if (this.$hasAnyFlags(2032 /* InitFlags */) || this.$hasAnyFlags(1648 /* DownOnAddedOrRemoved */)) {
                    this.inputUtils._updateProperties();
                }
                if (this.$isTyping) {
                    this.fillBackground();
                    return;
                }
            }
            else if (this.$TextField[3 /* textFieldWidth */] == 0) {
                return;
            }
            var underLines = this.drawText();
            this.fillBackground(underLines);
            //tudo ๅฎฝ้ซๅพๅฐ็ๆๅตไธwebglๆจกๅผ็ปๅถๅผๅธธ
            var bounds = this.$getRenderBounds();
            var node = this.textNode;
            node.x = bounds.x;
            node.y = bounds.y;
            node.width = Math.ceil(bounds.width);
            node.height = Math.ceil(bounds.height);
            egret.Rectangle.release(bounds);
        };
        Object.defineProperty(TextField.prototype, "textFlow", {
            /**
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.textArr;
            },
            /**
             * Set rich text
             * @language en_US
             */
            /**
             * ่ฎพ็ฝฎๅฏๆๆฌ
             * @see http://edn.egret.com/cn/index.php/article/index/id/146
             * @language zh_CN
             */
            set: function (textArr) {
                this.isFlow = true;
                var text = "";
                if (textArr == null)
                    textArr = [];
                for (var i = 0; i < textArr.length; i++) {
                    var element = textArr[i];
                    text += element.text;
                }
                if (this.$TextField[20 /* displayAsPassword */]) {
                    this.$setBaseText(text);
                }
                else {
                    this.$TextField[13 /* text */] = text;
                    this.setMiddleStyle(textArr);
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param text
         * @returns
         */
        TextField.prototype.changeToPassText = function (text) {
            if (this.$TextField[20 /* displayAsPassword */]) {
                var passText = "";
                for (var i = 0, num = text.length; i < num; i++) {
                    switch (text.charAt(i)) {
                        case '\n':
                            passText += "\n";
                            break;
                        case '\r':
                            break;
                        default:
                            passText += '*';
                    }
                }
                return passText;
            }
            return text;
        };
        /**
         * @private
         *
         * @param textArr
         */
        TextField.prototype.setMiddleStyle = function (textArr) {
            this.$TextField[18 /* textLinesChanged */] = true;
            this.textArr = textArr;
            this.$invalidateTextField();
        };
        Object.defineProperty(TextField.prototype, "textWidth", {
            /**
             * Get the text measured width
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅๆๆฌๆต้ๅฎฝๅบฆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getLinesArr();
                return this.$TextField[5 /* textWidth */];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextField.prototype, "textHeight", {
            /**
             * Get Text measuring height
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅๆๆฌๆต้้ซๅบฆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                this.$getLinesArr();
                return egret.TextFieldUtils.$getTextHeight(this);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * @param text
         * @version Egret 2.4
         * @platform Web,Native
         */
        TextField.prototype.appendText = function (text) {
            this.appendElement({ text: text });
        };
        /**
         * @private
         * @param element
         * @version Egret 2.4
         * @platform Web,Native
         */
        TextField.prototype.appendElement = function (element) {
            var text = this.$TextField[13 /* text */] + element.text;
            if (this.$TextField[20 /* displayAsPassword */]) {
                this.$setBaseText(text);
            }
            else {
                this.$TextField[13 /* text */] = text;
                this.textArr.push(element);
                this.setMiddleStyle(this.textArr);
            }
        };
        /**
         * @private
         *
         * @returns
         */
        TextField.prototype.$getLinesArr = function () {
            var values = this.$TextField;
            if (!values[18 /* textLinesChanged */]) {
                return this.linesArr;
            }
            values[18 /* textLinesChanged */] = false;
            var text2Arr = this.textArr;
            this.linesArr.length = 0;
            values[6 /* textHeight */] = 0;
            values[5 /* textWidth */] = 0;
            var textFieldWidth = values[3 /* textFieldWidth */];
            //ๅฎฝๅบฆ่ขซ่ฎพ็ฝฎไธบ0
            if (!isNaN(textFieldWidth) && textFieldWidth == 0) {
                values[29 /* numLines */] = 0;
                return [{ width: 0, height: 0, charNum: 0, elements: [], hasNextLine: false }];
            }
            var linesArr = this.linesArr;
            var lineW = 0;
            var lineCharNum = 0;
            var lineH = 0;
            var lineCount = 0;
            var lineElement;
            for (var i = 0, text2ArrLength = text2Arr.length; i < text2ArrLength; i++) {
                var element = text2Arr[i];
                //ๅฏ่ฝ่ฎพ็ฝฎไธบๆฒกๆๆๆฌ๏ผๅฟฝ็ฅ็ปๅถ
                if (!element.text) {
                    if (lineElement) {
                        lineElement.width = lineW;
                        lineElement.height = lineH;
                        lineElement.charNum = lineCharNum;
                        values[5 /* textWidth */] = Math.max(values[5 /* textWidth */], lineW);
                        values[6 /* textHeight */] += lineH;
                    }
                    continue;
                }
                element.style = element.style || {};
                var text = element.text.toString();
                var textArr = text.split(/(?:\r\n|\r|\n)/);
                for (var j = 0, textArrLength = textArr.length; j < textArrLength; j++) {
                    if (linesArr[lineCount] == null) {
                        lineElement = { width: 0, height: 0, elements: [], charNum: 0, hasNextLine: false };
                        linesArr[lineCount] = lineElement;
                        lineW = 0;
                        lineH = 0;
                        lineCharNum = 0;
                    }
                    if (values[24 /* type */] == egret.TextFieldType.INPUT) {
                        lineH = values[0 /* fontSize */];
                    }
                    else {
                        lineH = Math.max(lineH, element.style.size || values[0 /* fontSize */]);
                    }
                    var isNextLine = true;
                    if (textArr[j] == "") {
                        if (j == textArrLength - 1) {
                            isNextLine = false;
                        }
                    }
                    else {
                        var w = measureTextWidth(textArr[j], values, element.style);
                        if (isNaN(textFieldWidth)) {
                            lineW += w;
                            lineCharNum += textArr[j].length;
                            lineElement.elements.push({
                                width: w,
                                text: textArr[j],
                                style: element.style
                            });
                            if (j == textArrLength - 1) {
                                isNextLine = false;
                            }
                        }
                        else {
                            if (lineW + w <= textFieldWidth) {
                                lineElement.elements.push({
                                    width: w,
                                    text: textArr[j],
                                    style: element.style
                                });
                                lineW += w;
                                lineCharNum += textArr[j].length;
                                if (j == textArrLength - 1) {
                                    isNextLine = false;
                                }
                            }
                            else {
                                var k = 0;
                                var ww = 0;
                                var word = textArr[j];
                                var words = void 0;
                                if (values[19 /* wordWrap */]) {
                                    words = word.split(SplitRegex);
                                }
                                else {
                                    words = word.match(/./g);
                                }
                                var wl = words.length;
                                var charNum = 0;
                                for (; k < wl; k++) {
                                    // detect 4 bytes unicode, refer https://mths.be/punycode
                                    var codeLen = words[k].length;
                                    var has4BytesUnicode = false;
                                    if (codeLen == 1 && k < wl - 1) {
                                        var charCodeHigh = words[k].charCodeAt(0);
                                        var charCodeLow = words[k + 1].charCodeAt(0);
                                        if (charCodeHigh >= 0xD800 && charCodeHigh <= 0xDBFF && (charCodeLow & 0xFC00) == 0xDC00) {
                                            var realWord = words[k] + words[k + 1];
                                            codeLen = 2;
                                            has4BytesUnicode = true;
                                            w = measureTextWidth(realWord, values, element.style);
                                        }
                                        else {
                                            w = measureTextWidth(words[k], values, element.style);
                                        }
                                    }
                                    else {
                                        w = measureTextWidth(words[k], values, element.style);
                                    }
                                    // w = measureTextWidth(words[k], values, element.style);
                                    if (lineW != 0 && lineW + w > textFieldWidth && lineW + k != 0) {
                                        break;
                                    }
                                    if (ww + w > textFieldWidth) {
                                        var words2 = words[k].match(/./g);
                                        for (var k2 = 0, wl2 = words2.length; k2 < wl2; k2++) {
                                            // detect 4 bytes unicode, refer https://mths.be/punycode
                                            var codeLen = words2[k2].length;
                                            var has4BytesUnicode2 = false;
                                            if (codeLen == 1 && k2 < wl2 - 1) {
                                                var charCodeHigh = words2[k2].charCodeAt(0);
                                                var charCodeLow = words2[k2 + 1].charCodeAt(0);
                                                if (charCodeHigh >= 0xD800 && charCodeHigh <= 0xDBFF && (charCodeLow & 0xFC00) == 0xDC00) {
                                                    var realWord = words2[k2] + words2[k2 + 1];
                                                    codeLen = 2;
                                                    has4BytesUnicode2 = true;
                                                    w = measureTextWidth(realWord, values, element.style);
                                                }
                                                else {
                                                    w = measureTextWidth(words2[k2], values, element.style);
                                                }
                                            }
                                            else {
                                                w = measureTextWidth(words2[k2], values, element.style);
                                            }
                                            // w = measureTextWidth(words2[k2], values, element.style);
                                            if (k2 > 0 && lineW + w > textFieldWidth) {
                                                break;
                                            }
                                            // charNum += words2[k2].length;
                                            charNum += codeLen;
                                            ww += w;
                                            lineW += w;
                                            lineCharNum += charNum;
                                            if (has4BytesUnicode2) {
                                                k2++;
                                            }
                                        }
                                    }
                                    else {
                                        // charNum += words[k].length;
                                        charNum += codeLen;
                                        ww += w;
                                        lineW += w;
                                        lineCharNum += charNum;
                                    }
                                    if (has4BytesUnicode) {
                                        k++;
                                    }
                                }
                                if (k > 0) {
                                    lineElement.elements.push({
                                        width: ww,
                                        text: word.substring(0, charNum),
                                        style: element.style
                                    });
                                    var leftWord = word.substring(charNum);
                                    var m = void 0;
                                    var lwleng = leftWord.length;
                                    for (m = 0; m < lwleng; m++) {
                                        if (leftWord.charAt(m) != " ") {
                                            break;
                                        }
                                    }
                                    textArr[j] = leftWord.substring(m);
                                }
                                if (textArr[j] != "") {
                                    j--;
                                    isNextLine = false;
                                }
                            }
                        }
                    }
                    if (isNextLine) {
                        lineCharNum++;
                        lineElement.hasNextLine = true;
                    }
                    if (j < textArr.length - 1) {
                        lineElement.width = lineW;
                        lineElement.height = lineH;
                        lineElement.charNum = lineCharNum;
                        values[5 /* textWidth */] = Math.max(values[5 /* textWidth */], lineW);
                        values[6 /* textHeight */] += lineH;
                        //if (this._type == TextFieldType.INPUT && !this._multiline) {
                        //    this._numLines = linesArr.length;
                        //    return linesArr;
                        //}
                        lineCount++;
                    }
                }
                if (i == text2Arr.length - 1 && lineElement) {
                    lineElement.width = lineW;
                    lineElement.height = lineH;
                    lineElement.charNum = lineCharNum;
                    values[5 /* textWidth */] = Math.max(values[5 /* textWidth */], lineW);
                    values[6 /* textHeight */] += lineH;
                }
            }
            values[29 /* numLines */] = linesArr.length;
            return linesArr;
        };
        /**
         * @private
         * ่ฟๅ่ฆ็ปๅถ็ไธๅ็บฟๅ่กจ
         */
        TextField.prototype.drawText = function () {
            var node = this.textNode;
            var values = this.$TextField;
            //ๆดๆฐๆๆฌๆทๅผ
            node.bold = values[15 /* bold */];
            node.fontFamily = values[8 /* fontFamily */] || TextField.default_fontFamily;
            node.italic = values[16 /* italic */];
            node.size = values[0 /* fontSize */];
            node.stroke = values[27 /* stroke */];
            node.strokeColor = values[25 /* strokeColor */];
            node.textColor = values[2 /* textColor */];
            //ๅ็ฎๅบ้่ฆ็ๆฐๅผ
            var lines = this.$getLinesArr();
            if (values[5 /* textWidth */] == 0) {
                return [];
            }
            var maxWidth = !isNaN(values[3 /* textFieldWidth */]) ? values[3 /* textFieldWidth */] : values[5 /* textWidth */];
            var textHeight = egret.TextFieldUtils.$getTextHeight(this);
            var drawY = 0;
            var startLine = egret.TextFieldUtils.$getStartLine(this);
            var textFieldHeight = values[4 /* textFieldHeight */];
            if (!isNaN(textFieldHeight) && textFieldHeight > textHeight) {
                var vAlign = egret.TextFieldUtils.$getValign(this);
                drawY += vAlign * (textFieldHeight - textHeight);
            }
            drawY = Math.round(drawY);
            var hAlign = egret.TextFieldUtils.$getHalign(this);
            var drawX = 0;
            var underLineData = [];
            for (var i = startLine, numLinesLength = values[29 /* numLines */]; i < numLinesLength; i++) {
                var line = lines[i];
                var h = line.height;
                drawY += h / 2;
                if (i != startLine) {
                    if (values[24 /* type */] == egret.TextFieldType.INPUT && !values[30 /* multiline */]) {
                        break;
                    }
                    if (!isNaN(textFieldHeight) && drawY > textFieldHeight) {
                        break;
                    }
                }
                drawX = Math.round((maxWidth - line.width) * hAlign);
                for (var j = 0, elementsLength = line.elements.length; j < elementsLength; j++) {
                    var element = line.elements[j];
                    var size = element.style.size || values[0 /* fontSize */];
                    node.drawText(drawX, drawY + (h - size) / 2, element.text, element.style);
                    if (element.style.underline) {
                        underLineData.push(drawX, drawY + (h) / 2, element.width, element.style.textColor);
                    }
                    drawX += element.width;
                }
                drawY += h / 2 + values[1 /* lineSpacing */];
            }
            return underLineData;
        };
        //ๅขๅ็นๅปไบไปถ
        TextField.prototype.addEvent = function () {
            this.addEventListener(egret.TouchEvent.TOUCH_TAP, this.onTapHandler, this);
        };
        //้ๆพ็นๅปไบไปถ
        TextField.prototype.removeEvent = function () {
            this.removeEventListener(egret.TouchEvent.TOUCH_TAP, this.onTapHandler, this);
        };
        //ๅค็ๅฏๆๆฌไธญๆhref็
        TextField.prototype.onTapHandler = function (e) {
            if (this.$TextField[24 /* type */] == egret.TextFieldType.INPUT) {
                return;
            }
            var ele = egret.TextFieldUtils.$getTextElement(this, e.localX, e.localY);
            if (ele == null) {
                return;
            }
            var style = ele.style;
            if (style && style.href) {
                if (style.href.match(/^event:/)) {
                    var type = style.href.match(/^event:/)[0];
                    egret.TextEvent.dispatchTextEvent(this, egret.TextEvent.LINK, style.href.substring(type.length));
                }
                else {
                    open(style.href, style.target || "_blank");
                }
            }
        };
        /**
         * default fontFamily
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ป่ฎคๆๆฌๅญไฝ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TextField.default_fontFamily = "Arial";
        /**
         * default size in pixels of text
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ป่ฎคๆๆฌๅญๅทๅคงๅฐ
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language zh_CN
         */
        TextField.default_size = 30;
        /**
         * default color of the text.
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ป่ฎคๆๆฌ้ข่ฒ
         * @version Egret 3.2.1
         * @platform Web,Native
         * @language zh_CN
         */
        TextField.default_textColor = 0xffffff;
        return TextField;
    }(egret.DisplayObject));
    egret.TextField = TextField;
    __reflect(TextField.prototype, "egret.TextField");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * TextFieldInputType class is an enumeration of constant value used in setting the inputType property of the TextField class.
     * @version Egret 3.1.2
     * @platform Web,Native
     * @language en_US
     */
    /**
     * TextFieldInputType ็ฑปๆฏๅจ่ฎพ็ฝฎ TextField ็ฑป็ inputType ๅฑๆงๆถไฝฟ็จ็ๅธธๆฐๅผ็ๆไธพใ
     * @version Egret 3.1.2
     * @platform Web,Native
     * @language zh_CN
     */
    var TextFieldInputType = (function () {
        function TextFieldInputType() {
        }
        /**
         * The default
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ป่ฎค input ็ฑปๅ
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language zh_CN
         */
        TextFieldInputType.TEXT = "text";
        /**
         * Telephone Number Inputs
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ต่ฏๅท็ input ็ฑปๅ
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language zh_CN
         */
        TextFieldInputType.TEL = "tel";
        /**
         * Password Inputs
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language en_US
         */
        /**
         * password ็ฑปๅ
         * @version Egret 3.1.2
         * @platform Web,Native
         * @language zh_CN
         */
        TextFieldInputType.PASSWORD = "password";
        return TextFieldInputType;
    }());
    egret.TextFieldInputType = TextFieldInputType;
    __reflect(TextFieldInputType.prototype, "egret.TextFieldInputType");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * TextFieldType class is an enumeration of constant value used in setting the type property of the TextField class.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * TextFieldType ็ฑปๆฏๅจ่ฎพ็ฝฎ TextField ็ฑป็ type ๅฑๆงๆถไฝฟ็จ็ๅธธๆฐๅผ็ๆไธพใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var TextFieldType = (function () {
        function TextFieldType() {
        }
        /**
         * Used to specify dynamic text
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๆๅฎๅจๆๆๆฌ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TextFieldType.DYNAMIC = "dynamic";
        /**
         * Used to specify the input text
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จไบๆๅฎ่พๅฅๆๆฌ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        TextFieldType.INPUT = "input";
        return TextFieldType;
    }());
    egret.TextFieldType = TextFieldType;
    __reflect(TextFieldType.prototype, "egret.TextFieldType");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     * @version Egret 2.4
     * @platform Web,Native
     */
    var TextFieldUtils = (function () {
        function TextFieldUtils() {
        }
        /**
         * ่ทๅ็ฌฌไธไธช็ปๅถ็่กๆฐ
         * @param textfield ๆๆฌ
         * @returns {number} ่กๆฐ๏ผไป0ๅผๅง
         * @private
         */
        TextFieldUtils.$getStartLine = function (textfield) {
            var values = textfield.$TextField;
            var textHeight = TextFieldUtils.$getTextHeight(textfield);
            var startLine = 0;
            var textFieldHeight = values[4 /* textFieldHeight */];
            if (!isNaN(textFieldHeight)) {
                if (textHeight < textFieldHeight) {
                }
                else if (textHeight > textFieldHeight) {
                    startLine = Math.max(values[28 /* scrollV */] - 1, 0);
                    startLine = Math.min(values[29 /* numLines */] - 1, startLine);
                }
                if (!values[30 /* multiline */]) {
                    startLine = Math.max(values[28 /* scrollV */] - 1, 0);
                    if (values[29 /* numLines */] > 0) {
                        startLine = Math.min(values[29 /* numLines */] - 1, startLine);
                    }
                }
            }
            return startLine;
        };
        /**
         * ่ทๅๆฐดๅนณๆฏไพ
         * @param textfield ๆๆฌ
         * @returns {number} ๆฐดๅนณๆฏไพ
         * @private
         */
        TextFieldUtils.$getHalign = function (textfield) {
            var lineArr = textfield.$getLinesArr();
            var halign = 0;
            if (textfield.$TextField[9 /* textAlign */] == egret.HorizontalAlign.CENTER) {
                halign = 0.5;
            }
            else if (textfield.$TextField[9 /* textAlign */] == egret.HorizontalAlign.RIGHT) {
                halign = 1;
            }
            if (textfield.$TextField[24 /* type */] == egret.TextFieldType.INPUT && !textfield.$TextField[30 /* multiline */] && lineArr.length > 1) {
                halign = 0;
            }
            return halign;
        };
        /**
         * @private
         *
         * @param textfield
         * @returns
         */
        TextFieldUtils.$getTextHeight = function (textfield) {
            var textHeight = (egret.TextFieldType.INPUT == textfield.$TextField[24 /* type */]
                && !textfield.$TextField[30 /* multiline */]) ? textfield.$TextField[0 /* fontSize */] : (textfield.$TextField[6 /* textHeight */] + (textfield.$TextField[29 /* numLines */] - 1) * textfield.$TextField[1 /* lineSpacing */]);
            return textHeight;
        };
        /**
         * ่ทๅๅ็ดๆฏไพ
         * @param textfield ๆๆฌ
         * @returns {number} ๅ็ดๆฏไพ
         * @private
         */
        TextFieldUtils.$getValign = function (textfield) {
            var textHeight = TextFieldUtils.$getTextHeight(textfield);
            //if (textfield.$TextField[sys.TextKeys.type] == egret.TextFieldType.INPUT) {
            //    if (textfield.$TextField[sys.TextKeys.multiline]) {
            //return 0;
            //}
            //return 0.5;
            //}
            var textFieldHeight = textfield.$TextField[4 /* textFieldHeight */];
            if (!isNaN(textFieldHeight)) {
                if (textHeight < textFieldHeight) {
                    var valign = 0;
                    if (textfield.$TextField[10 /* verticalAlign */] == egret.VerticalAlign.MIDDLE)
                        valign = 0.5;
                    else if (textfield.$TextField[10 /* verticalAlign */] == egret.VerticalAlign.BOTTOM)
                        valign = 1;
                    return valign;
                }
            }
            return 0;
        };
        /**
         * ๆนๆฎxใy่ทๅๆๆฌ้กน
         * @param textfield ๆๆฌ
         * @param x xๅๆๅผ
         * @param y yๅๆๅผ
         * @returns ๆๆฌๅ้กน
         * @private
         */
        TextFieldUtils.$getTextElement = function (textfield, x, y) {
            var hitTextEle = TextFieldUtils.$getHit(textfield, x, y);
            var lineArr = textfield.$getLinesArr();
            if (hitTextEle && lineArr[hitTextEle.lineIndex] && lineArr[hitTextEle.lineIndex].elements[hitTextEle.textElementIndex]) {
                return lineArr[hitTextEle.lineIndex].elements[hitTextEle.textElementIndex];
            }
            return null;
        };
        /**
         * ่ทๅๆๆฌ็นๅปๅ
         * @param textfield ๆๆฌ
         * @param x xๅๆๅผ
         * @param y yๅๆๅผ
         * @returns ๆๆฌ็นๅปๅ
         * @private
         */
        TextFieldUtils.$getHit = function (textfield, x, y) {
            var lineArr = textfield.$getLinesArr();
            if (textfield.$TextField[3 /* textFieldWidth */] == 0) {
                return null;
            }
            var line = 0;
            var textHeight = TextFieldUtils.$getTextHeight(textfield);
            var startY = 0;
            var textFieldHeight = textfield.$TextField[4 /* textFieldHeight */];
            if (!isNaN(textFieldHeight) && textFieldHeight > textHeight) {
                var valign = TextFieldUtils.$getValign(textfield);
                startY = valign * (textFieldHeight - textHeight);
                if (startY != 0) {
                    y -= startY;
                }
            }
            var startLine = TextFieldUtils.$getStartLine(textfield);
            var lineH = 0;
            for (var i = startLine; i < lineArr.length; i++) {
                var lineEle = lineArr[i];
                if (lineH + lineEle.height >= y) {
                    if (lineH < y) {
                        line = i + 1;
                    }
                    break;
                }
                else {
                    lineH += lineEle.height;
                }
                if (lineH + textfield.$TextField[1 /* lineSpacing */] > y) {
                    return null;
                }
                lineH += textfield.$TextField[1 /* lineSpacing */];
            }
            if (line == 0) {
                return null;
            }
            var lineElement = lineArr[line - 1];
            var textFieldWidth = textfield.$TextField[3 /* textFieldWidth */];
            if (isNaN(textFieldWidth)) {
                textFieldWidth = textfield.textWidth;
            }
            var halign = TextFieldUtils.$getHalign(textfield);
            x -= halign * (textFieldWidth - lineElement.width);
            var lineW = 0;
            for (var i = 0; i < lineElement.elements.length; i++) {
                var iwTE = lineElement.elements[i];
                if (lineW + iwTE.width <= x) {
                    lineW += iwTE.width;
                }
                else if (lineW < x) {
                    return { "lineIndex": line - 1, "textElementIndex": i };
                }
            }
            return null;
        };
        /**
         * ่ทๅๅฝๅๆพ็คบๅคๅฐ่ก
         * @param textfield ๆๆฌ
         * @returns {number} ๆพ็คบ็่กๆฐ
         * @private
         */
        TextFieldUtils.$getScrollNum = function (textfield) {
            var scrollNum = 1;
            if (textfield.$TextField[30 /* multiline */]) {
                var height = textfield.height;
                var size = textfield.size;
                var lineSpacing = textfield.lineSpacing;
                scrollNum = Math.floor(height / (size + lineSpacing));
                var leftH = height - (size + lineSpacing) * scrollNum;
                if (leftH > size / 2) {
                    scrollNum++;
                }
            }
            return scrollNum;
        };
        return TextFieldUtils;
    }());
    egret.TextFieldUtils = TextFieldUtils;
    __reflect(TextFieldUtils.prototype, "egret.TextFieldUtils");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/**
 * @private
 */
var egret;
(function (egret) {
    var sys;
    (function (sys) {
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The VerticalAlign class defines the possible values for the vertical alignment.
     * @see egret.TextField#verticalAlign
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * VerticalAlign ็ฑปไธบๅ็ดๅฏน้ฝๆนๅผๅฎไนๅฏ่ฝ็ๅผใ
     * @see egret.TextField#verticalAlign
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var VerticalAlign = (function () {
        function VerticalAlign() {
        }
        /**
         * Vertically align content to the top of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅๅฎนไธๅฎนๅจ็้กถ้จๅฏน้ฝใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        VerticalAlign.TOP = "top";
        /**
         * Vertically align content to the bottom of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅๅฎนไธๅฎนๅจ็ๅบ้จๅฏน้ฝใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        VerticalAlign.BOTTOM = "bottom";
        /**
         * Vertically align content in the middle of the container.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅฎนๅจ็ๅ็ดไธญๅฟๅฏน้ฝๅๅฎนใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        VerticalAlign.MIDDLE = "middle";
        /**
         * Vertical alignment with both edges
         * Note: TextFiled does not support this alignment method."
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ็ดไธค็ซฏๅฏน้ฝ
         * ๆณจๆ๏ผTextFiledไธๆฏๆๆญคๅฏน้ฝๆนๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        VerticalAlign.JUSTIFY = "justify";
        /**
         * Align the content of the child items, relative to the container. This operation will adjust uniformly the size of all the child items to be the Content Height \" of the container \".
         * The Content Height \" of the container \" is the size of the max. child item. If the size of all child items are less than the height of the container, they will be adjusted to the height of the container.
         * Note: TextFiled does not support this alignment method.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ธๅฏนไบๅฎนๅจๅฏนๅญ้กน่ฟ่กๅๅฎนๅฏน้ฝใ่ฟไผๅฐๆๆๅญ้กน็ๅคงๅฐ็ปไธ่ฐๆดไธบๅฎนๅจ็"ๅๅฎน้ซๅบฆ"ใ
         * ๅฎนๅจ็"ๅๅฎน้ซๅบฆ"ๆฏๆๅคงๅญ้กน็ๅคงๅฐ,ๅฆๆๆๆๅญ้กน้ฝๅฐไบๅฎนๅจ็้ซๅบฆ๏ผๅไผๅฐๆๆๅญ้กน็ๅคงๅฐ่ฐๆดไธบๅฎนๅจ็้ซๅบฆใ
         * ๆณจๆ๏ผTextFiledไธๆฏๆๆญคๅฏน้ฝๆนๅผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        VerticalAlign.CONTENT_JUSTIFY = "contentJustify";
        return VerticalAlign;
    }());
    egret.VerticalAlign = VerticalAlign;
    __reflect(VerticalAlign.prototype, "egret.VerticalAlign");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
    * @language en_US
    * The Base64Util class provides methods for encoding and decoding base64.
    * @version Egret 2.4
    * @platform Web,Native
    * @includeExample egret/utils/Base64Util.ts
    */
    /**
     * @language zh_CN
     * Base64Util ็ฑปๆไพ็จไบ็ผ่งฃ็base64็ๆนๆณใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/Base64Util.ts
     */
    var Base64Util = (function () {
        function Base64Util() {
        }
        /**
         * @language en_US
         * encode base64.
         * @version Egret 2.4
         * @platform Web,Native
         */
        /**
         * @language zh_CN
         * ็ผ็base64ใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Base64Util.encode = function (arraybuffer) {
            var bytes = new Uint8Array(arraybuffer);
            var len = bytes.length;
            var base64 = '';
            for (var i = 0; i < len; i += 3) {
                base64 += chars[bytes[i] >> 2];
                base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];
                base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];
                base64 += chars[bytes[i + 2] & 63];
            }
            if ((len % 3) === 2) {
                base64 = base64.substring(0, base64.length - 1) + '=';
            }
            else if (len % 3 === 1) {
                base64 = base64.substring(0, base64.length - 2) + '==';
            }
            return base64;
        };
        /**
         * @language en_US
         * decode base64.
         * @version Egret 2.4
         * @platform Web,Native
         */
        /**
         * @language zh_CN
         * ่งฃ็base64ใ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Base64Util.decode = function (base64) {
            var bufferLength = base64.length * 0.75;
            var len = base64.length;
            var p = 0;
            var encoded1 = 0;
            var encoded2 = 0;
            var encoded3 = 0;
            var encoded4 = 0;
            if (base64[base64.length - 1] === '=') {
                bufferLength--;
                if (base64[base64.length - 2] === '=') {
                    bufferLength--;
                }
            }
            var arraybuffer = new ArrayBuffer(bufferLength), bytes = new Uint8Array(arraybuffer);
            for (var i = 0; i < len; i += 4) {
                encoded1 = lookup[base64.charCodeAt(i)];
                encoded2 = lookup[base64.charCodeAt(i + 1)];
                encoded3 = lookup[base64.charCodeAt(i + 2)];
                encoded4 = lookup[base64.charCodeAt(i + 3)];
                bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);
                bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);
                bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);
            }
            return arraybuffer;
        };
        return Base64Util;
    }());
    egret.Base64Util = Base64Util;
    __reflect(Base64Util.prototype, "egret.Base64Util");
})(egret || (egret = {}));
/**
 * @private
 */
var chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
/**
 * @private
 */
var lookup = new Uint8Array(256);
for (var i = 0; i < chars.length; i++) {
    lookup[chars.charCodeAt(i)] = i;
}
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Endian class contains values that denote the byte order used to represent multibyte numbers.
     * The byte order is either bigEndian (most significant byte first) or littleEndian (least significant byte first).
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Endian ็ฑปไธญๅๅซไธไบๅผ๏ผๅฎไปฌ่กจ็คบ็จไบ่กจ็คบๅคๅญ่ๆฐๅญ็ๅญ่้กบๅบใ
     * ๅญ่้กบๅบไธบ bigEndian๏ผๆ้ซๆๆๅญ่ไฝไบๆๅ๏ผๆ littleEndian๏ผๆไฝๆๆๅญ่ไฝไบๆๅ๏ผใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var Endian = (function () {
        function Endian() {
        }
        /**
         * Indicates the least significant byte of the multibyte number appears first in the sequence of bytes.
         * The hexadecimal number 0x12345678 has 4 bytes (2 hexadecimal digits per byte). The most significant byte is 0x12. The least significant byte is 0x78. (For the equivalent decimal number, 305419896, the most significant digit is 3, and the least significant digit is 6).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบๅคๅญ่ๆฐๅญ็ๆไฝๆๆๅญ่ไฝไบๅญ่ๅบๅ็ๆๅ้ขใ
         * ๅๅญ่ฟๅถๆฐๅญ 0x12345678 ๅๅซ 4 ไธชๅญ่๏ผๆฏไธชๅญ่ๅๅซ 2 ไธชๅๅญ่ฟๅถๆฐๅญ๏ผใๆ้ซๆๆๅญ่ไธบ 0x12ใๆไฝๆๆๅญ่ไธบ 0x78ใ๏ผๅฏนไบ็ญๆ็ๅ่ฟๅถๆฐๅญ 305419896๏ผๆ้ซๆๆๆฐๅญๆฏ 3๏ผๆไฝๆๆๆฐๅญๆฏ 6๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Endian.LITTLE_ENDIAN = "littleEndian";
        /**
         * Indicates the most significant byte of the multibyte number appears first in the sequence of bytes.
         * The hexadecimal number 0x12345678 has 4 bytes (2 hexadecimal digits per byte).  The most significant byte is 0x12. The least significant byte is 0x78. (For the equivalent decimal number, 305419896, the most significant digit is 3, and the least significant digit is 6).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบๅคๅญ่ๆฐๅญ็ๆ้ซๆๆๅญ่ไฝไบๅญ่ๅบๅ็ๆๅ้ขใ
         * ๅๅญ่ฟๅถๆฐๅญ 0x12345678 ๅๅซ 4 ไธชๅญ่๏ผๆฏไธชๅญ่ๅๅซ 2 ไธชๅๅญ่ฟๅถๆฐๅญ๏ผใๆ้ซๆๆๅญ่ไธบ 0x12ใๆไฝๆๆๅญ่ไธบ 0x78ใ๏ผๅฏนไบ็ญๆ็ๅ่ฟๅถๆฐๅญ 305419896๏ผๆ้ซๆๆๆฐๅญๆฏ 3๏ผๆไฝๆๆๆฐๅญๆฏ 6๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Endian.BIG_ENDIAN = "bigEndian";
        return Endian;
    }());
    egret.Endian = Endian;
    __reflect(Endian.prototype, "egret.Endian");
    /**
     * The ByteArray class provides methods and attributes for optimized reading and writing as well as dealing with binary data.
     * Note: The ByteArray class is applied to the advanced developers who need to access data at the byte layer.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/ByteArray.ts
     * @language en_US
     */
    /**
     * ByteArray ็ฑปๆไพ็จไบไผๅ่ฏปๅใๅๅฅไปฅๅๅค็ไบ่ฟๅถๆฐๆฎ็ๆนๆณๅๅฑๆงใ
     * ๆณจๆ๏ผByteArray ็ฑป้็จไบ้่ฆๅจๅญ่ๅฑ่ฎฟ้ฎๆฐๆฎ็้ซ็บงๅผๅไบบๅใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/ByteArray.ts
     * @language zh_CN
     */
    var ByteArray = (function () {
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function ByteArray(buffer, bufferExtSize) {
            if (bufferExtSize === void 0) {
                bufferExtSize = 0;
            }
            /**
             * @private
             */
            this.bufferExtSize = 0; //Buffer expansion size
            /**
             * @private
             */
            this.EOF_byte = -1;
            /**
             * @private
             */
            this.EOF_code_point = -1;
            if (bufferExtSize < 0) {
                bufferExtSize = 0;
            }
            this.bufferExtSize = bufferExtSize;
            var bytes, wpos = 0;
            if (buffer) {
                var uint8 = void 0;
                if (buffer instanceof Uint8Array) {
                    uint8 = buffer;
                    wpos = buffer.length;
                }
                else {
                    wpos = buffer.byteLength;
                    uint8 = new Uint8Array(buffer);
                }
                if (bufferExtSize == 0) {
                    bytes = new Uint8Array(wpos);
                }
                else {
                    var multi = (wpos / bufferExtSize | 0) + 1;
                    bytes = new Uint8Array(multi * bufferExtSize);
                }
                bytes.set(uint8);
            }
            else {
                bytes = new Uint8Array(bufferExtSize);
            }
            this.write_position = wpos;
            this._position = 0;
            this._bytes = bytes;
            this.data = new DataView(bytes.buffer);
            this.endian = Endian.BIG_ENDIAN;
        }
        Object.defineProperty(ByteArray.prototype, "endian", {
            /**
             * Changes or reads the byte order; egret.EndianConst.BIG_ENDIAN or egret.EndianConst.LITTLE_EndianConst.
             * @default egret.EndianConst.BIG_ENDIAN
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆดๆนๆ่ฏปๅๆฐๆฎ็ๅญ่้กบๅบ๏ผegret.EndianConst.BIG_ENDIAN ๆ egret.EndianConst.LITTLE_ENDIANใ
             * @default egret.EndianConst.BIG_ENDIAN
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$endian == 0 /* LITTLE_ENDIAN */ ? Endian.LITTLE_ENDIAN : Endian.BIG_ENDIAN;
            },
            set: function (value) {
                this.$endian = value == Endian.LITTLE_ENDIAN ? 0 /* LITTLE_ENDIAN */ : 1 /* BIG_ENDIAN */;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @deprecated
         * @version Egret 2.4
         * @platform Web,Native
         */
        ByteArray.prototype.setArrayBuffer = function (buffer) {
        };
        Object.defineProperty(ByteArray.prototype, "readAvailable", {
            /**
             * ๅฏ่ฏป็ๅฉไฝๅญ่ๆฐ
             *
             * @returns
             *
             * @memberOf ByteArray
             */
            get: function () {
                return this.write_position - this._position;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "buffer", {
            get: function () {
                return this.data.buffer.slice(0, this.write_position);
            },
            /**
             * @private
             */
            set: function (value) {
                var wpos = value.byteLength;
                var uint8 = new Uint8Array(value);
                var bufferExtSize = this.bufferExtSize;
                var bytes;
                if (bufferExtSize == 0) {
                    bytes = new Uint8Array(wpos);
                }
                else {
                    var multi = (wpos / bufferExtSize | 0) + 1;
                    bytes = new Uint8Array(multi * bufferExtSize);
                }
                bytes.set(uint8);
                this.write_position = wpos;
                this._bytes = bytes;
                this.data = new DataView(bytes.buffer);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "rawBuffer", {
            get: function () {
                return this.data.buffer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "bytes", {
            get: function () {
                return this._bytes;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "dataView", {
            /**
             * @private
             * @version Egret 2.4
             * @platform Web,Native
             */
            get: function () {
                return this.data;
            },
            /**
             * @private
             */
            set: function (value) {
                this.buffer = value.buffer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "bufferOffset", {
            /**
             * @private
             */
            get: function () {
                return this.data.byteOffset;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "position", {
            /**
             * The current position of the file pointer (in bytes) to move or return to the ByteArray object. The next time you start reading reading method call in this position, or will start writing in this position next time call a write method.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฐๆไปถๆ้็ๅฝๅไฝ็ฝฎ๏ผไปฅๅญ่ไธบๅไฝ๏ผ็งปๅจๆ่ฟๅๅฐ ByteArray ๅฏน่ฑกไธญใไธไธๆฌก่ฐ็จ่ฏปๅๆนๆณๆถๅฐๅจๆญคไฝ็ฝฎๅผๅง่ฏปๅ๏ผๆ่ไธไธๆฌก่ฐ็จๅๅฅๆนๆณๆถๅฐๅจๆญคไฝ็ฝฎๅผๅงๅๅฅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._position;
            },
            set: function (value) {
                this._position = value;
                if (value > this.write_position) {
                    this.write_position = value;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ByteArray.prototype, "length", {
            /**
             * The length of the ByteArray object (in bytes).
                      * If the length is set to be larger than the current length, the right-side zero padding byte array.
                      * If the length is set smaller than the current length, the byte array is truncated.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ByteArray ๅฏน่ฑก็้ฟๅบฆ๏ผไปฅๅญ่ไธบๅไฝ๏ผใ
             * ๅฆๆๅฐ้ฟๅบฆ่ฎพ็ฝฎไธบๅคงไบๅฝๅ้ฟๅบฆ็ๅผ๏ผๅ็จ้ถๅกซๅๅญ่ๆฐ็ป็ๅณไพงใ
             * ๅฆๆๅฐ้ฟๅบฆ่ฎพ็ฝฎไธบๅฐไบๅฝๅ้ฟๅบฆ็ๅผ๏ผๅฐไผๆชๆญ่ฏฅๅญ่ๆฐ็ปใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.write_position;
            },
            set: function (value) {
                this.write_position = value;
                if (this.data.byteLength > value) {
                    this._position = value;
                }
                this._validateBuffer(value);
            },
            enumerable: true,
            configurable: true
        });
        ByteArray.prototype._validateBuffer = function (value) {
            if (this.data.byteLength < value) {
                var be = this.bufferExtSize;
                var tmp = void 0;
                if (be == 0) {
                    tmp = new Uint8Array(value);
                }
                else {
                    var nLen = ((value / be >> 0) + 1) * be;
                    tmp = new Uint8Array(nLen);
                }
                tmp.set(this._bytes);
                this._bytes = tmp;
                this.data = new DataView(tmp.buffer);
            }
        };
        Object.defineProperty(ByteArray.prototype, "bytesAvailable", {
            /**
             * The number of bytes that can be read from the current position of the byte array to the end of the array data.
             * When you access a ByteArray object, the bytesAvailable property in conjunction with the read methods each use to make sure you are reading valid data.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฏไปๅญ่ๆฐ็ป็ๅฝๅไฝ็ฝฎๅฐๆฐ็ปๆซๅฐพ่ฏปๅ็ๆฐๆฎ็ๅญ่ๆฐใ
             * ๆฏๆฌก่ฎฟ้ฎ ByteArray ๅฏน่ฑกๆถ๏ผๅฐ bytesAvailable ๅฑๆงไธ่ฏปๅๆนๆณ็ปๅไฝฟ็จ๏ผไปฅ็กฎไฟ่ฏปๅๆๆ็ๆฐๆฎใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.data.byteLength - this._position;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Clears the contents of the byte array and resets the length and position properties to 0.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆธ้คๅญ่ๆฐ็ป็ๅๅฎน๏ผๅนถๅฐ length ๅ position ๅฑๆง้็ฝฎไธบ 0ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.clear = function () {
            var buffer = new ArrayBuffer(this.bufferExtSize);
            this.data = new DataView(buffer);
            this._bytes = new Uint8Array(buffer);
            this._position = 0;
            this.write_position = 0;
        };
        /**
         * Read a Boolean value from the byte stream. Read a simple byte. If the byte is non-zero, it returns true; otherwise, it returns false.
         * @return If the byte is non-zero, it returns true; otherwise, it returns false.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅๅธๅฐๅผใ่ฏปๅๅไธชๅญ่๏ผๅฆๆๅญ่้้ถ๏ผๅ่ฟๅ true๏ผๅฆๅ่ฟๅ false
         * @return ๅฆๆๅญ่ไธไธบ้ถ๏ผๅ่ฟๅ true๏ผๅฆๅ่ฟๅ false
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readBoolean = function () {
            if (this.validate(1 /* SIZE_OF_BOOLEAN */))
                return !!this._bytes[this.position++];
        };
        /**
         * Read signed bytes from the byte stream.
         * @return An integer ranging from -128 to 127
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅๅธฆ็ฌฆๅท็ๅญ่
         * @return ไปไบ -128 ๅ 127 ไน้ด็ๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readByte = function () {
            if (this.validate(1 /* SIZE_OF_INT8 */))
                return this.data.getInt8(this.position++);
        };
        /**
         * Read data byte number specified by the length parameter from the byte stream. Starting from the position specified by offset, read bytes into the ByteArray object specified by the bytes parameter, and write bytes into the target ByteArray
         * @param bytes ByteArray object that data is read into
         * @param offset Offset (position) in bytes. Read data should be written from this position
         * @param length Byte number to be read Default value 0 indicates reading all available data
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅ length ๅๆฐๆๅฎ็ๆฐๆฎๅญ่ๆฐใไป offset ๆๅฎ็ไฝ็ฝฎๅผๅง๏ผๅฐๅญ่่ฏปๅฅ bytes ๅๆฐๆๅฎ็ ByteArray ๅฏน่ฑกไธญ๏ผๅนถๅฐๅญ่ๅๅฅ็ฎๆ ByteArray ไธญ
         * @param bytes ่ฆๅฐๆฐๆฎ่ฏปๅฅ็ ByteArray ๅฏน่ฑก
         * @param offset bytes ไธญ็ๅ็งป๏ผไฝ็ฝฎ๏ผ๏ผๅบไป่ฏฅไฝ็ฝฎๅๅฅ่ฏปๅ็ๆฐๆฎ
         * @param length ่ฆ่ฏปๅ็ๅญ่ๆฐใ้ป่ฎคๅผ 0 ๅฏผ่ด่ฏปๅๆๆๅฏ็จ็ๆฐๆฎ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readBytes = function (bytes, offset, length) {
            if (offset === void 0) {
                offset = 0;
            }
            if (length === void 0) {
                length = 0;
            }
            if (!bytes) {
                return;
            }
            var pos = this._position;
            var available = this.write_position - pos;
            if (available < 0) {
                egret.$error(1025);
                return;
            }
            if (length == 0) {
                length = available;
            }
            else if (length > available) {
                egret.$error(1025);
                return;
            }
            bytes.validateBuffer(offset + length);
            bytes._bytes.set(this._bytes.subarray(pos, pos + length), offset);
            this.position += length;
        };
        /**
         * Read an IEEE 754 double-precision (64 bit) floating point number from the byte stream
         * @return Double-precision (64 bit) floating point number
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธช IEEE 754 ๅ็ฒพๅบฆ๏ผ64 ไฝ๏ผๆตฎ็นๆฐ
         * @return ๅ็ฒพๅบฆ๏ผ64 ไฝ๏ผๆตฎ็นๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readDouble = function () {
            if (this.validate(8 /* SIZE_OF_FLOAT64 */)) {
                var value = this.data.getFloat64(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 8 /* SIZE_OF_FLOAT64 */;
                return value;
            }
        };
        /**
         * Read an IEEE 754 single-precision (32 bit) floating point number from the byte stream
         * @return Single-precision (32 bit) floating point number
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธช IEEE 754 ๅ็ฒพๅบฆ๏ผ32 ไฝ๏ผๆตฎ็นๆฐ
         * @return ๅ็ฒพๅบฆ๏ผ32 ไฝ๏ผๆตฎ็นๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readFloat = function () {
            if (this.validate(4 /* SIZE_OF_FLOAT32 */)) {
                var value = this.data.getFloat32(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 4 /* SIZE_OF_FLOAT32 */;
                return value;
            }
        };
        /**
         * Read a 32-bit signed integer from the byte stream.
         * @return A 32-bit signed integer ranging from -2147483648 to 2147483647
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธชๅธฆ็ฌฆๅท็ 32 ไฝๆดๆฐ
         * @return ไปไบ -2147483648 ๅ 2147483647 ไน้ด็ 32 ไฝๅธฆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readInt = function () {
            if (this.validate(4 /* SIZE_OF_INT32 */)) {
                var value = this.data.getInt32(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 4 /* SIZE_OF_INT32 */;
                return value;
            }
        };
        /**
         * Read a 16-bit signed integer from the byte stream.
         * @return A 16-bit signed integer ranging from -32768 to 32767
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธชๅธฆ็ฌฆๅท็ 16 ไฝๆดๆฐ
         * @return ไปไบ -32768 ๅ 32767 ไน้ด็ 16 ไฝๅธฆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readShort = function () {
            if (this.validate(2 /* SIZE_OF_INT16 */)) {
                var value = this.data.getInt16(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 2 /* SIZE_OF_INT16 */;
                return value;
            }
        };
        /**
         * Read unsigned bytes from the byte stream.
         * @return A 32-bit unsigned integer ranging from 0 to 255
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅๆ็ฌฆๅท็ๅญ่
         * @return ไปไบ 0 ๅ 255 ไน้ด็ 32 ไฝๆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readUnsignedByte = function () {
            if (this.validate(1 /* SIZE_OF_UINT8 */))
                return this._bytes[this.position++];
        };
        /**
         * Read a 32-bit unsigned integer from the byte stream.
         * @return A 32-bit unsigned integer ranging from 0 to 4294967295
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธชๆ็ฌฆๅท็ 32 ไฝๆดๆฐ
         * @return ไปไบ 0 ๅ 4294967295 ไน้ด็ 32 ไฝๆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readUnsignedInt = function () {
            if (this.validate(4 /* SIZE_OF_UINT32 */)) {
                var value = this.data.getUint32(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 4 /* SIZE_OF_UINT32 */;
                return value;
            }
        };
        /**
         * Read a 16-bit unsigned integer from the byte stream.
         * @return A 16-bit unsigned integer ranging from 0 to 65535
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธชๆ็ฌฆๅท็ 16 ไฝๆดๆฐ
         * @return ไปไบ 0 ๅ 65535 ไน้ด็ 16 ไฝๆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readUnsignedShort = function () {
            if (this.validate(2 /* SIZE_OF_UINT16 */)) {
                var value = this.data.getUint16(this._position, this.$endian == 0 /* LITTLE_ENDIAN */);
                this.position += 2 /* SIZE_OF_UINT16 */;
                return value;
            }
        };
        /**
         * Read a UTF-8 character string from the byte stream Assume that the prefix of the character string is a short unsigned integer (use byte to express length)
         * @return UTF-8 character string
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธช UTF-8 ๅญ็ฌฆไธฒใๅๅฎๅญ็ฌฆไธฒ็ๅ็ผๆฏๆ็ฌฆๅท็็ญๆดๅ๏ผไปฅๅญ่่กจ็คบ้ฟๅบฆ๏ผ
         * @return UTF-8 ็ผ็็ๅญ็ฌฆไธฒ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readUTF = function () {
            var length = this.readUnsignedShort();
            if (length > 0) {
                return this.readUTFBytes(length);
            }
            else {
                return "";
            }
        };
        /**
         * Read a UTF-8 byte sequence specified by the length parameter from the byte stream, and then return a character string
         * @param Specify a short unsigned integer of the UTF-8 byte length
         * @return A character string consists of UTF-8 bytes of the specified length
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅญ่ๆตไธญ่ฏปๅไธไธช็ฑ length ๅๆฐๆๅฎ็ UTF-8 ๅญ่ๅบๅ๏ผๅนถ่ฟๅไธไธชๅญ็ฌฆไธฒ
         * @param length ๆๆ UTF-8 ๅญ่้ฟๅบฆ็ๆ็ฌฆๅท็ญๆดๅๆฐ
         * @return ็ฑๆๅฎ้ฟๅบฆ็ UTF-8 ๅญ่็ปๆ็ๅญ็ฌฆไธฒ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.readUTFBytes = function (length) {
            if (!this.validate(length))
                return;
            var bytes = new Uint8Array(this.buffer, this.bufferOffset + this._position, length);
            this.position += length;
            return this.decodeUTF8(bytes);
        };
        /**
         * Write a Boolean value. A single byte is written according to the value parameter. If the value is true, write 1; if the value is false, write 0.
         * @param value A Boolean value determining which byte is written. If the value is true, write 1; if the value is false, write 0.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅฅๅธๅฐๅผใๆนๆฎ value ๅๆฐๅๅฅๅไธชๅญ่ใๅฆๆไธบ true๏ผๅๅๅฅ 1๏ผๅฆๆไธบ false๏ผๅๅๅฅ 0
         * @param value ็กฎๅฎๅๅฅๅชไธชๅญ่็ๅธๅฐๅผใๅฆๆ่ฏฅๅๆฐไธบ true๏ผๅ่ฏฅๆนๆณๅๅฅ 1๏ผๅฆๆ่ฏฅๅๆฐไธบ false๏ผๅ่ฏฅๆนๆณๅๅฅ 0
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeBoolean = function (value) {
            this.validateBuffer(1 /* SIZE_OF_BOOLEAN */);
            this._bytes[this.position++] = +value;
        };
        /**
         * Write a byte into the byte stream
         * The low 8 bits of the parameter are used. The high 24 bits are ignored.
         * @param value A 32-bit integer. The low 8 bits will be written into the byte stream
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธชๅญ่
         * ไฝฟ็จๅๆฐ็ไฝ 8 ไฝใๅฟฝ็ฅ้ซ 24 ไฝ
         * @param value ไธไธช 32 ไฝๆดๆฐใไฝ 8 ไฝๅฐ่ขซๅๅฅๅญ่ๆต
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeByte = function (value) {
            this.validateBuffer(1 /* SIZE_OF_INT8 */);
            this._bytes[this.position++] = value & 0xff;
        };
        /**
         * Write the byte sequence that includes length bytes in the specified byte array, bytes, (starting at the byte specified by offset, using a zero-based index), into the byte stream
         * If the length parameter is omitted, the default length value 0 is used and the entire buffer starting at offset is written. If the offset parameter is also omitted, the entire buffer is written
         * If the offset or length parameter is out of range, they are clamped to the beginning and end of the bytes array.
         * @param bytes ByteArray Object
         * @param offset A zero-based index specifying the position into the array to begin writing
         * @param length An unsigned integer specifying how far into the buffer to write
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆๅฎๅญ่ๆฐ็ป bytes๏ผ่ตทๅงๅ็งป้ไธบ offset๏ผไป้ถๅผๅง็็ดขๅผ๏ผไธญๅๅซ length ไธชๅญ่็ๅญ่ๅบๅๅๅฅๅญ่ๆต
         * ๅฆๆ็็ฅ length ๅๆฐ๏ผๅไฝฟ็จ้ป่ฎค้ฟๅบฆ 0๏ผ่ฏฅๆนๆณๅฐไป offset ๅผๅงๅๅฅๆดไธช็ผๅฒๅบใๅฆๆ่ฟ็็ฅไบ offset ๅๆฐ๏ผๅๅๅฅๆดไธช็ผๅฒๅบ
         * ๅฆๆ offset ๆ length ่ถๅบ่ๅด๏ผๅฎไปฌๅฐ่ขซ้ๅฎๅฐ bytes ๆฐ็ป็ๅผๅคดๅ็ปๅฐพ
         * @param bytes ByteArray ๅฏน่ฑก
         * @param offset ไป 0 ๅผๅง็็ดขๅผ๏ผ่กจ็คบๅจๆฐ็ปไธญๅผๅงๅๅฅ็ไฝ็ฝฎ
         * @param length ไธไธชๆ็ฌฆๅทๆดๆฐ๏ผ่กจ็คบๅจ็ผๅฒๅบไธญ็ๅๅฅ่ๅด
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeBytes = function (bytes, offset, length) {
            if (offset === void 0) {
                offset = 0;
            }
            if (length === void 0) {
                length = 0;
            }
            var writeLength;
            if (offset < 0) {
                return;
            }
            if (length < 0) {
                return;
            }
            else if (length == 0) {
                writeLength = bytes.length - offset;
            }
            else {
                writeLength = Math.min(bytes.length - offset, length);
            }
            if (writeLength > 0) {
                this.validateBuffer(writeLength);
                this._bytes.set(bytes._bytes.subarray(offset, offset + writeLength), this._position);
                this.position = this._position + writeLength;
            }
        };
        /**
         * Write an IEEE 754 double-precision (64 bit) floating point number into the byte stream
         * @param value Double-precision (64 bit) floating point number
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธช IEEE 754 ๅ็ฒพๅบฆ๏ผ64 ไฝ๏ผๆตฎ็นๆฐ
         * @param value ๅ็ฒพๅบฆ๏ผ64 ไฝ๏ผๆตฎ็นๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeDouble = function (value) {
            this.validateBuffer(8 /* SIZE_OF_FLOAT64 */);
            this.data.setFloat64(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 8 /* SIZE_OF_FLOAT64 */;
        };
        /**
         * Write an IEEE 754 single-precision (32 bit) floating point number into the byte stream
         * @param value Single-precision (32 bit) floating point number
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธช IEEE 754 ๅ็ฒพๅบฆ๏ผ32 ไฝ๏ผๆตฎ็นๆฐ
         * @param value ๅ็ฒพๅบฆ๏ผ32 ไฝ๏ผๆตฎ็นๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeFloat = function (value) {
            this.validateBuffer(4 /* SIZE_OF_FLOAT32 */);
            this.data.setFloat32(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 4 /* SIZE_OF_FLOAT32 */;
        };
        /**
         * Write a 32-bit signed integer into the byte stream
         * @param value An integer to be written into the byte stream
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธชๅธฆ็ฌฆๅท็ 32 ไฝๆดๆฐ
         * @param value ่ฆๅๅฅๅญ่ๆต็ๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeInt = function (value) {
            this.validateBuffer(4 /* SIZE_OF_INT32 */);
            this.data.setInt32(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 4 /* SIZE_OF_INT32 */;
        };
        /**
         * Write a 16-bit integer into the byte stream. The low 16 bits of the parameter are used. The high 16 bits are ignored.
         * @param value A 32-bit integer. Its low 16 bits will be written into the byte stream
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธช 16 ไฝๆดๆฐใไฝฟ็จๅๆฐ็ไฝ 16 ไฝใๅฟฝ็ฅ้ซ 16 ไฝ
         * @param value 32 ไฝๆดๆฐ๏ผ่ฏฅๆดๆฐ็ไฝ 16 ไฝๅฐ่ขซๅๅฅๅญ่ๆต
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeShort = function (value) {
            this.validateBuffer(2 /* SIZE_OF_INT16 */);
            this.data.setInt16(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 2 /* SIZE_OF_INT16 */;
        };
        /**
         * Write a 32-bit unsigned integer into the byte stream
         * @param value An unsigned integer to be written into the byte stream
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธชๆ็ฌฆๅท็ 32 ไฝๆดๆฐ
         * @param value ่ฆๅๅฅๅญ่ๆต็ๆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeUnsignedInt = function (value) {
            this.validateBuffer(4 /* SIZE_OF_UINT32 */);
            this.data.setUint32(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 4 /* SIZE_OF_UINT32 */;
        };
        /**
         * Write a 16-bit unsigned integer into the byte stream
         * @param value An unsigned integer to be written into the byte stream
         * @version Egret 2.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅญ่ๆตไธญๅๅฅไธไธชๆ็ฌฆๅท็ 16 ไฝๆดๆฐ
         * @param value ่ฆๅๅฅๅญ่ๆต็ๆ็ฌฆๅทๆดๆฐ
         * @version Egret 2.5
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeUnsignedShort = function (value) {
            this.validateBuffer(2 /* SIZE_OF_UINT16 */);
            this.data.setUint16(this._position, value, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 2 /* SIZE_OF_UINT16 */;
        };
        /**
         * Write a UTF-8 string into the byte stream. The length of the UTF-8 string in bytes is written first, as a 16-bit integer, followed by the bytes representing the characters of the string
         * @param value Character string value to be written
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ UTF-8 ๅญ็ฌฆไธฒๅๅฅๅญ่ๆตใๅๅๅฅไปฅๅญ่่กจ็คบ็ UTF-8 ๅญ็ฌฆไธฒ้ฟๅบฆ๏ผไฝไธบ 16 ไฝๆดๆฐ๏ผ๏ผ็ถๅๅๅฅ่กจ็คบๅญ็ฌฆไธฒๅญ็ฌฆ็ๅญ่
         * @param value ่ฆๅๅฅ็ๅญ็ฌฆไธฒๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeUTF = function (value) {
            var utf8bytes = this.encodeUTF8(value);
            var length = utf8bytes.length;
            this.validateBuffer(2 /* SIZE_OF_UINT16 */ + length);
            this.data.setUint16(this._position, length, this.$endian == 0 /* LITTLE_ENDIAN */);
            this.position += 2 /* SIZE_OF_UINT16 */;
            this._writeUint8Array(utf8bytes, false);
        };
        /**
         * Write a UTF-8 string into the byte stream. Similar to the writeUTF() method, but the writeUTFBytes() method does not prefix the string with a 16-bit length word
         * @param value Character string value to be written
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ UTF-8 ๅญ็ฌฆไธฒๅๅฅๅญ่ๆตใ็ฑปไผผไบ writeUTF() ๆนๆณ๏ผไฝ writeUTFBytes() ไธไฝฟ็จ 16 ไฝ้ฟๅบฆ็่ฏไธบๅญ็ฌฆไธฒๆทปๅๅ็ผ
         * @param value ่ฆๅๅฅ็ๅญ็ฌฆไธฒๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ByteArray.prototype.writeUTFBytes = function (value) {
            this._writeUint8Array(this.encodeUTF8(value));
        };
        /**
         *
         * @returns
         * @version Egret 2.4
         * @platform Web,Native
         */
        ByteArray.prototype.toString = function () {
            return "[ByteArray] length:" + this.length + ", bytesAvailable:" + this.bytesAvailable;
        };
        /**
         * @private
         * ๅฐ Uint8Array ๅๅฅๅญ่ๆต
         * @param bytes ่ฆๅๅฅ็Uint8Array
         * @param validateBuffer
         */
        ByteArray.prototype._writeUint8Array = function (bytes, validateBuffer) {
            if (validateBuffer === void 0) {
                validateBuffer = true;
            }
            var pos = this._position;
            var npos = pos + bytes.length;
            if (validateBuffer) {
                this.validateBuffer(npos);
            }
            this.bytes.set(bytes, pos);
            this.position = npos;
        };
        /**
         * @param len
         * @returns
         * @version Egret 2.4
         * @platform Web,Native
         * @private
         */
        ByteArray.prototype.validate = function (len) {
            var bl = this._bytes.length;
            if (bl > 0 && this._position + len <= bl) {
                return true;
            }
            else {
                egret.$error(1025);
            }
        };
        /**********************/
        /*  PRIVATE METHODS   */
        /**********************/
        /**
         * @private
         * @param len
         * @param needReplace
         */
        ByteArray.prototype.validateBuffer = function (len) {
            this.write_position = len > this.write_position ? len : this.write_position;
            len += this._position;
            this._validateBuffer(len);
        };
        /**
         * @private
         * UTF-8 Encoding/Decoding
         */
        ByteArray.prototype.encodeUTF8 = function (str) {
            var pos = 0;
            var codePoints = this.stringToCodePoints(str);
            var outputBytes = [];
            while (codePoints.length > pos) {
                var code_point = codePoints[pos++];
                if (this.inRange(code_point, 0xD800, 0xDFFF)) {
                    this.encoderError(code_point);
                }
                else if (this.inRange(code_point, 0x0000, 0x007f)) {
                    outputBytes.push(code_point);
                }
                else {
                    var count = void 0, offset = void 0;
                    if (this.inRange(code_point, 0x0080, 0x07FF)) {
                        count = 1;
                        offset = 0xC0;
                    }
                    else if (this.inRange(code_point, 0x0800, 0xFFFF)) {
                        count = 2;
                        offset = 0xE0;
                    }
                    else if (this.inRange(code_point, 0x10000, 0x10FFFF)) {
                        count = 3;
                        offset = 0xF0;
                    }
                    outputBytes.push(this.div(code_point, Math.pow(64, count)) + offset);
                    while (count > 0) {
                        var temp = this.div(code_point, Math.pow(64, count - 1));
                        outputBytes.push(0x80 + (temp % 64));
                        count -= 1;
                    }
                }
            }
            return new Uint8Array(outputBytes);
        };
        /**
         * @private
         *
         * @param data
         * @returns
         */
        ByteArray.prototype.decodeUTF8 = function (data) {
            var fatal = false;
            var pos = 0;
            var result = "";
            var code_point;
            var utf8_code_point = 0;
            var utf8_bytes_needed = 0;
            var utf8_bytes_seen = 0;
            var utf8_lower_boundary = 0;
            while (data.length > pos) {
                var _byte = data[pos++];
                if (_byte == this.EOF_byte) {
                    if (utf8_bytes_needed != 0) {
                        code_point = this.decoderError(fatal);
                    }
                    else {
                        code_point = this.EOF_code_point;
                    }
                }
                else {
                    if (utf8_bytes_needed == 0) {
                        if (this.inRange(_byte, 0x00, 0x7F)) {
                            code_point = _byte;
                        }
                        else {
                            if (this.inRange(_byte, 0xC2, 0xDF)) {
                                utf8_bytes_needed = 1;
                                utf8_lower_boundary = 0x80;
                                utf8_code_point = _byte - 0xC0;
                            }
                            else if (this.inRange(_byte, 0xE0, 0xEF)) {
                                utf8_bytes_needed = 2;
                                utf8_lower_boundary = 0x800;
                                utf8_code_point = _byte - 0xE0;
                            }
                            else if (this.inRange(_byte, 0xF0, 0xF4)) {
                                utf8_bytes_needed = 3;
                                utf8_lower_boundary = 0x10000;
                                utf8_code_point = _byte - 0xF0;
                            }
                            else {
                                this.decoderError(fatal);
                            }
                            utf8_code_point = utf8_code_point * Math.pow(64, utf8_bytes_needed);
                            code_point = null;
                        }
                    }
                    else if (!this.inRange(_byte, 0x80, 0xBF)) {
                        utf8_code_point = 0;
                        utf8_bytes_needed = 0;
                        utf8_bytes_seen = 0;
                        utf8_lower_boundary = 0;
                        pos--;
                        code_point = this.decoderError(fatal, _byte);
                    }
                    else {
                        utf8_bytes_seen += 1;
                        utf8_code_point = utf8_code_point + (_byte - 0x80) * Math.pow(64, utf8_bytes_needed - utf8_bytes_seen);
                        if (utf8_bytes_seen !== utf8_bytes_needed) {
                            code_point = null;
                        }
                        else {
                            var cp = utf8_code_point;
                            var lower_boundary = utf8_lower_boundary;
                            utf8_code_point = 0;
                            utf8_bytes_needed = 0;
                            utf8_bytes_seen = 0;
                            utf8_lower_boundary = 0;
                            if (this.inRange(cp, lower_boundary, 0x10FFFF) && !this.inRange(cp, 0xD800, 0xDFFF)) {
                                code_point = cp;
                            }
                            else {
                                code_point = this.decoderError(fatal, _byte);
                            }
                        }
                    }
                }
                //Decode string
                if (code_point !== null && code_point !== this.EOF_code_point) {
                    if (code_point <= 0xFFFF) {
                        if (code_point > 0)
                            result += String.fromCharCode(code_point);
                    }
                    else {
                        code_point -= 0x10000;
                        result += String.fromCharCode(0xD800 + ((code_point >> 10) & 0x3ff));
                        result += String.fromCharCode(0xDC00 + (code_point & 0x3ff));
                    }
                }
            }
            return result;
        };
        /**
         * @private
         *
         * @param code_point
         */
        ByteArray.prototype.encoderError = function (code_point) {
            egret.$error(1026, code_point);
        };
        /**
         * @private
         *
         * @param fatal
         * @param opt_code_point
         * @returns
         */
        ByteArray.prototype.decoderError = function (fatal, opt_code_point) {
            if (fatal) {
                egret.$error(1027);
            }
            return opt_code_point || 0xFFFD;
        };
        /**
         * @private
         *
         * @param a
         * @param min
         * @param max
         */
        ByteArray.prototype.inRange = function (a, min, max) {
            return min <= a && a <= max;
        };
        /**
         * @private
         *
         * @param n
         * @param d
         */
        ByteArray.prototype.div = function (n, d) {
            return Math.floor(n / d);
        };
        /**
         * @private
         *
         * @param string
         */
        ByteArray.prototype.stringToCodePoints = function (string) {
            /** @type {Array.<number>} */
            var cps = [];
            // Based on http://www.w3.org/TR/WebIDL/#idl-DOMString
            var i = 0, n = string.length;
            while (i < string.length) {
                var c = string.charCodeAt(i);
                if (!this.inRange(c, 0xD800, 0xDFFF)) {
                    cps.push(c);
                }
                else if (this.inRange(c, 0xDC00, 0xDFFF)) {
                    cps.push(0xFFFD);
                }
                else {
                    if (i == n - 1) {
                        cps.push(0xFFFD);
                    }
                    else {
                        var d = string.charCodeAt(i + 1);
                        if (this.inRange(d, 0xDC00, 0xDFFF)) {
                            var a = c & 0x3FF;
                            var b = d & 0x3FF;
                            i += 1;
                            cps.push(0x10000 + (a << 10) + b);
                        }
                        else {
                            cps.push(0xFFFD);
                        }
                    }
                }
                i += 1;
            }
            return cps;
        };
        return ByteArray;
    }());
    egret.ByteArray = ByteArray;
    __reflect(ByteArray.prototype, "egret.ByteArray");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    //ๆททๅๆจกๅผๅจWeb็ซฏๅชๆ้จๅ่ขซๆฏๆ๏ผๅจ Native ไธญๅจ้จ้ฝๆฏๆใ
    //็ฎๅๆๆๅนณๅฐ็ๆต่งๅจ้ฝๆฏๆ็ๆ๏ผLayer,Alpha,Normal,Add,ERASEใ
    //IOSไธญ็ๆๆๆต่งๅจไปฅๅAndroidๅ็้จๅๆต่งๅจ่ฟๆฏๆ๏ผMultiply,Screen,Lighten,Darken,Difference,Overlay,HardLightใ
    //ไปๅจ Native ็ซฏๆฏๆ็ๆ๏ผSubtract,Invertใ
    /**
     * A class that provides constant values for visual blend mode effects. These constants are used in the blendMode
     * property of the DisplayObject class.
     * @see egret.DisplayObject#blendMode
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/BlendMode.ts
     * @see http://edn.egret.com/cn/docs/page/108 ๆพ็คบๅฎนๅจ็ๆฆๅฟตไธๅฎ็ฐ
     * @language en_US
     */
    /**
     * ๆไพๆททๅๆจกๅผๅฏ่งๆๆ็ๅธธ้ๅผ็็ฑป,้ๅธธ็จไบ DisplayObject ็ blendMode ๅฑๆงไธใ
     * @see egret.DisplayObject#blendMode
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/BlendMode.ts
     * @see http://edn.egret.com/cn/docs/page/108 ๆพ็คบๅฎนๅจ็ๆฆๅฟตไธๅฎ็ฐ
     * @language zh_CN
     */
    var BlendMode = (function () {
        function BlendMode() {
        }
        /**
         * The display object appears in front of the background. Pixel values of the display object override the pixel
         * values of the background. Where the display object is transparent, the background is visible.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฏฅๆพ็คบๅฏน่ฑกๅบ็ฐๅจ่ๆฏๅ้ขใๆพ็คบๅฏน่ฑก็ๅ็ดๅผไผ่ฆ็่ๆฏ็ๅ็ดๅผใๅจๆพ็คบๅฏน่ฑกไธบ้ๆ็ๅบๅ๏ผ่ๆฏๆฏๅฏ่ง็ใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        BlendMode.NORMAL = "normal";
        /**
         * Adds the values of the constituent colors of the display object to the colors of its background, applying a
         * ceiling of 0xFF. This setting is commonly used for animating a lightening dissolve between two objects.<br/>
         * For example, if the display object has a pixel with an RGB value of 0xAAA633, and the background pixel has an
         * RGB value of 0xDD2200, the resulting RGB value for the displayed pixel is 0xFFC833 (because 0xAA + 0xDD > 0xFF,
         * 0xA6 + 0x22 = 0xC8, and 0x33 + 0x00 = 0x33).
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆพ็คบๅฏน่ฑก็ๅ่ฒๅผๆทปๅๅฐๅฎ็่ๆฏ้ข่ฒไธญ๏ผไธ้ๅผไธบ 0xFFใๆญค่ฎพ็ฝฎ้ๅธธ็จไบไฝฟไธคไธชๅฏน่ฑก้ด็ๅไบฎๆบถ่งฃไบง็ๅจ็ปๆๆใ<br/>
         * ไพๅฆ๏ผๅฆๆๆพ็คบๅฏน่ฑก็ๆไธชๅ็ด็ RGB ๅผไธบ 0xAAA633๏ผ่ๆฏๅ็ด็ RGB ๅผไธบ 0xDD2200๏ผๅๆพ็คบๅ็ด็็ปๆ RGB ๅผไธบ 0xFFC833
         * ๏ผๅไธบ 0xAA + 0xDD > 0xFF๏ผ0xA6 + 0x22 = 0xC8๏ผไธ 0x33 + 0x00 = 0x33๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        BlendMode.ADD = "add";
        /**
         * Erases the background based on the alpha value of the display object.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆนๆฎๆพ็คบๅฏน่ฑก็ Alpha ๅผๆฆ้ค่ๆฏใAlpha ๅผไธไธบ0็ๅบๅๅฐ่ขซๆฆ้คใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        BlendMode.ERASE = "erase";
        return BlendMode;
    }());
    egret.BlendMode = BlendMode;
    __reflect(BlendMode.prototype, "egret.BlendMode");
})(egret || (egret = {}));
(function (egret) {
    var sys;
    (function (sys) {
        var blendModeString = ["normal", "add", "erase"];
        var blendModeNumber = {};
        var length = blendModeString.length;
        for (var i = 0; i < length; i++) {
            var str = blendModeString[i];
            blendModeNumber[str] = i;
        }
        /**
         * @private
         * ่ฝฌๆข blendMode ๅญ็ฌฆไธฒไธบๆฐๅญใ
         */
        function blendModeToNumber(blendMode) {
            var num = blendModeNumber[blendMode];
            return num === undefined ? 0 : num;
        }
        sys.blendModeToNumber = blendModeToNumber;
        /**
         * @private
         * ่ฝฌๆขๆฐๅญไธบ blendMode ๅญ็ฌฆไธฒใ
         */
        function numberToBlendMode(blendMode) {
            var str = blendModeString[blendMode];
            return str === undefined ? "normal" : str;
        }
        sys.numberToBlendMode = numberToBlendMode;
    })(sys = egret.sys || (egret.sys = {}));
})(egret || (egret = {}));
var egret;
(function (egret) {
    /**
     * @private
     */
    egret.fontMapping = {};
    /**
     * ๅผๅฎนๆง็ๆฌไธไฝฟ็จ fontMapping ็ๆๅต
     * @private
     */
    egret.useFontMapping = false;
    /**
     * Register font mapping.
     * @param fontFamily The font family name to register.
     * @param value The font value.
     * @version Egret 3.2.3
     * @platform Native
     * @language en_US
     */
    /**
     * ๆณจๅๅญไฝๆๅฐ
     * @param fontFamily ่ฆๆณจๅ็ๅญไฝๅ็งฐ
     * @param value ๆณจๅ็ๅญไฝๅผ
     * @version Egret 3.2.3
     * @platform Native
     * @language zh_CN
     */
    function registerFontMapping(fontFamily, value) {
        egret.useFontMapping = true;
        egret.fontMapping[fontFamily] = value;
    }
    egret.registerFontMapping = registerFontMapping;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Registers the runtime class information for a class.This method adds some strings which represent the class name or
     * some interface names to the class definition. After the registration,you can use egret.is() method to do the type checking
     * for the instance of this class.<br/>
     * Note:If you use the TypeScript programming language, the egret command line tool will automatically generate the registration code line.
     * You don't need to manually call this method.
     *
     * @example the following code shows how to register the runtime class information for the EventDispatcher class and do the type checking:
     * <pre>
     *      egret.registerClass(egret.EventDispatcher,"egret.EventDispatcher",["egret.IEventDispatcher"]);
     *      let dispatcher = new egret.EventDispatcher();
     *      egret.log(egret.is(dispatcher, "egret.IEventDispatcher"));  //trueใ
     *      egret.log(egret.is(dispatcher, "egret.EventDispatcher"));   //trueใ
     *      egret.log(egret.is(dispatcher, "egret.Bitmap"));   //falseใ
     * </pre>
     * @param classDefinition the class definition to be registered.
     * @param className  a unique identification string of the specific class
     * @param interfaceNames a list of unique identification string of the specific interfaces.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ไธบไธไธช็ฑปๅฎไนๆณจๅ่ฟ่กๆถ็ฑปไฟกๆฏ,็จๆญคๆนๆณๅพ็ฑปๅฎไนไธๆณจๅๅฎ่ช่บซไปฅๅๆๆๆฅๅฃๅฏนๅบ็ๅญ็ฌฆไธฒใ
     * ๅจ่ฟ่กๆถ๏ผ่ฟไธช็ฑป็ๅฎไพๅฐๅฏไปฅไฝฟ็จ egret.is() ๆนๆณไผๅฅไธไธชๅญ็ฌฆไธฒๆฅๅคๆญๅฎไพ็ฑปๅใ
     * @example ไปฅไธไปฃ็ๆผ็คบไบๅฆไฝไธบEventDispatcher็ฑปๆณจๅ่ฟ่กๆถ็ฑปไฟกๆฏๅนถๅคๆญ็ฑปๅ๏ผ
     * <pre>
     *      //ไธบegret.EventDispatcher็ฑปๆณจๅ่ฟ่กๆถ็ฑปไฟกๆฏ๏ผ็ฑไบๅฎๅฎ็ฐไบIEventDispatcherๆฅๅฃ๏ผ่ฟ้ๅบๅๆถไผๅฅๆฅๅฃๅๅฏนๅบ็ๅญ็ฌฆไธฒใ
     *      egret.registerClass(egret.EventDispatcher,"egret.EventDispatcher",["egret.IEventDispatcher"]);
     *      let dispatcher = new egret.EventDispatcher();
     *      egret.log(egret.is(dispatcher, "egret.IEventDispatcher"));  //trueใ
     *      egret.log(egret.is(dispatcher, "egret.EventDispatcher"));   //trueใ
     *      egret.log(egret.is(dispatcher, "egret.Bitmap"));   //falseใ
     * </pre>
     * ๆณจๆ๏ผ่ฅๆจไฝฟ็จ TypeScript ๆฅ็ผๅ็จๅบ๏ผegret ๅฝไปค่กไผ่ชๅจๅธฎๆจ็ๆ็ฑปไฟกๆฏๆณจๅไปฃ็่กๅฐๆ็ป็ Javascript ๆไปถไธญใๅๆญคๆจไธ้่ฆๆๅจ่ฐ็จๆญคๆนๆณใ
     *
     * @param classDefinition ่ฆๆณจๅ็็ฑปๅฎไนใ
     * @param className ่ฆๆณจๅ็็ฑปๅใ
     * @param interfaceNames ่ฆๆณจๅ็็ฑปๆๅฎ็ฐ็ๆฅๅฃๅๅ่กจใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function registerClass(classDefinition, className, interfaceNames) {
        if (true) {
            if (!classDefinition) {
                egret.$error(1003, "classDefinition");
            }
            if (!classDefinition.prototype) {
                egret.$error(1012, "classDefinition");
            }
            if (className === void 0) {
                egret.$error(1003, "className");
            }
        }
        var prototype = classDefinition.prototype;
        prototype.__class__ = className;
        var types = [className];
        if (interfaceNames) {
            types = types.concat(interfaceNames);
        }
        var superTypes = prototype.__types__;
        if (prototype.__types__) {
            var length_11 = superTypes.length;
            for (var i = 0; i < length_11; i++) {
                var name_1 = superTypes[i];
                if (types.indexOf(name_1) == -1) {
                    types.push(name_1);
                }
            }
        }
        prototype.__types__ = types;
    }
    egret.registerClass = registerClass;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Stage class represents the main drawing area.The Stage object is not globally accessible. You need to access
     * it through the stage property of a DisplayObject instance.<br/>
     * The Stage class has several ancestor classes โ Sprite, DisplayObject, and EventDispatcher โ from which it inherits
     * properties and methods. Many of these properties and methods are inapplicable to Stage objects.
     * @event egret.Event.RESIZE Dispatched when the stageWidth or stageHeight property of the Stage object is changed.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Stage.ts
     * @language en_US
     */
    /**
     * Stage ็ฑปไปฃ่กจไธป็ปๅพๅบใ
     * ๅฏไปฅๅฉ็จ DisplayObject ๅฎไพ็ stage ๅฑๆง่ฟ่ก่ฎฟ้ฎใ<br/>
     * Stage ็ฑปๅทๆๅคไธช็ฅไปฃ็ฑป: SpriteใDisplayObject ๅ EventDispatcher๏ผๅฑๆงๅๆนๆณไพฟๆฏไป่ฟไบ็ฑป็ปงๆฟ่ๆฅ็ใ
     * ไป่ฟไบ็ปงๆฟ็่ฎธๅคๅฑๆงๅๆนๆณไธ้็จไบ Stage ๅฏน่ฑกใ
     * @event egret.Event.RESIZE ๅฝstageWidthๆstageHeightๅฑๆงๅ็ๆนๅๆถ่ฐๅบฆ
     * @event egret.Event.DEACTIVATE ๅฝstageๅคฑๅป็ฆ็นๅ่ฐๅบฆ
     * @event egret.Event.ACTIVATE ๅฝstage่ทๅพ็ฆ็นๅ่ฐๅบฆ
     *
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/display/Stage.ts
     * @language zh_CN
     */
    var Stage = (function (_super) {
        __extends(Stage, _super);
        /**
         * @private
         * Stageไธ่ฎธๅ่ฎธ่ช่กๅฎไพๅ
         * @version Egret 2.4
         * @platform Web,Native
         */
        function Stage() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$stageWidth = 0;
            /**
             * @private
             */
            _this.$stageHeight = 0;
            _this.$scaleMode = egret.StageScaleMode.SHOW_ALL;
            _this.$orientation = egret.OrientationMode.AUTO;
            _this.$maxTouches = 99;
            _this.$dirtyRegionPolicy = egret.DirtyRegionPolicy.ON;
            _this.$stage = _this;
            _this.$nestLevel = 1;
            return _this;
        }
        Object.defineProperty(Stage.prototype, "frameRate", {
            /**
             * Gets and sets the frame rate of the stage. The frame rate is defined as frames per second. Valid range for the
             * frame rate is from 0.01 to 1000 frames per second.<br/>
             * Note: setting the frameRate property of one Stage object changes the frame rate for all Stage objects
             * @default 30
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ทๅๅนถ่ฎพ็ฝฎ่ๅฐ็ๅธง้็ใๅธง้็ๆฏๆๆฏ็งๆพ็คบ็ๅธงๆฐใๅธง้็็ๆๆ่ๅดไธบๆฏ็ง 0.01 ๅฐ 60 ไธชๅธงใ<br/>
             * ๆณจๆ: ไฟฎๆนไปปไฝไธไธชStage็frameRateๅฑๆง้ฝไผๅๆญฅไฟฎๆนๅถไปStage็ๅธง็ใ
             * @default 30
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return egret.ticker.$frameRate;
            },
            set: function (value) {
                egret.ticker.$setFrameRate(value);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "stageWidth", {
            /**
             * Indicates the width of the stage, in pixels.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๅฐ็ๅฝๅๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$stageWidth;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "stageHeight", {
            /**
             * Indicates the height of the stage, in pixels.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๅฐ็ๅฝๅ้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$stageHeight;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * After you call the invalidate() method, when the display list is next rendered, the Egret runtime sends a render
         * event to each display object that has registered to listen for the render event. You must call the invalidate()
         * method each time you want the Egret runtime to send render events.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฐ็จ invalidate() ๆนๆณๅ๏ผๅจๆพ็คบๅ่กจไธๆฌกๅ็ฐๆถ๏ผEgret ไผๅๆฏไธชๅทฒๆณจๅไพฆๅฌ Event.RENDER ไบไปถ็ๆพ็คบๅฏน่ฑกๅ้ไธไธช Event.RENDER ไบไปถใ
         * ๆฏๆฌกๆจๅธๆ Egret ๅ้ Event.RENDER ไบไปถๆถ๏ผ้ฝๅฟ้กป่ฐ็จ invalidate() ๆนๆณใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Stage.prototype.invalidate = function () {
            egret.sys.$invalidateRenderFlag = true;
        };
        /**
         * @deprecated
         */
        Stage.prototype.registerImplementation = function (interfaceName, instance) {
            egret.registerImplementation(interfaceName, instance);
        };
        /**
         * @deprecated
         */
        Stage.prototype.getImplementation = function (interfaceName) {
            return egret.getImplementation(interfaceName);
        };
        Object.defineProperty(Stage.prototype, "scaleMode", {
            /**
             * A StageScaleMode class that specifies which scale mode to use. The following are valid values:<br/>
             * <ul>
             * <li>StageScaleMode.EXACT_FIT -- The entire application be visible in the specified area without trying to preserve the original aspect ratio. Distortion can occur, the application may be stretched or compressed.</li>
             * <li>StageScaleMode.SHOW_ALL -- The entire application is visible in the specified area without distortion while maintaining the application of the original aspect ratio. Applications may display border.</li>
             * <li>StageScaleMode.NO_SCALE -- The size of the entire application is fixed, so that even if the size of the player window changes, it remains unchanged. If the player window is smaller than the content, it may do some trimming.</li>
             * <li>StageScaleMode.NO_BORDER -- Keep the original aspect ratio scaling application content, after scaling a narrow direction of application content to fill the viewport players on both sides in the other direction may exceed the viewport and the player is cut.</li>
             * <li>StageScaleMode.FIXED_WIDTH -- Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player, but only to keep the contents of the original application constant width, height may change.</li>
             * <li>StageScaleMode.FIXED_HEIGHT -- Keep the original aspect ratio scaling application content, after scaling application content in the horizontal and vertical directions to fill the viewport player, but only to keep the contents of the original application constant height, width may change.</li>
             * </ul>
             * @default egret.StageScaleMode.SHOW_ALL
             * @language en_US
             */
            /**
             * ไธไธช StageScaleMode ็ฑปไธญๆๅฎ่ฆไฝฟ็จๅช็ง็ผฉๆพๆจกๅผ็ๅผใไปฅไธๆฏๆๆๅผ๏ผ<br/>
             * <ul>
             * <li>StageScaleMode.EXACT_FIT -- ๆดไธชๅบ็จ็จๅบๅจๆๅฎๅบๅไธญๅฏ่ง๏ผไฝไธๅฐ่ฏไฟๆๅๅง้ซๅฎฝๆฏใๅฏ่ฝไผๅ็ๆญๆฒ๏ผๅบ็จ็จๅบๅฏ่ฝไผๆไผธๆๅ็ผฉๆพ็คบใ</li>
             * <li>StageScaleMode.SHOW_ALL -- ๆดไธชๅบ็จ็จๅบๅจๆๅฎๅบๅไธญๅฏ่ง๏ผไธไธๅ็ๆญๆฒ๏ผๅๆถไฟๆๅบ็จ็จๅบ็ๅๅง้ซๅฎฝๆฏใๅบ็จ็จๅบ็ๅฏ่ฝไผๆพ็คบ่พนๆกใ</li>
             * <li>StageScaleMode.NO_SCALE -- ๆดไธชๅบ็จ็จๅบ็ๅคงๅฐๅบๅฎ๏ผๅๆญค๏ผๅณไฝฟๆญๆพๅจ็ชๅฃ็ๅคงๅฐๆดๆน๏ผๅฎไนไผไฟๆไธๅใๅฆๆๆญๆพๅจ็ชๅฃๆฏๅๅฎนๅฐ๏ผๅๅฏ่ฝ่ฟ่กไธไบ่ฃๅใ</li>
             * <li>StageScaleMode.NO_BORDER -- ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎน็่พ็ชๆนๅๅกซๆปกๆญๆพๅจ่งๅฃ๏ผๅฆไธไธชๆนๅ็ไธคไพงๅฏ่ฝไผ่ถๅบๆญๆพๅจ่งๅฃ่่ขซ่ฃๅใ</li>
             * <li>StageScaleMode.FIXED_WIDTH -- ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผไฝๅชไฟๆๅบ็จ็จๅบๅๅฎน็ๅๅงๅฎฝๅบฆไธๅ๏ผ้ซๅบฆๅฏ่ฝไผๆนๅใ</li>
             * <li>StageScaleMode.FIXED_HEIGHT -- ไฟๆๅๅงๅฎฝ้ซๆฏ็ผฉๆพๅบ็จ็จๅบๅๅฎน๏ผ็ผฉๆพๅๅบ็จ็จๅบๅๅฎนๅจๆฐดๅนณๅๅ็ดๆนๅ้ฝๅกซๆปกๆญๆพๅจ่งๅฃ๏ผไฝๅชไฟๆๅบ็จ็จๅบๅๅฎน็ๅๅง้ซๅบฆไธๅ๏ผๅฎฝๅบฆๅฏ่ฝไผๆนๅใ</li>
             * </ul>
             * @default egret.StageScaleMode.SHOW_ALL
             * @language zh_CN
             */
            get: function () {
                return this.$scaleMode;
            },
            set: function (value) {
                if (this.$scaleMode == value) {
                    return;
                }
                this.$scaleMode = value;
                this.$screen.updateScreenSize();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "orientation", {
            /**
             * Horizontal and vertical screen display screen, can only be set under the current Native in the configuration file. A egret.OrientationMode class that specifies which display mode to use. The following are valid values:<br/>
             * <ul>
             * <li>egret.OrientationMode.AUTO -- Always follow the direction of application display screen, always guaranteed by the look down.</li>
             * <li>egret.OrientationMode.PORTRAIT -- Applications remain portrait mode, namely horizontal screen look, the screen from left to right.</li>
             * <li>egret.OrientationMode.LANDSCAPE -- Applications remain horizontal screen mode, namely vertical screen, the screen from right to left.</li>
             * <li>egret.OrientationMode.LANDSCAPE_FLIPPED -- Applications remain horizontal screen mode, namely vertical screen, the screen from left to right.</li>
             * </ul>
             * @platform Web
             * @version 2.4
             * @language en_US
             */
            /**
             * ๅฑๅนๆจช็ซๅฑๆพ็คบๆนๅผ๏ผ็ฎๅ Native ไธๅช่ฝๅจ้็ฝฎๆไปถ้่ฎพ็ฝฎใไธไธช egret.OrientationMode ็ฑปไธญๆๅฎ่ฆไฝฟ็จๅช็งๆพ็คบๆนๅผใไปฅไธๆฏๆๆๅผ๏ผ<br/>
             * <ul>
             * <li>egret.OrientationMode.AUTO -- ๅบ็จๅง็ป่ท้ๅฑๅน็ๆนๅๆพ็คบ๏ผๅง็ปไฟ่ฏ็ฑไธๅพไธ็ใ</li>
             * <li>egret.OrientationMode.PORTRAIT -- ๅบ็จๅง็ปไฟๆ็ซๅฑๆจกๅผ๏ผๅณๆจชๅฑ็ๆถ๏ผๅฑๅน็ฑๅทฆๅพๅณ็ใ</li>
             * <li>egret.OrientationMode.LANDSCAPE -- ๅบ็จๅง็ปไฟๆๆจชๅฑๆจกๅผ๏ผๅณ็ซๅฑ็ๆถ๏ผๅฑๅนๆพ็คบ็ฑๅณๅพๅทฆใ</li>
             * <li>egret.OrientationMode.LANDSCAPE_FLIPPED -- ๅบ็จๅง็ปไฟๆๆจชๅฑๆจกๅผ๏ผๅณ็ซๅฑ็ๆถ๏ผๅฑๅนๆพ็คบ็ฑๅทฆๅพๅณใ</li>
             * </ul>
             * @platform Web
             * @version 2.4
             * @language zh_CN
             */
            get: function () {
                return this.$orientation;
            },
            set: function (value) {
                if (this.$orientation == value) {
                    return;
                }
                this.$orientation = value;
                this.$screen.updateScreenSize();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "textureScaleFactor", {
            /**
             * Draw texture zoom ratio
             * @default 1
             * @language en_US
             */
            /**
             * ็ปๅถ็บน็็็ผฉๆพๆฏ็๏ผ้ป่ฎคๅผไธบ1
             * @default 1
             * @language zh_CN
             */
            get: function () {
                return egret.$TextureScaleFactor;
            },
            set: function (value) {
                egret.$TextureScaleFactor = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "maxTouches", {
            /**
             * Set the number of screens can simultaneously touch. Above this amount will not be triggered in response.
             * @default 99
             * @language en_US
             */
            /**
             * ่ฎพ็ฝฎๅฑๅนๅๆถๅฏไปฅ่งฆๆธ็ๆฐ้ใ้ซไบ่ฟไธชๆฐ้ๅฐไธไผ่ขซ่งฆๅๅๅบใ
             * @default 99
             * @language zh_CN
             */
            get: function () {
                return this.$maxTouches;
            },
            set: function (value) {
                if (this.$maxTouches == value) {
                    return;
                }
                this.$maxTouches = value;
                this.$screen.updateMaxTouches();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Stage.prototype, "dirtyRegionPolicy", {
            get: function () {
                return this.$dirtyRegionPolicy;
            },
            /**
             * Set dirty region policy
             * One of the constants defined by egret.DirtyRegionPolicy
             * @version Egret 2.5.5
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฎพ็ฝฎ่็ฉๅฝข็ญ็ฅ
             * egret.DirtyRegionPolicy ๅฎไน็ๅธธ้ไนไธ
             * @version Egret 2.5.5
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (policy) {
                if (this.$dirtyRegionPolicy != policy) {
                    this.$dirtyRegionPolicy = policy;
                    this.$displayList.setDirtyRegionPolicy(policy);
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Set resolution size
         * @param width width
         * @param height height
         * @version Egret 2.5.5
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎๅ่พจ็ๅฐบๅฏธ
         * @param width ๅฎฝๅบฆ
         * @param height ้ซๅบฆ
         * @version Egret 2.5.5
         * @platform Web,Native
         * @language zh_CN
         */
        Stage.prototype.setContentSize = function (width, height) {
            this.$screen.setContentSize(width, height);
        };
        return Stage;
    }(egret.DisplayObjectContainer));
    egret.Stage = Stage;
    __reflect(Stage.prototype, "egret.Stage");
    if (true) {
        egret.$markCannotUse(Stage, "alpha", 1);
        egret.$markCannotUse(Stage, "visible", true);
        egret.$markCannotUse(Stage, "x", 0);
        egret.$markCannotUse(Stage, "y", 0);
        egret.$markCannotUse(Stage, "scaleX", 1);
        egret.$markCannotUse(Stage, "scaleY", 1);
        egret.$markCannotUse(Stage, "rotation", 0);
        egret.$markCannotUse(Stage, "cacheAsBitmap", false);
        egret.$markCannotUse(Stage, "scrollRect", null);
        egret.$markCannotUse(Stage, "filters", null);
        egret.$markCannotUse(Stage, "blendMode", null);
        egret.$markCannotUse(Stage, "touchEnabled", true);
        egret.$markCannotUse(Stage, "matrix", null);
    }
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Logger is an entrance for the log processing namespace of the engine
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Loggerๆฏๅผๆ็ๆฅๅฟๅค็ๆจกๅๅฅๅฃ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var Logger = (function () {
        function Logger() {
        }
        Object.defineProperty(Logger, "logLevel", {
            /**
             * Set the current need to open the log level. Grade level are: ALL <DEBUG <INFO <WARN <ERROR <OFF<br/>
             * This feature is only in DEBUG mode to take effect. <br/>
             * <Ul>
             * <Li> Logger.ALL - all levels of log can be printed out. </ li>
             * <Li> Logger.DEBUG - print debug, info, log, warn, error. </ li>
             * <Li> Logger.INFO - print info, log, warn, error. </ li>
             * <Li> Logger.WARN - can print warn, error. </ li>
             * <Li> Logger.ERROR - You can print error. </ li>
             * <Li> Logger.OFF - all closed. </ li>
             * </ Ul>
             *param LogType from this level to start printing.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฎพ็ฝฎๅฝๅ้่ฆๅผๅฏ็log็บงๅซใ็บงๅซ็ญ็บงๅๅซไธบ๏ผALL < DEBUG < INFO < WARN < ERROR < OFF<br/>
             * ๆญคๅ่ฝๅชๅจ DEBUG ๆจกๅผไธๆ็ๆใ<br/>
             * <ul>
             * <li>Logger.ALL -- ๆๆ็ญ็บง็log้ฝๅฏไปฅๆๅฐๅบๆฅใ</li>
             * <li>Logger.DEBUG -- ๅฏไปฅๆๅฐdebugใinfoใlogใwarnใerrorใ</li>
             * <li>Logger.INFO -- ๅฏไปฅๆๅฐinfoใlogใwarnใerrorใ</li>
             * <li>Logger.WARN -- ๅฏไปฅๆๅฐwarnใerrorใ</li>
             * <li>Logger.ERROR -- ๅฏไปฅๆๅฐerrorใ</li>
             * <li>Logger.OFF -- ๅจ้จๅณ้ญใ</li>
             * </ul>
             * @param logType ไป่ฟไธช็ญ็บงๅผๅงๆๅฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (logType) {
            },
            enumerable: true,
            configurable: true
        });
        /**
         * open all
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.ALL = "all";
        /**
         * level: DEBUG
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ญ็บงไธบ DEBUG
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.DEBUG = "debug";
        /**
         * level: INFO
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ญ็บงไธบ INFO
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.INFO = "info";
        /**
         * level: WARN
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ญ็บงไธบ WARN
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.WARN = "warn";
        /**
         * level: ERROR
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ญ็บงไธบ ERROR
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.ERROR = "error";
        /**
         * close all
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅณ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Logger.OFF = "off";
        return Logger;
    }());
    egret.Logger = Logger;
    __reflect(Logger.prototype, "egret.Logger");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @version Egret 2.4
     * @platform Web,Native
     */
    var NumberUtils = (function () {
        function NumberUtils() {
        }
        /**
         * Judge whether it is a numerical value
         * @param value Parameter that needs to be judged
         * @returns
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅคๆญๆฏๅฆๆฏๆฐๅผ
         * @param value ้่ฆๅคๆญ็ๅๆฐ
         * @returns
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        NumberUtils.isNumber = function (value) {
            return typeof (value) === "number" && !isNaN(value);
        };
        /**
         * Obtain the approximate sin value of the corresponding angle value
         * @param value {number} Angle value
         * @returns {number} sin value
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅพๅฐๅฏนๅบ่งๅบฆๅผ็sin่ฟไผผๅผ
         * @param value {number} ่งๅบฆๅผ
         * @returns {number} sinๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        NumberUtils.sin = function (value) {
            var valueFloor = Math.floor(value);
            var valueCeil = valueFloor + 1;
            var resultFloor = NumberUtils.sinInt(valueFloor);
            if (valueFloor == value) {
                return resultFloor;
            }
            var resultCeil = NumberUtils.sinInt(valueCeil);
            return (value - valueFloor) * resultCeil + (valueCeil - value) * resultFloor;
        };
        /**
         * @private
         *
         * @param value
         * @returns
         */
        NumberUtils.sinInt = function (value) {
            value = value % 360;
            if (value < 0) {
                value += 360;
            }
            return egret_sin_map[value];
        };
        /**
         * Obtain the approximate cos value of the corresponding angle value
         * @param value {number} Angle value
         * @returns {number} cos value
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅพๅฐๅฏนๅบ่งๅบฆๅผ็cos่ฟไผผๅผ
         * @param value {number} ่งๅบฆๅผ
         * @returns {number} cosๅผ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        NumberUtils.cos = function (value) {
            var valueFloor = Math.floor(value);
            var valueCeil = valueFloor + 1;
            var resultFloor = NumberUtils.cosInt(valueFloor);
            if (valueFloor == value) {
                return resultFloor;
            }
            var resultCeil = NumberUtils.cosInt(valueCeil);
            return (value - valueFloor) * resultCeil + (valueCeil - value) * resultFloor;
        };
        /**
         * @private
         *
         * @param value
         * @returns
         */
        NumberUtils.cosInt = function (value) {
            value = value % 360;
            if (value < 0) {
                value += 360;
            }
            return egret_cos_map[value];
        };
        return NumberUtils;
    }());
    egret.NumberUtils = NumberUtils;
    __reflect(NumberUtils.prototype, "egret.NumberUtils");
})(egret || (egret = {}));
/**
 * @private
 */
var egret_sin_map = {};
/**
 * @private
 */
var egret_cos_map = {};
/**
 * @private
 */
var DEG_TO_RAD = Math.PI / 180;
for (var NumberUtils_i = 0; NumberUtils_i < 360; NumberUtils_i++) {
    egret_sin_map[NumberUtils_i] = Math.sin(NumberUtils_i * DEG_TO_RAD);
    egret_cos_map[NumberUtils_i] = Math.cos(NumberUtils_i * DEG_TO_RAD);
}
egret_sin_map[90] = 1;
egret_cos_map[90] = 0;
egret_sin_map[180] = 0;
egret_cos_map[180] = -1;
egret_sin_map[270] = -1;
egret_cos_map[270] = 0;
//ๅฏนๆชๆไพbind็ๆต่งๅจๅฎ็ฐbindๆบๅถ
if (!Function.prototype.bind) {
    Function.prototype.bind = function (oThis) {
        if (typeof this !== "function") {
            // closest thing possible to the ECMAScript 5 internal IsCallable function
            egret.$error(1029);
        }
        var aArgs = Array.prototype.slice.call(arguments, 1), fToBind = this, fNOP = function () {
        }, fBound = function () {
            return fToBind.apply(this instanceof fNOP && oThis
                ? this
                : oThis, aArgs.concat(Array.prototype.slice.call(arguments)));
        };
        fNOP.prototype = this.prototype;
        fBound.prototype = new fNOP();
        return fBound;
    };
}
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * The Timer class is the interface to timers, which let you run code on a specified time sequence. Use the start()
     * method to start a timer. Add an event listener for the timer event to set up code to be run on the timer interval.<br/>
     * You can create Timer objects to run once or repeat at specified intervals to execute code on a schedule. Depending
     * on the framerate or the runtime environment (available memory and other factors), the runtime may dispatchEvent events at
     * slightly offset intervals.
     * @see egret.TimerEvent
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/Timer.ts
     * @language en_US
     */
    /**
     * Timer ็ฑปๆฏ่ฎกๆถๅจ็ๆฅๅฃ๏ผๅฎไฝฟๆจ่ฝๆๆๅฎ็ๆถ้ดๅบๅ่ฟ่กไปฃ็ใ
     * ไฝฟ็จ start() ๆนๆณๆฅๅฏๅจ่ฎกๆถๅจใไธบ timer ไบไปถๆทปๅไบไปถไพฆๅฌๅจ๏ผไปฅไพฟๅฐไปฃ็่ฎพ็ฝฎไธบๆ่ฎกๆถๅจ้ด้่ฟ่กใ
     * ๅฏไปฅๅๅปบ Timer ๅฏน่ฑกไปฅ่ฟ่กไธๆฌกๆๆๆๅฎ้ด้้ๅค่ฟ่ก๏ผไป่ๆ่ฎกๅๆง่กไปฃ็ใ
     * ๆนๆฎ Egret ็ๅธง้็ๆ่ฟ่กๆถ็ฏๅข๏ผๅฏ็จๅๅญๅๅถไปๅ็ด๏ผ๏ผ่ฟ่กๆถ่ฐๅบฆไบไปถ็้ด้ๅฏ่ฝ็จๆไธๅใ
     * @see egret.TimerEvent
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/Timer.ts
     * @language zh_CN
     */
    var Timer = (function (_super) {
        __extends(Timer, _super);
        /**
         * Constructs a new Timer object with the specified delay and repeatCount states.
         * @param delay The delay between timer events, in milliseconds. A delay lower than 20 milliseconds is not recommended.
         * Timer frequency is limited to 60 frames per second, meaning a delay lower than 16.6 milliseconds causes runtime problems.
         * @param repeatCount Specifies the number of repetitions. If zero, the timer repeats indefinitely.If nonzero,
         * the timer runs the specified number of times and then stops.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็ delay ๅ repeatCount ็ถๆๆ้ๆฐ็ Timer ๅฏน่ฑกใ
         * @param delay ่ฎกๆถๅจไบไปถ้ด็ๅปถ่ฟ๏ผไปฅๆฏซ็งไธบๅไฝ๏ผใๅปบ่ฎฎ delay ไธ่ฆไฝไบ 20 ๆฏซ็งใ่ฎกๆถๅจ้ข็ไธๅพ่ถ่ฟ 60 ๅธง/็ง๏ผ่ฟๆๅณ็ไฝไบ 16.6 ๆฏซ็ง็ๅปถ่ฟๅฏๅฏผ่ดๅบ็ฐ่ฟ่กๆถ้ฎ้ขใ
         * @param repeatCount ๆๅฎ้ๅคๆฌกๆฐใๅฆๆไธบ้ถ๏ผๅ่ฎกๆถๅจๅฐๆ็ปญไธๆญ้ๅค่ฟ่กใๅฆๆไธไธบ 0๏ผๅๅฐ่ฟ่ก่ฎกๆถๅจ๏ผ่ฟ่กๆฌกๆฐไธบๆๅฎ็ๆฌกๆฐ๏ผ็ถๅๅๆญขใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function Timer(delay, repeatCount) {
            if (repeatCount === void 0) {
                repeatCount = 0;
            }
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this._delay = 0;
            /**
             * @private
             */
            _this._currentCount = 0;
            /**
             * @private
             */
            _this._running = false;
            /**
             * @private
             */
            _this.updateInterval = 1000;
            /**
             * @private
             */
            _this.lastCount = 1000;
            /**
             * @private
             */
            _this.lastTimeStamp = 0;
            _this.delay = delay;
            _this.repeatCount = +repeatCount | 0;
            return _this;
        }
        Object.defineProperty(Timer.prototype, "delay", {
            /**
             * The delay between timer events, in milliseconds. A delay lower than 20 milliseconds is not recommended.<br/>
             * Note: Timer frequency is limited to 60 frames per second, meaning a delay lower than 16.6 milliseconds causes runtime problems.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฎกๆถๅจไบไปถ้ด็ๅปถ่ฟ๏ผไปฅๆฏซ็งไธบๅไฝ๏ผใๅฆๆๅจ่ฎกๆถๅจๆญฃๅจ่ฟ่กๆถ่ฎพ็ฝฎๅปถ่ฟ้ด้๏ผๅ่ฎกๆถๅจๅฐๆ็ธๅ็ repeatCount ่ฟญไปฃ้ๆฐๅฏๅจใ<br/>
             * ๆณจๆ๏ผๅปบ่ฎฎ delay ไธ่ฆไฝไบ 20 ๆฏซ็งใ่ฎกๆถๅจ้ข็ไธๅพ่ถ่ฟ 60 ๅธง/็ง๏ผ่ฟๆๅณ็ไฝไบ 16.6 ๆฏซ็ง็ๅปถ่ฟๅฏๅฏผ่ดๅบ็ฐ่ฟ่กๆถ้ฎ้ขใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._delay;
            },
            set: function (value) {
                //value = +value||0;
                if (value < 1) {
                    value = 1;
                }
                if (this._delay == value) {
                    return;
                }
                this._delay = value;
                this.lastCount = this.updateInterval = Math.round(60 * value);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Timer.prototype, "currentCount", {
            /**
             * The total number of times the timer has fired since it started at zero. If the timer has been reset, only the fires since the reset are counted.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฎกๆถๅจไป 0 ๅผๅงๅ่งฆๅ็ๆปๆฌกๆฐใๅฆๆๅทฒ้็ฝฎไบ่ฎกๆถๅจ๏ผๅๅชไผ่ฎกๅฅ้็ฝฎๅ็่งฆๅๆฌกๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._currentCount;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Timer.prototype, "running", {
            /**
             * The timer's current state; true if the timer is running, otherwise false.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฎกๆถๅจ็ๅฝๅ็ถๆ๏ผๅฆๆ่ฎกๆถๅจๆญฃๅจ่ฟ่ก๏ผๅไธบ true๏ผๅฆๅไธบ falseใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._running;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Stops the timer, if it is running, and sets the currentCount property back to 0, like the reset button of a stopwatch.
         * Then, when start() is called, the timer instance runs for the specified number of repetitions, as set by the repeatCount value.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆ่ฎกๆถๅจๆญฃๅจ่ฟ่ก๏ผๅๅๆญข่ฎกๆถๅจ๏ผๅนถๅฐ currentCount ๅฑๆง่ฎพๅไธบ 0๏ผ่ฟ็ฑปไผผไบ็ง่กจ็้็ฝฎๆ้ฎใ็ถๅ๏ผๅจ่ฐ็จ start() ๅ๏ผๅฐ่ฟ่ก่ฎกๆถๅจๅฎไพ๏ผ่ฟ่กๆฌกๆฐไธบๆๅฎ็้ๅคๆฌกๆฐ๏ผ็ฑ repeatCount ๅผ่ฎพ็ฝฎ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Timer.prototype.reset = function () {
            this.stop();
            this._currentCount = 0;
        };
        /**
         * Starts the timer, if it is not already running.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆ่ฎกๆถๅจๅฐๆช่ฟ่ก๏ผๅๅฏๅจ่ฎกๆถๅจใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Timer.prototype.start = function () {
            if (this._running)
                return;
            this.lastCount = this.updateInterval;
            this.lastTimeStamp = egret.getTimer();
            egret.ticker.$startTick(this.$update, this);
            this._running = true;
        };
        /**
         * Stops the timer. When start() is called after stop(), the timer instance runs for the remaining number of
         * repetitions, as set by the repeatCount property.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๆญข่ฎกๆถๅจใๅฆๆๅจ่ฐ็จ stop() ๅ่ฐ็จ start()๏ผๅๅฐ็ปง็ปญ่ฟ่ก่ฎกๆถๅจๅฎไพ๏ผ่ฟ่กๆฌกๆฐไธบๅฉไฝ็ ้ๅคๆฌกๆฐ๏ผ็ฑ repeatCount ๅฑๆง่ฎพ็ฝฎ๏ผใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Timer.prototype.stop = function () {
            if (!this._running)
                return;
            egret.stopTick(this.$update, this);
            this._running = false;
        };
        /**
         * @private
         * Tickerไปฅ60FPS้ข็ๅทๆฐๆญคๆนๆณ
         */
        Timer.prototype.$update = function (timeStamp) {
            var deltaTime = timeStamp - this.lastTimeStamp;
            if (deltaTime >= this._delay) {
                this.lastCount = this.updateInterval;
            }
            else {
                this.lastCount -= 1000;
                if (this.lastCount > 0) {
                    return false;
                }
                this.lastCount += this.updateInterval;
            }
            this.lastTimeStamp = timeStamp;
            this._currentCount++;
            var complete = (this.repeatCount > 0 && this._currentCount >= this.repeatCount);
            egret.TimerEvent.dispatchTimerEvent(this, egret.TimerEvent.TIMER);
            if (complete) {
                this.stop();
                egret.TimerEvent.dispatchTimerEvent(this, egret.TimerEvent.TIMER_COMPLETE);
            }
            return false;
        };
        return Timer;
    }(egret.EventDispatcher));
    egret.Timer = Timer;
    __reflect(Timer.prototype, "egret.Timer");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    egret.$callLaterFunctionList = [];
    /**
     * @private
     */
    egret.$callLaterThisList = [];
    /**
     * @private
     */
    egret.$callLaterArgsList = [];
    /**
     * Delay the function to run unless screen is redrawn.
     * @param method {Function} The function to be delayed to run
     * @param thisObject {any} this reference of callback function
     * @param ...args {any} Function parameter list
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/callLater.ts
     * @language en_US
     */
    /**
     * ๅปถ่ฟๅฝๆฐๅฐๅฑๅน้็ปๅๆง่กใ
     * @param method {Function} ่ฆๅปถ่ฟๆง่ก็ๅฝๆฐ
     * @param thisObject {any} ๅ่ฐๅฝๆฐ็thisๅผ็จ
     * @param ...args {any} ๅฝๆฐๅๆฐๅ่กจ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/callLater.ts
     * @language zh_CN
     */
    function callLater(method, thisObject) {
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        egret.$callLaterFunctionList.push(method);
        egret.$callLaterThisList.push(thisObject);
        egret.$callLaterArgsList.push(args);
    }
    egret.callLater = callLater;
    /**
     * @private
     */
    egret.$callAsyncFunctionList = [];
    /**
     * @private
     */
    egret.$callAsyncThisList = [];
    /**
     * @private
     */
    egret.$callAsyncArgsList = [];
    /**
     * ๅผๆญฅ่ฐ็จๅฝๆฐ
     * @param method {Function} ่ฆๅผๆญฅ่ฐ็จ็ๅฝๆฐ
     * @param thisObject {any} ๅฝๆฐ็thisๅผ็จ
     * @param ...args {any} ๅฝๆฐๅๆฐๅ่กจ
     * @private
     */
    function $callAsync(method, thisObject) {
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        egret.$callAsyncFunctionList.push(method);
        egret.$callAsyncThisList.push(thisObject);
        egret.$callAsyncArgsList.push(args);
    }
    egret.$callAsync = $callAsync;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//function __extends(d, b) {
//    for (let p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
//    function __() {
//        this.constructor = d;
//    }
//
//    __.prototype = b.prototype;
//    d.prototype = new __();
//}
var egret;
(function (egret) {
    /**
     * Call setter properties of the parent class, instead of the other writing languages, such as super.alpha = 1;
     * @param currentClass The current class class name, non-string
     * @param thisObj The current object. Always this
     * @param type Setter property names need to call
     * @param values Value passed to the parent class
     *
     * @exmaple egret.superSetter(egret.Sprite, this, "alpha", 1);
     * @language en_US
     */
    /**
     * ่ฐ็จ็ถ็ฑป็setterๅฑๆง๏ผไปฃๆฟๅถไป่ฏญ่จ็ๅๆณ๏ผๅฆ super.alpha = 1;
     * @param thisObj ๅฝๅๅฏน่ฑกใๆฐธ่ฟ้ฝthis
     * @param currentClass ๅฝๅ class ็ฑปๅ๏ผ้ๅญ็ฌฆไธฒ
     * @param type ้่ฆ่ฐ็จ็setterๅฑๆงๅ็งฐ
     * @param values ไผ็ป็ถ็ฑป็ๅผ
     *
     * @exmaple egret.superSetter(egret.Sprite, this, "alpha", 1);
     * @language zh_CN
     */
    function superSetter(currentClass, thisObj, type) {
        var values = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            values[_i - 3] = arguments[_i];
        }
        var cla = currentClass.prototype;
        var seters;
        if (!currentClass.hasOwnProperty("__sets__")) {
            Object.defineProperty(currentClass, "__sets__", { "value": {} });
        }
        seters = currentClass["__sets__"];
        var setF = seters[type];
        if (setF) {
            return setF.apply(thisObj, values);
        }
        var d = Object.getPrototypeOf(cla);
        if (d == null) {
            return;
        }
        while (!d.hasOwnProperty(type)) {
            d = Object.getPrototypeOf(d);
            if (d == null) {
                return;
            }
        }
        setF = Object.getOwnPropertyDescriptor(d, type).set;
        seters[type] = setF;
        setF.apply(thisObj, values);
    }
    egret.superSetter = superSetter;
    /**
     * Get getter property value of the parent class. Instead of writing in other languages, such as super.alpha;
     * @param currentClass The current class class name, non-string
     * @param thisObj The current object. Always this
     * @param type Setter property names need to call
     * @returns {any} The value returned by the parent
     *
     * @exmaple egret.superGetter(egret.Sprite, this, "alpha");
     * @language en_US
     */
    /**
     * ่ทๅ็ถ็ฑป็getterๅฑๆงๅผใไปฃๆฟๅถไป่ฏญ่จ็ๅๆณ๏ผๅฆ super.alpha;
     * @param thisObj ๅฝๅๅฏน่ฑกใๆฐธ่ฟ้ฝthis
     * @param currentClass ๅฝๅ class ็ฑปๅ๏ผ้ๅญ็ฌฆไธฒ
     * @param type ้่ฆ่ฐ็จ็setterๅฑๆงๅ็งฐ
     * @returns {any} ็ถ็ฑป่ฟๅ็ๅผ
     *
     * @exmaple egret.superGetter(egret.Sprite, this, "alpha");
     * @language zh_CN
     */
    function superGetter(currentClass, thisObj, type) {
        var cla = currentClass.prototype;
        var geters;
        if (!currentClass.hasOwnProperty("__gets__")) {
            Object.defineProperty(currentClass, "__gets__", { "value": {} });
        }
        geters = currentClass["__gets__"];
        var getF = geters[type];
        if (getF) {
            return getF.call(thisObj);
        }
        var d = Object.getPrototypeOf(cla);
        if (d == null) {
            return;
        }
        while (!d.hasOwnProperty(type)) {
            d = Object.getPrototypeOf(d);
            if (d == null) {
                return;
            }
        }
        getF = Object.getOwnPropertyDescriptor(d, type).get;
        geters[type] = getF;
        return getF.call(thisObj);
    }
    egret.superGetter = superGetter;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * @private
     */
    var getDefinitionByNameCache = {};
    /**
     * Returns a reference to the class object of the class specified by the name parameter.
     * @param name The name of a class.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getDefinitionByName.ts
     * @language en_US
     */
    /**
     * ่ฟๅ name ๅๆฐๆๅฎ็็ฑป็็ฑปๅฏน่ฑกๅผ็จใ
     * @param name ็ฑป็ๅ็งฐใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getDefinitionByName.ts
     * @language zh_CN
     */
    function getDefinitionByName(name) {
        if (!name)
            return null;
        var definition = getDefinitionByNameCache[name];
        if (definition) {
            return definition;
        }
        var paths = name.split(".");
        var length = paths.length;
        definition = __global;
        for (var i = 0; i < length; i++) {
            var path = paths[i];
            definition = definition[path];
            if (!definition) {
                return null;
            }
        }
        getDefinitionByNameCache[name] = definition;
        return definition;
    }
    egret.getDefinitionByName = getDefinitionByName;
    if (true) {
        egret["cleanCache"] = function () {
            getDefinitionByNameCache = {};
        };
    }
})(egret || (egret = {}));
var __global = this.__global || this;
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Return the fully qualified class name of an object
     * @param value The object for which a fully qualified class name is desired. Any JavaScript value may be passed to
     * this method including all available JavaScript types, object instances, primitive types such as number, and class objects.
     * @returns A string containing the fully qualified class name.
     * @example
     * <pre>
     *  egret.getQualifiedClassName(egret.DisplayObject) //return "egret.DisplayObject"
     * </pre>
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getQualifiedClassName.ts
     * @language en_US
     */
    /**
     * ่ฟๅๅฏน่ฑก็ๅฎๅจ้ๅฎ็ฑปๅใ
     * @param value ้่ฆๅฎๅจ้ๅฎ็ฑปๅ็งฐ็ๅฏน่ฑก๏ผๅฏไปฅๅฐไปปไฝ JavaScript ๅผไผ้็ปๆญคๆนๆณ๏ผๅๆฌๆๆๅฏ็จ็ JavaScript ็ฑปๅใๅฏน่ฑกๅฎไพใๅๅง็ฑปๅ
     * ๏ผๅฆnumber)ๅ็ฑปๅฏน่ฑก
     * @returns ๅๅซๅฎๅจ้ๅฎ็ฑปๅ็งฐ็ๅญ็ฌฆไธฒใ
     * @example
     * <pre>
     *  egret.getQualifiedClassName(egret.DisplayObject) //่ฟๅ "egret.DisplayObject"
     * </pre>
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getQualifiedClassName.ts
     * @language zh_CN
     */
    function getQualifiedClassName(value) {
        var type = typeof value;
        if (!value || (type != "object" && !value.prototype)) {
            return type;
        }
        var prototype = value.prototype ? value.prototype : Object.getPrototypeOf(value);
        if (prototype.hasOwnProperty("__class__")) {
            return prototype["__class__"];
        }
        var constructorString = prototype.constructor.toString().trim();
        var index = constructorString.indexOf("(");
        var className = constructorString.substring(9, index);
        Object.defineProperty(prototype, "__class__", {
            value: className,
            enumerable: false,
            writable: true
        });
        return className;
    }
    egret.getQualifiedClassName = getQualifiedClassName;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Returns the fully qualified class name of the base class of the object specified by the value parameter.
     * @param value The object for which a parent class is desired. Any JavaScript value may be passed to this method including
     * all available JavaScript types, object instances, primitive types such as number, and class objects.
     * @returns  A fully qualified base class name, or null if none exists.
     * @example
     * <pre>
     *  egret.getQualifiedSuperclassName(egret.Bitmap) //return "egret.DisplayObject"
     * </pre>
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getQualifiedSuperclassName.ts
     * @language en_US
     */
    /**
     * ่ฟๅ value ๅๆฐๆๅฎ็ๅฏน่ฑก็ๅบ็ฑป็ๅฎๅจ้ๅฎ็ฑปๅใ
     * @param value ้่ฆๅๅพ็ถ็ฑป็ๅฏน่ฑก๏ผๅฏไปฅๅฐไปปไฝ JavaScript ๅผไผ้็ปๆญคๆนๆณ๏ผๅๆฌๆๆๅฏ็จ็ JavaScript ็ฑปๅใๅฏน่ฑกๅฎไพใๅๅง็ฑปๅ๏ผๅฆnumber๏ผๅ็ฑปๅฏน่ฑก
     * @returns ๅฎๅจ้ๅฎ็ๅบ็ฑปๅ็งฐ๏ผๆ null๏ผๅฆๆไธๅญๅจๅบ็ฑปๅ็งฐ๏ผใ
     * @example
     * <pre>
     *  egret.getQualifiedSuperclassName(egret.Sprite) //่ฟๅ "egret.DisplayObject"
     * </pre>
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getQualifiedSuperclassName.ts
     * @language zh_CN
     */
    function getQualifiedSuperclassName(value) {
        if (!value || (typeof value != "object" && !value.prototype)) {
            return null;
        }
        var prototype = value.prototype ? value.prototype : Object.getPrototypeOf(value);
        var superProto = Object.getPrototypeOf(prototype);
        if (!superProto) {
            return null;
        }
        var superClass = egret.getQualifiedClassName(superProto.constructor);
        if (!superClass) {
            return null;
        }
        return superClass;
    }
    egret.getQualifiedSuperclassName = getQualifiedSuperclassName;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Used to compute relative time.this method returns the number of milliseconds since the Egret framework was initialized
     * @returns The number of milliseconds since the Egret framework was initialized
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getTimer.ts
     * @language en_US
     */
    /**
     * ็จไบ่ฎก็ฎ็ธๅฏนๆถ้ดใๆญคๆนๆณ่ฟๅ่ชๅฏๅจ Egret ๆกๆถไปฅๆฅ็ป่ฟ็ๆฏซ็งๆฐใ
     * @returns ๅฏๅจ Egret ๆกๆถไปฅๆฅ็ป่ฟ็ๆฏซ็งๆฐใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/getTimer.ts
     * @language zh_CN
     */
    function getTimer() {
        return Date.now() - egret.sys.$START_TIME;
    }
    egret.getTimer = getTimer;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Check whether a public definition exists in the specified application domain. The definition can be that of a class, a naming space or a function.
     * @param name {string} Name of the definition.
     * @returns {boolean} Whether the public definition exists
     * @example
     * egret.hasDefinition("egret.DisplayObject") //return true
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/hasDefinition.ts
     * @language en_US
     */
    /**
     * ๆฃๆฅๆๅฎ็ๅบ็จ็จๅบๅไนๅๆฏๅฆๅญๅจไธไธชๅฌๅฑๅฎไนใ่ฏฅๅฎไนๅฏไปฅๆฏไธไธช็ฑปใไธไธชๅฝๅ็ฉบ้ดๆไธไธชๅฝๆฐ็ๅฎไนใ
     * @param name {string} ๅฎไน็ๅ็งฐใ
     * @returns {boolean} ๅฌๅฑๅฎไนๆฏๅฆๅญๅจ
     * @example
     * egret.hasDefinition("egret.DisplayObject") //่ฟๅ true
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/hasDefinition.ts
     * @language zh_CN
     */
    function hasDefinition(name) {
        var definition = egret.getDefinitionByName(name);
        return definition ? true : false;
    }
    egret.hasDefinition = hasDefinition;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Indicates whether an object is a instance of the class or interface specified as the parameter.This method has better performance
     * compared width the instanceOf operator,and it can indicate whether an object is a instance of the specific interface.
     * @param instance the instance to be checked.
     * @param typeName the string value representing a specific class or interface.
     * @returns A value of true if the object is a instance of the class or interface specified as the parameter.
     * @example
     * <pre>
     *     let instance = new egret.Sprite();
     *     egret.log(egret.is(instance,"egret.Sprite"))  //true
     *     egret.log(egret.is(instance,"egret.DisplayObjectContainer"))  //true
     *     egret.log(egret.is(instance,"egret.Bitmap"))  //false
     * </pre>
     * @see egret.registerClass()
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆฃๆฅๆๅฎๅฏน่ฑกๆฏๅฆไธบ Egret ๆกๆถๅๆๅฎๆฅๅฃๆ็ฑปๆๅถๅญ็ฑป็ๅฎไพใๆญคๆนๆณไธไฝฟ็จ instanceOf ๅณ้ฎๅญ็ธๆฏๅทๆๆด้ซ็ๆง่ฝ๏ผๅนถไธ่ฝๅคๆญๆฅๅฃ็ๅฎ็ฐใ
     * @param instance ่ฆๅคๆญ็ๅฎไพใ
     * @param typeName ็ฑปๆๆฅๅฃ็ๅฎๅจๅ็งฐ.
     * @returns ่ฟๅtrue่กจ็คบๅฝๅๅฏน่ฑกๆฏๆๅฎ็ฑปๆๆฅๅฃ็ๅฎไพใ
     * @example
     * <pre>
     *     let instance = new egret.Sprite();
     *     egret.log(egret.is(instance,"egret.Sprite"))  //true
     *     egret.log(egret.is(instance,"egret.DisplayObjectContainer"))  //true
     *     egret.log(egret.is(instance,"egret.Bitmap"))  //false
     * </pre>
     * @see egret.registerClass()
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function is(instance, typeName) {
        if (!instance || typeof instance != "object") {
            return false;
        }
        var prototype = Object.getPrototypeOf(instance);
        var types = prototype ? prototype.__types__ : null;
        if (!types) {
            return false;
        }
        return (types.indexOf(typeName) !== -1);
    }
    egret.is = is;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Register and start a timer,which will notify the callback method at a rate of 60 FPS ,and pass the current time stamp as parameters.<br/>
     * Note: After the registration,it will notify the callback method continuously,you can call the stopTick () method to stop it.
     * @param callBack the call back method. the timeStamp parameter of this method represents the number of milliseconds
     * since the Egret framework was initialized. If the return value of this method is true, it will force Egret runtime
     * to render after processing of this method completes.
     * @param thisObject the call back method's "this"
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆณจๅๅนถๅฏๅจไธไธช่ฎกๆถๅจ๏ผ้ๅธธไผไปฅ60FPS็้็่งฆๅๅ่ฐๆนๆณ๏ผๅนถไผๅฅๅฝๅๆถ้ดๆณใๆณจๆ๏ผๆณจๅๅๅฐไผๆ็ปญ่งฆๅๅ่ฐๆนๆณ๏ผ่ฅ่ฆๅๆญขๅ่ฐ๏ผ้่ฆๆๅจ่ฐ็จstopTick()ๆนๆณใ
     * @param callBack ่ฆๆง่ก็ๅ่ฐๆนๆณใๅๆฐ timeStamp ่กจ็คบไปๅฏๅจEgretๆกๆถๅผๅง็ป่ฟ็ๆถ้ด(ๆฏซ็ง)ใ
     * ่ฅๅ่ฐๆนๆณ่ฟๅๅผไธบtrue๏ผๅถไฝ็จไธTimerEvent.updateAfterEvent()็ฑปไผผ๏ผๅฐไผๅฟฝ็ฅๅธง้ข้ๅถ๏ผๅจๆญคๆนๆณๅค็ๅฎๆๅ็ซๅณ้็ปๅฑๅนใ
     * @param thisObject ๅ่ฐๆนๆณ็thisๅฏน่ฑกๅผ็จใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function startTick(callBack, thisObject) {
        if (true && !callBack) {
            egret.$error(1003, "callBack");
        }
        egret.ticker.$startTick(callBack, thisObject);
    }
    egret.startTick = startTick;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Stops the timer started by the egret.startTick() method.
     * @param callBack the call back method. the timeStamp parameter of this method represents the number of milliseconds
     * since the Egret framework was initialized. If the return value of this method is true, it will force Egret runtime
     * to render after processing of this method completes.
     * @param thisObject the call back method's "this"
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅๆญขไนๅ็จ startTick() ๆนๆณๅฏๅจ็่ฎกๆถๅจใ
     * @param callBack ่ฆๆง่ก็ๅ่ฐๆนๆณใๅๆฐ timeStamp ่กจ็คบไปๅฏๅจEgretๆกๆถๅผๅง็ป่ฟ็ๆถ้ด(ๆฏซ็ง)ใ
     * ่ฅๅ่ฐๆนๆณ่ฟๅๅผไธบtrue๏ผๅถไฝ็จไธTimerEvent.updateAfterEvent()็ฑปไผผ๏ผๅฐไผๅฟฝ็ฅๅธง้ข้ๅถ๏ผๅจๆญคๆนๆณๅค็ๅฎๆๅ็ซๅณ้็ปๅฑๅนใ
     * @param thisObject ๅ่ฐๆนๆณ็thisๅฏน่ฑกๅผ็จใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function stopTick(callBack, thisObject) {
        if (true && !callBack) {
            egret.$error(1003, "callBack");
        }
        egret.ticker.$stopTick(callBack, thisObject);
    }
    egret.stopTick = stopTick;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Transfer number to color character string
     * @param value {number} color value ,such as 0xffffff
     * @returns {string} Color character string, for example, #ffffff.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/toColorString.ts
     * @language en_US
     */
    /**
     * ่ฝฌๆขๆฐๅญไธบ้ข่ฒๅญ็ฌฆไธฒ
     * @param value {number} ้ข่ฒๅผ๏ผไพๅฆ 0xffffff
     * @returns {string} ้ข่ฒๅญ็ฌฆไธฒ๏ผไพๅฆ"#ffffff"ใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample egret/utils/toColorString.ts
     * @language zh_CN
     */
    function toColorString(value) {
        if (value < 0)
            value = 0;
        if (value > 16777215)
            value = 16777215;
        var color = value.toString(16).toUpperCase();
        while (color.length > 6) {
            color = color.slice(1, color.length);
        }
        while (color.length < 6) {
            color = "0" + color;
        }
        return "#" + color;
    }
    egret.toColorString = toColorString;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var __reflect = (this && this.__reflect) || function (p, c, t) {
    p.__class__ = c, t ? t.push(c) : t = [c], p.__types__ = p.__types__ ? t.concat(p.__types__) : t;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebFps = (function (_super) {
            __extends(WebFps, _super);
            function WebFps(stage, showFPS, showLog, logFilter, styles) {
                var _this = _super.call(this) || this;
                _this.showPanle = true;
                _this.fpsHeight = 0;
                _this.WIDTH = 101;
                _this.HEIGHT = 20;
                _this.bgCanvasColor = "#18304b";
                _this.fpsFrontColor = "#18fefe";
                _this.WIDTH_COST = 33;
                _this.cost1Color = "#18fefe";
                _this.cost2Color = "#ffff00";
                _this.cost3Color = "#ff0000";
                _this.arrFps = [];
                _this.arrCost = [];
                _this.arrLog = [];
                if (showFPS || showLog) {
                    if (egret.Capabilities.renderMode == 'canvas') {
                        _this.renderMode = "Canvas";
                    }
                    else {
                        _this.renderMode = "WebGL";
                    }
                    _this.panelX = styles["x"] === undefined ? 0 : parseInt(styles['x']);
                    _this.panelY = styles["y"] === undefined ? 0 : parseInt(styles['y']);
                    _this.fontColor = styles["textColor"] === undefined ? '#ffffff' : styles['textColor'].replace("0x", "#");
                    _this.fontSize = styles["size"] === undefined ? 12 : parseInt(styles['size']);
                    if (egret.Capabilities.isMobile) {
                        _this.fontSize -= 2;
                    }
                    var all = document.createElement('div');
                    all.style.position = 'absolute';
                    all.style.background = "rgba(0,0,0," + styles['bgAlpha'] + ")";
                    all.style.left = _this.panelX + 'px';
                    all.style.top = _this.panelY + 'px';
                    all.style.pointerEvents = 'none';
                    document.body.appendChild(all);
                    var container = document.createElement('div');
                    container.style.color = _this.fontColor;
                    container.style.fontSize = _this.fontSize + 'px';
                    container.style.lineHeight = _this.fontSize + 'px';
                    container.style.margin = '4px 4px 4px 4px';
                    _this.container = container;
                    all.appendChild(container);
                    if (showFPS)
                        _this.addFps();
                    if (showLog)
                        _this.addLog();
                }
                return _this;
            }
            WebFps.prototype.addFps = function () {
                var div = document.createElement('div');
                div.style.display = 'inline-block';
                this.containerFps = div;
                this.container.appendChild(div);
                var fps = document.createElement('div');
                fps.style.paddingBottom = '2px';
                this.fps = fps;
                this.containerFps.appendChild(fps);
                fps.innerHTML = "0 FPS " + this.renderMode + "<br/>min0 max0 avg0";
                var canvas = document.createElement('canvas');
                this.containerFps.appendChild(canvas);
                canvas.width = this.WIDTH;
                canvas.height = this.HEIGHT;
                this.canvasFps = canvas;
                var context = canvas.getContext('2d');
                this.contextFps = context;
                context.fillStyle = this.bgCanvasColor;
                context.fillRect(0, 0, this.WIDTH, this.HEIGHT);
                var divDatas = document.createElement('div');
                this.divDatas = divDatas;
                this.containerFps.appendChild(divDatas);
                var left = document.createElement('div');
                left.style['float'] = 'left';
                left.innerHTML = "Draw<br/>Dirty<br/>Cost";
                divDatas.appendChild(left);
                var right = document.createElement('div');
                right.style.paddingLeft = left.offsetWidth + 20 + "px";
                divDatas.appendChild(right);
                var draw = document.createElement('div');
                this.divDraw = draw;
                draw.innerHTML = "0<br/>0<br/>";
                right.appendChild(draw);
                var cost = document.createElement('div');
                this.divCost = cost;
                cost.innerHTML = "<font  style=\"color:" + this.cost1Color + "\">0<font/> <font  style=\"color:" + this.cost2Color + "\">0<font/> <font  style=\"color:" + this.cost3Color + "\">0<font/>";
                right.appendChild(cost);
                canvas = document.createElement('canvas');
                this.canvasCost = canvas;
                this.containerFps.appendChild(canvas);
                canvas.width = this.WIDTH;
                canvas.height = this.HEIGHT;
                context = canvas.getContext('2d');
                this.contextCost = context;
                context.fillStyle = this.bgCanvasColor;
                context.fillRect(0, 0, this.WIDTH, this.HEIGHT);
                context.fillStyle = "#000000";
                context.fillRect(this.WIDTH_COST, 0, 1, this.HEIGHT);
                context.fillRect(this.WIDTH_COST * 2 + 1, 0, 1, this.HEIGHT);
                this.fpsHeight = this.container.offsetHeight;
            };
            WebFps.prototype.addLog = function () {
                var log = document.createElement('div');
                log.style.maxWidth = document.body.clientWidth - 8 - this.panelX + 'px';
                log.style.wordWrap = "break-word";
                this.log = log;
                this.container.appendChild(log);
            };
            WebFps.prototype.update = function (datas, showLastData) {
                if (showLastData === void 0) {
                    showLastData = false;
                }
                var numFps;
                var numCostTicker;
                var numCostDirty;
                var numCostRender;
                if (!showLastData) {
                    numFps = datas.fps;
                    numCostTicker = datas.costTicker;
                    numCostDirty = datas.costDirty;
                    numCostRender = datas.costRender;
                    this.lastNumDraw = datas.draw;
                    this.lastNumDirty = datas.dirty;
                    this.arrFps.push(numFps);
                    this.arrCost.push([numCostTicker, numCostDirty, numCostRender]);
                }
                else {
                    numFps = this.arrFps[this.arrFps.length - 1];
                    numCostTicker = this.arrCost[this.arrCost.length - 1][0];
                    numCostDirty = this.arrCost[this.arrCost.length - 1][1];
                    numCostRender = this.arrCost[this.arrCost.length - 1][2];
                }
                var fpsTotal = 0;
                var lenFps = this.arrFps.length;
                if (lenFps > 101) {
                    lenFps = 101;
                    this.arrFps.shift();
                    this.arrCost.shift();
                }
                var fpsMin = this.arrFps[0];
                var fpsMax = this.arrFps[0];
                for (var i = 0; i < lenFps; i++) {
                    var num = this.arrFps[i];
                    fpsTotal += num;
                    if (num < fpsMin)
                        fpsMin = num;
                    else if (num > fpsMax)
                        fpsMax = num;
                }
                var WIDTH = this.WIDTH;
                var HEIGHT = this.HEIGHT;
                var context = this.contextFps;
                context.drawImage(this.canvasFps, 1, 0, WIDTH - 1, HEIGHT, 0, 0, WIDTH - 1, HEIGHT);
                context.fillStyle = this.bgCanvasColor;
                context.fillRect(WIDTH - 1, 0, 1, HEIGHT);
                var lastHeight = Math.floor(numFps / 60 * 20);
                if (lastHeight < 1)
                    lastHeight = 1;
                context.fillStyle = this.fpsFrontColor;
                context.fillRect(WIDTH - 1, 20 - lastHeight, 1, lastHeight);
                var WIDTH_COST = this.WIDTH_COST;
                context = this.contextCost;
                context.drawImage(this.canvasCost, 1, 0, WIDTH_COST - 1, HEIGHT, 0, 0, WIDTH_COST - 1, HEIGHT);
                context.drawImage(this.canvasCost, WIDTH_COST + 2, 0, WIDTH_COST - 1, HEIGHT, WIDTH_COST + 1, 0, WIDTH_COST - 1, HEIGHT);
                context.drawImage(this.canvasCost, WIDTH_COST * 2 + 3, 0, WIDTH_COST - 1, HEIGHT, WIDTH_COST * 2 + 2, 0, WIDTH_COST - 1, HEIGHT);
                var c1Height = Math.floor(numCostTicker / 2);
                if (c1Height < 1)
                    c1Height = 1;
                else if (c1Height > 20)
                    c1Height = 20;
                var c2Height = Math.floor(numCostDirty / 2);
                if (c2Height < 1)
                    c2Height = 1;
                else if (c2Height > 20)
                    c2Height = 20;
                var c3Height = Math.floor(numCostRender / 2);
                if (c3Height < 1)
                    c3Height = 1;
                else if (c3Height > 20)
                    c3Height = 20;
                context.fillStyle = this.bgCanvasColor;
                context.fillRect(WIDTH_COST - 1, 0, 1, HEIGHT);
                context.fillRect(WIDTH_COST * 2, 0, 1, HEIGHT);
                context.fillRect(WIDTH_COST * 3 + 1, 0, 1, HEIGHT);
                context.fillStyle = this.cost1Color;
                context.fillRect(WIDTH_COST - 1, 20 - c1Height, 1, c1Height);
                context.fillStyle = this.cost2Color;
                context.fillRect(WIDTH_COST * 2, 20 - c2Height, 1, c2Height);
                context.fillStyle = this.cost3Color;
                context.fillRect(WIDTH_COST * 3 + 1, 20 - c3Height, 1, c3Height);
                var fpsAvg = Math.floor(fpsTotal / lenFps);
                var fpsOutput = numFps + " FPS " + this.renderMode;
                if (this.showPanle) {
                    fpsOutput += "<br/>min" + fpsMin + " max" + fpsMax + " avg" + fpsAvg;
                    this.divDraw.innerHTML = this.lastNumDraw + "<br/>" + this.lastNumDirty + "%<br/>";
                    this.divCost.innerHTML = "<font  style=\"color:#18fefe\">" + numCostTicker + "<font/> <font  style=\"color:#ffff00\">" + numCostDirty + "<font/> <font  style=\"color:#ff0000\">" + numCostRender + "<font/>";
                }
                this.fps.innerHTML = fpsOutput;
            };
            ;
            WebFps.prototype.updateInfo = function (info) {
                this.arrLog.push(info);
                this.log.innerHTML = this.arrLog.join('<br/>');
                while (document.body.clientHeight < (this.log.offsetHeight + this.fpsHeight + this.panelY + this.fontSize * 2)) {
                    this.arrLog.shift();
                    this.log.innerHTML = this.arrLog.join('<br/>');
                }
            };
            return WebFps;
        }(egret.DisplayObject));
        web.WebFps = WebFps;
        __reflect(WebFps.prototype, "egret.web.WebFps", ["egret.FPSDisplay", "egret.DisplayObject"]);
        egret.FPSDisplay = WebFps;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
// There is no HTMLDivElement in webkit for air
if (true && window['HTMLVideoElement'] == undefined) {
    window['HTMLVideoElement'] = HTMLDivElement;
}
var egret;
(function (egret) {
    var web;
    (function (web) {
        var className = "egret.BitmapData";
        egret.registerClass(HTMLImageElement, className);
        egret.registerClass(HTMLCanvasElement, className);
        egret.registerClass(HTMLVideoElement, className);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
(function (egret) {
    /**
     * ่ฝฌๆข Image๏ผCanvas๏ผVideo ไธบ Egret ๆกๆถๅไฝฟ็จ็ BitmapData ๅฏน่ฑกใ
     * @param data ้่ฆ่ฝฌๆข็ๅฏน่ฑก๏ผๅๆฌHTMLImageElement|HTMLCanvasElement|HTMLVideoElement
     * @deprecated
     */
    function $toBitmapData(data) {
        data["hashCode"] = data["$hashCode"] = egret.$hashCount++;
        return data;
    }
    egret.$toBitmapData = $toBitmapData;
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var localStorage;
    (function (localStorage) {
        var web;
        (function (web) {
            /**
             * @private
             *
             * @param key
             * @returns
             */
            function getItem(key) {
                return window.localStorage.getItem(key);
            }
            /**
             * @private
             *
             * @param key
             * @param value
             * @returns
             */
            function setItem(key, value) {
                try {
                    window.localStorage.setItem(key, value);
                    return true;
                }
                catch (e) {
                    egret.$warn(1047, key, value);
                    return false;
                }
            }
            /**
             * @private
             *
             * @param key
             */
            function removeItem(key) {
                window.localStorage.removeItem(key);
            }
            /**
             * @private
             *
             */
            function clear() {
                window.localStorage.clear();
            }
            localStorage.getItem = getItem;
            localStorage.setItem = setItem;
            localStorage.removeItem = removeItem;
            localStorage.clear = clear;
        })(web = localStorage.web || (localStorage.web = {}));
    })(localStorage = egret.localStorage || (egret.localStorage = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * @inheritDoc
         */
        var HtmlSound = (function (_super) {
            __extends(HtmlSound, _super);
            /**
             * @private
             * @inheritDoc
             */
            function HtmlSound() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.loaded = false;
                return _this;
            }
            Object.defineProperty(HtmlSound.prototype, "length", {
                get: function () {
                    if (this.originAudio) {
                        return this.originAudio.duration;
                    }
                    throw new Error("sound not loaded!");
                    //return 0;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @inheritDoc
             */
            HtmlSound.prototype.load = function (url) {
                var self = this;
                this.url = url;
                if (true && !url) {
                    egret.$error(3002);
                }
                var audio = new Audio(url);
                audio.addEventListener("canplaythrough", onAudioLoaded);
                audio.addEventListener("error", onAudioError);
                var ua = navigator.userAgent.toLowerCase();
                if (ua.indexOf("firefox") >= 0) {
                    audio.autoplay = !0;
                    audio.muted = true;
                }
                audio.load();
                this.originAudio = audio;
                if (HtmlSound.clearAudios[this.url]) {
                    delete HtmlSound.clearAudios[this.url];
                }
                HtmlSound.$recycle(this.url, audio);
                function onAudioLoaded() {
                    removeListeners();
                    if (ua.indexOf("firefox") >= 0) {
                        audio.pause();
                        audio.muted = false;
                    }
                    self.loaded = true;
                    self.dispatchEventWith(egret.Event.COMPLETE);
                }
                function onAudioError() {
                    removeListeners();
                    self.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
                }
                function removeListeners() {
                    audio.removeEventListener("canplaythrough", onAudioLoaded);
                    audio.removeEventListener("error", onAudioError);
                }
            };
            /**
             * @inheritDoc
             */
            HtmlSound.prototype.play = function (startTime, loops) {
                startTime = +startTime || 0;
                loops = +loops || 0;
                if (true && this.loaded == false) {
                    egret.$error(1049);
                }
                var audio = HtmlSound.$pop(this.url);
                if (audio == null) {
                    audio = this.originAudio.cloneNode();
                }
                else {
                    //audio.load();
                }
                audio.autoplay = true;
                var channel = new web.HtmlSoundChannel(audio);
                channel.$url = this.url;
                channel.$loops = loops;
                channel.$startTime = startTime;
                channel.$play();
                egret.sys.$pushSoundChannel(channel);
                return channel;
            };
            /**
             * @inheritDoc
             */
            HtmlSound.prototype.close = function () {
                if (this.loaded == false && this.originAudio)
                    this.originAudio.src = "";
                if (this.originAudio)
                    this.originAudio = null;
                HtmlSound.$clear(this.url);
            };
            HtmlSound.$clear = function (url) {
                HtmlSound.clearAudios[url] = true;
                var array = HtmlSound.audios[url];
                if (array) {
                    array.length = 0;
                }
            };
            HtmlSound.$pop = function (url) {
                var array = HtmlSound.audios[url];
                if (array && array.length > 0) {
                    return array.pop();
                }
                return null;
            };
            HtmlSound.$recycle = function (url, audio) {
                if (HtmlSound.clearAudios[url]) {
                    return;
                }
                var array = HtmlSound.audios[url];
                if (HtmlSound.audios[url] == null) {
                    array = HtmlSound.audios[url] = [];
                }
                array.push(audio);
            };
            /**
             * Background music
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๆฏ้ณไน
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            HtmlSound.MUSIC = "music";
            /**
             * EFFECT
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ้ณๆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            HtmlSound.EFFECT = "effect";
            /**
             * @private
             */
            HtmlSound.audios = {};
            HtmlSound.clearAudios = {};
            return HtmlSound;
        }(egret.EventDispatcher));
        web.HtmlSound = HtmlSound;
        __reflect(HtmlSound.prototype, "egret.web.HtmlSound", ["egret.Sound"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * @inheritDoc
         */
        var HtmlSoundChannel = (function (_super) {
            __extends(HtmlSoundChannel, _super);
            /**
             * @private
             */
            function HtmlSoundChannel(audio) {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.$startTime = 0;
                /**
                 * @private
                 */
                _this.audio = null;
                //ๅฃฐ้ณๆฏๅฆๅทฒ็ปๆญๆพๅฎๆ
                _this.isStopped = false;
                _this.canPlay = function () {
                    _this.audio.removeEventListener("canplay", _this.canPlay);
                    try {
                        _this.audio.currentTime = _this.$startTime;
                    }
                    catch (e) {
                    }
                    finally {
                        _this.audio.play();
                    }
                };
                /**
                 * @private
                 */
                _this.onPlayEnd = function () {
                    if (_this.$loops == 1) {
                        _this.stop();
                        _this.dispatchEventWith(egret.Event.SOUND_COMPLETE);
                        return;
                    }
                    if (_this.$loops > 0) {
                        _this.$loops--;
                    }
                    /////////////
                    //this.audio.load();
                    _this.$play();
                };
                /**
                 * @private
                 */
                _this._volume = 1;
                audio.addEventListener("ended", _this.onPlayEnd);
                _this.audio = audio;
                return _this;
            }
            HtmlSoundChannel.prototype.$play = function () {
                if (this.isStopped) {
                    egret.$error(1036);
                    return;
                }
                try {
                    //this.audio.pause();
                    this.audio.volume = this._volume;
                    this.audio.currentTime = this.$startTime;
                }
                catch (e) {
                    this.audio.addEventListener("canplay", this.canPlay);
                    return;
                }
                this.audio.play();
            };
            /**
             * @private
             * @inheritDoc
             */
            HtmlSoundChannel.prototype.stop = function () {
                if (!this.audio)
                    return;
                if (!this.isStopped) {
                    egret.sys.$popSoundChannel(this);
                }
                this.isStopped = true;
                var audio = this.audio;
                audio.removeEventListener("ended", this.onPlayEnd);
                audio.volume = 0;
                this._volume = 0;
                this.audio = null;
                var url = this.$url;
                //ๅปถ่ฟไธๅฎๆถ้ดๅๅๆญข๏ผ่ง้ฟchromeๆฅ้
                window.setTimeout(function () {
                    audio.pause();
                    web.HtmlSound.$recycle(url, audio);
                }, 200);
            };
            Object.defineProperty(HtmlSoundChannel.prototype, "volume", {
                /**
                 * @private
                 * @inheritDoc
                 */
                get: function () {
                    return this._volume;
                },
                /**
                 * @inheritDoc
                 */
                set: function (value) {
                    if (this.isStopped) {
                        egret.$error(1036);
                        return;
                    }
                    this._volume = value;
                    if (!this.audio)
                        return;
                    this.audio.volume = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(HtmlSoundChannel.prototype, "position", {
                /**
                 * @private
                 * @inheritDoc
                 */
                get: function () {
                    if (!this.audio)
                        return 0;
                    return this.audio.currentTime;
                },
                enumerable: true,
                configurable: true
            });
            return HtmlSoundChannel;
        }(egret.EventDispatcher));
        web.HtmlSoundChannel = HtmlSoundChannel;
        __reflect(HtmlSoundChannel.prototype, "egret.web.HtmlSoundChannel", ["egret.SoundChannel", "egret.IEventDispatcher"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebAudioDecode = (function () {
            function WebAudioDecode() {
            }
            /**
             * @private
             *
             */
            WebAudioDecode.decodeAudios = function () {
                if (WebAudioDecode.decodeArr.length <= 0) {
                    return;
                }
                if (WebAudioDecode.isDecoding) {
                    return;
                }
                WebAudioDecode.isDecoding = true;
                var decodeInfo = WebAudioDecode.decodeArr.shift();
                WebAudioDecode.ctx.decodeAudioData(decodeInfo["buffer"], function (audioBuffer) {
                    decodeInfo["self"].audioBuffer = audioBuffer;
                    if (decodeInfo["success"]) {
                        decodeInfo["success"]();
                    }
                    WebAudioDecode.isDecoding = false;
                    WebAudioDecode.decodeAudios();
                }, function () {
                    alert("sound decode error: " + decodeInfo["url"] + "๏ผ\nsee http://edn.egret.com/cn/docs/page/156");
                    if (decodeInfo["fail"]) {
                        decodeInfo["fail"]();
                    }
                    WebAudioDecode.isDecoding = false;
                    WebAudioDecode.decodeAudios();
                });
            };
            /**
             * @private
             */
            WebAudioDecode.decodeArr = [];
            /**
             * @private
             */
            WebAudioDecode.isDecoding = false;
            return WebAudioDecode;
        }());
        web.WebAudioDecode = WebAudioDecode;
        __reflect(WebAudioDecode.prototype, "egret.web.WebAudioDecode");
        /**
         * @private
         * @inheritDoc
         */
        var WebAudioSound = (function (_super) {
            __extends(WebAudioSound, _super);
            /**
             * @private
             * @inheritDoc
             */
            function WebAudioSound() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.loaded = false;
                return _this;
            }
            Object.defineProperty(WebAudioSound.prototype, "length", {
                get: function () {
                    if (this.audioBuffer) {
                        return this.audioBuffer.duration;
                    }
                    throw new Error("sound not loaded!");
                    //return 0;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @inheritDoc
             */
            WebAudioSound.prototype.load = function (url) {
                var self = this;
                this.url = url;
                if (true && !url) {
                    egret.$error(3002);
                }
                var request = new XMLHttpRequest();
                request.open("GET", url, true);
                request.responseType = "arraybuffer";
                request.onreadystatechange = function () {
                    if (request.readyState == 4) {
                        var ioError = (request.status >= 400 || request.status == 0);
                        if (ioError) {
                            self.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
                        }
                        else {
                            WebAudioDecode.decodeArr.push({
                                "buffer": request.response,
                                "success": onAudioLoaded,
                                "fail": onAudioError,
                                "self": self,
                                "url": self.url
                            });
                            WebAudioDecode.decodeAudios();
                        }
                    }
                };
                request.send();
                function onAudioLoaded() {
                    self.loaded = true;
                    self.dispatchEventWith(egret.Event.COMPLETE);
                }
                function onAudioError() {
                    self.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
                }
            };
            /**
             * @inheritDoc
             */
            WebAudioSound.prototype.play = function (startTime, loops) {
                startTime = +startTime || 0;
                loops = +loops || 0;
                if (true && this.loaded == false) {
                    egret.$error(1049);
                }
                var channel = new web.WebAudioSoundChannel();
                channel.$url = this.url;
                channel.$loops = loops;
                channel.$audioBuffer = this.audioBuffer;
                channel.$startTime = startTime;
                channel.$play();
                egret.sys.$pushSoundChannel(channel);
                return channel;
            };
            /**
             * @inheritDoc
             */
            WebAudioSound.prototype.close = function () {
            };
            /**
             * Background music
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๆฏ้ณไน
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            WebAudioSound.MUSIC = "music";
            /**
             * EFFECT
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ้ณๆ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            WebAudioSound.EFFECT = "effect";
            return WebAudioSound;
        }(egret.EventDispatcher));
        web.WebAudioSound = WebAudioSound;
        __reflect(WebAudioSound.prototype, "egret.web.WebAudioSound", ["egret.Sound"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * @inheritDoc
         */
        var WebAudioSoundChannel = (function (_super) {
            __extends(WebAudioSoundChannel, _super);
            /**
             * @private
             */
            function WebAudioSoundChannel() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.$startTime = 0;
                /**
                 * @private
                 */
                _this.bufferSource = null;
                /**
                 * @private
                 */
                _this.context = web.WebAudioDecode.ctx;
                //ๅฃฐ้ณๆฏๅฆๅทฒ็ปๆญๆพๅฎๆ
                _this.isStopped = false;
                /**
                 * @private
                 */
                _this._currentTime = 0;
                /**
                 * @private
                 */
                _this._volume = 1;
                /**
                 * @private
                 */
                _this.onPlayEnd = function () {
                    if (_this.$loops == 1) {
                        _this.stop();
                        _this.dispatchEventWith(egret.Event.SOUND_COMPLETE);
                        return;
                    }
                    if (_this.$loops > 0) {
                        _this.$loops--;
                    }
                    /////////////
                    _this.$play();
                };
                /**
                 * @private
                 */
                _this._startTime = 0;
                if (_this.context["createGain"]) {
                    _this.gain = _this.context["createGain"]();
                }
                else {
                    _this.gain = _this.context["createGainNode"]();
                }
                return _this;
            }
            WebAudioSoundChannel.prototype.$play = function () {
                if (this.isStopped) {
                    egret.$error(1036);
                    return;
                }
                if (this.bufferSource) {
                    this.bufferSource.onended = null;
                    this.bufferSource = null;
                }
                var context = this.context;
                var gain = this.gain;
                var bufferSource = context.createBufferSource();
                this.bufferSource = bufferSource;
                bufferSource.buffer = this.$audioBuffer;
                bufferSource.connect(gain);
                gain.connect(context.destination);
                bufferSource.onended = this.onPlayEnd;
                this._startTime = Date.now();
                this.gain.gain.value = this._volume;
                bufferSource.start(0, this.$startTime);
                this._currentTime = 0;
            };
            WebAudioSoundChannel.prototype.stop = function () {
                if (this.bufferSource) {
                    var sourceNode = this.bufferSource;
                    if (sourceNode.stop) {
                        sourceNode.stop(0);
                    }
                    else {
                        sourceNode.noteOff(0);
                    }
                    sourceNode.onended = null;
                    sourceNode.disconnect();
                    this.bufferSource = null;
                    this.$audioBuffer = null;
                }
                if (!this.isStopped) {
                    egret.sys.$popSoundChannel(this);
                }
                this.isStopped = true;
            };
            Object.defineProperty(WebAudioSoundChannel.prototype, "volume", {
                /**
                 * @private
                 * @inheritDoc
                 */
                get: function () {
                    return this._volume;
                },
                /**
                 * @inheritDoc
                 */
                set: function (value) {
                    if (this.isStopped) {
                        egret.$error(1036);
                        return;
                    }
                    this._volume = value;
                    this.gain.gain.value = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebAudioSoundChannel.prototype, "position", {
                /**
                 * @private
                 * @inheritDoc
                 */
                get: function () {
                    if (this.bufferSource) {
                        return (Date.now() - this._startTime) / 1000 + this.$startTime;
                    }
                    return 0;
                },
                enumerable: true,
                configurable: true
            });
            return WebAudioSoundChannel;
        }(egret.EventDispatcher));
        web.WebAudioSoundChannel = WebAudioSoundChannel;
        __reflect(WebAudioSoundChannel.prototype, "egret.web.WebAudioSoundChannel", ["egret.SoundChannel", "egret.IEventDispatcher"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * @inheritDoc
         */
        var WebVideo = (function (_super) {
            __extends(WebVideo, _super);
            /**
             * @inheritDoc
             */
            function WebVideo(url, cache) {
                if (cache === void 0) {
                    cache = true;
                }
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.loaded = false;
                /**
                 * @private
                 */
                _this.closed = false;
                /**
                 * @private
                 */
                _this.heightSet = NaN;
                /**
                 * @private
                 */
                _this.widthSet = NaN;
                /**
                 * @private
                 * pcไธ่ง้ขๅกไฝ็ๆถๅไธ่ฝๆๅ
                 */
                _this.waiting = false;
                /**
                 * @private
                 * ็จๆทๆฏๅฆ่ฎพ็ฝฎไบ pause
                 */
                _this.userPause = false;
                /**
                 * @private
                 * ็จๆทๆฏๅฆ่ฎพ็ฝฎไบ play
                 */
                _this.userPlay = false;
                _this.isPlayed = false;
                _this.screenChanged = function (e) {
                    var isfullscreen = document.fullscreenEnabled || document.webkitIsFullScreen;
                    if (!isfullscreen) {
                        _this.checkFullScreen(false);
                        if (!egret.Capabilities.isMobile) {
                            _this._fullscreen = isfullscreen;
                        }
                    }
                };
                _this._fullscreen = true;
                /**
                 * @private
                 *
                 */
                _this.onVideoLoaded = function () {
                    _this.video.removeEventListener("canplay", _this.onVideoLoaded);
                    var video = _this.video;
                    _this.loaded = true;
                    //video.pause();
                    if (_this.posterData) {
                        _this.posterData.width = _this.getPlayWidth();
                        _this.posterData.height = _this.getPlayHeight();
                    }
                    video.width = video.videoWidth;
                    video.height = video.videoHeight;
                    _this.$invalidateContentBounds();
                    window.setTimeout(function () {
                        _this.dispatchEventWith(egret.Event.COMPLETE);
                    }, 200);
                };
                _this.$renderNode = new egret.sys.BitmapNode();
                _this.src = url;
                _this.once(egret.Event.ADDED_TO_STAGE, _this.loadPoster, _this);
                if (url) {
                    _this.load();
                }
                return _this;
            }
            /**
             * @inheritDoc
             */
            WebVideo.prototype.load = function (url, cache) {
                var _this = this;
                if (cache === void 0) {
                    cache = true;
                }
                url = url || this.src;
                this.src = url;
                if (true && !url) {
                    egret.$error(3002);
                }
                if (this.video && this.video.src == url) {
                    return;
                }
                var video;
                if (!this.video || egret.Capabilities.isMobile) {
                    video = document.createElement("video");
                    this.video = video;
                    video.controls = null;
                }
                else {
                    video = this.video;
                }
                video.src = url;
                video.setAttribute("autoplay", "autoplay");
                video.setAttribute("webkit-playsinline", "true");
                video.addEventListener("canplay", this.onVideoLoaded);
                video.addEventListener("error", function () { return _this.onVideoError(); });
                video.addEventListener("ended", function () { return _this.onVideoEnded(); });
                var firstPause = false;
                video.addEventListener("canplay", function () {
                    _this.waiting = false;
                    if (!firstPause) {
                        firstPause = true;
                        video.pause();
                    }
                    else {
                        if (_this.userPause) {
                            _this.pause();
                        }
                        else if (_this.userPlay) {
                            _this.play();
                        }
                    }
                });
                video.addEventListener("waiting", function () {
                    _this.waiting = true;
                });
                video.load();
                this.videoPlay();
                video.style.position = "absolute";
                video.style.top = "0px";
                video.style.zIndex = "-88888";
                video.style.left = "0px";
                video.height = 1;
                video.width = 1;
            };
            /**
             * @inheritDoc
             */
            WebVideo.prototype.play = function (startTime, loop) {
                var _this = this;
                if (loop === void 0) {
                    loop = false;
                }
                if (this.loaded == false) {
                    this.load(this.src);
                    this.once(egret.Event.COMPLETE, function (e) { return _this.play(startTime, loop); }, this);
                    return;
                }
                this.isPlayed = true;
                var video = this.video;
                if (startTime != undefined)
                    video.currentTime = +startTime || 0;
                video.loop = !!loop;
                if (egret.Capabilities.isMobile) {
                    video.style.zIndex = "-88888"; //็งปๅจ็ซฏ๏ผๅฐฑ็ฎ่ฎพ็ฝฎๆๆๅฐ๏ผๅช่ฆๅจๅฑ๏ผ้ฝไผๅจๆไธๅฑ๏ผ่ไธๅจ่ชๅจ้ๅบๅปๅ๏ผไธๆๅฟๆกไฝcanvas
                }
                else {
                    video.style.zIndex = "9999";
                }
                video.style.position = "absolute";
                video.style.top = "0px";
                video.style.left = "0px";
                video.height = video.videoHeight;
                video.width = video.videoWidth;
                if (egret.Capabilities.os != "Windows PC" && egret.Capabilities.os != "Mac OS") {
                    window.setTimeout(function () {
                        video.width = 0;
                    }, 1000);
                }
                this.checkFullScreen(this._fullscreen);
            };
            WebVideo.prototype.videoPlay = function () {
                this.userPause = false;
                if (this.waiting) {
                    this.userPlay = true;
                    return;
                }
                this.userPlay = false;
                this.video.play();
            };
            WebVideo.prototype.checkFullScreen = function (playFullScreen) {
                var video = this.video;
                if (playFullScreen) {
                    if (video.parentElement == null) {
                        video.removeAttribute("webkit-playsinline");
                        document.body.appendChild(video);
                    }
                    egret.stopTick(this.markDirty, this);
                    this.goFullscreen();
                }
                else {
                    if (video.parentElement != null) {
                        video.parentElement.removeChild(video);
                    }
                    video.setAttribute("webkit-playsinline", "true");
                    this.setFullScreenMonitor(false);
                    egret.startTick(this.markDirty, this);
                    if (egret.Capabilities.isMobile) {
                        this.video.currentTime = 0;
                        this.onVideoEnded();
                        return;
                    }
                }
                this.videoPlay();
            };
            WebVideo.prototype.goFullscreen = function () {
                var video = this.video;
                var fullscreenType;
                fullscreenType = egret.web.getPrefixStyleName('requestFullscreen', video);
                if (!video[fullscreenType]) {
                    fullscreenType = egret.web.getPrefixStyleName('requestFullScreen', video);
                    if (!video[fullscreenType]) {
                        return true;
                    }
                }
                video.removeAttribute("webkit-playsinline");
                video[fullscreenType]();
                this.setFullScreenMonitor(true);
                return true;
            };
            WebVideo.prototype.setFullScreenMonitor = function (use) {
                var video = this.video;
                if (use) {
                    video.addEventListener("mozfullscreenchange", this.screenChanged);
                    video.addEventListener("webkitfullscreenchange", this.screenChanged);
                    video.addEventListener("mozfullscreenerror", this.screenError);
                    video.addEventListener("webkitfullscreenerror", this.screenError);
                }
                else {
                    video.removeEventListener("mozfullscreenchange", this.screenChanged);
                    video.removeEventListener("webkitfullscreenchange", this.screenChanged);
                    video.removeEventListener("mozfullscreenerror", this.screenError);
                    video.removeEventListener("webkitfullscreenerror", this.screenError);
                }
            };
            WebVideo.prototype.screenError = function () {
                egret.$error(3014);
            };
            WebVideo.prototype.exitFullscreen = function () {
                //้ๅบๅจๅฑ
                if (document['exitFullscreen']) {
                    document['exitFullscreen']();
                }
                else if (document['msExitFullscreen']) {
                    document['msExitFullscreen']();
                }
                else if (document['mozCancelFullScreen']) {
                    document['mozCancelFullScreen']();
                }
                else if (document['oCancelFullScreen']) {
                    document['oCancelFullScreen']();
                }
                else if (document['webkitExitFullscreen']) {
                    document['webkitExitFullscreen']();
                }
                else {
                }
            };
            /**
             * @private
             *
             */
            WebVideo.prototype.onVideoEnded = function () {
                this.pause();
                this.isPlayed = false;
                this.$invalidateContentBounds();
                this.dispatchEventWith(egret.Event.ENDED);
            };
            /**
             * @private
             *
             */
            WebVideo.prototype.onVideoError = function () {
                this.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
            };
            /**
             * @inheritDoc
             */
            WebVideo.prototype.close = function () {
                var _this = this;
                this.closed = true;
                this.video.removeEventListener("canplay", this.onVideoLoaded);
                this.video.removeEventListener("error", function () { return _this.onVideoError(); });
                this.video.removeEventListener("ended", function () { return _this.onVideoEnded(); });
                this.pause();
                if (this.loaded == false && this.video)
                    this.video.src = "";
                if (this.video && this.video.parentElement) {
                    this.video.parentElement.removeChild(this.video);
                    this.video = null;
                }
                this.loaded = false;
            };
            /**
             * @inheritDoc
             */
            WebVideo.prototype.pause = function () {
                this.userPlay = false;
                if (this.waiting) {
                    this.userPause = true;
                    return;
                }
                this.userPause = false;
                egret.stopTick(this.markDirty, this);
                this.$invalidate();
            };
            Object.defineProperty(WebVideo.prototype, "volume", {
                /**
                 * @inheritDoc
                 */
                get: function () {
                    if (!this.video)
                        return 1;
                    return this.video.volume;
                },
                /**
                 * @inheritDoc
                 */
                set: function (value) {
                    if (!this.video)
                        return;
                    this.video.volume = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebVideo.prototype, "position", {
                /**
                 * @inheritDoc
                 */
                get: function () {
                    if (!this.video)
                        return 0;
                    return this.video.currentTime;
                },
                /**
                 * @inheritDoc
                 */
                set: function (value) {
                    if (!this.video)
                        return;
                    this.video.currentTime = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebVideo.prototype, "fullscreen", {
                /**
                 * @inheritDoc
                 */
                get: function () {
                    return this._fullscreen;
                },
                /**
                 * @inheritDoc
                 */
                set: function (value) {
                    if (egret.Capabilities.isMobile) {
                        return;
                    }
                    this._fullscreen = !!value;
                    if (this.video && this.video.paused == false) {
                        this.checkFullScreen(this._fullscreen);
                    }
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebVideo.prototype, "bitmapData", {
                /**
                 * @inheritDoc
                 */
                get: function () {
                    if (!this.video || !this.loaded)
                        return null;
                    if (!this._bitmapData) {
                        this.video.width = this.video.videoWidth;
                        this.video.height = this.video.videoHeight;
                        this._bitmapData = new egret.BitmapData(this.video);
                        this._bitmapData.$deleteSource = false;
                    }
                    return this._bitmapData;
                },
                enumerable: true,
                configurable: true
            });
            WebVideo.prototype.loadPoster = function () {
                var _this = this;
                var poster = this.poster;
                if (!poster)
                    return;
                var imageLoader = new egret.ImageLoader();
                imageLoader.once(egret.Event.COMPLETE, function (e) {
                    var posterData = imageLoader.data;
                    _this.posterData = imageLoader.data;
                    _this.posterData.width = _this.getPlayWidth();
                    _this.posterData.height = _this.getPlayHeight();
                    _this.$invalidateContentBounds();
                }, this);
                imageLoader.load(poster);
            };
            /**
             * @private
             */
            WebVideo.prototype.$measureContentBounds = function (bounds) {
                var bitmapData = this.bitmapData;
                var posterData = this.posterData;
                if (bitmapData) {
                    bounds.setTo(0, 0, this.getPlayWidth(), this.getPlayHeight());
                }
                else if (posterData) {
                    bounds.setTo(0, 0, this.getPlayWidth(), this.getPlayHeight());
                }
                else {
                    bounds.setEmpty();
                }
            };
            WebVideo.prototype.getPlayWidth = function () {
                if (!isNaN(this.widthSet)) {
                    return this.widthSet;
                }
                if (this.bitmapData) {
                    return this.bitmapData.width;
                }
                if (this.posterData) {
                    return this.posterData.width;
                }
                return NaN;
            };
            WebVideo.prototype.getPlayHeight = function () {
                if (!isNaN(this.heightSet)) {
                    return this.heightSet;
                }
                if (this.bitmapData) {
                    return this.bitmapData.height;
                }
                if (this.posterData) {
                    return this.posterData.height;
                }
                return NaN;
            };
            /**
             * @private
             */
            WebVideo.prototype.$render = function () {
                var node = this.$renderNode;
                var bitmapData = this.bitmapData;
                var posterData = this.posterData;
                var width = this.getPlayWidth();
                var height = this.getPlayHeight();
                if ((!this.isPlayed || egret.Capabilities.isMobile) && posterData) {
                    node.image = posterData;
                    node.imageWidth = width;
                    node.imageHeight = height;
                    node.drawImage(0, 0, posterData.width, posterData.height, 0, 0, width, height);
                }
                else if (this.isPlayed && bitmapData) {
                    node.image = bitmapData;
                    node.imageWidth = bitmapData.width;
                    node.imageHeight = bitmapData.height;
                    egret.WebGLUtils.deleteWebGLTexture(bitmapData.webGLTexture);
                    bitmapData.webGLTexture = null;
                    node.drawImage(0, 0, bitmapData.width, bitmapData.height, 0, 0, width, height);
                }
            };
            WebVideo.prototype.markDirty = function () {
                this.$invalidate();
                return true;
            };
            /**
             * @private
             * ่ฎพ็ฝฎๆพ็คบ้ซๅบฆ
             */
            WebVideo.prototype.$setHeight = function (value) {
                this.heightSet = +value || 0;
                this.$invalidate();
                this.$invalidateContentBounds();
                return _super.prototype.$setHeight.call(this, value);
            };
            /**
             * @private
             * ่ฎพ็ฝฎๆพ็คบๅฎฝๅบฆ
             */
            WebVideo.prototype.$setWidth = function (value) {
                this.widthSet = +value || 0;
                this.$invalidate();
                this.$invalidateContentBounds();
                return _super.prototype.$setWidth.call(this, value);
            };
            Object.defineProperty(WebVideo.prototype, "paused", {
                get: function () {
                    if (this.video) {
                        return this.video.paused;
                    }
                    return true;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebVideo.prototype, "length", {
                /**
                 * @inheritDoc
                 */
                get: function () {
                    if (this.video) {
                        return this.video.duration;
                    }
                    throw new Error("Video not loaded!");
                },
                enumerable: true,
                configurable: true
            });
            return WebVideo;
        }(egret.DisplayObject));
        web.WebVideo = WebVideo;
        __reflect(WebVideo.prototype, "egret.web.WebVideo", ["egret.Video", "egret.DisplayObject"]);
        egret.Video = WebVideo;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebHttpRequest = (function (_super) {
            __extends(WebHttpRequest, _super);
            /**
             * @private
             */
            function WebHttpRequest() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this._url = "";
                _this._method = "";
                return _this;
            }
            Object.defineProperty(WebHttpRequest.prototype, "response", {
                /**
                 * @private
                 * ๆฌๆฌก่ฏทๆฑ่ฟๅ็ๆฐๆฎ๏ผๆฐๆฎ็ฑปๅๆนๆฎresponseType่ฎพ็ฝฎ็ๅผ็กฎๅฎใ
                 */
                get: function () {
                    if (!this._xhr) {
                        return null;
                    }
                    if (this._xhr.response != undefined) {
                        return this._xhr.response;
                    }
                    if (this._responseType == "text") {
                        return this._xhr.responseText;
                    }
                    if (this._responseType == "arraybuffer" && /msie 9.0/i.test(navigator.userAgent)) {
                        var w = window;
                        return w.convertResponseBodyToText(this._xhr["responseBody"]);
                    }
                    if (this._responseType == "document") {
                        return this._xhr.responseXML;
                    }
                    /*if (this._xhr.responseXML) {
                        return this._xhr.responseXML;
                    }
                    if (this._xhr.responseText != undefined) {
                        return this._xhr.responseText;
                    }*/
                    return null;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebHttpRequest.prototype, "responseType", {
                /**
                 * @private
                 * ่ฎพ็ฝฎ่ฟๅ็ๆฐๆฎๆผๅผ๏ผ่ฏทไฝฟ็จ HttpResponseType ้ๅฎไน็ๆไธพๅผใ่ฎพ็ฝฎ้ๆณ็ๅผๆไธ่ฎพ็ฝฎ๏ผ้ฝๅฐไฝฟ็จHttpResponseType.TEXTใ
                 */
                get: function () {
                    return this._responseType;
                },
                set: function (value) {
                    this._responseType = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebHttpRequest.prototype, "withCredentials", {
                /**
                 * @private
                 * ่กจๆๅจ่ฟ่ก่ทจ็ซ(cross-site)็่ฎฟ้ฎๆงๅถ(Access-Control)่ฏทๆฑๆถ๏ผๆฏๅฆไฝฟ็จ่ฎค่ฏไฟกๆฏ(ไพๅฆcookieๆๆๆ็header)ใ ้ป่ฎคไธบ falseใ(่ฟไธชๆๅฟไธไผๅฝฑๅๅ็ซ็่ฏทๆฑ)
                 */
                get: function () {
                    return this._withCredentials;
                },
                set: function (value) {
                    this._withCredentials = value;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             *
             * @returns
             */
            WebHttpRequest.prototype.getXHR = function () {
                if (window["XMLHttpRequest"]) {
                    return new window["XMLHttpRequest"]();
                }
                else {
                    return new ActiveXObject("MSXML2.XMLHTTP");
                }
            };
            /**
             * @private
             * ๅๅงๅไธไธช่ฏทๆฑ.ๆณจๆ๏ผ่ฅๅจๅทฒ็ปๅๅบ่ฏทๆฑ็ๅฏน่ฑกไธ่ฐ็จๆญคๆนๆณ๏ผ็ธๅฝไบ็ซๅณ่ฐ็จabort().
             * @param url ่ฏฅ่ฏทๆฑๆ่ฆ่ฎฟ้ฎ็URL่ฏฅ่ฏทๆฑๆ่ฆ่ฎฟ้ฎ็URL
             * @param method ่ฏทๆฑๆไฝฟ็จ็HTTPๆนๆณ๏ผ ่ฏทไฝฟ็จ HttpMethod ๅฎไน็ๆไธพๅผ.
             */
            WebHttpRequest.prototype.open = function (url, method) {
                if (method === void 0) {
                    method = "GET";
                }
                this._url = url;
                this._method = method;
                if (this._xhr) {
                    this._xhr.abort();
                    this._xhr = null;
                }
                this._xhr = this.getXHR(); //new XMLHttpRequest();
                this._xhr.onreadystatechange = this.onReadyStateChange.bind(this);
                this._xhr.onprogress = this.updateProgress.bind(this);
                this._xhr.open(this._method, this._url, true);
            };
            /**
             * @private
             * ๅ้่ฏทๆฑ.
             * @param data ้่ฆๅ้็ๆฐๆฎ
             */
            WebHttpRequest.prototype.send = function (data) {
                if (this._responseType != null) {
                    this._xhr.responseType = this._responseType;
                }
                if (this._withCredentials != null) {
                    this._xhr.withCredentials = this._withCredentials;
                }
                if (this.headerObj) {
                    for (var key in this.headerObj) {
                        this._xhr.setRequestHeader(key, this.headerObj[key]);
                    }
                }
                this._xhr.send(data);
            };
            /**
             * @private
             * ๅฆๆ่ฏทๆฑๅทฒ็ป่ขซๅ้,ๅ็ซๅปไธญๆญข่ฏทๆฑ.
             */
            WebHttpRequest.prototype.abort = function () {
                if (this._xhr) {
                    this._xhr.abort();
                }
            };
            /**
             * @private
             * ่ฟๅๆๆๅๅบๅคดไฟกๆฏ(ๅๅบๅคดๅๅๅผ), ๅฆๆๅๅบๅคด่ฟๆฒกๆฅๅ,ๅ่ฟๅ"".
             */
            WebHttpRequest.prototype.getAllResponseHeaders = function () {
                if (!this._xhr) {
                    return null;
                }
                var result = this._xhr.getAllResponseHeaders();
                return result ? result : "";
            };
            /**
             * @private
             * ็ปๆๅฎ็HTTP่ฏทๆฑๅคด่ตๅผ.ๅจ่ฟไนๅ,ๆจๅฟ้กป็กฎ่ฎคๅทฒ็ป่ฐ็จ open() ๆนๆณๆๅผไบไธไธชurl.
             * @param header ๅฐ่ฆ่ขซ่ตๅผ็่ฏทๆฑๅคดๅ็งฐ.
             * @param value ็ปๆๅฎ็่ฏทๆฑๅคด่ต็ๅผ.
             */
            WebHttpRequest.prototype.setRequestHeader = function (header, value) {
                if (!this.headerObj) {
                    this.headerObj = {};
                }
                this.headerObj[header] = value;
            };
            /**
             * @private
             * ่ฟๅๆๅฎ็ๅๅบๅคด็ๅผ, ๅฆๆๅๅบๅคด่ฟๆฒก่ขซๆฅๅ,ๆ่ฏฅๅๅบๅคดไธๅญๅจ,ๅ่ฟๅ"".
             * @param header ่ฆ่ฟๅ็ๅๅบๅคดๅ็งฐ
             */
            WebHttpRequest.prototype.getResponseHeader = function (header) {
                if (!this._xhr) {
                    return null;
                }
                var result = this._xhr.getResponseHeader(header);
                return result ? result : "";
            };
            /**
             * @private
             */
            WebHttpRequest.prototype.onReadyStateChange = function () {
                var xhr = this._xhr;
                if (xhr.readyState == 4) {
                    var ioError_1 = (xhr.status >= 400 || xhr.status == 0);
                    var url_1 = this._url;
                    var self_1 = this;
                    window.setTimeout(function () {
                        if (ioError_1) {
                            if (true && !self_1.hasEventListener(egret.IOErrorEvent.IO_ERROR)) {
                                egret.$error(1011, url_1);
                            }
                            self_1.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
                        }
                        else {
                            self_1.dispatchEventWith(egret.Event.COMPLETE);
                        }
                    }, 0);
                }
            };
            /**
             * @private
             */
            WebHttpRequest.prototype.updateProgress = function (event) {
                if (event.lengthComputable) {
                    egret.ProgressEvent.dispatchProgressEvent(this, egret.ProgressEvent.PROGRESS, event.loaded, event.total);
                }
            };
            return WebHttpRequest;
        }(egret.EventDispatcher));
        web.WebHttpRequest = WebHttpRequest;
        __reflect(WebHttpRequest.prototype, "egret.web.WebHttpRequest", ["egret.HttpRequest"]);
        egret.HttpRequest = WebHttpRequest;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        var winURL = window["URL"] || window["webkitURL"];
        /**
         * @private
         * ImageLoader ็ฑปๅฏ็จไบๅ่ฝฝๅพๅ๏ผJPGใPNG ๆ GIF๏ผๆไปถใไฝฟ็จ load() ๆนๆณๆฅๅฏๅจๅ่ฝฝใ่ขซๅ่ฝฝ็ๅพๅๅฏน่ฑกๆฐๆฎๅฐๅญๅจๅจ ImageLoader.data ๅฑๆงไธ ใ
         */
        var WebImageLoader = (function (_super) {
            __extends(WebImageLoader, _super);
            function WebImageLoader() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 * ไฝฟ็จ load() ๆนๆณๅ่ฝฝๆๅ็ BitmapData ๅพๅๆฐๆฎใ
                 */
                _this.data = null;
                /**
                 * @private
                 * ๅฝไปๅถไป็ซ็นๅ่ฝฝไธไธชๅพ็ๆถ๏ผๆๅฎๆฏๅฆๅฏ็จ่ทจๅ่ตๆบๅฑไบซ(CORS)๏ผ้ป่ฎคๅผไธบnullใ
                 * ๅฏไปฅ่ฎพ็ฝฎไธบ"anonymous","use-credentials"ๆnull,่ฎพ็ฝฎไธบๅถไปๅผๅฐ็ญๅไบ"anonymous"ใ
                 */
                _this._crossOrigin = null;
                /**
                 * @private
                 * ๆ่ฎฐcrossOriginๆๆฒกๆ่ขซ่ฎพ็ฝฎ่ฟ,่ฎพ็ฝฎ่ฟไนๅไฝฟ็จ่ฎพ็ฝฎ็ๅฑๆง
                 */
                _this._hasCrossOriginSet = false;
                /**
                 * @private
                 */
                _this.currentImage = null;
                /**
                 * @private
                 */
                _this.request = null;
                return _this;
            }
            Object.defineProperty(WebImageLoader.prototype, "crossOrigin", {
                get: function () {
                    return this._crossOrigin;
                },
                set: function (value) {
                    this._hasCrossOriginSet = true;
                    this._crossOrigin = value;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             * ๅฏๅจไธๆฌกๅพๅๅ่ฝฝใๆณจๆ๏ผ่ฅไนๅๅทฒ็ป่ฐ็จ่ฟๅ่ฝฝ่ฏทๆฑ๏ผ้ๆฐ่ฐ็จ load() ๅฐ็ปๆญขๅๅ็่ฏทๆฑ๏ผๅนถๅผๅงๆฐ็ๅ่ฝฝใ
             * @param url ่ฆๅ่ฝฝ็ๅพๅๆไปถ็ๅฐๅใ
             */
            WebImageLoader.prototype.load = function (url) {
                if (web.Html5Capatibility._canUseBlob
                    && url.indexOf("wxLocalResource:") != 0 //ๅพฎไฟกไธ็จไธ่ฝไฝฟ็จ blob
                    && url.indexOf("data:") != 0
                    && url.indexOf("http:") != 0
                    && url.indexOf("https:") != 0) {
                    var request = this.request;
                    if (!request) {
                        request = this.request = new egret.web.WebHttpRequest();
                        request.addEventListener(egret.Event.COMPLETE, this.onBlobLoaded, this);
                        request.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onBlobError, this);
                        request.responseType = "blob";
                    }
                    if (true) {
                        this.currentURL = url;
                    }
                    request.open(url);
                    request.send();
                }
                else {
                    this.loadImage(url);
                }
            };
            /**
             * @private
             */
            WebImageLoader.prototype.onBlobLoaded = function (event) {
                var blob = this.request.response;
                this.request = undefined;
                this.loadImage(winURL.createObjectURL(blob));
            };
            /**
             * @private
             */
            WebImageLoader.prototype.onBlobError = function (event) {
                this.dispatchIOError(this.currentURL);
                this.request = undefined;
            };
            /**
             * @private
             */
            WebImageLoader.prototype.loadImage = function (src) {
                var image = new Image();
                this.data = null;
                this.currentImage = image;
                if (this._hasCrossOriginSet) {
                    if (this._crossOrigin) {
                        image.crossOrigin = this._crossOrigin;
                    }
                }
                else {
                    if (WebImageLoader.crossOrigin) {
                        image.crossOrigin = WebImageLoader.crossOrigin;
                    }
                }
                /*else {
                    if (image.hasAttribute("crossOrigin")) {//ๅผๅฎน็่ฑน
                        image.removeAttribute("crossOrigin");
                    }
                }*/
                image.onload = this.onImageComplete.bind(this);
                image.onerror = this.onLoadError.bind(this);
                image.src = src;
            };
            /**
             * @private
             */
            WebImageLoader.prototype.onImageComplete = function (event) {
                var image = this.getImage(event);
                if (!image) {
                    return;
                }
                this.data = new egret.BitmapData(image);
                var self = this;
                window.setTimeout(function () {
                    self.dispatchEventWith(egret.Event.COMPLETE);
                }, 0);
            };
            /**
             * @private
             */
            WebImageLoader.prototype.onLoadError = function (event) {
                var image = this.getImage(event);
                if (!image) {
                    return;
                }
                this.dispatchIOError(image.src);
            };
            WebImageLoader.prototype.dispatchIOError = function (url) {
                var self = this;
                window.setTimeout(function () {
                    if (true && !self.hasEventListener(egret.IOErrorEvent.IO_ERROR)) {
                        egret.$error(1011, url);
                    }
                    self.dispatchEventWith(egret.IOErrorEvent.IO_ERROR);
                }, 0);
            };
            /**
             * @private
             */
            WebImageLoader.prototype.getImage = function (event) {
                var image = event.target;
                var url = image.src;
                if (url.indexOf("blob:") == 0) {
                    try {
                        winURL.revokeObjectURL(image.src);
                    }
                    catch (e) {
                        egret.$warn(1037);
                    }
                }
                image.onerror = null;
                image.onload = null;
                if (this.currentImage !== image) {
                    return null;
                }
                this.currentImage = null;
                return image;
            };
            /**
             * @private
             * ๆๅฎๆฏๅฆๅฏ็จ่ทจๅ่ตๆบๅฑไบซ,ๅฆๆImageLoaderๅฎไพๆ่ฎพ็ฝฎ่ฟcrossOriginๅฑๆงๅฐไฝฟ็จ่ฎพ็ฝฎ็ๅฑๆง
             */
            WebImageLoader.crossOrigin = null;
            return WebImageLoader;
        }(egret.EventDispatcher));
        web.WebImageLoader = WebImageLoader;
        __reflect(WebImageLoader.prototype, "egret.web.WebImageLoader", ["egret.ImageLoader"]);
        egret.ImageLoader = WebImageLoader;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @classdesc
         * @extends egret.StageText
         * @private
         */
        var HTML5StageText = (function (_super) {
            __extends(HTML5StageText, _super);
            /**
             * @private
             */
            function HTML5StageText() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this._isNeedShow = false;
                /**
                 * @private
                 */
                _this.inputElement = null;
                /**
                 * @private
                 */
                _this.inputDiv = null;
                /**
                 * @private
                 */
                _this._gscaleX = 0;
                /**
                 * @private
                 */
                _this._gscaleY = 0;
                /**
                 * @private
                 */
                _this.textValue = "";
                /**
                 * @private
                 */
                _this.colorValue = 0xffffff;
                /**
                 * @private
                 */
                _this._styleInfoes = {};
                return _this;
            }
            /**
             * @private
             *
             * @param textfield
             */
            HTML5StageText.prototype.$setTextField = function (textfield) {
                this.$textfield = textfield;
                return true;
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.$addToStage = function () {
                this.htmlInput = egret.web.$getTextAdapter(this.$textfield);
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype._initElement = function () {
                var point = this.$textfield.localToGlobal(0, 0);
                var x = point.x;
                var y = point.y;
                // let m = this.$textfield.$renderNode.renderMatrix;
                // let cX = m.a;
                // let cY = m.d;
                var scaleX = this.htmlInput.$scaleX;
                var scaleY = this.htmlInput.$scaleY;
                this.inputDiv.style.left = x * scaleX + "px";
                this.inputDiv.style.top = y * scaleY + "px";
                if (this.$textfield.multiline && this.$textfield.height > this.$textfield.size) {
                    this.inputDiv.style.top = (y) * scaleY + "px";
                    this.inputElement.style.top = (-this.$textfield.lineSpacing / 2) * scaleY + "px";
                }
                else {
                    this.inputDiv.style.top = y * scaleY + "px";
                    this.inputElement.style.top = 0 + "px";
                }
                var node = this.$textfield;
                var cX = 1;
                var cY = 1;
                var rotation = 0;
                while (node.parent) {
                    cX *= node.scaleX;
                    cY *= node.scaleY;
                    rotation += node.rotation;
                    node = node.parent;
                }
                var transformKey = egret.web.getPrefixStyleName("transform");
                this.inputDiv.style[transformKey] = "rotate(" + rotation + "deg)";
                this._gscaleX = scaleX * cX;
                this._gscaleY = scaleY * cY;
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.$show = function () {
                if (!this.htmlInput.isCurrentStageText(this)) {
                    this.inputElement = this.htmlInput.getInputElement(this);
                    if (!this.$textfield.multiline) {
                        this.inputElement.type = this.$textfield.inputType;
                    }
                    else {
                        this.inputElement.type = "text";
                    }
                    this.inputDiv = this.htmlInput._inputDIV;
                }
                else {
                    this.inputElement.onblur = null;
                }
                this.htmlInput._needShow = true;
                //ๆ่ฎฐๅฝๅๆๆฌ่ขซ้ไธญ
                this._isNeedShow = true;
                this._initElement();
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.onBlurHandler = function () {
                this.htmlInput.clearInputElement();
                window.scrollTo(0, 0);
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.executeShow = function () {
                var self = this;
                //ๆๅผ
                this.inputElement.value = this.$getText();
                if (this.inputElement.onblur == null) {
                    this.inputElement.onblur = this.onBlurHandler.bind(this);
                }
                this.$resetStageText();
                if (this.$textfield.maxChars > 0) {
                    this.inputElement.setAttribute("maxlength", this.$textfield.maxChars);
                }
                else {
                    this.inputElement.removeAttribute("maxlength");
                }
                this.inputElement.selectionStart = this.inputElement.value.length;
                this.inputElement.selectionEnd = this.inputElement.value.length;
                this.inputElement.focus();
            };
            /**
             * @private
             */
            HTML5StageText.prototype.$hide = function () {
                if (this.htmlInput) {
                    this.htmlInput.disconnectStageText(this);
                }
            };
            /**
             * @private
             *
             * @returns
             */
            HTML5StageText.prototype.$getText = function () {
                if (!this.textValue) {
                    this.textValue = "";
                }
                return this.textValue;
            };
            /**
             * @private
             *
             * @param value
             */
            HTML5StageText.prototype.$setText = function (value) {
                this.textValue = value;
                this.resetText();
                return true;
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.resetText = function () {
                if (this.inputElement) {
                    this.inputElement.value = this.textValue;
                }
            };
            HTML5StageText.prototype.$setColor = function (value) {
                this.colorValue = value;
                this.resetColor();
                return true;
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.resetColor = function () {
                if (this.inputElement) {
                    this.setElementStyle("color", egret.toColorString(this.colorValue));
                }
            };
            HTML5StageText.prototype.$onBlur = function () {
                if (web.Html5Capatibility._System_OS == web.SystemOSType.WPHONE) {
                    egret.Event.dispatchEvent(this, "updateText", false);
                }
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype._onInput = function () {
                var self = this;
                if (web.Html5Capatibility._System_OS == web.SystemOSType.WPHONE) {
                    var values = this.$textfield.$TextField;
                    if (values[35 /* restrictAnd */] == null && values[36 /* restrictNot */] == null) {
                        self.textValue = self.inputElement.value;
                        egret.Event.dispatchEvent(self, "updateText", false);
                    }
                    else {
                        window.setTimeout(function () {
                            if (self.inputElement && self.inputElement.selectionStart && self.inputElement.selectionEnd) {
                                if (self.inputElement.selectionStart == self.inputElement.selectionEnd) {
                                    self.textValue = self.inputElement.value;
                                    egret.Event.dispatchEvent(self, "updateText", false);
                                }
                            }
                        }, 0);
                    }
                }
                else {
                    window.setTimeout(function () {
                        if (self.inputElement && self.inputElement.selectionStart == self.inputElement.selectionEnd) {
                            self.textValue = self.inputElement.value;
                            egret.Event.dispatchEvent(self, "updateText", false);
                        }
                    }, 0);
                }
            };
            HTML5StageText.prototype.setAreaHeight = function () {
                var textfield = this.$textfield;
                if (textfield.multiline) {
                    var textheight = egret.TextFieldUtils.$getTextHeight(textfield);
                    if (textfield.height <= textfield.size) {
                        this.setElementStyle("height", (textfield.size) * this._gscaleY + "px");
                        this.setElementStyle("padding", "0px");
                        this.setElementStyle("lineHeight", (textfield.size) * this._gscaleY + "px");
                    }
                    else if (textfield.height < textheight) {
                        this.setElementStyle("height", (textfield.height) * this._gscaleY + "px");
                        this.setElementStyle("padding", "0px");
                        this.setElementStyle("lineHeight", (textfield.size + textfield.lineSpacing) * this._gscaleY + "px");
                    }
                    else {
                        this.setElementStyle("height", (textheight + textfield.lineSpacing) * this._gscaleY + "px");
                        var rap = (textfield.height - textheight) * this._gscaleY;
                        var valign = egret.TextFieldUtils.$getValign(textfield);
                        var top_1 = rap * valign;
                        var bottom = rap - top_1;
                        this.setElementStyle("padding", top_1 + "px 0px " + bottom + "px 0px");
                        this.setElementStyle("lineHeight", (textfield.size + textfield.lineSpacing) * this._gscaleY + "px");
                    }
                }
            };
            /**
             * @private
             *
             * @param e
             */
            HTML5StageText.prototype._onClickHandler = function (e) {
                if (this._isNeedShow) {
                    e.stopImmediatePropagation();
                    //e.preventDefault();
                    this._isNeedShow = false;
                    this.executeShow();
                    this.dispatchEvent(new egret.Event("focus"));
                }
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype._onDisconnect = function () {
                this.inputElement = null;
                this.dispatchEvent(new egret.Event("blur"));
            };
            /**
             * @private
             *
             * @param style
             * @param value
             */
            HTML5StageText.prototype.setElementStyle = function (style, value) {
                if (this.inputElement) {
                    if (this._styleInfoes[style] != value) {
                        this.inputElement.style[style] = value;
                        //this._styleInfoes[style] = value;
                    }
                }
            };
            /**
             * @private
             *
             */
            HTML5StageText.prototype.$removeFromStage = function () {
                if (this.inputElement) {
                    this.htmlInput.disconnectStageText(this);
                }
            };
            /**
             * ไฟฎๆนไฝ็ฝฎ
             * @private
             */
            HTML5StageText.prototype.$resetStageText = function () {
                if (this.inputElement) {
                    var textfield = this.$textfield;
                    this.setElementStyle("fontFamily", textfield.fontFamily);
                    this.setElementStyle("fontStyle", textfield.italic ? "italic" : "normal");
                    this.setElementStyle("fontWeight", textfield.bold ? "bold" : "normal");
                    this.setElementStyle("textAlign", textfield.textAlign);
                    this.setElementStyle("fontSize", textfield.size * this._gscaleY + "px");
                    this.setElementStyle("color", egret.toColorString(textfield.textColor));
                    var tw = void 0;
                    if (textfield.stage) {
                        tw = textfield.localToGlobal(0, 0).x;
                        tw = Math.min(textfield.width, textfield.stage.stageWidth - tw);
                    }
                    else {
                        tw = textfield.width;
                    }
                    this.setElementStyle("width", tw * this._gscaleX + "px");
                    this.setElementStyle("verticalAlign", textfield.verticalAlign);
                    if (textfield.multiline) {
                        this.setAreaHeight();
                    }
                    else {
                        this.setElementStyle("lineHeight", (textfield.size) * this._gscaleY + "px");
                        if (textfield.height < textfield.size) {
                            this.setElementStyle("height", (textfield.size) * this._gscaleY + "px");
                            var bottom = (textfield.size / 2) * this._gscaleY;
                            this.setElementStyle("padding", "0px 0px " + bottom + "px 0px");
                        }
                        else {
                            this.setElementStyle("height", (textfield.size) * this._gscaleY + "px");
                            var rap = (textfield.height - textfield.size) * this._gscaleY;
                            var valign = egret.TextFieldUtils.$getValign(textfield);
                            var top_2 = rap * valign;
                            var bottom = rap - top_2;
                            if (bottom < textfield.size / 2 * this._gscaleY) {
                                bottom = textfield.size / 2 * this._gscaleY;
                            }
                            this.setElementStyle("padding", top_2 + "px 0px " + bottom + "px 0px");
                        }
                    }
                    this.inputDiv.style.clip = "rect(0px " + (textfield.width * this._gscaleX) + "px " + (textfield.height * this._gscaleY) + "px 0px)";
                    this.inputDiv.style.height = textfield.height * this._gscaleY + "px";
                    this.inputDiv.style.width = tw * this._gscaleX + "px";
                }
            };
            return HTML5StageText;
        }(egret.EventDispatcher));
        web.HTML5StageText = HTML5StageText;
        __reflect(HTML5StageText.prototype, "egret.web.HTML5StageText", ["egret.StageText"]);
        egret.StageText = HTML5StageText;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var HTMLInput = (function () {
            function HTMLInput() {
                /**
                 * @private
                 */
                this._needShow = false;
                /**
                 * @private
                 */
                this.$scaleX = 1;
                /**
                 * @private
                 */
                this.$scaleY = 1;
            }
            /**
             * @private
             *
             * @returns
             */
            HTMLInput.prototype.isInputOn = function () {
                return this._stageText != null;
            };
            /**
             * @private
             *
             * @param stageText
             * @returns
             */
            HTMLInput.prototype.isCurrentStageText = function (stageText) {
                return this._stageText == stageText;
            };
            /**
             * @private
             *
             * @param dom
             */
            HTMLInput.prototype.initValue = function (dom) {
                dom.style.position = "absolute";
                dom.style.left = "0px";
                dom.style.top = "0px";
                dom.style.border = "none";
                dom.style.padding = "0";
            };
            /**
             * @private
             *
             */
            HTMLInput.prototype.$updateSize = function () {
                if (!this.canvas) {
                    return;
                }
                var stageW = this.canvas.width;
                var stageH = this.canvas.height;
                var screenW = this.canvas.style.width.split("px")[0];
                var screenH = this.canvas.style.height.split("px")[0];
                this.$scaleX = screenW / stageW;
                this.$scaleY = screenH / stageH;
                this.StageDelegateDiv.style.left = this.canvas.style.left;
                this.StageDelegateDiv.style.top = this.canvas.style.top;
                var transformKey = egret.web.getPrefixStyleName("transform");
                this.StageDelegateDiv.style[transformKey] = this.canvas.style[transformKey];
                this.StageDelegateDiv.style[egret.web.getPrefixStyleName("transformOrigin")] = "0% 0% 0px";
            };
            /**
             * @private
             *
             * @param container
             * @param canvas
             * @returns
             */
            HTMLInput.prototype._initStageDelegateDiv = function (container, canvas) {
                this.canvas = canvas;
                var self = this;
                var stageDelegateDiv;
                if (!stageDelegateDiv) {
                    stageDelegateDiv = document.createElement("div");
                    this.StageDelegateDiv = stageDelegateDiv;
                    stageDelegateDiv.id = "StageDelegateDiv";
                    container.appendChild(stageDelegateDiv);
                    self.initValue(stageDelegateDiv);
                    self._inputDIV = document.createElement("div");
                    self.initValue(self._inputDIV);
                    self._inputDIV.style.width = "0px";
                    self._inputDIV.style.height = "0px";
                    self._inputDIV.style.left = 0 + "px";
                    self._inputDIV.style.top = "-100px";
                    self._inputDIV.style[egret.web.getPrefixStyleName("transformOrigin")] = "0% 0% 0px";
                    stageDelegateDiv.appendChild(self._inputDIV);
                    this.canvas.addEventListener("click", function (e) {
                        if (self._needShow) {
                            self._needShow = false;
                            self._stageText._onClickHandler(e);
                            self.show();
                        }
                        else {
                            if (self._inputElement) {
                                self.clearInputElement();
                                self._inputElement.blur();
                                self._inputElement = null;
                            }
                        }
                    });
                    self.initInputElement(true);
                    self.initInputElement(false);
                }
            };
            //ๅๅงๅ่พๅฅๆก
            HTMLInput.prototype.initInputElement = function (multiline) {
                var self = this;
                //ๅขๅ1ไธช็ฉบ็textarea
                var inputElement;
                if (multiline) {
                    inputElement = document.createElement("textarea");
                    inputElement.style["resize"] = "none";
                    self._multiElement = inputElement;
                    inputElement.id = "egretTextarea";
                }
                else {
                    inputElement = document.createElement("input");
                    self._simpleElement = inputElement;
                    inputElement.id = "egretInput";
                }
                inputElement.type = "text";
                self._inputDIV.appendChild(inputElement);
                inputElement.setAttribute("tabindex", "-1");
                inputElement.style.width = "1px";
                inputElement.style.height = "12px";
                self.initValue(inputElement);
                inputElement.style.outline = "thin";
                inputElement.style.background = "none";
                inputElement.style.overflow = "hidden";
                inputElement.style.wordBreak = "break-all";
                //้่่พๅฅๆก
                inputElement.style.opacity = 0;
                inputElement.oninput = function () {
                    if (self._stageText) {
                        self._stageText._onInput();
                    }
                };
            };
            /**
             * @private
             *
             */
            HTMLInput.prototype.show = function () {
                var self = this;
                var inputElement = self._inputElement;
                //้่่พๅฅๆก
                egret.$callAsync(function () {
                    inputElement.style.opacity = 1;
                }, self);
            };
            /**
             * @private
             *
             * @param stageText
             */
            HTMLInput.prototype.disconnectStageText = function (stageText) {
                if (this._stageText == null || this._stageText == stageText) {
                    this.clearInputElement();
                    if (this._inputElement) {
                        this._inputElement.blur();
                    }
                }
            };
            /**
             * @private
             *
             */
            HTMLInput.prototype.clearInputElement = function () {
                var self = this;
                if (self._inputElement) {
                    self._inputElement.value = "";
                    self._inputElement.onblur = null;
                    self._inputElement.style.width = "1px";
                    self._inputElement.style.height = "12px";
                    self._inputElement.style.left = "0px";
                    self._inputElement.style.top = "0px";
                    self._inputElement.style.opacity = 0;
                    var otherElement = void 0;
                    if (self._simpleElement == self._inputElement) {
                        otherElement = self._multiElement;
                    }
                    else {
                        otherElement = self._simpleElement;
                    }
                    otherElement.style.display = "block";
                    self._inputDIV.style.left = 0 + "px";
                    self._inputDIV.style.top = "-100px";
                    self._inputDIV.style.height = 0 + "px";
                    self._inputDIV.style.width = 0 + "px";
                }
                if (self._stageText) {
                    self._stageText._onDisconnect();
                    self._stageText = null;
                    this.canvas['userTyping'] = false;
                }
            };
            /**
             * @private
             *
             * @param stageText
             * @returns
             */
            HTMLInput.prototype.getInputElement = function (stageText) {
                var self = this;
                self.clearInputElement();
                self._stageText = stageText;
                this.canvas['userTyping'] = true;
                if (self._stageText.$textfield.multiline) {
                    self._inputElement = self._multiElement;
                }
                else {
                    self._inputElement = self._simpleElement;
                }
                var otherElement;
                if (self._simpleElement == self._inputElement) {
                    otherElement = self._multiElement;
                }
                else {
                    otherElement = self._simpleElement;
                }
                otherElement.style.display = "none";
                return self._inputElement;
            };
            return HTMLInput;
        }());
        web.HTMLInput = HTMLInput;
        __reflect(HTMLInput.prototype, "egret.web.HTMLInput");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
(function (egret) {
    var web;
    (function (web) {
        var stageToTextLayerMap = {};
        var stageToCanvasMap = {};
        var stageToContainerMap = {};
        /**
         * @private
         * ่ทๅ
         */
        function $getTextAdapter(textfield) {
            var stageHash = textfield.stage ? textfield.stage.$hashCode : 0;
            var adapter = stageToTextLayerMap[stageHash];
            var canvas = stageToCanvasMap[stageHash];
            var container = stageToContainerMap[stageHash];
            if (canvas && container) {
                //adapter._initStageDelegateDiv(container, canvas);
                //adapter.$updateSize();
                delete stageToCanvasMap[stageHash];
                delete stageToContainerMap[stageHash];
            }
            return adapter;
        }
        web.$getTextAdapter = $getTextAdapter;
        /**
         * @private
         */
        function $cacheTextAdapter(adapter, stage, container, canvas) {
            adapter._initStageDelegateDiv(container, canvas);
            stageToTextLayerMap[stage.$hashCode] = adapter;
            stageToCanvasMap[stage.$hashCode] = canvas;
            stageToContainerMap[stage.$hashCode] = container;
        }
        web.$cacheTextAdapter = $cacheTextAdapter;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var context = null;
        /**
         * @private
         */
        var fontCache = {};
        /**
         * ๆต้ๆๆฌๅจๆๅฎๆทๅผไธ็ๅฎฝๅบฆใ
         * @param text ่ฆๆต้็ๆๆฌๅๅฎนใ
         * @param fontFamily ๅญไฝๅ็งฐ
         * @param fontSize ๅญไฝๅคงๅฐ
         * @param bold ๆฏๅฆ็ฒไฝ
         * @param italic ๆฏๅฆๆไฝ
         */
        function measureText(text, fontFamily, fontSize, bold, italic) {
            if (!context) {
                createContext();
            }
            var font = "";
            if (italic)
                font += "italic ";
            if (bold)
                font += "bold ";
            font += (fontSize || 12) + "px ";
            font += (fontFamily || "Arial");
            context.font = font;
            return context.measureText(text).width;
        }
        /**
         * @private
         */
        function createContext() {
            context = egret.sys.canvasHitTestBuffer.context;
            context.textAlign = "left";
            context.textBaseline = "middle";
        }
        egret.sys.measureText = measureText;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * ๅๅปบไธไธชcanvasใ
         */
        function createCanvas(width, height) {
            var canvas = document.createElement("canvas");
            if (!isNaN(width) && !isNaN(height)) {
                canvas.width = width;
                canvas.height = height;
            }
            var context = canvas.getContext("2d");
            if (context["imageSmoothingEnabled"] === undefined) {
                var keys = ["webkitImageSmoothingEnabled", "mozImageSmoothingEnabled", "msImageSmoothingEnabled"];
                var key_1;
                for (var i = keys.length - 1; i >= 0; i--) {
                    key_1 = keys[i];
                    if (context[key_1] !== void 0) {
                        break;
                    }
                }
                try {
                    Object.defineProperty(context, "imageSmoothingEnabled", {
                        get: function () {
                            return this[key_1];
                        },
                        set: function (value) {
                            this[key_1] = value;
                        }
                    });
                }
                catch (e) {
                    context["imageSmoothingEnabled"] = context[key_1];
                }
            }
            return canvas;
        }
        var sharedCanvas;
        /**
         * @private
         * Canvas2Dๆธฒๆ็ผๅฒ
         */
        var CanvasRenderBuffer = (function () {
            function CanvasRenderBuffer(width, height, root) {
                this.surface = createCanvas(width, height);
                this.context = this.surface.getContext("2d");
            }
            Object.defineProperty(CanvasRenderBuffer.prototype, "width", {
                /**
                 * ๆธฒๆ็ผๅฒ็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝใ
                 * @readOnly
                 */
                get: function () {
                    return this.surface.width;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(CanvasRenderBuffer.prototype, "height", {
                /**
                 * ๆธฒๆ็ผๅฒ็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝใ
                 * @readOnly
                 */
                get: function () {
                    return this.surface.height;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * ๆนๅๆธฒๆ็ผๅฒ็ๅคงๅฐๅนถๆธ็ฉบ็ผๅฒๅบ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param useMaxSize ่ฅไผๅฅtrue๏ผๅๅฐๆนๅๅ็ๅฐบๅฏธไธๅทฒๆๅฐบๅฏธๅฏนๆฏ๏ผไฟ็่พๅคง็ๅฐบๅฏธใ
             */
            CanvasRenderBuffer.prototype.resize = function (width, height, useMaxSize) {
                var surface = this.surface;
                if (useMaxSize) {
                    var change = false;
                    if (surface.width < width) {
                        surface.width = width;
                        change = true;
                    }
                    if (surface.height < height) {
                        surface.height = height;
                        change = true;
                    }
                    //ๅฐบๅฏธๆฒกๆๅๅๆถ,ๅฐ็ปๅถๅฑๆง้็ฝฎ
                    if (!change) {
                        this.context.globalCompositeOperation = "source-over";
                        this.context.setTransform(1, 0, 0, 1, 0, 0);
                        this.context.globalAlpha = 1;
                    }
                }
                else {
                    if (surface.width != width) {
                        surface.width = width;
                    }
                    if (surface.height != height) {
                        surface.height = height;
                    }
                }
                this.clear();
            };
            /**
             * ๆนๅๆธฒๆ็ผๅฒไธบๆๅฎๅคงๅฐ๏ผไฝไฟ็ๅๅงๅพๅๆฐๆฎ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param offsetX ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎx
             * @param offsetY ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎy
             */
            CanvasRenderBuffer.prototype.resizeTo = function (width, height, offsetX, offsetY) {
                if (!sharedCanvas) {
                    sharedCanvas = createCanvas();
                }
                var oldContext = this.context;
                var oldSurface = this.surface;
                var newSurface = sharedCanvas;
                var newContext = newSurface.getContext("2d");
                sharedCanvas = oldSurface;
                this.context = newContext;
                this.surface = newSurface;
                newSurface.width = Math.max(width, 257);
                newSurface.height = Math.max(height, 257);
                newContext.setTransform(1, 0, 0, 1, 0, 0);
                newContext.drawImage(oldSurface, offsetX, offsetY);
                oldSurface.height = 1;
                oldSurface.width = 1;
            };
            CanvasRenderBuffer.prototype.setDirtyRegionPolicy = function (state) {
            };
            /**
             * ๆธ็ฉบๅนถ่ฎพ็ฝฎ่ฃๅ
             * @param regions ็ฉๅฝขๅ่กจ
             * @param offsetX ็ฉๅฝข่ฆๅไธ็ๅ็งป้x
             * @param offsetY ็ฉๅฝข่ฆๅไธ็ๅ็งป้y
             */
            CanvasRenderBuffer.prototype.beginClip = function (regions, offsetX, offsetY) {
                offsetX = +offsetX || 0;
                offsetY = +offsetY || 0;
                var pixelRatio = egret.sys.DisplayList.$pixelRatio;
                var context = this.context;
                context.save();
                context.beginPath();
                context.setTransform(1, 0, 0, 1, offsetX, offsetY);
                var length = regions.length;
                for (var i = 0; i < length; i++) {
                    var region = regions[i];
                    context.clearRect(region.minX * pixelRatio, region.minY * pixelRatio, region.width * pixelRatio, region.height * pixelRatio);
                    context.rect(region.minX * pixelRatio, region.minY * pixelRatio, region.width * pixelRatio, region.height * pixelRatio);
                }
                context.clip();
            };
            /**
             * ๅๆถไธไธๆฌก่ฎพ็ฝฎ็clipใ
             */
            CanvasRenderBuffer.prototype.endClip = function () {
                this.context.restore();
            };
            /**
             * ่ทๅๆๅฎๅบๅ็ๅ็ด
             */
            CanvasRenderBuffer.prototype.getPixels = function (x, y, width, height) {
                if (width === void 0) {
                    width = 1;
                }
                if (height === void 0) {
                    height = 1;
                }
                return this.context.getImageData(x, y, width, height).data;
            };
            /**
             * ่ฝฌๆขๆbase64ๅญ็ฌฆไธฒ๏ผๅฆๆๅพ็๏ผๆ่ๅๅซ็ๅพ็๏ผ่ทจๅ๏ผๅ่ฟๅnull
             * @param type ่ฝฌๆข็็ฑปๅ๏ผๅฆ: "image/png","image/jpeg"
             */
            CanvasRenderBuffer.prototype.toDataURL = function (type, encoderOptions) {
                return this.surface.toDataURL(type, encoderOptions);
            };
            /**
             * ๆธ็ฉบ็ผๅฒๅบๆฐๆฎ
             */
            CanvasRenderBuffer.prototype.clear = function () {
                this.context.setTransform(1, 0, 0, 1, 0, 0);
                this.context.clearRect(0, 0, this.surface.width, this.surface.height);
            };
            /**
             * ้ๆฏ็ปๅถๅฏน่ฑก
             */
            CanvasRenderBuffer.prototype.destroy = function () {
                this.surface.width = this.surface.height = 0;
            };
            return CanvasRenderBuffer;
        }());
        web.CanvasRenderBuffer = CanvasRenderBuffer;
        __reflect(CanvasRenderBuffer.prototype, "egret.web.CanvasRenderBuffer", ["egret.sys.RenderBuffer"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided this the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebTouchHandler = (function (_super) {
            __extends(WebTouchHandler, _super);
            /**
             * @private
             */
            function WebTouchHandler(stage, canvas) {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.onTouchBegin = function (event) {
                    var location = _this.getLocation(event);
                    _this.touch.onTouchBegin(location.x, location.y, event.identifier);
                };
                /**
                 * @private
                 */
                _this.onTouchMove = function (event) {
                    var location = _this.getLocation(event);
                    _this.touch.onTouchMove(location.x, location.y, event.identifier);
                };
                /**
                 * @private
                 */
                _this.onTouchEnd = function (event) {
                    var location = _this.getLocation(event);
                    _this.touch.onTouchEnd(location.x, location.y, event.identifier);
                };
                /**
                 * @private
                 */
                _this.scaleX = 1;
                /**
                 * @private
                 */
                _this.scaleY = 1;
                /**
                 * @private
                 */
                _this.rotation = 0;
                _this.canvas = canvas;
                _this.touch = new egret.sys.TouchHandler(stage);
                _this.addListeners();
                return _this;
            }
            /**
             * @private
             * ๆทปๅไบไปถ็ๅฌ
             */
            WebTouchHandler.prototype.addListeners = function () {
                var _this = this;
                if (window.navigator.msPointerEnabled) {
                    this.canvas.addEventListener("MSPointerDown", function (event) {
                        event.identifier = event.pointerId;
                        _this.onTouchBegin(event);
                        _this.prevent(event);
                    }, false);
                    this.canvas.addEventListener("MSPointerMove", function (event) {
                        event.identifier = event.pointerId;
                        _this.onTouchMove(event);
                        _this.prevent(event);
                    }, false);
                    this.canvas.addEventListener("MSPointerUp", function (event) {
                        event.identifier = event.pointerId;
                        _this.onTouchEnd(event);
                        _this.prevent(event);
                    }, false);
                }
                else {
                    if (!egret.Capabilities.$isMobile) {
                        this.addMouseListener();
                    }
                    this.addTouchListener();
                }
            };
            /**
             * @private
             *
             */
            WebTouchHandler.prototype.addMouseListener = function () {
                this.canvas.addEventListener("mousedown", this.onTouchBegin);
                this.canvas.addEventListener("mousemove", this.onTouchMove);
                this.canvas.addEventListener("mouseup", this.onTouchEnd);
            };
            /**
             * @private
             *
             */
            WebTouchHandler.prototype.addTouchListener = function () {
                var _this = this;
                this.canvas.addEventListener("touchstart", function (event) {
                    var l = event.changedTouches.length;
                    for (var i = 0; i < l; i++) {
                        _this.onTouchBegin(event.changedTouches[i]);
                    }
                    _this.prevent(event);
                }, false);
                this.canvas.addEventListener("touchmove", function (event) {
                    var l = event.changedTouches.length;
                    for (var i = 0; i < l; i++) {
                        _this.onTouchMove(event.changedTouches[i]);
                    }
                    _this.prevent(event);
                }, false);
                this.canvas.addEventListener("touchend", function (event) {
                    var l = event.changedTouches.length;
                    for (var i = 0; i < l; i++) {
                        _this.onTouchEnd(event.changedTouches[i]);
                    }
                    _this.prevent(event);
                }, false);
                this.canvas.addEventListener("touchcancel", function (event) {
                    var l = event.changedTouches.length;
                    for (var i = 0; i < l; i++) {
                        _this.onTouchEnd(event.changedTouches[i]);
                    }
                    _this.prevent(event);
                }, false);
            };
            /**
             * @private
             */
            WebTouchHandler.prototype.prevent = function (event) {
                event.stopPropagation();
                if (event["isScroll"] != true && !this.canvas['userTyping']) {
                    event.preventDefault();
                }
            };
            /**
             * @private
             */
            WebTouchHandler.prototype.getLocation = function (event) {
                event.identifier = +event.identifier || 0;
                var doc = document.documentElement;
                var box = this.canvas.getBoundingClientRect();
                var left = box.left + window.pageXOffset - doc.clientLeft;
                var top = box.top + window.pageYOffset - doc.clientTop;
                var x = event.pageX - left, newx = x;
                var y = event.pageY - top, newy = y;
                if (this.rotation == 90) {
                    newx = y;
                    newy = box.width - x;
                }
                else if (this.rotation == -90) {
                    newx = box.height - y;
                    newy = x;
                }
                newx = newx / this.scaleX;
                newy = newy / this.scaleY;
                return egret.$TempPoint.setTo(Math.round(newx), Math.round(newy));
            };
            /**
             * @private
             * ๆดๆฐๅฑๅนๅฝๅ็็ผฉๆพๆฏไพ๏ผ็จไบ่ฎก็ฎๅ็กฎ็็นๅปไฝ็ฝฎใ
             * @param scaleX ๆฐดๅนณๆนๅ็็ผฉๆพๆฏไพใ
             * @param scaleY ๅ็ดๆนๅ็็ผฉๆพๆฏไพใ
             */
            WebTouchHandler.prototype.updateScaleMode = function (scaleX, scaleY, rotation) {
                this.scaleX = scaleX;
                this.scaleY = scaleY;
                this.rotation = rotation;
            };
            /**
             * @private
             * ๆดๆฐๅๆถ่งฆๆธ็น็ๆฐ้
             */
            WebTouchHandler.prototype.$updateMaxTouches = function () {
                this.touch.$initMaxTouches();
            };
            return WebTouchHandler;
        }(egret.HashObject));
        web.WebTouchHandler = WebTouchHandler;
        __reflect(WebTouchHandler.prototype, "egret.web.WebTouchHandler");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        web.WebLifeCycleHandler = function (context) {
            var handleVisibilityChange = function () {
                if (!document[hidden]) {
                    context.resume();
                }
                else {
                    context.pause();
                }
            };
            window.addEventListener("focus", context.resume, false);
            window.addEventListener("blur", context.pause, false);
            var hidden, visibilityChange;
            if (typeof document.hidden !== "undefined") {
                hidden = "hidden";
                visibilityChange = "visibilitychange";
            }
            else if (typeof document["mozHidden"] !== "undefined") {
                hidden = "mozHidden";
                visibilityChange = "mozvisibilitychange";
            }
            else if (typeof document["msHidden"] !== "undefined") {
                hidden = "msHidden";
                visibilityChange = "msvisibilitychange";
            }
            else if (typeof document["webkitHidden"] !== "undefined") {
                hidden = "webkitHidden";
                visibilityChange = "webkitvisibilitychange";
            }
            else if (typeof document["oHidden"] !== "undefined") {
                hidden = "oHidden";
                visibilityChange = "ovisibilitychange";
            }
            if ("onpageshow" in window && "onpagehide" in window) {
                window.addEventListener("pageshow", context.resume, false);
                window.addEventListener("pagehide", context.pause, false);
            }
            if (hidden && visibilityChange) {
                document.addEventListener(visibilityChange, handleVisibilityChange, false);
            }
            var ua = navigator.userAgent;
            var isWX = /micromessenger/gi.test(ua);
            var isQQBrowser = /mqq/ig.test(ua);
            var isQQ = /mobile.*qq/gi.test(ua);
            if (isQQ || isWX) {
                isQQBrowser = false;
            }
            if (isQQBrowser) {
                var browser = window["browser"] || {};
                browser.execWebFn = browser.execWebFn || {};
                browser.execWebFn.postX5GamePlayerMessage = function (event) {
                    var eventType = event.type;
                    if (eventType == "app_enter_background") {
                        context.pause();
                    }
                    else if (eventType == "app_enter_foreground") {
                        context.resume();
                    }
                };
                window["browser"] = browser;
            }
        };
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var AudioType = (function () {
            function AudioType() {
            }
            /**
             * @private
             */
            AudioType.WEB_AUDIO = 2;
            /**
             * @private
             */
            AudioType.HTML5_AUDIO = 3;
            return AudioType;
        }());
        web.AudioType = AudioType;
        __reflect(AudioType.prototype, "egret.web.AudioType");
        /**
         * @private
         */
        var SystemOSType = (function () {
            function SystemOSType() {
            }
            /**
             * @private
             */
            SystemOSType.WPHONE = 1;
            /**
             * @private
             */
            SystemOSType.IOS = 2;
            /**
             * @private
             */
            SystemOSType.ADNROID = 3;
            return SystemOSType;
        }());
        web.SystemOSType = SystemOSType;
        __reflect(SystemOSType.prototype, "egret.web.SystemOSType");
        /**
         * html5ๅผๅฎนๆง้็ฝฎ
         * @private
         */
        var Html5Capatibility = (function (_super) {
            __extends(Html5Capatibility, _super);
            /**
             * @private
             */
            function Html5Capatibility() {
                return _super.call(this) || this;
            }
            /**
             * @private
             *
             */
            Html5Capatibility.$init = function () {
                var ua = navigator.userAgent.toLowerCase();
                Html5Capatibility.ua = ua;
                egret.Capabilities.$isMobile = (ua.indexOf('mobile') != -1 || ua.indexOf('android') != -1);
                Html5Capatibility._canUseBlob = false;
                var canUseWebAudio = window["AudioContext"] || window["webkitAudioContext"] || window["mozAudioContext"];
                if (canUseWebAudio) {
                    try {
                        //้ฒๆญขๆไบchrome็ๆฌๅๅปบๅผๅธธ้ฎ้ข
                        web.WebAudioDecode.ctx = new (window["AudioContext"] || window["webkitAudioContext"] || window["mozAudioContext"])();
                    }
                    catch (e) {
                        canUseWebAudio = false;
                    }
                }
                var audioType = Html5Capatibility._audioType;
                var checkAudioType;
                if ((audioType == AudioType.WEB_AUDIO && canUseWebAudio) || audioType == AudioType.HTML5_AUDIO) {
                    checkAudioType = false;
                    Html5Capatibility.setAudioType(audioType);
                }
                else {
                    checkAudioType = true;
                    Html5Capatibility.setAudioType(AudioType.HTML5_AUDIO);
                }
                if (ua.indexOf("windows phone") >= 0) {
                    Html5Capatibility._System_OS = SystemOSType.WPHONE;
                    egret.Capabilities.$os = "Windows Phone";
                }
                else if (ua.indexOf("android") >= 0) {
                    egret.Capabilities.$os = "Android";
                    Html5Capatibility._System_OS = SystemOSType.ADNROID;
                    if (checkAudioType && canUseWebAudio) {
                        Html5Capatibility.setAudioType(AudioType.WEB_AUDIO);
                    }
                }
                else if (ua.indexOf("iphone") >= 0 || ua.indexOf("ipad") >= 0 || ua.indexOf("ipod") >= 0) {
                    egret.Capabilities.$os = "iOS";
                    Html5Capatibility._System_OS = SystemOSType.IOS;
                    if (Html5Capatibility.getIOSVersion() >= 7) {
                        Html5Capatibility._canUseBlob = true;
                        if (checkAudioType && canUseWebAudio) {
                            Html5Capatibility.setAudioType(AudioType.WEB_AUDIO);
                        }
                    }
                }
                else {
                    if (ua.indexOf("windows nt") != -1) {
                        egret.Capabilities.$os = "Windows PC";
                    }
                    else if (ua.indexOf("mac os") != -1) {
                        egret.Capabilities.$os = "Mac OS";
                    }
                }
                var winURL = window["URL"] || window["webkitURL"];
                if (!winURL) {
                    Html5Capatibility._canUseBlob = false;
                }
                if (ua.indexOf("egretnative") >= 0) {
                    Html5Capatibility.setAudioType(AudioType.HTML5_AUDIO);
                    Html5Capatibility._canUseBlob = true;
                }
                egret.Sound = Html5Capatibility._AudioClass;
            };
            Html5Capatibility.setAudioType = function (type) {
                Html5Capatibility._audioType = type;
                switch (type) {
                    case AudioType.WEB_AUDIO:
                        Html5Capatibility._AudioClass = egret.web.WebAudioSound;
                        break;
                    case AudioType.HTML5_AUDIO:
                        Html5Capatibility._AudioClass = egret.web.HtmlSound;
                        break;
                }
            };
            /**
             * @private
             * ่ทๅios็ๆฌ
             * @returns {string}
             */
            Html5Capatibility.getIOSVersion = function () {
                var value = Html5Capatibility.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];
                return parseInt(value.match(/\d+(_\d)*/)[0]) || 0;
            };
            /**
             * @private
             *
             */
            Html5Capatibility.checkHtml5Support = function () {
                var language = (navigator.language || navigator["browserLanguage"]).toLowerCase();
                var strings = language.split("-");
                if (strings.length > 1) {
                    strings[1] = strings[1].toUpperCase();
                }
                egret.Capabilities.$language = strings.join("-");
            };
            //ๅฝๅๆต่งๅจ็ๆฌๆฏๅฆๆฏๆblob
            Html5Capatibility._canUseBlob = false;
            //ๅฝๅๆต่งๅจ็ๆฌๆฏๅฆๆฏๆwebaudio
            Html5Capatibility._audioType = 0;
            /**
             * @private
             */
            Html5Capatibility._System_OS = 0;
            /**
             * @private
             */
            Html5Capatibility.ua = "";
            return Html5Capatibility;
        }(egret.HashObject));
        web.Html5Capatibility = Html5Capatibility;
        __reflect(Html5Capatibility.prototype, "egret.web.Html5Capatibility");
        /**
         * @private
         */
        var currentPrefix = null;
        /**
         * @private
         */
        function getPrefixStyleName(name, element) {
            var header = "";
            if (element != null) {
                header = getPrefix(name, element);
            }
            else {
                if (currentPrefix == null) {
                    var tempStyle = document.createElement('div').style;
                    currentPrefix = getPrefix("transform", tempStyle);
                }
                header = currentPrefix;
            }
            if (header == "") {
                return name;
            }
            return header + name.charAt(0).toUpperCase() + name.substring(1, name.length);
        }
        web.getPrefixStyleName = getPrefixStyleName;
        /**
         * @private
         */
        function getPrefix(name, element) {
            if (name in element) {
                return "";
            }
            name = name.charAt(0).toUpperCase() + name.substring(1, name.length);
            var transArr = ["webkit", "ms", "Moz", "O"];
            for (var i = 0; i < transArr.length; i++) {
                var tempStyle = transArr[i] + name;
                if (tempStyle in element) {
                    return transArr[i];
                }
            }
            return "";
        }
        web.getPrefix = getPrefix;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        var customContext;
        var context = {
            setAutoClear: function (value) {
                web.WebGLRenderBuffer.autoClear = value;
            },
            save: function () {
                // do nothing
            },
            restore: function () {
                var context = web.WebGLRenderContext.getInstance(0, 0);
                var gl = context.context;
                gl.bindBuffer(gl.ARRAY_BUFFER, context["vertexBuffer"]);
                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, context["indexBuffer"]);
                gl.activeTexture(gl.TEXTURE0);
                context.currentProgram = null;
                context["bindIndices"] = false;
                var buffer = context.$bufferStack[1];
                context["activateBuffer"](buffer);
                gl.enable(gl.BLEND);
                context["setBlendMode"]("source-over");
            }
        };
        function setRendererContext(custom) {
            custom.onStart(context);
            customContext = custom;
        }
        egret.setRendererContext = setRendererContext;
        /**
         * @private
         * ๅทๆฐๆๆEgretๆญๆพๅจ็ๆพ็คบๅบๅๅฐบๅฏธใไปๅฝไฝฟ็จๅค้จJavaScriptไปฃ็ๅจๆไฟฎๆนไบEgretๅฎนๅจๅคงๅฐๆถ๏ผ้่ฆๆๅจ่ฐ็จๆญคๆนๆณๅทๆฐๆพ็คบๅบๅใ
         * ๅฝ็ฝ้กตๅฐบๅฏธๅ็ๆนๅๆถๆญคๆนๆณไผ่ชๅจ่ขซ่ฐ็จใ
         */
        function updateAllScreens() {
            if (!isRunning) {
                return;
            }
            var containerList = document.querySelectorAll(".egret-player");
            var length = containerList.length;
            for (var i = 0; i < length; i++) {
                var container = containerList[i];
                var player = container["egret-player"];
                player.updateScreenSize();
            }
        }
        var isRunning = false;
        /**
         * @private
         * ็ฝ้กตๅ่ฝฝๅฎๆ๏ผๅฎไพๅ้กต้ขไธญๅฎไน็Egretๆ็ญพ
         */
        function runEgret(options) {
            if (isRunning) {
                return;
            }
            isRunning = true;
            if (!options) {
                options = {};
            }
            web.Html5Capatibility._audioType = options.audioType;
            web.Html5Capatibility.$init();
            // WebGLไธไธๆๅๆฐ่ชๅฎไน
            if (options.renderMode == "webgl") {
                // WebGLๆ้ฏ้ฝฟ้ป่ฎคๅณ้ญ๏ผๆๅPCๅๆไบๅนณๅฐๆง่ฝ
                var antialias = options.antialias;
                web.WebGLRenderContext.antialias = !!antialias;
                // WebGLRenderContext.antialias = (typeof antialias == undefined) ? true : antialias;
            }
            egret.sys.CanvasRenderBuffer = web.CanvasRenderBuffer;
            setRenderMode(options.renderMode);
            if (options.retina) {
                //based on : https://github.com/jondavidjohn/hidpi-canvas-polyfill
                var context_1 = egret.sys.canvasHitTestBuffer.context;
                var backingStore = context_1.backingStorePixelRatio ||
                    context_1.webkitBackingStorePixelRatio ||
                    context_1.mozBackingStorePixelRatio ||
                    context_1.msBackingStorePixelRatio ||
                    context_1.oBackingStorePixelRatio ||
                    context_1.backingStorePixelRatio || 1;
                egret.sys.DisplayList.$setDevicePixelRatio((window.devicePixelRatio || 1) / backingStore);
            }
            var ticker = egret.ticker;
            startTicker(ticker);
            if (options.screenAdapter) {
                egret.sys.screenAdapter = options.screenAdapter;
            }
            else if (!egret.sys.screenAdapter) {
                egret.sys.screenAdapter = new egret.sys.DefaultScreenAdapter();
            }
            var list = document.querySelectorAll(".egret-player");
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var container = list[i];
                var player = new web.WebPlayer(container, options);
                container["egret-player"] = player;
                //webglๆจกๅผๅณ้ญ่็ฉๅฝข
                if (egret.Capabilities.$renderMode == "webgl") {
                    player.stage.dirtyRegionPolicy = egret.DirtyRegionPolicy.OFF;
                }
            }
            if (egret.Capabilities.$renderMode == "webgl") {
                egret.sys.DisplayList.prototype.setDirtyRegionPolicy = function () { };
            }
            window.addEventListener("resize", function () {
                if (isNaN(resizeTimer)) {
                    resizeTimer = window.setTimeout(doResize, 300);
                }
            });
        }
        /**
         * ่ฎพ็ฝฎๆธฒๆๆจกๅผใ"auto","webgl","canvas"
         * @param renderMode
         */
        function setRenderMode(renderMode) {
            if (renderMode == "webgl" && egret.WebGLUtils.checkCanUseWebGL()) {
                egret.sys.RenderBuffer = web.WebGLRenderBuffer;
                egret.sys.systemRenderer = new web.WebGLRenderer();
                egret.sys.canvasRenderer = new egret.CanvasRenderer();
                egret.sys.customHitTestBuffer = new web.WebGLRenderBuffer(3, 3);
                egret.sys.canvasHitTestBuffer = new web.CanvasRenderBuffer(3, 3);
                egret.Capabilities.$renderMode = "webgl";
            }
            else {
                egret.sys.RenderBuffer = web.CanvasRenderBuffer;
                egret.sys.systemRenderer = new egret.CanvasRenderer();
                egret.sys.canvasRenderer = egret.sys.systemRenderer;
                egret.sys.customHitTestBuffer = new web.CanvasRenderBuffer(3, 3);
                egret.sys.canvasHitTestBuffer = egret.sys.customHitTestBuffer;
                egret.Capabilities.$renderMode = "canvas";
            }
        }
        /**
         * @private
         * ๅฏๅจๅฟ่ทณ่ฎกๆถๅจใ
         */
        function startTicker(ticker) {
            var requestAnimationFrame = window["requestAnimationFrame"] ||
                window["webkitRequestAnimationFrame"] ||
                window["mozRequestAnimationFrame"] ||
                window["oRequestAnimationFrame"] ||
                window["msRequestAnimationFrame"];
            if (!requestAnimationFrame) {
                requestAnimationFrame = function (callback) {
                    return window.setTimeout(callback, 1000 / 60);
                };
            }
            requestAnimationFrame(onTick);
            function onTick() {
                if (customContext) {
                    customContext.onRender(context);
                }
                ticker.update();
                requestAnimationFrame(onTick);
            }
        }
        //่ฆ็ๅ็็isNaN()ๆนๆณๅฎ็ฐ๏ผๅจไธๅๆต่งๅจไธๆ2~10ๅๆง่ฝๆๅใ
        window["isNaN"] = function (value) {
            value = +value;
            return value !== value;
        };
        egret.runEgret = runEgret;
        egret.updateAllScreens = updateAllScreens;
        var resizeTimer = NaN;
        function doResize() {
            resizeTimer = NaN;
            egret.updateAllScreens();
            if (customContext) {
                customContext.onResize(context);
            }
        }
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
if (true) {
    var language = navigator.language || navigator["browserLanguage"] || "en_US";
    language = language.replace("-", "_");
    if (language in egret.$locale_strings)
        egret.$language = language;
}
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebCapability = (function () {
            function WebCapability() {
            }
            /**
             * @private
             * ๆฃๆต็ณป็ปๅฑๆง
             */
            WebCapability.detect = function () {
                var capabilities = egret.Capabilities;
                var ua = navigator.userAgent.toLowerCase();
                capabilities.$isMobile = (ua.indexOf('mobile') != -1 || ua.indexOf('android') != -1);
                if (capabilities.$isMobile) {
                    if (ua.indexOf("windows") < 0 && (ua.indexOf("iphone") != -1 || ua.indexOf("ipad") != -1 || ua.indexOf("ipod") != -1)) {
                        capabilities.$os = "iOS";
                    }
                    else if (ua.indexOf("android") != -1 && ua.indexOf("linux") != -1) {
                        capabilities.$os = "Android";
                    }
                    else if (ua.indexOf("windows") != -1) {
                        capabilities.$os = "Windows Phone";
                    }
                }
                else {
                    if (ua.indexOf("windows nt") != -1) {
                        capabilities.$os = "Windows PC";
                    }
                    else if (ua.indexOf("mac os") != -1) {
                        capabilities.$os = "Mac OS";
                    }
                }
                var language = (navigator.language || navigator["browserLanguage"]).toLowerCase();
                var strings = language.split("-");
                if (strings.length > 1) {
                    strings[1] = strings[1].toUpperCase();
                }
                capabilities.$language = strings.join("-");
                WebCapability.injectUIntFixOnIE9();
            };
            WebCapability.injectUIntFixOnIE9 = function () {
                if (/msie 9.0/i.test(navigator.userAgent) && !/opera/i.test(navigator.userAgent)) {
                    var IEBinaryToArray_ByteStr_Script = "<!-- IEBinaryToArray_ByteStr -->\r\n" +
                        "<script type='text/vbscript' language='VBScript'>\r\n" +
                        "Function IEBinaryToArray_ByteStr(Binary)\r\n" +
                        "   IEBinaryToArray_ByteStr = CStr(Binary)\r\n" +
                        "End Function\r\n" +
                        "Function IEBinaryToArray_ByteStr_Last(Binary)\r\n" +
                        "   Dim lastIndex\r\n" +
                        "   lastIndex = LenB(Binary)\r\n" +
                        "   if lastIndex mod 2 Then\r\n" +
                        "       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n" +
                        "   Else\r\n" +
                        "       IEBinaryToArray_ByteStr_Last = " + '""' + "\r\n" +
                        "   End If\r\n" +
                        "End Function\r\n" + "<\/script>\r\n" +
                        "<!-- convertResponseBodyToText -->\r\n" +
                        "<script>\r\n" +
                        "let convertResponseBodyToText = function (binary) {\r\n" +
                        "   let byteMapping = {};\r\n" +
                        "   for ( let i = 0; i < 256; i++ ) {\r\n" +
                        "       for ( let j = 0; j < 256; j++ ) {\r\n" +
                        "           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n" +
                        "           String.fromCharCode(i) + String.fromCharCode(j);\r\n" +
                        "       }\r\n" +
                        "   }\r\n" +
                        "   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n" +
                        "   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n" +
                        "   return rawBytes.replace(/[\\s\\S]/g," +
                        "                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n" +
                        "};\r\n" +
                        "<\/script>\r\n";
                    document.write(IEBinaryToArray_ByteStr_Script);
                }
            };
            return WebCapability;
        }());
        web.WebCapability = WebCapability;
        __reflect(WebCapability.prototype, "egret.web.WebCapability");
        WebCapability.detect();
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebExternalInterface = (function () {
            function WebExternalInterface() {
            }
            /**
             * @private
             * @param functionName
             * @param value
             */
            WebExternalInterface.call = function (functionName, value) {
            };
            /**
             * @private
             * @param functionName
             * @param listener
             */
            WebExternalInterface.addCallback = function (functionName, listener) {
            };
            return WebExternalInterface;
        }());
        web.WebExternalInterface = WebExternalInterface;
        __reflect(WebExternalInterface.prototype, "egret.web.WebExternalInterface", ["egret.ExternalInterface"]);
        var ua = navigator.userAgent.toLowerCase();
        if (ua.indexOf("egretnative") < 0) {
            egret.ExternalInterface = WebExternalInterface;
        }
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
(function (egret) {
    var web;
    (function (web) {
        var callBackDic = {};
        /**
         * @private
         */
        var NativeExternalInterface = (function () {
            function NativeExternalInterface() {
            }
            NativeExternalInterface.call = function (functionName, value) {
                var data = {};
                data.functionName = functionName;
                data.value = value;
                egret_native.sendInfoToPlugin(JSON.stringify(data));
            };
            NativeExternalInterface.addCallback = function (functionName, listener) {
                callBackDic[functionName] = listener;
            };
            return NativeExternalInterface;
        }());
        web.NativeExternalInterface = NativeExternalInterface;
        __reflect(NativeExternalInterface.prototype, "egret.web.NativeExternalInterface", ["egret.ExternalInterface"]);
        /**
         * @private
         * @param info
         */
        function onReceivedPluginInfo(info) {
            var data = JSON.parse(info);
            var functionName = data.functionName;
            var listener = callBackDic[functionName];
            if (listener) {
                var value = data.value;
                listener.call(null, value);
            }
            else {
                egret.$warn(1050, functionName);
            }
        }
        var ua = navigator.userAgent.toLowerCase();
        if (ua.indexOf("egretnative") >= 0) {
            egret.ExternalInterface = NativeExternalInterface;
            egret_native.receivedPluginInfo = onReceivedPluginInfo;
        }
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        function getOption(key) {
            if (window.location) {
                var search = location.search;
                if (search == "") {
                    return "";
                }
                search = search.slice(1);
                var searchArr = search.split("&");
                var length_1 = searchArr.length;
                for (var i = 0; i < length_1; i++) {
                    var str = searchArr[i];
                    var arr = str.split("=");
                    if (arr[0] == key) {
                        return arr[1];
                    }
                }
            }
            return "";
        }
        web.getOption = getOption;
        egret.getOption = getOption;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebPlayer = (function (_super) {
            __extends(WebPlayer, _super);
            function WebPlayer(container, options) {
                var _this = _super.call(this) || this;
                _this.init(container, options);
                _this.initOrientation();
                return _this;
            }
            WebPlayer.prototype.init = function (container, options) {
                var option = this.readOption(container, options);
                var stage = new egret.Stage();
                stage.$screen = this;
                stage.$scaleMode = option.scaleMode;
                stage.$orientation = option.orientation;
                stage.$maxTouches = option.maxTouches;
                stage.frameRate = option.frameRate;
                stage.textureScaleFactor = option.textureScaleFactor;
                var buffer = new egret.sys.RenderBuffer(undefined, undefined, true);
                var canvas = buffer.surface;
                this.attachCanvas(container, canvas);
                var webTouch = new web.WebTouchHandler(stage, canvas);
                var player = new egret.sys.Player(buffer, stage, option.entryClassName);
                egret.lifecycle.stage = stage;
                egret.lifecycle.addLifecycleListener(web.WebLifeCycleHandler);
                var webInput = new web.HTMLInput();
                player.showPaintRect(option.showPaintRect);
                if (option.showFPS || option.showLog) {
                    player.displayFPS(option.showFPS, option.showLog, option.logFilter, option.fpsStyles);
                }
                this.playerOption = option;
                this.container = container;
                this.canvas = canvas;
                this.stage = stage;
                this.player = player;
                this.webTouchHandler = webTouch;
                this.webInput = webInput;
                egret.web.$cacheTextAdapter(webInput, stage, container, canvas);
                this.updateScreenSize();
                this.updateMaxTouches();
                player.start();
            };
            WebPlayer.prototype.initOrientation = function () {
                var self = this;
                window.addEventListener("orientationchange", function () {
                    window.setTimeout(function () {
                        egret.StageOrientationEvent.dispatchStageOrientationEvent(self.stage, egret.StageOrientationEvent.ORIENTATION_CHANGE);
                    }, 350);
                });
            };
            /**
             * ่ฏปๅๅๅงๅๅๆฐ
             */
            WebPlayer.prototype.readOption = function (container, options) {
                var option = {};
                option.entryClassName = container.getAttribute("data-entry-class");
                option.scaleMode = container.getAttribute("data-scale-mode") || egret.StageScaleMode.NO_SCALE;
                option.frameRate = +container.getAttribute("data-frame-rate") || 30;
                option.contentWidth = +container.getAttribute("data-content-width") || 480;
                option.contentHeight = +container.getAttribute("data-content-height") || 800;
                option.orientation = container.getAttribute("data-orientation") || egret.OrientationMode.AUTO;
                option.maxTouches = +container.getAttribute("data-multi-fingered") || 2;
                option.textureScaleFactor = +container.getAttribute("texture-scale-factor") || 1;
                if (options.renderMode == "webgl") {
                    option.showPaintRect = false;
                }
                else {
                    option.showPaintRect = container.getAttribute("data-show-paint-rect") == "true";
                }
                option.showFPS = container.getAttribute("data-show-fps") == "true";
                var styleStr = container.getAttribute("data-show-fps-style") || "";
                var stylesArr = styleStr.split(",");
                var styles = {};
                for (var i = 0; i < stylesArr.length; i++) {
                    var tempStyleArr = stylesArr[i].split(":");
                    styles[tempStyleArr[0]] = tempStyleArr[1];
                }
                option.fpsStyles = styles;
                option.showLog = container.getAttribute("data-show-log") == "true";
                option.logFilter = container.getAttribute("data-log-filter");
                return option;
            };
            /**
             * @private
             * ๆทปๅcanvasๅฐcontainerใ
             */
            WebPlayer.prototype.attachCanvas = function (container, canvas) {
                var style = canvas.style;
                style.cursor = "inherit";
                style.position = "absolute";
                style.top = "0";
                style.bottom = "0";
                style.left = "0";
                style.right = "0";
                container.appendChild(canvas);
                style = container.style;
                style.overflow = "hidden";
                style.position = "absolute";
            };
            /**
             * @private
             * ๆดๆฐๆญๆพๅจ่งๅฃๅฐบๅฏธ
             */
            WebPlayer.prototype.updateScreenSize = function () {
                var canvas = this.canvas;
                if (canvas['userTyping'])
                    return;
                var option = this.playerOption;
                var screenRect = this.container.getBoundingClientRect();
                var top = 0;
                var boundingClientWidth = screenRect.width;
                var boundingClientHeight = screenRect.height;
                if (screenRect.top < 0) {
                    boundingClientHeight += screenRect.top;
                    top = -screenRect.top;
                }
                var shouldRotate = false;
                var orientation = this.stage.$orientation;
                if (orientation != egret.OrientationMode.AUTO) {
                    shouldRotate = orientation != egret.OrientationMode.PORTRAIT && boundingClientHeight > boundingClientWidth
                        || orientation == egret.OrientationMode.PORTRAIT && boundingClientWidth > boundingClientHeight;
                }
                var screenWidth = shouldRotate ? boundingClientHeight : boundingClientWidth;
                var screenHeight = shouldRotate ? boundingClientWidth : boundingClientHeight;
                egret.Capabilities.$boundingClientWidth = screenWidth;
                egret.Capabilities.$boundingClientHeight = screenHeight;
                var stageSize = egret.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode, screenWidth, screenHeight, option.contentWidth, option.contentHeight);
                var stageWidth = stageSize.stageWidth;
                var stageHeight = stageSize.stageHeight;
                var displayWidth = stageSize.displayWidth;
                var displayHeight = stageSize.displayHeight;
                if (canvas.width !== stageWidth) {
                    canvas.width = stageWidth;
                }
                if (canvas.height !== stageHeight) {
                    canvas.height = stageHeight;
                }
                canvas.style[egret.web.getPrefixStyleName("transformOrigin")] = "0% 0% 0px";
                canvas.style.width = displayWidth + "px";
                canvas.style.height = displayHeight + "px";
                var rotation = 0;
                if (shouldRotate) {
                    if (orientation == egret.OrientationMode.LANDSCAPE) {
                        rotation = 90;
                        canvas.style.top = top + (boundingClientHeight - displayWidth) / 2 + "px";
                        canvas.style.left = (boundingClientWidth + displayHeight) / 2 + "px";
                    }
                    else {
                        rotation = -90;
                        canvas.style.top = top + (boundingClientHeight + displayWidth) / 2 + "px";
                        canvas.style.left = (boundingClientWidth - displayHeight) / 2 + "px";
                    }
                }
                else {
                    canvas.style.top = top + (boundingClientHeight - displayHeight) / 2 + "px";
                    canvas.style.left = (boundingClientWidth - displayWidth) / 2 + "px";
                }
                var transform = "rotate(" + rotation + "deg)";
                canvas.style[egret.web.getPrefixStyleName("transform")] = transform;
                var scalex = displayWidth / stageWidth, scaley = displayHeight / stageHeight;
                this.webTouchHandler.updateScaleMode(scalex, scaley, rotation);
                this.webInput.$updateSize();
                this.player.updateStageSize(stageWidth, stageHeight); //ไธ่ฆๅจ่ฟไธชๆนๆณๅ้ขไฟฎๆนๅฑๆง
            };
            WebPlayer.prototype.setContentSize = function (width, height) {
                var option = this.playerOption;
                option.contentWidth = width;
                option.contentHeight = height;
                this.updateScreenSize();
            };
            /**
             * @private
             * ๆดๆฐ่งฆๆธๆฐ้
             */
            WebPlayer.prototype.updateMaxTouches = function () {
                this.webTouchHandler.$updateMaxTouches();
            };
            return WebPlayer;
        }(egret.HashObject));
        web.WebPlayer = WebPlayer;
        __reflect(WebPlayer.prototype, "egret.web.WebPlayer", ["egret.sys.Screen"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        var sharedCanvas;
        var sharedContext;
        /**
         * @private
         */
        function convertImageToCanvas(texture, rect) {
            if (!sharedCanvas) {
                sharedCanvas = document.createElement("canvas");
                sharedContext = sharedCanvas.getContext("2d");
            }
            var w = texture.$getTextureWidth();
            var h = texture.$getTextureHeight();
            if (rect == null) {
                rect = egret.$TempRectangle;
                rect.x = 0;
                rect.y = 0;
                rect.width = w;
                rect.height = h;
            }
            rect.x = Math.min(rect.x, w - 1);
            rect.y = Math.min(rect.y, h - 1);
            rect.width = Math.min(rect.width, w - rect.x);
            rect.height = Math.min(rect.height, h - rect.y);
            var iWidth = rect.width;
            var iHeight = rect.height;
            var surface = sharedCanvas;
            surface["style"]["width"] = iWidth + "px";
            surface["style"]["height"] = iHeight + "px";
            sharedCanvas.width = iWidth;
            sharedCanvas.height = iHeight;
            if (egret.Capabilities.$renderMode == "webgl") {
                var renderTexture = void 0;
                //webglไธ้RenderTexture็บน็ๅ็ปๅฐRenderTexture
                if (!texture.$renderBuffer) {
                    renderTexture = new egret.RenderTexture();
                    renderTexture.drawToTexture(new egret.Bitmap(texture));
                }
                else {
                    renderTexture = texture;
                }
                //ไปRenderTextureไธญ่ฏปๅๅ็ดๆฐๆฎ๏ผๅกซๅฅcanvas
                var pixels = renderTexture.$renderBuffer.getPixels(rect.x, rect.y, iWidth, iHeight);
                var imageData = new ImageData(iWidth, iHeight);
                for (var i = 0; i < pixels.length; i++) {
                    imageData.data[i] = pixels[i];
                }
                sharedContext.putImageData(imageData, 0, 0);
                if (!texture.$renderBuffer) {
                    renderTexture.dispose();
                }
                return surface;
            }
            else {
                var bitmapData = texture;
                var offsetX = Math.round(bitmapData._offsetX);
                var offsetY = Math.round(bitmapData._offsetY);
                var bitmapWidth = bitmapData._bitmapWidth;
                var bitmapHeight = bitmapData._bitmapHeight;
                sharedContext.drawImage(bitmapData._bitmapData.source, bitmapData._bitmapX + rect.x / egret.$TextureScaleFactor, bitmapData._bitmapY + rect.y / egret.$TextureScaleFactor, bitmapWidth * rect.width / w, bitmapHeight * rect.height / h, offsetX, offsetY, rect.width, rect.height);
                return surface;
            }
        }
        /**
         * @private
         */
        function toDataURL(type, rect, encoderOptions) {
            try {
                var surface = convertImageToCanvas(this, rect);
                var result = surface.toDataURL(type, encoderOptions);
                return result;
            }
            catch (e) {
                egret.$error(1033);
            }
            return null;
        }
        /**
         * ๆไบๆๆฏ่ฝฏไปถ่ฎคไธบ saveToFile ๅฏ่ฝๆฏไธไธช็ๆฏๆไปถ
         */
        function eliFoTevas(type, filePath, rect, encoderOptions) {
            var base64 = toDataURL.call(this, type, rect, encoderOptions);
            if (base64 == null) {
                return;
            }
            var href = base64.replace(/^data:image[^;]*/, "data:image/octet-stream");
            var aLink = document.createElement('a');
            aLink['download'] = filePath;
            aLink.href = href;
            var evt = document.createEvent('MouseEvents');
            evt.initMouseEvent('click', true, false, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);
            aLink.dispatchEvent(evt);
        }
        function getPixel32(x, y) {
            egret.$warn(1041, "getPixel32", "getPixels");
            return this.getPixels(x, y);
        }
        function getPixels(x, y, width, height) {
            if (width === void 0) {
                width = 1;
            }
            if (height === void 0) {
                height = 1;
            }
            try {
                var surface = convertImageToCanvas(this);
                var result = sharedContext.getImageData(x, y, width, height).data;
                return result;
            }
            catch (e) {
                egret.$error(1039);
            }
        }
        egret.Texture.prototype.toDataURL = toDataURL;
        egret.Texture.prototype.saveToFile = eliFoTevas;
        egret.Texture.prototype.getPixel32 = getPixel32;
        egret.Texture.prototype.getPixels = getPixels;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * XML่็นๅบ็ฑป
         */
        var XMLNode = (function () {
            /**
             * @private
             */
            function XMLNode(nodeType, parent) {
                this.nodeType = nodeType;
                this.parent = parent;
            }
            return XMLNode;
        }());
        web.XMLNode = XMLNode;
        __reflect(XMLNode.prototype, "egret.web.XMLNode");
        /**
         * @private
         * XML่็นๅฏน่ฑก
         */
        var XML = (function (_super) {
            __extends(XML, _super);
            /**
             * @private
             */
            function XML(localName, parent, prefix, namespace, name) {
                var _this = _super.call(this, 1, parent) || this;
                /**
                 * @private
                 * ๅฝๅ่็นไธ็ๅฑๆงๅ่กจ
                 */
                _this.attributes = {};
                /**
                 * @private
                 * ๅฝๅ่็น็ๅญ่็นๅ่กจ
                 */
                _this.children = [];
                _this.localName = localName;
                _this.prefix = prefix;
                _this.namespace = namespace;
                _this.name = name;
                return _this;
            }
            return XML;
        }(XMLNode));
        web.XML = XML;
        __reflect(XML.prototype, "egret.web.XML");
        /**
         * @private
         * XMLๆๆฌ่็น
         */
        var XMLText = (function (_super) {
            __extends(XMLText, _super);
            /**
             * @private
             */
            function XMLText(text, parent) {
                var _this = _super.call(this, 3, parent) || this;
                _this.text = text;
                return _this;
            }
            return XMLText;
        }(XMLNode));
        web.XMLText = XMLText;
        __reflect(XMLText.prototype, "egret.web.XMLText");
        var parser = new DOMParser();
        /**
         * @private
         * ่งฃๆๅญ็ฌฆไธฒไธบXMLๅฏน่ฑก
         * @param text ่ฆ่งฃๆ็ๅญ็ฌฆไธฒ
         */
        function parse(text) {
            var xmlDoc = parser.parseFromString(text, "text/xml");
            var length = xmlDoc.childNodes.length;
            for (var i = 0; i < length; i++) {
                var node = xmlDoc.childNodes[i];
                if (node.nodeType == 1) {
                    return parseNode(node, null);
                }
            }
            return null;
        }
        /**
         * @private
         * ่งฃๆไธไธช่็น
         */
        function parseNode(node, parent) {
            if (node.localName == "parsererror") {
                throw new Error(node.textContent);
            }
            var xml = new XML(node.localName, parent, node["prefix"], node.namespaceURI, node.nodeName);
            var nodeAttributes = node.attributes;
            var attributes = xml.attributes;
            var length = nodeAttributes.length;
            for (var i = 0; i < length; i++) {
                var attributeNode = nodeAttributes[i];
                var name_1 = attributeNode.name;
                if (name_1.indexOf("xmlns:") == 0) {
                    continue;
                }
                attributes[name_1] = attributeNode.value;
                xml["$" + name_1] = attributeNode.value;
            }
            var childNodes = node.childNodes;
            length = childNodes.length;
            var children = xml.children;
            for (var i = 0; i < length; i++) {
                var childNode = childNodes[i];
                var nodeType = childNode.nodeType;
                var childXML = null;
                if (nodeType == 1) {
                    childXML = parseNode(childNode, xml);
                }
                else if (nodeType == 3) {
                    var text = childNode.textContent.trim();
                    if (text) {
                        childXML = new XMLText(text, xml);
                    }
                }
                if (childXML) {
                    children.push(childXML);
                }
            }
            return xml;
        }
        egret.XML = { parse: parse };
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebDeviceOrientation = (function (_super) {
            __extends(WebDeviceOrientation, _super);
            function WebDeviceOrientation() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 */
                _this.onChange = function (e) {
                    var event = new egret.OrientationEvent(egret.Event.CHANGE);
                    event.beta = e.beta;
                    event.gamma = e.gamma;
                    event.alpha = e.alpha;
                    _this.dispatchEvent(event);
                };
                return _this;
            }
            /**
             * @private
             *
             */
            WebDeviceOrientation.prototype.start = function () {
                window.addEventListener("deviceorientation", this.onChange);
            };
            /**
             * @private
             *
             */
            WebDeviceOrientation.prototype.stop = function () {
                window.removeEventListener("deviceorientation", this.onChange);
            };
            return WebDeviceOrientation;
        }(egret.EventDispatcher));
        web.WebDeviceOrientation = WebDeviceOrientation;
        __reflect(WebDeviceOrientation.prototype, "egret.web.WebDeviceOrientation", ["egret.DeviceOrientation"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
egret.DeviceOrientation = egret.web.WebDeviceOrientation;
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebGeolocation = (function (_super) {
            __extends(WebGeolocation, _super);
            /**
             * @private
             */
            function WebGeolocation(option) {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.onUpdate = function (position) {
                    var event = new egret.GeolocationEvent(egret.Event.CHANGE);
                    var coords = position.coords;
                    event.altitude = coords.altitude;
                    event.heading = coords.heading;
                    event.accuracy = coords.accuracy;
                    event.latitude = coords.latitude;
                    event.longitude = coords.longitude;
                    event.speed = coords.speed;
                    event.altitudeAccuracy = coords.altitudeAccuracy;
                    _this.dispatchEvent(event);
                };
                /**
                 * @private
                 */
                _this.onError = function (error) {
                    var errorType = egret.GeolocationEvent.UNAVAILABLE;
                    if (error.code == error.PERMISSION_DENIED)
                        errorType = egret.GeolocationEvent.PERMISSION_DENIED;
                    var event = new egret.GeolocationEvent(egret.IOErrorEvent.IO_ERROR);
                    event.errorType = errorType;
                    event.errorMessage = error.message;
                    _this.dispatchEvent(event);
                };
                _this.geolocation = navigator.geolocation;
                return _this;
            }
            /**
             * @private
             *
             */
            WebGeolocation.prototype.start = function () {
                var geo = this.geolocation;
                if (geo)
                    this.watchId = geo.watchPosition(this.onUpdate, this.onError);
                else
                    this.onError({
                        code: 2,
                        message: egret.sys.tr(3004),
                        PERMISSION_DENIED: 1,
                        POSITION_UNAVAILABLE: 2
                    });
            };
            /**
             * @private
             *
             */
            WebGeolocation.prototype.stop = function () {
                var geo = this.geolocation;
                geo.clearWatch(this.watchId);
            };
            return WebGeolocation;
        }(egret.EventDispatcher));
        web.WebGeolocation = WebGeolocation;
        __reflect(WebGeolocation.prototype, "egret.web.WebGeolocation", ["egret.Geolocation"]);
        egret.Geolocation = egret.web.WebGeolocation;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WebMotion = (function (_super) {
            __extends(WebMotion, _super);
            function WebMotion() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 */
                _this.onChange = function (e) {
                    var event = new egret.MotionEvent(egret.Event.CHANGE);
                    var acceleration = {
                        x: e.acceleration.x,
                        y: e.acceleration.y,
                        z: e.acceleration.z
                    };
                    var accelerationIncludingGravity = {
                        x: e.accelerationIncludingGravity.x,
                        y: e.accelerationIncludingGravity.y,
                        z: e.accelerationIncludingGravity.z
                    };
                    var rotation = {
                        alpha: e.rotationRate.alpha,
                        beta: e.rotationRate.beta,
                        gamma: e.rotationRate.gamma
                    };
                    event.acceleration = acceleration;
                    event.accelerationIncludingGravity = accelerationIncludingGravity;
                    event.rotationRate = rotation;
                    _this.dispatchEvent(event);
                };
                return _this;
            }
            /**
             * @private
             *
             */
            WebMotion.prototype.start = function () {
                window.addEventListener("devicemotion", this.onChange);
            };
            /**
             * @private
             *
             */
            WebMotion.prototype.stop = function () {
                window.removeEventListener("devicemotion", this.onChange);
            };
            return WebMotion;
        }(egret.EventDispatcher));
        web.WebMotion = WebMotion;
        __reflect(WebMotion.prototype, "egret.web.WebMotion", ["egret.Motion"]);
        egret.Motion = egret.web.WebMotion;
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        if (true) {
            var logFuncs_1;
            function setLogLevel(logType) {
                if (logFuncs_1 == null) {
                    logFuncs_1 = {
                        "error": console.error,
                        "debug": console.debug,
                        "warn": console.warn,
                        "info": console.info,
                        "log": console.log
                    };
                }
                switch (logType) {
                    case egret.Logger.OFF:
                        console.error = function () {
                        };
                    case egret.Logger.ERROR:
                        console.warn = function () {
                        };
                    case egret.Logger.WARN:
                        console.info = function () {
                        };
                        console.log = function () {
                        };
                    case egret.Logger.INFO:
                        console.debug = function () {
                        };
                    default:
                        break;
                }
                switch (logType) {
                    case egret.Logger.ALL:
                    case egret.Logger.DEBUG:
                        console.debug = logFuncs_1["debug"];
                    case egret.Logger.INFO:
                        console.log = logFuncs_1["log"];
                        console.info = logFuncs_1["info"];
                    case egret.Logger.WARN:
                        console.warn = logFuncs_1["warn"];
                    case egret.Logger.ERROR:
                        console.error = logFuncs_1["error"];
                    default:
                        break;
                }
            }
            Object.defineProperty(egret.Logger, "logLevel", {
                set: setLogLevel,
                enumerable: true,
                configurable: true
            });
        }
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * ็ปๅถๆไปค็ฎก็ๅจ
         * ็จๆฅ็ปดๆคdrawDataๆฐ็ป
         */
        var WebGLDrawCmdManager = (function () {
            function WebGLDrawCmdManager() {
                /**
                 * ็จไบ็ผๅญ็ปๅถๅฝไปค็ๆฐ็ป
                 */
                this.drawData = [];
                this.drawDataLen = 0;
            }
            /**
             * ๅๅฅ็ปๅถ็ฉๅฝขๆไปค
             */
            WebGLDrawCmdManager.prototype.pushDrawRect = function () {
                if (this.drawDataLen == 0 || this.drawData[this.drawDataLen - 1].type != 1 /* RECT */) {
                    var data = this.drawData[this.drawDataLen] || {};
                    data.type = 1 /* RECT */;
                    data.count = 0;
                    this.drawData[this.drawDataLen] = data;
                    this.drawDataLen++;
                }
                this.drawData[this.drawDataLen - 1].count += 2;
            };
            /**
             * ๅๅฅ็ปๅถtextureๆไปค
             */
            WebGLDrawCmdManager.prototype.pushDrawTexture = function (texture, count, filter, textureWidth, textureHeight) {
                if (count === void 0) {
                    count = 2;
                }
                if (filter) {
                    // ็ฎๅๆๆปค้็ๆๅตไธไธไผๅๅนถ็ปๅถ
                    var data = this.drawData[this.drawDataLen] || {};
                    data.type = 0 /* TEXTURE */;
                    data.texture = texture;
                    data.filter = filter;
                    data.count = count;
                    data.textureWidth = textureWidth;
                    data.textureHeight = textureHeight;
                    this.drawData[this.drawDataLen] = data;
                    this.drawDataLen++;
                }
                else {
                    if (this.drawDataLen == 0 || this.drawData[this.drawDataLen - 1].type != 0 /* TEXTURE */ || texture != this.drawData[this.drawDataLen - 1].texture || this.drawData[this.drawDataLen - 1].filter) {
                        var data = this.drawData[this.drawDataLen] || {};
                        data.type = 0 /* TEXTURE */;
                        data.texture = texture;
                        data.count = 0;
                        this.drawData[this.drawDataLen] = data;
                        this.drawDataLen++;
                    }
                    this.drawData[this.drawDataLen - 1].count += count;
                }
            };
            WebGLDrawCmdManager.prototype.pushChangeSmoothing = function (texture, smoothing) {
                texture["smoothing"] = smoothing;
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 10 /* SMOOTHING */;
                data.texture = texture;
                data.smoothing = smoothing;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /**
             * ๅๅฅpushMaskๆไปค
             */
            WebGLDrawCmdManager.prototype.pushPushMask = function (count) {
                if (count === void 0) {
                    count = 1;
                }
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 2 /* PUSH_MASK */;
                data.count = count * 2;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /**
             * ๅๅฅpopMaskๆไปค
             */
            WebGLDrawCmdManager.prototype.pushPopMask = function (count) {
                if (count === void 0) {
                    count = 1;
                }
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 3 /* POP_MASK */;
                data.count = count * 2;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /**
             * ๅๅฅๆทท่ฒๆไปค
             */
            WebGLDrawCmdManager.prototype.pushSetBlend = function (value) {
                var len = this.drawDataLen;
                // ๆๆ้ๅๅฐๆๆ็ปๅพๆไฝ
                var drawState = false;
                for (var i = len - 1; i >= 0; i--) {
                    var data = this.drawData[i];
                    if (data) {
                        if (data.type == 0 /* TEXTURE */ || data.type == 1 /* RECT */) {
                            drawState = true;
                        }
                        // ๅฆๆไธไธไธๆฌกblendๆไฝไน้ดๆๆๆ็ปๅพ๏ผไธไธๆฌกๆไฝๆๆ
                        if (!drawState && data.type == 4 /* BLEND */) {
                            this.drawData.splice(i, 1);
                            this.drawDataLen--;
                            continue;
                        }
                        // ๅฆๆไธไธไธๆฌกblendๆไฝ้ๅค๏ผๆฌๆฌกๆไฝๆๆ
                        if (data.type == 4 /* BLEND */) {
                            if (data.value == value) {
                                return;
                            }
                            else {
                                break;
                            }
                        }
                    }
                }
                var _data = this.drawData[this.drawDataLen] || {};
                _data.type = 4 /* BLEND */;
                _data.value = value;
                this.drawData[this.drawDataLen] = _data;
                this.drawDataLen++;
            };
            /*
             * ๅๅฅresize render targetๅฝไปค
             */
            WebGLDrawCmdManager.prototype.pushResize = function (buffer, width, height) {
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 5 /* RESIZE_TARGET */;
                data.buffer = buffer;
                data.width = width;
                data.height = height;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /*
             * ๅๅฅclear colorๅฝไปค
             */
            WebGLDrawCmdManager.prototype.pushClearColor = function () {
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 6 /* CLEAR_COLOR */;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /**
             * ๅๅฅๆฟๆดปbufferๅฝไปค
             */
            WebGLDrawCmdManager.prototype.pushActivateBuffer = function (buffer) {
                var len = this.drawDataLen;
                // ๆๆ้ๅๅฐๆๆ็ปๅพๆไฝ
                var drawState = false;
                for (var i = len - 1; i >= 0; i--) {
                    var data = this.drawData[i];
                    if (data) {
                        if (data.type != 4 /* BLEND */ && data.type != 7 /* ACT_BUFFER */) {
                            drawState = true;
                        }
                        // ๅฆๆไธไธไธๆฌกbufferๆไฝไน้ดๆๆๆ็ปๅพ๏ผไธไธๆฌกๆไฝๆๆ
                        if (!drawState && data.type == 7 /* ACT_BUFFER */) {
                            this.drawData.splice(i, 1);
                            this.drawDataLen--;
                            continue;
                        }
                        // ๅฆๆไธไธไธๆฌกbufferๆไฝ้ๅค๏ผๆฌๆฌกๆไฝๆๆ
                        // if(data.type == DRAWABLE_TYPE.ACT_BUFFER) {
                        //     if(data.buffer == buffer) {
                        //         return;
                        //     } else {
                        //         break;
                        //     }
                        // }
                    }
                }
                var _data = this.drawData[this.drawDataLen] || {};
                _data.type = 7 /* ACT_BUFFER */;
                _data.buffer = buffer;
                _data.width = buffer.rootRenderTarget.width;
                _data.height = buffer.rootRenderTarget.height;
                this.drawData[this.drawDataLen] = _data;
                this.drawDataLen++;
            };
            /*
             * ๅๅฅenabel scissorๅฝไปค
             */
            WebGLDrawCmdManager.prototype.pushEnableScissor = function (x, y, width, height) {
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 8 /* ENABLE_SCISSOR */;
                data.x = x;
                data.y = y;
                data.width = width;
                data.height = height;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /*
             * ๅๅฅdisable scissorๅฝไปค
             */
            WebGLDrawCmdManager.prototype.pushDisableScissor = function () {
                var data = this.drawData[this.drawDataLen] || {};
                data.type = 9 /* DISABLE_SCISSOR */;
                this.drawData[this.drawDataLen] = data;
                this.drawDataLen++;
            };
            /**
             * ๆธ็ฉบๅฝไปคๆฐ็ป
             */
            WebGLDrawCmdManager.prototype.clear = function () {
                for (var i = 0; i < this.drawDataLen; i++) {
                    var data = this.drawData[i];
                    data.type = 0;
                    data.count = 0;
                    data.texture = null;
                    data.filter = null;
                    data.uv = null;
                    data.value = "";
                    data.buffer = null;
                    data.width = 0;
                    data.height = 0;
                }
                this.drawDataLen = 0;
            };
            return WebGLDrawCmdManager;
        }());
        web.WebGLDrawCmdManager = WebGLDrawCmdManager;
        __reflect(WebGLDrawCmdManager.prototype, "egret.web.WebGLDrawCmdManager");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * ้กถ็นๆฐ็ป็ฎก็ๅฏน่ฑก
         * ็จๆฅ็ปดๆค้กถ็นๆฐ็ป
         */
        var WebGLVertexArrayObject = (function () {
            function WebGLVertexArrayObject() {
                this.size = 2000;
                this.vertexMaxSize = this.size * 4;
                this.indicesMaxSize = this.size * 6;
                this.vertSize = 5;
                this.vertices = null;
                this.indices = null;
                this.indicesForMesh = null;
                this.vertexIndex = 0;
                this.indexIndex = 0;
                this.hasMesh = false;
                var numVerts = this.vertexMaxSize * this.vertSize;
                var numIndices = this.indicesMaxSize;
                this.vertices = new Float32Array(numVerts);
                this.indices = new Uint16Array(numIndices);
                this.indicesForMesh = new Uint16Array(numIndices);
                for (var i = 0, j = 0; i < numIndices; i += 6, j += 4) {
                    this.indices[i + 0] = j + 0;
                    this.indices[i + 1] = j + 1;
                    this.indices[i + 2] = j + 2;
                    this.indices[i + 3] = j + 0;
                    this.indices[i + 4] = j + 2;
                    this.indices[i + 5] = j + 3;
                }
            }
            /**
             * ๆฏๅฆ่พพๅฐๆๅคง็ผๅญๆฐ้
             */
            WebGLVertexArrayObject.prototype.reachMaxSize = function (vertexCount, indexCount) {
                if (vertexCount === void 0) {
                    vertexCount = 4;
                }
                if (indexCount === void 0) {
                    indexCount = 6;
                }
                return this.vertexIndex > this.vertexMaxSize - vertexCount || this.indexIndex > this.indicesMaxSize - indexCount;
            };
            /**
             * ่ทๅ็ผๅญๅฎๆ็้กถ็นๆฐ็ป
             */
            WebGLVertexArrayObject.prototype.getVertices = function () {
                var view = this.vertices.subarray(0, this.vertexIndex * this.vertSize);
                return view;
            };
            /**
             * ่ทๅ็ผๅญๅฎๆ็็ดขๅผๆฐ็ป
             */
            WebGLVertexArrayObject.prototype.getIndices = function () {
                return this.indices;
            };
            /**
             * ่ทๅ็ผๅญๅฎๆ็mesh็ดขๅผๆฐ็ป
             */
            WebGLVertexArrayObject.prototype.getMeshIndices = function () {
                return this.indicesForMesh;
            };
            /**
             * ๅๆขๆmesh็ดขๅผ็ผๅญๆนๅผ
             */
            WebGLVertexArrayObject.prototype.changeToMeshIndices = function () {
                if (!this.hasMesh) {
                    // ๆท่ด้ป่ฎคindexไฟกๆฏๅฐfor meshไธญ
                    for (var i = 0, l = this.indexIndex; i < l; ++i) {
                        this.indicesForMesh[i] = this.indices[i];
                    }
                    this.hasMesh = true;
                }
            };
            WebGLVertexArrayObject.prototype.isMesh = function () {
                return this.hasMesh;
            };
            /**
             * ้ป่ฎคๆๆ็ฉๅฝข
             */
            // private defaultMeshVertices = [0, 0, 1, 0, 1, 1, 0, 1];
            // private defaultMeshUvs = [
            //     0, 0,
            //     1, 0,
            //     1, 1,
            //     0, 1
            // ];
            // private defaultMeshIndices = [0, 1, 2, 0, 2, 3];
            /**
             * ็ผๅญไธ็ป้กถ็น
             */
            WebGLVertexArrayObject.prototype.cacheArrays = function (transform, alpha, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, textureSourceWidth, textureSourceHeight, meshUVs, meshVertices, meshIndices, rotated) {
                //่ฎก็ฎๅบ็ปๅถ็ฉ้ต๏ผไนๅๆ็ฉ้ต่ฟๅๅไนๅ็
                var locWorldTransform = transform;
                var originalA = locWorldTransform.a;
                var originalB = locWorldTransform.b;
                var originalC = locWorldTransform.c;
                var originalD = locWorldTransform.d;
                var originalTx = locWorldTransform.tx;
                var originalTy = locWorldTransform.ty;
                if (destX != 0 || destY != 0) {
                    locWorldTransform.append(1, 0, 0, 1, destX, destY);
                }
                if (sourceWidth / destWidth != 1 || sourceHeight / destHeight != 1) {
                    locWorldTransform.append(destWidth / sourceWidth, 0, 0, destHeight / sourceHeight, 0, 0);
                }
                var a = locWorldTransform.a;
                var b = locWorldTransform.b;
                var c = locWorldTransform.c;
                var d = locWorldTransform.d;
                var tx = locWorldTransform.tx;
                var ty = locWorldTransform.ty;
                locWorldTransform.a = originalA;
                locWorldTransform.b = originalB;
                locWorldTransform.c = originalC;
                locWorldTransform.d = originalD;
                locWorldTransform.tx = originalTx;
                locWorldTransform.ty = originalTy;
                if (meshVertices) {
                    // ่ฎก็ฎ็ดขๅผไฝ็ฝฎไธ่ตๅผ
                    var vertices = this.vertices;
                    var index = this.vertexIndex * this.vertSize;
                    // ็ผๅญ้กถ็นๆฐ็ป
                    var i = 0, iD = 0, l = 0;
                    var u = 0, v = 0, x = 0, y = 0;
                    for (i = 0, l = meshUVs.length; i < l; i += 2) {
                        iD = i * 5 / 2;
                        x = meshVertices[i];
                        y = meshVertices[i + 1];
                        u = meshUVs[i];
                        v = meshUVs[i + 1];
                        // xy
                        vertices[index + iD + 0] = a * x + c * y + tx;
                        vertices[index + iD + 1] = b * x + d * y + ty;
                        // uv
                        vertices[index + iD + 2] = (sourceX + u * sourceWidth) / textureSourceWidth;
                        vertices[index + iD + 3] = (sourceY + v * sourceHeight) / textureSourceHeight;
                        // alpha
                        vertices[index + iD + 4] = alpha;
                    }
                    // ็ผๅญ็ดขๅผๆฐ็ป
                    if (this.hasMesh) {
                        for (var i_1 = 0, l_1 = meshIndices.length; i_1 < l_1; ++i_1) {
                            this.indicesForMesh[this.indexIndex + i_1] = meshIndices[i_1] + this.vertexIndex;
                        }
                    }
                    this.vertexIndex += meshUVs.length / 2;
                    this.indexIndex += meshIndices.length;
                }
                else {
                    var width = textureSourceWidth;
                    var height = textureSourceHeight;
                    var w = sourceWidth;
                    var h = sourceHeight;
                    sourceX = sourceX / width;
                    sourceY = sourceY / height;
                    var vertices = this.vertices;
                    var index = this.vertexIndex * this.vertSize;
                    if (rotated) {
                        var temp = sourceWidth;
                        sourceWidth = sourceHeight / width;
                        sourceHeight = temp / height;
                        // xy
                        vertices[index++] = tx;
                        vertices[index++] = ty;
                        // uv
                        vertices[index++] = sourceWidth + sourceX;
                        vertices[index++] = sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = a * w + tx;
                        vertices[index++] = b * w + ty;
                        // uv
                        vertices[index++] = sourceWidth + sourceX;
                        vertices[index++] = sourceHeight + sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = a * w + c * h + tx;
                        vertices[index++] = d * h + b * w + ty;
                        // uv
                        vertices[index++] = sourceX;
                        vertices[index++] = sourceHeight + sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = c * h + tx;
                        vertices[index++] = d * h + ty;
                        // uv
                        vertices[index++] = sourceX;
                        vertices[index++] = sourceY;
                        // alpha
                        vertices[index++] = alpha;
                    }
                    else {
                        sourceWidth = sourceWidth / width;
                        sourceHeight = sourceHeight / height;
                        // xy
                        vertices[index++] = tx;
                        vertices[index++] = ty;
                        // uv
                        vertices[index++] = sourceX;
                        vertices[index++] = sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = a * w + tx;
                        vertices[index++] = b * w + ty;
                        // uv
                        vertices[index++] = sourceWidth + sourceX;
                        vertices[index++] = sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = a * w + c * h + tx;
                        vertices[index++] = d * h + b * w + ty;
                        // uv
                        vertices[index++] = sourceWidth + sourceX;
                        vertices[index++] = sourceHeight + sourceY;
                        // alpha
                        vertices[index++] = alpha;
                        // xy
                        vertices[index++] = c * h + tx;
                        vertices[index++] = d * h + ty;
                        // uv
                        vertices[index++] = sourceX;
                        vertices[index++] = sourceHeight + sourceY;
                        // alpha
                        vertices[index++] = alpha;
                    }
                    // ็ผๅญ็ดขๅผๆฐ็ป
                    if (this.hasMesh) {
                        var indicesForMesh = this.indicesForMesh;
                        indicesForMesh[this.indexIndex + 0] = 0 + this.vertexIndex;
                        indicesForMesh[this.indexIndex + 1] = 1 + this.vertexIndex;
                        indicesForMesh[this.indexIndex + 2] = 2 + this.vertexIndex;
                        indicesForMesh[this.indexIndex + 3] = 0 + this.vertexIndex;
                        indicesForMesh[this.indexIndex + 4] = 2 + this.vertexIndex;
                        indicesForMesh[this.indexIndex + 5] = 3 + this.vertexIndex;
                    }
                    this.vertexIndex += 4;
                    this.indexIndex += 6;
                }
            };
            WebGLVertexArrayObject.prototype.clear = function () {
                this.hasMesh = false;
                this.vertexIndex = 0;
                this.indexIndex = 0;
            };
            return WebGLVertexArrayObject;
        }());
        web.WebGLVertexArrayObject = WebGLVertexArrayObject;
        __reflect(WebGLVertexArrayObject.prototype, "egret.web.WebGLVertexArrayObject");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * WebGLRenderTarget็ฑป
         * ไธไธชWebGLๆธฒๆ็ฎๆ๏ผๆฅๆไธไธชframe bufferๅtexture
         */
        var WebGLRenderTarget = (function (_super) {
            __extends(WebGLRenderTarget, _super);
            function WebGLRenderTarget(gl, width, height) {
                var _this = _super.call(this) || this;
                // ๆธ้ค่ฒ
                _this.clearColor = [0, 0, 0, 0];
                // ๆฏๅฆๅฏ็จframe buffer, ้ป่ฎคไธบtrue
                _this.useFrameBuffer = true;
                _this.gl = gl;
                // ๅฆๆๅฐบๅฏธไธบ 0 chromeไผๆฅ่ญฆ
                _this.width = width || 1;
                _this.height = height || 1;
                return _this;
            }
            /**
             * ้็ฝฎrender target็ๅฐบๅฏธ
             */
            WebGLRenderTarget.prototype.resize = function (width, height) {
                var gl = this.gl;
                this.width = width;
                this.height = height;
                if (this.frameBuffer) {
                    // ่ฎพ็ฝฎtextureๅฐบๅฏธ
                    gl.bindTexture(gl.TEXTURE_2D, this.texture);
                    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);
                    // gl.bindTexture(gl.TEXTURE_2D, null);
                }
                if (this.stencilBuffer) {
                    gl.deleteRenderbuffer(this.stencilBuffer);
                    this.stencilBuffer = null;
                }
            };
            /**
             * ๆฟๆดปๆญคrender target
             */
            WebGLRenderTarget.prototype.activate = function () {
                var gl = this.gl;
                gl.bindFramebuffer(gl.FRAMEBUFFER, this.getFrameBuffer());
            };
            /**
             * ่ทๅframe buffer
             */
            WebGLRenderTarget.prototype.getFrameBuffer = function () {
                if (!this.useFrameBuffer) {
                    return null;
                }
                return this.frameBuffer;
            };
            WebGLRenderTarget.prototype.initFrameBuffer = function () {
                if (!this.frameBuffer) {
                    var gl = this.gl;
                    // ๅๅปบๆ่ดจ
                    this.texture = this.createTexture();
                    // ๅๅปบframe buffer
                    this.frameBuffer = gl.createFramebuffer();
                    gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer);
                    // ็ปๅฎๆ่ดจ
                    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);
                }
            };
            /**
             * ๅๅปบๆ่ดจ
             * TODO ๅๅปบๆ่ดจ็ๆนๆณๅฏไปฅๅๅนถ
             */
            WebGLRenderTarget.prototype.createTexture = function () {
                var gl = this.gl;
                var texture = gl.createTexture();
                gl.bindTexture(gl.TEXTURE_2D, texture);
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
                return texture;
            };
            /**
             * ๆธ้คrender target้ข่ฒ็ผๅญ
             */
            WebGLRenderTarget.prototype.clear = function (bind) {
                var gl = this.gl;
                if (bind) {
                    this.activate();
                }
                gl.colorMask(true, true, true, true);
                gl.clearColor(this.clearColor[0], this.clearColor[1], this.clearColor[2], this.clearColor[3]);
                gl.clear(gl.COLOR_BUFFER_BIT);
            };
            WebGLRenderTarget.prototype.enabledStencil = function () {
                if (!this.frameBuffer || this.stencilBuffer) {
                    return;
                }
                var gl = this.gl;
                // ่ฎพ็ฝฎrender buffer็ๅฐบๅฏธ
                gl.bindFramebuffer(gl.FRAMEBUFFER, this.frameBuffer); // ๆฏๅฆ้่ฆๅผบๅถ็ปๅฎ๏ผ
                // ็ปๅฎstencil buffer
                this.stencilBuffer = gl.createRenderbuffer();
                gl.bindRenderbuffer(gl.RENDERBUFFER, this.stencilBuffer);
                gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, this.width, this.height);
                gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, this.stencilBuffer);
                // ๆญคๅคไธ่งฃ็ปๆฏๅฆไผ้ๆbug๏ผ
                // gl.bindFramebuffer(gl.FRAMEBUFFER, null);
            };
            return WebGLRenderTarget;
        }(egret.HashObject));
        web.WebGLRenderTarget = WebGLRenderTarget;
        __reflect(WebGLRenderTarget.prototype, "egret.web.WebGLRenderTarget");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * ๅๅปบไธไธชcanvasใ
         */
        function createCanvas(width, height) {
            var canvas = document.createElement("canvas");
            if (!isNaN(width) && !isNaN(height)) {
                canvas.width = width;
                canvas.height = height;
            }
            return canvas;
        }
        /**
         * @private
         * WebGLไธไธๆๅฏน่ฑก๏ผๆไพ็ฎๅ็็ปๅพๆฅๅฃ
         * ๆฝ่ฑกๅบๆญค็ฑป๏ผไปฅๅฎ็ฐๅฑ็จไธไธชcontext
         */
        var WebGLRenderContext = (function () {
            function WebGLRenderContext(width, height) {
                this.glID = null;
                this.projectionX = NaN;
                this.projectionY = NaN;
                this.contextLost = false;
                this.$scissorState = false;
                this.vertSize = 5;
                this.surface = createCanvas(width, height);
                this.initWebGL();
                this.$bufferStack = [];
                var gl = this.context;
                this.vertexBuffer = gl.createBuffer();
                this.indexBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);
                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
                this.drawCmdManager = new web.WebGLDrawCmdManager();
                this.vao = new web.WebGLVertexArrayObject();
                this.setGlobalCompositeOperation("source-over");
            }
            WebGLRenderContext.getInstance = function (width, height) {
                if (this.instance) {
                    return this.instance;
                }
                this.instance = new WebGLRenderContext(width, height);
                return this.instance;
            };
            /**
             * ๆจๅฅไธไธชRenderBufferๅนถ็ปๅฎ
             */
            WebGLRenderContext.prototype.pushBuffer = function (buffer) {
                this.$bufferStack.push(buffer);
                if (buffer != this.currentBuffer) {
                    if (this.currentBuffer) {
                        // this.$drawWebGL();
                    }
                    this.drawCmdManager.pushActivateBuffer(buffer);
                }
                this.currentBuffer = buffer;
            };
            /**
             * ๆจๅบไธไธชRenderBufferๅนถ็ปๅฎไธไธไธชRenderBuffer
             */
            WebGLRenderContext.prototype.popBuffer = function () {
                // ๅฆๆๅชๅฉไธไธไธชbuffer๏ผๅไธๆง่กpopๆไฝ
                // ไฟ่ฏ่ๅฐbufferๆฐธ่ฟๅจๆๅผๅง
                if (this.$bufferStack.length <= 1) {
                    return;
                }
                var buffer = this.$bufferStack.pop();
                var lastBuffer = this.$bufferStack[this.$bufferStack.length - 1];
                // ้ๆฐ็ปๅฎ
                if (buffer != lastBuffer) {
                    // this.$drawWebGL();
                    this.drawCmdManager.pushActivateBuffer(lastBuffer);
                }
                this.currentBuffer = lastBuffer;
            };
            /**
             * ๅฏ็จRenderBuffer
             */
            WebGLRenderContext.prototype.activateBuffer = function (buffer) {
                buffer.rootRenderTarget.activate();
                if (!this.bindIndices) {
                    this.uploadIndicesArray(this.vao.getIndices());
                }
                buffer.restoreStencil();
                buffer.restoreScissor();
                this.onResize(buffer.width, buffer.height);
            };
            /**
             * ไธไผ้กถ็นๆฐๆฎ
             */
            WebGLRenderContext.prototype.uploadVerticesArray = function (array) {
                var gl = this.context;
                gl.bufferData(gl.ARRAY_BUFFER, array, gl.STREAM_DRAW);
                // gl.bufferSubData(gl.ARRAY_BUFFER, 0, array);
            };
            /**
             * ไธไผ็ดขๅผๆฐๆฎ
             */
            WebGLRenderContext.prototype.uploadIndicesArray = function (array) {
                var gl = this.context;
                gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, array, gl.STATIC_DRAW);
                this.bindIndices = true;
            };
            /**
             * ้ๆฏ็ปๅถๅฏน่ฑก
             */
            WebGLRenderContext.prototype.destroy = function () {
                this.surface.width = this.surface.height = 0;
            };
            WebGLRenderContext.prototype.onResize = function (width, height) {
                width = width || this.surface.width;
                height = height || this.surface.height;
                this.projectionX = width / 2;
                this.projectionY = -height / 2;
                if (this.context) {
                    this.context.viewport(0, 0, width, height);
                }
            };
            /**
             * ๆนๅๆธฒๆ็ผๅฒ็ๅคงๅฐๅนถๆธ็ฉบ็ผๅฒๅบ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param useMaxSize ่ฅไผๅฅtrue๏ผๅๅฐๆนๅๅ็ๅฐบๅฏธไธๅทฒๆๅฐบๅฏธๅฏนๆฏ๏ผไฟ็่พๅคง็ๅฐบๅฏธใ
             */
            WebGLRenderContext.prototype.resize = function (width, height, useMaxSize) {
                var surface = this.surface;
                if (useMaxSize) {
                    if (surface.width < width) {
                        surface.width = width;
                    }
                    if (surface.height < height) {
                        surface.height = height;
                    }
                }
                else {
                    if (surface.width != width) {
                        surface.width = width;
                    }
                    if (surface.height != height) {
                        surface.height = height;
                    }
                }
                this.onResize();
            };
            WebGLRenderContext.prototype.initWebGL = function () {
                this.onResize();
                this.surface.addEventListener("webglcontextlost", this.handleContextLost.bind(this), false);
                this.surface.addEventListener("webglcontextrestored", this.handleContextRestored.bind(this), false);
                this.getWebGLContext();
                var gl = this.context;
                this.$maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
            };
            WebGLRenderContext.prototype.handleContextLost = function () {
                this.contextLost = true;
            };
            WebGLRenderContext.prototype.handleContextRestored = function () {
                this.initWebGL();
                this.contextLost = false;
            };
            WebGLRenderContext.prototype.getWebGLContext = function () {
                var options = {
                    antialias: WebGLRenderContext.antialias,
                    stencil: true //่ฎพ็ฝฎๅฏไปฅไฝฟ็จๆจกๆฟ๏ผ็จไบไธ่งๅ้ฎ็ฝฉ๏ผ
                };
                var gl;
                //todo ๆฏๅฆไฝฟ็จchromeๆบ็names
                //let contextNames = ["moz-webgl", "webkit-3d", "experimental-webgl", "webgl", "3d"];
                var names = ["webgl", "experimental-webgl"];
                for (var i = 0; i < names.length; i++) {
                    try {
                        gl = this.surface.getContext(names[i], options);
                    }
                    catch (e) {
                    }
                    if (gl) {
                        break;
                    }
                }
                if (!gl) {
                    egret.$error(1021);
                }
                this.setContext(gl);
            };
            WebGLRenderContext.prototype.setContext = function (gl) {
                this.context = gl;
                gl.id = WebGLRenderContext.glContextId++;
                this.glID = gl.id;
                gl.disable(gl.DEPTH_TEST);
                gl.disable(gl.CULL_FACE);
                gl.enable(gl.BLEND);
                gl.colorMask(true, true, true, true);
                // ็ฎๅๅชไฝฟ็จ0ๅทๆ่ดจๅๅ๏ผ้ป่ฎคๅผๅฏ
                gl.activeTexture(gl.TEXTURE0);
            };
            /**
             * ๅผๅฏๆจก็ๆฃๆต
             */
            WebGLRenderContext.prototype.enableStencilTest = function () {
                var gl = this.context;
                gl.enable(gl.STENCIL_TEST);
            };
            /**
             * ๅณ้ญๆจก็ๆฃๆต
             */
            WebGLRenderContext.prototype.disableStencilTest = function () {
                var gl = this.context;
                gl.disable(gl.STENCIL_TEST);
            };
            /**
             * ๅผๅฏscissorๆฃๆต
             */
            WebGLRenderContext.prototype.enableScissorTest = function (rect) {
                var gl = this.context;
                gl.enable(gl.SCISSOR_TEST);
                gl.scissor(rect.x, rect.y, rect.width, rect.height);
            };
            /**
             * ๅณ้ญscissorๆฃๆต
             */
            WebGLRenderContext.prototype.disableScissorTest = function () {
                var gl = this.context;
                gl.disable(gl.SCISSOR_TEST);
            };
            /**
             * ่ทๅๅ็ดไฟกๆฏ
             */
            WebGLRenderContext.prototype.getPixels = function (x, y, width, height, pixels) {
                var gl = this.context;
                gl.readPixels(x, y, width, height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);
            };
            /**
             * ๅๅปบไธไธชWebGLTexture
             */
            WebGLRenderContext.prototype.createTexture = function (bitmapData) {
                var gl = this.context;
                var texture = gl.createTexture();
                if (!texture) {
                    //ๅๅๅปบtextureๅคฑ่ดฅ,็ถๅlostไบไปถๆๅๅบๆฅ..
                    this.contextLost = true;
                    return;
                }
                texture.glContext = gl;
                gl.bindTexture(gl.TEXTURE_2D, texture);
                gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, bitmapData);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
                gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
                return texture;
            };
            WebGLRenderContext.prototype.createTextureFromCompressedData = function (data, width, height, levels, internalFormat) {
                return null;
            };
            /**
             * ๆดๆฐๆ่ดจ็bitmapData
             */
            WebGLRenderContext.prototype.updateTexture = function (texture, bitmapData) {
                var gl = this.context;
                gl.bindTexture(gl.TEXTURE_2D, texture);
                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, bitmapData);
            };
            /**
             * ่ทๅไธไธชWebGLTexture
             * ๅฆๆๆ็ผๅญ็texture่ฟๅ็ผๅญ็texture๏ผๅฆๆๆฒกๆๅๅๅปบๅนถ็ผๅญtexture
             */
            WebGLRenderContext.prototype.getWebGLTexture = function (bitmapData) {
                if (!bitmapData.webGLTexture) {
                    if (bitmapData.format == "image") {
                        bitmapData.webGLTexture = this.createTexture(bitmapData.source);
                    }
                    else if (bitmapData.format == "pvr") {
                        bitmapData.webGLTexture = this.createTextureFromCompressedData(bitmapData.source.pvrtcData, bitmapData.width, bitmapData.height, bitmapData.source.mipmapsCount, bitmapData.source.format);
                    }
                    if (bitmapData.$deleteSource && bitmapData.webGLTexture) {
                        bitmapData.source = null;
                    }
                    //todo ้ป่ฎคๅผ
                    bitmapData.webGLTexture["smoothing"] = true;
                }
                return bitmapData.webGLTexture;
            };
            /**
             * ๆธ้ค็ฉๅฝขๅบๅ
             */
            WebGLRenderContext.prototype.clearRect = function (x, y, width, height) {
                if (x != 0 || y != 0 || width != this.surface.width || height != this.surface.height) {
                    var buffer = this.currentBuffer;
                    if (buffer.$hasScissor) {
                        this.setGlobalCompositeOperation("destination-out");
                        this.drawRect(x, y, width, height);
                        this.setGlobalCompositeOperation("source-over");
                    }
                    else {
                        var m = buffer.globalMatrix;
                        if (m.b == 0 && m.c == 0) {
                            x = x * m.a + m.tx;
                            y = y * m.d + m.ty;
                            width = width * m.a;
                            height = height * m.d;
                            this.enableScissor(x, -y - height + buffer.height, width, height);
                            this.clear();
                            this.disableScissor();
                        }
                        else {
                            this.setGlobalCompositeOperation("destination-out");
                            this.drawRect(x, y, width, height);
                            this.setGlobalCompositeOperation("source-over");
                        }
                    }
                }
                else {
                    this.clear();
                }
            };
            /**
             * ่ฎพ็ฝฎๆทท่ฒ
             */
            WebGLRenderContext.prototype.setGlobalCompositeOperation = function (value) {
                this.drawCmdManager.pushSetBlend(value);
            };
            /**
             * ็ปๅถๅพ็๏ผimageๅๆฐๅฏไปฅๆฏBitmapDataๆ่renderTarget
             */
            WebGLRenderContext.prototype.drawImage = function (image, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, imageSourceWidth, imageSourceHeight, rotated, smoothing) {
                var buffer = this.currentBuffer;
                if (this.contextLost || !image || !buffer) {
                    return;
                }
                var texture;
                if (image["texture"] || (image.source && image.source["texture"])) {
                    // ๅฆๆๆฏrender target
                    texture = image["texture"] || image.source["texture"];
                    buffer.saveTransform();
                    buffer.transform(1, 0, 0, -1, 0, destHeight + destY * 2); // ็ฟป่ฝฌ
                }
                else if (!image.source && !image.webGLTexture) {
                    return;
                }
                else {
                    texture = this.getWebGLTexture(image);
                }
                if (!texture) {
                    return;
                }
                this.drawTexture(texture, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, imageSourceWidth, imageSourceHeight, undefined, undefined, undefined, undefined, rotated, smoothing);
                if (image.source && image.source["texture"]) {
                    buffer.restoreTransform();
                }
            };
            /**
             * ็ปๅถMesh
             */
            WebGLRenderContext.prototype.drawMesh = function (image, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, imageSourceWidth, imageSourceHeight, meshUVs, meshVertices, meshIndices, bounds, smoothing) {
                var buffer = this.currentBuffer;
                if (this.contextLost || !image || !buffer) {
                    return;
                }
                var texture;
                if (image["texture"] || (image.source && image.source["texture"])) {
                    // ๅฆๆๆฏrender target
                    texture = image["texture"] || image.source["texture"];
                    buffer.saveTransform();
                    buffer.transform(1, 0, 0, -1, 0, destHeight + destY * 2); // ็ฟป่ฝฌ
                }
                else if (!image.source && !image.webGLTexture) {
                    return;
                }
                else {
                    texture = this.getWebGLTexture(image);
                }
                if (!texture) {
                    return;
                }
                this.drawTexture(texture, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, imageSourceWidth, imageSourceHeight, meshUVs, meshVertices, meshIndices, bounds, smoothing);
                if (image["texture"] || (image.source && image.source["texture"])) {
                    buffer.restoreTransform();
                }
            };
            /**
             * ็ปๅถๆ่ดจ
             */
            WebGLRenderContext.prototype.drawTexture = function (texture, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, textureWidth, textureHeight, meshUVs, meshVertices, meshIndices, bounds, rotated, smoothing) {
                var buffer = this.currentBuffer;
                if (this.contextLost || !texture || !buffer) {
                    return;
                }
                if (meshVertices && meshIndices) {
                    if (this.vao.reachMaxSize(meshVertices.length / 2, meshIndices.length)) {
                        this.$drawWebGL();
                    }
                }
                else {
                    if (this.vao.reachMaxSize()) {
                        this.$drawWebGL();
                    }
                }
                if (smoothing != undefined && texture["smoothing"] != smoothing) {
                    this.drawCmdManager.pushChangeSmoothing(texture, smoothing);
                }
                if (meshUVs) {
                    this.vao.changeToMeshIndices();
                }
                var transform = buffer.globalMatrix;
                var alpha = buffer.globalAlpha;
                var count = meshIndices ? meshIndices.length / 3 : 2;
                // ๅบ็จ$filter๏ผๅไธบๅชๅฏ่ฝๆฏcolorMatrixFilter๏ผๆๅไธคไธชๅๆฐๅฏไธไผ
                this.drawCmdManager.pushDrawTexture(texture, count, this.$filter);
                this.vao.cacheArrays(transform, alpha, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, textureWidth, textureHeight, meshUVs, meshVertices, meshIndices, rotated);
            };
            /**
             * ็ปๅถ็ฉๅฝข๏ผไป็จไบ้ฎ็ฝฉๆฆ้ค็ญ๏ผ
             */
            WebGLRenderContext.prototype.drawRect = function (x, y, width, height) {
                var buffer = this.currentBuffer;
                if (this.contextLost || !buffer) {
                    return;
                }
                if (this.vao.reachMaxSize()) {
                    this.$drawWebGL();
                }
                this.drawCmdManager.pushDrawRect();
                this.vao.cacheArrays(buffer.globalMatrix, buffer.globalAlpha, 0, 0, width, height, x, y, width, height, width, height);
            };
            /**
             * ็ปๅถ้ฎ็ฝฉ
             */
            WebGLRenderContext.prototype.pushMask = function (mask) {
                var buffer = this.currentBuffer;
                if (this.contextLost || !buffer) {
                    return;
                }
                buffer.$stencilList.push(mask);
                if (this.vao.reachMaxSize()) {
                    this.$drawWebGL();
                }
                var length = mask.length;
                if (length) {
                    this.drawCmdManager.pushPushMask(length);
                    for (var i = 0; i < length; i++) {
                        var item = mask[i];
                        this.vao.cacheArrays(buffer.globalMatrix, buffer.globalAlpha, 0, 0, item.width, item.height, item.minX, item.minY, item.width, item.height, item.width, item.height);
                    }
                }
                else {
                    this.drawCmdManager.pushPushMask();
                    this.vao.cacheArrays(buffer.globalMatrix, buffer.globalAlpha, 0, 0, mask.width, mask.height, mask.x, mask.y, mask.width, mask.height, mask.width, mask.height);
                }
            };
            /**
             * ๆขๅค้ฎ็ฝฉ
             */
            WebGLRenderContext.prototype.popMask = function () {
                var buffer = this.currentBuffer;
                if (this.contextLost || !buffer) {
                    return;
                }
                var mask = buffer.$stencilList.pop();
                if (this.vao.reachMaxSize()) {
                    this.$drawWebGL();
                }
                var length = mask.length;
                if (length) {
                    this.drawCmdManager.pushPopMask(length);
                    for (var i = 0; i < length; i++) {
                        var item = mask[i];
                        this.vao.cacheArrays(buffer.globalMatrix, buffer.globalAlpha, 0, 0, item.width, item.height, item.minX, item.minY, item.width, item.height, item.width, item.height);
                    }
                }
                else {
                    this.drawCmdManager.pushPopMask();
                    this.vao.cacheArrays(buffer.globalMatrix, buffer.globalAlpha, 0, 0, mask.width, mask.height, mask.x, mask.y, mask.width, mask.height, mask.width, mask.height);
                }
            };
            /**
             * ๆธ้ค้ข่ฒ็ผๅญ
             */
            WebGLRenderContext.prototype.clear = function () {
                this.drawCmdManager.pushClearColor();
            };
            /**
             * ๅผๅฏscissor test
             */
            WebGLRenderContext.prototype.enableScissor = function (x, y, width, height) {
                var buffer = this.currentBuffer;
                this.drawCmdManager.pushEnableScissor(x, y, width, height);
                buffer.$hasScissor = true;
            };
            /**
             * ๅณ้ญscissor test
             */
            WebGLRenderContext.prototype.disableScissor = function () {
                var buffer = this.currentBuffer;
                this.drawCmdManager.pushDisableScissor();
                buffer.$hasScissor = false;
            };
            WebGLRenderContext.prototype.$drawWebGL = function () {
                if (this.drawCmdManager.drawDataLen == 0 || this.contextLost) {
                    return;
                }
                this.uploadVerticesArray(this.vao.getVertices());
                // ๆmesh๏ผๅไฝฟ็จindicesForMesh
                if (this.vao.isMesh()) {
                    this.uploadIndicesArray(this.vao.getMeshIndices());
                }
                var length = this.drawCmdManager.drawDataLen;
                var offset = 0;
                for (var i = 0; i < length; i++) {
                    var data = this.drawCmdManager.drawData[i];
                    offset = this.drawData(data, offset);
                    // ่ฎก็ฎdraw call
                    if (data.type == 7 /* ACT_BUFFER */) {
                        this.activatedBuffer = data.buffer;
                    }
                    if (data.type == 0 /* TEXTURE */ || data.type == 1 /* RECT */ || data.type == 2 /* PUSH_MASK */ || data.type == 3 /* POP_MASK */) {
                        if (this.activatedBuffer && this.activatedBuffer.$computeDrawCall) {
                            this.activatedBuffer.$drawCalls++;
                        }
                    }
                }
                // ๅๆขๅ้ป่ฎคindices
                if (this.vao.isMesh()) {
                    this.uploadIndicesArray(this.vao.getIndices());
                }
                // ๆธ็ฉบๆฐๆฎ
                this.drawCmdManager.clear();
                this.vao.clear();
            };
            /**
             * ๆง่ก็ปๅถๅฝไปค
             */
            WebGLRenderContext.prototype.drawData = function (data, offset) {
                if (!data) {
                    return;
                }
                var gl = this.context;
                var program;
                var filter = data.filter;
                switch (data.type) {
                    case 0 /* TEXTURE */:
                        if (filter) {
                            if (filter.type === "custom") {
                                program = web.EgretWebGLProgram.getProgram(gl, filter.$vertexSrc, filter.$fragmentSrc, filter.$shaderKey);
                            }
                            else if (filter.type === "colorTransform") {
                                program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.colorTransform_frag, "colorTransform");
                            }
                            else if (filter.type === "blurX") {
                                program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.blur_frag, "blur");
                            }
                            else if (filter.type === "blurY") {
                                program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.blur_frag, "blur");
                            }
                            else if (filter.type === "glow") {
                                program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.glow_frag, "glow");
                            }
                        }
                        else {
                            program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.texture_frag, "texture");
                        }
                        this.activeProgram(gl, program);
                        this.syncUniforms(program, filter, data.textureWidth, data.textureHeight);
                        offset += this.drawTextureElements(data, offset);
                        break;
                    case 1 /* RECT */:
                        program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.primitive_frag, "primitive");
                        this.activeProgram(gl, program);
                        this.syncUniforms(program, filter, data.textureWidth, data.textureHeight);
                        offset += this.drawRectElements(data, offset);
                        break;
                    case 2 /* PUSH_MASK */:
                        program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.primitive_frag, "primitive");
                        this.activeProgram(gl, program);
                        this.syncUniforms(program, filter, data.textureWidth, data.textureHeight);
                        offset += this.drawPushMaskElements(data, offset);
                        break;
                    case 3 /* POP_MASK */:
                        program = web.EgretWebGLProgram.getProgram(gl, web.EgretShaderLib.default_vert, web.EgretShaderLib.primitive_frag, "primitive");
                        this.activeProgram(gl, program);
                        this.syncUniforms(program, filter, data.textureWidth, data.textureHeight);
                        offset += this.drawPopMaskElements(data, offset);
                        break;
                    case 4 /* BLEND */:
                        this.setBlendMode(data.value);
                        break;
                    case 5 /* RESIZE_TARGET */:
                        data.buffer.rootRenderTarget.resize(data.width, data.height);
                        this.onResize(data.width, data.height);
                        break;
                    case 6 /* CLEAR_COLOR */:
                        if (this.activatedBuffer) {
                            var target = this.activatedBuffer.rootRenderTarget;
                            if (target.width != 0 || target.height != 0) {
                                target.clear(true);
                            }
                        }
                        break;
                    case 7 /* ACT_BUFFER */:
                        this.activateBuffer(data.buffer);
                        break;
                    case 8 /* ENABLE_SCISSOR */:
                        var buffer = this.activatedBuffer;
                        if (buffer) {
                            if (buffer.rootRenderTarget) {
                                buffer.rootRenderTarget.enabledStencil();
                            }
                            buffer.enableScissor(data.x, data.y, data.width, data.height);
                        }
                        break;
                    case 9 /* DISABLE_SCISSOR */:
                        buffer = this.activatedBuffer;
                        if (buffer) {
                            buffer.disableScissor();
                        }
                        break;
                    case 10 /* SMOOTHING */:
                        gl.bindTexture(gl.TEXTURE_2D, data.texture);
                        if (data.smoothing) {
                            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
                            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
                        }
                        else {
                            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
                            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
                        }
                        break;
                    default:
                        break;
                }
                return offset;
            };
            WebGLRenderContext.prototype.activeProgram = function (gl, program) {
                if (program != this.currentProgram) {
                    gl.useProgram(program.id);
                    // ็ฎๅๆๆattribute buffer็็ปๅฎๆนๆณ้ฝๆฏไธ่ด็
                    var attribute = program.attributes;
                    for (var key in attribute) {
                        if (key === "aVertexPosition") {
                            gl.vertexAttribPointer(attribute["aVertexPosition"].location, 2, gl.FLOAT, false, 5 * 4, 0);
                            gl.enableVertexAttribArray(attribute["aVertexPosition"].location);
                        }
                        else if (key === "aTextureCoord") {
                            gl.vertexAttribPointer(attribute["aTextureCoord"].location, 2, gl.FLOAT, false, 5 * 4, 2 * 4);
                            gl.enableVertexAttribArray(attribute["aTextureCoord"].location);
                        }
                        else if (key === "aColor") {
                            gl.vertexAttribPointer(attribute["aColor"].location, 1, gl.FLOAT, false, 5 * 4, 4 * 4);
                            gl.enableVertexAttribArray(attribute["aColor"].location);
                        }
                    }
                    this.currentProgram = program;
                }
            };
            WebGLRenderContext.prototype.syncUniforms = function (program, filter, textureWidth, textureHeight) {
                var uniforms = program.uniforms;
                var isCustomFilter = filter && filter.type === "custom";
                for (var key in uniforms) {
                    if (key === "projectionVector") {
                        uniforms[key].setValue({ x: this.projectionX, y: this.projectionY });
                    }
                    else if (key === "uTextureSize") {
                        uniforms[key].setValue({ x: textureWidth, y: textureHeight });
                    }
                    else if (key === "uSampler") {
                    }
                    else {
                        var value = filter.$uniforms[key];
                        if (value !== undefined) {
                            uniforms[key].setValue(value);
                        }
                        else {
                            // egret.warn("filter custom: uniform " + key + " not defined!");
                        }
                    }
                }
            };
            /**
             * ็ปtexture
             **/
            WebGLRenderContext.prototype.drawTextureElements = function (data, offset) {
                var gl = this.context;
                gl.bindTexture(gl.TEXTURE_2D, data.texture);
                var size = data.count * 3;
                gl.drawElements(gl.TRIANGLES, size, gl.UNSIGNED_SHORT, offset * 2);
                return size;
            };
            /**
             * @private
             * ็ปrect
             **/
            WebGLRenderContext.prototype.drawRectElements = function (data, offset) {
                var gl = this.context;
                // gl.bindTexture(gl.TEXTURE_2D, null);
                var size = data.count * 3;
                gl.drawElements(gl.TRIANGLES, size, gl.UNSIGNED_SHORT, offset * 2);
                return size;
            };
            /**
             * ็ปpush mask
             **/
            WebGLRenderContext.prototype.drawPushMaskElements = function (data, offset) {
                var gl = this.context;
                var size = data.count * 3;
                var buffer = this.activatedBuffer;
                if (buffer) {
                    if (buffer.rootRenderTarget) {
                        buffer.rootRenderTarget.enabledStencil();
                    }
                    if (buffer.stencilHandleCount == 0) {
                        buffer.enableStencil();
                        gl.clear(gl.STENCIL_BUFFER_BIT); // clear
                    }
                    var level = buffer.stencilHandleCount;
                    buffer.stencilHandleCount++;
                    gl.colorMask(false, false, false, false);
                    gl.stencilFunc(gl.EQUAL, level, 0xFF);
                    gl.stencilOp(gl.KEEP, gl.KEEP, gl.INCR);
                    // gl.bindTexture(gl.TEXTURE_2D, null);
                    gl.drawElements(gl.TRIANGLES, size, gl.UNSIGNED_SHORT, offset * 2);
                    gl.stencilFunc(gl.EQUAL, level + 1, 0xFF);
                    gl.colorMask(true, true, true, true);
                    gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);
                }
                return size;
            };
            /**
             * ็ปpop mask
             **/
            WebGLRenderContext.prototype.drawPopMaskElements = function (data, offset) {
                var gl = this.context;
                var size = data.count * 3;
                var buffer = this.activatedBuffer;
                if (buffer) {
                    buffer.stencilHandleCount--;
                    if (buffer.stencilHandleCount == 0) {
                        buffer.disableStencil(); // skip this draw
                    }
                    else {
                        var level = buffer.stencilHandleCount;
                        gl.colorMask(false, false, false, false);
                        gl.stencilFunc(gl.EQUAL, level + 1, 0xFF);
                        gl.stencilOp(gl.KEEP, gl.KEEP, gl.DECR);
                        // gl.bindTexture(gl.TEXTURE_2D, null);
                        gl.drawElements(gl.TRIANGLES, size, gl.UNSIGNED_SHORT, offset * 2);
                        gl.stencilFunc(gl.EQUAL, level, 0xFF);
                        gl.colorMask(true, true, true, true);
                        gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);
                    }
                }
                return size;
            };
            /**
             * ่ฎพ็ฝฎๆทท่ฒ
             */
            WebGLRenderContext.prototype.setBlendMode = function (value) {
                var gl = this.context;
                var blendModeWebGL = WebGLRenderContext.blendModesForGL[value];
                if (blendModeWebGL) {
                    gl.blendFunc(blendModeWebGL[0], blendModeWebGL[1]);
                }
            };
            /**
             * ๅบ็จๆปค้็ปๅถ็ปๅฎ็render target
             * ๆญคๆนๆณไธไผๅฏผ่ดinput่ขซ้ๆพ๏ผๆไปฅๅฆๆ้่ฆ้ๆพinput๏ผ้่ฆ่ฐ็จๆญคๆนๆณๅๆๅจ่ฐ็จrelease
             */
            WebGLRenderContext.prototype.drawTargetWidthFilters = function (filters, input) {
                var originInput = input, filtersLen = filters.length, output;
                // ๅบ็จๅ้ข็ๆปค้
                if (filtersLen > 1) {
                    for (var i = 0; i < filtersLen - 1; i++) {
                        var filter_1 = filters[i];
                        var width = input.rootRenderTarget.width;
                        var height = input.rootRenderTarget.height;
                        output = web.WebGLRenderBuffer.create(width, height);
                        output.setTransform(1, 0, 0, 1, 0, 0);
                        output.globalAlpha = 1;
                        this.drawToRenderTarget(filter_1, input, output);
                        if (input != originInput) {
                            web.WebGLRenderBuffer.release(input);
                        }
                        input = output;
                    }
                }
                // ๅบ็จๆๅไธไธชๆปค้ๅนถ็ปๅถๅฐๅฝๅๅบๆฏไธญ
                var filter = filters[filtersLen - 1];
                this.drawToRenderTarget(filter, input, this.currentBuffer);
                // ้ๆพๆ็จไบไบคๆข็buffer
                if (input != originInput) {
                    web.WebGLRenderBuffer.release(input);
                }
            };
            /**
             * ๅไธไธชrenderTargetไธญ็ปๅถ
             * */
            WebGLRenderContext.prototype.drawToRenderTarget = function (filter, input, output) {
                if (this.contextLost) {
                    return;
                }
                if (this.vao.reachMaxSize()) {
                    this.$drawWebGL();
                }
                this.pushBuffer(output);
                var originInput = input, temp, width = input.rootRenderTarget.width, height = input.rootRenderTarget.height;
                // ๆจก็ณๆปค้ๅๅซๅค็blurXไธblurY
                if (filter.type == "blur") {
                    var blurXFilter = filter.blurXFilter;
                    var blurYFilter = filter.blurYFilter;
                    if (blurXFilter.blurX != 0 && blurYFilter.blurY != 0) {
                        temp = web.WebGLRenderBuffer.create(width, height);
                        temp.setTransform(1, 0, 0, 1, 0, 0);
                        temp.globalAlpha = 1;
                        this.drawToRenderTarget(filter.blurXFilter, input, temp);
                        if (input != originInput) {
                            web.WebGLRenderBuffer.release(input);
                        }
                        input = temp;
                        filter = blurYFilter;
                    }
                    else {
                        filter = blurXFilter.blurX === 0 ? blurYFilter : blurXFilter;
                    }
                }
                // ็ปๅถinput็ปๆๅฐ่ๅฐ
                output.saveTransform();
                output.transform(1, 0, 0, -1, 0, height);
                this.vao.cacheArrays(output.globalMatrix, output.globalAlpha, 0, 0, width, height, 0, 0, width, height, width, height);
                output.restoreTransform();
                this.drawCmdManager.pushDrawTexture(input.rootRenderTarget.texture, 2, filter, width, height);
                // ้ๆพๆinput
                if (input != originInput) {
                    web.WebGLRenderBuffer.release(input);
                }
                this.popBuffer();
            };
            WebGLRenderContext.initBlendMode = function () {
                WebGLRenderContext.blendModesForGL = {};
                WebGLRenderContext.blendModesForGL["source-over"] = [1, 771];
                WebGLRenderContext.blendModesForGL["lighter"] = [1, 1];
                WebGLRenderContext.blendModesForGL["lighter-in"] = [770, 771];
                WebGLRenderContext.blendModesForGL["destination-out"] = [0, 771];
                WebGLRenderContext.blendModesForGL["destination-in"] = [0, 770];
            };
            /**
             * ๆนๅๆธฒๆ็ผๅฒไธบๆๅฎๅคงๅฐ๏ผไฝไฟ็ๅๅงๅพๅๆฐๆฎ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param offsetX ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎx
             * @param offsetY ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎy
             */
            // public resizeTo(width:number, height:number, offsetX:number, offsetY:number):void {
            //     this.surface.width = width;
            //     this.surface.height = height;
            // }
            WebGLRenderContext.glContextId = 0;
            WebGLRenderContext.blendModesForGL = null;
            return WebGLRenderContext;
        }());
        web.WebGLRenderContext = WebGLRenderContext;
        __reflect(WebGLRenderContext.prototype, "egret.web.WebGLRenderContext");
        WebGLRenderContext.initBlendMode();
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         * WebGLๆธฒๆ็ผๅญ
         */
        var WebGLRenderBuffer = (function (_super) {
            __extends(WebGLRenderBuffer, _super);
            function WebGLRenderBuffer(width, height, root) {
                var _this = _super.call(this) || this;
                _this.globalAlpha = 1;
                /**
                 * stencil state
                 * ๆจก็ๅผๅณ็ถๆ
                 */
                _this.stencilState = false;
                _this.$stencilList = [];
                _this.stencilHandleCount = 0;
                /**
                 * scissor state
                 * scissor ๅผๅณ็ถๆ
                 */
                _this.$scissorState = false;
                _this.scissorRect = new egret.Rectangle();
                _this.$hasScissor = false;
                // dirtyRegionPolicy hack
                _this.dirtyRegionPolicy = true;
                _this._dirtyRegionPolicy = true; // ้ป่ฎค่ฎพ็ฝฎไธบtrue๏ผไฟ่ฏ็ฌฌไธๅธง็ปๅถๅจframeBufferไธ
                _this.$drawCalls = 0;
                _this.$computeDrawCall = false;
                _this.globalMatrix = new egret.Matrix();
                _this.savedGlobalMatrix = new egret.Matrix();
                // ่ทๅwebglRenderContext
                _this.context = web.WebGLRenderContext.getInstance(width, height);
                // buffer ๅฏนๅบ็ render target
                _this.rootRenderTarget = new web.WebGLRenderTarget(_this.context.context, 3, 3);
                if (width && height) {
                    _this.resize(width, height);
                }
                // ๅฆๆๆฏ็ฌฌไธไธชๅๅฅ็buffer๏ผ่ฏดๆๆฏ่ๅฐbuffer
                _this.root = root;
                // ๅฆๆๆฏ็จไบ่ๅฐๆธฒๆ็renderBuffer๏ผๅ้ป่ฎคๆทปๅrenderTargetๅฐrenderContextไธญ๏ผ่ไธๆฏ็ฌฌไธไธช
                if (_this.root) {
                    _this.context.pushBuffer(_this);
                    // ็ปๅธ
                    _this.surface = _this.context.surface;
                }
                else {
                    // ็ฑไบๅๅปบrenderTarget้ๆ็frameBuffer็ปๅฎ๏ผ่ฟ้้็ฝฎ็ปๅฎ
                    var lastBuffer = _this.context.activatedBuffer;
                    if (lastBuffer) {
                        lastBuffer.rootRenderTarget.activate();
                    }
                    _this.rootRenderTarget.initFrameBuffer();
                    _this.surface = _this.rootRenderTarget;
                }
                return _this;
            }
            WebGLRenderBuffer.prototype.enableStencil = function () {
                if (!this.stencilState) {
                    this.context.enableStencilTest();
                    this.stencilState = true;
                }
            };
            WebGLRenderBuffer.prototype.disableStencil = function () {
                if (this.stencilState) {
                    this.context.disableStencilTest();
                    this.stencilState = false;
                }
            };
            WebGLRenderBuffer.prototype.restoreStencil = function () {
                if (this.stencilState) {
                    this.context.enableStencilTest();
                }
                else {
                    this.context.disableStencilTest();
                }
            };
            WebGLRenderBuffer.prototype.enableScissor = function (x, y, width, height) {
                if (!this.$scissorState) {
                    this.$scissorState = true;
                    this.scissorRect.setTo(x, y, width, height);
                    this.context.enableScissorTest(this.scissorRect);
                }
            };
            WebGLRenderBuffer.prototype.disableScissor = function () {
                if (this.$scissorState) {
                    this.$scissorState = false;
                    this.scissorRect.setEmpty();
                    this.context.disableScissorTest();
                }
            };
            WebGLRenderBuffer.prototype.restoreScissor = function () {
                if (this.$scissorState) {
                    this.context.enableScissorTest(this.scissorRect);
                }
                else {
                    this.context.disableScissorTest();
                }
            };
            Object.defineProperty(WebGLRenderBuffer.prototype, "width", {
                /**
                 * ๆธฒๆ็ผๅฒ็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝใ
                 * @readOnly
                 */
                get: function () {
                    return this.rootRenderTarget.width;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(WebGLRenderBuffer.prototype, "height", {
                /**
                 * ๆธฒๆ็ผๅฒ็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝใ
                 * @readOnly
                 */
                get: function () {
                    return this.rootRenderTarget.height;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * ๆนๅๆธฒๆ็ผๅฒ็ๅคงๅฐๅนถๆธ็ฉบ็ผๅฒๅบ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param useMaxSize ่ฅไผๅฅtrue๏ผๅๅฐๆนๅๅ็ๅฐบๅฏธไธๅทฒๆๅฐบๅฏธๅฏนๆฏ๏ผไฟ็่พๅคง็ๅฐบๅฏธใ
             */
            WebGLRenderBuffer.prototype.resize = function (width, height, useMaxSize) {
                this.context.pushBuffer(this);
                width = width || 1;
                height = height || 1;
                // render target ๅฐบๅฏธ้็ฝฎ
                if (width != this.rootRenderTarget.width || height != this.rootRenderTarget.height) {
                    this.context.drawCmdManager.pushResize(this, width, height);
                    // ๅๆญฅๆดๆนๅฎฝ้ซ
                    this.rootRenderTarget.width = width;
                    this.rootRenderTarget.height = height;
                }
                // ๅฆๆๆฏ่ๅฐ็ๆธฒๆ็ผๅฒ๏ผๆง่กresize๏ผๅฆๅsurfaceๅคงๅฐไธ้ไนๆนๅ
                if (this.root) {
                    this.context.resize(width, height, useMaxSize);
                }
                this.context.clear();
                this.context.popBuffer();
            };
            /**
             * ๆนๅๆธฒๆ็ผๅฒไธบๆๅฎๅคงๅฐ๏ผไฝไฟ็ๅๅงๅพๅๆฐๆฎ
             * @param width ๆนๅๅ็ๅฎฝ
             * @param height ๆนๅๅ็้ซ
             * @param offsetX ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎx
             * @param offsetY ๅๅงๅพๅๆฐๆฎๅจๆนๅๅ็ผๅฒๅบ็็ปๅถ่ตทๅงไฝ็ฝฎy
             */
            WebGLRenderBuffer.prototype.resizeTo = function (width, height, offsetX, offsetY) {
                this.context.pushBuffer(this);
                var oldWidth = this.rootRenderTarget.width;
                var oldHeight = this.rootRenderTarget.height;
                var tempBuffer = WebGLRenderBuffer.create(oldWidth, oldHeight);
                this.context.pushBuffer(tempBuffer);
                this.context.drawImage(this.rootRenderTarget, 0, 0, oldWidth, oldHeight, 0, 0, oldWidth, oldHeight, oldWidth, oldHeight, false);
                this.context.popBuffer();
                this.resize(width, height);
                this.setTransform(1, 0, 0, 1, 0, 0);
                this.context.drawImage(tempBuffer.rootRenderTarget, 0, 0, oldWidth, oldHeight, offsetX, offsetY, oldWidth, oldHeight, oldWidth, oldHeight, false);
                WebGLRenderBuffer.release(tempBuffer);
                this.context.popBuffer();
            };
            WebGLRenderBuffer.prototype.setDirtyRegionPolicy = function (state) {
                this.dirtyRegionPolicy = (state == "on");
            };
            /**
             * ๆธ็ฉบๅนถ่ฎพ็ฝฎ่ฃๅ
             * @param regions ็ฉๅฝขๅ่กจ
             * @param offsetX ็ฉๅฝข่ฆๅไธ็ๅ็งป้x
             * @param offsetY ็ฉๅฝข่ฆๅไธ็ๅ็งป้y
             */
            WebGLRenderBuffer.prototype.beginClip = function (regions, offsetX, offsetY) {
                this.context.pushBuffer(this);
                if (this.root) {
                    // dirtyRegionPolicy hack
                    if (this._dirtyRegionPolicy) {
                        this.rootRenderTarget.useFrameBuffer = true;
                        this.rootRenderTarget.activate();
                    }
                    else {
                        this.rootRenderTarget.useFrameBuffer = false;
                        this.rootRenderTarget.activate();
                        WebGLRenderBuffer.autoClear && this.context.clear();
                    }
                }
                offsetX = +offsetX || 0;
                offsetY = +offsetY || 0;
                this.setTransform(1, 0, 0, 1, offsetX, offsetY);
                var length = regions.length;
                //ๅชๆไธไธชๅบๅไธๅๅฅฝไธบ่ๅฐๅคงๅฐๆถ,ไธ่ฎพ็ฝฎๆจกๆฟ
                // if (length == 1 && regions[0].minX == 0 && regions[0].minY == 0 &&
                //     regions[0].width == this.rootRenderTarget.width && regions[0].height == this.rootRenderTarget.height) {
                this.maskPushed = false;
                this.rootRenderTarget.useFrameBuffer && this.context.clear();
                this.context.popBuffer();
                return;
                // }
                // ๆฆ้ค่็ฉๅฝขๅบๅ
                // for (let i = 0; i < length; i++) {
                //     let region = regions[i];
                //     this.context.clearRect(region.minX, region.minY, region.width, region.height);
                // }
                // // ่ฎพ็ฝฎๆจก็
                // if (length > 0) {
                //     // ๅฏน็ฌฌไธไธชไธๅชๆไธไธชmask็จscissorๅค็
                //     if(!this.$hasScissor && length == 1) {
                //         let region = regions[0];
                //         regions = regions.slice(1);
                //         let x = region.minX + offsetX;
                //         let y = region.minY + offsetY;
                //         let width = region.width;
                //         let height = region.height;
                //         this.context.enableScissor(x, - y - height + this.height, width, height);
                //         this.scissorEnabled = true;
                //     } else {
                //         this.scissorEnabled = false;
                //     }
                //     if(regions.length > 0) {
                //         this.context.pushMask(regions);
                //         this.maskPushed = true;
                //     } else {
                //         this.maskPushed = false;
                //     }
                //     this.offsetX = offsetX;
                //     this.offsetY = offsetY;
                // }
                // else {
                //     this.maskPushed = false;
                // }
                // this.context.popBuffer();
            };
            /**
             * ๅๆถไธไธๆฌก่ฎพ็ฝฎ็clipใ
             */
            WebGLRenderBuffer.prototype.endClip = function () {
                if (this.maskPushed || this.scissorEnabled) {
                    this.context.pushBuffer(this);
                    if (this.maskPushed) {
                        this.setTransform(1, 0, 0, 1, this.offsetX, this.offsetY);
                        this.context.popMask();
                    }
                    if (this.scissorEnabled) {
                        this.context.disableScissor();
                    }
                    this.context.popBuffer();
                }
            };
            /**
             * ่ทๅๆๅฎๅบๅ็ๅ็ด
             */
            WebGLRenderBuffer.prototype.getPixels = function (x, y, width, height) {
                if (width === void 0) {
                    width = 1;
                }
                if (height === void 0) {
                    height = 1;
                }
                var pixels = new Uint8Array(4 * width * height);
                var useFrameBuffer = this.rootRenderTarget.useFrameBuffer;
                this.rootRenderTarget.useFrameBuffer = true;
                this.rootRenderTarget.activate();
                this.context.getPixels(x, y, width, height, pixels);
                this.rootRenderTarget.useFrameBuffer = useFrameBuffer;
                this.rootRenderTarget.activate();
                //ๅพๅๅ่ฝฌ
                var result = new Uint8Array(4 * width * height);
                for (var i = 0; i < height; i++) {
                    for (var j = 0; j < width; j++) {
                        result[(width * (height - i - 1) + j) * 4] = pixels[(width * i + j) * 4];
                        result[(width * (height - i - 1) + j) * 4 + 1] = pixels[(width * i + j) * 4 + 1];
                        result[(width * (height - i - 1) + j) * 4 + 2] = pixels[(width * i + j) * 4 + 2];
                        result[(width * (height - i - 1) + j) * 4 + 3] = pixels[(width * i + j) * 4 + 3];
                    }
                }
                return result;
            };
            /**
             * ่ฝฌๆขๆbase64ๅญ็ฌฆไธฒ๏ผๅฆๆๅพ็๏ผๆ่ๅๅซ็ๅพ็๏ผ่ทจๅ๏ผๅ่ฟๅnull
             * @param type ่ฝฌๆข็็ฑปๅ๏ผๅฆ: "image/png","image/jpeg"
             */
            WebGLRenderBuffer.prototype.toDataURL = function (type, encoderOptions) {
                return this.context.surface.toDataURL(type, encoderOptions);
            };
            /**
             * ้ๆฏ็ปๅถๅฏน่ฑก
             */
            WebGLRenderBuffer.prototype.destroy = function () {
                this.context.destroy();
            };
            WebGLRenderBuffer.prototype.onRenderFinish = function () {
                this.$drawCalls = 0;
                // ๅฆๆๆฏ่ๅฐๆธฒๆbuffer๏ผๅคๆญ่็ฉๅฝข็ญ็ฅ
                if (this.root) {
                    // dirtyRegionPolicy hack
                    if (!this._dirtyRegionPolicy && this.dirtyRegionPolicy) {
                        this.drawSurfaceToFrameBuffer(0, 0, this.rootRenderTarget.width, this.rootRenderTarget.height, 0, 0, this.rootRenderTarget.width, this.rootRenderTarget.height, true);
                    }
                    if (this._dirtyRegionPolicy) {
                        this.drawFrameBufferToSurface(0, 0, this.rootRenderTarget.width, this.rootRenderTarget.height, 0, 0, this.rootRenderTarget.width, this.rootRenderTarget.height);
                    }
                    this._dirtyRegionPolicy = this.dirtyRegionPolicy;
                }
            };
            /**
             * ไบคๆขframeBufferไธญ็ๅพๅๅฐsurfaceไธญ
             * @param width ๅฎฝๅบฆ
             * @param height ้ซๅบฆ
             */
            WebGLRenderBuffer.prototype.drawFrameBufferToSurface = function (sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, clear) {
                if (clear === void 0) {
                    clear = false;
                }
                this.rootRenderTarget.useFrameBuffer = false;
                this.rootRenderTarget.activate();
                this.context.disableStencilTest(); // ๅๆขframeBufferๆณจๆ่ฆ็ฆ็จSTENCIL_TEST
                this.context.disableScissorTest();
                this.setTransform(1, 0, 0, 1, 0, 0);
                this.globalAlpha = 1;
                this.context.setGlobalCompositeOperation("source-over");
                clear && this.context.clear();
                this.context.drawImage(this.rootRenderTarget, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, sourceWidth, sourceHeight, false);
                this.context.$drawWebGL();
                this.rootRenderTarget.useFrameBuffer = true;
                this.rootRenderTarget.activate();
                this.restoreStencil();
                this.restoreScissor();
            };
            /**
             * ไบคๆขsurface็ๅพๅๅฐframeBufferไธญ
             * @param width ๅฎฝๅบฆ
             * @param height ้ซๅบฆ
             */
            WebGLRenderBuffer.prototype.drawSurfaceToFrameBuffer = function (sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, clear) {
                if (clear === void 0) {
                    clear = false;
                }
                this.rootRenderTarget.useFrameBuffer = true;
                this.rootRenderTarget.activate();
                this.context.disableStencilTest(); // ๅๆขframeBufferๆณจๆ่ฆ็ฆ็จSTENCIL_TEST
                this.context.disableScissorTest();
                this.setTransform(1, 0, 0, 1, 0, 0);
                this.globalAlpha = 1;
                this.context.setGlobalCompositeOperation("source-over");
                clear && this.context.clear();
                this.context.drawImage(this.context.surface, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight, sourceWidth, sourceHeight, false);
                this.context.$drawWebGL();
                this.rootRenderTarget.useFrameBuffer = false;
                this.rootRenderTarget.activate();
                this.restoreStencil();
                this.restoreScissor();
            };
            /**
             * ๆธ็ฉบ็ผๅฒๅบๆฐๆฎ
             */
            WebGLRenderBuffer.prototype.clear = function () {
                this.context.clear();
            };
            WebGLRenderBuffer.prototype.setTransform = function (a, b, c, d, tx, ty) {
                // this.globalMatrix.setTo(a, b, c, d, tx, ty);
                var matrix = this.globalMatrix;
                matrix.a = a;
                matrix.b = b;
                matrix.c = c;
                matrix.d = d;
                matrix.tx = tx;
                matrix.ty = ty;
            };
            WebGLRenderBuffer.prototype.transform = function (a, b, c, d, tx, ty) {
                // this.globalMatrix.append(a, b, c, d, tx, ty);
                var matrix = this.globalMatrix;
                var a1 = matrix.a;
                var b1 = matrix.b;
                var c1 = matrix.c;
                var d1 = matrix.d;
                if (a != 1 || b != 0 || c != 0 || d != 1) {
                    matrix.a = a * a1 + b * c1;
                    matrix.b = a * b1 + b * d1;
                    matrix.c = c * a1 + d * c1;
                    matrix.d = c * b1 + d * d1;
                }
                matrix.tx = tx * a1 + ty * c1 + matrix.tx;
                matrix.ty = tx * b1 + ty * d1 + matrix.ty;
            };
            WebGLRenderBuffer.prototype.translate = function (dx, dy) {
                // this.globalMatrix.translate(dx, dy);
                var matrix = this.globalMatrix;
                matrix.tx += dx;
                matrix.ty += dy;
            };
            WebGLRenderBuffer.prototype.saveTransform = function () {
                // this.savedGlobalMatrix.copyFrom(this.globalMatrix);
                var matrix = this.globalMatrix;
                var sMatrix = this.savedGlobalMatrix;
                sMatrix.a = matrix.a;
                sMatrix.b = matrix.b;
                sMatrix.c = matrix.c;
                sMatrix.d = matrix.d;
                sMatrix.tx = matrix.tx;
                sMatrix.ty = matrix.ty;
            };
            WebGLRenderBuffer.prototype.restoreTransform = function () {
                // this.globalMatrix.copyFrom(this.savedGlobalMatrix);
                var matrix = this.globalMatrix;
                var sMatrix = this.savedGlobalMatrix;
                matrix.a = sMatrix.a;
                matrix.b = sMatrix.b;
                matrix.c = sMatrix.c;
                matrix.d = sMatrix.d;
                matrix.tx = sMatrix.tx;
                matrix.ty = sMatrix.ty;
            };
            /**
             * ๅๅปบไธไธชbufferๅฎไพ
             */
            WebGLRenderBuffer.create = function (width, height) {
                var buffer = renderBufferPool.pop();
                // width = Math.min(width, 1024);
                // height = Math.min(height, 1024);
                if (buffer) {
                    buffer.resize(width, height);
                    var matrix = buffer.globalMatrix;
                    matrix.a = 1;
                    matrix.b = 0;
                    matrix.c = 0;
                    matrix.d = 1;
                    matrix.tx = 0;
                    matrix.ty = 0;
                }
                else {
                    buffer = new WebGLRenderBuffer(width, height);
                    buffer.$computeDrawCall = false;
                }
                return buffer;
            };
            /**
             * ๅๆถไธไธชbufferๅฎไพ
             */
            WebGLRenderBuffer.release = function (buffer) {
                renderBufferPool.push(buffer);
            };
            WebGLRenderBuffer.autoClear = true;
            return WebGLRenderBuffer;
        }(egret.HashObject));
        web.WebGLRenderBuffer = WebGLRenderBuffer;
        __reflect(WebGLRenderBuffer.prototype, "egret.web.WebGLRenderBuffer", ["egret.sys.RenderBuffer"]);
        var renderBufferPool = []; //ๆธฒๆ็ผๅฒๅบๅฏน่ฑกๆฑ
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        var blendModes = ["source-over", "lighter", "destination-out"];
        var defaultCompositeOp = "source-over";
        var BLACK_COLOR = "#000000";
        var CAPS_STYLES = { none: 'butt', square: 'square', round: 'round' };
        var renderBufferPool = []; //ๆธฒๆ็ผๅฒๅบๅฏน่ฑกๆฑ
        /**
         * @private
         * WebGLๆธฒๆๅจ
         */
        var WebGLRenderer = (function () {
            function WebGLRenderer() {
                this.nestLevel = 0; //ๆธฒๆ็ๅตๅฅๅฑๆฌก๏ผ0่กจ็คบๅจ่ฐ็จๅๆ็ๆๅคๅฑใ
            }
            /**
             * ๆธฒๆไธไธชๆพ็คบๅฏน่ฑก
             * @param displayObject ่ฆๆธฒๆ็ๆพ็คบๅฏน่ฑก
             * @param buffer ๆธฒๆ็ผๅฒ
             * @param matrix ่ฆๅฏนๆพ็คบๅฏน่ฑกๆดไฝๅๅ็ๅๆข็ฉ้ต
             * @param dirtyList ่็ฉๅฝขๅ่กจ
             * @param forRenderTexture ็ปๅถ็ฎๆๆฏRenderTexture็ๆๅฟ
             * @returns drawCall่งฆๅ็ปๅถ็ๆฌกๆฐ
             */
            WebGLRenderer.prototype.render = function (displayObject, buffer, matrix, dirtyList, forRenderTexture) {
                this.nestLevel++;
                var webglBuffer = buffer;
                var webglBufferContext = webglBuffer.context;
                var root = forRenderTexture ? displayObject : null;
                webglBufferContext.pushBuffer(webglBuffer);
                //็ปๅถๆพ็คบๅฏน่ฑก
                this.drawDisplayObject(displayObject, webglBuffer, dirtyList, matrix, null, null, root);
                webglBufferContext.$drawWebGL();
                var drawCall = webglBuffer.$drawCalls;
                webglBuffer.onRenderFinish();
                webglBufferContext.popBuffer();
                this.nestLevel--;
                if (this.nestLevel === 0) {
                    //ๆๅคง็ผๅญ6ไธชๆธฒๆ็ผๅฒ
                    if (renderBufferPool.length > 6) {
                        renderBufferPool.length = 6;
                    }
                    var length_2 = renderBufferPool.length;
                    for (var i = 0; i < length_2; i++) {
                        renderBufferPool[i].resize(0, 0);
                    }
                }
                return drawCall;
            };
            /**
             * @private
             * ็ปๅถไธไธชๆพ็คบๅฏน่ฑก
             */
            WebGLRenderer.prototype.drawDisplayObject = function (displayObject, buffer, dirtyList, matrix, displayList, clipRegion, root) {
                var drawCalls = 0;
                var node;
                var filterPushed = false;
                if (displayList && !root) {
                    if (displayList.isDirty) {
                        drawCalls += displayList.drawToSurface();
                    }
                    node = displayList.$renderNode;
                }
                else {
                    node = displayObject.$getRenderNode();
                }
                if (node) {
                    if (dirtyList) {
                        var renderRegion = node.renderRegion;
                        if (clipRegion && !clipRegion.intersects(renderRegion)) {
                            node.needRedraw = false;
                        }
                        else if (!node.needRedraw) {
                            var l = dirtyList.length;
                            for (var j = 0; j < l; j++) {
                                if (renderRegion.intersects(dirtyList[j])) {
                                    node.needRedraw = true;
                                    break;
                                }
                            }
                        }
                    }
                    else {
                        node.needRedraw = true;
                    }
                    if (node.needRedraw) {
                        drawCalls++;
                        var renderAlpha = void 0;
                        var m = void 0;
                        if (root) {
                            renderAlpha = displayObject.$getConcatenatedAlphaAt(root, displayObject.$getConcatenatedAlpha());
                            m = egret.Matrix.create().copyFrom(displayObject.$getConcatenatedMatrix());
                            displayObject.$getConcatenatedMatrixAt(root, m);
                        }
                        else {
                            renderAlpha = node.renderAlpha;
                            m = egret.Matrix.create().copyFrom(node.renderMatrix);
                        }
                        matrix.$preMultiplyInto(m, m);
                        buffer.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                        egret.Matrix.release(m);
                        buffer.globalAlpha = renderAlpha;
                        this.renderNode(node, buffer);
                        node.needRedraw = false;
                    }
                }
                if (displayList && !root) {
                    return drawCalls;
                }
                var children = displayObject.$children;
                if (children) {
                    var length_3 = children.length;
                    for (var i = 0; i < length_3; i++) {
                        var child = children[i];
                        if (!child.$visible || child.$alpha <= 0 || child.$maskedObject) {
                            continue;
                        }
                        var filters = child.$getFilters();
                        if (filters && filters.length > 0) {
                            drawCalls += this.drawWithFilter(child, buffer, dirtyList, matrix, clipRegion, root);
                        }
                        else if ((child.$blendMode !== 0 ||
                            (child.$mask && (child.$mask.$parentDisplayList || root)))) {
                            drawCalls += this.drawWithClip(child, buffer, dirtyList, matrix, clipRegion, root);
                        }
                        else if (child.$scrollRect || child.$maskRect) {
                            drawCalls += this.drawWithScrollRect(child, buffer, dirtyList, matrix, clipRegion, root);
                        }
                        else {
                            if (child["isFPS"]) {
                                buffer.context.$drawWebGL();
                                buffer.$computeDrawCall = false;
                                this.drawDisplayObject(child, buffer, dirtyList, matrix, child.$displayList, clipRegion, root);
                                buffer.context.$drawWebGL();
                                buffer.$computeDrawCall = true;
                            }
                            else {
                                drawCalls += this.drawDisplayObject(child, buffer, dirtyList, matrix, child.$displayList, clipRegion, root);
                            }
                        }
                    }
                }
                return drawCalls;
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.drawWithFilter = function (displayObject, buffer, dirtyList, matrix, clipRegion, root) {
                var drawCalls = 0;
                if (displayObject.$children && displayObject.$children.length == 0) {
                    return;
                }
                var filters = displayObject.$getFilters();
                var hasBlendMode = (displayObject.$blendMode !== 0);
                var compositeOp;
                if (hasBlendMode) {
                    compositeOp = blendModes[displayObject.$blendMode];
                    if (!compositeOp) {
                        compositeOp = defaultCompositeOp;
                    }
                }
                if (!displayObject.mask && filters.length == 1 && (filters[0].type == "colorTransform" || (filters[0].type === "custom" && filters[0].padding === 0))) {
                    var childrenDrawCount = this.getRenderCount(displayObject);
                    if (!displayObject.$children || childrenDrawCount == 1) {
                        if (hasBlendMode) {
                            buffer.context.setGlobalCompositeOperation(compositeOp);
                        }
                        buffer.context.$filter = filters[0];
                        if (displayObject.$scrollRect || displayObject.$maskRect) {
                            drawCalls += this.drawWithScrollRect(displayObject, buffer, dirtyList, matrix, clipRegion, root);
                        }
                        else {
                            drawCalls += this.drawDisplayObject(displayObject, buffer, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                        }
                        buffer.context.$filter = null;
                        if (hasBlendMode) {
                            buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                        }
                        return drawCalls;
                    }
                }
                // ่ทๅๆพ็คบๅฏน่ฑก็้พๆฅ็ฉ้ต
                var displayMatrix = egret.Matrix.create();
                displayMatrix.copyFrom(displayObject.$getConcatenatedMatrix());
                if (root) {
                    displayObject.$getConcatenatedMatrixAt(root, displayMatrix);
                }
                // ่ทๅๆพ็คบๅฏน่ฑก็็ฉๅฝขๅบๅ
                var region;
                region = egret.sys.Region.create();
                var bounds = displayObject.$getOriginalBounds();
                region.updateRegion(bounds, displayMatrix);
                // ไธบๆพ็คบๅฏน่ฑกๅๅปบไธไธชๆฐ็buffer
                // todo ่ฟ้ๅบ่ฏฅ่ฎก็ฎ region.x region.y
                var displayBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d);
                displayBuffer.context.pushBuffer(displayBuffer);
                displayBuffer.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                var offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                //todo ๅฏไปฅไผๅๅๅฐdrawๆฌกๆฐ
                if ((displayObject.$mask && (displayObject.$mask.$parentDisplayList || root))) {
                    drawCalls += this.drawWithClip(displayObject, displayBuffer, dirtyList, offsetM, region, root);
                }
                else if (displayObject.$scrollRect || displayObject.$maskRect) {
                    drawCalls += this.drawWithScrollRect(displayObject, displayBuffer, dirtyList, offsetM, region, root);
                }
                else {
                    drawCalls += this.drawDisplayObject(displayObject, displayBuffer, dirtyList, offsetM, displayObject.$displayList, region, root);
                }
                egret.Matrix.release(offsetM);
                displayBuffer.context.popBuffer();
                //็ปๅถ็ปๆๅฐๅฑๅน
                if (drawCalls > 0) {
                    if (hasBlendMode) {
                        buffer.context.setGlobalCompositeOperation(compositeOp);
                    }
                    drawCalls++;
                    buffer.globalAlpha = 1;
                    buffer.setTransform(1, 0, 0, 1, (region.minX + matrix.tx) * matrix.a, (region.minY + matrix.ty) * matrix.d);
                    // ็ปๅถ็ปๆ็ๆถๅ๏ผๅบ็จๆปค้
                    buffer.context.drawTargetWidthFilters(filters, displayBuffer);
                    if (hasBlendMode) {
                        buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                    }
                }
                renderBufferPool.push(displayBuffer);
                egret.sys.Region.release(region);
                egret.Matrix.release(displayMatrix);
                return drawCalls;
            };
            WebGLRenderer.prototype.getRenderCount = function (displayObject) {
                var childrenDrawCount = 0;
                if (displayObject.$children) {
                    for (var _i = 0, _a = displayObject.$children; _i < _a.length; _i++) {
                        var child = _a[_i];
                        var node = child.$getRenderNode();
                        if (node) {
                            childrenDrawCount += node.$getRenderCount();
                        }
                        if (child.$children) {
                            childrenDrawCount += this.getRenderCount(child);
                        }
                    }
                }
                return childrenDrawCount;
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.drawWithClip = function (displayObject, buffer, dirtyList, matrix, clipRegion, root) {
                var drawCalls = 0;
                var hasBlendMode = (displayObject.$blendMode !== 0);
                var compositeOp;
                if (hasBlendMode) {
                    compositeOp = blendModes[displayObject.$blendMode];
                    if (!compositeOp) {
                        compositeOp = defaultCompositeOp;
                    }
                }
                var scrollRect = displayObject.$scrollRect ? displayObject.$scrollRect : displayObject.$maskRect;
                var mask = displayObject.$mask;
                if (mask) {
                    var maskRenderNode = mask.$getRenderNode();
                    if (maskRenderNode) {
                        var maskRenderMatrix = maskRenderNode.renderMatrix;
                        //้ฎ็ฝฉscaleXๆscaleYไธบ0๏ผๆพๅผ็ปๅถ
                        if ((maskRenderMatrix.a == 0 && maskRenderMatrix.b == 0) || (maskRenderMatrix.c == 0 && maskRenderMatrix.d == 0)) {
                            return drawCalls;
                        }
                    }
                }
                //if (mask && !mask.$parentDisplayList) {
                //    mask = null; //ๅฆๆ้ฎ็ฝฉไธๅจๆพ็คบๅ่กจไธญ๏ผๆพๅผ็ปๅถ้ฎ็ฝฉใ
                //}
                //่ฎก็ฎscrollRectๅmask็clipๅบๅๆฏๅฆ้่ฆ็ปๅถ๏ผไธ้่ฆๅฐฑ็ดๆฅ่ฟๅ๏ผ่ทณ่ฟๆๆๅญ้กน็้ๅใ
                var maskRegion;
                var displayMatrix = egret.Matrix.create();
                displayMatrix.copyFrom(displayObject.$getConcatenatedMatrix());
                if (root) {
                    displayObject.$getConcatenatedMatrixAt(root, displayMatrix);
                }
                else if (displayObject.$parentDisplayList) {
                    var displayRoot = displayObject.$parentDisplayList.root;
                    if (displayRoot !== displayObject.$stage) {
                        displayObject.$getConcatenatedMatrixAt(displayRoot, displayMatrix);
                    }
                }
                var bounds;
                if (mask) {
                    bounds = mask.$getOriginalBounds();
                    maskRegion = egret.sys.Region.create();
                    var m = egret.Matrix.create();
                    m.copyFrom(mask.$getConcatenatedMatrix());
                    if (root) {
                        mask.$getConcatenatedMatrixAt(root, m);
                    }
                    maskRegion.updateRegion(bounds, m);
                    egret.Matrix.release(m);
                }
                var region;
                if (scrollRect) {
                    region = egret.sys.Region.create();
                    region.updateRegion(scrollRect, displayMatrix);
                }
                if (region && maskRegion) {
                    region.intersect(maskRegion);
                    egret.sys.Region.release(maskRegion);
                }
                else if (!region && maskRegion) {
                    region = maskRegion;
                }
                if (region) {
                    if (region.isEmpty() || (clipRegion && !clipRegion.intersects(region))) {
                        egret.sys.Region.release(region);
                        egret.Matrix.release(displayMatrix);
                        return drawCalls;
                    }
                }
                else {
                    region = egret.sys.Region.create();
                    bounds = displayObject.$getOriginalBounds();
                    region.updateRegion(bounds, displayMatrix);
                }
                var found = false;
                if (!dirtyList) {
                    found = true;
                }
                else {
                    var l = dirtyList.length;
                    for (var j = 0; j < l; j++) {
                        if (region.intersects(dirtyList[j])) {
                            found = true;
                            break;
                        }
                    }
                }
                if (!found) {
                    egret.sys.Region.release(region);
                    egret.Matrix.release(displayMatrix);
                    return drawCalls;
                }
                //ๆฒกๆ้ฎ็ฝฉ,ๅๆถๆพ็คบๅฏน่ฑกๆฒกๆๅญ้กน
                if (!mask && (!displayObject.$children || displayObject.$children.length == 0)) {
                    if (scrollRect) {
                        var m = displayMatrix;
                        buffer.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                        buffer.context.pushMask(scrollRect);
                    }
                    //็ปๅถๆพ็คบๅฏน่ฑก
                    if (hasBlendMode) {
                        buffer.context.setGlobalCompositeOperation(compositeOp);
                    }
                    drawCalls += this.drawDisplayObject(displayObject, buffer, dirtyList, matrix, displayObject.$displayList, clipRegion, root);
                    if (hasBlendMode) {
                        buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                    }
                    if (scrollRect) {
                        buffer.context.popMask();
                    }
                    egret.sys.Region.release(region);
                    egret.Matrix.release(displayMatrix);
                    return drawCalls;
                }
                else {
                    //็ปๅถๆพ็คบๅฏน่ฑก่ช่บซ๏ผ่ฅๆscrollRect๏ผๅบ็จclip
                    var displayBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d);
                    // let displayContext = displayBuffer.context;
                    displayBuffer.context.pushBuffer(displayBuffer);
                    displayBuffer.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                    var offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                    drawCalls += this.drawDisplayObject(displayObject, displayBuffer, dirtyList, offsetM, displayObject.$displayList, region, root);
                    //็ปๅถ้ฎ็ฝฉ
                    if (mask) {
                        //ๅฆๆๅชๆไธๆฌก็ปๅถๆๆฏๅทฒ็ป่ขซcache็ดๆฅ็ปๅถๅฐdisplayContext
                        //webglๆๆถๆๆณๆทปๅ,ๅไธบไผๆ่พน็ๅ็ดๆฒกๆ่ขซๆฆ้ค
                        //let maskRenderNode = mask.$getRenderNode();
                        //if (maskRenderNode && maskRenderNode.$getRenderCount() == 1 || mask.$displayList) {
                        //    displayBuffer.context.setGlobalCompositeOperation("destination-in");
                        //    drawCalls += this.drawDisplayObject(mask, displayBuffer, dirtyList, offsetM,
                        //        mask.$displayList, region, root);
                        //}
                        //else {
                        var maskBuffer = this.createRenderBuffer(region.width * matrix.a, region.height * matrix.d);
                        maskBuffer.context.pushBuffer(maskBuffer);
                        maskBuffer.setTransform(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                        offsetM = egret.Matrix.create().setTo(matrix.a, 0, 0, matrix.d, -region.minX * matrix.a, -region.minY * matrix.d);
                        drawCalls += this.drawDisplayObject(mask, maskBuffer, dirtyList, offsetM, mask.$displayList, region, root);
                        maskBuffer.context.popBuffer();
                        displayBuffer.context.setGlobalCompositeOperation("destination-in");
                        displayBuffer.setTransform(1, 0, 0, -1, 0, maskBuffer.height);
                        displayBuffer.globalAlpha = 1;
                        var maskBufferWidth = maskBuffer.rootRenderTarget.width;
                        var maskBufferHeight = maskBuffer.rootRenderTarget.height;
                        displayBuffer.context.drawTexture(maskBuffer.rootRenderTarget.texture, 0, 0, maskBufferWidth, maskBufferHeight, 0, 0, maskBufferWidth, maskBufferHeight, maskBufferWidth, maskBufferHeight);
                        displayBuffer.context.setGlobalCompositeOperation("source-over");
                        renderBufferPool.push(maskBuffer);
                        //}
                    }
                    egret.Matrix.release(offsetM);
                    displayBuffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                    displayBuffer.context.popBuffer();
                    //็ปๅถ็ปๆๅฐๅฑๅน
                    if (drawCalls > 0) {
                        drawCalls++;
                        if (hasBlendMode) {
                            buffer.context.setGlobalCompositeOperation(compositeOp);
                        }
                        if (scrollRect) {
                            var m = displayMatrix;
                            matrix.$preMultiplyInto(m, m);
                            displayBuffer.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                            displayBuffer.context.pushMask(scrollRect);
                        }
                        buffer.globalAlpha = 1;
                        buffer.setTransform(1, 0, 0, -1, (region.minX + matrix.tx) * matrix.a, (region.minY + matrix.ty) * matrix.d + displayBuffer.height);
                        var displayBufferWidth = displayBuffer.rootRenderTarget.width;
                        var displayBufferHeight = displayBuffer.rootRenderTarget.height;
                        buffer.context.drawTexture(displayBuffer.rootRenderTarget.texture, 0, 0, displayBufferWidth, displayBufferHeight, 0, 0, displayBufferWidth, displayBufferHeight, displayBufferWidth, displayBufferHeight);
                        if (scrollRect) {
                            displayBuffer.context.popMask();
                        }
                        if (hasBlendMode) {
                            buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                        }
                    }
                    renderBufferPool.push(displayBuffer);
                    egret.sys.Region.release(region);
                    egret.Matrix.release(displayMatrix);
                    return drawCalls;
                }
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.drawWithScrollRect = function (displayObject, buffer, dirtyList, matrix, clipRegion, root) {
                var drawCalls = 0;
                var scrollRect = displayObject.$scrollRect ? displayObject.$scrollRect : displayObject.$maskRect;
                if (scrollRect.isEmpty()) {
                    return drawCalls;
                }
                var m = egret.Matrix.create();
                m.copyFrom(displayObject.$getConcatenatedMatrix());
                if (root) {
                    displayObject.$getConcatenatedMatrixAt(root, m);
                }
                else if (displayObject.$parentDisplayList) {
                    var displayRoot = displayObject.$parentDisplayList.root;
                    if (displayRoot !== displayObject.$stage) {
                        displayObject.$getConcatenatedMatrixAt(displayRoot, m);
                    }
                }
                var region = egret.sys.Region.create();
                region.updateRegion(scrollRect, m);
                if (region.isEmpty() || (clipRegion && !clipRegion.intersects(region))) {
                    egret.sys.Region.release(region);
                    egret.Matrix.release(m);
                    return drawCalls;
                }
                var found = false;
                if (!dirtyList) {
                    found = true;
                }
                else {
                    var l = dirtyList.length;
                    for (var j = 0; j < l; j++) {
                        if (region.intersects(dirtyList[j])) {
                            found = true;
                            break;
                        }
                    }
                }
                if (!found) {
                    egret.sys.Region.release(region);
                    egret.Matrix.release(m);
                    return drawCalls;
                }
                //็ปๅถๆพ็คบๅฏน่ฑก่ช่บซ
                matrix.$preMultiplyInto(m, m);
                buffer.setTransform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                var context = buffer.context;
                var scissor = false;
                if (buffer.$hasScissor || m.b != 0 || m.c != 0) {
                    context.pushMask(scrollRect);
                }
                else {
                    var a = m.a;
                    var d = m.d;
                    var tx = m.tx;
                    var ty = m.ty;
                    var x = scrollRect.x;
                    var y = scrollRect.y;
                    var xMax = x + scrollRect.width;
                    var yMax = y + scrollRect.height;
                    var minX = void 0, minY = void 0, maxX = void 0, maxY = void 0;
                    //ไผๅ๏ผ้ๅธธๆๅตไธไธ็ผฉๆพ็ๅฏน่ฑกๅๅคๆฐ๏ผ็ดๆฅๅไธๅ็งป้ๅณๅฏใ
                    if (a == 1.0 && d == 1.0) {
                        minX = x + tx;
                        minY = y + ty;
                        maxX = xMax + tx;
                        maxY = yMax + ty;
                    }
                    else {
                        var x0 = a * x + tx;
                        var y0 = d * y + ty;
                        var x1 = a * xMax + tx;
                        var y1 = d * y + ty;
                        var x2 = a * xMax + tx;
                        var y2 = d * yMax + ty;
                        var x3 = a * x + tx;
                        var y3 = d * yMax + ty;
                        var tmp = 0;
                        if (x0 > x1) {
                            tmp = x0;
                            x0 = x1;
                            x1 = tmp;
                        }
                        if (x2 > x3) {
                            tmp = x2;
                            x2 = x3;
                            x3 = tmp;
                        }
                        minX = (x0 < x2 ? x0 : x2);
                        maxX = (x1 > x3 ? x1 : x3);
                        if (y0 > y1) {
                            tmp = y0;
                            y0 = y1;
                            y1 = tmp;
                        }
                        if (y2 > y3) {
                            tmp = y2;
                            y2 = y3;
                            y3 = tmp;
                        }
                        minY = (y0 < y2 ? y0 : y2);
                        maxY = (y1 > y3 ? y1 : y3);
                    }
                    context.enableScissor(minX, -maxY + buffer.height, maxX - minX, maxY - minY);
                    scissor = true;
                }
                drawCalls += this.drawDisplayObject(displayObject, buffer, dirtyList, matrix, displayObject.$displayList, region, root);
                buffer.setTransform(m.a, m.b, m.c, m.d, m.tx + matrix.tx, m.ty + matrix.ty);
                if (scissor) {
                    context.disableScissor();
                }
                else {
                    context.popMask();
                }
                egret.sys.Region.release(region);
                egret.Matrix.release(m);
                return drawCalls;
            };
            /**
             * ๅฐไธไธชRenderNodeๅฏน่ฑก็ปๅถๅฐๆธฒๆ็ผๅฒ
             * @param node ่ฆ็ปๅถ็่็น
             * @param buffer ๆธฒๆ็ผๅฒ
             * @param matrix ่ฆๅๅ็็ฉ้ต
             * @param forHitTest ็ปๅถ็ปๆๆฏ็จไบ็ขฐๆๆฃๆตใ่ฅไธบtrue๏ผๅฝๆธฒๆGraphicsNodeๆถ๏ผไผๅฟฝ็ฅ้ๆๅบฆๆทๅผ่ฎพ็ฝฎ๏ผๅจ้ฝ็ปๅถไธบไธ้ๆ็ใ
             */
            WebGLRenderer.prototype.drawNodeToBuffer = function (node, buffer, matrix, forHitTest) {
                var webglBuffer = buffer;
                //pushRenderTARGET
                webglBuffer.context.pushBuffer(webglBuffer);
                webglBuffer.setTransform(matrix.a, matrix.b, matrix.c, matrix.d, matrix.tx, matrix.ty);
                this.renderNode(node, buffer, forHitTest);
                webglBuffer.context.$drawWebGL();
                webglBuffer.onRenderFinish();
                //popRenderTARGET
                webglBuffer.context.popBuffer();
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.renderNode = function (node, buffer, forHitTest) {
                switch (node.type) {
                    case 1 /* BitmapNode */:
                        this.renderBitmap(node, buffer);
                        break;
                    case 2 /* TextNode */:
                        this.renderText(node, buffer);
                        break;
                    case 3 /* GraphicsNode */:
                        this.renderGraphics(node, buffer, forHitTest);
                        break;
                    case 4 /* GroupNode */:
                        this.renderGroup(node, buffer);
                        break;
                    case 6 /* SetAlphaNode */:
                        buffer.globalAlpha = node.drawData[0];
                        break;
                    case 7 /* MeshNode */:
                        this.renderMesh(node, buffer);
                        break;
                }
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.renderBitmap = function (node, buffer) {
                var image = node.image;
                if (!image) {
                    return;
                }
                //buffer.imageSmoothingEnabled = node.smoothing;
                var data = node.drawData;
                var length = data.length;
                var pos = 0;
                var m = node.matrix;
                var blendMode = node.blendMode;
                var alpha = node.alpha;
                if (m) {
                    buffer.saveTransform();
                    buffer.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                }
                //่ฟ้ไธ่่ๅตๅฅ
                if (blendMode) {
                    buffer.context.setGlobalCompositeOperation(blendModes[blendMode]);
                }
                var originAlpha;
                if (alpha == alpha) {
                    originAlpha = buffer.globalAlpha;
                    buffer.globalAlpha *= alpha;
                }
                if (node.filter) {
                    buffer.context.$filter = node.filter;
                    while (pos < length) {
                        buffer.context.drawImage(image, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.rotated, node.smoothing);
                    }
                    buffer.context.$filter = null;
                }
                else {
                    while (pos < length) {
                        buffer.context.drawImage(image, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.rotated, node.smoothing);
                    }
                }
                if (blendMode) {
                    buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                }
                if (alpha == alpha) {
                    buffer.globalAlpha = originAlpha;
                }
                if (m) {
                    buffer.restoreTransform();
                }
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.renderMesh = function (node, buffer) {
                var image = node.image;
                //buffer.imageSmoothingEnabled = node.smoothing;
                var data = node.drawData;
                var length = data.length;
                var pos = 0;
                var m = node.matrix;
                var blendMode = node.blendMode;
                var alpha = node.alpha;
                if (m) {
                    buffer.saveTransform();
                    buffer.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                }
                //่ฟ้ไธ่่ๅตๅฅ
                if (blendMode) {
                    buffer.context.setGlobalCompositeOperation(blendModes[blendMode]);
                }
                var originAlpha;
                if (alpha == alpha) {
                    originAlpha = buffer.globalAlpha;
                    buffer.globalAlpha *= alpha;
                }
                if (node.filter) {
                    buffer.context.$filter = node.filter;
                    while (pos < length) {
                        buffer.context.drawMesh(image, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.uvs, node.vertices, node.indices, node.bounds, node.smoothing);
                    }
                    buffer.context.$filter = null;
                }
                else {
                    while (pos < length) {
                        buffer.context.drawMesh(image, data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], data[pos++], node.imageWidth, node.imageHeight, node.uvs, node.vertices, node.indices, node.bounds, node.smoothing);
                    }
                }
                if (blendMode) {
                    buffer.context.setGlobalCompositeOperation(defaultCompositeOp);
                }
                if (alpha == alpha) {
                    buffer.globalAlpha = originAlpha;
                }
                if (m) {
                    buffer.restoreTransform();
                }
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.renderText = function (node, buffer) {
                var width = node.width - node.x;
                var height = node.height - node.y;
                var pixelRatio = egret.sys.DisplayList.$pixelRatio;
                var maxTextureSize = buffer.context.$maxTextureSize;
                if (width * pixelRatio > maxTextureSize || height * pixelRatio > maxTextureSize) {
                    pixelRatio *= width * pixelRatio > height * pixelRatio ? maxTextureSize / (width * pixelRatio) : maxTextureSize / (height * pixelRatio);
                }
                width *= pixelRatio;
                height *= pixelRatio;
                var x = node.x * pixelRatio;
                var y = node.y * pixelRatio;
                if (node.drawData.length == 0) {
                    return;
                }
                if (!this.canvasRenderBuffer || !this.canvasRenderBuffer.context) {
                    this.canvasRenderer = new egret.CanvasRenderer();
                    this.canvasRenderBuffer = new web.CanvasRenderBuffer(width, height);
                    if (pixelRatio != 1) {
                        this.canvasRenderBuffer.context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);
                    }
                }
                else if (node.dirtyRender) {
                    this.canvasRenderBuffer.resize(width, height);
                }
                if (!this.canvasRenderBuffer.context) {
                    return;
                }
                if (x || y) {
                    if (node.dirtyRender) {
                        this.canvasRenderBuffer.context.setTransform(pixelRatio, 0, 0, pixelRatio, -x, -y);
                    }
                    buffer.transform(1, 0, 0, 1, x / pixelRatio, y / pixelRatio);
                }
                if (node.dirtyRender) {
                    var surface = this.canvasRenderBuffer.surface;
                    this.canvasRenderer.renderText(node, this.canvasRenderBuffer.context);
                    // ๆท่ดcanvasๅฐtexture
                    var texture = node.$texture;
                    if (!texture) {
                        texture = buffer.context.createTexture(surface);
                        node.$texture = texture;
                    }
                    else {
                        // ้ๆฐๆท่ดๆฐ็ๅพๅ
                        buffer.context.updateTexture(texture, surface);
                    }
                    // ไฟๅญๆ่ดจๅฐบๅฏธ
                    node.$textureWidth = surface.width;
                    node.$textureHeight = surface.height;
                }
                var textureWidth = node.$textureWidth;
                var textureHeight = node.$textureHeight;
                buffer.context.drawTexture(node.$texture, 0, 0, textureWidth, textureHeight, 0, 0, textureWidth / pixelRatio, textureHeight / pixelRatio, textureWidth, textureHeight);
                if (x || y) {
                    if (node.dirtyRender) {
                        this.canvasRenderBuffer.context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);
                    }
                    buffer.transform(1, 0, 0, 1, -x / pixelRatio, -y / pixelRatio);
                }
                node.dirtyRender = false;
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.renderGraphics = function (node, buffer, forHitTest) {
                var width = node.width;
                var height = node.height;
                if (width <= 0 || height <= 0 || !width || !height || node.drawData.length == 0) {
                    return;
                }
                if (!this.canvasRenderBuffer || !this.canvasRenderBuffer.context) {
                    this.canvasRenderer = new egret.CanvasRenderer();
                    this.canvasRenderBuffer = new web.CanvasRenderBuffer(width, height);
                }
                else if (node.dirtyRender || forHitTest) {
                    this.canvasRenderBuffer.resize(width, height);
                }
                if (!this.canvasRenderBuffer.context) {
                    return;
                }
                if (node.x || node.y) {
                    if (node.dirtyRender || forHitTest) {
                        this.canvasRenderBuffer.context.translate(-node.x, -node.y);
                    }
                    buffer.transform(1, 0, 0, 1, node.x, node.y);
                }
                var surface = this.canvasRenderBuffer.surface;
                if (forHitTest) {
                    this.canvasRenderer.renderGraphics(node, this.canvasRenderBuffer.context, true);
                    egret.WebGLUtils.deleteWebGLTexture(surface);
                    var texture = buffer.context.getWebGLTexture(surface);
                    buffer.context.drawTexture(texture, 0, 0, width, height, 0, 0, width, height, surface.width, surface.height);
                }
                else {
                    if (node.dirtyRender) {
                        this.canvasRenderer.renderGraphics(node, this.canvasRenderBuffer.context);
                        // ๆท่ดcanvasๅฐtexture
                        var texture = node.$texture;
                        if (!texture) {
                            texture = buffer.context.createTexture(surface);
                            node.$texture = texture;
                        }
                        else {
                            // ้ๆฐๆท่ดๆฐ็ๅพๅ
                            buffer.context.updateTexture(texture, surface);
                        }
                        // ไฟๅญๆ่ดจๅฐบๅฏธ
                        node.$textureWidth = surface.width;
                        node.$textureHeight = surface.height;
                    }
                    var textureWidth = node.$textureWidth;
                    var textureHeight = node.$textureHeight;
                    buffer.context.drawTexture(node.$texture, 0, 0, textureWidth, textureHeight, 0, 0, textureWidth, textureHeight, textureWidth, textureHeight);
                }
                if (node.x || node.y) {
                    if (node.dirtyRender || forHitTest) {
                        this.canvasRenderBuffer.context.translate(node.x, node.y);
                    }
                    buffer.transform(1, 0, 0, 1, -node.x, -node.y);
                }
                if (!forHitTest) {
                    node.dirtyRender = false;
                }
            };
            WebGLRenderer.prototype.renderGroup = function (groupNode, buffer) {
                var m = groupNode.matrix;
                if (m) {
                    buffer.saveTransform();
                    buffer.transform(m.a, m.b, m.c, m.d, m.tx, m.ty);
                }
                var children = groupNode.drawData;
                var length = children.length;
                for (var i = 0; i < length; i++) {
                    var node = children[i];
                    this.renderNode(node, buffer);
                }
                if (m) {
                    buffer.restoreTransform();
                }
            };
            /**
             * @private
             */
            WebGLRenderer.prototype.createRenderBuffer = function (width, height) {
                var buffer = renderBufferPool.pop();
                if (buffer) {
                    buffer.resize(width, height);
                }
                else {
                    buffer = new web.WebGLRenderBuffer(width, height);
                    buffer.$computeDrawCall = false;
                }
                return buffer;
            };
            return WebGLRenderer;
        }());
        web.WebGLRenderer = WebGLRenderer;
        __reflect(WebGLRenderer.prototype, "egret.web.WebGLRenderer", ["egret.sys.SystemRenderer"]);
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WEBGL_ATTRIBUTE_TYPE;
        (function (WEBGL_ATTRIBUTE_TYPE) {
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["FLOAT_VEC2"] = 35664] = "FLOAT_VEC2";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["FLOAT_VEC3"] = 35665] = "FLOAT_VEC3";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["FLOAT_VEC4"] = 35666] = "FLOAT_VEC4";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["FLOAT"] = 5126] = "FLOAT";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["BYTE"] = 65535] = "BYTE";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["UNSIGNED_BYTE"] = 5121] = "UNSIGNED_BYTE";
            WEBGL_ATTRIBUTE_TYPE[WEBGL_ATTRIBUTE_TYPE["UNSIGNED_SHORT"] = 5123] = "UNSIGNED_SHORT";
        })(WEBGL_ATTRIBUTE_TYPE = web.WEBGL_ATTRIBUTE_TYPE || (web.WEBGL_ATTRIBUTE_TYPE = {}));
        /**
         * @private
         */
        var EgretWebGLAttribute = (function () {
            function EgretWebGLAttribute(gl, program, attributeData) {
                this.gl = gl;
                this.name = attributeData.name;
                this.type = attributeData.type;
                this.size = attributeData.size;
                this.location = gl.getAttribLocation(program, this.name);
                this.count = 0;
                this.initCount(gl);
                this.format = gl.FLOAT;
                this.initFormat(gl);
            }
            EgretWebGLAttribute.prototype.initCount = function (gl) {
                var type = this.type;
                switch (type) {
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT:
                    case WEBGL_ATTRIBUTE_TYPE.BYTE:
                    case WEBGL_ATTRIBUTE_TYPE.UNSIGNED_BYTE:
                    case WEBGL_ATTRIBUTE_TYPE.UNSIGNED_SHORT:
                        this.count = 1;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC2:
                        this.count = 2;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC3:
                        this.count = 3;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC4:
                        this.count = 4;
                        break;
                }
            };
            EgretWebGLAttribute.prototype.initFormat = function (gl) {
                var type = this.type;
                switch (type) {
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT:
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC2:
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC3:
                    case WEBGL_ATTRIBUTE_TYPE.FLOAT_VEC4:
                        this.format = gl.FLOAT;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.UNSIGNED_BYTE:
                        this.format = gl.UNSIGNED_BYTE;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.UNSIGNED_SHORT:
                        this.format = gl.UNSIGNED_SHORT;
                        break;
                    case WEBGL_ATTRIBUTE_TYPE.BYTE:
                        this.format = gl.BYTE;
                        break;
                }
            };
            return EgretWebGLAttribute;
        }());
        web.EgretWebGLAttribute = EgretWebGLAttribute;
        __reflect(EgretWebGLAttribute.prototype, "egret.web.EgretWebGLAttribute");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        function loadShader(gl, type, source) {
            var shader = gl.createShader(type);
            gl.shaderSource(shader, source);
            gl.compileShader(shader);
            var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
            if (!compiled) {
                console.log("shader not compiled!");
                console.log(gl.getShaderInfoLog(shader));
            }
            return shader;
        }
        function createWebGLProgram(gl, vertexShader, fragmentShader) {
            var program = gl.createProgram();
            gl.attachShader(program, vertexShader);
            gl.attachShader(program, fragmentShader);
            gl.linkProgram(program);
            return program;
        }
        function extractAttributes(gl, program) {
            var attributes = {};
            var totalAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);
            for (var i = 0; i < totalAttributes; i++) {
                var attribData = gl.getActiveAttrib(program, i);
                var name_2 = attribData.name;
                var attribute = new web.EgretWebGLAttribute(gl, program, attribData);
                attributes[name_2] = attribute;
            }
            return attributes;
        }
        function extractUniforms(gl, program) {
            var uniforms = {};
            var totalUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);
            for (var i = 0; i < totalUniforms; i++) {
                var uniformData = gl.getActiveUniform(program, i);
                var name_3 = uniformData.name;
                var uniform = new web.EgretWebGLUniform(gl, program, uniformData);
                uniforms[name_3] = uniform;
            }
            return uniforms;
        }
        /**
         * @private
         */
        var EgretWebGLProgram = (function () {
            function EgretWebGLProgram(gl, vertSource, fragSource) {
                this.vshaderSource = vertSource;
                this.fshaderSource = fragSource;
                this.vertexShader = loadShader(gl, gl.VERTEX_SHADER, this.vshaderSource);
                this.fragmentShader = loadShader(gl, gl.FRAGMENT_SHADER, this.fshaderSource);
                this.id = createWebGLProgram(gl, this.vertexShader, this.fragmentShader);
                this.uniforms = extractUniforms(gl, this.id);
                this.attributes = extractAttributes(gl, this.id);
            }
            /**
             * ่ทๅๆ้็WebGL Program
             * @param key {string} ๅฏนไบๅฏไธ็program็จๅบ๏ผๅฏนๅบๅฏไธ็key
             */
            EgretWebGLProgram.getProgram = function (gl, vertSource, fragSource, key) {
                if (!this.programCache[key]) {
                    this.programCache[key] = new EgretWebGLProgram(gl, vertSource, fragSource);
                }
                return this.programCache[key];
            };
            EgretWebGLProgram.deleteProgram = function (gl, vertSource, fragSource, key) {
                // TODO delete
            };
            EgretWebGLProgram.programCache = {};
            return EgretWebGLProgram;
        }());
        web.EgretWebGLProgram = EgretWebGLProgram;
        __reflect(EgretWebGLProgram.prototype, "egret.web.EgretWebGLProgram");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var WEBGL_UNIFORM_TYPE;
        (function (WEBGL_UNIFORM_TYPE) {
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_VEC2"] = 35664] = "FLOAT_VEC2";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_VEC3"] = 35665] = "FLOAT_VEC3";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_VEC4"] = 35666] = "FLOAT_VEC4";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["INT_VEC2"] = 35667] = "INT_VEC2";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["INT_VEC3"] = 35668] = "INT_VEC3";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["INT_VEC4"] = 35669] = "INT_VEC4";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["BOOL"] = 35670] = "BOOL";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["BOOL_VEC2"] = 35671] = "BOOL_VEC2";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["BOOL_VEC3"] = 35672] = "BOOL_VEC3";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["BOOL_VEC4"] = 35673] = "BOOL_VEC4";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_MAT2"] = 35674] = "FLOAT_MAT2";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_MAT3"] = 35675] = "FLOAT_MAT3";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT_MAT4"] = 35676] = "FLOAT_MAT4";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["SAMPLER_2D"] = 35678] = "SAMPLER_2D";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["SAMPLER_CUBE"] = 35680] = "SAMPLER_CUBE";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["BYTE"] = 65535] = "BYTE";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["UNSIGNED_BYTE"] = 5121] = "UNSIGNED_BYTE";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["SHORT"] = 5122] = "SHORT";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["UNSIGNED_SHORT"] = 5123] = "UNSIGNED_SHORT";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["INT"] = 5124] = "INT";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["UNSIGNED_INT"] = 5125] = "UNSIGNED_INT";
            WEBGL_UNIFORM_TYPE[WEBGL_UNIFORM_TYPE["FLOAT"] = 5126] = "FLOAT";
        })(WEBGL_UNIFORM_TYPE = web.WEBGL_UNIFORM_TYPE || (web.WEBGL_UNIFORM_TYPE = {}));
        /**
         * @private
         */
        var EgretWebGLUniform = (function () {
            function EgretWebGLUniform(gl, program, uniformData) {
                this.gl = gl;
                this.name = uniformData.name;
                this.type = uniformData.type;
                this.size = uniformData.size;
                this.location = gl.getUniformLocation(program, this.name);
                this.setDefaultValue();
                this.generateSetValue();
                this.generateUpload();
            }
            EgretWebGLUniform.prototype.setDefaultValue = function () {
                var type = this.type;
                switch (type) {
                    case WEBGL_UNIFORM_TYPE.FLOAT:
                    case WEBGL_UNIFORM_TYPE.SAMPLER_2D:
                    case WEBGL_UNIFORM_TYPE.SAMPLER_CUBE:
                    case WEBGL_UNIFORM_TYPE.BOOL:
                    case WEBGL_UNIFORM_TYPE.INT:
                        this.value = 0;
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC2:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC2:
                    case WEBGL_UNIFORM_TYPE.INT_VEC2:
                        this.value = [0, 0];
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC3:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC3:
                    case WEBGL_UNIFORM_TYPE.INT_VEC3:
                        this.value = [0, 0, 0];
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC4:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC4:
                    case WEBGL_UNIFORM_TYPE.INT_VEC4:
                        this.value = [0, 0, 0, 0];
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT2:
                        this.value = new Float32Array([
                            1, 0,
                            0, 1
                        ]);
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT3:
                        this.value = new Float32Array([
                            1, 0, 0,
                            0, 1, 0,
                            0, 0, 1
                        ]);
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT4:
                        this.value = new Float32Array([
                            1, 0, 0, 0,
                            0, 1, 0, 0,
                            0, 0, 1, 0,
                            0, 0, 0, 1
                        ]);
                        break;
                }
            };
            EgretWebGLUniform.prototype.generateSetValue = function () {
                var type = this.type;
                switch (type) {
                    case WEBGL_UNIFORM_TYPE.FLOAT:
                    case WEBGL_UNIFORM_TYPE.SAMPLER_2D:
                    case WEBGL_UNIFORM_TYPE.SAMPLER_CUBE:
                    case WEBGL_UNIFORM_TYPE.BOOL:
                    case WEBGL_UNIFORM_TYPE.INT:
                        this.setValue = function (value) {
                            var notEqual = this.value !== value;
                            this.value = value;
                            notEqual && this.upload();
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC2:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC2:
                    case WEBGL_UNIFORM_TYPE.INT_VEC2:
                        this.setValue = function (value) {
                            var notEqual = this.value[0] !== value.x || this.value[1] !== value.y;
                            this.value[0] = value.x;
                            this.value[1] = value.y;
                            notEqual && this.upload();
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC3:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC3:
                    case WEBGL_UNIFORM_TYPE.INT_VEC3:
                        this.setValue = function (value) {
                            this.value[0] = value.x;
                            this.value[1] = value.y;
                            this.value[2] = value.z;
                            this.upload();
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC4:
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC4:
                    case WEBGL_UNIFORM_TYPE.INT_VEC4:
                        this.setValue = function (value) {
                            this.value[0] = value.x;
                            this.value[1] = value.y;
                            this.value[2] = value.z;
                            this.value[3] = value.w;
                            this.upload();
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT2:
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT3:
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT4:
                        this.setValue = function (value) {
                            this.value.set(value);
                            this.upload();
                        };
                        break;
                }
            };
            EgretWebGLUniform.prototype.generateUpload = function () {
                var gl = this.gl;
                var type = this.type;
                var location = this.location;
                switch (type) {
                    case WEBGL_UNIFORM_TYPE.FLOAT:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform1f(location, value);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC2:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform2f(location, value[0], value[1]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC3:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform3f(location, value[0], value[1], value[2]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_VEC4:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform4f(location, value[0], value[1], value[2], value[3]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.SAMPLER_2D:
                    case WEBGL_UNIFORM_TYPE.SAMPLER_CUBE:
                    case WEBGL_UNIFORM_TYPE.BOOL:
                    case WEBGL_UNIFORM_TYPE.INT:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform1i(location, value);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC2:
                    case WEBGL_UNIFORM_TYPE.INT_VEC2:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform2i(location, value[0], value[1]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC3:
                    case WEBGL_UNIFORM_TYPE.INT_VEC3:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform3i(location, value[0], value[1], value[2]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.BOOL_VEC4:
                    case WEBGL_UNIFORM_TYPE.INT_VEC4:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniform4i(location, value[0], value[1], value[2], value[3]);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT2:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniformMatrix2fv(location, false, value);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT3:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniformMatrix3fv(location, false, value);
                        };
                        break;
                    case WEBGL_UNIFORM_TYPE.FLOAT_MAT4:
                        this.upload = function () {
                            var value = this.value;
                            gl.uniformMatrix4fv(location, false, value);
                        };
                        break;
                }
            };
            return EgretWebGLUniform;
        }());
        web.EgretWebGLUniform = EgretWebGLUniform;
        __reflect(EgretWebGLUniform.prototype, "egret.web.EgretWebGLUniform");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
var egret;
(function (egret) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var EgretShaderLib = (function () {
            function EgretShaderLib() {
            }
            EgretShaderLib.blur_frag = "precision mediump float;\nuniform vec2 blur;\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nuniform vec2 uTextureSize;\nvoid main()\n{\n    const int sampleRadius = 5;\n    const int samples = sampleRadius * 2 + 1;\n    vec2 blurUv = blur / uTextureSize;\n    vec4 color = vec4(0, 0, 0, 0);\n    vec2 uv = vec2(0.0, 0.0);\n    blurUv /= float(sampleRadius);\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\n        color += texture2D(uSampler, uv);\n    }\n    color /= float(samples);\n    gl_FragColor = color;\n}";
            EgretShaderLib.colorTransform_frag = "precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\n    if(texColor.a > 0.) {\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n    }\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}";
            EgretShaderLib.default_vert = "attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}";
            EgretShaderLib.glow_frag = "precision mediump float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float dist;\nuniform float angle;\nuniform vec4 color;\nuniform float alpha;\nuniform float blurX;\nuniform float blurY;\nuniform float strength;\nuniform float inner;\nuniform float knockout;\nuniform float hideObject;\nuniform vec2 uTextureSize;\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\nvoid main(void) {\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\n    const float linearSamplingTimes = 7.0;\n    const float circleSamplingTimes = 12.0;\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\n    vec4 curColor;\n    float totalAlpha = 0.0;\n    float maxTotalAlpha = 0.0;\n    float curDistanceX = 0.0;\n    float curDistanceY = 0.0;\n    float offsetX = dist * cos(angle) * px.x;\n    float offsetY = dist * sin(angle) * px.y;\n    const float PI = 3.14159265358979323846264;\n    float cosAngle;\n    float sinAngle;\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    float stepX = blurX * px.x / linearSamplingTimes;\n    float stepY = blurY * px.y / linearSamplingTimes;\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\n        cosAngle = cos(a + offset);\n        sinAngle = sin(a + offset);\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\n            curDistanceX = i * stepX * cosAngle;\n            curDistanceY = i * stepY * sinAngle;\n            \n            curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\n            totalAlpha += (linearSamplingTimes - i) * curColor.a;\n            maxTotalAlpha += (linearSamplingTimes - i);\n        }\n    }\n    ownColor.a = max(ownColor.a, 0.0001);\n    ownColor.rgb = ownColor.rgb / ownColor.a;\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\n}";
            EgretShaderLib.primitive_frag = "precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\n    gl_FragColor = vColor;\n}";
            EgretShaderLib.texture_frag = "precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}";
            return EgretShaderLib;
        }());
        web.EgretShaderLib = EgretShaderLib;
        __reflect(EgretShaderLib.prototype, "egret.web.EgretShaderLib");
    })(web = egret.web || (egret.web = {}));
})(egret || (egret = {}));
;
var __reflect = (this && this.__reflect) || function (p, c, t) {
    p.__class__ = c, t ? t.push(c) : t = [c], p.__types__ = p.__types__ ? t.concat(p.__types__) : t;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @classic
     * @private
     */
    var AnalyzerBase = (function (_super) {
        __extends(AnalyzerBase, _super);
        function AnalyzerBase() {
            var _this = _super.call(this) || this;
            _this.resourceConfig = null;
            _this.resourceConfig = (RES["configInstance"]);
            return _this;
        }
        /**
         * ๆทปๅไธไธชไบ็บง้ฎๅๅฐ้็ฝฎๅ่กจใ
         * @method RES.ResourceConfig#addSubkey
         * @param subkey {string} ่ฆๆทปๅ็ไบ็บง้ฎๅ
         * @param name {string} ไบ็บง้ฎๅๆๅฑ็่ตๆบnameๅฑๆง
         */
        AnalyzerBase.prototype.addSubkey = function (subkey, name) {
            this.resourceConfig.addSubkey(subkey, name);
        };
        /**
         * ๅ่ฝฝไธไธช่ตๆบๆไปถ
         * @param resItem ๅ่ฝฝ้กนไฟกๆฏ
         * @param compFunc ๅ่ฝฝๅฎๆๅ่ฐๅฝๆฐ,็คบไพ:compFunc(resItem:ResourceItem):void;
         * @param thisObject ๅ่ฝฝๅฎๆๅ่ฐๅฝๆฐ็thisๅผ็จ
         */
        AnalyzerBase.prototype.loadFile = function (resItem, compFunc, thisObject) {
        };
        /**
         * ๅๆญฅๆนๅผ่ทๅ่งฃๆๅฎๆ็ๆฐๆฎ
         * @param name ๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงใ
         */
        AnalyzerBase.prototype.getRes = function (name) {
        };
        /**
         * ้ๆฏๆไธช่ตๆบๆไปถ็ไบ่ฟๅถๆฐๆฎ,่ฟๅๆฏๅฆๅ้คๆๅใ
         * @param name ้็ฝฎๆไปถไธญๅ่ฝฝ้กน็nameๅฑๆง
         */
        AnalyzerBase.prototype.destroyRes = function (name) {
            return false;
        };
        /**
         * ่ฏปๅไธไธชๅญ็ฌฆไธฒ้็ฌฌไธไธช็นไนๅ็ๅๅฎนใ
         * @param name {string} ่ฆ่ฏปๅ็ๅญ็ฌฆไธฒ
         */
        AnalyzerBase.getStringPrefix = function (name) {
            if (!name) {
                return "";
            }
            var index = name.indexOf(".");
            if (index != -1) {
                return name.substring(0, index);
            }
            return "";
        };
        /**
         * ่ฏปๅไธไธชๅญ็ฌฆไธฒ้็ฌฌไธไธช็นไนๅ็ๅๅฎนใ
         * @param name {string} ่ฆ่ฏปๅ็ๅญ็ฌฆไธฒ
         */
        AnalyzerBase.getStringTail = function (name) {
            if (!name) {
                return "";
            }
            var index = name.indexOf(".");
            if (index != -1) {
                return name.substring(index + 1);
            }
            return "";
        };
        return AnalyzerBase;
    }(egret.HashObject));
    RES.AnalyzerBase = AnalyzerBase;
    __reflect(AnalyzerBase.prototype, "RES.AnalyzerBase");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var BinAnalyzer = (function (_super) {
        __extends(BinAnalyzer, _super);
        /**
         * ๆ้ๅฝๆฐ
         */
        function BinAnalyzer() {
            var _this = _super.call(this) || this;
            /**
             * ๅญ่ๆตๆฐๆฎ็ผๅญๅญๅธ
             */
            _this.fileDic = {};
            /**
             * ๅ่ฝฝ้กนๅญๅธ
             */
            _this.resItemDic = [];
            _this._dataFormat = egret.HttpResponseType.ARRAY_BUFFER;
            /**
             * Loaderๅฏน่ฑกๆฑ
             */
            _this.recycler = [];
            return _this;
        }
        /**
         * @inheritDoc
         */
        BinAnalyzer.prototype.loadFile = function (resItem, compFunc, thisObject) {
            if (this.fileDic[resItem.name]) {
                compFunc.call(thisObject, resItem);
                return;
            }
            var request = this.getRequest();
            this.resItemDic[request.hashCode] = { item: resItem, func: compFunc, thisObject: thisObject };
            request.open(RES.$getVirtualUrl(resItem.url));
            request.send();
        };
        /**
         * ่ทๅไธไธชURLLoaderๅฏน่ฑก
         */
        BinAnalyzer.prototype.getRequest = function () {
            var request = this.recycler.pop();
            if (!request) {
                request = new egret.HttpRequest();
                request.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
                request.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            }
            request.responseType = this._dataFormat;
            return request;
        };
        /**
         * ไธ้กนๅ่ฝฝ็ปๆ
         */
        BinAnalyzer.prototype.onLoadFinish = function (event) {
            var request = (event.target);
            var data = this.resItemDic[request.hashCode];
            delete this.resItemDic[request.hashCode];
            var resItem = data.item;
            var compFunc = data.func;
            resItem.loaded = (event.type == egret.Event.COMPLETE);
            if (resItem.loaded) {
                this.analyzeData(resItem, request.response);
            }
            this.recycler.push(request);
            compFunc.call(data.thisObject, resItem);
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ๆฐๆฎ
         */
        BinAnalyzer.prototype.analyzeData = function (resItem, data) {
            var name = resItem.name;
            if (this.fileDic[name] || (data != "" && !data)) {
                return;
            }
            this.fileDic[name] = data;
        };
        /**
         * @inheritDoc
         */
        BinAnalyzer.prototype.getRes = function (name) {
            return this.fileDic[name];
        };
        /**
         * @inheritDoc
         */
        BinAnalyzer.prototype.hasRes = function (name) {
            var res = this.getRes(name);
            return res != null;
        };
        /**
         * @inheritDoc
         */
        BinAnalyzer.prototype.destroyRes = function (name) {
            if (this.fileDic[name]) {
                this.onResourceDestroy(this.fileDic[name]);
                delete this.fileDic[name];
                return true;
            }
            return false;
        };
        BinAnalyzer.prototype.onResourceDestroy = function (resource) {
        };
        return BinAnalyzer;
    }(RES.AnalyzerBase));
    RES.BinAnalyzer = BinAnalyzer;
    __reflect(BinAnalyzer.prototype, "RES.BinAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * Resource term. One of the resources arrays in resource.json.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ตๆบ้กนใๅฏนๅบ resource.json ไธญ resources ๆฐ็ปไธญ็ไธ้กนใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var ResourceItem = (function () {
        /**
         * Constructor.
         * @param name Name of resource term.
         * @param url URL of resource term.
         * @param type Type of resource term.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         * @param name ๅ่ฝฝ้กนๅ็งฐใ
         * @param url ่ฆๅ่ฝฝ็ๆไปถๅฐๅใ
         * @param type ๅ่ฝฝ้กนๆไปถ็ฑปๅใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        function ResourceItem(name, url, type) {
            /**
             * Name of the resource term group.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ตๆบๆๅฑ็็ปๅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            this.groupName = "";
            /**
             * The raw data object to be referenced.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ขซๅผ็จ็ๅๅงๆฐๆฎๅฏน่ฑกใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            this.data = null;
            this._loaded = false;
            this.name = name;
            this.url = url;
            this.type = type;
        }
        Object.defineProperty(ResourceItem.prototype, "loaded", {
            /**
             * Load complete flag.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅ่ฝฝๅฎๆ็ๆๅฟใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.data ? this.data.loaded : this._loaded;
            },
            set: function (value) {
                if (this.data)
                    this.data.loaded = value;
                this._loaded = value;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Turn into a string.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฝฌๆๅญ็ฌฆไธฒใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.prototype.toString = function () {
            return "[ResourceItem name=\"" + this.name + "\" url=\"" + this.url + "\" type=\"" + this.type + "\"]";
        };
        /**
         * XML file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * XML ๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_XML = "xml";
        /**
         * Picture file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅพ็ๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_IMAGE = "image";
        /**
         * Binary file.
         * @version Egret 2.4
         * @platform Web
         * @language en_US
         */
        /**
         * ไบ่ฟๅถๆไปถใ
         * @version Egret 2.4
         * @platform Web
         * @language zh_CN
         */
        ResourceItem.TYPE_BIN = "bin";
        /**
         * Text file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๆฌๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_TEXT = "text";
        /**
         * JSON file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * JSON ๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_JSON = "json";
        /**
         * SpriteSheet file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * SpriteSheet ๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_SHEET = "sheet";
        /**
         * BitmapTextSpriteSheet file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * BitmapTextSpriteSheet ๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_FONT = "font";
        /**
         * Sound file.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฃฐ้ณๆไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceItem.TYPE_SOUND = "sound";
        return ResourceItem;
    }());
    RES.ResourceItem = ResourceItem;
    __reflect(ResourceItem.prototype, "RES.ResourceItem");
})(RES || (RES = {}));
////////////////////////////////////////////////////////////////////////////////////////
////
////  Copyright (c) 2014-present, Egret Technology.
////  All rights reserved.
////  Redistribution and use in source and binary forms, with or without
////  modification, are permitted provided that the following conditions are met:
////
////     * Redistributions of source code must retain the above copyright
////       notice, this list of conditions and the following disclaimer.
////     * Redistributions in binary form must reproduce the above copyright
////       notice, this list of conditions and the following disclaimer in the
////       documentation and/or other materials provided with the distribution.
////     * Neither the name of the Egret nor the
////       names of its contributors may be used to endorse or promote products
////       derived from this software without specific prior written permission.
////
////  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
////  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
////  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
////  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
////  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
////  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
////  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
////  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
////  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
////  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
////
////////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * SpriteSheet่งฃๆๅจ
     * @private
     */
    var SheetAnalyzer = (function (_super) {
        __extends(SheetAnalyzer, _super);
        function SheetAnalyzer() {
            var _this = _super.call(this) || this;
            _this.sheetMap = {};
            _this.textureMap = {};
            /**
             * ImageLoaderๅฏน่ฑกๆฑ
             */
            _this.recyclerIamge = [];
            _this._dataFormat = egret.HttpResponseType.TEXT;
            return _this;
        }
        SheetAnalyzer.prototype.getRes = function (name) {
            var res = this.fileDic[name];
            if (!res) {
                res = this.textureMap[name];
            }
            if (!res) {
                var prefix = RES.AnalyzerBase.getStringPrefix(name);
                res = this.fileDic[prefix];
                if (res) {
                    var tail = RES.AnalyzerBase.getStringTail(name);
                    res = res.getTexture(tail);
                }
            }
            return res;
        };
        /**
         * ไธ้กนๅ่ฝฝ็ปๆ
         */
        SheetAnalyzer.prototype.onLoadFinish = function (event) {
            var request = event.target;
            var data = this.resItemDic[request.$hashCode];
            delete this.resItemDic[request.hashCode];
            var resItem = data.item;
            var compFunc = data.func;
            resItem.loaded = (event.type == egret.Event.COMPLETE);
            if (resItem.loaded) {
                if (request instanceof egret.HttpRequest) {
                    resItem.loaded = false;
                    var imageUrl = this.analyzeConfig(resItem, request.response);
                    if (imageUrl) {
                        this.loadImage(imageUrl, data);
                        this.recycler.push(request);
                        return;
                    }
                }
                else {
                    var texture = new egret.Texture();
                    texture._setBitmapData(request.data);
                    this.analyzeBitmap(resItem, texture);
                }
            }
            if (request instanceof egret.HttpRequest) {
                this.recycler.push(request);
            }
            else {
                this.recyclerIamge.push(request);
            }
            compFunc.call(data.thisObject, resItem);
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็้็ฝฎๆไปถ
         */
        SheetAnalyzer.prototype.analyzeConfig = function (resItem, data) {
            var name = resItem.name;
            var config;
            var imageUrl = "";
            try {
                var str = data;
                config = JSON.parse(str);
            }
            catch (e) {
                egret.$warn(1017, resItem.url, data);
            }
            if (config) {
                this.sheetMap[name] = config;
                imageUrl = this.getRelativePath(resItem.url, config["file"]);
            }
            return imageUrl;
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ไฝๅพๆฐๆฎ
         */
        SheetAnalyzer.prototype.analyzeBitmap = function (resItem, texture) {
            var name = resItem.name;
            if (this.fileDic[name] || !texture) {
                return;
            }
            var config = this.sheetMap[name];
            delete this.sheetMap[name];
            var targetName = resItem.data && resItem.data.subkeys ? "" : name;
            var spriteSheet = this.parseSpriteSheet(texture, config, targetName);
            this.fileDic[name] = spriteSheet;
        };
        /**
         * ่ทๅ็ธๅฏนไฝ็ฝฎ
         */
        SheetAnalyzer.prototype.getRelativePath = function (url, file) {
            url = url.split("\\").join("/");
            var params = url.match(/#.*|\?.*/);
            var paramUrl = "";
            if (params) {
                paramUrl = params[0];
            }
            var index = url.lastIndexOf("/");
            if (index != -1) {
                url = url.substring(0, index + 1) + file;
            }
            else {
                url = file;
            }
            return url + paramUrl;
        };
        SheetAnalyzer.prototype.parseSpriteSheet = function (texture, data, name) {
            var frames = data.frames;
            if (!frames) {
                return null;
            }
            var spriteSheet = new egret.SpriteSheet(texture);
            var textureMap = this.textureMap;
            for (var subkey in frames) {
                var config = frames[subkey];
                var texture_1 = spriteSheet.createTexture(subkey, config.x, config.y, config.w, config.h, config.offX, config.offY, config.sourceW, config.sourceH);
                if (config["scale9grid"]) {
                    var str = config["scale9grid"];
                    var list = str.split(",");
                    texture_1["scale9Grid"] = new egret.Rectangle(parseInt(list[0]), parseInt(list[1]), parseInt(list[2]), parseInt(list[3]));
                }
                if (textureMap[subkey] == null) {
                    textureMap[subkey] = texture_1;
                    if (name) {
                        this.addSubkey(subkey, name);
                    }
                }
            }
            return spriteSheet;
        };
        SheetAnalyzer.prototype.destroyRes = function (name) {
            var sheet = this.fileDic[name];
            if (sheet) {
                delete this.fileDic[name];
                var texture = void 0;
                for (var subkey in sheet._textureMap) {
                    if (texture == null) {
                        texture = sheet._textureMap[subkey];
                        this.onResourceDestroy(texture);
                        texture = null;
                    }
                    delete this.textureMap[subkey];
                }
                if (sheet.dispose) {
                    sheet.dispose();
                }
                return true;
            }
            return false;
        };
        SheetAnalyzer.prototype.loadImage = function (url, data) {
            var loader = this.getImageLoader();
            this.resItemDic[loader.hashCode] = data;
            loader.load(RES.$getVirtualUrl(url));
        };
        SheetAnalyzer.prototype.getImageLoader = function () {
            var loader = this.recyclerIamge.pop();
            if (!loader) {
                loader = new egret.ImageLoader();
                loader.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
                loader.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            }
            return loader;
        };
        SheetAnalyzer.prototype.onResourceDestroy = function (texture) {
            if (texture) {
                texture.dispose();
            }
        };
        return SheetAnalyzer;
    }(RES.BinAnalyzer));
    RES.SheetAnalyzer = SheetAnalyzer;
    __reflect(SheetAnalyzer.prototype, "RES.SheetAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var ImageAnalyzer = (function (_super) {
        __extends(ImageAnalyzer, _super);
        /**
         * ๆ้ๅฝๆฐ
         */
        function ImageAnalyzer() {
            var _this = _super.call(this) || this;
            /**
             * ๅญ่ๆตๆฐๆฎ็ผๅญๅญๅธ
             */
            _this.fileDic = {};
            /**
             * ๅ่ฝฝ้กนๅญๅธ
             */
            _this.resItemDic = [];
            /**
             * Loaderๅฏน่ฑกๆฑ
             */
            _this.recycler = [];
            return _this;
        }
        /**
         * @inheritDoc
         */
        ImageAnalyzer.prototype.loadFile = function (resItem, compFunc, thisObject) {
            if (this.fileDic[resItem.name]) {
                compFunc.call(thisObject, resItem);
                return;
            }
            var loader = this.getLoader();
            this.resItemDic[loader.$hashCode] = { item: resItem, func: compFunc, thisObject: thisObject };
            loader.load(RES.$getVirtualUrl(resItem.url));
        };
        /**
         * ่ทๅไธไธชLoaderๅฏน่ฑก
         */
        ImageAnalyzer.prototype.getLoader = function () {
            var loader = this.recycler.pop();
            if (!loader) {
                loader = new egret.ImageLoader();
                loader.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
                loader.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            }
            return loader;
        };
        /**
         * ไธ้กนๅ่ฝฝ็ปๆ
         */
        ImageAnalyzer.prototype.onLoadFinish = function (event) {
            var request = (event.$target);
            var data = this.resItemDic[request.$hashCode];
            delete this.resItemDic[request.$hashCode];
            var resItem = data.item;
            var compFunc = data.func;
            resItem.loaded = (event.$type == egret.Event.COMPLETE);
            if (resItem.loaded) {
                var texture = new egret.Texture();
                texture._setBitmapData(request.data);
                this.analyzeData(resItem, texture);
            }
            this.recycler.push(request);
            compFunc.call(data.thisObject, resItem);
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ๆฐๆฎ
         */
        ImageAnalyzer.prototype.analyzeData = function (resItem, texture) {
            var name = resItem.name;
            if (this.fileDic[name] || !texture) {
                return;
            }
            this.fileDic[name] = texture;
            var config = resItem.data;
            if (config && config["scale9grid"]) {
                var str = config["scale9grid"];
                var list = str.split(",");
                texture["scale9Grid"] = new egret.Rectangle(parseInt(list[0]), parseInt(list[1]), parseInt(list[2]), parseInt(list[3]));
            }
        };
        /**
         * @inheritDoc
         */
        ImageAnalyzer.prototype.getRes = function (name) {
            return this.fileDic[name];
        };
        /**
         * @inheritDoc
         */
        ImageAnalyzer.prototype.hasRes = function (name) {
            var res = this.getRes(name);
            return res != null;
        };
        /**
         * @inheritDoc
         */
        ImageAnalyzer.prototype.destroyRes = function (name) {
            if (this.fileDic[name]) {
                this.onResourceDestroy(this.fileDic[name]);
                delete this.fileDic[name];
                return true;
            }
            return false;
        };
        ImageAnalyzer.prototype.onResourceDestroy = function (texture) {
            texture.dispose();
        };
        return ImageAnalyzer;
    }(RES.AnalyzerBase));
    RES.ImageAnalyzer = ImageAnalyzer;
    __reflect(ImageAnalyzer.prototype, "RES.ImageAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var TextAnalyzer = (function (_super) {
        __extends(TextAnalyzer, _super);
        function TextAnalyzer() {
            var _this = _super.call(this) || this;
            _this._dataFormat = egret.HttpResponseType.TEXT;
            return _this;
        }
        return TextAnalyzer;
    }(RES.BinAnalyzer));
    RES.TextAnalyzer = TextAnalyzer;
    __reflect(TextAnalyzer.prototype, "RES.TextAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var JsonAnalyzer = (function (_super) {
        __extends(JsonAnalyzer, _super);
        function JsonAnalyzer() {
            var _this = _super.call(this) || this;
            _this._dataFormat = egret.HttpResponseType.TEXT;
            return _this;
        }
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ๆฐๆฎ
         */
        JsonAnalyzer.prototype.analyzeData = function (resItem, data) {
            var name = resItem.name;
            if (this.fileDic[name] || !data) {
                return;
            }
            try {
                var str = data;
                this.fileDic[name] = JSON.parse(str);
            }
            catch (e) {
                egret.$warn(1017, resItem.url, data);
            }
        };
        return JsonAnalyzer;
    }(RES.BinAnalyzer));
    RES.JsonAnalyzer = JsonAnalyzer;
    __reflect(JsonAnalyzer.prototype, "RES.JsonAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @class RES.ResourceLoader
     * @classdesc
     * @extends egret.EventDispatcher
     * @private
     */
    var ResourceLoader = (function (_super) {
        __extends(ResourceLoader, _super);
        /**
         * ๆ้ๅฝๆฐ
         * @method RES.ResourceLoader#constructor
         */
        function ResourceLoader() {
            var _this = _super.call(this) || this;
            /**
             * ๆๅคงๅนถๅๅ่ฝฝๆฐ
             */
            _this.thread = 2;
            /**
             * ๆญฃๅจๅ่ฝฝ็็บฟ็จ่ฎกๆฐ
             */
            _this.loadingCount = 0;
            /**
             * ไธ้กนๅ่ฝฝ็ปๆๅ่ฐๅฝๆฐใๆ่ฎบๅ่ฝฝๆๅๆ่ๅบ้้ฝๅฐๆง่กๅ่ฐๅฝๆฐใ็คบไพ๏ผcallBack(resItem:ResourceItem):void;
             * @member {Function} RES.ResourceLoader#callBack
             */
            _this.callBack = null;
            /**
             * RESๅไพ็ๅผ็จ
             * @member {any} RES.ResourceLoader#resInstance
             */
            _this.resInstance = null;
            /**
             * ๅฝๅ็ปๅ่ฝฝ็้กนๆปไธชๆฐ,keyไธบgroupName
             */
            _this.groupTotalDic = {};
            /**
             * ๅทฒ็ปๅ่ฝฝ็้กนไธชๆฐ,keyไธบgroupName
             */
            _this.numLoadedDic = {};
            /**
             * ๆญฃๅจๅ่ฝฝ็็ปๅ่กจ,keyไธบgroupName
             */
            _this.itemListDic = {};
            /**
             * ๅ่ฝฝๅคฑ่ดฅ็็ป,keyไธบgroupName
             */
            _this.groupErrorDic = {};
            _this.retryTimesDic = {};
            _this.maxRetryTimes = 3;
            _this.failedList = new Array();
            /**
             * ไผๅ็บง้ๅ,keyไธบpriority๏ผvalueไธบgroupNameๅ่กจ
             */
            _this.priorityQueue = {};
            /**
             * ๅปถ่ฟๅ่ฝฝ้ๅ
             */
            _this.lazyLoadList = new Array();
            /**
             * ่ตๆบ่งฃๆๅบๅญๅธ็ฑป
             */
            _this.analyzerDic = {};
            /**
             * ๅฝๅๅบ่ฏฅๅ่ฝฝๅไผๅ็บง้ๅ็็ฌฌๅๅ
             */
            _this.queueIndex = 0;
            return _this;
        }
        /**
         * ๆฃๆฅๆๅฎ็็ปๆฏๅฆๆญฃๅจๅ่ฝฝไธญ
         * @method RES.ResourceLoader#isGroupInLoading
         * @param groupName {string}
         * @returns {boolean}
         */
        ResourceLoader.prototype.isGroupInLoading = function (groupName) {
            return this.itemListDic[groupName] !== undefined;
        };
        /**
         * ๅผๅงๅ่ฝฝไธ็ปๆไปถ
         * @method RES.ResourceLoader#loadGroup
         * @param list {egret.Array<ResourceItem>} ๅ่ฝฝ้กนๅ่กจ
         * @param groupName {string} ็ปๅ
         * @param priority {number} ๅ่ฝฝไผๅ็บง
         */
        ResourceLoader.prototype.loadGroup = function (list, groupName, priority) {
            if (priority === void 0) {
                priority = 0;
            }
            if (this.itemListDic[groupName] || !groupName)
                return;
            if (!list || list.length == 0) {
                egret.$warn(3201, groupName);
                var event_1 = new RES.ResourceEvent(RES.ResourceEvent.GROUP_LOAD_ERROR);
                event_1.groupName = groupName;
                this.dispatchEvent(event_1);
                return;
            }
            if (this.priorityQueue[priority])
                this.priorityQueue[priority].push(groupName);
            else
                this.priorityQueue[priority] = [groupName];
            this.itemListDic[groupName] = list;
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var resItem = list[i];
                resItem.groupName = groupName;
            }
            this.groupTotalDic[groupName] = list.length;
            this.numLoadedDic[groupName] = 0;
            this.next();
        };
        /**
         * ๅ่ฝฝไธไธชๆไปถ
         * @method RES.ResourceLoader#loadItem
         * @param resItem {egret.ResourceItem} ่ฆๅ่ฝฝ็้กน
         */
        ResourceLoader.prototype.loadItem = function (resItem) {
            this.lazyLoadList.push(resItem);
            resItem.groupName = "";
            this.next();
        };
        /**
         * ๅ่ฝฝไธไธ้กน
         */
        ResourceLoader.prototype.next = function () {
            while (this.loadingCount < this.thread) {
                var resItem = this.getOneResourceItem();
                if (!resItem)
                    break;
                this.loadingCount++;
                if (resItem.loaded) {
                    this.onItemComplete(resItem);
                }
                else {
                    var analyzer = this.resInstance.$getAnalyzerByType(resItem.type);
                    analyzer.loadFile(resItem, this.onItemComplete, this);
                }
            }
        };
        /**
         * ่ทๅไธไธไธชๅพๅ่ฝฝ้กน
         */
        ResourceLoader.prototype.getOneResourceItem = function () {
            if (this.failedList.length > 0)
                return this.failedList.shift();
            var maxPriority = Number.NEGATIVE_INFINITY;
            for (var p in this.priorityQueue) {
                maxPriority = Math.max(maxPriority, p);
            }
            var queue = this.priorityQueue[maxPriority];
            if (!queue || queue.length == 0) {
                if (this.lazyLoadList.length == 0)
                    return null;
                //ๅ่ฏทๆฑ็ๅๅ่ฝฝ๏ผไปฅไพฟๆดๅฟซ่ทๅๅฝๅ้่ฆ็่ตๆบ
                return this.lazyLoadList.pop();
            }
            var length = queue.length;
            var list;
            for (var i = 0; i < length; i++) {
                if (this.queueIndex >= length)
                    this.queueIndex = 0;
                list = this.itemListDic[queue[this.queueIndex]];
                if (list.length > 0)
                    break;
                this.queueIndex++;
            }
            if (list.length == 0)
                return null;
            return list.shift();
        };
        /**
         * ๅ่ฝฝ็ปๆ
         */
        ResourceLoader.prototype.onItemComplete = function (resItem) {
            this.loadingCount--;
            var groupName = resItem.groupName;
            if (!resItem.loaded) {
                var times = this.retryTimesDic[resItem.name] || 1;
                if (times > this.maxRetryTimes) {
                    delete this.retryTimesDic[resItem.name];
                    RES.ResourceEvent.dispatchResourceEvent(this.resInstance, RES.ResourceEvent.ITEM_LOAD_ERROR, groupName, resItem);
                }
                else {
                    this.retryTimesDic[resItem.name] = times + 1;
                    this.failedList.push(resItem);
                    this.next();
                    return;
                }
            }
            if (groupName) {
                this.numLoadedDic[groupName]++;
                var itemsLoaded = this.numLoadedDic[groupName];
                var itemsTotal = this.groupTotalDic[groupName];
                if (!resItem.loaded) {
                    this.groupErrorDic[groupName] = true;
                }
                RES.ResourceEvent.dispatchResourceEvent(this.resInstance, RES.ResourceEvent.GROUP_PROGRESS, groupName, resItem, itemsLoaded, itemsTotal);
                if (itemsLoaded == itemsTotal) {
                    var groupError = this.groupErrorDic[groupName];
                    this.removeGroupName(groupName);
                    delete this.groupTotalDic[groupName];
                    delete this.numLoadedDic[groupName];
                    delete this.itemListDic[groupName];
                    delete this.groupErrorDic[groupName];
                    if (groupError) {
                        RES.ResourceEvent.dispatchResourceEvent(this, RES.ResourceEvent.GROUP_LOAD_ERROR, groupName);
                    }
                    else {
                        RES.ResourceEvent.dispatchResourceEvent(this, RES.ResourceEvent.GROUP_COMPLETE, groupName);
                    }
                }
            }
            else {
                this.callBack.call(this.resInstance, resItem);
            }
            this.next();
        };
        /**
         * ไปไผๅ็บง้ๅไธญ็งป้คๆๅฎ็็ปๅ
         */
        ResourceLoader.prototype.removeGroupName = function (groupName) {
            for (var p in this.priorityQueue) {
                var queue = this.priorityQueue[p];
                var index = 0;
                var found = false;
                var length_1 = queue.length;
                for (var i = 0; i < length_1; i++) {
                    var name_1 = queue[i];
                    if (name_1 == groupName) {
                        queue.splice(index, 1);
                        found = true;
                        break;
                    }
                    index++;
                }
                if (found) {
                    if (queue.length == 0) {
                        delete this.priorityQueue[p];
                    }
                    break;
                }
            }
        };
        return ResourceLoader;
    }(egret.EventDispatcher));
    RES.ResourceLoader = ResourceLoader;
    __reflect(ResourceLoader.prototype, "RES.ResourceLoader");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var FontAnalyzer = (function (_super) {
        __extends(FontAnalyzer, _super);
        function FontAnalyzer() {
            return _super.call(this) || this;
        }
        FontAnalyzer.prototype.analyzeConfig = function (resItem, data) {
            var name = resItem.name;
            var config;
            var imageUrl = "";
            try {
                var str = data;
                config = JSON.parse(str);
            }
            catch (e) {
            }
            if (config) {
                imageUrl = this.getRelativePath(resItem.url, config["file"]);
            }
            else {
                config = data;
                imageUrl = this.getTexturePath(resItem.url, config);
            }
            this.sheetMap[name] = config;
            return imageUrl;
        };
        FontAnalyzer.prototype.analyzeBitmap = function (resItem, texture) {
            var name = resItem.name;
            if (this.fileDic[name] || !texture) {
                return;
            }
            var config = this.sheetMap[name];
            delete this.sheetMap[name];
            var bitmapFont = new egret.BitmapFont(texture, config);
            this.fileDic[name] = bitmapFont;
        };
        FontAnalyzer.prototype.getTexturePath = function (url, fntText) {
            var file = "";
            var lines = fntText.split("\n");
            var pngLine = lines[2];
            var index = pngLine.indexOf("file=\"");
            if (index != -1) {
                pngLine = pngLine.substring(index + 6);
                index = pngLine.indexOf("\"");
                file = pngLine.substring(0, index);
            }
            url = url.split("\\").join("/");
            index = url.lastIndexOf("/");
            if (index != -1) {
                url = url.substring(0, index + 1) + file;
            }
            else {
                url = file;
            }
            return url;
        };
        FontAnalyzer.prototype.onResourceDestroy = function (font) {
            if (font) {
                font.dispose();
            }
        };
        return FontAnalyzer;
    }(RES.SheetAnalyzer));
    RES.FontAnalyzer = FontAnalyzer;
    __reflect(FontAnalyzer.prototype, "RES.FontAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @class RES.ResourceConfig
     * @classdesc
     * @private
     */
    var ResourceConfig = (function () {
        function ResourceConfig() {
            /**
             * ไธ็บง้ฎๅๅญๅธ
             */
            this.keyMap = {};
            /**
             * ๅ่ฝฝ็ปๅญๅธ
             */
            this.groupDic = {};
            RES["configInstance"] = this;
        }
        /**
         * ๆนๆฎ็ปๅ่ทๅ็ปๅ่ฝฝ้กนๅ่กจ
         * @method RES.ResourceConfig#getGroupByName
         * @param name {string} ็ปๅ
         * @returns {Array<egret.ResourceItem>}
         */
        ResourceConfig.prototype.getGroupByName = function (name) {
            var group = new Array();
            if (!this.groupDic[name])
                return group;
            var list = this.groupDic[name];
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var obj = list[i];
                group.push(this.parseResourceItem(obj));
            }
            return group;
        };
        /**
         * ๆนๆฎ็ปๅ่ทๅๅๅง็็ปๅ่ฝฝ้กนๅ่กจ
         * @method RES.ResourceConfig#getRawGroupByName
         * @param name {string} ็ปๅ
         * @returns {any[]}
         */
        ResourceConfig.prototype.getRawGroupByName = function (name) {
            if (this.groupDic[name])
                return this.groupDic[name];
            return [];
        };
        /**
         * ๅๅปบ่ชๅฎไน็ๅ่ฝฝ่ตๆบ็ป,ๆณจๆ๏ผๆญคๆนๆณไปๅจ่ตๆบ้็ฝฎๆไปถๅ่ฝฝๅฎๆๅๆง่กๆๆๆใ
         * ๅฏไปฅ็ๅฌResourceEvent.CONFIG_COMPLETEไบไปถๆฅ็กฎ่ฎค้็ฝฎๅ่ฝฝๅฎๆใ
         * @method RES.ResourceConfig#createGroup
         * @param name {string} ่ฆๅๅปบ็ๅ่ฝฝ่ตๆบ็ป็็ปๅ
         * @param keys {egret.string[]} ่ฆๅๅซ็้ฎๅๅ่กจ๏ผkeyๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงๆsbuKeysๅฑๆง็ไธ้กนๆไธไธช่ตๆบ็ปๅใ
         * @param override {boolean} ๆฏๅฆ่ฆ็ๅทฒ็ปๅญๅจ็ๅๅ่ตๆบ็ป,้ป่ฎคfalseใ
         * @returns {boolean}
         */
        ResourceConfig.prototype.createGroup = function (name, keys, override) {
            if (override === void 0) {
                override = false;
            }
            if ((!override && this.groupDic[name]) || !keys || keys.length == 0)
                return false;
            var groupDic = this.groupDic;
            var group = [];
            var length = keys.length;
            for (var i = 0; i < length; i++) {
                var key = keys[i];
                var g = groupDic[key];
                if (g) {
                    var len = g.length;
                    for (var j = 0; j < len; j++) {
                        var item = g[j];
                        if (group.indexOf(item) == -1)
                            group.push(item);
                    }
                }
                else {
                    var item = this.keyMap[key];
                    if (item) {
                        if (group.indexOf(item) == -1)
                            group.push(item);
                    }
                    else {
                        egret.$warn(3200, key);
                    }
                }
            }
            if (group.length == 0)
                return false;
            this.groupDic[name] = group;
            return true;
        };
        /**
         * ่งฃๆไธไธช้็ฝฎๆไปถ
         * @method RES.ResourceConfig#parseConfig
         * @param data {any} ้็ฝฎๆไปถๆฐๆฎ
         * @param folder {string} ๅ่ฝฝ้กน็่ทฏๅพๅ็ผใ
         */
        ResourceConfig.prototype.parseConfig = function (data, folder) {
            if (!data)
                return;
            var resources = data["resources"];
            if (resources) {
                var length_2 = resources.length;
                for (var i = 0; i < length_2; i++) {
                    var item = resources[i];
                    var url = item.url;
                    if (url && url.indexOf("://") == -1)
                        item.url = folder + url;
                    this.addItemToKeyMap(item);
                }
            }
            var groups = data["groups"];
            if (groups) {
                var length_3 = groups.length;
                for (var i = 0; i < length_3; i++) {
                    var group = groups[i];
                    var list = [];
                    var keys = group.keys.split(",");
                    var l = keys.length;
                    for (var j = 0; j < l; j++) {
                        var name_2 = keys[j].trim();
                        var item = this.keyMap[name_2];
                        if (item && list.indexOf(item) == -1) {
                            list.push(item);
                        }
                    }
                    this.groupDic[group.name] = list;
                }
            }
        };
        /**
         * ๆทปๅไธไธชไบ็บง้ฎๅๅฐ้็ฝฎๅ่กจใ
         * @method RES.ResourceConfig#addSubkey
         * @param subkey {string} ่ฆๆทปๅ็ไบ็บง้ฎๅ
         * @param name {string} ไบ็บง้ฎๅๆๅฑ็่ตๆบnameๅฑๆง
         */
        ResourceConfig.prototype.addSubkey = function (subkey, name) {
            var item = this.keyMap[name];
            if (item && !this.keyMap[subkey]) {
                this.keyMap[subkey] = item;
            }
        };
        /**
         * ๆทปๅไธไธชๅ่ฝฝ้กนๆฐๆฎๅฐๅ่กจ
         */
        ResourceConfig.prototype.addItemToKeyMap = function (item) {
            if (!this.keyMap[item.name])
                this.keyMap[item.name] = item;
            if (item.hasOwnProperty("subkeys")) {
                var subkeys = (item.subkeys).split(",");
                item.subkeys = subkeys;
                var length_4 = subkeys.length;
                for (var i = 0; i < length_4; i++) {
                    var key = subkeys[i];
                    if (this.keyMap[key] != null)
                        continue;
                    this.keyMap[key] = item;
                }
            }
        };
        /**
         * ่ทๅๅ่ฝฝ้กน็nameๅฑๆง
         * @method RES.ResourceConfig#getType
         * @param key {string} ๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงๆsbuKeysๅฑๆง็ไธ้กนใ
         * @returns {string}
         */
        ResourceConfig.prototype.getName = function (key) {
            var data = this.keyMap[key];
            return data ? data.name : "";
        };
        /**
         * ่ทๅๅ่ฝฝ้กน็ฑปๅใ
         * @method RES.ResourceConfig#getType
         * @param key {string} ๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงๆsbuKeysๅฑๆง็ไธ้กนใ
         * @returns {string}
         */
        ResourceConfig.prototype.getType = function (key) {
            var data = this.keyMap[key];
            return data ? data.type : "";
        };
        ResourceConfig.prototype.getRawResourceItem = function (key) {
            return this.keyMap[key];
        };
        /**
         * ่ทๅๅ่ฝฝ้กนไฟกๆฏๅฏน่ฑก
         * @method RES.ResourceConfig#getResourceItem
         * @param key {string} ๅฏนๅบ้็ฝฎๆไปถ้็keyๅฑๆงๆsbuKeysๅฑๆง็ไธ้กนใ
         * @returns {egret.ResourceItem}
         */
        ResourceConfig.prototype.getResourceItem = function (key) {
            var data = this.keyMap[key];
            if (data)
                return this.parseResourceItem(data);
            return null;
        };
        /**
         * ่ฝฌๆขObjectๆฐๆฎไธบResourceItemๅฏน่ฑก
         */
        ResourceConfig.prototype.parseResourceItem = function (data) {
            var resItem = new RES.ResourceItem(data.name, data.url, data.type);
            resItem.data = data;
            return resItem;
        };
        return ResourceConfig;
    }());
    RES.ResourceConfig = ResourceConfig;
    __reflect(ResourceConfig.prototype, "RES.ResourceConfig");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var XMLAnalyzer = (function (_super) {
        __extends(XMLAnalyzer, _super);
        function XMLAnalyzer() {
            var _this = _super.call(this) || this;
            _this._dataFormat = egret.HttpResponseType.TEXT;
            return _this;
        }
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ๆฐๆฎ
         */
        XMLAnalyzer.prototype.analyzeData = function (resItem, data) {
            var name = resItem.name;
            if (this.fileDic[name] || !data) {
                return;
            }
            try {
                var xmlStr = data;
                var xml = egret.XML.parse(xmlStr);
                this.fileDic[name] = xml;
            }
            catch (e) {
            }
        };
        return XMLAnalyzer;
    }(RES.BinAnalyzer));
    RES.XMLAnalyzer = XMLAnalyzer;
    __reflect(XMLAnalyzer.prototype, "RES.XMLAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * The events of resource loading.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ตๆบๅ่ฝฝไบไปถใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var ResourceEvent = (function (_super) {
        __extends(ResourceEvent, _super);
        /**
         * Creates an Event object to pass as a parameter to event listeners.
         * @param type  The type of the event, accessible as Event.type.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         * @version Egret 2.4
         * @platform Web,Native
         * @private
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชไฝไธบๅๆฐไผ้็ปไบไปถไพฆๅฌๅจ็ Event ๅฏน่ฑกใ
         * @param type  ไบไปถ็็ฑปๅ๏ผๅฏไปฅไฝไธบ Event.type ่ฎฟ้ฎใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         * @version Egret 2.4
         * @platform Web,Native
         * @private
         * @language zh_CN
         */
        function ResourceEvent(type, bubbles, cancelable) {
            if (bubbles === void 0) {
                bubbles = false;
            }
            if (cancelable === void 0) {
                cancelable = false;
            }
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            /**
             * File number that has been loaded.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅทฒ็ปๅ่ฝฝ็ๆไปถๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.itemsLoaded = 0;
            /**
             * Total file number to load.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๅ่ฝฝ็ๆปๆไปถๆฐใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.itemsTotal = 0;
            /**
             * Resource group name.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ตๆบ็ปๅใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.groupName = "";
            /**
             * An item of information that is finished by the end of a load.
             * @version Egret 2.4
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธๆฌกๅ่ฝฝ้กนๅ่ฝฝ็ปๆ็้กนไฟกๆฏๅฏน่ฑกใ
             * @version Egret 2.4
             * @platform Web,Native
             * @language zh_CN
             */
            _this.resItem = null;
            return _this;
        }
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         * @method RES.ResourceEvent.dispatchResourceEvent
         * @param target {egret.IEventDispatcher}
         * @param type {string}
         * @param groupName {string}
         * @param resItem {egret.ResourceItem}
         * @param itemsLoaded {number}
         * @param itemsTotal {number}
         * @private
         */
        ResourceEvent.dispatchResourceEvent = function (target, type, groupName, resItem, itemsLoaded, itemsTotal) {
            if (groupName === void 0) {
                groupName = "";
            }
            if (resItem === void 0) {
                resItem = null;
            }
            if (itemsLoaded === void 0) {
                itemsLoaded = 0;
            }
            if (itemsTotal === void 0) {
                itemsTotal = 0;
            }
            var event = egret.Event.create(ResourceEvent, type);
            event.groupName = groupName;
            event.resItem = resItem;
            event.itemsLoaded = itemsLoaded;
            event.itemsTotal = itemsTotal;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Failure event for a load item.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธไธชๅ่ฝฝ้กนๅ่ฝฝๅคฑ่ดฅไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.ITEM_LOAD_ERROR = "itemLoadError";
        /**
         * Configure file to load and parse the completion event. Note: if a configuration file is loaded, it will not be thrown out, and if you want to handle the configuration loading failure, monitor the CONFIG_LOAD_ERROR event.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้็ฝฎๆไปถๅ่ฝฝๅนถ่งฃๆๅฎๆไบไปถใๆณจๆ๏ผ่ฅๆ้็ฝฎๆไปถๅ่ฝฝๅคฑ่ดฅ๏ผๅฐไธไผๆๅบๆญคไบไปถ๏ผ่ฅ่ฆๅค็้็ฝฎๅ่ฝฝๅคฑ่ดฅ๏ผ่ฏทๅๆถ็ๅฌ CONFIG_LOAD_ERROR ไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.CONFIG_COMPLETE = "configComplete";
        /**
         * Configuration file failed to load.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้็ฝฎๆไปถๅ่ฝฝๅคฑ่ดฅไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.CONFIG_LOAD_ERROR = "configLoadError";
        /**
         * Delay load group resource loading progress event.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅปถ่ฟๅ่ฝฝ็ป่ตๆบๅ่ฝฝ่ฟๅบฆไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.GROUP_PROGRESS = "groupProgress";
        /**
         * Delay load group resource to complete event. Note: if you have a resource item loading failure, the event will not be thrown, if you want to handle the group load failure, please listen to the GROUP_LOAD_ERROR event.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅปถ่ฟๅ่ฝฝ็ป่ตๆบๅ่ฝฝๅฎๆไบไปถใๆณจๆ๏ผ่ฅ็ปๅๆ่ตๆบ้กนๅ่ฝฝๅคฑ่ดฅ๏ผๅฐไธไผๆๅบๆญคไบไปถ๏ผ่ฅ่ฆๅค็็ปๅ่ฝฝๅคฑ่ดฅ๏ผ่ฏทๅๆถ็ๅฌ GROUP_LOAD_ERROR ไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.GROUP_COMPLETE = "groupComplete";
        /**
         * Delayed load group resource failed event.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅปถ่ฟๅ่ฝฝ็ป่ตๆบๅ่ฝฝๅคฑ่ดฅไบไปถใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        ResourceEvent.GROUP_LOAD_ERROR = "groupLoadError";
        return ResourceEvent;
    }(egret.Event));
    RES.ResourceEvent = ResourceEvent;
    __reflect(ResourceEvent.prototype, "RES.ResourceEvent");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    var web;
    (function (web) {
        /**
         * @private
         */
        var Html5VersionController = (function (_super) {
            __extends(Html5VersionController, _super);
            function Html5VersionController() {
                var _this = _super.call(this) || this;
                _this._versionInfo = {};
                return _this;
            }
            Html5VersionController.prototype.fetchVersion = function (callback) {
                callback.onSuccess(null);
                return;
                /*
    
                todo
    
                let self = this;
    
                let virtualUrl:string = "all.manifest";
    
                let httpLoader:egret.HttpRequest = new egret.HttpRequest();
                httpLoader.addEventListener(egret.Event.COMPLETE, onLoadComplete, this);
                httpLoader.addEventListener(egret.IOErrorEvent.IO_ERROR, onError, this);
    
                httpLoader.open(virtualUrl + "?r=" + Date.now(), "get");
                httpLoader.send();
    
                function onError(event:egret.IOErrorEvent) {
                    removeListeners();
                    self.dispatchEvent(event);
                }
    
                function onLoadComplete() {
                    removeListeners();
    
                    self._versionInfo = JSON.parse(httpLoader.response);
    
                    window.setTimeout(function () {
                        self.dispatchEvent(new egret.Event(egret.Event.COMPLETE));
                    }, 0);
                }
    
                function removeListeners():void {
                    httpLoader.removeEventListener(egret.Event.COMPLETE, onLoadComplete, self);
                    httpLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR, onError, self);
                }
    
                */
            };
            /**
             * ่ทๅๆๆๆๅๅ็ๆไปถ
             * @returns {any[]}
             */
            Html5VersionController.prototype.getChangeList = function () {
                return [];
            };
            Html5VersionController.prototype.getVirtualUrl = function (url) {
                return url;
                /*
    
                todo
    
                if (DEBUG) {
                    return url;
                }
                if (this._versionInfo && this._versionInfo[url]) {
                    return "resource/" + this._versionInfo[url]["v"].substring(0, 2) + "/" + this._versionInfo[url]["v"] + "_" + this._versionInfo[url]["s"] + "." + url.substring(url.lastIndexOf(".") + 1);
                }
                else {
                    return url;
                }
    
                */
            };
            return Html5VersionController;
        }(egret.EventDispatcher));
        web.Html5VersionController = Html5VersionController;
        __reflect(Html5VersionController.prototype, "RES.web.Html5VersionController", ["RES.VersionController", "RES.IVersionController"]);
        if (egret.Capabilities.runtimeType == egret.RuntimeType.WEB) {
            RES.VersionController = Html5VersionController;
        }
    })(web = RES.web || (RES.web = {}));
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    var native;
    (function (native) {
        /**
         * @private
         */
        var NativeVersionController = (function () {
            function NativeVersionController() {
                this._versionInfo = {};
                this._versionPath = "";
                this._localFileArr = [];
            }
            NativeVersionController.prototype.fetchVersion = function (callback) {
                if (true) {
                    callback.onSuccess(null);
                    return;
                }
                var self = this;
                self._versionPath = "all.manifest";
                self._versionInfo = self.getLocalData(self._versionPath);
                if (self._versionInfo == null) {
                    egret.callLater(function () {
                        callback.onFail(1, null);
                    }, self);
                    return;
                }
                var count = 0;
                var loadOver = function (paths) {
                    if (paths) {
                        for (var i = 0; i < paths.length; i++) {
                            if (paths[i] && paths[i] != "") {
                                self._localFileArr.push("resource/" + paths[i]);
                            }
                        }
                    }
                    count++;
                    if (count == 2) {
                        callback.onSuccess(null);
                    }
                };
                self.getList(loadOver, "assets", "resource");
                self.getList(loadOver, "update", "resource");
            };
            NativeVersionController.prototype.getList = function (callback, type, root) {
                if (root === void 0) {
                    root = "";
                }
                var promise = egret.PromiseObject.create();
                promise.onSuccessFunc = function (paths) {
                    callback(paths);
                };
                promise.onErrorFunc = function () {
                    console.error("list files error");
                };
                if (type == "assets") {
                    egret_native.Game.listResource(root, promise);
                }
                else {
                    egret_native.Game.listUpdate(root, promise);
                }
            };
            /**
             * ่ทๅๆๆๆๅๅ็ๆไปถ
             * @returns {any[]}
             */
            NativeVersionController.prototype.getChangeList = function () {
                var temp = [];
                var localFileArr = this._localFileArr;
                for (var key in this._versionInfo) {
                    if (localFileArr.indexOf(this.getVirtualUrl(key)) < 0) {
                        temp.push({ "url": this.getVirtualUrl(key), "size": this._versionInfo[key]["s"] });
                    }
                }
                return temp;
            };
            NativeVersionController.prototype.getVirtualUrl = function (url) {
                if (true) {
                    return url;
                }
                if (this._versionInfo && this._versionInfo[url]) {
                    return "resource/" + this._versionInfo[url]["v"].substring(0, 2) + "/" + this._versionInfo[url]["v"] + "_" + this._versionInfo[url]["s"] + "." + url.substring(url.lastIndexOf(".") + 1);
                }
                else {
                    return url;
                }
            };
            NativeVersionController.prototype.getLocalData = function (filePath) {
                if (egret_native.readUpdateFileSync && egret_native.readResourceFileSync) {
                    //ๅๅๆดๆฐ็ฎๅฝ
                    var content = egret_native.readUpdateFileSync(filePath);
                    if (content != null) {
                        return JSON.parse(content);
                    }
                    //ๅๅ่ตๆบ็ฎๅฝ
                    content = egret_native.readResourceFileSync(filePath);
                    if (content != null) {
                        return JSON.parse(content);
                    }
                }
                return null;
            };
            return NativeVersionController;
        }());
        native.NativeVersionController = NativeVersionController;
        __reflect(NativeVersionController.prototype, "RES.native.NativeVersionController", ["RES.VersionController", "RES.IVersionController"]);
        if (egret.Capabilities.runtimeType == egret.RuntimeType.NATIVE) {
            RES.VersionController = NativeVersionController;
        }
    })(native = RES.native || (RES.native = {}));
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * @private
     */
    var SoundAnalyzer = (function (_super) {
        __extends(SoundAnalyzer, _super);
        /**
         * ๆ้ๅฝๆฐ
         */
        function SoundAnalyzer() {
            var _this = _super.call(this) || this;
            /**
             * ๅญ่ๆตๆฐๆฎ็ผๅญๅญๅธ
             */
            _this.soundDic = {};
            /**
             * ๅ่ฝฝ้กนๅญๅธ
             */
            _this.resItemDic = [];
            return _this;
        }
        /**
         * @inheritDoc
         */
        SoundAnalyzer.prototype.loadFile = function (resItem, callBack, thisObject) {
            if (this.soundDic[resItem.name]) {
                callBack.call(thisObject, resItem);
                return;
            }
            var sound = new egret.Sound();
            sound.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
            sound.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            this.resItemDic[sound.$hashCode] = { item: resItem, func: callBack, thisObject: thisObject };
            sound.load(RES.$getVirtualUrl(resItem.url));
            if (resItem.data) {
                sound.type = resItem.data.soundType;
            }
        };
        /**
         * ไธ้กนๅ่ฝฝ็ปๆ
         */
        SoundAnalyzer.prototype.onLoadFinish = function (event) {
            var sound = (event.$target);
            sound.removeEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
            sound.removeEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            var data = this.resItemDic[sound.$hashCode];
            delete this.resItemDic[sound.$hashCode];
            var resItem = data.item;
            var compFunc = data.func;
            resItem.loaded = (event.$type == egret.Event.COMPLETE);
            if (resItem.loaded) {
                this.analyzeData(resItem, sound);
            }
            compFunc.call(data.thisObject, resItem);
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ๆฐๆฎ
         */
        SoundAnalyzer.prototype.analyzeData = function (resItem, data) {
            var name = resItem.name;
            if (this.soundDic[name] || !data) {
                return;
            }
            this.soundDic[name] = data;
        };
        /**
         * @inheritDoc
         */
        SoundAnalyzer.prototype.getRes = function (name) {
            return this.soundDic[name];
        };
        /**
         * @inheritDoc
         */
        SoundAnalyzer.prototype.hasRes = function (name) {
            return !!this.getRes(name);
        };
        /**
         * @inheritDoc
         */
        SoundAnalyzer.prototype.destroyRes = function (name) {
            if (this.soundDic[name]) {
                delete this.soundDic[name];
                return true;
            }
            return false;
        };
        return SoundAnalyzer;
    }(RES.AnalyzerBase));
    RES.SoundAnalyzer = SoundAnalyzer;
    __reflect(SoundAnalyzer.prototype, "RES.SoundAnalyzer");
})(RES || (RES = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="core/ResourceItem.ts" />
/// <reference path="core/ResourceConfig.ts" />
/// <reference path="core/ResourceLoader.ts" />
/// <reference path="events/ResourceEvent.ts" />
/// <reference path="analyzer/BinAnalyzer.ts" />
/// <reference path="analyzer/ImageAnalyzer.ts" />
/// <reference path="analyzer/TextAnalyzer.ts" />
/// <reference path="analyzer/JsonAnalyzer.ts" />
/// <reference path="analyzer/SheetAnalyzer.ts" />
/// <reference path="analyzer/FontAnalyzer.ts" />
/// <reference path="analyzer/SoundAnalyzer.ts" />
/// <reference path="analyzer/XMLAnalyzer.ts" />
/// <reference path="version/IVersionController.ts" />
/// <reference path="version/Html5VersionController.ts" />
/// <reference path="version/NativeVersionController.ts" />
var RES;
(function (RES) {
    /**
     * Conduct mapping injection with class definition as the value.
     * @param type Injection type.
     * @param analyzerClass Injection type classes need to be resolved.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/resource/Resource.ts
     * @language en_US
     */
    /**
     * ไปฅ็ฑปๅฎไนไธบๅผ่ฟ่กๆๅฐๆณจๅฅใ
     * @param type ๆณจๅฅ็็ฑปๅใ
     * @param analyzerClass ๆณจๅฅ็ฑปๅ้่ฆ่งฃๆ็็ฑปใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/resource/Resource.ts
     * @language zh_CN
     */
    function registerAnalyzer(type, analyzerClass) {
        instance.registerAnalyzer(type, analyzerClass);
    }
    RES.registerAnalyzer = registerAnalyzer;
    /**
     * Get mapping injection.
     * @param type Injection type.
     * @version Egret 3.2.6
     * @platform Web,Native
     * @includeExample extension/resource/Resource.ts
     * @language en_US
     */
    /**
     * ่ทๅๆๅฐๆณจๅฅใ
     * @param type ๆณจๅฅ็็ฑปๅใ
     * @version Egret 3.2.6
     * @platform Web,Native
     * @includeExample extension/resource/Resource.ts
     * @language zh_CN
     */
    function getAnalyzer(type) {
        return instance.$getAnalyzerByType(type);
    }
    RES.getAnalyzer = getAnalyzer;
    /**
     * Register the VersionController
     * @param vcs The VersionController to register.
     * @version Egret 2.5
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆณจๅ็ๆฌๆงๅถๅจ,้่ฟRESๆจกๅๅ่ฝฝ่ตๆบๆถไผไป็ๆฌๆงๅถๅจ่ทๅ็ๅฎurl
     * @param vcs ๆณจๅฅ็็ๆฌๆงๅถๅจใ
     * @version Egret 2.5
     * @platform Web,Native
     * @language zh_CN
     */
    function registerVersionController(vcs) {
        instance.$registerVersionController(vcs);
    }
    RES.registerVersionController = registerVersionController;
    /**
     * Returns the VersionController
     * @version Egret 2.5
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ทๅพ็ๆฌๆงๅถๅจ.
     * @version Egret 2.5
     * @platform Web,Native
     * @language zh_CN
     */
    function getVersionController() {
        return instance.vcs;
    }
    RES.getVersionController = getVersionController;
    /**
     * Load configuration file and parse.
     * @param url Configuration file path (path resource.json).
     * @param resourceRoot Resource path. All URL in the configuration is the relative value of the path. The ultimate URL is the value of the sum of the URL of the string and the resource in the configuration.
     * @param type Configuration file format. Determine what parser to parse the configuration file. Default "json".
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅ่ฝฝ้็ฝฎๆไปถๅนถ่งฃๆใ
     * @param url ้็ฝฎๆไปถ่ทฏๅพ(resource.json็่ทฏๅพ)ใ
     * @param resourceRoot ่ตๆบๆน่ทฏๅพใ้็ฝฎไธญ็ๆๆurl้ฝๆฏ่ฟไธช่ทฏๅพ็็ธๅฏนๅผใๆ็ปurlๆฏ่ฟไธชๅญ็ฌฆไธฒไธ้็ฝฎ้่ตๆบ้กน็url็ธๅ็ๅผใ
     * @param type ้็ฝฎๆไปถ็ๆผๅผใ็กฎๅฎ่ฆ็จไปไน่งฃๆๅจๆฅ่งฃๆ้็ฝฎๆไปถใ้ป่ฎค"json"
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function loadConfig(url, resourceRoot, type) {
        if (resourceRoot === void 0) {
            resourceRoot = "";
        }
        if (type === void 0) {
            type = "json";
        }
        instance.loadConfig(url, resourceRoot, type);
    }
    RES.loadConfig = loadConfig;
    /**
     * Load a set of resources according to the group name.
     * @param name Group name to load the resource group.
     * @param priority Load priority can be negative, the default value is 0.
     * <br>A low priority group must wait for the high priority group to complete the end of the load to start, and the same priority group will be loaded at the same time.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆนๆฎ็ปๅๅ่ฝฝไธ็ป่ตๆบใ
     * @param name ่ฆๅ่ฝฝ่ตๆบ็ป็็ปๅใ
     * @param priority ๅ่ฝฝไผๅ็บง,ๅฏไปฅไธบ่ดๆฐ,้ป่ฎคๅผไธบ 0ใ
     * <br>ไฝไผๅ็บง็็ปๅฟ้กป็ญๅพ้ซไผๅ็บง็ปๅฎๅจๅ่ฝฝ็ปๆๆ่ฝๅผๅง๏ผๅไธไผๅ็บง็็ปไผๅๆถๅ่ฝฝใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function loadGroup(name, priority) {
        if (priority === void 0) {
            priority = 0;
        }
        instance.loadGroup(name, priority);
    }
    RES.loadGroup = loadGroup;
    /**
     * Check whether a resource group has been loaded.
     * @param name Group nameใ
     * @returns Is loading or not.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆฃๆฅๆไธช่ตๆบ็ปๆฏๅฆๅทฒ็ปๅ่ฝฝๅฎๆใ
     * @param name ็ปๅใ
     * @returns ๆฏๅฆๆญฃๅจๅ่ฝฝใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function isGroupLoaded(name) {
        return instance.isGroupLoaded(name);
    }
    RES.isGroupLoaded = isGroupLoaded;
    /**
     * A list of groups of loading is obtained according to the group name.
     * @param name Group name.
     * @returns The resource item array of group.
     * @see RES.ResourceItem
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆนๆฎ็ปๅ่ทๅ็ปๅ่ฝฝ้กนๅ่กจใ
     * @param name ็ปๅใ
     * @returns ๅ่ฝฝ้กนๅ่กจใ
     * @see RES.ResourceItem
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function getGroupByName(name) {
        return instance.getGroupByName(name);
    }
    RES.getGroupByName = getGroupByName;
    /**
     * Create a custom load resource group, note that this method is valid only after the resource configuration file is loaded.
     * <br>You can monitor the ResourceEvent.CONFIG_COMPLETE event to verify that the configuration is complete.
     * @param name Group name to create the load resource group.
     * @param keys To be included in the list of key keys, the corresponding configuration file in the name or sbuKeys property one or a resource group name.
     * @param override Is the default false for the same name resource group already exists.
     * @returns Create success or fail.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅๅปบ่ชๅฎไน็ๅ่ฝฝ่ตๆบ็ป,ๆณจๆ๏ผๆญคๆนๆณไปๅจ่ตๆบ้็ฝฎๆไปถๅ่ฝฝๅฎๆๅๆง่กๆๆๆใ
     * <br>ๅฏไปฅ็ๅฌ ResourceEvent.CONFIG_COMPLETE ไบไปถๆฅ็กฎ่ฎค้็ฝฎๅ่ฝฝๅฎๆใ
     * @param name ่ฆๅๅปบ็ๅ่ฝฝ่ตๆบ็ป็็ปๅใ
     * @param keys ่ฆๅๅซ็้ฎๅๅ่กจ๏ผkey ๅฏนๅบ้็ฝฎๆไปถ้็ name ๅฑๆงๆ sbuKeys ๅฑๆง็ไธ้กนๆไธไธช่ตๆบ็ปๅใ
     * @param override ๆฏๅฆ่ฆ็ๅทฒ็ปๅญๅจ็ๅๅ่ตๆบ็ป,้ป่ฎค falseใ
     * @returns ๆฏๅฆๅๅปบๆๅใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function createGroup(name, keys, override) {
        if (override === void 0) {
            override = false;
        }
        return instance.createGroup(name, keys, override);
    }
    RES.createGroup = createGroup;
    /**
     * Check whether the configuration file contains the specified resources.
     * @param key A sbuKeys attribute or name property in a configuration file.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆฃๆฅ้็ฝฎๆไปถ้ๆฏๅฆๅซๆๆๅฎ็่ตๆบใ
     * @param key ๅฏนๅบ้็ฝฎๆไปถ้็ name ๅฑๆงๆ sbuKeys ๅฑๆง็ไธ้กนใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function hasRes(key) {
        return instance.hasRes(key);
    }
    RES.hasRes = hasRes;
    /**
     * parse a configuration file at run time๏ผit will not clean the exist data.
     * @param data Configuration file data, please refer to the resource.json configuration file format. JSON object can be introduced into the corresponding.
     * @param folder Path prefix for load.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ฟ่กๆถๅจๆ่งฃๆไธไธช้็ฝฎๆไปถ,ๆญคๆไฝไธไผๆธ็ฉบไนๅๅทฒๅญๅจ็้็ฝฎใ
     * @param data ้็ฝฎๆไปถๆฐๆฎ๏ผ่ฏทๅ่ resource.json ็้็ฝฎๆไปถๆผๅผใไผๅฅๅฏนๅบ็ json ๅฏน่ฑกๅณๅฏใ
     * @param folder ๅ่ฝฝ้กน็่ทฏๅพๅ็ผใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function parseConfig(data, folder) {
        if (folder === void 0) {
            folder = "";
        }
        instance.parseConfig(data, folder);
    }
    RES.parseConfig = parseConfig;
    /**
     * The synchronization method for obtaining the cache has been loaded with the success of the resource.
     * <br>The type of resource and the corresponding return value types are as follows:
     * <br>RES.ResourceItem.TYPE_BIN : ArrayBuffer JavaScript primary object
     * <br>RES.ResourceItem.TYPE_IMAGE : img Html Object๏ผor egret.BitmapData interfaceใ
     * <br>RES.ResourceItem.TYPE_JSON : Object
     * <br>RES.ResourceItem.TYPE_SHEET : Object
     * <br>  1. If the incoming parameter is the name of the entire SpriteSheet is returned is {image1: Texture, "image2": Texture}.
     * <br>  2. If the incoming is "sheet.image1", the return is a single resource.
     * <br>  3. If the incoming is the name of the "image1" single resource, the return is a single resource.
     * But if there are two SpriteSheet in a single picture of the same name, the return of the image after the load.
     * <br>RES.ResourceItem.TYPE_SOUND : HtmlSound Html Object
     * <br>RES.ResourceItem.TYPE_TEXT : string
     * @param key A subKeys attribute or name property in a configuration file.
     * @see RES.ResourceItem
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅๆญฅๆนๅผ่ทๅ็ผๅญ็ๅทฒ็ปๅ่ฝฝๆๅ็่ตๆบใ
     * <br>่ตๆบ็ฑปๅๅๅฏนๅบ็่ฟๅๅผ็ฑปๅๅณ็ณปๅฆไธ๏ผ
     * <br>RES.ResourceItem.TYPE_BIN : ArrayBuffer JavaScript ๅ็ๅฏน่ฑก
     * <br>RES.ResourceItem.TYPE_IMAGE : img Html ๅฏน่ฑก๏ผๆ่ egret.BitmapData ๆฅๅฃใ
     * <br>RES.ResourceItem.TYPE_JSON : Object
     * <br>RES.ResourceItem.TYPE_SHEET : Object
     * <br>  1. ๅฆๆไผๅฅ็ๅๆฐๆฏๆดไธช SpriteSheet ็ๅ็งฐ่ฟๅ็ๆฏ {"image1":Texture,"image2":Texture} ่ฟๆท็ๆผๅผใ
     * <br>  2. ๅฆๆไผๅฅ็ๆฏ "sheet.image1"๏ผ่ฟๅ็ๆฏๅไธช่ตๆบใ
     * <br>  3. ๅฆๆไผๅฅ็ๆฏ "image1" ๅไธช่ตๆบ็ๅ็งฐ๏ผ่ฟๅ็ๆฏๅไธช่ตๆบใไฝๆฏๅฆๆๆไธคๅผ SpriteSheet ไธญๆๅไธชๅพ็่ตๆบๅ็งฐ็ธๅ๏ผ่ฟๅ็ๆฏๅๅ่ฝฝ็้ฃไธชๅพ็่ตๆบใ
     * <br>RES.ResourceItem.TYPE_SOUND : HtmlSound Html ๅฏน่ฑก
     * <br>RES.ResourceItem.TYPE_TEXT : string
     * @param key ๅฏนๅบ้็ฝฎๆไปถ้็ name ๅฑๆงๆ subKeys ๅฑๆง็ไธ้กนใ
     * @see RES.ResourceItem
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function getRes(key) {
        return instance.getRes(key);
    }
    RES.getRes = getRes;
    /**
     * Asynchronous mode to get the resources in the configuration. As long as the resources exist in the configuration file, you can get it in an asynchronous way.
     * @param key A sbuKeys attribute or name property in a configuration file.
     * @param compFunc Call back function. Example๏ผcompFunc(data,key):void.
     * @param thisObject This pointer of call back function.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅผๆญฅๆนๅผ่ทๅ้็ฝฎ้็่ตๆบใๅช่ฆๆฏ้็ฝฎๆไปถ้ๅญๅจ็่ตๆบ๏ผ้ฝๅฏไปฅ้่ฟๅผๆญฅๆนๅผ่ทๅใ
     * @param key ๅฏนๅบ้็ฝฎๆไปถ้็ name ๅฑๆงๆ sbuKeys ๅฑๆง็ไธ้กนใ
     * @param compFunc ๅ่ฐๅฝๆฐใ็คบไพ๏ผcompFunc(data,key):voidใ
     * @param thisObject ๅ่ฐๅฝๆฐ็ this ๅผ็จใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function getResAsync(key, compFunc, thisObject) {
        instance.getResAsync(key, compFunc, thisObject);
    }
    RES.getResAsync = getResAsync;
    /**
     * Access to external resources through the full URL.
     * @param url The external path to load the file.
     * @param compFunc Call back function. Example๏ผcompFunc(data,url):voidใ
     * @param thisObject This pointer of call back function.
     * @param type File type (optional). Use the static constants defined in the ResourceItem class. If you do not set the file name extension.
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/resource/GetResByUrl.ts
     * @language en_US
     */
    /**
     * ้่ฟๅฎๆดURLๆนๅผ่ทๅๅค้จ่ตๆบใ
     * @param url ่ฆๅ่ฝฝๆไปถ็ๅค้จ่ทฏๅพใ
     * @param compFunc ๅ่ฐๅฝๆฐใ็คบไพ๏ผcompFunc(data,url):voidใ
     * @param thisObject ๅ่ฐๅฝๆฐ็ this ๅผ็จใ
     * @param type ๆไปถ็ฑปๅ(ๅฏ้)ใ่ฏทไฝฟ็จ ResourceItem ็ฑปไธญๅฎไน็้ๆๅธธ้ใ่ฅไธ่ฎพ็ฝฎๅฐๆนๆฎๆไปถๆฉๅฑๅ็ๆใ
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/resource/GetResByUrl.ts
     * @language zh_CN
     */
    function getResByUrl(url, compFunc, thisObject, type) {
        if (type === void 0) {
            type = "";
        }
        instance.getResByUrl(url, compFunc, thisObject, type);
    }
    RES.getResByUrl = getResByUrl;
    /**
     * Destroy a single resource file or a set of resources to the cache data, to return whether to delete success.
     * @param name Name attribute or resource group name of the load item in the configuration file.
     * @param force Destruction of a resource group when the other resources groups have the same resource situation whether the resources will be deleted, the default value true.
     * @returns Are successful destruction.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ้ๆฏๅไธช่ตๆบๆไปถๆไธ็ป่ตๆบ็็ผๅญๆฐๆฎ,่ฟๅๆฏๅฆๅ้คๆๅใ
     * @param name ้็ฝฎๆไปถไธญๅ่ฝฝ้กน็nameๅฑๆงๆ่ตๆบ็ปๅใ
     * @param force ้ๆฏไธไธช่ตๆบ็ปๆถๅถไป่ตๆบ็ปๆๅๆท่ตๆบๆๅต่ตๆบๆฏๅฆไผ่ขซๅ้ค๏ผ้ป่ฎคๅผ trueใ
     * @see #setMaxRetryTimes
     * @returns ๆฏๅฆ้ๆฏๆๅใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function destroyRes(name, force) {
        return instance.destroyRes(name, force);
    }
    RES.destroyRes = destroyRes;
    /**
     * Sets the maximum number of concurrent load threads, the default value is 2.
     * @param thread The number of concurrent loads to be set.
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ฎพ็ฝฎๆๅคงๅนถๅๅ่ฝฝ็บฟ็จๆฐ้๏ผ้ป่ฎคๅผๆฏ 2ใ
     * @param thread ่ฆ่ฎพ็ฝฎ็ๅนถๅๅ่ฝฝๆฐใ
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function setMaxLoadingThread(thread) {
        instance.setMaxLoadingThread(thread);
    }
    RES.setMaxLoadingThread = setMaxLoadingThread;
    /**
     * Sets the number of retry times when the resource failed to load, and the default value is 3.
     * @param retry To set the retry count.
     * @includeExample extension/resource/Resource.ts
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่ฎพ็ฝฎ่ตๆบๅ่ฝฝๅคฑ่ดฅๆถ็้่ฏๆฌกๆฐ๏ผ้ป่ฎคๅผๆฏ 3ใ
     * @param retry ่ฆ่ฎพ็ฝฎ็้่ฏๆฌกๆฐใ
     * @includeExample extension/resource/Resource.ts
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function setMaxRetryTimes(retry) {
        instance.setMaxRetryTimes(retry);
    }
    RES.setMaxRetryTimes = setMaxRetryTimes;
    /**
     * Add event listeners, reference ResourceEvent defined constants.
     * @param type Event nameใ
     * @param listener Listener functions for handling events. This function must accept the Event object as its only parameter, and can't return any results,
     * As shown in the following example: function (evt:Event):void can have any name.
     * @param thisObject The this object that is bound to a function.
     * @param useCapture Determine the listener is running on the capture or running on the target and the bubbling phase. Set useCapture to true,
     * then the listener in the capture phase processing events, but not in the target or the bubbling phase processing events.
     * If useCapture is false, then the listener only in the target or the bubbling phase processing events.
     * To listen for events in all three stages, please call addEventListener two times: once the useCapture is set to true, once the useCapture is set to false.
     * @param priority Event listener priority. Priority is specified by a 32 - bit integer with a symbol. The higher the number, the higher the priority.
     * All listeners with a priority for n will be processed before the -1 n listener.
     * If two or more listeners share the same priority, they are processed in accordance with the order of their added. The default priority is 0.
     * @see RES.ResourceEvent
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆทปๅไบไปถไพฆๅฌๅจ,ๅ่ ResourceEvent ๅฎไน็ๅธธ้ใ
     * @param type ไบไปถ็็ฑปๅใ
     * @param listener ๅค็ไบไปถ็ไพฆๅฌๅจๅฝๆฐใๆญคๅฝๆฐๅฟ้กปๆฅๅ Event ๅฏน่ฑกไฝไธบๅถๅฏไธ็ๅๆฐ๏ผๅนถไธไธ่ฝ่ฟๅไปปไฝ็ปๆ๏ผ
     * ๅฆไธ้ข็็คบไพๆ็คบ๏ผ function(evt:Event):void ๅฝๆฐๅฏไปฅๆไปปไฝๅ็งฐใ
     * @param thisObject ไพฆๅฌๅฝๆฐ็ปๅฎ็ this ๅฏน่ฑกใ
     * @param useCapture ็กฎๅฎไพฆๅฌๅจๆฏ่ฟ่กไบๆ่ท้ถๆฎต่ฟๆฏ่ฟ่กไบ็ฎๆๅๅๆณก้ถๆฎตใๅฆๆๅฐ useCapture ่ฎพ็ฝฎไธบ true๏ผ
     * ๅไพฆๅฌๅจๅชๅจๆ่ท้ถๆฎตๅค็ไบไปถ๏ผ่ไธๅจ็ฎๆๆๅๆณก้ถๆฎตๅค็ไบไปถใๅฆๆ useCapture ไธบ false๏ผๅไพฆๅฌๅจๅชๅจ็ฎๆๆๅๆณก้ถๆฎตๅค็ไบไปถใ
     * ่ฆๅจๆๆไธไธช้ถๆฎต้ฝไพฆๅฌไบไปถ๏ผ่ฏท่ฐ็จ addEventListener ไธคๆฌก๏ผไธๆฌกๅฐ useCapture ่ฎพ็ฝฎไธบ true๏ผไธๆฌกๅฐ useCapture ่ฎพ็ฝฎไธบ falseใ
     * @param priority ไบไปถไพฆๅฌๅจ็ไผๅ็บงใไผๅ็บง็ฑไธไธชๅธฆ็ฌฆๅท็ 32 ไฝๆดๆฐๆๅฎใๆฐๅญ่ถๅคง๏ผไผๅ็บง่ถ้ซใไผๅ็บงไธบ n ็ๆๆไพฆๅฌๅจไผๅจ
     * ไผๅ็บงไธบ n -1 ็ไพฆๅฌๅจไนๅๅพๅฐๅค็ใๅฆๆไธคไธชๆๆดๅคไธชไพฆๅฌๅจๅฑไบซ็ธๅ็ไผๅ็บง๏ผๅๆ็งๅฎไปฌ็ๆทปๅ้กบๅบ่ฟ่กๅค็ใ้ป่ฎคไผๅ็บงไธบ 0ใ
     * @see RES.ResourceEvent
     * @see #setMaxRetryTimes
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function addEventListener(type, listener, thisObject, useCapture, priority) {
        if (useCapture === void 0) {
            useCapture = false;
        }
        if (priority === void 0) {
            priority = 0;
        }
        instance.addEventListener(type, listener, thisObject, useCapture, priority);
    }
    RES.addEventListener = addEventListener;
    /**
     * Remove event listeners, reference ResourceEvent defined constants.
     * @param type Event nameใ
     * @param listener Listening functionใ
     * @param thisObject The this object that is bound to a function.
     * @param useCapture Is used to capture, and this property is only valid in the display list.
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ็งป้คไบไปถไพฆๅฌๅจ,ๅ่ResourceEventๅฎไน็ๅธธ้ใ
     * @param type ไบไปถๅใ
     * @param listener ไพฆๅฌๅฝๆฐใ
     * @param thisObject ไพฆๅฌๅฝๆฐ็ปๅฎ็thisๅฏน่ฑกใ
     * @param useCapture ๆฏๅฆไฝฟ็จๆ่ท๏ผ่ฟไธชๅฑๆงๅชๅจๆพ็คบๅ่กจไธญ็ๆใ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    function removeEventListener(type, listener, thisObject, useCapture) {
        if (useCapture === void 0) {
            useCapture = false;
        }
        instance.removeEventListener(type, listener, thisObject, useCapture);
    }
    RES.removeEventListener = removeEventListener;
    function $getVirtualUrl(url) {
        if (instance.vcs) {
            return instance.vcs.getVirtualUrl(url);
        }
        else {
            return url;
        }
    }
    RES.$getVirtualUrl = $getVirtualUrl;
    /**
     * @private
     */
    var Resource = (function (_super) {
        __extends(Resource, _super);
        /**
         * ๆ้ๅฝๆฐ
         * @method RES.constructor
         * @private
         */
        function Resource() {
            var _this = _super.call(this) || this;
            /**
             * ่งฃๆๅจๅญๅธ
             */
            _this.analyzerDic = {};
            _this.analyzerClassMap = {};
            _this.configItemList = [];
            _this.callLaterFlag = false;
            /**
             * ้็ฝฎๆไปถๅ่ฝฝ่งฃๆๅฎๆๆๅฟ
             */
            _this.configComplete = false;
            /**
             * ๅทฒ็ปๅ่ฝฝ่ฟ็ปๅๅ่กจ
             */
            _this.loadedGroups = [];
            _this.groupNameList = [];
            /**
             * ๅผๆญฅ่ทๅ่ตๆบๅๆฐ็ผๅญๅญๅธ
             */
            _this.asyncDic = {};
            _this._loadedUrlTypes = {};
            _this.init();
            return _this;
        }
        /**
         * ๆนๆฎtype่ทๅๅฏนๅบ็ๆไปถ่งฃๆๅบ
         */
        Resource.prototype.$getAnalyzerByType = function (type) {
            var analyzer = this.analyzerDic[type];
            if (!analyzer) {
                var clazz = this.analyzerClassMap[type];
                if (!clazz) {
                    if (true) {
                        egret.$error(3203, type);
                    }
                    return null;
                }
                analyzer = this.analyzerDic[type] = new clazz();
            }
            return analyzer;
        };
        /**
         * ๆณจๅไธไธช่ชๅฎไนๆไปถ็ฑปๅ่งฃๆๅจ
         * @param type ๆไปถ็ฑปๅๅญ็ฌฆไธฒ๏ผไพๅฆ๏ผbin,text,image,json็ญใ
         * @param analyzerClass ่ชๅฎไน่งฃๆๅจ็็ฑปๅฎไน
         */
        Resource.prototype.registerAnalyzer = function (type, analyzerClass) {
            this.analyzerClassMap[type] = analyzerClass;
        };
        Resource.prototype.$registerVersionController = function (vcs) {
            this.vcs = vcs;
        };
        /**
         * ๅๅงๅ
         */
        Resource.prototype.init = function () {
            this.vcs = new RES.VersionController();
            var analyzerClassMap = this.analyzerClassMap;
            analyzerClassMap[RES.ResourceItem.TYPE_BIN] = RES.BinAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_IMAGE] = RES.ImageAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_TEXT] = RES.TextAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_JSON] = RES.JsonAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_SHEET] = RES.SheetAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_FONT] = RES.FontAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_SOUND] = RES.SoundAnalyzer;
            analyzerClassMap[RES.ResourceItem.TYPE_XML] = RES.XMLAnalyzer;
            this.resConfig = new RES.ResourceConfig();
            this.resLoader = new RES.ResourceLoader();
            this.resLoader.callBack = this.onResourceItemComp;
            this.resLoader.resInstance = this;
            this.resLoader.addEventListener(RES.ResourceEvent.GROUP_COMPLETE, this.onGroupComp, this);
            this.resLoader.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, this.onGroupError, this);
        };
        /**
         * ๅผๅงๅ่ฝฝ้็ฝฎ
         * @method RES.loadConfig
         * @param url {string}
         * @param resourceRoot {string}
         * @param type {string}
         */
        Resource.prototype.loadConfig = function (url, resourceRoot, type) {
            if (type === void 0) {
                type = "json";
            }
            var configItem = { url: url, resourceRoot: resourceRoot, type: type };
            this.configItemList.push(configItem);
            if (!this.callLaterFlag) {
                egret.callLater(this.startLoadConfig, this);
                this.callLaterFlag = true;
            }
        };
        Resource.prototype.startLoadConfig = function () {
            var _this = this;
            this.callLaterFlag = false;
            var configList = this.configItemList;
            this.configItemList = [];
            this.loadingConfigList = configList;
            var length = configList.length;
            var itemList = [];
            for (var i = 0; i < length; i++) {
                var item = configList[i];
                var resItem = new RES.ResourceItem(item.url, item.url, item.type);
                itemList.push(resItem);
            }
            var callback = {
                onSuccess: function (data) {
                    _this.resLoader.loadGroup(itemList, Resource.GROUP_CONFIG, Number.MAX_VALUE);
                },
                onFail: function (err, data) {
                    RES.ResourceEvent.dispatchResourceEvent(_this, RES.ResourceEvent.CONFIG_LOAD_ERROR);
                }
            };
            if (this.vcs) {
                this.vcs.fetchVersion(callback);
            }
            else {
                this.resLoader.loadGroup(itemList, Resource.GROUP_CONFIG, Number.MAX_VALUE);
            }
        };
        /**
         * ๆฃๆฅๆไธช่ตๆบ็ปๆฏๅฆๅทฒ็ปๅ่ฝฝๅฎๆ
         * @method RES.isGroupLoaded
         * @param name {string}
         * @returns {boolean}
         */
        Resource.prototype.isGroupLoaded = function (name) {
            return this.loadedGroups.indexOf(name) != -1;
        };
        /**
         * ๆนๆฎ็ปๅ่ทๅ็ปๅ่ฝฝ้กนๅ่กจ
         * @method RES.getGroupByName
         * @param name {string}
         * @returns {Array<egret.ResourceItem>}
         */
        Resource.prototype.getGroupByName = function (name) {
            return this.resConfig.getGroupByName(name);
        };
        /**
         * ๆนๆฎ็ปๅๅ่ฝฝไธ็ป่ตๆบ
         * @method RES.loadGroup
         * @param name {string}
         * @param priority {number}
         */
        Resource.prototype.loadGroup = function (name, priority) {
            if (priority === void 0) {
                priority = 0;
            }
            if (this.loadedGroups.indexOf(name) != -1) {
                RES.ResourceEvent.dispatchResourceEvent(this, RES.ResourceEvent.GROUP_COMPLETE, name);
                return;
            }
            if (this.resLoader.isGroupInLoading(name))
                return;
            if (this.configComplete) {
                var group = this.resConfig.getGroupByName(name);
                this.resLoader.loadGroup(group, name, priority);
            }
            else {
                this.groupNameList.push({ name: name, priority: priority });
            }
        };
        /**
         * ๅๅปบ่ชๅฎไน็ๅ่ฝฝ่ตๆบ็ป,ๆณจๆ๏ผๆญคๆนๆณไปๅจ่ตๆบ้็ฝฎๆไปถๅ่ฝฝๅฎๆๅๆง่กๆๆๆใ
         * ๅฏไปฅ็ๅฌResourceEvent.CONFIG_COMPLETEไบไปถๆฅ็กฎ่ฎค้็ฝฎๅ่ฝฝๅฎๆใ
         * @method RES.ResourceConfig#createGroup
         * @param name {string} ่ฆๅๅปบ็ๅ่ฝฝ่ตๆบ็ป็็ปๅ
         * @param keys {egret.string[]} ่ฆๅๅซ็้ฎๅๅ่กจ๏ผkeyๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงๆไธไธช่ตๆบ็ปๅใ
         * @param override {boolean} ๆฏๅฆ่ฆ็ๅทฒ็ปๅญๅจ็ๅๅ่ตๆบ็ป,้ป่ฎคfalseใ
         * @returns {boolean}
         */
        Resource.prototype.createGroup = function (name, keys, override) {
            if (override === void 0) {
                override = false;
            }
            if (override) {
                var index = this.loadedGroups.indexOf(name);
                if (index != -1) {
                    this.loadedGroups.splice(index, 1);
                }
            }
            return this.resConfig.createGroup(name, keys, override);
        };
        /**
         * ้ๅๅ่ฝฝๅฎๆไบไปถ
         */
        Resource.prototype.onGroupComp = function (event) {
            if (event.groupName == Resource.GROUP_CONFIG) {
                var length_5 = this.loadingConfigList.length;
                for (var i = 0; i < length_5; i++) {
                    var config = this.loadingConfigList[i];
                    var resolver = this.$getAnalyzerByType(config.type);
                    var data = resolver.getRes(config.url);
                    resolver.destroyRes(config.url);
                    this.resConfig.parseConfig(data, config.resourceRoot);
                }
                this.configComplete = true;
                this.loadingConfigList = null;
                RES.ResourceEvent.dispatchResourceEvent(this, RES.ResourceEvent.CONFIG_COMPLETE);
                this.loadDelayGroups();
            }
            else {
                this.loadedGroups.push(event.groupName);
                this.dispatchEvent(event);
            }
        };
        /**
         * ๅฏๅจๅปถ่ฟ็็ปๅ่ฝฝ
         */
        Resource.prototype.loadDelayGroups = function () {
            var groupNameList = this.groupNameList;
            this.groupNameList = [];
            var length = groupNameList.length;
            for (var i = 0; i < length; i++) {
                var item = groupNameList[i];
                this.loadGroup(item.name, item.priority);
            }
        };
        /**
         * ้ๅๅ่ฝฝๅคฑ่ดฅไบไปถ
         */
        Resource.prototype.onGroupError = function (event) {
            if (event.groupName == Resource.GROUP_CONFIG) {
                this.loadingConfigList = null;
                RES.ResourceEvent.dispatchResourceEvent(this, RES.ResourceEvent.CONFIG_LOAD_ERROR);
            }
            else {
                this.dispatchEvent(event);
            }
        };
        /**
         * ๆฃๆฅ้็ฝฎๆไปถ้ๆฏๅฆๅซๆๆๅฎ็่ตๆบ
         * @method RES.hasRes
         * @param key {string} ๅฏนๅบ้็ฝฎๆไปถ้็nameๅฑๆงๆsbuKeysๅฑๆง็ไธ้กนใ
         * @returns {boolean}
         */
        Resource.prototype.hasRes = function (key) {
            var type = this.resConfig.getType(key);
            if (type == "") {
                var prefix = RES.AnalyzerBase.getStringTail(key);
                type = this.resConfig.getType(prefix);
                if (type == "") {
                    return false;
                }
            }
            return true;
        };
        /**
         * ่ฟ่กๆถๅจๆ่งฃๆไธไธช้็ฝฎๆไปถ,
         * @param data {any} ้็ฝฎๆไปถๆฐๆฎ๏ผ่ฏทๅ่resource.json็้็ฝฎๆไปถๆผๅผใไผๅฅๅฏนๅบ็jsonๅฏน่ฑกๅณๅฏใ
         * @param folder {string} ๅ่ฝฝ้กน็่ทฏๅพๅ็ผใ
         */
        Resource.prototype.parseConfig = function (data, folder) {
            this.resConfig.parseConfig(data, folder);
            if (!this.configComplete && !this.loadingConfigList) {
                this.configComplete = true;
                this.loadDelayGroups();
            }
        };
        /**
         * ้่ฟkeyๅๆญฅ่ทๅ่ตๆบ
         * @method RES.getRes
         * @param key {string}
         * @returns {any}
         */
        Resource.prototype.getRes = function (key) {
            var type = this.resConfig.getType(key);
            if (type == "") {
                var prefix = RES.AnalyzerBase.getStringPrefix(key);
                type = this.resConfig.getType(prefix);
                if (type == "") {
                    return null;
                }
            }
            var analyzer = this.$getAnalyzerByType(type);
            return analyzer.getRes(key);
        };
        /**
         * ้่ฟkeyๅผๆญฅ่ทๅ่ตๆบ
         * @method RES.getResAsync
         * @param key {string}
         * @param compFunc {Function} ๅ่ฐๅฝๆฐใ็คบไพ๏ผcompFunc(data,url):voidใ
         * @param thisObject {any}
         */
        Resource.prototype.getResAsync = function (key, compFunc, thisObject) {
            var type = this.resConfig.getType(key);
            var name = this.resConfig.getName(key);
            if (type == "") {
                name = RES.AnalyzerBase.getStringPrefix(key);
                type = this.resConfig.getType(name);
                if (type == "") {
                    egret.$callAsync(compFunc, thisObject);
                    return;
                }
            }
            var analyzer = this.$getAnalyzerByType(type);
            var res = analyzer.getRes(key);
            if (res) {
                egret.$callAsync(compFunc, thisObject, res, key);
                return;
            }
            var args = { key: key, compFunc: compFunc, thisObject: thisObject };
            if (this.asyncDic[name]) {
                this.asyncDic[name].push(args);
            }
            else {
                this.asyncDic[name] = [args];
                var resItem = this.resConfig.getResourceItem(name);
                this.resLoader.loadItem(resItem);
            }
        };
        /**
         * ้่ฟurl่ทๅ่ตๆบ
         * @method RES.getResByUrl
         * @param url {string}
         * @param compFunc {Function}
         * @param thisObject {any}
         * @param type {string}
         */
        Resource.prototype.getResByUrl = function (url, compFunc, thisObject, type) {
            if (type === void 0) {
                type = "";
            }
            if (!url) {
                egret.$callAsync(compFunc, thisObject);
                return;
            }
            if (!type)
                type = this.getTypeByUrl(url);
            if (this._loadedUrlTypes[url] != null && this._loadedUrlTypes[url] != type) {
                egret.$warn(3202);
            }
            this._loadedUrlTypes[url] = type;
            var analyzer = this.$getAnalyzerByType(type);
            var name = url;
            var res = analyzer.getRes(name);
            if (res) {
                egret.$callAsync(compFunc, thisObject, res, url);
                return;
            }
            var args = { key: name, compFunc: compFunc, thisObject: thisObject };
            if (this.asyncDic[name]) {
                this.asyncDic[name].push(args);
            }
            else {
                this.asyncDic[name] = [args];
                var resItem = new RES.ResourceItem(name, url, type);
                this.resLoader.loadItem(resItem);
            }
        };
        /**
         * ้่ฟurl่ทๅๆไปถ็ฑปๅ
         */
        Resource.prototype.getTypeByUrl = function (url) {
            var suffix = url.substr(url.lastIndexOf(".") + 1);
            if (suffix) {
                suffix = suffix.toLowerCase();
            }
            var type;
            switch (suffix) {
                case RES.ResourceItem.TYPE_XML:
                case RES.ResourceItem.TYPE_JSON:
                case RES.ResourceItem.TYPE_SHEET:
                    type = suffix;
                    break;
                case "png":
                case "jpg":
                case "gif":
                case "jpeg":
                case "bmp":
                    type = RES.ResourceItem.TYPE_IMAGE;
                    break;
                case "fnt":
                    type = RES.ResourceItem.TYPE_FONT;
                    break;
                case "txt":
                    type = RES.ResourceItem.TYPE_TEXT;
                    break;
                case "mp3":
                case "ogg":
                case "mpeg":
                case "wav":
                case "m4a":
                case "mp4":
                case "aiff":
                case "wma":
                case "mid":
                    type = RES.ResourceItem.TYPE_SOUND;
                    break;
                default:
                    type = RES.ResourceItem.TYPE_BIN;
                    break;
            }
            return type;
        };
        /**
         * ไธไธชๅ่ฝฝ้กนๅ่ฝฝๅฎๆ
         */
        Resource.prototype.onResourceItemComp = function (item) {
            var argsList = this.asyncDic[item.name];
            delete this.asyncDic[item.name];
            var analyzer = this.$getAnalyzerByType(item.type);
            var length = argsList.length;
            for (var i = 0; i < length; i++) {
                var args = argsList[i];
                var res = analyzer.getRes(args.key);
                args.compFunc.call(args.thisObject, res, args.key);
            }
        };
        /**
         * ้ๆฏๅไธช่ตๆบๆไปถๆไธ็ป่ตๆบ็็ผๅญๆฐๆฎ,่ฟๅๆฏๅฆๅ้คๆๅใ
         * @method RES.destroyRes
         * @param name {string} ้็ฝฎๆไปถไธญๅ่ฝฝ้กน็nameๅฑๆงๆ่ตๆบ็ปๅ
         * @param force {boolean} ้ๆฏไธไธช่ตๆบ็ปๆถๅถไป่ตๆบ็ปๆๅๆท่ตๆบๆๅต่ตๆบๆฏๅฆไผ่ขซๅ้ค๏ผ้ป่ฎคๅผtrue
         * @returns {boolean}
         */
        Resource.prototype.destroyRes = function (name, force) {
            if (force === void 0) {
                force = true;
            }
            var group = this.resConfig.getRawGroupByName(name);
            if (group && group.length > 0) {
                var index = this.loadedGroups.indexOf(name);
                if (index != -1) {
                    this.loadedGroups.splice(index, 1);
                }
                var length_6 = group.length;
                for (var i = 0; i < length_6; i++) {
                    var item = group[i];
                    if (!force && this.isResInLoadedGroup(item.name)) {
                    }
                    else {
                        item.loaded = false;
                        var analyzer = this.$getAnalyzerByType(item.type);
                        analyzer.destroyRes(item.name);
                        this.removeLoadedGroupsByItemName(item.name);
                    }
                }
                return true;
            }
            else {
                var type = this.resConfig.getType(name);
                if (type == "") {
                    type = this._loadedUrlTypes[name];
                    if (type == null || type == "") {
                        return false;
                    }
                    delete this._loadedUrlTypes[name];
                    var analyzer_1 = this.$getAnalyzerByType(type);
                    analyzer_1.destroyRes(name);
                    return true;
                }
                var item = this.resConfig.getRawResourceItem(name);
                item.loaded = false;
                var analyzer = this.$getAnalyzerByType(type);
                var result = analyzer.destroyRes(name);
                this.removeLoadedGroupsByItemName(item.name);
                return result;
            }
        };
        Resource.prototype.removeLoadedGroupsByItemName = function (name) {
            var loadedGroups = this.loadedGroups;
            var loadedGroupLength = loadedGroups.length;
            for (var i = 0; i < loadedGroupLength; i++) {
                var group = this.resConfig.getRawGroupByName(loadedGroups[i]);
                var length_7 = group.length;
                for (var j = 0; j < length_7; j++) {
                    var item = group[j];
                    if (item.name == name) {
                        loadedGroups.splice(i, 1);
                        i--;
                        loadedGroupLength = loadedGroups.length;
                        break;
                    }
                }
            }
        };
        Resource.prototype.isResInLoadedGroup = function (name) {
            var loadedGroups = this.loadedGroups;
            var loadedGroupLength = loadedGroups.length;
            for (var i = 0; i < loadedGroupLength; i++) {
                var group = this.resConfig.getRawGroupByName(loadedGroups[i]);
                var length_8 = group.length;
                for (var j = 0; j < length_8; j++) {
                    var item = group[j];
                    if (item.name == name) {
                        return true;
                    }
                }
            }
            return false;
        };
        /**
         * ่ฎพ็ฝฎๆๅคงๅนถๅๅ่ฝฝ็บฟ็จๆฐ้๏ผ้ป่ฎคๅผๆฏ2.
         * @method RES.setMaxLoadingThread
         * @param thread {number} ่ฆ่ฎพ็ฝฎ็ๅนถๅๅ่ฝฝๆฐใ
         */
        Resource.prototype.setMaxLoadingThread = function (thread) {
            if (thread < 1) {
                thread = 1;
            }
            this.resLoader.thread = thread;
        };
        /**
         * ่ฎพ็ฝฎ่ตๆบๅ่ฝฝๅคฑ่ดฅๆถ็้่ฏๆฌกๆฐใ
         * @param retry ่ฆ่ฎพ็ฝฎ็้่ฏๆฌกๆฐใ
         */
        Resource.prototype.setMaxRetryTimes = function (retry) {
            retry = Math.max(retry, 0);
            this.resLoader.maxRetryTimes = retry;
        };
        /**
         * ้็ฝฎๆไปถ็ป็ปๅ
         */
        Resource.GROUP_CONFIG = "RES__CONFIG";
        return Resource;
    }(egret.EventDispatcher));
    __reflect(Resource.prototype, "Resource");
    /**
     * Resourceๅไพ
     */
    var instance = new Resource();
})(RES || (RES = {}));
////////////////////////////////////////////////////////////////////////////////////////
////
////  Copyright (c) 2014-present, Egret Technology.
////  All rights reserved.
////  Redistribution and use in source and binary forms, with or without
////  modification, are permitted provided that the following conditions are met:
////
////     * Redistributions of source code must retain the above copyright
////       notice, this list of conditions and the following disclaimer.
////     * Redistributions in binary form must reproduce the above copyright
////       notice, this list of conditions and the following disclaimer in the
////       documentation and/or other materials provided with the distribution.
////     * Neither the name of the Egret nor the
////       names of its contributors may be used to endorse or promote products
////       derived from this software without specific prior written permission.
////
////  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
////  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
////  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
////  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
////  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
////  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
////  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
////  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
////  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
////  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
////
////////////////////////////////////////////////////////////////////////////////////////
var RES;
(function (RES) {
    /**
     * SpriteSheet่งฃๆๅจ
     * @private
     */
    var AnimationAnalyzer = (function (_super) {
        __extends(AnimationAnalyzer, _super);
        function AnimationAnalyzer() {
            var _this = _super.call(this) || this;
            _this.sheetMap = {};
            /**
             * ImageLoaderๅฏน่ฑกๆฑ
             */
            _this.recyclerIamge = [];
            _this._dataFormat = egret.HttpResponseType.TEXT;
            return _this;
        }
        /**
         * ไธ้กนๅ่ฝฝ็ปๆ
         */
        AnimationAnalyzer.prototype.onLoadFinish = function (event) {
            var request = event.target;
            var data = this.resItemDic[request.$hashCode];
            delete this.resItemDic[request.hashCode];
            var resItem = data.item;
            var compFunc = data.func;
            resItem.loaded = (event.type == egret.Event.COMPLETE);
            if (resItem.loaded) {
                if (request instanceof egret.HttpRequest) {
                    resItem.loaded = false;
                    var imageUrl = this.analyzeConfig(resItem, request.response);
                    if (imageUrl) {
                        this.loadImage(imageUrl, data);
                        this.recycler.push(request);
                        return;
                    }
                }
                else {
                    this.analyzeBitmap(resItem, request.data);
                }
            }
            if (request instanceof egret.HttpRequest) {
                this.recycler.push(request);
            }
            else {
                this.recyclerIamge.push(request);
            }
            compFunc.call(data.thisObject, resItem);
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็้็ฝฎๆไปถ
         */
        AnimationAnalyzer.prototype.analyzeConfig = function (resItem, data) {
            var name = resItem.name;
            var config;
            var imageUrl = "";
            try {
                var str = data;
                config = JSON.parse(str);
            }
            catch (e) {
                egret.$warn(1017, resItem.url, data);
            }
            if (config) {
                this.sheetMap[name] = config;
                if (config["file"]) {
                    imageUrl = this.getRelativePath(resItem.url, config["file"]);
                }
                else {
                    var arr = resItem.url.split("?");
                    var arr2 = arr[0].split("/");
                    arr2[arr2.length - 1] = arr2[arr2.length - 1].split(".")[0] + ".png";
                    imageUrl = "";
                    for (var i = 0; i < arr2.length; i++) {
                        imageUrl += arr2[i] + (i < arr2.length - 1 ? "/" : "");
                    }
                    if (arr.length == 2)
                        imageUrl += arr[2];
                }
            }
            return imageUrl;
        };
        /**
         * ่งฃๆๅนถ็ผๅญๅ่ฝฝๆๅ็ไฝๅพๆฐๆฎ
         */
        AnimationAnalyzer.prototype.analyzeBitmap = function (resItem, data) {
            var name = resItem.name;
            if (this.fileDic[name] || !data) {
                return;
            }
            var config = this.sheetMap[name];
            delete this.sheetMap[name];
            var targetName = resItem.data && resItem.data.subkeys ? "" : name;
            var spriteSheet = this.parseAnimation(data, config, targetName);
            this.fileDic[name] = spriteSheet;
        };
        /**
         * ่ทๅ็ธๅฏนไฝ็ฝฎ
         */
        AnimationAnalyzer.prototype.getRelativePath = function (url, file) {
            url = url.split("\\").join("/");
            var index = url.lastIndexOf("/");
            if (index != -1) {
                url = url.substring(0, index + 1) + file;
            }
            else {
                url = file;
            }
            return url;
        };
        AnimationAnalyzer.prototype.parseAnimation = function (bitmapData, data, name) {
            var attributes = Object.keys(data.mc);
            var list = data.mc[attributes[0]].frames;
            var len = list.length;
            var config;
            var animationFrames = [];
            for (var i = 0; i < len; i++) {
                config = data.res[list[i].res];
                var texture = new egret.Texture();
                texture._bitmapData = bitmapData;
                texture.$initData(config.x, config.y, config.w, config.h, list[i].x, list[i].y, list[i].sourceW, list[i].sourceH, bitmapData.width, bitmapData.height);
            }
            return animationFrames;
        };
        AnimationAnalyzer.prototype.destroyRes = function (name) {
            var sheet = this.fileDic[name];
            if (sheet) {
                delete this.fileDic[name];
                return true;
            }
            return false;
        };
        AnimationAnalyzer.prototype.loadImage = function (url, data) {
            var loader = this.getImageLoader();
            this.resItemDic[loader.hashCode] = data;
            loader.load(RES.$getVirtualUrl(url));
        };
        AnimationAnalyzer.prototype.getImageLoader = function () {
            var loader = this.recyclerIamge.pop();
            if (!loader) {
                loader = new egret.ImageLoader();
                loader.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
                loader.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            }
            return loader;
        };
        return AnimationAnalyzer;
    }(RES.BinAnalyzer));
    RES.AnimationAnalyzer = AnimationAnalyzer;
    __reflect(AnimationAnalyzer.prototype, "RES.AnimationAnalyzer");
})(RES || (RES = {}));
var egret;
(function (egret) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["en_US"] = egret.$locale_strings["en_US"] || {};
    var locale_strings = egret.$locale_strings["en_US"];
    //RES 3200-3299
    locale_strings[3200] = "RES.createGroup() passed in non-existed key value in configuration: {0}";
    locale_strings[3201] = "RES loaded non-existed or empty resource group:\"{0}\"";
    locale_strings[3202] = "Do not use the different types of ways to load the same material!";
    locale_strings[3203] = "Can't find the analyzer of the specified file type:{0}ใ Please register the specified analyzer in the initialization of the project first,then start the resource loading processใ";
})(egret || (egret = {}));
var egret;
(function (egret) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["zh_CN"] = egret.$locale_strings["zh_CN"] || {};
    var locale_strings = egret.$locale_strings["zh_CN"];
    //RES 3200-3299
    locale_strings[3200] = "RES.createGroup()ไผๅฅไบ้็ฝฎไธญไธๅญๅจ็้ฎๅผ: {0}";
    locale_strings[3201] = "RESๅ่ฝฝไบไธๅญๅจๆ็ฉบ็่ตๆบ็ป:\"{0}\"";
    locale_strings[3202] = "่ฏทไธ่ฆไฝฟ็จไธๅ็็ฑปๅๆนๅผๆฅๅ่ฝฝๅไธไธช็ดๆ๏ผ";
    locale_strings[3203] = "ๆพไธๅฐๆๅฎๆไปถ็ฑปๅ็่งฃๆๅจ:{0}ใ ่ฏทๅๅจ้กน็ฎๅๅงๅ้ๆณจๅๆๅฎๆไปถ็ฑปๅ็่งฃๆๅจ๏ผๅๅฏๅจ่ตๆบๅ่ฝฝใ";
})(egret || (egret = {}));
var __reflect = (this && this.__reflect) || function (p, c, t) {
    p.__class__ = c, t ? t.push(c) : t = [c], p.__types__ = p.__types__ ? t.concat(p.__types__) : t;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ๅคฑๆ้ช่ฏ็ฎก็ๅจ
         */
        var Validator = (function (_super) {
            __extends(Validator, _super);
            /**
             * @private
             * ๅๅปบไธไธชValidatorๅฏน่ฑก
             */
            function Validator() {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 */
                _this.targetLevel = Number.POSITIVE_INFINITY;
                /**
                 * @private
                 */
                _this.invalidatePropertiesFlag = false;
                /**
                 * @private
                 */
                _this.invalidateClientPropertiesFlag = false;
                /**
                 * @private
                 */
                _this.invalidatePropertiesQueue = new DepthQueue();
                /**
                 * @private
                 */
                _this.invalidateSizeFlag = false;
                /**
                 * @private
                 */
                _this.invalidateClientSizeFlag = false;
                /**
                 * @private
                 */
                _this.invalidateSizeQueue = new DepthQueue();
                /**
                 * @private
                 */
                _this.invalidateDisplayListFlag = false;
                /**
                 * @private
                 */
                _this.invalidateDisplayListQueue = new DepthQueue();
                /**
                 * @private
                 */
                _this.eventDisplay = new egret.Bitmap();
                /**
                 * @private
                 * ๆฏๅฆๅทฒ็ปๆทปๅไบไบไปถ็ๅฌ
                 */
                _this.listenersAttached = false;
                return _this;
            }
            /**
             * @private
             * ๆ่ฎฐ็ปไปถๅฑๆงๅคฑๆ
             */
            Validator.prototype.invalidateProperties = function (client) {
                if (!this.invalidatePropertiesFlag) {
                    this.invalidatePropertiesFlag = true;
                    if (!this.listenersAttached)
                        this.attachListeners();
                }
                if (this.targetLevel <= client.$nestLevel)
                    this.invalidateClientPropertiesFlag = true;
                this.invalidatePropertiesQueue.insert(client);
            };
            /**
             * @private
             * ้ช่ฏๅคฑๆ็ๅฑๆง
             */
            Validator.prototype.validateProperties = function () {
                var queue = this.invalidatePropertiesQueue;
                var client = queue.shift();
                while (client) {
                    if (client.$stage) {
                        client.validateProperties();
                    }
                    client = queue.shift();
                }
                if (queue.isEmpty())
                    this.invalidatePropertiesFlag = false;
            };
            /**
             * @private
             * ๆ่ฎฐ้่ฆ้ๆฐๆต้ๅฐบๅฏธ
             */
            Validator.prototype.invalidateSize = function (client) {
                if (!this.invalidateSizeFlag) {
                    this.invalidateSizeFlag = true;
                    if (!this.listenersAttached)
                        this.attachListeners();
                }
                if (this.targetLevel <= client.$nestLevel)
                    this.invalidateClientSizeFlag = true;
                this.invalidateSizeQueue.insert(client);
            };
            /**
             * @private
             * ๆต้ๅฐบๅฏธ
             */
            Validator.prototype.validateSize = function () {
                var queue = this.invalidateSizeQueue;
                var client = queue.pop();
                while (client) {
                    if (client.$stage) {
                        client.validateSize();
                    }
                    client = queue.pop();
                }
                if (queue.isEmpty())
                    this.invalidateSizeFlag = false;
            };
            /**
             * @private
             * ๆ่ฎฐ้่ฆ้ๆฐๅธๅฑ
             */
            Validator.prototype.invalidateDisplayList = function (client) {
                if (!this.invalidateDisplayListFlag) {
                    this.invalidateDisplayListFlag = true;
                    if (!this.listenersAttached)
                        this.attachListeners();
                }
                this.invalidateDisplayListQueue.insert(client);
            };
            /**
             * @private
             * ้ๆฐๅธๅฑ
             */
            Validator.prototype.validateDisplayList = function () {
                var queue = this.invalidateDisplayListQueue;
                var client = queue.shift();
                while (client) {
                    if (client.$stage) {
                        client.validateDisplayList();
                    }
                    client = queue.shift();
                }
                if (queue.isEmpty())
                    this.invalidateDisplayListFlag = false;
            };
            /**
             * @private
             * ๆทปๅไบไปถ็ๅฌ
             */
            Validator.prototype.attachListeners = function () {
                this.eventDisplay.addEventListener(egret.Event.ENTER_FRAME, this.doPhasedInstantiationCallBack, this);
                this.eventDisplay.addEventListener(egret.Event.RENDER, this.doPhasedInstantiationCallBack, this);
                egret.sys.$invalidateRenderFlag = true;
                this.listenersAttached = true;
            };
            /**
             * @private
             * ๆง่กๅฑๆงๅบ็จ
             */
            Validator.prototype.doPhasedInstantiationCallBack = function (event) {
                this.eventDisplay.removeEventListener(egret.Event.ENTER_FRAME, this.doPhasedInstantiationCallBack, this);
                this.eventDisplay.removeEventListener(egret.Event.RENDER, this.doPhasedInstantiationCallBack, this);
                this.doPhasedInstantiation();
            };
            /**
             * @private
             *
             */
            Validator.prototype.doPhasedInstantiation = function () {
                if (this.invalidatePropertiesFlag) {
                    this.validateProperties();
                }
                if (this.invalidateSizeFlag) {
                    this.validateSize();
                }
                if (this.invalidateDisplayListFlag) {
                    this.validateDisplayList();
                }
                if (this.invalidatePropertiesFlag ||
                    this.invalidateSizeFlag ||
                    this.invalidateDisplayListFlag) {
                    this.attachListeners();
                }
                else {
                    this.listenersAttached = false;
                }
            };
            /**
             * @private
             * ไฝฟๅคงไบ็ญไบๆๅฎ็ปไปถๅฑ็บง็ๅ็ด็ซๅณๅบ็จๅฑๆง
             * @param target ่ฆ็ซๅณๅบ็จๅฑๆง็็ปไปถ
             */
            Validator.prototype.validateClient = function (target) {
                var obj;
                var done = false;
                var oldTargetLevel = this.targetLevel;
                if (this.targetLevel === Number.POSITIVE_INFINITY)
                    this.targetLevel = target.$nestLevel;
                var propertiesQueue = this.invalidatePropertiesQueue;
                var sizeQueue = this.invalidateSizeQueue;
                var displayListQueue = this.invalidateDisplayListQueue;
                while (!done) {
                    done = true;
                    obj = propertiesQueue.removeSmallestChild(target);
                    while (obj) {
                        if (obj.$stage) {
                            obj.validateProperties();
                        }
                        obj = propertiesQueue.removeSmallestChild(target);
                    }
                    if (propertiesQueue.isEmpty()) {
                        this.invalidatePropertiesFlag = false;
                    }
                    this.invalidateClientPropertiesFlag = false;
                    obj = sizeQueue.removeLargestChild(target);
                    while (obj) {
                        if (obj.$stage) {
                            obj.validateSize();
                        }
                        if (this.invalidateClientPropertiesFlag) {
                            obj = (propertiesQueue.removeSmallestChild(target));
                            if (obj) {
                                propertiesQueue.insert(obj);
                                done = false;
                                break;
                            }
                        }
                        obj = sizeQueue.removeLargestChild(target);
                    }
                    if (sizeQueue.isEmpty()) {
                        this.invalidateSizeFlag = false;
                    }
                    this.invalidateClientPropertiesFlag = false;
                    this.invalidateClientSizeFlag = false;
                    obj = displayListQueue.removeSmallestChild(target);
                    while (obj) {
                        if (obj.$stage) {
                            obj.validateDisplayList();
                        }
                        if (this.invalidateClientPropertiesFlag) {
                            obj = propertiesQueue.removeSmallestChild(target);
                            if (obj) {
                                propertiesQueue.insert(obj);
                                done = false;
                                break;
                            }
                        }
                        if (this.invalidateClientSizeFlag) {
                            obj = sizeQueue.removeLargestChild(target);
                            if (obj) {
                                sizeQueue.insert(obj);
                                done = false;
                                break;
                            }
                        }
                        obj = displayListQueue.removeSmallestChild(target);
                    }
                    if (displayListQueue.isEmpty()) {
                        this.invalidateDisplayListFlag = false;
                    }
                }
                if (oldTargetLevel === Number.POSITIVE_INFINITY) {
                    this.targetLevel = Number.POSITIVE_INFINITY;
                }
            };
            return Validator;
        }(egret.EventDispatcher));
        sys.Validator = Validator;
        __reflect(Validator.prototype, "eui.sys.Validator");
        /**
         * @private
         * ๆพ็คบๅ่กจๅตๅฅๆทฑๅบฆๆๅบ้ๅ
         */
        var DepthQueue = (function () {
            function DepthQueue() {
                /**
                 * ๆทฑๅบฆ้ๅ
                 */
                this.depthBins = {};
                /**
                 * ๆๅฐๆทฑๅบฆ
                 */
                this.minDepth = 0;
                /**
                 * ๆๅคงๆทฑๅบฆ
                 */
                this.maxDepth = -1;
            }
            /**
             * ๆๅฅไธไธชๅ็ด
             */
            DepthQueue.prototype.insert = function (client) {
                var depth = client.$nestLevel;
                if (this.maxDepth < this.minDepth) {
                    this.minDepth = this.maxDepth = depth;
                }
                else {
                    if (depth < this.minDepth)
                        this.minDepth = depth;
                    if (depth > this.maxDepth)
                        this.maxDepth = depth;
                }
                var bin = this.depthBins[depth];
                if (!bin) {
                    bin = this.depthBins[depth] = new DepthBin();
                }
                bin.insert(client);
            };
            /**
             * ไป้ๅๅฐพๅผนๅบๆทฑๅบฆๆๅคง็ไธไธชๅฏน่ฑก
             */
            DepthQueue.prototype.pop = function () {
                var client;
                var minDepth = this.minDepth;
                if (minDepth <= this.maxDepth) {
                    var bin = this.depthBins[this.maxDepth];
                    while (!bin || bin.length === 0) {
                        this.maxDepth--;
                        if (this.maxDepth < minDepth)
                            return null;
                        bin = this.depthBins[this.maxDepth];
                    }
                    client = bin.pop();
                    while (!bin || bin.length == 0) {
                        this.maxDepth--;
                        if (this.maxDepth < minDepth)
                            break;
                        bin = this.depthBins[this.maxDepth];
                    }
                }
                return client;
            };
            /**
             * ไป้ๅ้ฆๅผนๅบๆทฑๅบฆๆๅฐ็ไธไธชๅฏน่ฑก
             */
            DepthQueue.prototype.shift = function () {
                var client;
                var maxDepth = this.maxDepth;
                if (this.minDepth <= maxDepth) {
                    var bin = this.depthBins[this.minDepth];
                    while (!bin || bin.length === 0) {
                        this.minDepth++;
                        if (this.minDepth > maxDepth)
                            return null;
                        bin = this.depthBins[this.minDepth];
                    }
                    client = bin.pop();
                    while (!bin || bin.length == 0) {
                        this.minDepth++;
                        if (this.minDepth > maxDepth)
                            break;
                        bin = this.depthBins[this.minDepth];
                    }
                }
                return client;
            };
            /**
             * ็งป้คๅคงไบ็ญไบๆๅฎ็ปไปถๅฑ็บง็ๅ็ดไธญๆๅคง็ๅ็ด
             */
            DepthQueue.prototype.removeLargestChild = function (client) {
                var hashCode = client.$hashCode;
                var nestLevel = client.$nestLevel;
                var max = this.maxDepth;
                var min = nestLevel;
                while (min <= max) {
                    var bin = this.depthBins[max];
                    if (bin && bin.length > 0) {
                        if (max === nestLevel) {
                            if (bin.map[hashCode]) {
                                bin.remove(client);
                                return client;
                            }
                        }
                        else if (egret.is(client, "egret.DisplayObjectContainer")) {
                            var items = bin.items;
                            var length_1 = bin.length;
                            for (var i = 0; i < length_1; i++) {
                                var value = items[i];
                                if (client.contains(value)) {
                                    bin.remove(value);
                                    return value;
                                }
                            }
                        }
                        else {
                            break;
                        }
                        max--;
                    }
                    else {
                        if (max == this.maxDepth) {
                            this.maxDepth--;
                        }
                        max--;
                        if (max < min)
                            break;
                    }
                }
                return null;
            };
            /**
             * ็งป้คๅคงไบ็ญไบๆๅฎ็ปไปถๅฑ็บง็ๅ็ดไธญๆๅฐ็ๅ็ด
             */
            DepthQueue.prototype.removeSmallestChild = function (client) {
                var nestLevel = client.$nestLevel;
                var min = nestLevel;
                var max = this.maxDepth;
                var hashCode = client.$hashCode;
                while (min <= max) {
                    var bin = this.depthBins[min];
                    if (bin && bin.length > 0) {
                        if (min === nestLevel) {
                            if (bin.map[hashCode]) {
                                bin.remove(client);
                                return client;
                            }
                        }
                        else if (egret.is(client, "egret.DisplayObjectContainer")) {
                            var items = bin.items;
                            var length_2 = bin.length;
                            for (var i = 0; i < length_2; i++) {
                                var value = items[i];
                                if (client.contains(value)) {
                                    bin.remove(value);
                                    return value;
                                }
                            }
                        }
                        else {
                            break;
                        }
                        min++;
                    }
                    else {
                        if (min == this.minDepth)
                            this.minDepth++;
                        min++;
                        if (min > max)
                            break;
                    }
                }
                return null;
            };
            /**
             * ้ๅๆฏๅฆไธบ็ฉบ
             */
            DepthQueue.prototype.isEmpty = function () {
                return this.minDepth > this.maxDepth;
            };
            return DepthQueue;
        }());
        __reflect(DepthQueue.prototype, "DepthQueue");
        /**
         * @private
         * ๅ่กจ้กน
         */
        var DepthBin = (function () {
            function DepthBin() {
                this.map = {};
                this.items = [];
                this.length = 0;
            }
            DepthBin.prototype.insert = function (client) {
                var hashCode = client.$hashCode;
                if (this.map[hashCode]) {
                    return;
                }
                this.map[hashCode] = true;
                this.length++;
                this.items.push(client);
            };
            DepthBin.prototype.pop = function () {
                var client = this.items.pop(); //ไฝฟ็จpopไผๆฏshiftๆๆด้ซ็ๆง่ฝ๏ผ้ฟๅ็ดขๅผๆดไฝ้็ฝฎใ
                if (client) {
                    this.length--;
                    if (this.length === 0) {
                        this.map = {}; //ๆธ็ฉบๆๆkey้ฒๆญขๅๅญๆณ้ฒ
                    }
                    else {
                        this.map[client.$hashCode] = false;
                    }
                }
                return client;
            };
            DepthBin.prototype.remove = function (client) {
                var index = this.items.indexOf(client);
                if (index >= 0) {
                    this.items.splice(index, 1);
                    this.length--;
                    if (this.length === 0) {
                        this.map = {}; //ๆธ็ฉบๆๆkey้ฒๆญขๅๅญๆณ้ฒ
                    }
                    else {
                        this.map[client.$hashCode] = false;
                    }
                }
            };
            return DepthBin;
        }());
        __reflect(DepthBin.prototype, "DepthBin");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Register a property for a class definition in running,
     * so that the EUI can get type of property accurate when parsing a EXML.
     * This need not be called directly in most of time. Only when you have a custom UI
     * component need to be described in EXML, you may invoke this method explicitly.
     *
     * Contains no following๏ผ
     * When the property is the basic data type(boolean, number, string or Array), you only need set a correct initial value
     * for he custom property then the EXML parser can get the correct property type in running.
     *
     * If you can not set the correct initial value (such as <code>null</code>), the EXML parser will treat this property as
     * <code>string</code>. If there is no inital value, EUI will throw an error. But you can invoked this method to register
     * a property in this case.
     *
     *
     * @param classDefinition The class definition need to be registered.
     * @param property The property need to be registered. Note that the property
     * name cannot start with "_" or "$".
     * @param type The type need to be registered,
     * such as โboolean","number","string","Array","egret.Rectangle" and so on.
     * @param asDefault Whether register this property as a default property of component.
     * One component can register only on default property. And the default property can be spare in an EXML.
     *
     * @example๏ผ
     * <pre>
     *      <s:Scroller>
     *          <s:viewport>
     *          <s:Group/>
     *          </e:viewport>
     *      </e:Scroller>
     * </pre>
     * Cuz <code>viewport</code> is the default property of Scroller. So you can write as follow:
     * <pre>
     *      <s:Scroller>
     *          <s:Group/>
     *      </e:Scroller>
     * </pre>
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ไธบไธไธช็ฑปๅฎไนๆณจๅ่ฟ่กๆถๅฑๆง็ฑปๅ๏ผไปฅไพฟ่ฟ่กๆถ็EXMLๆไปถ่งฃๆ่ฟ็จ่ฝ่ทๅๅ็กฎ็ๅฑๆง็ฑปๅใๅคงๅคๆฐๆๅตไธ๏ผๆจ้ฝไธ้่ฆๆๅจ่ฐ็จๆญคๆนๆณๆพๅผๆณจๅๅฑๆง็ฑปๅใ
     * ไปๅฝๆจๆไธไธช่ชๅฎไน็ UI ็ปไปถ๏ผ้่ฆๅจEXMLไธญ็จๆ็ญพๆ่ฟฐๆถๅฏ่ฝ้่ฆๆพๅผๆณจๅ๏ผไฝไปฅไธๆๅต้คๅค๏ผ
     * ๅฝๅฑๆง็ฑปๅไธบๅบๆฌๆฐๆฎ็ฑปๅ๏ผboolean,number,string,Array่ฟๅ็งๅถไธญไนไธๆถ๏ผๆจๅช้่ฆไธบ่ชๅฎไน็ๅฑๆง่ตๅผไธๆญฃ็กฎ็ๅๅงๅผ๏ผ
     * ่ฟ่กๆถEXML่งฃๆๅจๅฐฑ่ฝ้่ฟๅๅงๅผ่ชๅจๅๆๅบๆญฃ็กฎ็ๅฑๆง็ฑปๅใ
     * ่ฅๆจๆๆณไธบๅฑๆง่ตๅผไธๆญฃ็กฎ็ๅๅงๅผๆถ(ๆๅๅงๅผ๏ผๆฏๅฆnull),่ฟ่กๆถEXML่งฃๆๅจไผๆๆญคๅฑๆงๅฝๅstringๆฅๅค็๏ผ่ฅๅฎๅจๆฒกๆๅๅงๅผ๏ผๅฐไผๆฅ้ๆพไธๅฐ่็นๅฑๆง๏ผ
     * ่ฟ็งๆๅตไธๅฏไปฅๆๅจ่ฐ็จๆญคๆนๆณๆพๅผๆณจๅๅฑๆง็ฑปๅใ
     *
     * @param classDefinition ่ฆๆณจๅ็็ฑปๅฎไนใ
     * @param property ่ฆๆณจๅ็ๅฑๆง,ๆณจๆๅฑๆงๅไธ่ฝไปฅ _ ๆ $ ็ฌฆๅผๅคดใ
     * @param type ่ฆๆณจๅ็็ฑปๅ,ไพๅฆ๏ผโboolean","number","string","Array","egret.Rectangle"
     * @param asDefault ๆฏๅฆๅฐๆญคๅฑๆงๆณจๅไธบ็ปไปถ็้ป่ฎคๅฑๆง,ไธไธช็ปไปถๅชๅฏไปฅ่ฎพ็ฝฎไธไธช้ป่ฎคๅฑๆงใๆณจๅไบ็ปไปถ้ป่ฎคๅฑๆงๅ๏ผๅจEXMLไธญๅฏไปฅไฝฟ็จ็็ฅๅฑๆง่็น็ๅๆณ๏ผ
     * @example๏ผ
     * <pre>
     * <s:Scroller>
     *     <s:viewport>
     *         <s:Group/>
     *     </e:viewport>
     * </e:Scroller>
     * </pre>
     * ๅไธบ viewport ๅทฒ็ปๆณจๅไธบ Scroller ็้ป่ฎคๅฑๆง๏ผไธ้ข็ไพๅญๅฏไปฅ็ญๆไธบ๏ผ
     * <pre>
     * <s:Scroller>
     *     <s:Group/>
     * </e:Scroller>
     * </pre>
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    function registerProperty(classDefinition, property, type, asDefault) {
        if (true) {
            if (!classDefinition) {
                egret.$error(1003, "classDefinition");
            }
            if (!classDefinition.prototype) {
                egret.$error(1012, "classDefinition");
            }
            if (!property) {
                egret.$error(1003, "property");
            }
            if (!type) {
                egret.$error(1003, "type");
            }
        }
        var prototype = classDefinition.prototype;
        prototype.__meta__ = prototype.__meta__ || {};
        prototype.__meta__[property] = type;
        if (asDefault) {
            prototype.__defaultProperty__ = property;
        }
    }
    eui.registerProperty = registerProperty;
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The State class defines a view state, a particular view of a component.
     *
     * For example, a product thumbnail could have two view states;
     * a base view state with minimal information, and a rich view state with
     * additional information.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * State ็ฑปๅฎไน่งๅพ็ถๆ๏ผๅณ็ปไปถ็็นๅฎ่งๅพใ
     *
     * ไพๅฆ๏ผไบงๅ็ผฉ็ฅๅพๅฏไปฅๆไธคไธช่งๅพ็ถๆ๏ผๅๅซๆๅฐไฟกๆฏ็ๅบๆฌ่งๅพ็ถๆๅๅๅซ้ๅไฟกๆฏ็ไธฐๅฏ่งๅพ็ถๆใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var State = (function (_super) {
        __extends(State, _super);
        /**
         * Constructor.
         *
         * @param name The name of the view state.
         * State names must be unique for a given component.
         * This property must be set.
         * @param overrides The overrides for this view state, as an Array of objects that implement
         * the IOverride interface. These overrides are applied in order when the
         * state is entered, and removed in reverse order when the state is exited.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชStateๅฎไพใ
         *
         * @param name ่งๅพ็ถๆ็ๅ็งฐใ็ปๅฎ็ปไปถ็็ถๆๅ็งฐๅฟ้กปๅฏไธใๅฟ้กป่ฎพ็ฝฎๆญคๅฑๆงใ
         * @param overrides ่ฏฅ่งๅพ็ถๆ็่ฆ็๏ผ่กจ็ฐไธบๅฎ็ฐ IOverride ๆฅๅฃ็ๅฏน่ฑก็ๆฐ็ปใ
         * ่ฟไบ่ฆ็ๅจ่ฟๅฅ็ถๆๆถๆ้กบๅบๅบ็จ๏ผๅจ้ๅบ็ถๆๆถๆ็ธๅ็้กบๅบๅ้คใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function State(name, overrides) {
            if (overrides === void 0) {
                overrides = [];
            }
            var _this = _super.call(this) || this;
            _this.name = name;
            _this.overrides = overrides;
            return _this;
        }
        /**
         * Initialize this state and all of its overrides.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅงๅ่งๅพ็ถๆ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        State.prototype.initialize = function (host, stage) {
            var overrides = this.overrides;
            var length = overrides.length;
            for (var i = 0; i < length; i++) {
                var addItems = overrides[i];
                if (addItems instanceof eui.AddItems) {
                    var target = host[addItems.target];
                    if (target && target instanceof eui.Image && !target.$parent) {
                        stage.addChild(target);
                        stage.removeChild(target);
                    }
                }
            }
        };
        return State;
    }(egret.HashObject));
    eui.State = State;
    __reflect(State.prototype, "eui.State");
})(eui || (eui = {}));
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         */
        var StateClient = (function () {
            function StateClient() {
            }
            Object.defineProperty(StateClient.prototype, "states", {
                /**
                 * @private
                 * ไธบๆญค็ปไปถๅฎไน็่งๅพ็ถๆใ
                 */
                get: function () {
                    return this.$stateValues.states;
                },
                set: function (value) {
                    if (!value)
                        value = [];
                    var values = this.$stateValues;
                    values.states = value;
                    var statesMap = {};
                    var length = value.length;
                    for (var i = 0; i < length; i++) {
                        var state = value[i];
                        statesMap[state.name] = state;
                    }
                    values.statesMap = statesMap;
                    if (values.parent) {
                        this.commitCurrentState();
                    }
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(StateClient.prototype, "currentState", {
                /**
                 * @private
                 * ็ปไปถ็ๅฝๅ่งๅพ็ถๆใๅฐๅถ่ฎพ็ฝฎไธบ "" ๆ null ๅฏๅฐ็ปไปถ้็ฝฎๅๅถๅบๆฌ็ถๆใ
                 */
                get: function () {
                    return this.$stateValues.currentState;
                },
                set: function (value) {
                    var values = this.$stateValues;
                    values.explicitState = value;
                    values.currentState = value;
                    this.commitCurrentState();
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             * ๅบ็จๅฝๅ็่งๅพ็ถๆใๅญ็ฑป่ฆ็ๆญคๆนๆณๅจ่งๅพ็ถๆๅ็ๆนๅๆถๆง่ก็ธๅบๆดๆฐๆไฝใ
             */
            StateClient.prototype.commitCurrentState = function () {
                var values = this.$stateValues;
                if (!values.parent) {
                    return;
                }
                var destination = values.statesMap[values.currentState];
                if (!destination) {
                    if (values.states.length > 0) {
                        values.currentState = values.states[0].name;
                    }
                    else {
                        return;
                    }
                }
                if (values.oldState == values.currentState) {
                    return;
                }
                var parent = values.parent;
                var state = values.statesMap[values.oldState];
                if (state) {
                    var overrides = state.overrides;
                    var length_3 = overrides.length;
                    for (var i = 0; i < length_3; i++) {
                        overrides[i].remove(this, parent);
                    }
                }
                values.oldState = values.currentState;
                state = values.statesMap[values.currentState];
                if (state) {
                    var overrides = state.overrides;
                    var length_4 = overrides.length;
                    for (var i = 0; i < length_4; i++) {
                        overrides[i].apply(this, parent);
                    }
                }
            };
            /**
             * @private
             * ่ฟๅๆฏๅฆๅซๆๆๅฎๅ็งฐ็่งๅพ็ถๆ
             * @param stateName ่ฆๆฃๆฅ็่งๅพ็ถๆๅ็งฐ
             */
            StateClient.prototype.hasState = function (stateName) {
                return !!this.$stateValues.statesMap[stateName];
            };
            /**
             * @private
             * ๅๅงๅๆๆ่งๅพ็ถๆ
             */
            StateClient.prototype.initializeStates = function (stage) {
                this.$stateValues.intialized = true;
                var states = this.states;
                var length = states.length;
                for (var i = 0; i < length; i++) {
                    states[i].initialize(this, stage);
                }
            };
            return StateClient;
        }());
        sys.StateClient = StateClient;
        __reflect(StateClient.prototype, "eui.sys.StateClient");
        /**
         * @private
         */
        var StateValues = (function () {
            function StateValues() {
                /**
                 * @private
                 */
                this.intialized = false;
                /**
                 * @private
                 */
                this.statesMap = {};
                /**
                 * @private
                 */
                this.states = [];
                /**
                 * @private
                 */
                this.oldState = null;
                /**
                 * @private
                 */
                this.explicitState = null;
                /**
                 * @private
                 */
                this.currentState = null;
                /**
                 * @private
                 */
                this.parent = null;
                /**
                 * @private
                 */
                this.stateIsDirty = false;
            }
            return StateValues;
        }());
        sys.StateValues = StateValues;
        __reflect(StateValues.prototype, "eui.sys.StateValues");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="Validator.ts" />
var eui;
(function (eui) {
    function getAssets(source, callback) {
        var adapter = egret.getImplementation("eui.IAssetAdapter");
        if (!adapter) {
            adapter = new eui.DefaultAssetAdapter();
        }
        adapter.getAsset(source, function (content) {
            callback(content);
        }, this);
    }
    eui.getAssets = getAssets;
    function getTheme(source, callback) {
        var adapter = egret.getImplementation("eui.IThemeAdapter");
        if (!adapter) {
            adapter = new eui.DefaultThemeAdapter();
        }
        adapter.getTheme(source, function (data) {
            callback(data);
        }, function (e) { console.log(e); }, this);
    }
    eui.getTheme = getTheme;
})(eui || (eui = {}));
(function (eui) {
    var sys;
    (function (sys) {
        var UIComponentClass = "eui.UIComponent";
        function isDeltaIdentity(m) {
            return (m.a === 1 && m.b === 0 && m.c === 0 && m.d === 1);
        }
        var validator = new sys.Validator();
        /**
         * @private
         * EUI ๆพ็คบๅฏน่ฑกๅบ็ฑปๆจกๆฟใไปไฝไธบ UIComponent ็้ป่ฎคๅฎ็ฐ๏ผไธบegret.sys.implemenetUIComponenet()ๆนๆณๆไพไปฃ็ๆจกๆฟใ
         * ๆณจๆ๏ผๅจๆญค็ฑป้ไธๅ่ฎธ็ดๆฅไฝฟ็จsuperๅณ้ฎๅญ่ฎฟ้ฎ็ถ็ฑปๆนๆณใไธๅพไฝฟ็จthis.$superๅฑๆง่ฎฟ้ฎใ
         */
        var UIComponentImpl = (function (_super) {
            __extends(UIComponentImpl, _super);
            /**
             * @private
             * ๆ้ๅฝๆฐ
             */
            function UIComponentImpl() {
                var _this = _super.call(this) || this;
                _this.initializeUIValues();
                return _this;
            }
            /**
             * @private
             * UIComponentImpl ๅฎไน็ๆๆๅ้่ฏทไธ่ฆๆทปๅไปปไฝๅๅงๅผ๏ผๅฟ้กป็ปไธๅจๆญคๅคๅๅงๅใ
             */
            UIComponentImpl.prototype.initializeUIValues = function () {
                this.$UIComponent = {
                    0: NaN,
                    1: NaN,
                    2: NaN,
                    3: NaN,
                    4: NaN,
                    5: NaN,
                    6: NaN,
                    7: NaN,
                    8: NaN,
                    9: NaN,
                    10: 0,
                    11: 0,
                    12: 0,
                    13: 100000,
                    14: 0,
                    15: 100000,
                    16: 0,
                    17: 0,
                    18: NaN,
                    19: NaN,
                    20: 0,
                    21: 0,
                    22: 0,
                    23: 0,
                    24: true,
                    25: true,
                    26: true,
                    27: false,
                    28: false,
                    29: false,
                };
                this.$includeInLayout = true;
                //if egret
                this.$touchEnabled = true;
                //endif*/
            };
            /**
             * @private
             * ๅญ็ฑป่ฆ็ๆญคๆนๆณๅฏไปฅๆง่กไธไบๅๅงๅๅญ้กนๆไฝใๆญคๆนๆณไปๅจ็ปไปถ็ฌฌไธๆฌกๆทปๅๅฐ่ๅฐๆถๅ่ฐไธๆฌกใ
             * ่ฏทๅกๅฟ่ฐ็จsuper.createChildren()ไปฅๅฎๆ็ถ็ฑป็ปไปถ็ๅๅงๅ
             */
            UIComponentImpl.prototype.createChildren = function () {
            };
            /**
             * @private
             * ๅญ้กนๅๅปบๅฎๆ,ๆญคๆนๆณๅจcreateChildren()ไนๅๆง่กใ
             */
            UIComponentImpl.prototype.childrenCreated = function () {
            };
            /**
             * @private
             * ๆไบคๅฑๆง๏ผๅญ็ฑปๅจ่ฐ็จๅฎinvalidateProperties()ๆนๆณๅ๏ผๅบ่ฆ็ๆญคๆนๆณไปฅๅบ็จๅฑๆง
             */
            UIComponentImpl.prototype.commitProperties = function () {
                var values = this.$UIComponent;
                if (values[22 /* oldWidth */] != values[10 /* width */] || values[23 /* oldHeight */] != values[11 /* height */]) {
                    this.dispatchEventWith(egret.Event.RESIZE);
                    values[22 /* oldWidth */] = values[10 /* width */];
                    values[23 /* oldHeight */] = values[11 /* height */];
                }
                if (values[20 /* oldX */] != this.$getX() || values[21 /* oldY */] != this.$getY()) {
                    eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.MOVE);
                    values[20 /* oldX */] = this.$getX();
                    values[21 /* oldY */] = this.$getY();
                }
            };
            /**
             * @private
             * ๆต้็ปไปถๅฐบๅฏธ
             */
            UIComponentImpl.prototype.measure = function () {
            };
            /**
             * @private
             * ๆดๆฐๆพ็คบๅ่กจ
             */
            UIComponentImpl.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            };
            Object.defineProperty(UIComponentImpl.prototype, "includeInLayout", {
                /**
                 * @private
                 * ๆๅฎๆญค็ปไปถๆฏๅฆๅๅซๅจ็ถๅฎนๅจ็ๅธๅฑไธญใ่ฅไธบfalse๏ผๅ็ถ็บงๅฎนๅจๅจๆต้ๅๅธๅฑ้ถๆฎต้ฝๅฟฝ็ฅๆญค็ปไปถใ้ป่ฎคๅผไธบtrueใ
                 * ๆณจๆ๏ผvisibleๅฑๆงไธๆญคๅฑๆงไธๅ๏ผ่ฎพ็ฝฎvisibleไธบfalse๏ผ็ถ็บงๅฎนๅจไปไผๅฏนๅถๅธๅฑใ
                 */
                get: function () {
                    return this.$includeInLayout;
                },
                set: function (value) {
                    value = !!value;
                    if (this.$includeInLayout === value)
                        return;
                    this.$includeInLayout = true;
                    this.invalidateParentLayout();
                    this.$includeInLayout = value;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             *
             * @param stage
             * @param nestLevel
             */
            UIComponentImpl.prototype.$onAddToStage = function (stage, nestLevel) {
                this.$super.$onAddToStage.call(this, stage, nestLevel);
                this.checkInvalidateFlag();
                var values = this.$UIComponent;
                if (!values[29 /* initialized */]) {
                    values[29 /* initialized */] = true;
                    this.createChildren();
                    this.childrenCreated();
                    eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CREATION_COMPLETE);
                }
            };
            /**
             * @private
             * ๆฃๆฅๅฑๆงๅคฑๆๆ่ฎฐๅนถๅบ็จ
             */
            UIComponentImpl.prototype.checkInvalidateFlag = function (event) {
                var values = this.$UIComponent;
                if (values[24 /* invalidatePropertiesFlag */]) {
                    validator.invalidateProperties(this);
                }
                if (values[25 /* invalidateSizeFlag */]) {
                    validator.invalidateSize(this);
                }
                if (values[26 /* invalidateDisplayListFlag */]) {
                    validator.invalidateDisplayList(this);
                }
            };
            Object.defineProperty(UIComponentImpl.prototype, "left", {
                /**
                 * @private
                 * ่ท็ถ็บงๅฎนๅจ็ฆปๅทฆ่พน่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[0 /* left */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[0 /* left */] === value)
                        return;
                    values[0 /* left */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "right", {
                /**
                 * @private
                 * ่ท็ถ็บงๅฎนๅจๅณ่พน่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[1 /* right */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[1 /* right */] === value)
                        return;
                    values[1 /* right */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "top", {
                /**
                 * @private
                 * ่ท็ถ็บงๅฎนๅจ้กถ้จ่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[2 /* top */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[2 /* top */] === value)
                        return;
                    values[2 /* top */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "bottom", {
                /**
                 * @private
                 * ่ท็ถ็บงๅฎนๅจๅบ้จ่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[3 /* bottom */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[3 /* bottom */] == value)
                        return;
                    values[3 /* bottom */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "horizontalCenter", {
                /**
                 * @private
                 * ๅจ็ถ็บงๅฎนๅจไธญ่ทๆฐดๅนณไธญๅฟไฝ็ฝฎ็่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[4 /* horizontalCenter */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[4 /* horizontalCenter */] === value)
                        return;
                    values[4 /* horizontalCenter */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "verticalCenter", {
                /**
                 * @private
                 * ๅจ็ถ็บงๅฎนๅจไธญ่ท็ซ็ดไธญๅฟไฝ็ฝฎ็่ท็ฆป
                 */
                get: function () {
                    return this.$UIComponent[5 /* verticalCenter */];
                },
                set: function (value) {
                    if (!value || typeof value == "number") {
                        value = +value;
                    }
                    else {
                        value = value.toString().trim();
                    }
                    var values = this.$UIComponent;
                    if (values[5 /* verticalCenter */] === value)
                        return;
                    values[5 /* verticalCenter */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "percentWidth", {
                /**
                 * @private
                 * ็ธๅฏน็ถ็บงๅฎนๅจๅฎฝๅบฆ็็พๅๆฏ
                 */
                get: function () {
                    return this.$UIComponent[6 /* percentWidth */];
                },
                set: function (value) {
                    value = +value;
                    var values = this.$UIComponent;
                    if (values[6 /* percentWidth */] === value)
                        return;
                    values[6 /* percentWidth */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "percentHeight", {
                /**
                 * @private
                 * ็ธๅฏน็ถ็บงๅฎนๅจ้ซๅบฆ็็พๅๆฏ
                 */
                get: function () {
                    return this.$UIComponent[7 /* percentHeight */];
                },
                set: function (value) {
                    value = +value;
                    var values = this.$UIComponent;
                    if (values[7 /* percentHeight */] === value)
                        return;
                    values[7 /* percentHeight */] = value;
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "explicitWidth", {
                /**
                 * @private
                 * ๅค้จๆพๅผๆๅฎ็ๅฎฝๅบฆ
                 */
                get: function () {
                    return this.$UIComponent[8 /* explicitWidth */];
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "explicitHeight", {
                /**
                 * @private
                 * ๅค้จๆพๅผๆๅฎ็้ซๅบฆ
                 */
                get: function () {
                    return this.$UIComponent[9 /* explicitHeight */];
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             * ็ปไปถๅฎฝๅบฆ,้ป่ฎคๅผไธบegret.NaN,่ฎพ็ฝฎไธบNaNๅฐไฝฟ็จ็ปไปถ็measure()ๆนๆณ่ชๅจ่ฎก็ฎๅฐบๅฏธ
             */
            UIComponentImpl.prototype.$getWidth = function () {
                this.validateSizeNow();
                return this.$UIComponent[10 /* width */];
            };
            /**
             * @private
             *
             * @param value
             */
            UIComponentImpl.prototype.$setWidth = function (value) {
                value = +value;
                var values = this.$UIComponent;
                if (value < 0 || values[10 /* width */] === value && values[8 /* explicitWidth */] === value)
                    return false;
                values[8 /* explicitWidth */] = value;
                if (isNaN(value))
                    this.invalidateSize();
                this.invalidateProperties();
                this.invalidateDisplayList();
                this.invalidateParentLayout();
                return true;
            };
            /**
             * @private
             * ็ซๅณ้ช่ฏ่ช่บซ็ๅฐบๅฏธใ
             */
            UIComponentImpl.prototype.validateSizeNow = function () {
                this.validateSize(true);
                this.updateFinalSize();
            };
            /**
             * @private
             * ็ปไปถ้ซๅบฆ,้ป่ฎคๅผไธบNaN,่ฎพ็ฝฎไธบNaNๅฐไฝฟ็จ็ปไปถ็measure()ๆนๆณ่ชๅจ่ฎก็ฎๅฐบๅฏธ
             */
            UIComponentImpl.prototype.$getHeight = function () {
                this.validateSizeNow();
                return this.$UIComponent[11 /* height */];
            };
            /**
             * @private
             *
             * @param value
             */
            UIComponentImpl.prototype.$setHeight = function (value) {
                value = +value;
                var values = this.$UIComponent;
                if (value < 0 || values[11 /* height */] === value && values[9 /* explicitHeight */] === value)
                    return false;
                values[9 /* explicitHeight */] = value;
                if (isNaN(value))
                    this.invalidateSize();
                this.invalidateProperties();
                this.invalidateDisplayList();
                this.invalidateParentLayout();
                return true;
            };
            Object.defineProperty(UIComponentImpl.prototype, "minWidth", {
                /**
                 * @private
                 * ็ปไปถ็ๆๅฐๅฎฝๅบฆ,ๆญคๅฑๆง่ฎพ็ฝฎไธบๅคงไบmaxWidth็ๅผๆถๆๆใๅๆถๅฝฑๅๆต้ๅ่ชๅจๅธๅฑ็ๅฐบๅฏธใ
                 */
                get: function () {
                    return this.$UIComponent[12 /* minWidth */];
                },
                set: function (value) {
                    value = +value || 0;
                    var values = this.$UIComponent;
                    if (value < 0 || values[12 /* minWidth */] === value) {
                        return;
                    }
                    values[12 /* minWidth */] = value;
                    this.invalidateSize();
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "maxWidth", {
                /**
                 * @private
                 * ็ปไปถ็ๆๅคง้ซๅบฆใๅๆถๅฝฑๅๆต้ๅ่ชๅจๅธๅฑ็ๅฐบๅฏธใ
                 */
                get: function () {
                    return this.$UIComponent[13 /* maxWidth */];
                },
                set: function (value) {
                    value = +value || 0;
                    var values = this.$UIComponent;
                    if (value < 0 || values[13 /* maxWidth */] === value) {
                        return;
                    }
                    values[13 /* maxWidth */] = value;
                    this.invalidateSize();
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "minHeight", {
                /**
                 * @private
                 * ็ปไปถ็ๆๅฐ้ซๅบฆ,ๆญคๅฑๆง่ฎพ็ฝฎไธบๅคงไบmaxHeight็ๅผๆถๆๆใๅๆถๅฝฑๅๆต้ๅ่ชๅจๅธๅฑ็ๅฐบๅฏธใ
                 */
                get: function () {
                    return this.$UIComponent[14 /* minHeight */];
                },
                set: function (value) {
                    value = +value || 0;
                    var values = this.$UIComponent;
                    if (value < 0 || values[14 /* minHeight */] === value) {
                        return;
                    }
                    values[14 /* minHeight */] = value;
                    this.invalidateSize();
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(UIComponentImpl.prototype, "maxHeight", {
                /**
                 * @private
                 * ็ปไปถ็ๆๅคง้ซๅบฆ,ๅๆถๅฝฑๅๆต้ๅ่ชๅจๅธๅฑ็ๅฐบๅฏธใ
                 */
                get: function () {
                    return this.$UIComponent[15 /* maxHeight */];
                },
                set: function (value) {
                    value = +value || 0;
                    var values = this.$UIComponent;
                    if (value < 0 || values[15 /* maxHeight */] === value) {
                        return;
                    }
                    values[15 /* maxHeight */] = value;
                    this.invalidateSize();
                    this.invalidateParentLayout();
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @private
             * ่ฎพ็ฝฎๆต้็ปๆใ
             * @param width ๆต้ๅฎฝๅบฆ
             * @param height ๆต้้ซๅบฆ
             */
            UIComponentImpl.prototype.setMeasuredSize = function (width, height) {
                var values = this.$UIComponent;
                values[16 /* measuredWidth */] = Math.ceil(+width || 0);
                values[17 /* measuredHeight */] = Math.ceil(+height || 0);
            };
            /**
             * @private
             * ่ฎพ็ฝฎ็ปไปถ็ๅฎฝ้ซใๆญคๆนๆณไธๅไบ็ดๆฅ่ฎพ็ฝฎwidth,heightๅฑๆง๏ผ
             * ไธไผๅฝฑๅๆพๅผๆ่ฎฐๅฐบๅฏธๅฑๆง
             */
            UIComponentImpl.prototype.setActualSize = function (w, h) {
                var change = false;
                var values = this.$UIComponent;
                if (values[10 /* width */] !== w) {
                    values[10 /* width */] = w;
                    change = true;
                }
                if (values[11 /* height */] !== h) {
                    values[11 /* height */] = h;
                    change = true;
                }
                if (change) {
                    this.invalidateDisplayList();
                    this.dispatchEventWith(egret.Event.RESIZE);
                }
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.$invalidateMatrix = function () {
                this.$super.$invalidateMatrix.call(this);
                this.invalidateParentLayout();
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.$setMatrix = function (matrix, needUpdateProperties) {
                if (needUpdateProperties === void 0) {
                    needUpdateProperties = true;
                }
                this.$super.$setMatrix.call(this, matrix, needUpdateProperties);
                this.invalidateParentLayout();
                return true;
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.$setAnchorOffsetX = function (value) {
                this.$super.$setAnchorOffsetX.call(this, value);
                this.invalidateParentLayout();
                return true;
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.$setAnchorOffsetY = function (value) {
                this.$super.$setAnchorOffsetY.call(this, value);
                this.invalidateParentLayout();
                return true;
            };
            /**
             * @private
             *
             * @param value
             * @returns
             */
            UIComponentImpl.prototype.$setX = function (value) {
                var change = this.$super.$setX.call(this, value);
                if (change) {
                    this.invalidateParentLayout();
                    this.invalidateProperties();
                }
                return change;
            };
            /**
             * @private
             *
             * @param value
             * @returns
             */
            UIComponentImpl.prototype.$setY = function (value) {
                var change = this.$super.$setY.call(this, value);
                if (change) {
                    this.invalidateParentLayout();
                    this.invalidateProperties();
                }
                return change;
            };
            /**
             * @private
             * ๆ่ฎฐๅฑๆงๅคฑๆ
             */
            UIComponentImpl.prototype.invalidateProperties = function () {
                var values = this.$UIComponent;
                if (!values[24 /* invalidatePropertiesFlag */]) {
                    values[24 /* invalidatePropertiesFlag */] = true;
                    if (this.$stage)
                        validator.invalidateProperties(this);
                }
            };
            /**
             * @private
             * ้ช่ฏ็ปไปถ็ๅฑๆง
             */
            UIComponentImpl.prototype.validateProperties = function () {
                var values = this.$UIComponent;
                if (values[24 /* invalidatePropertiesFlag */]) {
                    this.commitProperties();
                    values[24 /* invalidatePropertiesFlag */] = false;
                }
            };
            /**
             * @private
             * ๆ่ฎฐๆไบค่ฟ้่ฆ้ช่ฏ็ปไปถๅฐบๅฏธ
             */
            UIComponentImpl.prototype.invalidateSize = function () {
                var values = this.$UIComponent;
                if (!values[25 /* invalidateSizeFlag */]) {
                    values[25 /* invalidateSizeFlag */] = true;
                    if (this.$stage)
                        validator.invalidateSize(this);
                }
            };
            /**
             * @private
             * ้ช่ฏ็ปไปถ็ๅฐบๅฏธ
             */
            UIComponentImpl.prototype.validateSize = function (recursive) {
                if (recursive) {
                    var children = this.$children;
                    if (children) {
                        var length_5 = children.length;
                        for (var i = 0; i < length_5; i++) {
                            var child = children[i];
                            if (egret.is(child, UIComponentClass)) {
                                child.validateSize(true);
                            }
                        }
                    }
                }
                var values = this.$UIComponent;
                if (values[25 /* invalidateSizeFlag */]) {
                    var changed = this.measureSizes();
                    if (changed) {
                        this.invalidateDisplayList();
                        this.invalidateParentLayout();
                    }
                    values[25 /* invalidateSizeFlag */] = false;
                }
            };
            /**
             * @private
             * ๆต้็ปไปถๅฐบๅฏธ๏ผ่ฟๅๅฐบๅฏธๆฏๅฆๅ็ๅๅ
             */
            UIComponentImpl.prototype.measureSizes = function () {
                var changed = false;
                var values = this.$UIComponent;
                if (!values[25 /* invalidateSizeFlag */])
                    return changed;
                if (isNaN(values[8 /* explicitWidth */]) || isNaN(values[9 /* explicitHeight */])) {
                    this.measure();
                    if (values[16 /* measuredWidth */] < values[12 /* minWidth */]) {
                        values[16 /* measuredWidth */] = values[12 /* minWidth */];
                    }
                    if (values[16 /* measuredWidth */] > values[13 /* maxWidth */]) {
                        values[16 /* measuredWidth */] = values[13 /* maxWidth */];
                    }
                    if (values[17 /* measuredHeight */] < values[14 /* minHeight */]) {
                        values[17 /* measuredHeight */] = values[14 /* minHeight */];
                    }
                    if (values[17 /* measuredHeight */] > values[15 /* maxHeight */]) {
                        values[17 /* measuredHeight */] = values[15 /* maxHeight */];
                    }
                }
                var preferredW = this.getPreferredUWidth();
                var preferredH = this.getPreferredUHeight();
                if (preferredW !== values[18 /* oldPreferWidth */] ||
                    preferredH !== values[19 /* oldPreferHeight */]) {
                    values[18 /* oldPreferWidth */] = preferredW;
                    values[19 /* oldPreferHeight */] = preferredH;
                    changed = true;
                }
                return changed;
            };
            /**
             * @private
             * ๆ่ฎฐ้่ฆ้ช่ฏๆพ็คบๅ่กจ
             */
            UIComponentImpl.prototype.invalidateDisplayList = function () {
                var values = this.$UIComponent;
                if (!values[26 /* invalidateDisplayListFlag */]) {
                    values[26 /* invalidateDisplayListFlag */] = true;
                    if (this.$stage)
                        validator.invalidateDisplayList(this);
                }
            };
            /**
             * @private
             * ้ช่ฏๅญ้กน็ไฝ็ฝฎๅๅคงๅฐ๏ผๅนถ็ปๅถๅถไปๅฏ่งๅๅฎน
             */
            UIComponentImpl.prototype.validateDisplayList = function () {
                var values = this.$UIComponent;
                if (values[26 /* invalidateDisplayListFlag */]) {
                    this.updateFinalSize();
                    this.updateDisplayList(values[10 /* width */], values[11 /* height */]);
                    values[26 /* invalidateDisplayListFlag */] = false;
                }
            };
            /**
             * @private
             * ๆดๆฐๆ็ป็็ปไปถๅฎฝ้ซ
             */
            UIComponentImpl.prototype.updateFinalSize = function () {
                var unscaledWidth = 0;
                var unscaledHeight = 0;
                var values = this.$UIComponent;
                if (values[27 /* layoutWidthExplicitlySet */]) {
                    unscaledWidth = values[10 /* width */];
                }
                else if (!isNaN(values[8 /* explicitWidth */])) {
                    unscaledWidth = values[8 /* explicitWidth */];
                }
                else {
                    unscaledWidth = values[16 /* measuredWidth */];
                }
                if (values[28 /* layoutHeightExplicitlySet */]) {
                    unscaledHeight = values[11 /* height */];
                }
                else if (!isNaN(values[9 /* explicitHeight */])) {
                    unscaledHeight = values[9 /* explicitHeight */];
                }
                else {
                    unscaledHeight = values[17 /* measuredHeight */];
                }
                this.setActualSize(unscaledWidth, unscaledHeight);
            };
            /**
             * @private
             * ็ซๅณๅบ็จ็ปไปถๅๅถๅญ้กน็ๆๆๅฑๆง
             */
            UIComponentImpl.prototype.validateNow = function () {
                if (this.$stage)
                    validator.validateClient(this);
            };
            /**
             * @private
             * ๆ่ฎฐ็ถ็บงๅฎนๅจ็ๅฐบๅฏธๅๆพ็คบๅ่กจไธบๅคฑๆ
             */
            UIComponentImpl.prototype.invalidateParentLayout = function () {
                var parent = this.$parent;
                if (!parent || !this.$includeInLayout || !egret.is(parent, UIComponentClass))
                    return;
                parent.invalidateSize();
                parent.invalidateDisplayList();
            };
            /**
             * @private
             * ่ฎพ็ฝฎ็ปไปถ็ๅธๅฑๅฎฝ้ซ
             */
            UIComponentImpl.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
                layoutHeight = +layoutHeight;
                layoutWidth = +layoutWidth;
                if (layoutHeight < 0 || layoutWidth < 0) {
                    return;
                }
                var values = this.$UIComponent;
                var maxWidth = values[13 /* maxWidth */];
                var maxHeight = values[15 /* maxHeight */];
                var minWidth = Math.min(values[12 /* minWidth */], maxWidth);
                var minHeight = Math.min(values[14 /* minHeight */], maxHeight);
                var width;
                var height;
                if (isNaN(layoutWidth)) {
                    values[27 /* layoutWidthExplicitlySet */] = false;
                    width = this.getPreferredUWidth();
                }
                else {
                    values[27 /* layoutWidthExplicitlySet */] = true;
                    width = Math.max(minWidth, Math.min(maxWidth, layoutWidth));
                }
                if (isNaN(layoutHeight)) {
                    values[28 /* layoutHeightExplicitlySet */] = false;
                    height = this.getPreferredUHeight();
                }
                else {
                    values[28 /* layoutHeightExplicitlySet */] = true;
                    height = Math.max(minHeight, Math.min(maxHeight, layoutHeight));
                }
                var matrix = this.getAnchorMatrix();
                if (isDeltaIdentity(matrix)) {
                    this.setActualSize(width, height);
                    return;
                }
                var fitSize = sys.MatrixUtil.fitBounds(layoutWidth, layoutHeight, matrix, values[8 /* explicitWidth */], values[9 /* explicitHeight */], this.getPreferredUWidth(), this.getPreferredUHeight(), minWidth, minHeight, maxWidth, maxHeight);
                if (!fitSize) {
                    fitSize = egret.Point.create(minWidth, minHeight);
                }
                this.setActualSize(fitSize.x, fitSize.y);
                egret.Point.release(fitSize);
            };
            /**
             * @private
             * ่ฎพ็ฝฎ็ปไปถ็ๅธๅฑไฝ็ฝฎ
             */
            UIComponentImpl.prototype.setLayoutBoundsPosition = function (x, y) {
                var matrix = this.$getMatrix();
                if (!isDeltaIdentity(matrix) || this.anchorOffsetX != 0 || this.anchorOffsetY != 0) {
                    var bounds = egret.$TempRectangle;
                    this.getLayoutBounds(bounds);
                    x += this.$getX() - bounds.x;
                    y += this.$getY() - bounds.y;
                }
                var changed = this.$super.$setX.call(this, x);
                if (this.$super.$setY.call(this, y) || changed) {
                    eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.MOVE);
                }
            };
            /**
             * @private
             * ็ปไปถ็ๅธๅฑๅฐบๅฏธ,ๅธธ็จไบ็ถ็บง็updateDisplayList()ๆนๆณไธญ
             * ๆ็ง๏ผๅธๅฑๅฐบๅฏธ>ๅค้จๆพๅผ่ฎพ็ฝฎๅฐบๅฏธ>ๆต้ๅฐบๅฏธ ็ไผๅ็บง้กบๅบ่ฟๅๅฐบๅฏธ,
             * ๆณจๆๆญคๆนๆณ่ฟๅๅผๅทฒ็ปๅๅซscaleๅrotationใ
             */
            UIComponentImpl.prototype.getLayoutBounds = function (bounds) {
                var values = this.$UIComponent;
                var w;
                if (values[27 /* layoutWidthExplicitlySet */]) {
                    w = values[10 /* width */];
                }
                else if (!isNaN(values[8 /* explicitWidth */])) {
                    w = values[8 /* explicitWidth */];
                }
                else {
                    w = values[16 /* measuredWidth */];
                }
                var h;
                if (values[28 /* layoutHeightExplicitlySet */]) {
                    h = values[11 /* height */];
                }
                else if (!isNaN(values[9 /* explicitHeight */])) {
                    h = values[9 /* explicitHeight */];
                }
                else {
                    h = values[17 /* measuredHeight */];
                }
                this.applyMatrix(bounds, w, h);
            };
            /**
             * @private
             *
             * @returns
             */
            UIComponentImpl.prototype.getPreferredUWidth = function () {
                var values = this.$UIComponent;
                return isNaN(values[8 /* explicitWidth */]) ?
                    values[16 /* measuredWidth */] : values[8 /* explicitWidth */];
            };
            /**
             * @private
             *
             * @returns
             */
            UIComponentImpl.prototype.getPreferredUHeight = function () {
                var values = this.$UIComponent;
                return isNaN(values[9 /* explicitHeight */]) ?
                    values[17 /* measuredHeight */] : values[9 /* explicitHeight */];
            };
            /**
             * @private
             * ่ทๅ็ปไปถ็้ฆ้ๅฐบๅฏธ,ๅธธ็จไบ็ถ็บง็measure()ๆนๆณไธญ
             * ๆ็ง๏ผๅค้จๆพๅผ่ฎพ็ฝฎๅฐบๅฏธ>ๆต้ๅฐบๅฏธ ็ไผๅ็บง้กบๅบ่ฟๅๅฐบๅฏธ๏ผ
             * ๆณจๆๆญคๆนๆณ่ฟๅๅผๅทฒ็ปๅๅซscaleๅrotationใ
             */
            UIComponentImpl.prototype.getPreferredBounds = function (bounds) {
                var w = this.getPreferredUWidth();
                var h = this.getPreferredUHeight();
                this.applyMatrix(bounds, w, h);
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.applyMatrix = function (bounds, w, h) {
                bounds.setTo(0, 0, w, h);
                var matrix = this.getAnchorMatrix();
                if (isDeltaIdentity(matrix)) {
                    bounds.x += matrix.tx;
                    bounds.y += matrix.ty;
                }
                else {
                    matrix.$transformBounds(bounds);
                }
            };
            /**
             * @private
             */
            UIComponentImpl.prototype.getAnchorMatrix = function () {
                var matrix = this.$getMatrix();
                var offsetX = this.anchorOffsetX;
                var offsetY = this.anchorOffsetY;
                if (offsetX != 0 || offsetY != 0) {
                    var tempM = egret.$TempMatrix;
                    matrix.$preMultiplyInto(tempM.setTo(1, 0, 0, 1, -offsetX, -offsetY), tempM);
                    return tempM;
                }
                return matrix;
            };
            return UIComponentImpl;
        }(egret.DisplayObject));
        sys.UIComponentImpl = UIComponentImpl;
        __reflect(UIComponentImpl.prototype, "eui.sys.UIComponentImpl", ["eui.UIComponent", "egret.DisplayObject"]);
        /**
         * ๆฃๆฅไธไธชๅฝๆฐ็ๆนๆณไฝๆฏๅฆไธบ็ฉบใ
         */
        function isEmptyFunction(prototype, key) {
            if (typeof prototype[key] != "function") {
                return false;
            }
            var body = prototype[key].toString();
            var index = body.indexOf("{");
            var lastIndex = body.lastIndexOf("}");
            body = body.substring(index + 1, lastIndex);
            return body.trim() == "";
        }
        /**
         * @private
         * ๆท่ดๆจกๆฟ็ฑป็ๆนๆณไฝๅๅฑๆงๅฐ็ฎๆ็ฑปไธใ
         * @param target ็ฎๆ็ฑป
         * @param template ๆจกๆฟ็ฑป
         */
        function mixin(target, template) {
            for (var property in template) {
                if (property != "prototype" && template.hasOwnProperty(property)) {
                    target[property] = template[property];
                }
            }
            var prototype = target.prototype;
            var protoBase = template.prototype;
            var keys = Object.keys(protoBase);
            var length = keys.length;
            for (var i = 0; i < length; i++) {
                var key = keys[i];
                if (key == "__meta__") {
                    continue;
                }
                if (!prototype.hasOwnProperty(key) || isEmptyFunction(prototype, key)) {
                    var value = Object.getOwnPropertyDescriptor(protoBase, key);
                    Object.defineProperty(prototype, key, value);
                }
            }
        }
        sys.mixin = mixin;
        /**
         * @private
         * ่ชๅฎไน็ฑปๅฎ็ฐUIComponent็ๆญฅ้ชค๏ผ
         * 1.ๅจ่ชๅฎไน็ฑป็ๆ้ๅฝๆฐ้่ฐ็จ๏ผthis.initializeUIValues();
         * 2.ๆท่ดUIComponentๆฅๅฃๅฎไน็ๆๆๅๅฎน(ๅๆฌๆณจ้ๆ็protectedๅฝๆฐ)ๅฐ่ชๅฎไน็ฑป๏ผๅฐๆๆๅญ็ฑป้่ฆ่ฆ็็ๆนๆณ้ฝๅฃฐๆไธบ็ฉบๆนๆณไฝใ
         * 3.ๅจๅฎไน็ฑป็ปๅฐพ็ๅค้จ่ฐ็จsys.implementUIComponent()๏ผๅนถไผๅฅ่ชๅฎไน็ฑปใ
         * 4.่ฅ่ฆ็ไบๆไธชUIComponent็ๆนๆณ๏ผ้่ฆๆๅจ่ฐ็จUIComponentImpl.prototype["ๆนๆณๅ"].call(this);
         * @param descendant ่ชๅฎไน็UIComponentๅญ็ฑป
         * @param base ่ชๅฎไนๅญ็ฑป็ปงๆฟ็็ถ็ฑป
         */
        function implementUIComponent(descendant, base, isContainer) {
            mixin(descendant, UIComponentImpl);
            var prototype = descendant.prototype;
            prototype.$super = base.prototype;
            eui.registerProperty(descendant, "left", "Percentage");
            eui.registerProperty(descendant, "right", "Percentage");
            eui.registerProperty(descendant, "top", "Percentage");
            eui.registerProperty(descendant, "bottom", "Percentage");
            eui.registerProperty(descendant, "horizontalCenter", "Percentage");
            eui.registerProperty(descendant, "verticalCenter", "Percentage");
            if (isContainer) {
                prototype.$childAdded = function (child, index) {
                    this.invalidateSize();
                    this.invalidateDisplayList();
                };
                prototype.$childRemoved = function (child, index) {
                    this.invalidateSize();
                    this.invalidateDisplayList();
                };
            }
            if (true) {
                Object.defineProperty(prototype, "preferredWidth", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getPreferredBounds(bounds);
                        return bounds.width;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "preferredHeight", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getPreferredBounds(bounds);
                        return bounds.height;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "preferredX", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getPreferredBounds(bounds);
                        return bounds.x;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "preferredY", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getPreferredBounds(bounds);
                        return bounds.y;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutBoundsX", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getLayoutBounds(bounds);
                        return bounds.x;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutBoundsY", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getLayoutBounds(bounds);
                        return bounds.y;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutBoundsWidth", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getLayoutBounds(bounds);
                        return bounds.width;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutBoundsHeight", {
                    get: function () {
                        var bounds = egret.$TempRectangle;
                        this.getLayoutBounds(bounds);
                        return bounds.height;
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "measuredWidth", {
                    get: function () {
                        return this.$UIComponent[16 /* measuredWidth */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "measuredHeight", {
                    get: function () {
                        return this.$UIComponent[17 /* measuredHeight */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutWidthExplicitlySet", {
                    get: function () {
                        return this.$UIComponent[27 /* layoutWidthExplicitlySet */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "layoutHeightExplicitlySet", {
                    get: function () {
                        return this.$UIComponent[28 /* layoutHeightExplicitlySet */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "invalidatePropertiesFlag", {
                    get: function () {
                        return this.$UIComponent[24 /* invalidatePropertiesFlag */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "invalidateSizeFlag", {
                    get: function () {
                        return this.$UIComponent[25 /* invalidateSizeFlag */];
                    },
                    enumerable: true,
                    configurable: true
                });
                Object.defineProperty(prototype, "invalidateDisplayListFlag", {
                    get: function () {
                        return this.$UIComponent[26 /* invalidateDisplayListFlag */];
                    },
                    enumerable: true,
                    configurable: true
                });
            }
        }
        sys.implementUIComponent = implementUIComponent;
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../states/State.ts" />
/// <reference path="../core/UIComponent.ts" />
/// <reference path="../utils/registerProperty.ts" />
var eui;
(function (eui) {
    /**
     * The Group class is defines the base class for layout component.
     * If the contents of the sub items are too large to scroll to show, you can wrap a Scroller component outside the
     * group (Give the instance of Group to <code>viewport</code> property of Scroller component).
     * The scroller component can adds a scrolling touch operation for the Group.
     *
     * @see http://edn.egret.com/cn/article/index/id/608 Simple container
     * @defaultProperty elementsContent
     * @includeExample  extension/eui/components/GroupExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Group ๆฏ่ชๅจๅธๅฑ็ๅฎนๅจๅบ็ฑปใๅฆๆๅๅซ็ๅญ้กนๅๅฎนๅคชๅคง้่ฆๆปๅจๆพ็คบ๏ผๅฏไปฅๅจๅจ Group ๅค้จๅ่ฃนไธๅฑ Scroller ็ปไปถ
     * (ๅฐ Group ๅฎไพ่ตๅผ็ป Scroller ็ปไปถ็ viewport ๅฑๆง)ใScroller ไผไธบ Group ๆทปๅๆปๅจ็่งฆๆธๆไฝๅ่ฝ๏ผๅนถๆพ็คบๅ็ดๆๆฐดๅนณ็ๆปๅจๆกใ
     *
     * @see http://edn.egret.com/cn/article/index/id/608 ็ฎๅๅฎนๅจ
     * @defaultProperty elementsContent
     * @includeExample  extension/eui/components/GroupExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var Group = (function (_super) {
        __extends(Group, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Group() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$layout = null;
            /**
             * @private
             */
            _this.$stateValues = new eui.sys.StateValues();
            _this.initializeUIValues();
            _this.$Group = {
                0: 0,
                1: 0,
                2: 0,
                3: 0,
                4: false,
                5: false,
            };
            _this.$stateValues.parent = _this;
            return _this;
        }
        Object.defineProperty(Group.prototype, "elementsContent", {
            /**
             * This property is Usually invoked in resolving an EXML for adding multiple children quickly.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญคๅฑๆง้ๅธธๅจ EXML ็่งฃๆๅจไธญ่ฐ็จ๏ผไพฟไบๅฟซ้ๆทปๅๅคไธชๅญ้กนใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (value) {
                if (value) {
                    var length_6 = value.length;
                    for (var i = 0; i < length_6; i++) {
                        this.addChild(value[i]);
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Group.prototype, "layout", {
            /**
             * The layout object for this container.
             * This object is responsible for the measurement and layout of
             * the UIcomponent in the container.
             *
             * @default eui.BasicLayout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญคๅฎนๅจ็ๅธๅฑๅฏน่ฑกใ
             *
             * s@default eui.BasicLayout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$layout;
            },
            set: function (value) {
                this.$setLayout(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        Group.prototype.$setLayout = function (value) {
            if (this.$layout == value)
                return false;
            if (this.$layout) {
                this.$layout.target = null;
            }
            this.$layout = value;
            if (value) {
                value.target = this;
            }
            this.invalidateSize();
            this.invalidateDisplayList();
            return true;
        };
        Object.defineProperty(Group.prototype, "contentWidth", {
            /**
             * @copy eui.IViewport#contentWidth
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$Group[0 /* contentWidth */];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Group.prototype, "contentHeight", {
            /**
             * @copy eui.IViewport#contentHeight
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$Group[1 /* contentHeight */];
            },
            enumerable: true,
            configurable: true
        });
        /**
         *
         * Sets the <code>contentWidth</code> and <code>contentHeight</code>
         * properties.
         *
         * This method is intended for layout class developers who should
         * call it from <code>updateDisplayList()</code> methods.
         *
         * @param width The new value of <code>contentWidth</code>.
         * @param height The new value of <code>contentHeight</code>.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         *
         * ่ฎพ็ฝฎ <code>contentWidth</code> ๅ <code>contentHeight</code> ๅฑๆงใ
         * ๆญคๆนๆณ็ฑๅธๅฑๆฅ่ฐ็จ๏ผๅผๅ่ๅบ่ฏฅๅจๅธๅฑ็ฑป็ <code>updateDisplayList()</code> ๆนๆณไธญๅฏนๅถ่ฟ่ก่ฐ็จใ
         *
         * @param width <code>contentWidth</code> ็ๆฐๅผใ
         * @param height <code>contentHeight</code> ็ๆฐๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Group.prototype.setContentSize = function (width, height) {
            width = Math.ceil(+width || 0);
            height = Math.ceil(+height || 0);
            var values = this.$Group;
            var wChange = (values[0 /* contentWidth */] !== width);
            var hChange = (values[1 /* contentHeight */] !== height);
            if (!wChange && !hChange) {
                return;
            }
            values[0 /* contentWidth */] = width;
            values[1 /* contentHeight */] = height;
            if (wChange) {
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "contentWidth");
            }
            if (hChange) {
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "contentHeight");
            }
        };
        Object.defineProperty(Group.prototype, "scrollEnabled", {
            /**
             * @copy eui.IViewport#scrollEnabled
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$Group[4 /* scrollEnabled */];
            },
            set: function (value) {
                value = !!value;
                var values = this.$Group;
                if (value === values[4 /* scrollEnabled */])
                    return;
                values[4 /* scrollEnabled */] = value;
                this.updateScrollRect();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Group.prototype, "scrollH", {
            /**
             * @copy eui.IViewport#scrollH
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$Group[2 /* scrollH */];
            },
            set: function (value) {
                value = +value || 0;
                var values = this.$Group;
                if (value === values[2 /* scrollH */])
                    return;
                values[2 /* scrollH */] = value;
                if (this.updateScrollRect() && this.$layout) {
                    this.$layout.scrollPositionChanged();
                }
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "scrollH");
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Group.prototype, "scrollV", {
            /**
             * @copy eui.IViewport#scrollV
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$Group[3 /* scrollV */];
            },
            set: function (value) {
                value = +value || 0;
                var values = this.$Group;
                if (value == values[3 /* scrollV */])
                    return;
                values[3 /* scrollV */] = value;
                if (this.updateScrollRect() && this.$layout) {
                    this.$layout.scrollPositionChanged();
                }
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "scrollV");
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        Group.prototype.updateScrollRect = function () {
            var values = this.$Group;
            var hasClip = values[4 /* scrollEnabled */];
            if (hasClip) {
                var uiValues = this.$UIComponent;
                this.scrollRect = egret.$TempRectangle.setTo(values[2 /* scrollH */], values[3 /* scrollV */], uiValues[10 /* width */], uiValues[11 /* height */]);
            }
            else if (this.$scrollRect) {
                this.scrollRect = null;
            }
            return hasClip;
        };
        Object.defineProperty(Group.prototype, "numElements", {
            /**
             * The number of layout element in this container.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅธๅฑๅ็ดๅญ้กน็ๆฐ้ใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$children.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Returns the layout element at the specified index.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅไธไธชๅธๅฑๅ็ดๅญ้กนใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Group.prototype.getElementAt = function (index) {
            return this.$children[index];
        };
        Group.prototype.getVirtualElementAt = function (index) {
            return this.getElementAt(index);
        };
        /**
         * Set the index range of the sub Visual element in container which support virtual layout.
         * This method is invalid in container which do not support virtual layout.
         * This method is usually invoked before layout. Override this method to release the invisible elements.
         *
         * @param startIndex the start index of sub visual elements๏ผinclude๏ผ
         * @param endIndex the end index of sub visual elements๏ผinclude๏ผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๆฏๆ่ๆๅธๅฑ็ๅฎนๅจไธญ๏ผ่ฎพ็ฝฎๅฎนๅจๅๅฏ่ง็ๅญๅ็ด็ดขๅผ่ๅดใๆญคๆนๆณๅจไธๆฏๆ่ๆๅธๅฑ็ๅฎนๅจไธญๆๆใ
         * ้ๅธธๅจๅณๅฐ้ๆฐๅธๅฑๅญ้กนไนๅไผ่ขซ่ฐ็จไธๆฌก๏ผๅฎนๅจ่ฆ็ๆญคๆนๆณๆๅ้ๆพๅทฒ็ปไธๅฏ่ง็ๅญๅ็ดใ
         *
         * @param startIndex ๅฏ่งๅ็ด่ตทๅง็ดขๅผ๏ผๅๆฌ๏ผ
         * @param endIndex ๅฏ่งๅ็ด็ปๆ็ดขๅผ๏ผๅๆฌ๏ผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Group.prototype.setVirtualElementIndicesInView = function (startIndex, endIndex) {
        };
        Object.defineProperty(Group.prototype, "touchThrough", {
            /**
             * When <code>true</code>, this property
             * ensures that the entire bounds of the Group respond to
             * touch events such as begin.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งฆๆธ็ปไปถ็่ๆฏ้ๆๅบๅๆฏๅฆๅฏไปฅ็ฉฟ้ใ่ฎพ็ฝฎไธบtrue่กจ็คบๅฏไปฅ็ฉฟ้๏ผๅไน้ๆๅบๅไนไผๅๅบ่งฆๆธไบไปถใ้ป่ฎค falseใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Group[5 /* touchThrough */];
            },
            set: function (value) {
                this.$Group[5 /* touchThrough */] = !!value;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Group.prototype.$hitTest = function (stageX, stageY) {
            var target = _super.prototype.$hitTest.call(this, stageX, stageY);
            if (target || this.$Group[5 /* touchThrough */]) {
                return target;
            }
            if (!this.$visible || !this.touchEnabled) {
                return null;
            }
            var point = this.globalToLocal(stageX, stageY, egret.$TempPoint);
            var values = this.$UIComponent;
            var bounds = egret.$TempRectangle.setTo(0, 0, values[10 /* width */], values[11 /* height */]);
            var scrollRect = this.$scrollRect;
            if (scrollRect) {
                bounds.x = scrollRect.x;
                bounds.y = scrollRect.y;
            }
            if (bounds.contains(point.x, point.y)) {
                return this;
            }
            return null;
        };
        /**
         * @copy eui.Component#invalidateState()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.invalidateState = function () {
            var values = this.$stateValues;
            if (values.stateIsDirty) {
                return;
            }
            values.stateIsDirty = true;
            this.invalidateProperties();
        };
        /**
         * @copy eui.Component#getCurrentState()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.getCurrentState = function () {
            return "";
        };
        /**
         * @copy eui.Component#createChildren()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.createChildren = function () {
            if (!this.$layout) {
                this.$setLayout(new eui.BasicLayout());
            }
            this.initializeStates(this.$stage);
        };
        /**
         * @copy eui.Component#childrenCreated()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.childrenCreated = function () {
        };
        /**
         * @copy eui.Component#commitProperties()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.commitProperties = function () {
            eui.sys.UIComponentImpl.prototype["commitProperties"].call(this);
            var values = this.$stateValues;
            if (values.stateIsDirty) {
                values.stateIsDirty = false;
                if (!values.explicitState) {
                    values.currentState = this.getCurrentState();
                    this.commitCurrentState();
                }
            }
        };
        /**
         * @copy eui.Component#measure()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.measure = function () {
            if (!this.$layout) {
                this.setMeasuredSize(0, 0);
                return;
            }
            this.$layout.measure();
        };
        /**
         * @copy eui.Component#updateDisplayList()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            if (this.$layout) {
                this.$layout.updateDisplayList(unscaledWidth, unscaledHeight);
            }
            this.updateScrollRect();
        };
        /**
         * @copy eui.Component#invalidateParentLayout()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Group.prototype.getPreferredBounds = function (bounds) {
        };
        return Group;
    }(egret.DisplayObjectContainer));
    eui.Group = Group;
    __reflect(Group.prototype, "eui.Group", ["eui.IViewport", "eui.UIComponent", "egret.DisplayObject"]);
    eui.sys.implementUIComponent(Group, egret.DisplayObjectContainer, true);
    eui.sys.mixin(Group, eui.sys.StateClient);
    eui.registerProperty(Group, "elementsContent", "Array", true);
    eui.registerProperty(Group, "states", "State[]");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var key = "__bindables__";
    /**
     * Register a property of an instance is can be bound.
     * This method is ususally invoked by Watcher class.
     *
     * @param instance the instance to be registered.
     * @param property the property of specified instance to be registered.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆ่ฎฐๅฎไพ็ไธไธชๅฑๆงๆฏๅฏ็ปๅฎ็,ๆญคๆนๆณ้ๅธธ็ฑ Watcher ็ฑป่ฐ็จใ
     *
     * @param instance ่ฆๆ่ฎฐ็ๅฎไพ
     * @param property ๅฏ็ปๅฎ็ๅฑๆงใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    function registerBindable(instance, property) {
        if (true) {
            if (!instance) {
                egret.$error(1003, "instance");
            }
            if (!property) {
                egret.$error(1003, "property");
            }
        }
        if (instance.hasOwnProperty(key)) {
            instance[key].push(property);
        }
        else {
            var list = [property];
            if (instance[key]) {
                list = instance[key].concat(list);
            }
            instance[key] = list;
        }
    }
    eui.registerBindable = registerBindable;
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../core/UIComponent.ts" />
/// <reference path="../utils/registerProperty.ts" />
var eui;
(function (eui) {
    /**
     * The Component class defines the base class for skinnable components.
     * The skins used by a Component class are typically child classes of
     * the Skin class.<p/>
     *
     * Associate a skin class with a component class by setting the <code>skinName</code> property of the
     * component class.
     * @event egret.Event.COMPLETE Dispatch when <code>skinName</code> property is set the path of external EXML file and the EXML file is resolved.
     *
     * @includeExample  extension/eui/components/ComponentExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Component ็ฑปๅฎไนๅฏ่ฎพ็ฝฎๅค่ง็็ปไปถ็ๅบ็ฑปใComponent ็ฑปๆไฝฟ็จ็ๅค่ง้ๅธธๆฏ Skin ็ฑป็ๅญ็ฑปใ<p/>
     * ้่ฟ่ฎพ็ฝฎ component ็ฑป็ skinName ๅฑๆง๏ผๅฐ skin ็ฑปไธ component ็ฑป็ธๅณ่ใ
     * @event egret.Event.COMPLETE ๅฝ่ฎพ็ฝฎskinNameไธบๅค้จexmlๆไปถ่ทฏๅพๆถ๏ผๅ่ฝฝๅนถๅฎๆEXML่งฃๆๅ่ฐๅบฆใ
     *
     * @includeExample  extension/eui/components/ComponentExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var Component = (function (_super) {
        __extends(Component, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Component() {
            var _this = _super.call(this) || this;
            _this.initializeUIValues();
            _this.$Component = {
                0: null,
                1: null,
                2: "",
                3: true,
                4: false,
                5: false,
                6: true,
                7: true,
                8: null //skin
            };
            //if egret
            _this.$touchEnabled = true;
            return _this;
            //endif*/
        }
        Object.defineProperty(Component.prototype, "hostComponentKey", {
            /**
             * A identifier of host component which can determine only one component names.
             * Usually used for quering a default skin name in theme.
             * @default null
             * @see eui.Theme#getSkinName()
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธปๆบ็ปไปถๆ่ฏ็ฌฆใ็จไบๅฏไธ็กฎๅฎไธไธช็ปไปถ็ๅ็งฐใ้ๅธธ็จไบๅจไธป้ขไธญๆฅ่ฏข้ป่ฎค็ฎ่คๅใ
             *
             * @default null
             * @see eui.Theme#getSkinName()
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Component[0 /* hostComponentKey */];
            },
            set: function (value) {
                this.$Component[0 /* hostComponentKey */] = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Component.prototype, "skinName", {
            /**
             * Identifier of skin. Valid values: class definition of skin,
             * class name of skin, instance of skin, EXML or external EXML file path.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่คๆ่ฏ็ฌฆใๆๆๅผๅฏไธบ๏ผ็ฎ่ค็ฑปๅฎไน,็ฎ่ค็ฑปๅ,็ฎ่คๅฎไพ,EXMLๆไปถๅๅฎน,ๆๅค้จEXMLๆไปถ่ทฏๅพ๏ผ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Component[1 /* skinName */];
            },
            set: function (value) {
                var values = this.$Component;
                values[5 /* skinNameExplicitlySet */] = true;
                if (values[1 /* skinName */] == value)
                    return;
                if (value) {
                    values[1 /* skinName */] = value;
                }
                else {
                    var theme = egret.getImplementation("eui.Theme");
                    if (theme) {
                        var skinName = theme.getSkinName(this);
                        if (skinName) {
                            values[1 /* skinName */] = skinName;
                        }
                    }
                }
                this.$parseSkinName();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่งฃๆskinName
         */
        Component.prototype.$parseSkinName = function () {
            var skinName = this.skinName;
            var skin;
            if (skinName) {
                if (skinName.prototype) {
                    skin = new skinName();
                }
                else if (typeof (skinName) == "string") {
                    var clazz = void 0;
                    var text = skinName.trim();
                    if (text.charAt(0) == "<") {
                        clazz = EXML.parse(text);
                    }
                    else {
                        clazz = egret.getDefinitionByName(skinName);
                        if (!clazz && text.toLowerCase().indexOf(".exml") != -1) {
                            EXML.load(skinName, this.onExmlLoaded, this, true);
                            return;
                        }
                    }
                    if (clazz) {
                        skin = new clazz();
                    }
                }
                else {
                    skin = skinName;
                }
            }
            this.setSkin(skin);
        };
        /**
         * @private
         * @param clazz
         * @param url
         */
        Component.prototype.onExmlLoaded = function (clazz, url) {
            if (this.skinName != url) {
                return;
            }
            var skin = new clazz();
            this.setSkin(skin);
        };
        Object.defineProperty(Component.prototype, "skin", {
            /**
             * The instance of the skin class for this component instance.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่คๅฏน่ฑกๅฎไพใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Component[8 /* skin */];
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Setter for the skin instance.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎ็ฎ่คๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.setSkin = function (skin) {
            if (skin && !(skin instanceof eui.Skin)) {
                skin = null;
                true && egret.$error(2202);
            }
            var values = this.$Component;
            var oldSkin = values[8 /* skin */];
            if (oldSkin) {
                var skinParts = oldSkin.skinParts;
                var length_7 = skinParts.length;
                for (var i = 0; i < length_7; i++) {
                    var partName = skinParts[i];
                    if (this[partName]) {
                        this.setSkinPart(partName, null);
                    }
                }
                var children = oldSkin.$elementsContent;
                if (children) {
                    length_7 = children.length;
                    for (var i = 0; i < length_7; i++) {
                        var child = children[i];
                        if (child.$parent == this) {
                            this.removeChild(child);
                        }
                    }
                }
                oldSkin.hostComponent = null;
            }
            values[8 /* skin */] = skin;
            if (skin) {
                var skinParts = skin.skinParts;
                var length_8 = skinParts.length;
                for (var i = 0; i < length_8; i++) {
                    var partName = skinParts[i];
                    var instance = skin[partName];
                    if (instance) {
                        this.setSkinPart(partName, instance);
                    }
                }
                var children = skin.$elementsContent;
                if (children) {
                    for (var i = children.length - 1; i >= 0; i--) {
                        this.addChildAt(children[i], 0);
                    }
                }
                skin.hostComponent = this;
            }
            this.invalidateSize();
            this.invalidateDisplayList();
            this.dispatchEventWith(egret.Event.COMPLETE);
        };
        /**
         * Find the skin parts in the skin class and assign them to the properties of the component.
         * You do not call this method directly. This method will be invoked automatically when using a EXML as skin.
         * The ID for a tag in an EXML will be passed in as <code>partName</code>, and the instance of the tag will be
         * passed in as <code>instance</code>.
         * @param partName name of a skin part
         * @param instance instance of a skin part
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅณ่ไธไธชๅฏน่ฑกๅฐ้ป่พ็ปไปถ็ๆๅฎ็ฎ่ค้จไปถไธใ้ๅธธๆจไธ้่ฆๆๅจ่ฐ็จๆญคๆนๆณ๏ผๅฝไฝฟ็จEXMLๆไปถไฝไธบ็ปไปถ็ฎ่ค๏ผๆญคๆนๆณๅฐไผ่ขซ่ชๅจ่ฐ็จใ
         * ๅจ่ฟ่กๆถ๏ผEXMLๆไปถๅๅฃฐๆ็idๅ็งฐๅฐไฝไธบๆญคๆนๆณ็partNameๅๆฐ๏ผ่idๆๅฏนๅบ็่็นๅฏน่ฑก๏ผๅฐไฝไธบๆญคๆนๆณ็instanceๅๆฐ่ขซไพๆฌกไผๅฅใ
         * @param partName ็ฎ่ค้จไปถๅ็งฐ
         * @param instance ็ฎ่ค้จไปถๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.setSkinPart = function (partName, instance) {
            var oldInstance = this[partName];
            if (oldInstance) {
                this.partRemoved(partName, oldInstance);
            }
            this[partName] = instance;
            if (instance) {
                this.partAdded(partName, instance);
            }
        };
        /**
         * Called when a skin part is added.
         * You do not call this method directly.
         * EUI calls it automatically when it calls the <code>setSkinPart()</code> method.<p/>
         *
         * Override this function to attach behavior to the part, such as add event listener or
         * assign property values cached.
         * @param partName name of a skin part to add.
         * @param instance instance of a skin part to add.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆทปๅ็ฎ่ค้จไปถๆถ่ฐ็จใ
         * ๆจๆ้็ดๆฅ่ฐ็จๆญคๆนๆณใ
         * EUI ไผๅจ่ฐ็จ setSkinPart()ๆนๆณๆถ่ชๅจ่ฐ็จๆญคๆนๆณใ<p/>
         *
         * ๅญ็ฑป่ฆ็ๆญคๆนๆณ๏ผไปฅๅจ็ฎ่ค้จไปถ็ฌฌไธๆฌก้ๅๆถๅฏนๅถๆง่กไธไบๅๅงๅๆไฝ๏ผไพๅฆๆทปๅไบไปถ็ๅฌ๏ผ่ตๅผ็ผๅญ็ๅฑๆงๅผ็ญใ
         * @param partName ่ฆ้ๅ็็ฎ่ค้จไปถๅ็งฐใ
         * @param instance ่ฆ้ๅ็็ฎ่ค้จไปถๅฎไพใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.partAdded = function (partName, instance) {
        };
        /**
         * Called when an instance of a skin part is being removed.
         * You do not call this method directly.
         * EUI calls it automatically when it calls the <code>setSkinPart()</code> method.<p/>
         *
         * Override this function to clean behavior of the part, such as remove event listener or
         * disconnect the cache reference
         * @param partName name of a skin part to remove.
         * @param instance instance of a skin part to remove.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆญฃๅ้คๅค่ง้จไปถ็ๅฎไพๆถ่ฐ็จใ
         * ๆจๆ้็ดๆฅ่ฐ็จๆญคๆนๆณใ
         * EUI ไผๅจ่ฐ็จ setSkinPart()ๆนๆณๆถ่ชๅจ่ฐ็จๆญคๆนๆณใ<p/>
         *
         * ๅญ็ฑป่ฆ็ๆญคๆนๆณ๏ผไปฅๅจ็ฎ่ค้จไปถไป้ป่พ็ปไปถๅธ่ฝฝๆถๅฏนๅถๆง่กไธไบๆธ็ๆไฝ๏ผไพๅฆ็งป้คไบไปถ็ๅฌ๏ผๆญๅผ็ผๅญ็ๅผ็จ็ญใ
         * @param partName ่ฆๅธ่ฝฝ็็ฎ่ค้จไปถๅ็งฐ
         * @param instance ่ฆๅธ่ฝฝ็็ฎ่ค้จไปถๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.partRemoved = function (partName, instance) {
        };
        /**
         * @private
         *
         * @param value
         */
        Component.prototype.$setTouchChildren = function (value) {
            value = !!value;
            var values = this.$Component;
            values[6 /* explicitTouchChildren */] = value;
            if (values[3 /* enabled */]) {
                values[6 /* explicitTouchChildren */] = value;
                return _super.prototype.$setTouchChildren.call(this, value);
            }
            else {
                return true;
            }
        };
        /**
         * @private
         *
         * @param value
         */
        Component.prototype.$setTouchEnabled = function (value) {
            value = !!value;
            var values = this.$Component;
            values[7 /* explicitTouchEnabled */] = value;
            if (values[3 /* enabled */]) {
                return _super.prototype.$setTouchEnabled.call(this, value);
            }
            else {
                return true;
            }
        };
        Object.defineProperty(Component.prototype, "enabled", {
            /**
             * Whether the component can accept user interaction.
             * After setting the <code>enabled</code> property to <code>false</code>, components will disabled touch event
             * (set <code>touchEnabled</code> and <code>touchChildren</code> to false) and set state of skin to "disabled".
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ปไปถๆฏๅฆๅฏไปฅๆฅๅ็จๆทไบคไบใ
             * ๅฐ enabled ๅฑๆง่ฎพ็ฝฎไธบ false ๅ๏ผ
             * ็ปไปถไผ่ชๅจ็ฆ็จ่งฆๆธไบไปถ(ๅฐ touchEnabled ๅ touchChildren ๅๆถ่ฎพ็ฝฎไธบ false)๏ผ
             * ้จๅ็ปไปถๅฏ่ฝ่ฟไผๅฐ็ฎ่ค็่งๅพ็ถๆ่ฎพ็ฝฎไธบ"disabled",ไฝฟๅถๆๆๅญ้กน็้ข่ฒๅๆใ
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Component[3 /* enabled */];
            },
            set: function (value) {
                value = !!value;
                this.$setEnabled(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        Component.prototype.$setEnabled = function (value) {
            var values = this.$Component;
            if (value === values[3 /* enabled */]) {
                return false;
            }
            values[3 /* enabled */] = value;
            if (value) {
                this.$touchEnabled = values[7 /* explicitTouchEnabled */];
                this.$touchChildren = values[6 /* explicitTouchChildren */];
            }
            else {
                this.$touchEnabled = false;
                this.$touchChildren = false;
            }
            this.invalidateState();
            return true;
        };
        Object.defineProperty(Component.prototype, "currentState", {
            //========================็ฎ่ค่งๅพ็ถๆ=====================start=======================
            /**
             * The current view state of the component. When you use this property to set a component's state,
             * EUI will explicit update state of skin and ignore the return of <code>getCurrentState()</code>.
             *
             * Set to <code>""</code> or <code>null</code> to reset the component back to its base state.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ปไปถ็ๅฝๅ่งๅพ็ถๆใๆพๅผ่ฎพ็ฝฎๆญคๅฑๆง๏ผ
             * ๅฐ้็จๆพๅผ่ฎพ็ฝฎ็ๅผๅปๆดๆฐ็ฎ่ค็ถๆ๏ผ่ๅฟฝ็ฅ็ปไปถๅ้จ getCurrentState() ๆนๆณ่ฟๅ็ๅผใ
             *
             * ๅฐๅถ่ฎพ็ฝฎไธบ "" ๆ null ๅฏๅฐๅๆถ็ปไปถๅค้จๆพๅผ่ฎพ็ฝฎ็่งๅพ็ถๆๅ็งฐ๏ผไป่้็จๅ้จ getCurrentState() ๆนๆณ่ฟๅ็็ถๆใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var values = this.$Component;
                return values[2 /* explicitState */] ?
                    values[2 /* explicitState */] : this.getCurrentState();
            },
            set: function (value) {
                var values = this.$Component;
                if (value == values[2 /* explicitState */]) {
                    return;
                }
                values[2 /* explicitState */] = value;
                this.invalidateState();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Marks the component so that the new state of the skin is set during a later screen update.
         * A subclass of SkinnableComponent must override <code>getCurrentState()</code> to return a value.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ่ฎฐ็ปไปถๅฝๅ็่งๅพ็ถๆๅคฑๆ๏ผ่ฐ็จๆญคๆนๆณๅ๏ผๅญ็ฑปๅบ่ฏฅ่ฆ็ <code>getCurrentState()</code> ๆนๆณๆฅ่ฟๅๅฝๅ็่งๅพ็ถๆๅ็งฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.invalidateState = function () {
            var values = this.$Component;
            if (values[4 /* stateIsDirty */])
                return;
            values[4 /* stateIsDirty */] = true;
            this.invalidateProperties();
        };
        /**
         * Returns the name of the state to be applied to the skin.<p/>
         * A subclass of SkinnableComponent must override this method to return a value.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅ็ปไปถๅฝๅ็็ฎ่ค็ถๆๅ็งฐ,ๅญ็ฑป่ฆ็ๆญคๆนๆณๅฎไนๅ็ง็ถๆๅ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.getCurrentState = function () {
            return "";
        };
        /**
         * Create child objects of the component. This is an advanced method that you might override
         * when creating a subclass of Component. This method will be called once it be added to stage.
         * You must invoke <code>super.createChildren()</code> to complete initialization of the parent class
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅญ็ฑป่ฆ็ๆญคๆนๆณๅฏไปฅๆง่กไธไบๅๅงๅๅญ้กนๆไฝใๆญคๆนๆณไปๅจ็ปไปถ็ฌฌไธๆฌกๆทปๅๅฐ่ๅฐๆถๅ่ฐไธๆฌกใ
         * ่ฏทๅกๅฟ่ฐ็จsuper.createChildren()ไปฅๅฎๆ็ถ็ฑป็ปไปถ็ๅๅงๅ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.createChildren = function () {
            var values = this.$Component;
            if (!values[1 /* skinName */]) {
                var theme = egret.getImplementation("eui.Theme");
                if (theme) {
                    var skinName = theme.getSkinName(this);
                    if (skinName) {
                        values[1 /* skinName */] = skinName;
                        this.$parseSkinName();
                    }
                }
            }
        };
        /**
         * Performs any final processing after child objects are created.
         * This is an advanced method that you might override
         * when creating a subclass of Component.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบๅญๅฏน่ฑกๅๆง่กไปปไฝๆ็ปๅค็ใๆญคๆนๆณๅจๅๅปบ Component ็ๅญ็ฑปๆถ่ฆ็ใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.childrenCreated = function () {
        };
        /**
         * Processes the properties set on the component.
         * You can override this method when creating a subclass of Component.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆไบคๅฑๆง๏ผๅญ็ฑปๅจ่ฐ็จๅฎinvalidateProperties()ๆนๆณๅ๏ผๅบ่ฆ็ๆญคๆนๆณไปฅๅบ็จๅฑๆง
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.commitProperties = function () {
            eui.sys.UIComponentImpl.prototype["commitProperties"].call(this);
            var values = this.$Component;
            if (values[4 /* stateIsDirty */]) {
                values[4 /* stateIsDirty */] = false;
                if (values[8 /* skin */]) {
                    values[8 /* skin */].currentState = this.currentState;
                }
            }
        };
        /**
         * Calculates the default size.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆต้็ปไปถๅฐบๅฏธ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.measure = function () {
            eui.sys.measure(this);
            var skin = this.$Component[8 /* skin */];
            if (!skin) {
                return;
            }
            var values = this.$UIComponent;
            if (!isNaN(skin.width)) {
                values[16 /* measuredWidth */] = skin.width;
            }
            else {
                if (values[16 /* measuredWidth */] < skin.minWidth) {
                    values[16 /* measuredWidth */] = skin.minWidth;
                }
                if (values[16 /* measuredWidth */] > skin.maxWidth) {
                    values[16 /* measuredWidth */] = skin.maxWidth;
                }
            }
            if (!isNaN(skin.height)) {
                values[17 /* measuredHeight */] = skin.height;
            }
            else {
                if (values[17 /* measuredHeight */] < skin.minHeight) {
                    values[17 /* measuredHeight */] = skin.minHeight;
                }
                if (values[17 /* measuredHeight */] > skin.maxHeight) {
                    values[17 /* measuredHeight */] = skin.maxHeight;
                }
            }
        };
        /**
         * Draws the object and/or sizes and positions its children.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆฐๆพ็คบๅ่กจ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            eui.sys.updateDisplayList(this, unscaledWidth, unscaledHeight);
        };
        /**
         * Method to invalidate parent size and display list if
         * this object affects its layout (includeInLayout is true).
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆญคๅฏน่ฑกๅฝฑๅๅถๅธๅฑๆถ๏ผincludeInLayout ไธบ true๏ผ๏ผไฝฟ็ถไปฃๅคงๅฐๅๆพ็คบๅ่กจๅคฑๆ็ๆนๆณใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Component.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Component.prototype.getPreferredBounds = function (bounds) {
        };
        return Component;
    }(egret.DisplayObjectContainer));
    eui.Component = Component;
    __reflect(Component.prototype, "eui.Component", ["eui.UIComponent", "egret.DisplayObject"]);
    eui.registerProperty(Component, "skinName", "Class");
    eui.sys.implementUIComponent(Component, egret.DisplayObjectContainer, true);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The DataGroup class is the base container class for data items.
     * The DataGroup class converts data items to visual elements for display.
     * While this container can hold visual elements, it is often used only
     * to hold data items as children.
     *
     * @see eui.Group
     * @see http://edn.egret.com/cn/article/index/id/527 Data container
     * @see http://edn.egret.com/cn/article/index/id/528 Array collection
     * @defaultProperty dataProvider
     * @includeExample  extension/eui/components/DataGroupExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * DataGroup ็ฑปๅฐๆฐๆฎ้กน็ฎ่ฝฌๆขไธบๅฏ่งๅ็ดไปฅ่ฟ่กๆพ็คบใ
     * ๅฐฝ็ฎกๆญคๅฎนๅจๅฏไปฅๅๅซๅฏ่งๅ็ด๏ผไฝๅฎ้ๅธธไป็จไบๅๅซไฝไธบๅญ้กน็ๆฐๆฎ้กน็ฎใ
     *
     * @see eui.Group
     * @see http://edn.egret.com/cn/article/index/id/527 ๆฐๆฎๅฎนๅจ
     * @see http://edn.egret.com/cn/article/index/id/528 ๆฐ็ป้ๅ
     * @defaultProperty dataProvider
     * @includeExample  extension/eui/components/DataGroupExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var DataGroup = (function (_super) {
        __extends(DataGroup, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function DataGroup() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$dataProviderChanged = false;
            /**
             * @private
             */
            _this.$dataProvider = null;
            /**
             * @private
             * ็ดขๅผๅฐ้กนๅ็คบๅจ็่ฝฌๆขๆฐ็ป
             */
            _this.$indexToRenderer = [];
            _this.$DataGroup = {
                0: true,
                1: false,
                2: {},
                3: {},
                4: false,
                5: false,
                6: null,
                7: null,
                8: false,
                9: null,
                10: false,
                11: false,
                12: null,
                13: null,
                14: false,
            };
            return _this;
        }
        Object.defineProperty(DataGroup.prototype, "useVirtualLayout", {
            /**
             * @copy eui.LayoutBase#useVirtualLayout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this.$layout ? this.$layout.$useVirtualLayout :
                    this.$DataGroup[0 /* useVirtualLayout */];
            },
            set: function (value) {
                value = !!value;
                var values = this.$DataGroup;
                if (value === values[0 /* useVirtualLayout */])
                    return;
                values[0 /* useVirtualLayout */] = value;
                if (this.$layout)
                    this.$layout.useVirtualLayout = value;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DataGroup.prototype.$setLayout = function (value) {
            if (value == this.$layout)
                return false;
            if (this.$layout) {
                this.$layout.setTypicalSize(0, 0);
                this.$layout.removeEventListener("useVirtualLayoutChanged", this.onUseVirtualLayoutChanged, this);
            }
            if (this.$layout && value && (this.$layout.$useVirtualLayout != value.$useVirtualLayout))
                this.onUseVirtualLayoutChanged();
            var result = _super.prototype.$setLayout.call(this, value);
            if (value) {
                var rect = this.$DataGroup[9 /* typicalLayoutRect */];
                if (rect) {
                    value.setTypicalSize(rect.width, rect.height);
                }
                value.useVirtualLayout = this.$DataGroup[0 /* useVirtualLayout */];
                value.addEventListener("useVirtualLayoutChanged", this.onUseVirtualLayoutChanged, this);
            }
            return result;
        };
        /**
         * @private
         * ๆฏๅฆไฝฟ็จ่ๆๅธๅฑๆ่ฎฐๆนๅ
         */
        DataGroup.prototype.onUseVirtualLayoutChanged = function (event) {
            var values = this.$DataGroup;
            values[1 /* useVirtualLayoutChanged */] = true;
            values[10 /* cleanFreeRenderer */] = true;
            this.removeDataProviderListener();
            this.invalidateProperties();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.setVirtualElementIndicesInView = function (startIndex, endIndex) {
            if (!this.$layout || !this.$layout.$useVirtualLayout) {
                return;
            }
            var indexToRenderer = this.$indexToRenderer;
            var keys = Object.keys(indexToRenderer);
            var length = keys.length;
            for (var i = 0; i < length; i++) {
                var index = +keys[i];
                if (index < startIndex || index > endIndex) {
                    this.freeRendererByIndex(index);
                }
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.getElementAt = function (index) {
            return this.$indexToRenderer[index];
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.5.2
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.getVirtualElementAt = function (index) {
            index = +index | 0;
            if (index < 0 || index >= this.$dataProvider.length)
                return null;
            var renderer = this.$indexToRenderer[index];
            if (!renderer) {
                var item = this.$dataProvider.getItemAt(index);
                renderer = this.createVirtualRenderer(item);
                this.$indexToRenderer[index] = renderer;
                this.updateRenderer(renderer, index, item);
                var values = this.$DataGroup;
                if (values[4 /* createNewRendererFlag */]) {
                    renderer.validateNow();
                    values[4 /* createNewRendererFlag */] = false;
                    this.rendererAdded(renderer, index, item);
                }
            }
            return renderer;
        };
        /**
         * @private
         * ้ๆพๆๅฎ็ดขๅผๅค็้กนๅ็คบๅจ
         */
        DataGroup.prototype.freeRendererByIndex = function (index) {
            var renderer = this.$indexToRenderer[index];
            if (renderer) {
                delete this.$indexToRenderer[index];
                this.doFreeRenderer(renderer);
            }
        };
        /**
         * @private
         *
         * @param renderer
         */
        DataGroup.prototype.doFreeRenderer = function (renderer) {
            var values = this.$DataGroup;
            var rendererClass = values[2 /* rendererToClassMap */][renderer.$hashCode];
            var hashCode = rendererClass.$hashCode;
            if (!values[3 /* freeRenderers */][hashCode]) {
                values[3 /* freeRenderers */][hashCode] = [];
            }
            values[3 /* freeRenderers */][hashCode].push(renderer);
            renderer.visible = false;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.invalidateSize = function () {
            if (!this.$DataGroup[4 /* createNewRendererFlag */]) {
                _super.prototype.invalidateSize.call(this);
            }
        };
        /**
         * @private
         * ไธบๆๅฎ็ดขๅผๅๅปบ่ๆ็้กนๅ็คบๅจ
         */
        DataGroup.prototype.createVirtualRenderer = function (item) {
            var renderer;
            var rendererClass = this.itemToRendererClass(item);
            var hashCode = rendererClass.$hashCode;
            var values = this.$DataGroup;
            var freeRenderers = values[3 /* freeRenderers */];
            if (freeRenderers[hashCode] && freeRenderers[hashCode].length > 0) {
                renderer = freeRenderers[hashCode].pop();
                renderer.visible = true;
                this.invalidateDisplayList();
                return renderer;
            }
            values[4 /* createNewRendererFlag */] = true;
            return this.createOneRenderer(rendererClass);
        };
        /**
         * @private
         * ๆนๆฎrendererClassๅๅปบไธไธชRenderer,ๅนถๆทปๅๅฐๆพ็คบๅ่กจ
         */
        DataGroup.prototype.createOneRenderer = function (rendererClass) {
            var renderer = (new rendererClass());
            var values = this.$DataGroup;
            values[2 /* rendererToClassMap */][renderer.$hashCode] = rendererClass;
            if (!egret.is(renderer, "eui.IItemRenderer")) {
                return null;
            }
            if (values[13 /* itemRendererSkinName */]) {
                this.setItemRenderSkinName(renderer, values[13 /* itemRendererSkinName */]);
            }
            this.addChild(renderer);
            return renderer;
        };
        /**
         * @private
         * ่ฎพ็ฝฎ้กนๅ็คบๅจ็้ป่ฎค็ฎ่ค
         */
        DataGroup.prototype.setItemRenderSkinName = function (renderer, skinName) {
            if (renderer && renderer instanceof eui.Component) {
                var comp = renderer;
                if (!comp.$Component[5 /* skinNameExplicitlySet */]) {
                    comp.skinName = skinName;
                    comp.$Component[5 /* skinNameExplicitlySet */] = false;
                }
            }
        };
        Object.defineProperty(DataGroup.prototype, "dataProvider", {
            /**
             * The data provider for this DataGroup.
             * It must be an ICollection, such as ArrayCollection
             *
             * @see eui.ICollection
             * @see eui.ArrayCollection
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅ่กจๆฐๆฎๆบ๏ผ่ฏทไฝฟ็จๅฎ็ฐไบICollectionๆฅๅฃ็ๆฐๆฎ็ฑปๅ๏ผไพๅฆ ArrayCollection
             *
             * @see eui.ICollection
             * @see eui.ArrayCollection
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$dataProvider;
            },
            set: function (value) {
                this.$setDataProvider(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        DataGroup.prototype.$setDataProvider = function (value) {
            if (this.$dataProvider == value || (value && !value.getItemAt))
                return false;
            this.removeDataProviderListener();
            this.$dataProvider = value;
            this.$dataProviderChanged = true;
            this.$DataGroup[10 /* cleanFreeRenderer */] = true;
            this.invalidateProperties();
            this.invalidateSize();
            this.invalidateDisplayList();
            return true;
        };
        /**
         * @private
         * ็งป้คๆฐๆฎๆบ็ๅฌ
         */
        DataGroup.prototype.removeDataProviderListener = function () {
            if (this.$dataProvider)
                this.$dataProvider.removeEventListener(eui.CollectionEvent.COLLECTION_CHANGE, this.onCollectionChange, this);
        };
        /**
         * Called when contents within the dataProvider changes.  We will catch certain
         * events and update our children based on that.
         *
         * @param event ไบไปถ<code>eui.CollectionEvent</code>็ๅฏน่ฑกใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐๆฎๆบๆนๅไบไปถๅค็ใ
         *
         * @param event ไบไปถ<code>eui.CollectionEvent</code>็ๅฏน่ฑกใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.onCollectionChange = function (event) {
            switch (event.kind) {
                case eui.CollectionEventKind.ADD:
                    this.itemAddedHandler(event.items, event.location);
                    break;
                case eui.CollectionEventKind.REMOVE:
                    this.itemRemovedHandler(event.items, event.location);
                    break;
                case eui.CollectionEventKind.UPDATE:
                case eui.CollectionEventKind.REPLACE:
                    this.itemUpdatedHandler(event.items[0], event.location);
                    break;
                case eui.CollectionEventKind.RESET:
                case eui.CollectionEventKind.REFRESH:
                    if (this.$layout && this.$layout.$useVirtualLayout) {
                        var indexToRenderer = this.$indexToRenderer;
                        var keys = Object.keys(indexToRenderer);
                        var length_9 = keys.length;
                        for (var i = length_9 - 1; i >= 0; i--) {
                            var index = +keys[i];
                            this.freeRendererByIndex(index);
                        }
                    }
                    this.$dataProviderChanged = true;
                    this.invalidateProperties();
                    break;
            }
            this.invalidateSize();
            this.invalidateDisplayList();
        };
        /**
         * @private
         * ๆฐๆฎๆบๆทปๅ้กน็ฎไบไปถๅค็
         */
        DataGroup.prototype.itemAddedHandler = function (items, index) {
            var length = items.length;
            for (var i = 0; i < length; i++) {
                this.itemAdded(items[i], index + i);
            }
            this.resetRenderersIndices();
        };
        /**
         * @private
         * ๆฐๆฎๆบ็งป้ค้กน็ฎไบไปถๅค็
         */
        DataGroup.prototype.itemRemovedHandler = function (items, location) {
            var length = items.length;
            for (var i = length - 1; i >= 0; i--) {
                this.itemRemoved(items[i], location + i);
            }
            this.resetRenderersIndices();
        };
        /**
         * Adds the item for the specified dataProvider item to this DataGroup.
         *
         * This method is called as needed by the DataGroup implementation,
         * it should not be called directly.
         *
         * @param item The item that was added, the value of dataProvider[index].
         * @param index The index where the dataProvider item was added.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆทปๅไธไธชๆๅฎ็ๆฐๆฎๅฐๆฐๆฎๆบใ
         *
         * ่ฟไธชๆนๆณไธๅบ่ฏฅ็ฑๅผๅ่็ดๆฅ่ฐ็จ๏ผ่็จไบๆฌ็ฑป่ชๅจๅ่ฐ็จใ
         *
         * @param item ๆทปๅ็ๆฐๆฎ้กนใ
         * @param index ่ขซๆทปๅๅฐ็็ดขๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.itemAdded = function (item, index) {
            if (this.$layout)
                this.$layout.elementAdded(index);
            if (this.$layout && this.$layout.$useVirtualLayout) {
                this.$indexToRenderer.splice(index, 0, null);
                return;
            }
            var renderer = this.createVirtualRenderer(item);
            this.$indexToRenderer.splice(index, 0, renderer);
            if (renderer) {
                this.updateRenderer(renderer, index, item);
                var values = this.$DataGroup;
                if (values[4 /* createNewRendererFlag */]) {
                    values[4 /* createNewRendererFlag */] = false;
                    this.rendererAdded(renderer, index, item);
                }
            }
        };
        /**
         * Removes the itemRenderer for the specified dataProvider item from this DataGroup.
         *
         * This method is called as needed by the DataGroup implementation,
         * it should not be called directly.
         *
         * @param item The item that is being removed.
         * @param index The index of the item that is being removed.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้คๆฐๆฎๆบไธญๆๅฎ็้กนใ
         *
         * ่ฟไธชๆนๆณไธๅบ่ฏฅ็ฑๅผๅ่็ดๆฅ่ฐ็จ๏ผ่็จไบๆฌ็ฑป่ชๅจๅ่ฐ็จใ
         *
         * @param item ็งป้ค็ๆฐๆฎ้กนใ
         * @param index ่ขซ็งป้ค็็ดขๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.itemRemoved = function (item, index) {
            if (this.$layout)
                this.$layout.elementRemoved(index);
            var oldRenderer = this.$indexToRenderer[index];
            if (this.$indexToRenderer.length > index)
                this.$indexToRenderer.splice(index, 1);
            if (oldRenderer) {
                if (this.$layout && this.$layout.$useVirtualLayout) {
                    this.doFreeRenderer(oldRenderer);
                }
                else {
                    this.rendererRemoved(oldRenderer, index, item);
                    this.removeChild(oldRenderer);
                }
            }
        };
        /**
         * @private
         * ๆดๆฐๅฝๅๆๆ้กน็็ดขๅผ
         */
        DataGroup.prototype.resetRenderersIndices = function () {
            var indexToRenderer = this.$indexToRenderer;
            if (indexToRenderer.length == 0)
                return;
            if (this.$layout && this.$layout.$useVirtualLayout) {
                var keys = Object.keys(indexToRenderer);
                var length_10 = keys.length;
                for (var i = 0; i < length_10; i++) {
                    var index = +keys[i];
                    this.resetRendererItemIndex(index);
                }
            }
            else {
                var indexToRendererLength = indexToRenderer.length;
                for (var index = 0; index < indexToRendererLength; index++) {
                    this.resetRendererItemIndex(index);
                }
            }
        };
        /**
         * @private
         * ๆฐๆฎๆบๆดๆฐๆๆฟๆข้กน็ฎไบไปถๅค็
         */
        DataGroup.prototype.itemUpdatedHandler = function (item, location) {
            if (this.$DataGroup[11 /* renderersBeingUpdated */]) {
                return; //้ฒๆญขๆ้ๅพช็ฏ
            }
            var renderer = this.$indexToRenderer[location];
            if (renderer)
                this.updateRenderer(renderer, location, item);
        };
        /**
         * @private
         * ่ฐๆดๆๅฎ้กนๅ็คบๅจ็็ดขๅผๅผ
         */
        DataGroup.prototype.resetRendererItemIndex = function (index) {
            var renderer = this.$indexToRenderer[index];
            if (renderer)
                renderer.itemIndex = index;
        };
        Object.defineProperty(DataGroup.prototype, "itemRenderer", {
            /**
             * The item renderer to use for data items.
             * The class must implement the IItemRenderer interface.
             * If defined, the <code>itemRendererFunction</code> property
             * takes precedence over this property.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็จไบๆฐๆฎ้กน็ฎ็้กนๅ็คบๅจใๆจๅบ่ฏฅ็ดๆฅไธบๆญคๅฑๆง่ตๅผ่ชๅฎไน็ฑป็็ฑปๅฎไน๏ผ่ไธๆฏไธไธชๅฎไพใๆณจๆ๏ผ่ฏฅ็ฑปๅฟ้กปๅฎ็ฐ IItemRenderer ๆฅๅฃใ<br/>
             * rendererClass่ทๅ้กบๅบ๏ผitemRendererFunction > itemRenderer > ้ป่ฎคItemRenererใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DataGroup[6 /* itemRenderer */];
            },
            set: function (value) {
                var values = this.$DataGroup;
                if (values[6 /* itemRenderer */] == value)
                    return;
                values[6 /* itemRenderer */] = value;
                values[5 /* itemRendererChanged */] = true;
                values[8 /* typicalItemChanged */] = true;
                values[10 /* cleanFreeRenderer */] = true;
                this.removeDataProviderListener();
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DataGroup.prototype, "itemRendererSkinName", {
            /**
             * The skinName property of the itemRenderer.This property will be passed to itemRenderer.skinName as default value,if you
             * did not set it explicitly.<br>
             * Note: This property is invalid if the itemRenderer is not a subclass of the Component class.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆก็ฎๆธฒๆๅจ็ๅฏ้็ฎ่คๆ่ฏ็ฌฆใๅจๅฎไพๅitemRendererๆถ๏ผ่ฅๅถๅ้จๆฒกๆ่ฎพ็ฝฎ่ฟskinName,ๅๅฐๆญคๅฑๆง็ๅผ่ตๅผ็ปๅฎ็skinNameใ
             * ๆณจๆ:่ฅ itemRenderer ไธๆฏ Component ็ๅญ็ฑป๏ผๅๆญคๅฑๆงๆๆใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DataGroup[13 /* itemRendererSkinName */];
            },
            set: function (value) {
                var values = this.$DataGroup;
                if (values[13 /* itemRendererSkinName */] == value)
                    return;
                values[13 /* itemRendererSkinName */] = value;
                if (this.$UIComponent[29 /* initialized */]) {
                    values[14 /* itemRendererSkinNameChange */] = true;
                    this.invalidateProperties();
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DataGroup.prototype, "itemRendererFunction", {
            /**
             * Function that returns an item renderer for a
             * specific item.
             *
             * If defined, this property
             * takes precedence over the <code>itemRenderer</code> property.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธบๆไธช็นๅฎๆฐๆฎ้กน่ฟๅไธไธช้กนๅ็คบๅจ็ฑปๅฎไน็ๅฝๆฐใ
             * rendererClass่ทๅ้กบๅบ๏ผitemRendererFunction > itemRenderer > ้ป่ฎคItemRenererใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$DataGroup[7 /* itemRendererFunction */];
            },
            set: function (value) {
                var values = this.$DataGroup;
                if (values[7 /* itemRendererFunction */] == value)
                    return;
                values[7 /* itemRendererFunction */] = value;
                values[5 /* itemRendererChanged */] = true;
                values[8 /* typicalItemChanged */] = true;
                this.removeDataProviderListener();
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ไธบ็นๅฎ็ๆฐๆฎ้กน่ฟๅ้กนๅ็คบๅจ็ๅทฅๅๅฎไพ
         */
        DataGroup.prototype.itemToRendererClass = function (item) {
            var rendererClass;
            var values = this.$DataGroup;
            if (values[7 /* itemRendererFunction */]) {
                rendererClass = values[7 /* itemRendererFunction */](item);
            }
            if (!rendererClass) {
                rendererClass = values[6 /* itemRenderer */];
            }
            if (!rendererClass) {
                rendererClass = eui.ItemRenderer;
            }
            if (!rendererClass.$hashCode) {
                rendererClass.$hashCode = egret.$hashCount++;
            }
            return rendererClass;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.createChildren = function () {
            if (!this.$layout) {
                var layout = new eui.VerticalLayout();
                layout.gap = 0;
                layout.horizontalAlign = eui.JustifyAlign.CONTENT_JUSTIFY;
                this.$setLayout(layout);
            }
            _super.prototype.createChildren.call(this);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.commitProperties = function () {
            var values = this.$DataGroup;
            if (values[5 /* itemRendererChanged */] || this.$dataProviderChanged || values[1 /* useVirtualLayoutChanged */]) {
                this.removeAllRenderers();
                if (this.$layout)
                    this.$layout.clearVirtualLayoutCache();
                this.setTypicalLayoutRect(null);
                values[1 /* useVirtualLayoutChanged */] = false;
                values[5 /* itemRendererChanged */] = false;
                if (this.$dataProvider)
                    this.$dataProvider.addEventListener(eui.CollectionEvent.COLLECTION_CHANGE, this.onCollectionChange, this);
                if (this.$layout && this.$layout.$useVirtualLayout) {
                    this.invalidateSize();
                    this.invalidateDisplayList();
                }
                else {
                    this.createRenderers();
                }
                if (this.$dataProviderChanged) {
                    this.$dataProviderChanged = false;
                    this.scrollV = this.scrollH = 0;
                }
            }
            _super.prototype.commitProperties.call(this);
            if (values[8 /* typicalItemChanged */]) {
                values[8 /* typicalItemChanged */] = false;
                if (this.$dataProvider && this.$dataProvider.length > 0) {
                    values[12 /* typicalItem */] = this.$dataProvider.getItemAt(0);
                    this.measureRendererSize();
                }
            }
            if (values[14 /* itemRendererSkinNameChange */]) {
                values[14 /* itemRendererSkinNameChange */] = false;
                var skinName = values[13 /* itemRendererSkinName */];
                var indexToRenderer = this.$indexToRenderer;
                var keys = Object.keys(indexToRenderer);
                var length_11 = keys.length;
                for (var i = 0; i < length_11; i++) {
                    var index = keys[i];
                    this.setItemRenderSkinName(indexToRenderer[index], skinName);
                }
                var freeRenderers = values[3 /* freeRenderers */];
                keys = Object.keys(freeRenderers);
                length_11 = keys.length;
                for (var i = 0; i < length_11; i++) {
                    var hashCode = keys[i];
                    var list = freeRenderers[hashCode];
                    var length_12 = list.length;
                    for (var i_1 = 0; i_1 < length_12; i_1++) {
                        this.setItemRenderSkinName(list[i_1], skinName);
                    }
                }
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.measure = function () {
            if (this.$layout && this.$layout.$useVirtualLayout) {
                this.ensureTypicalLayoutElement();
            }
            _super.prototype.measure.call(this);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        DataGroup.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            var useVirtualLayout = (this.$layout && this.$layout.$useVirtualLayout);
            if (useVirtualLayout) {
                this.ensureTypicalLayoutElement();
            }
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            var values = this.$DataGroup;
            if (useVirtualLayout) {
                //ๆฃๆฅ็ดขๅผ 0 ๅค็้กนๆต้ๅคงๅฐๆฏๅฆๅ็ๆนๅ๏ผ่ฅๆนๅๅฐฑ้ๆฐ่ฎก็ฎ typicalLayoutRect
                var rect = values[9 /* typicalLayoutRect */];
                if (rect) {
                    var renderer = this.$indexToRenderer[0];
                    if (renderer) {
                        var bounds = egret.$TempRectangle;
                        renderer.getPreferredBounds(bounds);
                        if (bounds.width != rect.width || bounds.height != rect.height) {
                            values[9 /* typicalLayoutRect */] = null;
                        }
                    }
                }
            }
        };
        /**
         * @private
         * ็กฎไฟๆต้่ฟ้ป่ฎคๆก็ฎๅคงๅฐใ
         */
        DataGroup.prototype.ensureTypicalLayoutElement = function () {
            if (this.$DataGroup[9 /* typicalLayoutRect */])
                return;
            if (this.$dataProvider && this.$dataProvider.length > 0) {
                this.$DataGroup[12 /* typicalItem */] = this.$dataProvider.getItemAt(0);
                this.measureRendererSize();
            }
        };
        /**
         * @private
         * ๆต้้กนๅ็คบๅจ้ป่ฎคๅฐบๅฏธ
         */
        DataGroup.prototype.measureRendererSize = function () {
            var values = this.$DataGroup;
            if (!values[12 /* typicalItem */]) {
                this.setTypicalLayoutRect(null);
                return;
            }
            var typicalRenderer = this.createVirtualRenderer(values[12 /* typicalItem */]);
            if (!typicalRenderer) {
                this.setTypicalLayoutRect(null);
                return;
            }
            this.updateRenderer(typicalRenderer, 0, values[12 /* typicalItem */]);
            typicalRenderer.validateNow();
            var bounds = egret.$TempRectangle;
            typicalRenderer.getPreferredBounds(bounds);
            var rect = new egret.Rectangle(0, 0, bounds.width, bounds.height);
            if (this.$layout && this.$layout.$useVirtualLayout) {
                if (values[4 /* createNewRendererFlag */]) {
                    this.rendererAdded(typicalRenderer, 0, values[12 /* typicalItem */]);
                }
                this.doFreeRenderer(typicalRenderer);
            }
            else {
                this.removeChild(typicalRenderer);
            }
            this.setTypicalLayoutRect(rect);
            values[4 /* createNewRendererFlag */] = false;
        };
        /**
         * @private
         * ่ฎพ็ฝฎ้กน็ฎ้ป่ฎคๅคงๅฐ
         */
        DataGroup.prototype.setTypicalLayoutRect = function (rect) {
            this.$DataGroup[9 /* typicalLayoutRect */] = rect;
            if (this.$layout) {
                if (rect) {
                    this.$layout.setTypicalSize(rect.width, rect.height);
                }
                else {
                    this.$layout.setTypicalSize(0, 0);
                }
            }
        };
        /**
         * @private
         * ็งป้คๆๆ้กนๅ็คบๅจ
         */
        DataGroup.prototype.removeAllRenderers = function () {
            var indexToRenderer = this.$indexToRenderer;
            var keys = Object.keys(indexToRenderer);
            var length = keys.length;
            for (var i = 0; i < length; i++) {
                var index = keys[i];
                var renderer = indexToRenderer[index];
                if (renderer) {
                    this.rendererRemoved(renderer, renderer.itemIndex, renderer.data);
                    this.removeChild(renderer);
                }
            }
            this.$indexToRenderer = [];
            var values = this.$DataGroup;
            if (values[10 /* cleanFreeRenderer */]) {
                var freeRenderers = values[3 /* freeRenderers */];
                var keys_1 = Object.keys(freeRenderers);
                var length_13 = keys_1.length;
                for (var i = 0; i < length_13; i++) {
                    var hashCode = keys_1[i];
                    var list = freeRenderers[hashCode];
                    var length_14 = list.length;
                    for (var i_2 = 0; i_2 < length_14; i_2++) {
                        var renderer = list[i_2];
                        this.rendererRemoved(renderer, renderer.itemIndex, renderer.data);
                        this.removeChild(renderer);
                    }
                }
                values[3 /* freeRenderers */] = {};
                values[2 /* rendererToClassMap */] = {};
                values[10 /* cleanFreeRenderer */] = false;
            }
        };
        /**
         * @private
         * ไธบๆฐๆฎ้กนๅๅปบ้กนๅ็คบๅจ
         */
        DataGroup.prototype.createRenderers = function () {
            if (!this.$dataProvider)
                return;
            var index = 0;
            var length = this.$dataProvider.length;
            for (var i = 0; i < length; i++) {
                var item = this.$dataProvider.getItemAt(i);
                var rendererClass = this.itemToRendererClass(item);
                var renderer = this.createOneRenderer(rendererClass);
                if (!renderer)
                    continue;
                this.$indexToRenderer[index] = renderer;
                this.updateRenderer(renderer, index, item);
                this.rendererAdded(renderer, index, item);
                index++;
            }
        };
        /**
         * Updates the renderer for reuse.
         * This method first prepares the item
         * renderer for reuse by cleaning out any stale properties
         * as well as updating it with new properties.<p/>
         *
         * The last thing this method should do is set the <code>data</code> property
         * of the item renderer.
         *
         * @param renderer The item renderer.
         * @param itemIndex The index of the data in the data provider.
         * @param data The data object this item renderer is representing.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆญคๆนๆณ้ฆๅไผๅๅค้กนๅ็คบๅจไปฅ้็จ๏ผๆนๆณๆฏๆธ้คไปปไฝๆงๅฑๆง๏ผๅๆถไฝฟ็จๆฐๅฑๆง่ฟ่กๆดๆฐใ<p/>
         *
         * ๆๅ๏ผๆญคๆนๆณๅบๅฏน้กนๅ็คบๅจ่ฎพ็ฝฎ data ๅฑๆงใ
         *
         * @param renderer ้กนๅ็คบๅจใ
         * @param itemIndex ๆฐๆฎๆไพ็จๅบไธญ็ๆฐๆฎ็ดขๅผใ
         * @param data ๆญค้กนๅ็คบๅจๆญฃๅจ่กจ็คบ็ๆฐๆฎๅฏน่ฑกใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.updateRenderer = function (renderer, itemIndex, data) {
            var values = this.$DataGroup;
            values[11 /* renderersBeingUpdated */] = true;
            renderer.itemIndex = itemIndex;
            if (renderer.parent == this) {
                this.setChildIndex(renderer, itemIndex);
            }
            renderer.data = data;
            values[11 /* renderersBeingUpdated */] = false;
            return renderer;
        };
        Object.defineProperty(DataGroup.prototype, "numElements", {
            /**
             * @inheritDoc
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (!this.$dataProvider)
                    return 0;
                return this.$dataProvider.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Adds the itemRenderer for the specified dataProvider item to this DataGroup.
         *
         * This method is called as needed by the DataGroup implementation,
         * it should not be called directly.
         *
         * @param renderer The renderer that was added.
         * @param index The index where the dataProvider item was added.
         * @param item The item that was added, the value of dataProvider[index].
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้กนๅ็คบๅจ่ขซๆทปๅ.
         *
         * ่ฟไธชๆนๆณไธ่ฝ็ดๆฅ่ฐ็จ๏ผๅฎๆฏ็ฑ่ฏฅ็ฑป่ช่บซ่ชๅจ่ฐ็จ็ใ
         *
         * @param renderer ๆทปๅ็้กนๅ็คบๅจ
         * @param index ้กนๅ็คบๅจ็็ดขๅผ
         * @param item ้กนๅ็คบๅจๅฏนๅบ็ๆฐๆฎ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.rendererAdded = function (renderer, index, item) {
        };
        /**
         * Removes the itemRenderer for the specified dataProvider item from this DataGroup.
         *
         * This method is called as needed by the DataGroup implementation,
         * it should not be called directly.
         *
         * @param renderer The renderer that is being removed.
         * @param index The index of the item that is being removed.
         * @param item The item that is being removed.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้กนๅ็คบๅจ่ขซ็งป้คใ
         * ่ฟไธชๆนๆณไธ่ฝ็ดๆฅ่ฐ็จ๏ผๅฎๆฏ็ฑ่ฏฅ็ฑป่ช่บซ่ชๅจ่ฐ็จ็ใ
         *
         * @param renderer ็งป้ค็้กนๅ็คบๅจ
         * @param index ้กนๅ็คบๅจ็็ดขๅผ
         * @param item ้กนๅ็คบๅจๅฏนๅบ็ๆฐๆฎ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DataGroup.prototype.rendererRemoved = function (renderer, index, item) {
        };
        return DataGroup;
    }(eui.Group));
    eui.DataGroup = DataGroup;
    __reflect(DataGroup.prototype, "eui.DataGroup");
    eui.registerProperty(DataGroup, "itemRenderer", "Class");
    eui.registerProperty(DataGroup, "itemRendererSkinName", "Class");
    eui.registerProperty(DataGroup, "dataProvider", "eui.ICollection", true);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The Button component is a commonly used rectangular button.
     * The Button component looks like it can be pressed.
     * The default skin has a text label and a icon display object.
     *
     * @event egret.TouchEvent.TOUCH_CANCEL canceled the touch
     *
     * @state up Button up state
     * @state down Button down state
     * @state disabled Button disabled state
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/ButtonExample.ts
     * @language en_US
     */
    /**
     * Button ็ปไปถๆฏๅธธ็จ็็ฉๅฝขๆ้ฎใButton ็ปไปถ็่ตทๆฅๅฏไปฅๆๅใ้ป่ฎคๅค่งๅทๆไธไธชๆๆฌๆ็ญพๅๅพๆๆพ็คบๅฏน่ฑกใ
     *
     * @event egret.TouchEvent.TOUCH_CANCEL ๅๆถ่งฆๆธไบไปถ
     *
     * @state up ๆ้ฎๅผน่ตท็ถๆ
     * @state down ๆ้ฎๆไธ็ถๆ
     * @state disabled ๆ้ฎ็ฆ็จ็ถๆ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/ButtonExample.ts
     * @language zh_CN
     */
    var Button = (function (_super) {
        __extends(Button, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๆ้ฎๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Button() {
            var _this = _super.call(this) || this;
            /**
             * [SkinPart] A skin part that defines the label of the button.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart] ๆ้ฎไธ็ๆๆฌๆ็ญพใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.labelDisplay = null;
            /**
             * @private
             */
            _this._label = "";
            /**
             * [SkinPart] A skin part that defines an optional icon for the button.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart] ๆ้ฎไธ็ๅพๆๆพ็คบๅฏน่ฑกใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.iconDisplay = null;
            /**
             * @private
             */
            _this._icon = null;
            /**
             * @private
             * ๆ็คบ็ฌฌไธๆฌกๅๆดพ TouchEvent.TOUCH_BEGIN ๆถ๏ผ่งฆๆธ็นๆฏๅฆๅจๆ้ฎไธใ
             */
            _this.touchCaptured = false;
            _this.touchChildren = false;
            _this.addEventListener(egret.TouchEvent.TOUCH_BEGIN, _this.onTouchBegin, _this);
            return _this;
        }
        Object.defineProperty(Button.prototype, "label", {
            /**
             * Text to appear on the Button control.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๅจๆ้ฎไธๆพ็คบ็ๆๆฌใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._label;
            },
            set: function (value) {
                this._label = value;
                if (this.labelDisplay) {
                    this.labelDisplay.text = value;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Button.prototype, "icon", {
            /**
             * Icon to appear on the Button control.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๅจๆ้ฎไธๆพ็คบ็ๅพๆๆฐๆฎ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._icon;
            },
            set: function (value) {
                this._icon = value;
                if (this.iconDisplay) {
                    this.iconDisplay.source = value;
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * This method handles the touchCancle events
         * @param  The <code>egret.TouchEvent</code> object.
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฃ้ค่งฆ็ขฐไบไปถๅค็ใ
         * @param event ไบไปถ <code>egret.TouchEvent</code> ็ๅฏน่ฑกใ
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Button.prototype.onTouchCancle = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            this.touchCaptured = false;
            this.invalidateState();
        };
        /**
         * This method handles the touch events
         * @param  The <code>egret.TouchEvent</code> object.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฆ็ขฐไบไปถๅค็ใ
         * @param event ไบไปถ <code>egret.TouchEvent</code> ็ๅฏน่ฑกใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Button.prototype.onTouchBegin = function (event) {
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            this.touchCaptured = true;
            this.invalidateState();
            event.updateAfterEvent();
        };
        /**
         * @private
         * ่ๅฐไธ่งฆๆธๅผน่ตทไบไปถ
         */
        Button.prototype.onStageTouchEnd = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            if (this.contains(event.target)) {
                this.buttonReleased();
            }
            this.touchCaptured = false;
            this.invalidateState();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Button.prototype.getCurrentState = function () {
            if (!this.enabled)
                return "disabled";
            if (this.touchCaptured)
                return "down";
            return "up";
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Button.prototype.partAdded = function (partName, instance) {
            if (instance === this.labelDisplay) {
                this.labelDisplay.text = this._label;
            }
            else if (instance == this.iconDisplay) {
                this.iconDisplay.source = this._icon;
            }
        };
        /**
         * This method is called when handling a <code>egret.TouchEvent.TOUCH_END</code> event
         * when the user touches on the button. It is only called when the button
         * is the target and when <code>touchCaptured</code> is <code>true</code>.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝๅจ็จๆทๅๅปๆ้ฎไนๅๅค็ <code>egret.TouchEvent.TOUCH_END</code> ไบไปถๆถ๏ผๅฐ่ฐ็จๆญคๆนๆณใ
         * ไปๅฝไปฅๆ้ฎไธบ็ฎๆ๏ผๅนถไธ <code>touchCaptured</code> ไธบ <code>true</code> ๆถ๏ผๆไผ่ฐ็จๆญคๆนๆณใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Button.prototype.buttonReleased = function () {
        };
        return Button;
    }(eui.Component));
    eui.Button = Button;
    __reflect(Button.prototype, "eui.Button");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The Range class holds a value and an allowed range for that
     * value, defined by <code>minimum</code> and <code>maximum</code> properties.
     *
     * The <code>value</code> property
     * is always constrained to be between the current <code>minimum</code> and
     * <code>maximum</code>, and the <code>minimum</code>,
     * and <code>maximum</code> are always constrained
     * to be in the proper numerical order, such that
     * <code>(minimum <= value <= maximum)</code> is <code>true</code>.
     *
     * If the value of the <code>snapInterval</code> property is not 0,
     * then the <code>value</code> property is also constrained to be a multiple of
     * <code>snapInterval</code>.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/supportClasses/RangeExample.ts
     * @language en_US
     */
    /**
     * ่ๅด้ๅ็ปไปถ,่ฏฅ็ปไปถๅๅซไธไธชๅผๅ่ฟไธชๅผๆๅ่ฎธ็ๆๅคงๆๅฐ็บฆๆ่ๅดใ
     *
     * <code>value</code>ๅฑๆง็ๅผๆฐธ่ฟ่ขซ้ๅถไบๅฝๅ็<code>minimum</code>ๅ
     * <code>maximum</code>ไน้ด๏ผๅนถไธ<code>minimum</code>ๅ <code>maximum</code>ๆฐธ่ฟๆ็งๅบๅฎ็้กบๅบๆๅ๏ผ
     * ๅณ<code>(minimum <= value <= maximum)</code> ไธบ็ใ
     *
     * ๅฆๆ<code>snapInterval</code>ๅฑๆง็ๅผไธๆฏ0๏ผ้ฃไน<code>value</code>็ๅผไนไผ่ขซ<code>snapInterval</code>ๆ็บฆๆใ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/supportClasses/RangeExample.ts
     * @language zh_CN
     */
    var Range = (function (_super) {
        __extends(Range, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช Range ๅฎไพใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Range() {
            var _this = _super.call(this) || this;
            _this.$Range = {
                0: 100,
                1: false,
                2: 0,
                3: false,
                4: 0,
                5: 0,
                6: false,
                7: 1,
                8: false,
                9: false,
            };
            return _this;
        }
        Object.defineProperty(Range.prototype, "maximum", {
            /**
             * The maximum valid <code>value</code>.<p/>
             *
             * Changes to the value property are constrained
             * by <code>commitProperties()</code> to be less than or equal to
             * maximum with the <code>nearestValidValue()</code> method.
             *
             * @default 100
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅคงๆๆๅผใ<p/>
             *
             * ่งๅฎ<code>value</code>ๅฑๆง็ๅผไธ่ฝๅค่ถ่ฟ็ๆๅคงๅผใ่ฏฅไฟฎๆญฃ่ฟ็จ
             * ๅฐๅจ<code>nearestValidValue()</code>ๆนๆณไธญ่ฟ่กใ
             *
             * @default 100
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Range[0 /* maximum */];
            },
            set: function (value) {
                value = +value || 0;
                var values = this.$Range;
                if (value === values[0 /* maximum */])
                    return;
                values[0 /* maximum */] = value;
                values[1 /* maxChanged */] = true;
                this.invalidateProperties();
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Range.prototype, "minimum", {
            /**
             * The minimum valid <code>value</code>.<p/>
             *
             * Changes to the value property are constrained
             * by <code>commitProperties()</code> to be greater than or equal to
             * minimum with the <code>nearestValidValue()</code> method.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฐๆๆๅผ<p/>
             *
             * ่งๅฎ<code>value</code>ๅฑๆง็ๅผไธ่ฝๅคไฝไบ็ๆๅฐๅผใ่ฏฅไฟฎๆญฃ่ฟ็จ
             * ๅฐๅจ<code>nearestValidValue()</code>ๆนๆณไธญ่ฟ่กใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Range[2 /* minimum */];
            },
            set: function (value) {
                value = +value || 0;
                var values = this.$Range;
                if (value === values[2 /* minimum */])
                    return;
                values[2 /* minimum */] = value;
                values[3 /* minChanged */] = true;
                this.invalidateProperties();
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Range.prototype, "value", {
            /**
             * The current value for this range.<p/>
             *
             * Changes to the value property are constrained
             * by <code>commitProperties()</code> to be greater than or equal to
             * the <code>minimum</code> property, less than or equal to the <code>maximum</code> property, and a
             * multiple of <code>snapInterval</code> with the <code>nearestValidValue()</code>
             * method.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญค่ๅด็ๅฝๅๅผใ<p/>
             *
             * ๆนๅ็<code>value</code>ๅฑๆงๅฐๅจ<code>commitProperties()</code>ๆนๆณไธญ่ขซ<code>minimum</code>ๅฑๆง
             * ๅ<code>minimum</code>ๅฑๆงๆ้ๅถใๆญคไฟฎๆญฃ่ฟ็จๅฐๅจ<code>nearestValidValue()</code>ๆนๆณไธญ่ฟ่กใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var values = this.$Range;
                return values[6 /* valueChanged */] ?
                    values[5 /* changedValue */] : values[4 /* value */];
            },
            set: function (newValue) {
                newValue = +newValue || 0;
                this.$setValue(newValue);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param newValue
         */
        Range.prototype.$setValue = function (newValue) {
            if (newValue === this.value)
                return false;
            var values = this.$Range;
            values[5 /* changedValue */] = newValue;
            values[6 /* valueChanged */] = true;
            this.invalidateProperties();
            return true;
        };
        Object.defineProperty(Range.prototype, "snapInterval", {
            /**
             * The snapInterval property controls the valid values of the <code>value</code> property.
             *
             * If nonzero, valid values are the sum of the <code>minimum</code> and integer multiples
             * of this property, for all sums that are less than or equal to the <code>maximum</code>.<p/>
             *
             * For example, if <code>minimum</code> is 10, <code>maximum</code> is 20, and this property is 3, then the
             * valid values of this Range are 10, 13, 16, 19, and 20.<p/>
             *
             * If the value of this property is zero, then valid values are only constrained
             * to be between minimum and maximum inclusive.
             *
             * @default 1
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * snapInterval ๅฑๆงๅฎไน value ๅฑๆง็ๆๆๅผใ
             * ๅฆๆไธบ้้ถ๏ผๅๆๆๅผไธบ minimum ไธๆญคๅฑๆง็ๆดๆฐๅๆฐไนๅ๏ผไธๅฐไบๆ็ญไบ maximumใ</p>
             *
             * ไพๅฆ๏ผๅฆๆ minimum ไธบ 10๏ผmaximum ไธบ 20๏ผ่ๆญคๅฑๆงไธบ 3๏ผๅๅฏ่ฝ็ๆๆๅผไธบ 10ใ13ใ16ใ19 ๅ 20.</p>
             *
             * ๅฆๆๆญคๅฑๆง็ๅผไธบ้ถ๏ผๅไปไผๅฐๆๆๅผ็บฆๆๅฐไปไบ minimum ๅ maximum ไน้ด๏ผๅๆฌไธค่๏ผใ
             *
             * @default 1
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Range[7 /* snapInterval */];
            },
            set: function (value) {
                var values = this.$Range;
                values[9 /* explicitSnapInterval */] = true;
                value = +value || 0;
                if (value === values[7 /* snapInterval */])
                    return;
                if (isNaN(value)) {
                    values[7 /* snapInterval */] = 1;
                    values[9 /* explicitSnapInterval */] = false;
                }
                else {
                    values[7 /* snapInterval */] = value;
                }
                values[8 /* snapIntervalChanged */] = true;
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Processes the properties set on the component.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅค็ๅฏน็ปไปถ่ฎพ็ฝฎ็ๅฑๆง
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Range.prototype.commitProperties = function () {
            _super.prototype.commitProperties.call(this);
            var values = this.$Range;
            if (values[2 /* minimum */] > values[0 /* maximum */]) {
                if (!values[1 /* maxChanged */])
                    values[2 /* minimum */] = values[0 /* maximum */];
                else
                    values[0 /* maximum */] = values[2 /* minimum */];
            }
            if (values[6 /* valueChanged */] || values[1 /* maxChanged */] ||
                values[3 /* minChanged */] || values[8 /* snapIntervalChanged */]) {
                var currentValue = values[6 /* valueChanged */] ?
                    values[5 /* changedValue */] : values[4 /* value */];
                values[6 /* valueChanged */] = false;
                values[1 /* maxChanged */] = false;
                values[3 /* minChanged */] = false;
                values[8 /* snapIntervalChanged */] = false;
                this.setValue(this.nearestValidValue(currentValue, values[7 /* snapInterval */]));
            }
        };
        /**
         * @private
         * ไฟฎๆญฃsizeๅฐๆๆฅ่ฟsnapInterval็ๆดๆฐๅ
         */
        Range.prototype.nearestValidSize = function (size) {
            var interval = this.snapInterval;
            if (interval == 0)
                return size;
            var validSize = Math.round(size / interval) * interval;
            return (Math.abs(validSize) < interval) ? interval : validSize;
        };
        /**
         * Returns the sum of the minimum with an integer multiple of <code>interval</code> that's
         * closest to <code>value</code>, unless <code>value</code> is closer to the maximum limit,
         * in which case the maximum is returned.<p/>
         *
         * If <code>interval</code> is equal to 0, the value is clipped to the minimum and maximum
         * limits.<p/>
         *
         * The valid values for a range are defined by the sum of the <code>minimum</code> property
         * with multiples of the <code>interval</code> and also defined to be less than or equal to the
         * <code>maximum</code> property.
         * The maximum need not be a multiple of <code>snapInterval</code>.<p/>
         *
         * For example, if <code>minimum</code> is equal to 1, <code>maximum</code> is equal to 6,
         * and <code>snapInterval</code> is equal to 2, the valid
         * values for the Range are 1, 3, 5, 6.
         *
         * Similarly, if <code>minimum</code> is equal to 2, <code>maximum</code> is equal to 9,
         * and <code>snapInterval</code> is equal to 1.5, the valid
         * values for the Range are 2, 3.5, 5, 6.5, 8, and 9.
         *
         * @param value The input value.
         * @param interval The value of snapInterval or an integer multiple of snapInterval.
         * @return The valid value that's closest to the input.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅ <code>minimum</code> ไธๆๆฅ่ฟ <code>value</code> ็ <code>interval</code> ็ๆดๆฐๅๆฐไนๅ๏ผ
         * ้ค้ <code>value</code> ๆฅ่ฟๆๅคงๅผ้ๅถ็ๆถๅไผ่ฟๅ maximumใ<p/>
         *
         * ๅฆๆ <code>interval</code> ็ญไบ 0๏ผๅไผๅฐ่ฏฅๅผๅช่ฃๅฐ้ๅถ็ๆๅฐๅผๅๆๅคงๅผใ<p/>
         *
         * ่ๅด็ๆๆๅผ็ฑ <code>minimum</code> ๅฑๆงไธ <code>interval</code> ็ๅๆฐไนๅๅณๅฎ๏ผ
         * ไธๆญคๅๆถไน่ฆๅฐไบ็ญไบ <code>maximum</code> ๅฑๆงใ
         * ๆๅคงๅผไธ่ฝๆฏ <code>snapInterval</code> ๅฑๆง็ๅๆฐใ<p/>
         *
         * ไพๅฆ๏ผๅฆๆ <code>minimum</code> ็ญไบ 1๏ผ<code>maximum</code> ็ญไบ 6๏ผไธ <code>snapInterval</code> ็ญไบ 3๏ผ
         * ๅ Range ็ๆๆๅผๆ 1ใ2ใ5ใ6ใ
         *
         * ็ฑปไผผๅฐ๏ผๅฆๆ <code>minimum</code> ็ญไบ 2๏ผ<code>maximum</code> ็ญไบ 9๏ผ
         * ไธ <code>snapInterval</code> ็ญไบ 1.5๏ผๅ Range ็ๆๆๅผๆ 2ใ3.5ใ5ใ6.5ใ8 ๅ 9ใ
         *
         *
         * @param value ่พๅฅๅผใ
         * @param interval snapInterval ็ๅผ๏ผๆ snapInterval ็ๆดๆฐๅๆฐใ
         * @return ๆ่ฟๆฅ่พๅฅๅผ็ๆๆๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Range.prototype.nearestValidValue = function (value, interval) {
            var values = this.$Range;
            if (interval == 0)
                return Math.max(values[2 /* minimum */], Math.min(values[0 /* maximum */], value));
            var maxValue = values[0 /* maximum */] - values[2 /* minimum */];
            var scale = 1;
            value -= values[2 /* minimum */];
            if (interval != Math.round(interval)) {
                var parts = ((1 + interval).toString()).split(".");
                scale = Math.pow(10, parts[1].length);
                maxValue *= scale;
                value = Math.round(value * scale);
                interval = Math.round(interval * scale);
            }
            var lower = Math.max(0, Math.floor(value / interval) * interval);
            var upper = Math.min(maxValue, Math.floor((value + interval) / interval) * interval);
            var validValue = ((value - lower) >= ((upper - lower) / 2)) ? upper : lower;
            return (validValue / scale) + values[2 /* minimum */];
        };
        /**
         * Sets the current value for the <code>value</code> property.<p/>
         *
         * This method assumes that the caller has already used the <code>nearestValidValue()</code> method
         * to constrain the value parameter
         *
         * @param value The new value of the <code>value</code> property.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎๅฝๅๅผใ<p/>
         *
         * ๆญคๆนๆณๅๅฎ่ฐ็จ่ๅทฒ็ปไฝฟ็จไบ nearestValidValue() ๆนๆณๆฅ็บฆๆ value ๅๆฐใ
         *
         * @param value valueๅฑๆง็ๆฐๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Range.prototype.setValue = function (value) {
            var values = this.$Range;
            if (values[4 /* value */] === value)
                return;
            if (values[0 /* maximum */] > values[2 /* minimum */])
                values[4 /* value */] = Math.min(values[0 /* maximum */], Math.max(values[2 /* minimum */], value));
            else
                values[4 /* value */] = value;
            values[6 /* valueChanged */] = false;
            this.invalidateDisplayList();
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "value");
        };
        /**
         * Draws the object and/or sizes and positions its children.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅถๅฏน่ฑกๅ/ๆ่ฎพ็ฝฎๅถๅญ้กน็ๅคงๅฐๅไฝ็ฝฎ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Range.prototype.updateDisplayList = function (w, h) {
            _super.prototype.updateDisplayList.call(this, w, h);
            this.updateSkinDisplayList();
        };
        /**
         * Update size and visible of skin parts.<p/>
         * Subclasses override this method to update skin parts display based on <code>minimum</code>, <code>maximum</code>
         * and <code>value</code> properties.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆฐ็ฎ่ค้จไปถ๏ผ้ๅธธไธบๆปๅ๏ผ็ๅคงๅฐๅๅฏ่งๆงใ<p/>
         * ๅญ็ฑป่ฆ็ๆญคๆนๆณไปฅๅบไบ minimumใmaximum ๅ value ๅฑๆงๆดๆฐๆปๅ็ๅคงๅฐใไฝ็ฝฎๅๅฏ่งๆงใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Range.prototype.updateSkinDisplayList = function () {
        };
        return Range;
    }(eui.Component));
    eui.Range = Range;
    __reflect(Range.prototype, "eui.Range");
    eui.registerBindable(Range.prototype, "value");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The LayoutBase class defines the base class for all Spark layouts.
     * To create a custom layout that works with the Spark containers,
     * you must extend <code>LayoutBase</code> or one of its subclasses.
     *
     * <p>Subclasses must implement the <code>updateDisplayList()</code>
     * method, which positions and sizes the <code>target</code> GroupBase's elements, and
     * the <code>measure()</code> method, which calculates the default
     * size of the <code>target</code>.</p>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅฎนๅจๅธๅฑๅบ็ฑปใ่ฅ่ฆๅๅปบไฝฟ็จ Group ๅฎนๅจ็่ชๅฎไนๅธๅฑ๏ผๅฟ้กปๆฉๅฑ <code>LayoutBase</code> ๆๅถๅญ็ฑปไนไธใ
     *
     * <p>ๅญ็ฑปๅฟ้กปๅฎ็ฐ <code>updateDisplayList()</code> ๆนๆณ
     * ๏ผๅฎไฝ <code>target</code> Group ็ๅญ้กนๅนถ่ฐๆด่ฟไบๅญ้กน็ๅคงๅฐ๏ผๅ <code>measure()</code> ๆนๆณ
     * ๏ผ่ฎก็ฎ <code>target</code> ็้ป่ฎคๅคงๅฐ๏ผใ</p>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var LayoutBase = (function (_super) {
        __extends(LayoutBase, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function LayoutBase() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.$target = null;
            /**
             * @private
             */
            _this.$useVirtualLayout = false;
            /**
             * @private
             */
            _this.$typicalWidth = 71;
            /**
             * @private
             */
            _this.$typicalHeight = 22;
            return _this;
        }
        Object.defineProperty(LayoutBase.prototype, "target", {
            /**
             * The Group container whose elements are measured, sized and positioned
             * by this layout.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญคๅธๅฑๅฐๆต้ๅถๅ็ดใ่ฐๆดๅถๅ็ด็ๅคงๅฐๅนถๅฎไฝๅถๅ็ด็ Group ๅฎนๅจใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$target;
            },
            set: function (value) {
                if (this.$target === value)
                    return;
                this.$target = value;
                this.clearVirtualLayoutCache();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LayoutBase.prototype, "useVirtualLayout", {
            /**
             * To configure a container to use virtual layout, set the <code>useVirtualLayout</code> property
             * to <code>true</code> for the layout associated with the container.
             * Only DataGroup with layout set to VerticalLayout,
             * HorizontalLayout, or TileLayout supports virtual layout.
             * Layout subclasses that do not support virtualization must prevent changing
             * this property.
             *
             * @default false
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฅ่ฆ้็ฝฎๅฎนๅจไฝฟ็จ่ๆๅธๅฑ๏ผ่ฏทไธบไธๅฎนๅจๅณ่็ๅธๅฑ็ <code>useVirtualLayout</code> ๅฑๆง่ฎพ็ฝฎไธบ <code>true</code>ใ
             * ๅชๆๅธๅฑ่ฎพ็ฝฎไธบ VerticalLayoutใHorizontalLayout ๆ TileLayout ็ DataGroup ๆๆฏๆ่ๆๅธๅฑใ
             * ไธๆฏๆ่ๆๅ็ๅธๅฑๅญ็ฑปๅฟ้กป็ฆๆญขๆดๆนๆญคๅฑๆงใ
             *
             * @default false
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$useVirtualLayout;
            },
            set: function (value) {
                value = !!value;
                if (this.$useVirtualLayout == value)
                    return;
                this.$useVirtualLayout = value;
                this.dispatchEventWith("useVirtualLayoutChanged");
                if (this.$useVirtualLayout && !value)
                    this.clearVirtualLayoutCache();
                if (this.target)
                    this.target.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Set this size of a typical element
         *
         * @param width the height of element
         * @param height the width of element
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎไธไธชๅธๅๅ็ด็ๅคงๅฐ
         *
         * @param width ๅ็ด็ๅฎฝ
         * @param height ๅ็ด็้ซ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.setTypicalSize = function (width, height) {
            width = +width || 71;
            height = +height || 22;
            if (width !== this.$typicalWidth || height !== this.$typicalHeight) {
                this.$typicalWidth = width;
                this.$typicalHeight = height;
                if (this.$target) {
                    this.$target.invalidateSize();
                }
            }
        };
        /**
         * Called when the <code>verticalScrollPosition</code> or
         * <code>horizontalScrollPosition</code> properties change.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * <code>verticalScrollPosition</code> ๆ <code>horizontalScrollPosition</code>
         * ๅฑๆงๆดๆนๆถ่ฐ็จใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.scrollPositionChanged = function () {
        };
        /**
         * When <code>useVirtualLayout</code> is <code>true</code>,
         * this method can be used by the layout target
         * to clear cached layout information when the target changes.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆ <code>useVirtualLayout</code> ไธบ <code>true</code>๏ผ
         * ๅๅฝๅธๅฑ็ฎๆๆนๅๆถ๏ผๅธๅฑ็ฎๆๅฏไปฅไฝฟ็จๆญคๆนๆณๆฅๆธ้คๅทฒ็ผๅญๅธๅฑไฟกๆฏใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.clearVirtualLayoutCache = function () {
        };
        /**
         * Called by the target after a layout element
         * has been added and before the target's size and display list are
         * validated.
         * Layouts that cache per element state, like virtual layouts, can
         * override this method to update their cache.
         *
         * @param index The index of the element that was added.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅทฒๆทปๅๅธๅฑๅ็ดไนๅไธๅจ้ช่ฏ็ฎๆ็ๅคงๅฐๅๆพ็คบๅ่กจไนๅ๏ผ็ฑ็ฎๆ่ฐ็จใ
         * ๆๅ็ด็ถๆ็ผๅญ็ๅธๅฑ๏ผๆฏๅฆ่ๆๅธๅฑ๏ผๅฏไปฅ่ฆ็ๆญคๆนๆณไปฅๆดๆฐๅถ็ผๅญใ
         *
         * @param index ๅ็ๆนๅ็ๅญ้กน็ดขๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.elementAdded = function (index) {
        };
        /**
         * This method must is called by the target after a layout element
         * has been removed and before the target's size and display list are
         * validated.
         * Layouts that cache per element state, like virtual layouts, can
         * override this method to update their cache.
         *
         * @param index The index of the element that was added.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         *
         * ๅฟ้กปๅจๅทฒๅ้คๅธๅฑๅ็ดไนๅไธๅจ้ช่ฏ็ฎๆ็ๅคงๅฐๅๆพ็คบๅ่กจไนๅ๏ผ็ฑ็ฎๆ่ฐ็จๆญคๆนๆณใ
         * ๆๅ็ด็ถๆ็ผๅญ็ๅธๅฑ๏ผๆฏๅฆ่ๆๅธๅฑ๏ผๅฏไปฅ่ฆ็ๆญคๆนๆณไปฅๆดๆฐๅถ็ผๅญใ
         *
         * @param index ๅ็ๆนๅ็ๅญ้กน็ดขๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.elementRemoved = function (index) {
        };
        /**
         * Return the indices of the element visible within this Group.
         *
         * @return The indices of the visible element.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๆญค Group ไธญๅฏ่ง็ๅ็ด็็ดขๅผใ
         *
         * @return ๅฏ่ง็ๅ็ด็็ดขๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.getElementIndicesInView = function () {
            return null;
        };
        /**
         * Measures the target's default size based on its content.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅบไบ็ฎๆ็ๅๅฎนๆต้ๅถ้ป่ฎคๅคงๅฐ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.measure = function () {
        };
        /**
         * Sizes and positions the target's elements.
         *
         * @param unscaledWidth Specifies the width of the target, in pixels,
         * in the targets's coordinates.
         *
         * @param unscaledHeight Specifies the height of the component, in pixels,
         * in the target's coordinates.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฐๆด็ฎๆ็ๅ็ด็ๅคงๅฐๅนถๅฎไฝ่ฟไบๅ็ดใ
         *
         * @param unscaledWidth ๆๅฎ็ฎๆๅจ็ฎๆๅๆไธญ็ๅฎฝๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         * @param unscaledHeight ๆๅฎ็ปไปถๅจ็ฎๆๅๆไธญ็้ซๅบฆ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LayoutBase.prototype.updateDisplayList = function (width, height) {
        };
        return LayoutBase;
    }(egret.EventDispatcher));
    eui.LayoutBase = LayoutBase;
    __reflect(LayoutBase.prototype, "eui.LayoutBase");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ListBase class is the base class for list component.
     * It can display items of list as vertical or horizontal such as SELECT of HTML.
     * @event egret.Event.CHANGE Dispatched after the selection has changed.
     * This event is dispatched when the user interacts with the control.
     * @event egret.Event.CHANGING Dispatched when the selection is going to change.
     * Calling the <code>preventDefault()</code> method
     * on the event prevents the selection from changing.<p/>
     * This event is dispatched when the user interacts with the control.
     *
     * @event eui.ItemTapEvent.ITEM_TAP dispatched when the user tap an item in the control.
     * @event egret.TouchEvent.TOUCH_CANCEL canceled the touch
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ListBase ๆฏๅ่กจๆงไปถๅบ็ฑปใๅฏๆพ็คบๅ็ดๆๆฐดๅนณ็้กน็ฎๅ่กจใๅถๅ่ฝไธ HTML ไธญ็ SELECT ่กจๅๅ็ด็ๅ่ฝ็ธไผผใ
     * @event egret.Event.CHANGE ้ไธญ็็ดขๅผๅทฒ็ปๅ็ๆนๅ,ๆณจๆ๏ผๆญคไบไปถไปๅจ็ดขๅผๆนๅๆฏ็ฑ็จๆท่งฆๆธๆไฝๅผ่ตทๆถๆๆๅบใ
     * @event egret.Event.CHANGING ้ไธญ็็ดขๅผๅณๅฐๅ็ๆนๅ๏ผๅฏไปฅ้่ฟ่ฐ็จไบไปถๅฏน่ฑก็ preventDefault() ๆนๆณๆฅ้ปๆญขๆนๅใ<p/>
     * ๆณจๆ๏ผๆญคไบไปถไปๅจ็ดขๅผๆนๅๆฏ็ฑ็จๆท่งฆๆธๆไฝๅผ่ตทๆถๆๆๅบใ
     *
     * @event eui.ItemTapEvent.ITEM_TAP ้กนๅ็คบๅจๅๅปไบไปถใ
     * @event egret.TouchEvent.TOUCH_CANCEL ๅๆถ่งฆๆธไบไปถ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var ListBase = (function (_super) {
        __extends(ListBase, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ListBase() {
            var _this = _super.call(this) || this;
            _this.$ListBase = {
                0: false,
                1: false,
                2: -2,
                3: -1,
                4: false,
                5: undefined,
                6: false,
                7: null,
                8: false //touchCancle
            };
            return _this;
        }
        Object.defineProperty(ListBase.prototype, "requireSelection", {
            /**
             * If <code>true</code>, a data item must always be selected in the control.
             * If the value is <code>true</code>, the <code>selectedIndex</code> property
             * is always set to a value between 0 and (<code>dataProvider.length</code> - 1).
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆไธบ true๏ผๅๆงไปถไธญๅฟ้กปๅซๆ้ไธญ็ๆฐๆฎ้กน็ฎใ
             * ๅฆๆ่ฏฅๅผไธบ true๏ผๅๅง็ปๅฐ selectedIndex ๅฑๆง่ฎพ็ฝฎไธบ 0 ๅ (dataProvider.length - 1) ไน้ด็ไธไธชๅผใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$ListBase[0 /* requireSelection */];
            },
            set: function (value) {
                value = !!value;
                var values = this.$ListBase;
                if (value === values[0 /* requireSelection */]) {
                    return;
                }
                values[0 /* requireSelection */] = value;
                if (value) {
                    values[1 /* requireSelectionChanged */] = true;
                    this.invalidateProperties();
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ListBase.prototype, "selectedIndex", {
            /**
             * he 0-based index of the selected item, or -1 if no item is selected.
             * Setting the <code>selectedIndex</code> property deselects the currently selected
             * item and selects the data item at the specified index.<p/>
             *
             * The value is always between -1 and (<code>dataProvider.length</code> - 1).
             * If items at a lower index than <code>selectedIndex</code> are
             * removed from the component, the selected index is adjusted downward
             * accordingly. <p/>
             *
             * If the selected item is removed, the selected index is set to:<p/>
             *
             * <ul>
             *   <li>-1 if <code>requireSelection == false</code> or there are no remaining items.</li>
             *   <li>0 if <code>requireSelection == true</code> and there is at least one item.</li>
             * </ul><p/>
             *
             * When the user changes the <code>selectedIndex</code> property by interacting with the control,
             * the control dispatches the <code>change</code> and <code>changing</code> events.
             * When you change the value of the <code>selectedIndex</code> property programmatically,
             * it does not dispatches the <code>change</code> and <code>changing</code> events.</p>
             *
             * @default -1
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ้ไธญ้กน็ฎ็ๅบไบ 0 ็็ดขๅผใ
             * ๆ่ๅฆๆๆช้ไธญ้กน็ฎ๏ผๅไธบ-1ใ่ฎพ็ฝฎ selectedIndex ๅฑๆงไผๅๆถ้ๆฉๅฝๅ้ๅฎ็้กน็ฎๅนถ้ๆฉๆๅฎ็ดขๅผไฝ็ฝฎ็ๆฐๆฎ้กน็ฎใ<p/>
             *
             * ่ฟไธชๅผไผไนไธญๅจ-1ๅฐ<code>(dataProvider.length - 1)</code>ไน้ดใๅฆๆไป่ฏฅ็ปไปถไธญๅ้คไธไธชไฝไบ
             * <code>selectedIndex</code>็ๅผ๏ผๅ<code>selectedIndex</code>ไนไผ็ธๅบ็่ฐ่้ๅฎ็็ดขๅผใ<p/>
             *
             * ๅฆๆๅ้ค็้กนไธบๅฝๅ้ไธญ้กน๏ผๅ่ฏฅๅผไผๅไธบ๏ผ<p/>
             *
             * <ul>
             *    <li>-1: ๅฆๆ <code>requireSelection == false</code> ๆ่ๅทฒ็ปๆฒกๆๅฉไฝ้กน็ฎใ</li>
             *    <li> 0: ๅฆๆ <code>requireSelection == true</code> ๅนถไธๅฝๅ่ณๅฐ่ฟๆไธไธชๅฉไฝ้กน็ฎใ</li>
             * </ul><p/>
             * ๅฝ็จๆท้่ฟไธๆงไปถไบคไบๆฅๆดๆน selectedIndex ๅฑๆงๆถ๏ผๆญคๆงไปถๅฐๅๆดพ change ๅ changing ไบไปถใ
             * ๅฝไปฅ็ผ็จๆนๅผๆดๆน selectedIndex ๅฑๆง็ๅผๆถ๏ผๆญคๆงไปถไธๅๆดพ change ๅ changing ไบไปถใ
             *
             * @default -1
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$getSelectedIndex();
            },
            set: function (value) {
                value = +value | 0;
                this.setSelectedIndex(value, false);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @returns
         */
        ListBase.prototype.$getSelectedIndex = function () {
            var values = this.$ListBase;
            if (values[2 /* proposedSelectedIndex */] != ListBase.NO_PROPOSED_SELECTION)
                return values[2 /* proposedSelectedIndex */];
            return values[3 /* selectedIndex */];
        };
        /**
         * Used internally to specify whether the selectedIndex changed programmatically or due to
         * user interaction.
         * @param value the new index need to select.
         * @param dispatchChangeEvent if true, the component will dispatch a "change" event if the
         * value has changed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฑ็จๅบๆ่็จๆท่ฎพ็ฝฎ้ไธญ้กนใ
         * @param value ็ดขๅผๅผใ
         * @param dispatchChangeEvent ๅฝ็ดขๅผๅผๅ็ๆนๅ๏ผไธ่ฏฅๅๆฐไธบtrue็ๆถๅ๏ผ็ปไปถๆดพๅๅบไธไธชโchangeโไบไปถใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.setSelectedIndex = function (value, dispatchChangeEvent) {
            if (value == this.selectedIndex) {
                return;
            }
            var values = this.$ListBase;
            if (dispatchChangeEvent)
                values[4 /* dispatchChangeAfterSelection */] =
                    (values[4 /* dispatchChangeAfterSelection */] || dispatchChangeEvent);
            values[2 /* proposedSelectedIndex */] = value;
            this.invalidateProperties();
        };
        Object.defineProperty(ListBase.prototype, "selectedItem", {
            /**
             * The item that is currently selected.
             * Setting this property deselects the currently selected
             * item and selects the newly specified item.<p/>
             *
             * Setting <code>selectedItem</code> to an item that is not
             * in this component results in no selection,
             * and <code>selectedItem</code> being set to <code>undefined</code>.<p/>
             *
             * If the selected item is removed, the selected item is set to:<p/>
             * <ul>
             *   <li><code>undefined</code> if <code>requireSelection == false</code>
             *     or there are no remaining items.</li>
             *   <li>The first item if <code>requireSelection</code> = <code>true</code>
             *     and there is at least one item.</li>
             * </ul><p/>
             *
             * When the user changes the <code>selectedItem</code> property by interacting with the control,
             * the control dispatches the <code>change</code> and <code>changing</code> events.
             * When you change the value of the <code>selectedIndex</code> property programmatically,
             * it does not dispatches the <code>change</code> and <code>changing</code> events.</p>
             *
             * @default undefined
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝๅๅทฒ้ไธญ็้กน็ฎใ่ฎพ็ฝฎๆญคๅฑๆงไผๅๆถ้ไธญๅฝๅ้ๅฎ็้กน็ฎๅนถ้ๆฉๆฐๆๅฎ็้กน็ฎใ<p/>
             *
             * ๅฆๆ่ฎพ็ฝฎ็<code>selectedItem</code>ไธๅจๅฝๅๅ่กจ้้ฃไน<code>selectedItem</code>ๅฐ่ขซ่ฎพ็ฝฎ
             * ไธบ<code>undefined</code>ใ<p/>
             *
             * ๅฆๆ้ๆฉ้กน็ฎ่ขซ็งป้ค๏ผ้ฃ้ๆฉ้กนไผ่ขซ่ฎพ็ฝฎไธบ๏ผ<p/>
             * <ul>
             *   <li><code>undefined</code>: ๅฆๆ <code>requireSelection == false</code>
             *     ๆ่ๅทฒ็ปๆฒกๆๅฉไฝ้กนใ</li>
             *   <li>็ฌฌไธ้กน: ๅฝ <code>requireSelection == true</code>
             *     ๅนถไธๅ่กจไธญ่ฟ่ณๅฐๅญๆไธ้กน.</li>
             * </ul><p/>
             *
             * ๅฝ็จๆท้่ฟไธๆงไปถไบคไบๆฅๆดๆน selectedItem ๅฑๆงๆถ๏ผๆญคๆงไปถๅฐๅๆดพ change ๅ changing ไบไปถใ
             * ๅฝไปฅ็ผ็จๆนๅผๆดๆน selectedItem ๅฑๆง็ๅผๆถ๏ผๆญคๆงไปถไธๅๆดพ change ๅ changing ไบไปถใ<p/>
             *
             * @default undefined
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var values = this.$ListBase;
                if (values[5 /* pendingSelectedItem */] !== undefined)
                    return values[5 /* pendingSelectedItem */];
                var selectedIndex = this.$getSelectedIndex();
                if (selectedIndex == ListBase.NO_SELECTION || this.$dataProvider == null)
                    return undefined;
                return this.$dataProvider.length > selectedIndex ? this.$dataProvider.getItemAt(selectedIndex) : undefined;
            },
            set: function (value) {
                this.setSelectedItem(value, false);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Used internally to specify whether the selectedItem changed programmatically or due to
         * user interaction.
         * @param value the new item need to select.
         * @param dispatchChangeEvent if true, the component will dispatch a "change" event if the
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฑ็จๅบๆ็จๆท่ฎพ็ฝฎ้ไธญ้กนๆฐๆฎๆบใ
         * @param value ่ฆ้ไธญ็้กนใ
         * @param dispatchChangeEvent ๅฝ็ดขๅผๅผๅ็ๆนๅ๏ผไธ่ฏฅๅๆฐไธบtrue็ๆถๅ๏ผ็ปไปถๆดพๅๅบไธไธชโchangeโไบไปถใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.setSelectedItem = function (value, dispatchChangeEvent) {
            if (dispatchChangeEvent === void 0) {
                dispatchChangeEvent = false;
            }
            if (this.selectedItem === value)
                return;
            var values = this.$ListBase;
            if (dispatchChangeEvent)
                values[4 /* dispatchChangeAfterSelection */] =
                    (values[4 /* dispatchChangeAfterSelection */] || dispatchChangeEvent);
            values[5 /* pendingSelectedItem */] = value;
            this.invalidateProperties();
        };
        /**
         * Processes the properties set on the component.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅค็ๅฏน็ปไปถ่ฎพ็ฝฎ็ๅฑๆง
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.commitProperties = function () {
            var dataProviderChanged = this.$dataProviderChanged;
            _super.prototype.commitProperties.call(this);
            var values = this.$ListBase;
            var selectedIndex = this.$getSelectedIndex();
            var dataProvider = this.$dataProvider;
            if (dataProviderChanged) {
                if (selectedIndex >= 0 && dataProvider && selectedIndex < dataProvider.length)
                    this.itemSelected(selectedIndex, true);
                else if (this.requireSelection)
                    values[2 /* proposedSelectedIndex */] = 0;
                else
                    this.setSelectedIndex(-1, false);
            }
            if (values[1 /* requireSelectionChanged */]) {
                values[1 /* requireSelectionChanged */] = false;
                if (values[0 /* requireSelection */] &&
                    selectedIndex == ListBase.NO_SELECTION &&
                    dataProvider &&
                    dataProvider.length > 0) {
                    values[2 /* proposedSelectedIndex */] = 0;
                }
            }
            if (values[5 /* pendingSelectedItem */] !== undefined) {
                if (dataProvider)
                    values[2 /* proposedSelectedIndex */] =
                        dataProvider.getItemIndex(values[5 /* pendingSelectedItem */]);
                else
                    values[2 /* proposedSelectedIndex */] = ListBase.NO_SELECTION;
                values[5 /* pendingSelectedItem */] = undefined;
            }
            var changedSelection = false;
            if (values[2 /* proposedSelectedIndex */] != ListBase.NO_PROPOSED_SELECTION)
                changedSelection = this.commitSelection();
            if (values[6 /* selectedIndexAdjusted */]) {
                values[6 /* selectedIndexAdjusted */] = false;
                if (!changedSelection) {
                    eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedIndex");
                }
            }
        };
        /**
         * Updates an item renderer for use or reuse.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆฐ้กนๅ็คบๅจ๏ผไปฅๅคไฝฟ็จๆ้็จ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.updateRenderer = function (renderer, itemIndex, data) {
            this.itemSelected(itemIndex, this.$isItemIndexSelected(itemIndex));
            return _super.prototype.updateRenderer.call(this, renderer, itemIndex, data);
        };
        /**
         * Called when an item is selected or deselected.
         * Subclasses must override this method to display the selection.
         * @param index The item index that was selected.
         * @param selected <code>true</code> if the item is selected,
         * and <code>false</code> if it is deselected.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ไธญๆๅๆถ้ไธญ้กน็ฎๆถ่ฐ็จใๅญ็ฑปๅฟ้กป่ฆ็ๆญคๆนๆณๆๅฏ่ฎพ็ฝฎ้ไธญ้กนใ
         * @param index ๅทฒ้ไธญ็้กน็ฎ็ดขๅผใ
         * @param selected <code>true</code>ไธบ้ไธญ๏ผ<code>false</code>ๅๆถ้ไธญ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.itemSelected = function (index, selected) {
            var renderer = this.$indexToRenderer[index];
            if (renderer) {
                renderer.selected = selected;
            }
        };
        /**
         * @private
         * ่ฟๅๆๅฎ็ดขๅผๆฏๅฆ็ญไบๅฝๅ้ไธญ็ดขๅผ
         */
        ListBase.prototype.$isItemIndexSelected = function (index) {
            return index == this.selectedIndex;
        };
        /**
         * The selection validation and commitment workhorse method.
         * Called to commit the pending selected index. This method dispatches
         * the "changing" event, and if the event is not cancelled,
         * commits the selection change and then dispatches the "change"
         * event.
         * @param dispatchChangedEvents if dispatch a "changed" event.
         * @return true if the selection was committed, or false if the selection
         * was cancelled.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆไบค้ไธญ้กนๅฑๆงใ่ฏฅๆนๆณไผๆดพๅไธไธชโchangingโไบไปถ๏ผๅฆๆ่ฏฅไบไปถๆฒกๆ่ขซ้ปๆญข๏ผ
         * ่ฏฅๆนๆณๅฐไผๆไบค้ๆฉ้กน็ๆนๆฎๅๆฐๆดพๅโchangeโไบไปถใ
         * @param dispatchChangedEvents ๆฏๅฆๆดพๅไธไธชโchangedโไบไปถใ
         * @return true ่กจ็คบๆไบคๆๅ, false่กจ็คบ่ขซๅๆถ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.commitSelection = function (dispatchChangedEvents) {
            if (dispatchChangedEvents === void 0) {
                dispatchChangedEvents = true;
            }
            var dataProvider = this.$dataProvider;
            var values = this.$ListBase;
            var maxIndex = dataProvider ? dataProvider.length - 1 : -1;
            var oldSelectedIndex = values[3 /* selectedIndex */];
            var tmpProposedIndex = values[2 /* proposedSelectedIndex */];
            if (tmpProposedIndex < ListBase.NO_SELECTION)
                tmpProposedIndex = ListBase.NO_SELECTION;
            if (tmpProposedIndex > maxIndex)
                tmpProposedIndex = maxIndex;
            if (values[0 /* requireSelection */] && tmpProposedIndex == ListBase.NO_SELECTION &&
                dataProvider && dataProvider.length > 0) {
                values[2 /* proposedSelectedIndex */] = ListBase.NO_PROPOSED_SELECTION;
                values[4 /* dispatchChangeAfterSelection */] = false;
                return false;
            }
            if (values[4 /* dispatchChangeAfterSelection */]) {
                var result = this.dispatchEventWith(egret.Event.CHANGING, false, true, true);
                if (!result) {
                    this.itemSelected(values[2 /* proposedSelectedIndex */], false);
                    values[2 /* proposedSelectedIndex */] = ListBase.NO_PROPOSED_SELECTION;
                    values[4 /* dispatchChangeAfterSelection */] = false;
                    return false;
                }
            }
            values[3 /* selectedIndex */] = tmpProposedIndex;
            values[2 /* proposedSelectedIndex */] = ListBase.NO_PROPOSED_SELECTION;
            if (oldSelectedIndex != ListBase.NO_SELECTION)
                this.itemSelected(oldSelectedIndex, false);
            if (values[3 /* selectedIndex */] != ListBase.NO_SELECTION)
                this.itemSelected(values[3 /* selectedIndex */], true);
            //ๅญ็ฑป่ฅ้่ฆ่ช่บซๆๅบChangeไบไปถ๏ผ่ไธๆฏๅจๆญคๅคๆๅบ๏ผๅฏไปฅ่ฎพ็ฝฎdispatchChangedEventsไธบfalse
            if (dispatchChangedEvents) {
                if (values[4 /* dispatchChangeAfterSelection */]) {
                    this.dispatchEventWith(egret.Event.CHANGE);
                    values[4 /* dispatchChangeAfterSelection */] = false;
                }
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedIndex");
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedItem");
            }
            return true;
        };
        /**
         * Adjusts the selected index to account for items being added to or
         * removed from this component.
         * It does not dispatch a <code>change</code> event because the change did not
         * occur as a direct result of user-interaction.  Moreover,
         * it does not dispatch a <code>changing</code> event
         * or allow the cancellation of the selection.
         * It also does not call the <code>itemSelected()</code> method,
         * since the same item is selected;
         * @param newIndex The new index.
         * @param add <code>true</code> if an item was added to the component,
         *  and <code>false</code> if an item was removed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไป่ฐๆด้ไธญ็ดขๅผๅผ่ไธๆดๆฐ้ไธญ้กน,ๅณๅจๆไบคๅฑๆง้ถๆฎตitemSelectedๆนๆณไธไผ่ขซ่ฐ็จ๏ผไนไธไผ่งฆๅchangingๅchangeไบไปถใ
         * @param newIndex ๆฐ็ดขๅผใ
         * @param add ๅฆๆๅทฒๅฐ้กน็ฎๆทปๅๅฐ็ปไปถ๏ผๅไธบ<code>true</code>๏ผๅฆๆๅทฒๅ้ค้กน็ฎ๏ผๅไธบ<code>false</code>ใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.adjustSelection = function (newIndex, add) {
            if (add === void 0) {
                add = false;
            }
            var values = this.$ListBase;
            if (values[2 /* proposedSelectedIndex */] != ListBase.NO_PROPOSED_SELECTION)
                values[2 /* proposedSelectedIndex */] = newIndex;
            else
                values[3 /* selectedIndex */] = newIndex;
            values[6 /* selectedIndexAdjusted */] = true;
            this.invalidateProperties();
        };
        /**
         * Called when an item has been added to this component. Selection
         * and caret related properties are adjusted accordingly.
         * @param item The item being added.
         * @param index The index of the item being added.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐๆฎ้กนๆทปๅ
         * @param item ่ขซๆทปๅ็้กนใ
         * @param index ่ขซๆทปๅ็้กน็็ดขๅผใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.itemAdded = function (item, index) {
            _super.prototype.itemAdded.call(this, item, index);
            var selectedIndex = this.$getSelectedIndex();
            if (selectedIndex == ListBase.NO_SELECTION) {
                if (this.$ListBase[0 /* requireSelection */])
                    this.adjustSelection(index, true);
            }
            else if (index <= selectedIndex) {
                this.adjustSelection(selectedIndex + 1, true);
            }
        };
        /**
         * Called when an item has been removed from this component.
         * Selection and caret related properties are adjusted
         * accordingly.
         * @param item The item being removed.
         * @param index The index of the item being removed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐๆฎ้กน็งป้ค
         * @param item ่ขซ็งป้ค็้กนใ
         * @param index ่ขซ็งป้ค็้กน็็ดขๅผใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.itemRemoved = function (item, index) {
            _super.prototype.itemRemoved.call(this, item, index);
            if (this.selectedIndex == ListBase.NO_SELECTION)
                return;
            var selectedIndex = this.$getSelectedIndex();
            if (index == selectedIndex) {
                if (this.requireSelection && this.$dataProvider && this.$dataProvider.length > 0) {
                    if (index == 0) {
                        this.$ListBase[2 /* proposedSelectedIndex */] = 0;
                        this.invalidateProperties();
                    }
                    else
                        this.setSelectedIndex(0, false);
                }
                else
                    this.adjustSelection(-1, false);
            }
            else if (index < selectedIndex) {
                this.adjustSelection(selectedIndex - 1, false);
            }
        };
        /**
         * Event Listener of source data changed.
         * @param The <code>egret.gui.CollectionEvent</code> object.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐๆฎๆบๆนๅไบไปถๅค็ใ
         * @param event ไบไปถ <code>egret.gui.CollectionEvent</code> ็ๅฏน่ฑกใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.onCollectionChange = function (event) {
            _super.prototype.onCollectionChange.call(this, event);
            if (event.kind == eui.CollectionEventKind.RESET) {
                if (this.$dataProvider.length == 0) {
                    this.setSelectedIndex(ListBase.NO_SELECTION, false);
                }
            }
            else if (event.kind == eui.CollectionEventKind.REFRESH) {
                this.dataProviderRefreshed();
            }
        };
        /**
         * Default response to dataProvider refresh events: clear the selection and caret.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐๆฎๆบๅทๆฐๆถ่งฆๅใๆญคๆนๆณไธไป็ปไปถๅค้จ่ฐ็จ๏ผไป็จไบ็ผๅ่ชๅฎไน็ปไปถๆถ๏ผๅญ็ฑป่ฆ็็ถ็ฑป็ๆญคๆนๆณ๏ผไปฅไพฟๅจๆฐๆฎๆบๅ็ๆนๅๆถ๏ผ่ชๅจๆง่กไธไบ้ขๅค็ๆนๆฎๆฐๆฎๅทๆฐ่งๅพ็ๆไฝใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.dataProviderRefreshed = function () {
            this.setSelectedIndex(ListBase.NO_SELECTION, false);
        };
        /**
         * Called when an item has been added to this component.
         * @param renderer the renderer being added.
         * @param index the index of renderer
         * @param item the data of renderer
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้กนๅ็คบๅจ่ขซๆทปๅ
         * @param renderer ๆทปๅ็้กนๅ็คบๅจ
         * @param index ้กนๅ็คบๅจ็็ดขๅผ
         * @param item ้กนๅ็คบๅจๅฏนๅบ็ๆฐๆฎ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.rendererAdded = function (renderer, index, item) {
            renderer.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onRendererTouchBegin, this);
            renderer.addEventListener(egret.TouchEvent.TOUCH_END, this.onRendererTouchEnd, this);
            renderer.addEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onRendererTouchCancle, this);
        };
        /**
         * Called when an item has been removed to this component.
         * @param renderer the renderer being removed.
         * @param index the index of renderer.
         * @param item the data of renderer.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้กนๅ็คบๅจ่ขซ็งป้ค
         * @param renderer ็งป้ค็้กนๅ็คบๅจ
         * @param index ้กนๅ็คบๅจ็็ดขๅผ
         * @param item ้กนๅ็คบๅจๅฏนๅบ็ๆฐๆฎ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.rendererRemoved = function (renderer, index, item) {
            renderer.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onRendererTouchBegin, this);
            renderer.removeEventListener(egret.TouchEvent.TOUCH_END, this.onRendererTouchEnd, this);
            renderer.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onRendererTouchCancle, this);
        };
        /**
         * Handles <code>egret.TouchEvent.TOUCH_BEGIN</code> events from any of the
         * item renderers. This method handles <code>egret.TouchEvent.TOUCH_END</code>.
         * @param event The <code>egret.TouchEvent</code> object.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไพฆๅฌ้กนๅ็คบๅจ<code>egret.TouchEvent.TOUCH_BEGIN</code>ไบไปถ็ๆนๆณใๅๆถไผๆทปๅๅฏน่ๅฐ<code>egret.TouchEvent.TOUCH_END</code>
         * ไบไปถ็ไพฆๅฌใ
         * @param event ไบไปถ<code>egret.TouchEvent</code>็ๅฏน่ฑกใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.onRendererTouchBegin = function (event) {
            var values = this.$ListBase;
            if (event.$isDefaultPrevented)
                return;
            values[8 /* touchCancle */] = false;
            values[7 /* touchDownItemRenderer */] = (event.$currentTarget);
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_END, this.stage_touchEndHandler, this);
        };
        /**
         * Handles <code>egret.TouchEvent.TOUCH_CANCEL</code> events from any of the
         * item renderers. This method will cancel the handles <code>egret.TouchEvent.TOUCH_END</code> and <code>egret.TouchEvent.TOUCH_TAP</code>.
         * @param event The <code>egret.TouchEvent</code> object.
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไพฆๅฌ้กนๅ็คบๅจ<code>egret.TouchEvent.TOUCH_CANCEL</code>ไบไปถ็ๆนๆณใ่งฆๅๆถไผๅๆถๅฏน่ๅฐ<code>egret.TouchEvent.TOUCH_END</code>
         * ๅ<code>egret.TouchEvent.TOUCH_TAP</code>ไบไปถ็ไพฆๅฌใ
         * @param event ไบไปถ<code>egret.TouchEvent</code>็ๅฏน่ฑกใ
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.onRendererTouchCancle = function (event) {
            var values = this.$ListBase;
            values[7 /* touchDownItemRenderer */] = null;
            values[8 /* touchCancle */] = true;
            if (this.$stage) {
                this.$stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.stage_touchEndHandler, this);
            }
        };
        /**
         * Handles <code>egret.TouchEvent.TOUCH_END</code> events and dispatch <code>ItemTapEvent.ITEM_TAP</code> event.
         * @param event The <code>egret.TouchEvent</code> object.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฆๆธๅจ้กนๅ็คบๅจไธ็ปๆ๏ผๆๅบ<code>ItemTapEvent.ITEM_TAP</code>ไบไปถใ
         * @param event ไบไปถ<code>egret.TouchEvent</code>็ๅฏน่ฑกใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.prototype.onRendererTouchEnd = function (event) {
            var values = this.$ListBase;
            var itemRenderer = (event.$currentTarget);
            var touchDownItemRenderer = values[7 /* touchDownItemRenderer */];
            if (itemRenderer != touchDownItemRenderer)
                return;
            if (!values[8 /* touchCancle */]) {
                this.setSelectedIndex(itemRenderer.itemIndex, true);
                eui.ItemTapEvent.dispatchItemTapEvent(this, eui.ItemTapEvent.ITEM_TAP, itemRenderer);
            }
            values[8 /* touchCancle */] = false;
        };
        /**
         * @private
         * ่งฆๆธๅจ่ๅฐไธ็ปๆ
         */
        ListBase.prototype.stage_touchEndHandler = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.stage_touchEndHandler, this);
            this.$ListBase[7 /* touchDownItemRenderer */] = null;
        };
        /**
         * Static constant representing the value "no selection".
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆช้ไธญไปปไฝ้กนๆถ็็ดขๅผๅผ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.NO_SELECTION = -1;
        /**
         * Static constant representing no proposed selection.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆช่ฎพ็ฝฎ็ผๅญ้ไธญ้กน็ๅผ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ListBase.NO_PROPOSED_SELECTION = -2;
        return ListBase;
    }(eui.DataGroup));
    eui.ListBase = ListBase;
    __reflect(ListBase.prototype, "eui.ListBase");
    eui.registerBindable(ListBase.prototype, "selectedIndex");
    eui.registerBindable(ListBase.prototype, "selectedItem");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ScrollBarBase class helps to position
     * the portion of data that is displayed when there is too much data
     * to fit in a display area.
     * The ScrollBarBase class displays a pair of viewport and a thumb.
     * viewport is a instance that implements IViewport.
     *
     * @see eui.IViewport
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * <code>ScrollBarBase</code> ๆปๅจๆกๅบ็ฑป๏ผ่ฏฅ็ฑปๅธฎๅฉๅจๅๆฐๆฎๅคชๅค่ไธ่ฝๅจๆพ็คบๅบๅๅฎๅจๆพ็คบๆถๅฎไฝๆพ็คบ็ๆฐๆฎ้จๅใ
     * ScrollBarBase ็ฑปๆพ็คบ่งๅบ็ไธ้จๅๅไธไธชๆ็คบๆปๅใ
     * ่งๅบๆฏไธไธชIViewportๆฅๅฃๅฎ็ฐ็ๅฎไพใ
     *
     * @see eui.IViewport
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var ScrollBarBase = (function (_super) {
        __extends(ScrollBarBase, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชScrollBarBaseๅฎไพใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ScrollBarBase() {
            var _this = _super.call(this) || this;
            /**
             * [SkinPart] Thumb display object.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart]ๆปๅๆพ็คบๅฏน่ฑกใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.thumb = null;
            /**
             * @private
             */
            _this.$viewport = null;
            /**
             * Whether the scrollbar can be autohide.
             * @version Egret 3.0.2
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฏๅฆ่ชๅจ้่ scrollbar
             * @version Egret 3.0.2
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.autoVisibility = true;
            return _this;
        }
        Object.defineProperty(ScrollBarBase.prototype, "viewport", {
            /**
             * The viewport controlled by this scrollbar.
             *
             * If a viewport is specified, then changes to its actual size, content
             * size, and scroll position cause the corresponding ScrollBarBase methods to
             * run:
             * <ul>
             *     <li><code>onViewportResize()</code></li>
             *     <li><code>onPropertyChanged()</code></li>
             * </ul><p/>
             *
             * The VScrollBar and HScrollBar classes override these methods to keep their properties in
             * sync with the viewport.
             *
             * @default null
             * @see eui.VScrollBar
             * @see eui.HScrollBar
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฑ่ฏฅๆปๅจๆกๆงๅถ็่งๅบใ
             *
             * ๅฆๆๆๅฎไบ่งๅบ๏ผๅๅฏนๅถๅฎ้ๅคงๅฐใๅๅฎนๅคงๅฐๅๆปๅจไฝ็ฝฎ็ๆดๆนไผๅฏผ่ด่ฟ่ก็ธๅฏนๅบ็ ScrollBarBase ๆนๆณ๏ผ
             * <ul>
             *     <li><code>onViewportResize()</code></li>
             *     <li><code>onPropertyChanged()</code></li>
             * </ul><p/>
             *
             * VScrollBar ๅ HScrollBar ็ฑป้่ฆ้ๅ่ฟไบๆนๆณไปฅไฟ่ฏๅฑๆงไธ่งๅบ็ๅๆญฅใ
             *
             * @default null
             * @see eui.VScrollBar
             * @see eui.HScrollBar
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$viewport;
            },
            set: function (value) {
                if (value == this.$viewport) {
                    return;
                }
                var viewport = this.$viewport;
                if (viewport) {
                    viewport.removeEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.onPropertyChanged, this);
                    viewport.removeEventListener(egret.Event.RESIZE, this.onViewportResize, this);
                }
                this.$viewport = value;
                if (value) {
                    value.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.onPropertyChanged, this);
                    value.addEventListener(egret.Event.RESIZE, this.onViewportResize, this);
                }
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param event
         */
        ScrollBarBase.prototype.onViewportResize = function (event) {
            this.invalidateDisplayList();
        };
        /**
         * Properties of viewport changed.
         * @param event
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งๅบๅฑๆงๅ็ๆนๅใ
         * @param event
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ScrollBarBase.prototype.onPropertyChanged = function (event) {
        };
        return ScrollBarBase;
    }(eui.Component));
    eui.ScrollBarBase = ScrollBarBase;
    __reflect(ScrollBarBase.prototype, "eui.ScrollBarBase");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The SliderBase class lets users select a value by moving a slider thumb between
     * the end points of the slider track.
     * The current value of the slider is determined by the relative location of
     * the thumb between the end points of the slider,
     * corresponding to the slider's minimum and maximum values.
     * The SliderBase class is a base class for HSlider and VSlider.
     *
     * @event eui.UIEvent.CHANGE_START Dispatched when the scroll position is going to change
     * @event eui.UIEvent.CHANGE_END Dispatched when the scroll position changed complete
     * @event egret.Event.CHANGE Dispatched when the scroll position is changing
     *
     * @see eui.HSlider
     * @see eui.VSlider
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๆปๅๆงไปถๅบ็ฑป๏ผ้่ฟไฝฟ็จ SliderBase ็ฑป๏ผ็จๆทๅฏไปฅๅจๆปๅ่ฝจ้็็ซฏ็นไน้ด็งปๅจๆปๅๆฅ้ๆฉๅผใ
     * ๆปๅ็ๅฝๅๅผ็ฑๆปๅ็ซฏ็น๏ผๅฏนๅบไบๆปๅ็ๆๅฐๅผๅๆๅคงๅผ๏ผไน้ดๆปๅ็็ธๅฏนไฝ็ฝฎ็กฎๅฎใ
     * SliderBase ็ฑปๆฏ HSlider ๅ VSlider ็ๅบ็ฑปใ
     *
     * @event eui.UIEvent.CHANGE_START ๆปๅจไฝ็ฝฎๆนๅๅผๅง
     * @event eui.UIEvent.CHANGE_END ๆปๅจไฝ็ฝฎๆนๅ็ปๆ
     * @event egret.Event.CHANGE ๆปๅจไฝ็ฝฎๆนๅ็ๆถๅ
     *
     * @see eui.HSlider
     * @see eui.VSlider
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var SliderBase = (function (_super) {
        __extends(SliderBase, _super);
        /**
         * Constructor
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช SliderBase ๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function SliderBase() {
            var _this = _super.call(this) || this;
            /**
             * [SkinPart] Highlight of track.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart] ่ฝจ้้ซไบฎๆพ็คบๅฏน่ฑกใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.trackHighlight = null;
            /**
             * [SkinPart] Thumb display object.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart]ๆปๅๆพ็คบๅฏน่ฑกใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.thumb = null;
            /**
             * [SkinPart] Track display object.
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * [SkinPart]่ฝจ้ๆพ็คบๅฏน่ฑกใ
             * @skinPart
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.track = null;
            _this.$SliderBase = {
                0: 0,
                1: 0,
                2: 0,
                3: 0,
                4: null,
                5: null,
                6: 300,
                7: 0,
                8: 0,
                9: true,
            };
            _this.maximum = 10;
            _this.addEventListener(egret.TouchEvent.TOUCH_BEGIN, _this.onTouchBegin, _this);
            return _this;
        }
        Object.defineProperty(SliderBase.prototype, "slideDuration", {
            /**
             * Duration in milliseconds for the sliding animation when you tap on the track to move a thumb.
             *
             * @default 300
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅจ่ฝจ้ไธๅๅปไปฅ็งปๅจๆปๅๆถ๏ผๆปๅจๅจ็ปๆ็ปญ็ๆถ้ด๏ผไปฅๆฏซ็งไธบๅไฝ๏ผใ่ฎพ็ฝฎไธบ0ๅฐไธๆง่ก็ผๅจใ
             *
             * @default 300
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$SliderBase[6 /* slideDuration */];
            },
            set: function (value) {
                this.$SliderBase[6 /* slideDuration */] = +value || 0;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Converts a track-relative x,y pixel location into a value between
         * the minimum and maximum, inclusive.
         *
         * @param x The x coordinate of the location relative to the track's origin.
         * @param y The y coordinate of the location relative to the track's origin.
         * @return A value between the minimum and maximum, inclusive.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐ็ธๅฏนไบ่ฝจ้็ x,y ๅ็ดไฝ็ฝฎ่ฝฌๆขไธบไปไบๆๅฐๅผๅๆๅคงๅผ๏ผๅๆฌไธค่๏ผไน้ด็ไธไธชๅผใ
         *
         * @param x ็ธๅฏนไบ่ฝจ้ๅ็น็ไฝ็ฝฎ็xๅๆใ
         * @param y ็ธๅฏนไบ่ฝจ้ๅ็น็ไฝ็ฝฎ็yๅๆใ
         * @return ไปไบๆๅฐๅผๅๆๅคงๅผ๏ผๅๆฌไธค่๏ผไน้ด็ไธไธชๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        SliderBase.prototype.pointToValue = function (x, y) {
            return this.minimum;
        };
        Object.defineProperty(SliderBase.prototype, "liveDragging", {
            /**
             * Specifies whether live dragging is enabled for the slider. If true, sets the value
             * and values properties and dispatches the change event continuously as
             * the user moves the thumb.
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆไธบ true๏ผๅๅฐๅจๆฒฟ็่ฝจ้ๆๅจๆปๅๆถ๏ผ่ไธๆฏๅจ้ๆพๆปๅๆ้ฎๆถ๏ผๆไบคๆญคๆปๅ็ๅผใ
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$SliderBase[9 /* liveDragging */];
            },
            set: function (value) {
                this.$SliderBase[9 /* liveDragging */] = !!value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(SliderBase.prototype, "pendingValue", {
            /**
             * The value the slider will have when the touch is end.
             * This property is updated when the slider thumb moves, even if <code>liveDragging</code> is false.<p/>
             * If the <code>liveDragging</code> style is false, then the slider's value is only set
             * when the touch is end.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งฆๆธ็ปๆๆถๆปๅๅฐๅทๆ็ๅผใ
             * ๆ่ฎบ liveDragging ๆฏๅฆไธบ true๏ผๅจๆปๅๆๅจๆ้ดๅง็ปๆดๆฐๆญคๅฑๆงใ
             * ่ value ๅฑๆงๅจๅฝ liveDragging ไธบ false ๆถ๏ผๅชๅจ่งฆๆธ้ๆพๆถๆดๆฐไธๆฌกใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$SliderBase[7 /* pendingValue */];
            },
            set: function (value) {
                value = +value || 0;
                var values = this.$SliderBase;
                if (value === values[7 /* pendingValue */])
                    return;
                values[7 /* pendingValue */] = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        SliderBase.prototype.setValue = function (value) {
            this.$SliderBase[7 /* pendingValue */] = value;
            _super.prototype.setValue.call(this, value);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        SliderBase.prototype.partAdded = function (partName, instance) {
            _super.prototype.partAdded.call(this, partName, instance);
            if (instance == this.thumb) {
                this.thumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onThumbTouchBegin, this);
                this.thumb.addEventListener(egret.Event.RESIZE, this.onTrackOrThumbResize, this);
            }
            else if (instance == this.track) {
                this.track.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTrackTouchBegin, this);
                this.track.addEventListener(egret.Event.RESIZE, this.onTrackOrThumbResize, this);
            }
            else if (instance === this.trackHighlight) {
                this.trackHighlight.touchEnabled = false;
                if (egret.is(this.trackHighlight, "egret.DisplayObjectContainer")) {
                    this.trackHighlight.touchChildren = false;
                }
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        SliderBase.prototype.partRemoved = function (partName, instance) {
            _super.prototype.partRemoved.call(this, partName, instance);
            if (instance == this.thumb) {
                this.thumb.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onThumbTouchBegin, this);
                this.thumb.removeEventListener(egret.Event.RESIZE, this.onTrackOrThumbResize, this);
            }
            else if (instance == this.track) {
                this.track.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTrackTouchBegin, this);
                this.track.removeEventListener(egret.Event.RESIZE, this.onTrackOrThumbResize, this);
            }
        };
        /**
         * @private
         * ๆปๅๆ่ฝจ้ๅฐบๅฏธๆนๅไบไปถ
         */
        SliderBase.prototype.onTrackOrThumbResize = function (event) {
            this.updateSkinDisplayList();
        };
        /**
         * Handle touch-begin events on the scroll thumb. Records the touch begin point in clickOffset.
         *
         * @param The <code>egret.TouchEvent</code> object.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆปๅ่งฆๆธๅผๅงไบไปถ๏ผ่ฎฐๅฝ่งฆ็ขฐๅผๅง็ๅๆๅ็งป้ใ
         *
         * @param event ไบไปถ <code>egret.TouchEvent</code> ็ๅฏน่ฑก.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        SliderBase.prototype.onThumbTouchBegin = function (event) {
            var values = this.$SliderBase;
            if (values[5 /* animation */] && values[5 /* animation */].isPlaying)
                this.stopAnimation();
            var stage = this.$stage;
            stage.addEventListener(egret.TouchEvent.TOUCH_MOVE, this.onStageTouchMove, this);
            stage.addEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            var clickOffset = this.thumb.globalToLocal(event.stageX, event.stageY, egret.$TempPoint);
            values[0 /* clickOffsetX */] = clickOffset.x;
            values[1 /* clickOffsetY */] = clickOffset.y;
            eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_START);
        };
        /**
         * @private
         * ่ๅฐไธ่งฆๆธ็งปๅจไบไปถ
         */
        SliderBase.prototype.onStageTouchMove = function (event) {
            var values = this.$SliderBase;
            values[2 /* moveStageX */] = event.$stageX;
            values[3 /* moveStageY */] = event.$stageY;
            var track = this.track;
            if (!track)
                return;
            var p = track.globalToLocal(values[2 /* moveStageX */], values[3 /* moveStageY */], egret.$TempPoint);
            var newValue = this.pointToValue(p.x - values[0 /* clickOffsetX */], p.y - values[1 /* clickOffsetY */]);
            newValue = this.nearestValidValue(newValue, this.snapInterval);
            this.updateWhenTouchMove(newValue);
            event.updateAfterEvent();
        };
        /**
         * Capture touch-move events anywhere on or off the stage.
         * @param newValue new value
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ๅฌ่ๅฐ็่งฆ็ขฐ็งปๅจไบไปถใ
         * @param newValue ๆฐ็ๅผ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        SliderBase.prototype.updateWhenTouchMove = function (newValue) {
            if (newValue != this.$SliderBase[7 /* pendingValue */]) {
                if (this.liveDragging) {
                    this.setValue(newValue);
                    this.dispatchEventWith(egret.Event.CHANGE);
                }
                else {
                    this.pendingValue = newValue;
                }
            }
        };
        /**
         * Handle touch-end events anywhere on or off the stage.
         *
         * @param The <code>egret.Event</code> object.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฆๆธ็ปๆไบไปถ
         *
         * @param event ไบไปถ <code>egret.Event</code> ็ๅฏน่ฑกใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        SliderBase.prototype.onStageTouchEnd = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE, this.onStageTouchMove, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
            var values = this.$SliderBase;
            if (!this.liveDragging && this.value != values[7 /* pendingValue */]) {
                this.setValue(values[7 /* pendingValue */]);
                this.dispatchEventWith(egret.Event.CHANGE);
            }
        };
        /**
         * @private
         * ๅฝๅจ็ปไปถไธๆไธๆถ่ฎฐๅฝ่ขซๆไธ็ๅญๆพ็คบๅฏน่ฑก
         */
        SliderBase.prototype.onTouchBegin = function (event) {
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_END, this.stageTouchEndHandler, this);
            this.$SliderBase[4 /* touchDownTarget */] = (event.$target);
        };
        /**
         * @private
         * ๅฝ็ปๆๆถ๏ผ่ฅไธๆฏๅจ touchDownTarget ไธๅผน่ตท๏ผ่ๆฏๅฆๅค็ๅญๆพ็คบๅฏน่ฑกไธๅผน่ตทๆถ๏ผ้ขๅคๆๅบไธไธช่งฆๆธๅๅปไบไปถใ
         */
        SliderBase.prototype.stageTouchEndHandler = function (event) {
            var target = event.$target;
            var values = this.$SliderBase;
            event.$currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END, this.stageTouchEndHandler, this);
            if (values[4 /* touchDownTarget */] != target && this.contains((target))) {
                egret.TouchEvent.dispatchTouchEvent(this, egret.TouchEvent.TOUCH_TAP, true, true, event.$stageX, event.$stageY, event.touchPointID);
            }
            values[4 /* touchDownTarget */] = null;
        };
        /**
         * @private
         * ๅจ็ปๆญๆพๆดๆฐๆฐๅผ
         */
        SliderBase.prototype.$animationUpdateHandler = function (animation) {
            this.pendingValue = animation.currentValue;
        };
        /**
         * @private
         * ๅจ็ปๆญๆพๅฎๆฏ
         */
        SliderBase.prototype.animationEndHandler = function (animation) {
            this.setValue(this.$SliderBase[8 /* slideToValue */]);
            this.dispatchEventWith(egret.Event.CHANGE);
            eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
        };
        /**
         * @private
         * ๅๆญขๆญๆพๅจ็ป
         */
        SliderBase.prototype.stopAnimation = function () {
            this.$SliderBase[5 /* animation */].stop();
            this.setValue(this.nearestValidValue(this.pendingValue, this.snapInterval));
            this.dispatchEventWith(egret.Event.CHANGE);
            eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
        };
        /**
         * Handle touch-begin events for the slider track. We
         * calculate the value based on the new position and then
         * move the thumb to the correct location as well as
         * commit the value.
         * @param The <code>egret.TouchEvent</code> object.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฝจ้็่งฆ็ขฐๅผๅงไบไปถใๆไปฌไผๅจ่ฟ้ๆนๆฎๆฐ็ๅๆไฝ็ฝฎ่ฎก็ฎvalue๏ผ็ถๅ็งปๅจๆปๅๅฐๅฝๅไฝ็ฝฎใ
         *
         * @param event ไบไปถ <code>egret.TouchEvent</code> ็ๅฏน่ฑก.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        SliderBase.prototype.onTrackTouchBegin = function (event) {
            var thumbW = this.thumb ? this.thumb.width : 0;
            var thumbH = this.thumb ? this.thumb.height : 0;
            var offsetX = event.$stageX - (thumbW / 2);
            var offsetY = event.$stageY - (thumbH / 2);
            var p = this.track.globalToLocal(offsetX, offsetY, egret.$TempPoint);
            var rangeValues = this.$Range;
            var newValue = this.pointToValue(p.x, p.y);
            newValue = this.nearestValidValue(newValue, rangeValues[7 /* snapInterval */]);
            var values = this.$SliderBase;
            if (newValue != values[7 /* pendingValue */]) {
                if (values[6 /* slideDuration */] != 0) {
                    if (!values[5 /* animation */]) {
                        values[5 /* animation */] = new eui.sys.Animation(this.$animationUpdateHandler, this);
                        values[5 /* animation */].endFunction = this.animationEndHandler;
                    }
                    var animation = values[5 /* animation */];
                    if (animation.isPlaying)
                        this.stopAnimation();
                    values[8 /* slideToValue */] = newValue;
                    animation.duration = values[6 /* slideDuration */] *
                        (Math.abs(values[7 /* pendingValue */] - values[8 /* slideToValue */]) / (rangeValues[0 /* maximum */] - rangeValues[2 /* minimum */]));
                    animation.from = values[7 /* pendingValue */];
                    animation.to = values[8 /* slideToValue */];
                    eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_START);
                    animation.play();
                }
                else {
                    this.setValue(newValue);
                    this.dispatchEventWith(egret.Event.CHANGE);
                }
            }
        };
        return SliderBase;
    }(eui.Range));
    eui.SliderBase = SliderBase;
    __reflect(SliderBase.prototype, "eui.SliderBase");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        var exmlParserPool = [];
        var parsedClasses = {};
        var innerClassCount = 1;
        var HOST_COMPONENT = "hostComponent";
        var SKIN_CLASS = "eui.Skin";
        var DECLARATIONS = "Declarations";
        var RECTANGLE = "egret.Rectangle";
        var TYPE_CLASS = "Class";
        var TYPE_ARRAY = "Array";
        var TYPE_PERCENTAGE = "Percentage";
        var TYPE_STATE = "State[]";
        var SKIN_NAME = "skinName";
        var ELEMENTS_CONTENT = "elementsContent";
        var basicTypes = [TYPE_ARRAY, "boolean", "string", "number"];
        var wingKeys = ["id", "locked", "includeIn", "excludeFrom"];
        var htmlEntities = [["<", "&lt;"], [">", "&gt;"], ["&", "&amp;"], ["\"", "&quot;"], ["'", "&apos;"]];
        var jsKeyWords = ["null", "NaN", "undefined", "true", "false"];
        /**
         * @private
         */
        var EXMLParser = (function () {
            /**
             * @private
             */
            function EXMLParser() {
                /**
                 * @private
                 * ๅปถ่ฟ่ตๅผๅญๅธ
                 */
                this.delayAssignmentDic = {};
                if (true) {
                    this.repeatedIdMap = {};
                    this.getRepeatedIds = getRepeatedIds;
                    this.getIds = getIds;
                    this.checkDeclarations = checkDeclarations;
                }
            }
            /**
             * @private
             * ๅฐๅทฒๆjavascriptไปฃ็ๆณจๅ
             * @param codeText ๆง่ก็javascriptไปฃ็
             * @param classStr ็ฑปๅ
             */
            EXMLParser.prototype.$parseCode = function (codeText, classStr) {
                //ไผๅฅ็ๆฏ็ผ่ฏๅ็jsๅญ็ฌฆไธฒ
                var className = classStr ? classStr : "$exmlClass" + innerClassCount++;
                var clazz = eval(codeText);
                var hasClass = true;
                if (hasClass && clazz) {
                    egret.registerClass(clazz, className);
                    var paths = className.split(".");
                    var length_15 = paths.length;
                    var definition = __global;
                    for (var i = 0; i < length_15 - 1; i++) {
                        var path = paths[i];
                        definition = definition[path] || (definition[path] = {});
                    }
                    if (definition[paths[length_15 - 1]]) {
                        if (true && !parsedClasses[className]) {
                            egret.$warn(2101, className, codeText);
                        }
                    }
                    else {
                        if (true) {
                            parsedClasses[className] = true;
                        }
                        definition[paths[length_15 - 1]] = clazz;
                    }
                }
                return clazz;
            };
            /**
             * @private
             * ็ผ่ฏๆๅฎ็XMLๅฏน่ฑกไธบJavaScriptไปฃ็ใ
             * @param xmlData ่ฆ็ผ่ฏ็EXMLๆไปถๅๅฎน
             *
             */
            EXMLParser.prototype.parse = function (text) {
                if (true) {
                    if (!text) {
                        egret.$error(1003, "text");
                    }
                }
                var xmlData = null;
                if (true) {
                    try {
                        xmlData = egret.XML.parse(text);
                    }
                    catch (e) {
                        egret.$error(2002, text + "\n" + e.message);
                    }
                }
                else {
                    xmlData = egret.XML.parse(text);
                }
                var hasClass = false;
                var className = "";
                if (xmlData.attributes["class"]) {
                    className = xmlData.attributes["class"];
                    delete xmlData.attributes["class"];
                    hasClass = !!className;
                }
                else {
                    className = "$exmlClass" + innerClassCount++;
                }
                var exClass = this.parseClass(xmlData, className);
                var code = exClass.toCode();
                var clazz = null;
                if (true) {
                    try {
                        clazz = eval(code);
                    }
                    catch (e) {
                        egret.log(code);
                        return null;
                    }
                }
                else {
                    clazz = eval(code);
                }
                if (hasClass && clazz) {
                    egret.registerClass(clazz, className);
                    var paths = className.split(".");
                    var length_16 = paths.length;
                    var definition = __global;
                    for (var i = 0; i < length_16 - 1; i++) {
                        var path = paths[i];
                        definition = definition[path] || (definition[path] = {});
                    }
                    if (definition[paths[length_16 - 1]]) {
                        if (true && !parsedClasses[className]) {
                            egret.$warn(2101, className, toXMLString(xmlData));
                        }
                    }
                    else {
                        if (true) {
                            parsedClasses[className] = true;
                        }
                        definition[paths[length_16 - 1]] = clazz;
                    }
                }
                return clazz;
            };
            /**
             * @private
             * ็ผ่ฏๆๅฎ็XMLๅฏน่ฑกไธบCpClassๅฏน่ฑกใ
             */
            EXMLParser.prototype.parseClass = function (xmlData, className) {
                if (!sys.exmlConfig) {
                    sys.exmlConfig = new sys.EXMLConfig();
                }
                this.currentXML = xmlData;
                this.currentClassName = className;
                this.delayAssignmentDic = {};
                this.idDic = {};
                this.stateCode = [];
                this.stateNames = [];
                this.skinParts = [];
                this.bindings = [];
                this.declarations = null;
                this.currentClass = new sys.EXClass();
                this.stateIds = [];
                var index = className.lastIndexOf(".");
                if (index != -1) {
                    this.currentClass.className = className.substring(index + 1);
                }
                else {
                    this.currentClass.className = className;
                }
                this.startCompile();
                var clazz = this.currentClass;
                this.currentClass = null;
                return clazz;
            };
            /**
             * @private
             * ๅผๅง็ผ่ฏ
             */
            EXMLParser.prototype.startCompile = function () {
                if (true) {
                    var result = this.getRepeatedIds(this.currentXML);
                    if (result.length > 0) {
                        egret.$error(2004, this.currentClassName, result.join("\n"));
                    }
                }
                var superClass = this.getClassNameOfNode(this.currentXML);
                this.isSkinClass = (superClass == SKIN_CLASS);
                this.currentClass.superClass = superClass;
                this.getStateNames();
                var children = this.currentXML.children;
                if (children) {
                    var length_17 = children.length;
                    for (var i = 0; i < length_17; i++) {
                        var node = children[i];
                        if (node.nodeType === 1 && node.namespace == sys.NS_W &&
                            node.localName == DECLARATIONS) {
                            this.declarations = node;
                            break;
                        }
                    }
                }
                if (true) {
                    var list = [];
                    this.checkDeclarations(this.declarations, list);
                    if (list.length > 0) {
                        egret.$error(2020, this.currentClassName, list.join("\n"));
                    }
                }
                if (!this.currentXML.namespace) {
                    if (true) {
                        egret.$error(2017, this.currentClassName, toXMLString(this.currentXML));
                    }
                    return;
                }
                this.addIds(this.currentXML.children);
                this.createConstructFunc();
            };
            /**
             * @private
             * ๆทปๅๅฟ้กป็id
             */
            EXMLParser.prototype.addIds = function (items) {
                if (!items) {
                    return;
                }
                var length = items.length;
                for (var i = 0; i < length; i++) {
                    var node = items[i];
                    if (node.nodeType != 1) {
                        continue;
                    }
                    if (!node.namespace) {
                        if (true) {
                            egret.$error(2017, this.currentClassName, toXMLString(node));
                        }
                        continue;
                    }
                    if (this.isInnerClass(node)) {
                        continue;
                    }
                    this.addIds(node.children);
                    if (node.namespace == sys.NS_W || !node.localName) {
                    }
                    else if (this.isProperty(node)) {
                        var prop = node.localName;
                        var index = prop.indexOf(".");
                        var children = node.children;
                        if (index == -1 || !children || children.length == 0) {
                            continue;
                        }
                        var firstChild = children[0];
                        this.stateIds.push(firstChild.attributes.id);
                    }
                    else if (node.nodeType === 1) {
                        var id = node.attributes["id"];
                        if (id) {
                            var e = new RegExp("^[a-zA-Z_$]{1}[a-z0-9A-Z_$]*");
                            if (id.match(e) == null) {
                                egret.$warn(2022, id);
                            }
                            if (this.skinParts.indexOf(id) == -1) {
                                this.skinParts.push(id);
                            }
                            this.createVarForNode(node);
                            if (this.isStateNode(node))
                                this.stateIds.push(id);
                        }
                        else {
                            this.createIdForNode(node);
                            if (this.isStateNode(node))
                                this.stateIds.push(node.attributes.id);
                        }
                    }
                }
            };
            /**
             * @private
             * ๆฏๅฆไธบๅ้จ็ฑปใ
             */
            EXMLParser.prototype.isInnerClass = function (node) {
                if (node.hasOwnProperty("isInnerClass")) {
                    return node["isInnerClass"];
                }
                var result = (node.localName == "Skin" && node.namespace == sys.NS_S);
                if (!result) {
                    if (this.isProperty(node)) {
                        result = false;
                    }
                    else {
                        var prop = void 0;
                        var parent_1 = node.parent;
                        if (this.isProperty(parent_1)) {
                            prop = parent_1.localName;
                            var index = prop.indexOf(".");
                            if (index != -1) {
                                var stateName = prop.substring(index + 1);
                                prop = prop.substring(0, index);
                            }
                            parent_1 = parent_1.parent;
                        }
                        else {
                            prop = sys.exmlConfig.getDefaultPropById(parent_1.localName, parent_1.namespace);
                        }
                        var className = sys.exmlConfig.getClassNameById(parent_1.localName, parent_1.namespace);
                        result = (sys.exmlConfig.getPropertyType(prop, className) == TYPE_CLASS);
                    }
                }
                node["isInnerClass"] = result;
                return result;
            };
            /**
             * @private
             * ๆฃๆตๆๅฎ่็น็ๅฑๆงๆฏๅฆๅซๆ่งๅพ็ถๆ
             */
            EXMLParser.prototype.containsState = function (node) {
                var attributes = node.attributes;
                if (attributes["includeIn"] || attributes["excludeFrom"]) {
                    return true;
                }
                var keys = Object.keys(attributes);
                var length = keys.length;
                for (var i = 0; i < length; i++) {
                    var name_1 = keys[i];
                    if (name_1.indexOf(".") != -1) {
                        return true;
                    }
                }
                return false;
            };
            /**
             * @private
             * ไธบๆๅฎ่็นๅๅปบidๅฑๆง
             */
            EXMLParser.prototype.createIdForNode = function (node) {
                var idName = this.getNodeId(node);
                if (!this.idDic[idName])
                    this.idDic[idName] = 1;
                else
                    this.idDic[idName]++;
                idName += this.idDic[idName];
                node.attributes.id = idName;
            };
            /**
             * @private
             * ่ทๅ่็นID
             */
            EXMLParser.prototype.getNodeId = function (node) {
                if (node.attributes["id"])
                    return node.attributes.id;
                return "_" + node.localName;
            };
            /**
             * @private
             * ไธบๆๅฎ่็นๅๅปบๅ้
             */
            EXMLParser.prototype.createVarForNode = function (node) {
                var moduleName = this.getClassNameOfNode(node);
                if (moduleName == "")
                    return;
                if (!this.currentClass.getVariableByName(node.attributes.id))
                    this.currentClass.addVariable(new sys.EXVariable(node.attributes.id));
            };
            /**
             * @private
             * ไธบๆๅฎ่็นๅๅปบๅๅงๅๅฝๆฐ,่ฟๅๅฝๆฐๅๅผ็จ
             */
            EXMLParser.prototype.createFuncForNode = function (node) {
                var className = node.localName;
                var isBasicType = this.isBasicTypeData(className);
                if (isBasicType)
                    return this.createBasicTypeForNode(node);
                var moduleName = this.getClassNameOfNode(node);
                var func = new sys.EXFunction();
                var tailName = "_i";
                var id = node.attributes.id;
                func.name = id + tailName;
                this.currentClass.addFunction(func);
                var cb = new sys.EXCodeBlock();
                func.codeBlock = cb;
                var varName = "t";
                if (className == "Object") {
                    cb.addVar(varName, "{}");
                }
                else {
                    cb.addVar(varName, "new " + moduleName + "()");
                }
                var containsId = !!this.currentClass.getVariableByName(id);
                if (containsId) {
                    cb.addAssignment("this." + id, varName);
                }
                this.addAttributesToCodeBlock(cb, varName, node);
                this.initlizeChildNode(node, cb, varName);
                var delayAssignments = this.delayAssignmentDic[id];
                if (delayAssignments) {
                    var length_18 = delayAssignments.length;
                    for (var i = 0; i < length_18; i++) {
                        var codeBlock = delayAssignments[i];
                        cb.concat(codeBlock);
                    }
                }
                cb.addReturn(varName);
                return "this." + func.name + "()";
            };
            /**
             * @private
             * ๆฃๆฅ็ฎๆ็ฑปๅๆฏๅฆๆฏๅบๆฌๆฐๆฎ็ฑปๅ
             */
            EXMLParser.prototype.isBasicTypeData = function (className) {
                return basicTypes.indexOf(className) != -1;
            };
            /**
             * @private
             * ไธบๆๅฎๅบๆฌๆฐๆฎ็ฑปๅ่็นๅฎไพๅ,่ฟๅๅฎไพๅๅ็ๅผใ
             */
            EXMLParser.prototype.createBasicTypeForNode = function (node) {
                var className = node.localName;
                var returnValue = "";
                var varItem = this.currentClass.getVariableByName(node.attributes.id);
                var children = node.children;
                var text = "";
                if (children && children.length > 0) {
                    var firstChild = children[0];
                    if (firstChild.nodeType == 3) {
                        text = firstChild.text.trim();
                    }
                }
                switch (className) {
                    case TYPE_ARRAY:
                        var values = [];
                        if (children) {
                            var length_19 = children.length;
                            for (var i = 0; i < length_19; i++) {
                                var child = children[i];
                                if (child.nodeType == 1) {
                                    values.push(this.createFuncForNode(child));
                                }
                            }
                        }
                        returnValue = "[" + values.join(",") + "]";
                        break;
                    case "boolean":
                        returnValue = (text == "false" || !text) ? "false" : "true";
                        break;
                    case "number":
                        returnValue = text;
                        if (returnValue.indexOf("%") != -1)
                            returnValue = returnValue.substring(0, returnValue.length - 1);
                        break;
                    case "string":
                        returnValue = this.formatString(text);
                        break;
                }
                if (varItem)
                    varItem.defaultValue = returnValue;
                return returnValue;
            };
            /**
             * @private
             * ๅฐ่็นๅฑๆง่ตๅผ่ฏญๅฅๆทปๅๅฐไปฃ็ๅ
             */
            EXMLParser.prototype.addAttributesToCodeBlock = function (cb, varName, node) {
                var key;
                var value;
                var attributes = node.attributes;
                var keyList = Object.keys(attributes);
                keyList.sort(); //ๆๅบไธไธ้ฒๆญขๅบ็ฐ้ๆบ้กบๅบ
                var length = keyList.length;
                for (var i = 0; i < length; i++) {
                    key = keyList[i];
                    if (!this.isNormalKey(key)) {
                        continue;
                    }
                    value = attributes[key];
                    key = this.formatKey(key, value);
                    value = this.formatValue(key, value, node);
                    if (!value) {
                        continue;
                    }
                    if (this.currentClass.getVariableByName(value)) {
                        var THIS = "this.";
                        var id = attributes.id;
                        var codeLine = THIS + id + " = t;";
                        if (!this.currentClass.getVariableByName(id))
                            this.createVarForNode(node);
                        if (!cb.containsCodeLine(codeLine)) {
                            cb.addCodeLineAt(codeLine, 1);
                        }
                        var delayCb = new sys.EXCodeBlock();
                        if (varName == "this") {
                            delayCb.addAssignment(varName, THIS + value, key);
                        }
                        else {
                            delayCb.startIf(THIS + id);
                            delayCb.addAssignment(THIS + id, THIS + value, key);
                            delayCb.endBlock();
                        }
                        if (!this.delayAssignmentDic[value]) {
                            this.delayAssignmentDic[value] = [];
                        }
                        this.delayAssignmentDic[value].push(delayCb);
                        value = THIS + value;
                    }
                    cb.addAssignment(varName, value, key);
                }
            };
            /**
             * @private
             * ๅๅงๅๅญ้กน
             */
            EXMLParser.prototype.initlizeChildNode = function (node, cb, varName) {
                var children = node.children;
                if (!children || children.length == 0)
                    return;
                var className = sys.exmlConfig.getClassNameById(node.localName, node.namespace);
                var directChild = [];
                var length = children.length;
                var propList = [];
                var errorInfo;
                for (var i = 0; i < length; i++) {
                    var child = children[i];
                    if (child.nodeType != 1 || child.namespace == sys.NS_W) {
                        continue;
                    }
                    if (this.isInnerClass(child)) {
                        if (child.localName == "Skin") {
                            var innerClassName = this.parseInnerClass(child);
                            var type = sys.exmlConfig.getPropertyType(SKIN_NAME, className);
                            if (type) {
                                cb.addAssignment(varName, innerClassName, SKIN_NAME);
                            }
                            else {
                                egret.$error(2005, this.currentClassName, SKIN_NAME, getPropertyStr(child));
                            }
                        }
                        continue;
                    }
                    var prop = child.localName;
                    if (this.isProperty(child)) {
                        if (!this.isNormalKey(prop)) {
                            continue;
                        }
                        var type = sys.exmlConfig.getPropertyType(child.localName, className);
                        if (!type) {
                            if (true) {
                                egret.$error(2005, this.currentClassName, child.localName, getPropertyStr(child));
                            }
                            continue;
                        }
                        if (!child.children || child.children.length == 0) {
                            if (true) {
                                egret.$warn(2102, this.currentClassName, getPropertyStr(child));
                            }
                            continue;
                        }
                        if (true) {
                            errorInfo = getPropertyStr(child);
                        }
                        this.addChildrenToProp(child.children, type, prop, cb, varName, errorInfo, propList, node);
                    }
                    else {
                        directChild.push(child);
                    }
                }
                if (directChild.length == 0)
                    return;
                var defaultProp = sys.exmlConfig.getDefaultPropById(node.localName, node.namespace);
                var defaultType = sys.exmlConfig.getPropertyType(defaultProp, className);
                if (true) {
                    errorInfo = getPropertyStr(directChild[0]);
                }
                if (!defaultProp || !defaultType) {
                    if (true) {
                        egret.$error(2012, this.currentClassName, errorInfo);
                    }
                    return;
                }
                this.addChildrenToProp(directChild, defaultType, defaultProp, cb, varName, errorInfo, propList, node);
            };
            /**
             * @private
             * ่งฃๆๅ้จ็ฑป่็น๏ผๅนถ่ฟๅ็ฑปๅใ
             */
            EXMLParser.prototype.parseInnerClass = function (node) {
                var parser = exmlParserPool.pop();
                if (!parser) {
                    parser = new EXMLParser();
                }
                var innerClassName = this.currentClass.className + "$" + node.localName + innerClassCount++;
                var innerClass = parser.parseClass(node, innerClassName);
                this.currentClass.addInnerClass(innerClass);
                exmlParserPool.push(parser);
                return innerClassName;
            };
            /**
             * @private
             * ๆทปๅๅคไธชๅญ่็นๅฐๆๅฎ็ๅฑๆง
             */
            EXMLParser.prototype.addChildrenToProp = function (children, type, prop, cb, varName, errorInfo, propList, node) {
                var childFunc = "";
                var childLength = children.length;
                if (childLength > 1) {
                    if (type != TYPE_ARRAY) {
                        if (true) {
                            egret.$error(2011, this.currentClassName, prop, errorInfo);
                        }
                        return;
                    }
                    var values = [];
                    for (var j = 0; j < childLength; j++) {
                        var item = children[j];
                        if (item.nodeType != 1) {
                            continue;
                        }
                        childFunc = this.createFuncForNode(item);
                        var childClassName = this.getClassNameOfNode(item);
                        if (!this.isStateNode(item))
                            values.push(childFunc);
                    }
                    childFunc = "[" + values.join(",") + "]";
                }
                else {
                    var firstChild = children[0];
                    if (type == TYPE_ARRAY) {
                        if (firstChild.localName == TYPE_ARRAY) {
                            var values = [];
                            if (firstChild.children) {
                                var len = firstChild.children.length;
                                for (var k = 0; k < len; k++) {
                                    var item = firstChild.children[k];
                                    if (item.nodeType != 1) {
                                        continue;
                                    }
                                    childFunc = this.createFuncForNode(item);
                                    var childClassName = this.getClassNameOfNode(item);
                                    if (!this.isStateNode(item))
                                        values.push(childFunc);
                                }
                            }
                            childFunc = "[" + values.join(",") + "]";
                        }
                        else {
                            childFunc = this.createFuncForNode(firstChild);
                            var childClassName = this.getClassNameOfNode(firstChild);
                            if (!this.isStateNode(firstChild))
                                childFunc = "[" + childFunc + "]";
                            else
                                childFunc = "[]";
                        }
                    }
                    else if (firstChild.nodeType == 1) {
                        if (type == TYPE_CLASS) {
                            if (childLength > 1) {
                                if (true) {
                                    egret.$error(2011, this.currentClassName, prop, errorInfo);
                                }
                                return;
                            }
                            childFunc = this.parseInnerClass(children[0]);
                        }
                        else {
                            var targetClass = this.getClassNameOfNode(firstChild);
                            childFunc = this.createFuncForNode(firstChild);
                        }
                    }
                    else {
                        childFunc = this.formatValue(prop, firstChild.text, node);
                    }
                }
                if (childFunc != "") {
                    if (childFunc.indexOf("()") == -1)
                        prop = this.formatKey(prop, childFunc);
                    if (propList.indexOf(prop) == -1) {
                        propList.push(prop);
                    }
                    else if (true) {
                        egret.$warn(2103, this.currentClassName, prop, errorInfo);
                    }
                    cb.addAssignment(varName, childFunc, prop);
                }
            };
            /**
             * @private
             * ๆๅฎ่็นๆฏๅฆๆฏๅฑๆง่็น
             */
            EXMLParser.prototype.isProperty = function (node) {
                if (node.hasOwnProperty("isProperty")) {
                    return node["isProperty"];
                }
                var result;
                var name = node.localName;
                if (!name || node.nodeType !== 1 || !node.parent || this.isBasicTypeData(name)) {
                    result = false;
                }
                else {
                    var parent_2 = node.parent;
                    var index = name.indexOf(".");
                    if (index != -1) {
                        name = name.substr(0, index);
                    }
                    var className = sys.exmlConfig.getClassNameById(parent_2.localName, parent_2.namespace);
                    result = !!sys.exmlConfig.getPropertyType(name, className);
                }
                node["isProperty"] = result;
                return result;
            };
            /**
             * @private
             * ๆฏๅฆๆฏๆฎ้่ตๅผ็key
             */
            EXMLParser.prototype.isNormalKey = function (key) {
                if (!key || key.indexOf(".") != -1
                    || key.indexOf(":") != -1 || wingKeys.indexOf(key) != -1)
                    return false;
                return true;
            };
            /**
             * @private
             * ๆผๅผๅkey
             */
            EXMLParser.prototype.formatKey = function (key, value) {
                if (value.indexOf("%") != -1) {
                    if (key == "height")
                        key = "percentHeight";
                    else if (key == "width")
                        key = "percentWidth";
                }
                return key;
            };
            /**
             * @private
             * ๆผๅผๅๅผ
             */
            EXMLParser.prototype.formatValue = function (key, value, node) {
                if (!value) {
                    value = "";
                }
                var stringValue = value; //้คไบๅญ็ฌฆไธฒ๏ผๅถไป็ฑปๅ้ฝๅป้คไธค็ซฏๅคไฝ็ฉบๆผใ
                value = value.trim();
                var className = this.getClassNameOfNode(node);
                var type = sys.exmlConfig.getPropertyType(key, className);
                if (true && !type) {
                    egret.$error(2005, this.currentClassName, key, toXMLString(node));
                }
                var bindingValue = this.formatBinding(key, value, node);
                if (bindingValue) {
                    this.checkIdForState(node);
                    var target = "this";
                    if (node !== this.currentXML) {
                        target += "." + node.attributes["id"];
                    }
                    this.bindings.push(new sys.EXBinding(target, key, bindingValue.templates, bindingValue.chainIndex));
                    value = "";
                }
                else if (type == RECTANGLE) {
                    if (true) {
                        var rect = value.split(",");
                        if (rect.length != 4 || isNaN(parseInt(rect[0])) || isNaN(parseInt(rect[1])) ||
                            isNaN(parseInt(rect[2])) || isNaN(parseInt(rect[3]))) {
                            egret.$error(2016, this.currentClassName, toXMLString(node));
                        }
                    }
                    value = "new " + RECTANGLE + "(" + value + ")";
                }
                else if (type == TYPE_PERCENTAGE) {
                    if (value.indexOf("%") != -1) {
                        value = this.formatString(value);
                        ;
                    }
                }
                else {
                    var orgValue = value;
                    switch (type) {
                        case TYPE_CLASS:
                            if (key == SKIN_NAME) {
                                value = this.formatString(stringValue);
                            }
                            break;
                        case "number":
                            if (value.indexOf("#") == 0) {
                                if (true && isNaN(value.substring(1))) {
                                    egret.$warn(2021, this.currentClassName, key, value);
                                }
                                value = "0x" + value.substring(1);
                            }
                            else if (value.indexOf("%") != -1) {
                                if (true && isNaN(value.substr(0, value.length - 1))) {
                                    egret.$warn(2021, this.currentClassName, key, value);
                                }
                                value = (parseFloat(value.substr(0, value.length - 1))).toString();
                            }
                            else if (true && isNaN(value)) {
                                egret.$warn(2021, this.currentClassName, key, value);
                            }
                            break;
                        case "boolean":
                            value = (value == "false" || !value) ? "false" : "true";
                            break;
                        case "string":
                        case "any":
                            value = this.formatString(stringValue);
                            break;
                        default:
                            if (true) {
                                egret.$error(2008, this.currentClassName, "string", key + ":" + type, toXMLString(node));
                            }
                            break;
                    }
                }
                return value;
            };
            /**
             * @private
             * ๆผๅผๅๅญ็ฌฆไธฒ
             */
            EXMLParser.prototype.formatString = function (value) {
                value = this.unescapeHTMLEntity(value);
                value = value.split("\n").join("\\n");
                value = value.split("\r").join("\\n");
                value = value.split("\"").join("\\\"");
                value = "\"" + value + "\"";
                return value;
            };
            EXMLParser.prototype.formatBinding = function (key, value, node) {
                if (!value) {
                    return null;
                }
                value = value.trim();
                if (value.charAt(0) != "{" || value.charAt(value.length - 1) != "}") {
                    return null;
                }
                value = value.substring(1, value.length - 1).trim();
                var templates = value.indexOf("+") == -1 ? [value] : this.parseTemplates(value);
                var chainIndex = [];
                var length = templates.length;
                for (var i = 0; i < length; i++) {
                    var item = templates[i].trim();
                    if (!item) {
                        templates.splice(i, 1);
                        i--;
                        length--;
                        continue;
                    }
                    var first = item.charAt(0);
                    if (first == "'" || first == "\"" || first >= "0" && first <= "9" || first == "-") {
                        continue;
                    }
                    if (item.indexOf(".") == -1 && jsKeyWords.indexOf(item) != -1) {
                        continue;
                    }
                    if (item.indexOf("this.") == 0) {
                        item = item.substring(5);
                    }
                    var firstKey = item.split(".")[0];
                    if (firstKey != HOST_COMPONENT && this.skinParts.indexOf(firstKey) == -1) {
                        item = HOST_COMPONENT + "." + item;
                    }
                    templates[i] = "\"" + item + "\"";
                    chainIndex.push(i);
                }
                return { templates: templates, chainIndex: chainIndex };
            };
            EXMLParser.prototype.parseTemplates = function (value) {
                //ไปไปๆฏ่กจ่พพๅผ็ธๅ ๅฆ:{a.b+c.d}
                if (value.indexOf("'") == -1) {
                    return value.split("+");
                }
                //ๅๅซๆๆฌ็้่ฆๆๅๆๆฌๅนถๅฏนๆๆฌ่ฟ่กๅค็
                var isSingleQuoteLeak = false; //ๆฏๅฆ็ผบๅคฑๅๅผๅท
                var trimText = "";
                value = value.split("\\\'").join("\v0\v");
                while (value.length > 0) {
                    //'ๆๅฏนๅบ็ฐ ่ฟๆฏ็ฌฌไธไธช
                    var index = value.indexOf("'");
                    if (index == -1) {
                        trimText += value;
                        break;
                    }
                    trimText += value.substring(0, index + 1);
                    value = value.substring(index + 1);
                    //'ๆๅฏนๅบ็ฐ ่ฟๆฏ็ฌฌไบไธช
                    index = value.indexOf("'");
                    if (index == -1) {
                        index = value.length - 1;
                        isSingleQuoteLeak = true;
                    }
                    var quote = value.substring(0, index + 1);
                    trimText += quote.split("+").join("\v1\v");
                    value = value.substring(index + 1);
                }
                value = trimText.split("\v0\v").join("\\\'");
                //่กฅๅจ็ผบๅคฑ็ๅๅผๅท
                if (isSingleQuoteLeak) {
                    value += "'";
                }
                var templates = value.split("+");
                var length = templates.length;
                for (var i = 0; i < length; i++) {
                    templates[i] = templates[i].split("\v1\v").join("+");
                }
                return templates;
            };
            /**
             * @private
             /**
             * ่ฝฌๆขHTMLๅฎไฝๅญ็ฌฆไธบๆฎ้ๅญ็ฌฆ
             */
            EXMLParser.prototype.unescapeHTMLEntity = function (str) {
                if (!str)
                    return "";
                var length = htmlEntities.length;
                for (var i = 0; i < length; i++) {
                    var arr = htmlEntities[i];
                    var key = arr[0];
                    var value = arr[1];
                    str = str.split(value).join(key);
                }
                return str;
            };
            /**
             * @private
             * ๅๅปบๆ้ๅฝๆฐ
             */
            EXMLParser.prototype.createConstructFunc = function () {
                var cb = new sys.EXCodeBlock;
                cb.addEmptyLine();
                var varName = "this";
                this.addAttributesToCodeBlock(cb, varName, this.currentXML);
                if (this.declarations) {
                    var children = this.declarations.children;
                    if (children && children.length > 0) {
                        var length_20 = children.length;
                        for (var i = 0; i < length_20; i++) {
                            var decl = children[i];
                            if (decl.nodeType != 1) {
                                continue;
                            }
                            var funcName = this.createFuncForNode(decl);
                            if (funcName) {
                                cb.addCodeLine(funcName + ";");
                            }
                        }
                    }
                }
                this.initlizeChildNode(this.currentXML, cb, varName);
                var id;
                var length;
                var stateIds = this.stateIds;
                if (stateIds.length > 0) {
                    length = stateIds.length;
                    for (var i = 0; i < length; i++) {
                        id = stateIds[i];
                        cb.addCodeLine("this." + id + "_i();");
                    }
                    cb.addEmptyLine();
                }
                var skinParts = this.skinParts;
                var skinPartStr = "[]";
                length = skinParts.length;
                if (length > 0) {
                    for (var i = 0; i < length; i++) {
                        skinParts[i] = "\"" + skinParts[i] + "\"";
                    }
                    skinPartStr = "[" + skinParts.join(",") + "]";
                }
                var skinPartFunc = new sys.EXFunction();
                skinPartFunc.name = "skinParts";
                skinPartFunc.isGet = true;
                var skinPartCB = new sys.EXCodeBlock();
                skinPartCB.addReturn(skinPartStr);
                skinPartFunc.codeBlock = skinPartCB;
                this.currentClass.addFunction(skinPartFunc);
                this.currentXML.attributes.id = "";
                //็ๆ่งๅพ็ถๆไปฃ็
                this.createStates(this.currentXML);
                var states;
                var node = this.currentXML;
                var nodeClassName = this.getClassNameOfNode(node);
                var attributes = node.attributes;
                var keys = Object.keys(attributes);
                var keysLength = keys.length;
                for (var m = 0; m < keysLength; m++) {
                    var itemName = keys[m];
                    var value = attributes[itemName];
                    var index = itemName.indexOf(".");
                    if (index != -1) {
                        var key = itemName.substring(0, index);
                        key = this.formatKey(key, value);
                        var itemValue = this.formatValue(key, value, node);
                        if (!itemValue) {
                            continue;
                        }
                        var stateName = itemName.substr(index + 1);
                        states = this.getStateByName(stateName, node);
                        var stateLength = states.length;
                        if (stateLength > 0) {
                            for (var i = 0; i < stateLength; i++) {
                                var state = states[i];
                                state.addOverride(new sys.EXSetProperty("", key, itemValue));
                            }
                        }
                    }
                }
                //ๆๅฐ่งๅพ็ถๆๅๅงๅไปฃ็
                var stateCode = this.stateCode;
                length = stateCode.length;
                if (length > 0) {
                    var indentStr = "	";
                    cb.addCodeLine("this.states = [");
                    var first = true;
                    for (var i = 0; i < length; i++) {
                        var state = stateCode[i];
                        if (first)
                            first = false;
                        else
                            cb.addCodeLine(indentStr + ",");
                        var codes = state.toCode().split("\n");
                        var codeIndex = 0;
                        while (codeIndex < codes.length) {
                            var code = codes[codeIndex];
                            if (code)
                                cb.addCodeLine(indentStr + code);
                            codeIndex++;
                        }
                    }
                    cb.addCodeLine("];");
                }
                //็ๆ็ปๅฎไปฃ็
                var bindings = this.bindings;
                length = bindings.length;
                if (length > 0) {
                    cb.addEmptyLine();
                    for (var i = 0; i < length; i++) {
                        var binding = bindings[i];
                        cb.addCodeLine(binding.toCode());
                    }
                }
                this.currentClass.constructCode = cb;
            };
            /**
             * @private
             * ๆฏๅฆๅซๆincludeInๅexcludeFromๅฑๆง
             */
            EXMLParser.prototype.isStateNode = function (node) {
                var attributes = node.attributes;
                return attributes.hasOwnProperty("includeIn") || attributes.hasOwnProperty("excludeFrom");
            };
            /**
             * @private
             * ่ทๅ่งๅพ็ถๆๅ็งฐๅ่กจ
             */
            EXMLParser.prototype.getStateNames = function () {
                var root = this.currentXML;
                var className = sys.exmlConfig.getClassNameById(root.localName, root.namespace);
                var type = sys.exmlConfig.getPropertyType("states", className);
                if (type != TYPE_STATE) {
                    return;
                }
                var statesValue = root.attributes["states"];
                if (statesValue) {
                    delete root.attributes["states"];
                }
                var stateNames = this.stateNames;
                var stateChildren;
                var children = root.children;
                var item;
                if (children) {
                    var length_21 = children.length;
                    for (var i = 0; i < length_21; i++) {
                        item = children[i];
                        if (item.nodeType == 1 &&
                            item.localName == "states") {
                            item.namespace = sys.NS_W;
                            stateChildren = item.children;
                            break;
                        }
                    }
                }
                if (!stateChildren && !statesValue) {
                    return;
                }
                if (true) {
                    if (stateChildren && stateChildren.length == 0) {
                        egret.$warn(2102, this.currentClassName, getPropertyStr(item));
                    }
                    if (stateChildren && statesValue) {
                        egret.$warn(2103, this.currentClassName, "states", getPropertyStr(item));
                    }
                }
                if (statesValue) {
                    var states = statesValue.split(",");
                    var length_22 = states.length;
                    for (var i = 0; i < length_22; i++) {
                        var stateName = states[i].trim();
                        if (!stateName) {
                            continue;
                        }
                        if (stateNames.indexOf(stateName) == -1) {
                            stateNames.push(stateName);
                        }
                        this.stateCode.push(new sys.EXState(stateName));
                    }
                    return;
                }
                var length = stateChildren.length;
                for (var i = 0; i < length; i++) {
                    var state = stateChildren[i];
                    if (state.nodeType != 1) {
                        continue;
                    }
                    var stateGroups = [];
                    var attributes = state.attributes;
                    if (attributes["stateGroups"]) {
                        var groups = attributes.stateGroups.split(",");
                        var len = groups.length;
                        for (var j = 0; j < len; j++) {
                            var group = groups[j].trim();
                            if (group) {
                                if (stateNames.indexOf(group) == -1) {
                                    stateNames.push(group);
                                }
                                stateGroups.push(group);
                            }
                        }
                    }
                    var stateName = attributes.name;
                    if (stateNames.indexOf(stateName) == -1) {
                        stateNames.push(stateName);
                    }
                    this.stateCode.push(new sys.EXState(stateName, stateGroups));
                }
            };
            /**
             * @private
             * ่งฃๆ่งๅพ็ถๆไปฃ็
             */
            EXMLParser.prototype.createStates = function (parentNode) {
                var items = parentNode.children;
                if (!items) {
                    return;
                }
                var length = items.length;
                for (var i = 0; i < length; i++) {
                    var node = items[i];
                    if (node.nodeType != 1 || this.isInnerClass(node)) {
                        continue;
                    }
                    this.createStates(node);
                    if (node.namespace == sys.NS_W || !node.localName) {
                        continue;
                    }
                    if (this.isProperty(node)) {
                        var prop = node.localName;
                        var index = prop.indexOf(".");
                        var children = node.children;
                        if (index == -1 || !children || children.length == 0) {
                            continue;
                        }
                        var stateName = prop.substring(index + 1);
                        prop = prop.substring(0, index);
                        var className = this.getClassNameOfNode(parentNode);
                        var type = sys.exmlConfig.getPropertyType(prop, className);
                        if (true) {
                            if (type == TYPE_ARRAY) {
                                egret.$error(2013, this.currentClassName, getPropertyStr(node));
                            }
                            if (children.length > 1) {
                                egret.$error(2011, this.currentClassName, prop, getPropertyStr(node));
                            }
                        }
                        var firstChild = children[0];
                        var value = void 0;
                        if (firstChild.nodeType == 1) {
                            this.createFuncForNode(firstChild);
                            this.checkIdForState(firstChild);
                            value = "this." + firstChild.attributes.id;
                        }
                        else {
                            value = this.formatValue(prop, firstChild.text, parentNode);
                        }
                        var states = this.getStateByName(stateName, node);
                        var l = states.length;
                        if (l > 0) {
                            for (var j = 0; j < l; j++) {
                                var state = states[j];
                                state.addOverride(new sys.EXSetProperty(parentNode.attributes.id, prop, value));
                            }
                        }
                    }
                    else if (this.containsState(node)) {
                        var attributes = node.attributes;
                        var id = attributes.id;
                        var nodeClassName = this.getClassNameOfNode(node);
                        this.checkIdForState(node);
                        var stateName = void 0;
                        var states = void 0;
                        var state = void 0;
                        if (this.isStateNode(node)) {
                            var propertyName = "";
                            var parent_3 = node.parent;
                            if (parent_3.localName == TYPE_ARRAY)
                                parent_3 = parent_3.parent;
                            if (parent_3 && parent_3.parent) {
                                if (this.isProperty(parent_3))
                                    parent_3 = parent_3.parent;
                            }
                            if (parent_3 && parent_3 != this.currentXML) {
                                propertyName = parent_3.attributes.id;
                                this.checkIdForState(parent_3);
                            }
                            var positionObj = this.findNearNodeId(node);
                            var stateNames = [];
                            if (attributes.includeIn) {
                                stateNames = attributes.includeIn.split(",");
                            }
                            else {
                                var excludeNames = attributes.excludeFrom.split(",");
                                var stateLength = excludeNames.length;
                                for (var j = 0; j < stateLength; j++) {
                                    var name_2 = excludeNames[j];
                                    this.getStateByName(name_2, node); //ๆฃๆฅexlcudeFromๆฏๅฆๅซๆๆชๅฎไน็่งๅพ็ถๆๅ
                                }
                                stateLength = this.stateCode.length;
                                for (var j = 0; j < stateLength; j++) {
                                    state = this.stateCode[j];
                                    if (excludeNames.indexOf(state.name) == -1) {
                                        stateNames.push(state.name);
                                    }
                                }
                            }
                            var len = stateNames.length;
                            for (var k = 0; k < len; k++) {
                                stateName = stateNames[k];
                                states = this.getStateByName(stateName, node);
                                if (states.length > 0) {
                                    var l = states.length;
                                    for (var j = 0; j < l; j++) {
                                        state = states[j];
                                        state.addOverride(new sys.EXAddItems(id, propertyName, positionObj.position, positionObj.relativeTo));
                                    }
                                }
                            }
                        }
                        var names = Object.keys(attributes);
                        var namesLength = names.length;
                        for (var m = 0; m < namesLength; m++) {
                            var name_3 = names[m];
                            var value = attributes[name_3];
                            var index = name_3.indexOf(".");
                            if (index != -1) {
                                var key = name_3.substring(0, index);
                                key = this.formatKey(key, value);
                                var bindingValue = this.formatBinding(key, value, node);
                                if (!bindingValue) {
                                    value = this.formatValue(key, value, node);
                                    if (!value) {
                                        continue;
                                    }
                                }
                                stateName = name_3.substr(index + 1);
                                states = this.getStateByName(stateName, node);
                                var l = states.length;
                                if (l > 0) {
                                    for (var j = 0; j < l; j++) {
                                        state = states[j];
                                        if (bindingValue) {
                                            state.addOverride(new sys.EXSetStateProperty(id, key, bindingValue.templates, bindingValue.chainIndex));
                                        }
                                        else {
                                            state.addOverride(new sys.EXSetProperty(id, key, value));
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            };
            /**
             * @private
             * ๆฃๆฅๆๅฎ็IDๆฏๅฆๅๅปบไบ็ฑปๆๅๅ้๏ผ่ฅๆฒกๅๅปบๅไธบๅถๅๅปบใ
             */
            EXMLParser.prototype.checkIdForState = function (node) {
                if (!node || this.currentClass.getVariableByName(node.attributes.id)) {
                    return;
                }
                this.createVarForNode(node);
                var id = node.attributes.id;
                var funcName = id + "_i";
                var func = this.currentClass.getFuncByName(funcName);
                if (!func)
                    return;
                var codeLine = "this." + id + " = t;";
                var cb = func.codeBlock;
                if (!cb)
                    return;
                if (!cb.containsCodeLine(codeLine)) {
                    cb.addCodeLineAt(codeLine, 1);
                }
            };
            /**
             * @private
             * ้่ฟ่งๅพ็ถๆๅ็งฐ่ทๅๅฏนๅบ็่งๅพ็ถๆ
             */
            EXMLParser.prototype.getStateByName = function (name, node) {
                var states = [];
                var stateCode = this.stateCode;
                var length = stateCode.length;
                for (var i = 0; i < length; i++) {
                    var state = stateCode[i];
                    if (state.name == name) {
                        if (states.indexOf(state) == -1)
                            states.push(state);
                    }
                    else if (state.stateGroups.length > 0) {
                        var found = false;
                        var len = state.stateGroups.length;
                        for (var j = 0; j < len; j++) {
                            var g = state.stateGroups[j];
                            if (g == name) {
                                found = true;
                                break;
                            }
                        }
                        if (found) {
                            if (states.indexOf(state) == -1)
                                states.push(state);
                        }
                    }
                }
                if (true && states.length == 0) {
                    egret.$error(2006, this.currentClassName, name, toXMLString(node));
                }
                return states;
            };
            /**
             * @private
             * ๅฏปๆพ่็น็ไธด่ฟ่็นIDๅไฝ็ฝฎ
             */
            EXMLParser.prototype.findNearNodeId = function (node) {
                var parentNode = node.parent;
                var targetId = "";
                var position;
                var index = -1;
                var preItem;
                var afterItem;
                var found = false;
                var children = parentNode.children;
                var length = children.length;
                for (var i = 0; i < length; i++) {
                    var item = children[i];
                    if (this.isProperty(item))
                        continue;
                    if (item == node) {
                        found = true;
                        index = i;
                    }
                    else {
                        if (found && !afterItem && !this.isStateNode(item)) {
                            afterItem = item;
                        }
                    }
                    if (!found && !this.isStateNode(item))
                        preItem = item;
                }
                if (index == 0) {
                    position = 0 /* FIRST */;
                    return { position: position, relativeTo: targetId };
                }
                if (index == length - 1) {
                    position = 1 /* LAST */;
                    return { position: position, relativeTo: targetId };
                }
                if (afterItem) {
                    position = 2 /* BEFORE */;
                    targetId = afterItem.attributes.id;
                    if (targetId) {
                        this.checkIdForState(afterItem);
                        return { position: position, relativeTo: targetId };
                    }
                }
                return { position: 1 /* LAST */, relativeTo: targetId };
            };
            /**
             * @private
             * ่ทๅ่็น็ๅฎๆด็ฑปๅ๏ผๅๆฌๆจกๅๅ
             */
            EXMLParser.prototype.getClassNameOfNode = function (node) {
                var className = sys.exmlConfig.getClassNameById(node.localName, node.namespace);
                if (true && !className) {
                    egret.$error(2003, this.currentClassName, toXMLString(node));
                }
                return className;
            };
            return EXMLParser;
        }());
        sys.EXMLParser = EXMLParser;
        __reflect(EXMLParser.prototype, "eui.sys.EXMLParser");
        if (true) {
            /**
             * ่ทๅ้ๅค็IDๅ
             */
            function getRepeatedIds(xml) {
                var result = [];
                this.repeatedIdMap = {};
                this.getIds(xml, result);
                return result;
            }
            function getIds(xml, result) {
                if (xml.namespace != sys.NS_W && xml.attributes.id) {
                    var id = xml.attributes.id;
                    if (this.repeatedIdMap[id]) {
                        result.push(toXMLString(xml));
                    }
                    else {
                        this.repeatedIdMap[id] = true;
                    }
                }
                var children = xml.children;
                if (children) {
                    var length_23 = children.length;
                    for (var i = 0; i < length_23; i++) {
                        var node = children[i];
                        if (node.nodeType !== 1 || this.isInnerClass(node)) {
                            continue;
                        }
                        this.getIds(node, result);
                    }
                }
            }
            function toXMLString(node) {
                if (!node) {
                    return "";
                }
                var str = "  at <" + node.name;
                var attributes = node.attributes;
                var keys = Object.keys(attributes);
                var length = keys.length;
                for (var i = 0; i < length; i++) {
                    var key = keys[i];
                    var value = attributes[key];
                    if (key == "id" && value.substring(0, 2) == "__") {
                        continue;
                    }
                    str += " " + key + "=\"" + value + "\"";
                }
                if (node.children.length == 0) {
                    str += "/>";
                }
                else {
                    str += ">";
                }
                return str;
            }
            /**
             * ๆธ็ๅฃฐๆ่็น้็็ถๆๆๅฟ
             */
            function checkDeclarations(declarations, list) {
                if (!declarations) {
                    return;
                }
                var children = declarations.children;
                if (children) {
                    var length_24 = children.length;
                    for (var i = 0; i < length_24; i++) {
                        var node = children[i];
                        if (node.nodeType != 1) {
                            continue;
                        }
                        if (node.attributes.includeIn) {
                            list.push(toXMLString(node));
                        }
                        if (node.attributes.excludeFrom) {
                            list.push(toXMLString(node));
                        }
                        checkDeclarations(node, list);
                    }
                }
            }
            function getPropertyStr(child) {
                var parentStr = toXMLString(child.parent);
                var childStr = toXMLString(child).substring(5);
                return parentStr + "\n      \t" + childStr;
            }
        }
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ToggleButton component defines a toggle button.
     * Clicking the button toggles it between the up and an down states.
     * If you click the button while it is in the up state,
     * it toggles to the down state. You must click the button again
     * to toggle it back to the up state.
     * <p>You can get or set this state programmatically
     * by using the <code>selected</code> property.</p>
     *
     * @event egret.Event.CHANGE Dispatched when the <code>selected</code> property
     * changes for the ToggleButton control.
     * This event is dispatched only when the
     * user interacts with the control by touching.
     *
     * @state up Button up state
     * @state down Button down state
     * @state disabled Button disabled state
     * @state upAndSelected Up state when the button is selected
     * @state downAndSelected Down state when the button is selected
     * @state disabledAndSelected Disabled state when the button is selected
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ToggleButtonExample.ts
     * @language en_US
     */
    /**
     * ToggleButton ็ปไปถๅฎไนๅๆขๆ้ฎใๅๅป่ฏฅๆ้ฎไผๅจๅผน่ตท็ถๆๅๆไธ็ถๆไน้ด่ฟ่กๅๆขใ
     * ๅฆๆๅจๆ้ฎๅคไบๅผน่ตท็ถๆๆถๅๅป่ฏฅๆ้ฎ๏ผๅๅฎไผๅๆขๅฐๆไธ็ถๆใๅฟ้กปๅๆฌกๅๅป่ฏฅๆ้ฎๆๅฏๅฐๅถๅๆขๅๅผน่ตท็ถๆใ
     * <p>ๅฏไปฅไฝฟ็จ <code>selected</code> ๅฑๆงไปฅ็ผ็จๆนๅผ่ทๅๆ่ฎพ็ฝฎๆญค็ถๆใ</p>
     *
     * @event egret.Event.CHANGE ToggleButtonBase ๆงไปถ็ <code>selected</code> ๅฑๆงๆดๆนๆถๅๆดพใ
     * ไปๅฝ็จๆท้่ฟ่งฆๆธไธๆงไปถไบคไบๆถ๏ผๆๅๆดพๆญคไบไปถใ
     *
     * @state up ๆ้ฎๅผน่ตท็ถๆ
     * @state down ๆ้ฎๆไธ็ถๆ
     * @state disabled ๆ้ฎ็ฆ็จ็ถๆ
     * @state upAndSelected ๆ้ฎ้ๆฉๆถ็ๅผน่ตท็ถๆ
     * @state downAndSelected ๆ้ฎ้ๆฉๆถ็ๆไธ็ถๆ
     * @state disabledAndSelected ๆ้ฎ้ๆฉๆถ็็ฆ็จ็ถๆ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ToggleButtonExample.ts
     * @language zh_CN
     */
    var ToggleButton = (function (_super) {
        __extends(ToggleButton, _super);
        function ToggleButton() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            /**
             * @private
             */
            _this.$selected = false;
            /**
             * @private
             * ๆฏๅฆๆนๆฎ่งฆๆธไบไปถ่ชๅจๅๆข้ไธญ็ถๆ,้ป่ฎคtrueใไปๆกๆถๅไฝฟ็จใ
             */
            _this.$autoSelected = true;
            return _this;
        }
        Object.defineProperty(ToggleButton.prototype, "selected", {
            /**
             * Contains <code>true</code> if the button is in the down state,
             * and <code>false</code> if it is in the up state.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ้ฎๅคไบๆไธ็ถๆๆถไธบ <code>true</code>๏ผ่ๆ้ฎๅคไบๅผน่ตท็ถๆๆถไธบ <code>false</code>ใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$selected;
            },
            set: function (value) {
                this.$setSelected(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        ToggleButton.prototype.$setSelected = function (value) {
            value = !!value;
            if (value === this.$selected)
                return false;
            this.$selected = value;
            this.invalidateState();
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selected");
            return true;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ToggleButton.prototype.getCurrentState = function () {
            var state = _super.prototype.getCurrentState.call(this);
            if (!this.$selected) {
                return state;
            }
            else {
                var selectedState = state + "AndSelected";
                var skin = this.skin;
                if (skin && skin.hasState(selectedState)) {
                    return selectedState;
                }
                return state == "disabled" ? "disabled" : "down";
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ToggleButton.prototype.buttonReleased = function () {
            if (!this.$autoSelected)
                return;
            this.selected = !this.$selected;
            this.dispatchEventWith(egret.Event.CHANGE);
        };
        return ToggleButton;
    }(eui.Button));
    eui.ToggleButton = ToggleButton;
    __reflect(ToggleButton.prototype, "eui.ToggleButton");
    eui.registerBindable(ToggleButton.prototype, "selected");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Linear layout base class, usually as the parent class of
     * <code>HorizontalLayout</code> and <code>VerticalLayout</code>.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ็บฟๆงๅธๅฑๅบ็ฑป๏ผ้ๅธธไฝไธบ <code>HorizontalLayout</code> ๅ <code>VerticalLayout</code> ็็ถ็ฑปใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var LinearLayoutBase = (function (_super) {
        __extends(LinearLayoutBase, _super);
        function LinearLayoutBase() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            /**
             * @private
             */
            _this.$horizontalAlign = "left";
            /**
             * @private
             */
            _this.$verticalAlign = "top";
            /**
             * @private
             */
            _this.$gap = 6;
            /**
             * @private
             */
            _this.$paddingLeft = 0;
            /**
             * @private
             */
            _this.$paddingRight = 0;
            /**
             * @private
             */
            _this.$paddingTop = 0;
            /**
             * @private
             */
            _this.$paddingBottom = 0;
            /**
             * An Array of the virtual layout elements size cache.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๆๅธๅฑไฝฟ็จ็ๅฐบๅฏธ็ผๅญใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.elementSizeTable = [];
            /**
             * The first element index in the view of the virtual layout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๆๅธๅฑไฝฟ็จ็ๅฝๅ่งๅพไธญ็็ฌฌไธไธชๅ็ด็ดขๅผ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.startIndex = -1;
            /**
             * The last element index in the view of the virtual layout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ๆๅธๅฑไฝฟ็จ็ๅฝๅ่งๅพไธญ็ๆๅไธไธชๅ็ด็็ดขๅผ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.endIndex = -1;
            /**
             * A Flag of the first element and the end element has been calculated.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งๅพ็็ฌฌไธไธชๅๆๅไธไธชๅ็ด็็ดขๅผๅผๅทฒ็ป่ฎก็ฎๅฅฝ็ๆๅฟ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.indexInViewCalculated = false;
            /**
             * The maximum size of elements
             *
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅญๅ็ดๆๅคง็ๅฐบๅฏธ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.maxElementSize = 0;
            return _this;
        }
        Object.defineProperty(LinearLayoutBase.prototype, "horizontalAlign", {
            /**
             * The horizontal alignment of layout elements.
             * <p>The <code>egret.HorizontalAlign</code> and <code>eui.JustifyAlign</code> class
             * defines the possible values for this property.</p>
             *
             * @default "left"
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅธๅฑๅ็ด็ๆฐดๅนณๅฏน้ฝ็ญ็ฅใ
             * <p><code>egret.HorizontalAlign</code> ๅ
             * <code>eui.JustifyAlign</code>็ฑปๅฎไนๆญคๅฑๆง็ๅฏ่ฝๅผใ<p>
             *
             * @default "left"
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$horizontalAlign;
            },
            set: function (value) {
                if (this.$horizontalAlign == value)
                    return;
                this.$horizontalAlign = value;
                if (this.$target)
                    this.$target.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "verticalAlign", {
            /**
             * The vertical alignment of layout elements.
             * <p>The <code>egret.VerticalAlign</code> and <code>eui.JustifyAlign</code> class
             * defines the possible values for this property.</p>
             *
             * @default "top"
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅธๅฑๅ็ด็ๅ็ดๅฏน้ฝ็ญ็ฅใ่ฏทไฝฟ็จ VerticalAlign ๅฎไน็ๅธธ้ใ
             * <p><code>egret.VerticalAlign</code> ๅ
             * <code>eui.JustifyAlign</code>็ฑปๅฎไนๆญคๅฑๆง็ๅฏ่ฝๅผใ<p>
             *
             * @default "top"
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$verticalAlign;
            },
            set: function (value) {
                if (this.$verticalAlign == value)
                    return;
                this.$verticalAlign = value;
                if (this.$target)
                    this.$target.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "gap", {
            /**
             * The space between layout elements, in pixels.
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅธๅฑๅ็ดไน้ด็้ด้๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$gap;
            },
            set: function (value) {
                value = +value || 0;
                if (this.$gap === value)
                    return;
                this.$gap = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "paddingLeft", {
            /**
             * Number of pixels between the container's left edge
             * and the left edge of the first layout element.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฎนๅจ็ๅทฆ่พน็ผไธ็ฌฌไธไธชๅธๅฑๅ็ด็ๅทฆ่พน็ผไน้ด็ๅ็ดๆฐใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$paddingLeft;
            },
            set: function (value) {
                value = +value || 0;
                if (this.$paddingLeft === value)
                    return;
                this.$paddingLeft = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "paddingRight", {
            /**
             * Number of pixels between the container's right edge
             * and the right edge of the last layout element.
             *
             *  @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฎนๅจ็ๅณ่พน็ผไธๆๅไธไธชๅธๅฑๅ็ด็ๅณ่พน็ผไน้ด็ๅ็ดๆฐใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$paddingRight;
            },
            set: function (value) {
                value = +value || 0;
                if (this.$paddingRight === value)
                    return;
                this.$paddingRight = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "paddingTop", {
            /**
             * The minimum number of pixels between the container's top edge and
             * the top of all the container's layout elements.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฎนๅจ็้กถ่พน็ผไธๆๆๅฎนๅจ็ๅธๅฑๅ็ด็้กถ่พน็ผไน้ด็ๆๅฐๅ็ดๆฐใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$paddingTop;
            },
            set: function (value) {
                value = +value || 0;
                if (this.$paddingTop === value)
                    return;
                this.$paddingTop = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(LinearLayoutBase.prototype, "paddingBottom", {
            /**
             * The minimum number of pixels between the container's bottom edge and
             * the bottom of all the container's layout elements.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฎนๅจ็ๅบ่พน็ผไธๆๆๅฎนๅจ็ๅธๅฑๅ็ด็ๅบ่พน็ผไน้ด็ๆๅฐๅ็ดๆฐใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$paddingBottom;
            },
            set: function (value) {
                value = +value || 0;
                if (this.$paddingBottom === value)
                    return;
                this.$paddingBottom = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Convenience function for subclasses that invalidates the
         * target's size and displayList so that both layout's <code>measure()</code>
         * and <code>updateDisplayList</code> methods get called.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅคฑๆ็ฎๆๅฎนๅจ็ๅฐบๅฏธๅๆพ็คบๅ่กจ็็ฎไพฟๆนๆณ๏ผ่ฐ็จ็ฎๆๅฎนๅจ็
         * <code>measure()</code>ๅ<code>updateDisplayList</code>ๆนๆณ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.invalidateTargetLayout = function () {
            var target = this.$target;
            if (target) {
                target.invalidateSize();
                target.invalidateDisplayList();
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        LinearLayoutBase.prototype.measure = function () {
            if (!this.$target)
                return;
            if (this.$useVirtualLayout) {
                this.measureVirtual();
            }
            else {
                this.measureReal();
            }
        };
        /**
         * Compute exact values for measuredWidth and measuredHeight.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎก็ฎ็ฎๆๅฎนๅจ measuredWidth ๅ measuredHeight ็็ฒพ็กฎๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.measureReal = function () {
        };
        /**
         * Compute potentially approximate values for measuredWidth and measuredHeight.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎก็ฎ็ฎๆๅฎนๅจ measuredWidth ๅ measuredHeight ็่ฟไผผๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.measureVirtual = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        LinearLayoutBase.prototype.updateDisplayList = function (width, height) {
            var target = this.$target;
            if (!target)
                return;
            if (target.numElements == 0) {
                target.setContentSize(Math.ceil(this.$paddingLeft + this.$paddingRight), Math.ceil(this.$paddingTop + this.$paddingBottom));
                return;
            }
            if (this.$useVirtualLayout) {
                this.updateDisplayListVirtual(width, height);
            }
            else {
                this.updateDisplayListReal(width, height);
            }
        };
        /**
         * Gets the starting position of the specified index element
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅๆๅฎ็ดขๅผๅ็ด็่ตทๅงไฝ็ฝฎ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.getStartPosition = function (index) {
            return 0;
        };
        /**
         * Gets the size of the specified index element
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅๆๅฎ็ดขๅผๅ็ด็ๅฐบๅฏธ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.getElementSize = function (index) {
            return 0;
        };
        /**
         * Gets the sum of the size of cached elements
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅ็ผๅญ็ๅญๅฏน่ฑกๅฐบๅฏธๆปๅ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.getElementTotalSize = function () {
            return 0;
        };
        /**
         * @inheritDoc
         *
         * @param index
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        LinearLayoutBase.prototype.elementRemoved = function (index) {
            if (!this.$useVirtualLayout)
                return;
            _super.prototype.elementRemoved.call(this, index);
            this.elementSizeTable.splice(index, 1);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        LinearLayoutBase.prototype.clearVirtualLayoutCache = function () {
            if (!this.$useVirtualLayout)
                return;
            this.elementSizeTable = [];
            this.maxElementSize = 0;
        };
        /**
         * The binary search to find the specified index position of the display object
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๅๆฅๆพๆณๅฏปๆพๆๅฎไฝ็ฝฎ็ๆพ็คบๅฏน่ฑก็ดขๅผ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.findIndexAt = function (x, i0, i1) {
            var index = ((i0 + i1) * 0.5) | 0;
            var elementX = this.getStartPosition(index);
            var elementWidth = this.getElementSize(index);
            if ((x >= elementX) && (x < elementX + elementWidth + this.$gap))
                return index;
            else if (i0 == i1)
                return -1;
            else if (x < elementX)
                return this.findIndexAt(x, i0, Math.max(i0, index - 1));
            else
                return this.findIndexAt(x, Math.min(index + 1, i1), i1);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        LinearLayoutBase.prototype.scrollPositionChanged = function () {
            _super.prototype.scrollPositionChanged.call(this);
            if (this.$useVirtualLayout) {
                var changed = this.getIndexInView();
                if (changed) {
                    this.indexInViewCalculated = true;
                    this.target.invalidateDisplayList();
                }
            }
        };
        /**
         * Get the index of the first and last element in the view,
         * and to return whether or not to change.
         *
         * @return has the index changed
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ทๅ่งๅพไธญ็ฌฌไธไธชๅๆๅไธไธชๅ็ด็็ดขๅผ,่ฟๅๆฏๅฆๅ็ๆนๅใ
         *
         * @return ็ดขๅผๆฏๅฆๅทฒๆนๅ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.getIndexInView = function () {
            return false;
        };
        /**
         * Update the layout of the virtualized elements
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆฐ่ๆๅธๅฑ็ๆพ็คบๅ่กจ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.updateDisplayListVirtual = function (width, height) {
        };
        /**
         * Update the layout of the reality elements
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆดๆฐ็ๅฎๅธๅฑ็ๆพ็คบๅ่กจ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.updateDisplayListReal = function (width, height) {
        };
        /**
         * Allocate blank area for each variable size element.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธบๆฏไธชๅฏๅๅฐบๅฏธ็ๅญ้กนๅ้็ฉบ็ฝๅบๅใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        LinearLayoutBase.prototype.flexChildrenProportionally = function (spaceForChildren, spaceToDistribute, totalPercent, childInfoArray) {
            var numElements = childInfoArray.length;
            var done;
            do {
                done = true;
                var unused = spaceToDistribute -
                    (spaceForChildren * totalPercent / 100);
                if (unused > 0)
                    spaceToDistribute -= unused;
                else
                    unused = 0;
                var spacePerPercent = spaceToDistribute / totalPercent;
                for (var i = 0; i < numElements; i++) {
                    var childInfo = childInfoArray[i];
                    var size = childInfo.percent * spacePerPercent;
                    if (size < childInfo.min) {
                        var min = childInfo.min;
                        childInfo.size = min;
                        childInfoArray[i] = childInfoArray[--numElements];
                        childInfoArray[numElements] = childInfo;
                        totalPercent -= childInfo.percent;
                        if (unused >= min) {
                            unused -= min;
                        }
                        else {
                            spaceToDistribute -= min - unused;
                            unused = 0;
                        }
                        done = false;
                        break;
                    }
                    else if (size > childInfo.max) {
                        var max = childInfo.max;
                        childInfo.size = max;
                        childInfoArray[i] = childInfoArray[--numElements];
                        childInfoArray[numElements] = childInfo;
                        totalPercent -= childInfo.percent;
                        if (unused >= max) {
                            unused -= max;
                        }
                        else {
                            spaceToDistribute -= max - unused;
                            unused = 0;
                        }
                        done = false;
                        break;
                    }
                    else {
                        childInfo.size = size;
                    }
                }
            } while (!done);
        };
        return LinearLayoutBase;
    }(eui.LayoutBase));
    eui.LinearLayoutBase = LinearLayoutBase;
    __reflect(LinearLayoutBase.prototype, "eui.LinearLayoutBase");
})(eui || (eui = {}));
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         */
        var ChildInfo = (function () {
            function ChildInfo() {
                /**
                 * @private
                 */
                this.layoutElement = null;
                /**
                 * @private
                 */
                this.size = 0;
                /**
                 * @private
                 */
                this.percent = NaN;
                /**
                 * @private
                 */
                this.min = NaN;
                /**
                 * @private
                 */
                this.max = NaN;
            }
            return ChildInfo;
        }());
        sys.ChildInfo = ChildInfo;
        __reflect(ChildInfo.prototype, "eui.sys.ChildInfo");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The HSlider (horizontal slider) control lets users select a value
     * by moving a slider thumb between the end points of the slider track.
     * The current value of the slider is determined by the relative location of the thumb between
     * the end points of the slider, corresponding to the slider's minimum and maximum values.
     *
     * @includeExample  extension/eui/components/HSliderExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ไฝฟ็จ HSlider๏ผๆฐดๅนณๆปๅ๏ผๆงไปถ๏ผ็จๆทๅฏ้่ฟๅจๆปๅ่ฝจ้็็ซฏ็นไน้ด็งปๅจๆปๅๆฅ้ๆฉๅผใ
     * ๆปๅ็ๅฝๅๅผ็ฑๆปๅ็ซฏ็น๏ผๅฏนๅบไบๆปๅ็ๆๅฐๅผๅๆๅคงๅผ๏ผไน้ดๆปๅ็็ธๅฏนไฝ็ฝฎ็กฎๅฎใ
     *
     * @includeExample  extension/eui/components/HSliderExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var HSlider = (function (_super) {
        __extends(HSlider, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function HSlider() {
            return _super.call(this) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HSlider.prototype.pointToValue = function (x, y) {
            if (!this.thumb || !this.track)
                return 0;
            var values = this.$Range;
            var range = values[0 /* maximum */] - values[2 /* minimum */];
            var thumbRange = this.getThumbRange();
            return values[2 /* minimum */] + (thumbRange != 0 ? (x / thumbRange) * range : 0);
        };
        /**
         * @private
         *
         * @returns
         */
        HSlider.prototype.getThumbRange = function () {
            var bounds = egret.$TempRectangle;
            this.track.getLayoutBounds(bounds);
            var thumbRange = bounds.width;
            this.thumb.getLayoutBounds(bounds);
            return thumbRange - bounds.width;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HSlider.prototype.updateSkinDisplayList = function () {
            if (!this.thumb || !this.track)
                return;
            var values = this.$Range;
            var thumbRange = this.getThumbRange();
            var range = values[0 /* maximum */] - values[2 /* minimum */];
            var thumbPosTrackX = (range > 0) ? ((this.pendingValue - values[2 /* minimum */]) / range) * thumbRange : 0;
            var thumbPos = this.track.localToGlobal(thumbPosTrackX, 0, egret.$TempPoint);
            var thumbPosX = thumbPos.x;
            var thumbPosY = thumbPos.y;
            var thumbPosParentX = this.thumb.$parent.globalToLocal(thumbPosX, thumbPosY, egret.$TempPoint).x;
            var bounds = egret.$TempRectangle;
            this.thumb.getLayoutBounds(bounds);
            this.thumb.setLayoutBoundsPosition(Math.round(thumbPosParentX), bounds.y);
            if (this.trackHighlight && this.trackHighlight.$parent) {
                var trackHighlightX = this.trackHighlight.$parent.globalToLocal(thumbPosX, thumbPosY, egret.$TempPoint).x - thumbPosTrackX;
                this.trackHighlight.x = Math.round(trackHighlightX);
                this.trackHighlight.width = Math.round(thumbPosTrackX);
            }
        };
        return HSlider;
    }(eui.SliderBase));
    eui.HSlider = HSlider;
    __reflect(HSlider.prototype, "eui.HSlider");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var loaderPool = [];
    var callBackMap = {};
    var loaderMap = {};
    /**
     * Default instance of interface <code>IAssetAdapter</code>.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/supportClasses/DefaultAssetAdapterExample.ts
     * @language en_US
     */
    /**
     * ้ป่ฎค็IAssetAdapterๆฅๅฃๅฎ็ฐใ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/supportClasses/DefaultAssetAdapterExample.ts
     * @language zh_CN
     */
    var DefaultAssetAdapter = (function () {
        function DefaultAssetAdapter() {
        }
        /**
         * resolve asset.
         * @param source the identifier of new asset need to be resolved
         * @param callBack callback function when resolving complete
         * example๏ผcallBack(content:any,source:string):void;
         * @param thisObject <code>this</code> object of callback method
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฃๆ็ดๆ
         * @param source ๅพ่งฃๆ็ๆฐ็ดๆๆ่ฏ็ฌฆ
         * @param callBack ่งฃๆๅฎๆๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผcallBack(content:any,source:string):void;
         * @param thisObject callBack็ this ๅผ็จ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        DefaultAssetAdapter.prototype.getAsset = function (source, callBack, thisObject) {
            var list = callBackMap[source];
            if (list) {
                list.push([callBack, thisObject]);
                return;
            }
            var loader = loaderPool.pop();
            if (!loader) {
                loader = new egret.ImageLoader();
            }
            callBackMap[source] = [[callBack, thisObject]];
            loaderMap[loader.$hashCode] = source;
            loader.addEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
            loader.addEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            loader.load(source);
        };
        /**
         * @private
         *
         * @param event
         */
        DefaultAssetAdapter.prototype.onLoadFinish = function (event) {
            var loader = event.currentTarget;
            loader.removeEventListener(egret.Event.COMPLETE, this.onLoadFinish, this);
            loader.removeEventListener(egret.IOErrorEvent.IO_ERROR, this.onLoadFinish, this);
            var data;
            if (event.$type == egret.Event.COMPLETE) {
                data = new egret.Texture();
                data._setBitmapData(loader.data);
                loader.data = null;
            }
            loaderPool.push(loader);
            var source = loaderMap[loader.$hashCode];
            delete loaderMap[loader.$hashCode];
            var list = callBackMap[source];
            delete callBackMap[source];
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var arr = list[i];
                arr[0].call(arr[1], data, source);
            }
        };
        return DefaultAssetAdapter;
    }());
    eui.DefaultAssetAdapter = DefaultAssetAdapter;
    __reflect(DefaultAssetAdapter.prototype, "eui.DefaultAssetAdapter", ["eui.IAssetAdapter"]);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="supportClasses/DefaultAssetAdapter.ts" />
var eui;
(function (eui) {
    /**
     * The Image control lets you show JPEG, PNG, and GIF files
     * at runtime. Image inherit Bitmap๏ผso you can set the <code>bitmapData</code> property
     * to show the data. you can also set the <code>source</code> property, Image will auto load
     * and show the url image or the bitmapData.
     *
     * @event egret.Event.COMPLETE Dispatched when the image loaded complete.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ImageExample.ts
     * @language en_US
     */
    /**
     * Image ๆงไปถๅ่ฎธๆจๅจ่ฟ่กๆถๆพ็คบ JPEGใPNG ็ญๅพ็ๆไปถๆไปถใImage ็ปงๆฟ่ณ Bitmap๏ผๅๆญคๆจๅฏไปฅ็ดๆฅๅฏนๅถ bitmapData ๅฑๆง๏ผ
     * ่ตๅผไปๅค้จๅ่ฝฝๅพๅฐ็ไฝๅพๆฐๆฎไปฅๆพ็คบๅฏนๅบๅพ็ใๅๆถ๏ผImage ่ฟๆไพไบๆดๅๆนไพฟ็ source ๅฑๆง๏ผsource ๅฑๆงๅฏไปฅๆฅๅไธไธช็ฝ็ปๅพ็urlไฝไธบๅผ๏ผ
     * ่ตๅผไธบurlๅ๏ผๅฎๅ้จไผ่ชๅจๅปๅ่ฝฝๅนถๆพ็คบๅพ็ใๅนถไธๆจๅๆทไนๅฏไปฅ็ดๆฅๆ BitmapData ๅฏน่ฑก่ตๅผ็ป source ๅฑๆงไปฅๆพ็คบๅพ็ใ
     *
     * @event egret.Event.COMPLETE ๅฝๅพ็ๅ่ฝฝๅฎๆๅ่ฐๅบฆ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ImageExample.ts
     * @language zh_CN
     */
    var Image = (function (_super) {
        __extends(Image, _super);
        /**
         * Constructor.
         *
         * @param source The source used for the bitmap fill. the value can be
         * a string or an instance of <code>egret.Texture</code>
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @param source ็จไบไฝๅพๅกซๅ็ๆบใๅฏไปฅๆฏไธไธชๅญ็ฌฆไธฒๆ่ <code>egret.Texture</code> ๅฏน่ฑก
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Image(source) {
            var _this = _super.call(this) || this;
            //endif*/
            /**
             * @private
             */
            _this.sourceChanged = false;
            /**
             * @private
             */
            _this._source = null;
            _this.initializeUIValues();
            if (source) {
                _this.source = source;
            }
            return _this;
        }
        Object.defineProperty(Image.prototype, "scale9Grid", {
            /**
             * Represent a Rectangle Area that the 9 scale area of Image.
             * Notice: This property is valid only when <code>fillMode</code>
             * is <code>BitmapFillMode.SCALE</code>.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฉๅฝขๅบๅ๏ผๅฎๅฎไน็ดๆๅฏน่ฑก็ไนไธช็ผฉๆพๅบๅใ
             * ๆณจๆ:ๆญคๅฑๆงไปๅจ<code>fillMode</code>ไธบ<code>BitmapFillMode.SCALE</code>ๆถๆๆใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$scale9Grid;
            },
            set: function (value) {
                this.$scale9Grid = value;
                this.$invalidateContentBounds();
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Image.prototype, "fillMode", {
            /**
             * Determines how the bitmap fills in the dimensions.
             * <p>When set to <code>BitmapFillMode.CLIP</code>, the bitmap
             * ends at the edge of the region.</p>
             * <p>When set to <code>BitmapFillMode.REPEAT</code>, the bitmap
             * repeats to fill the region.</p>
             * <p>When set to <code>BitmapFillMode.SCALE</code>, the bitmap
             * stretches to fill the region.</p>
             *
             * @default <code>BitmapFillMode.SCALE</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็กฎๅฎไฝๅพๅกซๅๅฐบๅฏธ็ๆนๅผใ
             * <p>่ฎพ็ฝฎไธบ <code>BitmapFillMode.CLIP</code>ๆถ๏ผไฝๅพๅฐๅจ่พน็ผๅค่ขซๆชๆญใ</p>
             * <p>่ฎพ็ฝฎไธบ <code>BitmapFillMode.REPEAT</code>ๆถ๏ผไฝๅพๅฐ้ๅคไปฅๅกซๅๅบๅใ</p>
             * <p>่ฎพ็ฝฎไธบ <code>BitmapFillMode.SCALE</code>ๆถ๏ผไฝๅพๅฐๆไผธไปฅๅกซๅๅบๅใ</p>
             *
             * @default <code>BitmapFillMode.SCALE</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$fillMode;
            },
            set: function (value) {
                if (value == this.$fillMode) {
                    return;
                }
                this.$fillMode = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        //if egret
        Image.prototype.$setFillMode = function (value) {
            var result = _super.prototype.$setFillMode.call(this, value);
            this.invalidateDisplayList();
            return result;
        };
        Object.defineProperty(Image.prototype, "source", {
            /**
             * The source used for the bitmap fill. the value can be
             * a string or an instance of <code>egret.Texture</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็จไบไฝๅพๅกซๅ็ๆบใๅฏไปฅๆฏไธไธชๅญ็ฌฆไธฒๆ่ <code>egret.Texture</code> ๅฏน่ฑก
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._source;
            },
            set: function (value) {
                if (value == this._source) {
                    return;
                }
                this._source = value;
                if (this.$stage) {
                    this.parseSource();
                }
                else {
                    this.sourceChanged = true;
                    this.invalidateProperties();
                }
            },
            enumerable: true,
            configurable: true
        });
        Image.prototype.$setBitmapData = function (value) {
            if (value == this.$Bitmap[0 /* bitmapData */]) {
                return false;
            }
            var result = _super.prototype.$setBitmapData.call(this, value);
            this.sourceChanged = false;
            this.invalidateSize();
            this.invalidateDisplayList();
            return result;
        };
        /**
         * @private
         * ่งฃๆsource
         */
        Image.prototype.parseSource = function () {
            var _this = this;
            this.sourceChanged = false;
            var source = this._source;
            if (source && typeof source == "string") {
                eui.getAssets(this._source, function (data) {
                    if (source !== _this._source)
                        return;
                    if (!egret.is(data, "egret.Texture")) {
                        return;
                    }
                    _this.$setBitmapData(data);
                    if (data) {
                        _this.dispatchEventWith(egret.Event.COMPLETE);
                    }
                    else if (true) {
                        egret.$warn(2301, source);
                    }
                });
            }
            else {
                this.$setBitmapData(source);
            }
        };
        Image.prototype.$measureContentBounds = function (bounds) {
            var values = this.$Bitmap;
            var image = this.$Bitmap[0 /* bitmapData */];
            if (image) {
                var uiValues = this.$UIComponent;
                var width = uiValues[10 /* width */];
                var height = uiValues[11 /* height */];
                if (isNaN(width) || isNaN(height)) {
                    bounds.setEmpty();
                    return;
                }
                if (this.$fillMode == "clip") {
                    if (width > image.$getTextureWidth()) {
                        width = image.$getTextureWidth();
                    }
                    if (height > image.$getTextureHeight()) {
                        height = image.$getTextureHeight();
                    }
                }
                bounds.setTo(0, 0, width, height);
            }
            else {
                bounds.setEmpty();
            }
        };
        /**
         * @private
         *
         * @param context
         */
        Image.prototype.$render = function () {
            var image = this.$Bitmap[0 /* bitmapData */];
            if (!image) {
                return;
            }
            var uiValues = this.$UIComponent;
            var width = uiValues[10 /* width */];
            var height = uiValues[11 /* height */];
            if (width === 0 || height === 0) {
                return;
            }
            var values = this.$Bitmap;
            egret.sys.BitmapNode.$updateTextureData(this.$renderNode, values[1 /* image */], values[2 /* bitmapX */], values[3 /* bitmapY */], values[4 /* bitmapWidth */], values[5 /* bitmapHeight */], values[6 /* offsetX */], values[7 /* offsetY */], values[8 /* textureWidth */], values[9 /* textureHeight */], width, height, values[13 /* sourceWidth */], values[14 /* sourceHeight */], this.scale9Grid || values[0 /* bitmapData */]["scale9Grid"], this.$fillMode, values[10 /* smoothing */]);
        };
        /**
         * @copy eui.UIComponent#createChildren
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.createChildren = function () {
            if (this.sourceChanged) {
                this.parseSource();
            }
        };
        /**
         * @copy eui.UIComponent#childrenCreated
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.childrenCreated = function () {
        };
        /**
         * @copy eui.UIComponent#commitProperties
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.commitProperties = function () {
            eui.sys.UIComponentImpl.prototype["commitProperties"].call(this);
            if (this.sourceChanged) {
                this.parseSource();
            }
        };
        /**
         * @copy eui.UIComponent#measure
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.measure = function () {
            var bitmapData = this.$Bitmap[0 /* bitmapData */];
            if (bitmapData) {
                this.setMeasuredSize(bitmapData.$getTextureWidth(), bitmapData.$getTextureHeight());
            }
            else {
                this.setMeasuredSize(0, 0);
            }
        };
        /**
         * @copy eui.UIComponent#updateDisplayList
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            this.$invalidateContentBounds();
        };
        /**
         * @copy eui.UIComponent#invalidateParentLayout
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Image.prototype.getPreferredBounds = function (bounds) {
        };
        return Image;
    }(egret.Bitmap));
    eui.Image = Image;
    __reflect(Image.prototype, "eui.Image", ["eui.UIComponent", "egret.DisplayObject"]);
    eui.sys.implementUIComponent(Image, egret.Bitmap);
    eui.registerProperty(Image, "scale9Grid", "egret.Rectangle");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../utils/registerBindable.ts" />
var eui;
(function (eui) {
    /**
     * The ItemRenderer class is the base class for item renderers.
     *
     * @state up Up state
     * @state down Down state
     * @state upAndSelected Up state when the button is selected
     * @state downAndSelected Down state when the button is selected
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ItemRendererExample.ts
     * @language en_US
     */
    /**
     * ItemRenderer ็ฑปๆฏ้กนๅ็คบๅจ็ๅบ็ฑปใ
     *
     * @state up ๅผน่ตท็ถๆ
     * @state down ๆไธ็ถๆ
     * @state upAndSelected ้ๆฉๆถ็ๅผน่ตท็ถๆ
     * @state downAndSelected ้ๆฉๆถ็ๆไธ็ถๆ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ItemRendererExample.ts
     * @language zh_CN
     */
    var ItemRenderer = (function (_super) {
        __extends(ItemRenderer, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ItemRenderer() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this._data = null;
            /**
             * @private
             */
            _this._selected = false;
            /**
             * The index of the item in the data provider
             * of the host component of the item renderer.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ้กนๅ็คบๅจ็ๆฐๆฎๆไพ็จๅบไธญ็้กน็ฎ็ดขๅผใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.itemIndex = -1;
            /**
             * @private
             * ๆ็คบ็ฌฌไธๆฌกๅๆดพ TouchEvent.TOUCH_BEGIN ๆถ๏ผ่งฆๆธ็นๆฏๅฆๅจๆ้ฎไธใ
             */
            _this.touchCaptured = false;
            _this.addEventListener(egret.TouchEvent.TOUCH_BEGIN, _this.onTouchBegin, _this);
            return _this;
        }
        Object.defineProperty(ItemRenderer.prototype, "data", {
            /**
             * The data to render or edit.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๅ็คบๆ็ผ่พ็ๆฐๆฎใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._data;
            },
            set: function (value) {
                this._data = value;
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "data");
                this.dataChanged();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Update the view when the <code>data</code> property changes.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝๆฐๆฎๆนๅๆถ๏ผๆดๆฐ่งๅพใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ItemRenderer.prototype.dataChanged = function () {
        };
        Object.defineProperty(ItemRenderer.prototype, "selected", {
            /**
             * Contains <code>true</code> if the item renderer
             * can show itself as selected.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆ้กนๅ็คบๅจๅฏไปฅๅฐๅถ่ช่บซๆพ็คบไธบๅทฒ้ไธญ๏ผๅไธบ trueใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._selected;
            },
            set: function (value) {
                if (this._selected == value)
                    return;
                this._selected = value;
                this.invalidateState();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Dispatched when an event of some kind occurred that canceled the touch.
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ฑไบๆไธชไบไปถๅๆถไบ่งฆๆธๆถ่งฆๅ
         * @version Egret 3.0.1
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ItemRenderer.prototype.onTouchCancle = function (event) {
            this.touchCaptured = false;
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            this.invalidateState();
        };
        /**
         * Handles <code>TouchEvent.TOUCH_BEGIN</code> events
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฆ็ขฐๅผๅงๆถ่งฆๅไบไปถ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ItemRenderer.prototype.onTouchBegin = function (event) {
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            this.touchCaptured = true;
            this.invalidateState();
            event.updateAfterEvent();
        };
        /**
         * @private
         * ่ๅฐไธ่งฆๆธๅผน่ตทไบไปถ
         */
        ItemRenderer.prototype.onStageTouchEnd = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancle, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onStageTouchEnd, this);
            this.touchCaptured = false;
            this.invalidateState();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ItemRenderer.prototype.getCurrentState = function () {
            var state = "up";
            if (!this.enabled) {
                state = "disabled";
            }
            if (this.touchCaptured) {
                state = "down";
            }
            if (this._selected) {
                var selectedState = state + "AndSelected";
                var skin = this.skin;
                if (skin && skin.hasState(selectedState)) {
                    return selectedState;
                }
                return state == "disabled" ? "disabled" : "down";
            }
            return state;
        };
        return ItemRenderer;
    }(eui.Component));
    eui.ItemRenderer = ItemRenderer;
    __reflect(ItemRenderer.prototype, "eui.ItemRenderer", ["eui.IItemRenderer"]);
    eui.registerBindable(ItemRenderer.prototype, "data");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var UIImpl = eui.sys.UIComponentImpl;
    /**
     * Label is an UIComponent that can render one or more lines of text.
     * The text to be displayed is determined by the <code>text</code> property.
     * The formatting of the text is specified by the styles๏ผ
     * such as <code>fontFamily</code> and <code>size</code>.
     *
     * <p>Because Label is fast and lightweight, it is especially suitable
     * for use cases that involve rendering many small pieces of non-interactive
     * text, such as item renderers and labels in Button skins.</p>
     *
     * <p>In Label, three character sequences are recognized
     * as explicit line breaks: CR (<code>"\r"</code>), LF (<code>"\n"</code>),
     * and CR+LF (<code>"\r\n"</code>).</p>
     *
     * <p>If you don't specify any kind of width for a Label,
     * then the longest line, as determined by these explicit line breaks,
     * determines the width of the Label.</p>
     *
     * <p>If you do specify some kind of width, then the specified text is
     * word-wrapped at the right edge of the component's bounds.
     * If the text extends below the bottom of the component,
     * it is clipped.</p>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/LabelExample.ts
     * @language en_US
     */
    /**
     * Label ๆฏๅฏไปฅๅ็คบไธ่กๆๅค่ก็ปไธๆผๅผๆๆฌ็UI็ปไปถใ่ฆๆพ็คบ็ๆๆฌ็ฑ text ๅฑๆง็กฎๅฎใๆๆฌๆผๅผ็ฑๆทๅผๅฑๆงๆๅฎ๏ผไพๅฆ fontFamily ๅ sizeใ
     * ๅไธบ Label ่ฟ่ก้ๅบฆๅฟซไธๅ็จๅๅญๅฐ๏ผๆไปฅๅฎ็นๅซ้ๅ็จไบๆพ็คบๅคไธชๅฐๅ้ไบคไบๅผๆๆฌ็ๆๅต๏ผไพๅฆ๏ผ้กนๅ็คบๅจๅ Button ๅค่งไธญ็ๆ็ญพใ
     * ๅจ Label ไธญ๏ผๅฐไปฅไธไธไธชๅญ็ฌฆๅบๅ่ฏๅซไธบๆพๅผๆข่ก็ฌฆ๏ผCR๏ผโ\rโ๏ผใLF๏ผโ\nโ๏ผๅ CR+LF๏ผโ\r\nโ๏ผใ
     * ๅฆๆๆฒกๆไธบ Label ๆๅฎๅฎฝๅบฆ๏ผๅ็ฑ่ฟไบๆพๅผๆข่ก็ฌฆ็กฎๅฎ็ๆ้ฟ่ก็กฎๅฎ Label ็ๅฎฝๅบฆใ
     * ๅฆๆๆๅฎไบๅฎฝๅบฆ๏ผๅๆๅฎๆๆฌๅฐๅจ็ปไปถ่พน็็ๅณ่พน็ผๆข่ก๏ผๅฆๆๆๆฌๆฉๅฑๅฐไฝไบ็ปไปถๅบ้จ๏ผๅๅฐ่ขซๅชๅใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/LabelExample.ts
     * @language zh_CN
     */
    var Label = (function (_super) {
        __extends(Label, _super);
        /**
         * Constructor.
         *
         * @param text The text displayed by this text component.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @param text ๆญคๆๆฌ็ปไปถๆๆพ็คบ็ๆๆฌใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Label(text) {
            var _this = _super.call(this) || this;
            /**
             * styleไธญๅฑๆงๆฏๅฆๅ่ฎธ่ขซ่ตๅผ๏ผๅฝไธปๅจ่ตๅผ่ฟๅฑๆงไนๅๅฐไธๅ่ฎธ่ขซ่ตๅผ
             */
            _this.$styleSetMap = {
                "fontFamily": true,
                "size": true,
                "bold": true,
                "italic": true,
                "textAlign": true,
                "verticalAlign": true,
                "lineSpacing": true,
                "textColor": true,
                "wordWrap": true,
                "displayAsPassword": true,
                "strokeColor": true,
                "stroke": true,
                "maxChars": true,
                "multiline": true,
                "border": true,
                "borderColor": true,
                "background": true,
                "backgroundColor": true
            };
            _this.$revertStyle = {};
            _this.$style = null;
            _this.$changeFromStyle = false;
            /**
             * @private
             */
            _this._widthConstraint = NaN;
            _this.initializeUIValues();
            _this.text = text;
            return _this;
        }
        Object.defineProperty(Label.prototype, "style", {
            /**
             * The style of text.
             * @version Egret 3.2.1
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๆฌๆทๅผใ
             * @version Egret 3.2.1
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$style;
            },
            set: function (value) {
                this.$setStyle(value);
            },
            enumerable: true,
            configurable: true
        });
        Label.prototype.$setStyle = function (value) {
            if (this.$style == value) {
                return;
            }
            this.$style = value;
            var theme = egret.getImplementation("eui.Theme");
            if (theme) {
                this.$changeFromStyle = true;
                for (var key in this.$revertStyle) {
                    this[key] = this.$revertStyle[key];
                }
                this.$revertStyle = {};
                if (value == null) {
                    this.$changeFromStyle = false;
                    return;
                }
                var styleList = value.split(",");
                for (var i = 0; i < styleList.length; i++) {
                    var config = theme.$getStyleConfig(styleList[i]);
                    if (config) {
                        for (var key in config) {
                            if (this.$styleSetMap[key]) {
                                var revertValue = this[key];
                                this[key] = config[key];
                                this.$revertStyle[key] = revertValue;
                            }
                        }
                    }
                }
                this.$changeFromStyle = false;
            }
        };
        Label.prototype.$setFontFamily = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["fontFanily"];
                this.$styleSetMap["fontFanily"] = false;
            }
            return _super.prototype.$setFontFamily.call(this, value);
        };
        Label.prototype.$setSize = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["size"];
                this.$styleSetMap["size"] = false;
            }
            return _super.prototype.$setSize.call(this, value);
        };
        Label.prototype.$setBold = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["bold"];
                this.$styleSetMap["bold"] = false;
            }
            return _super.prototype.$setBold.call(this, value);
        };
        Label.prototype.$setItalic = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["italic"];
                this.$styleSetMap["italic"] = false;
            }
            return _super.prototype.$setItalic.call(this, value);
        };
        Label.prototype.$setTextAlign = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["textAlign"];
                this.$styleSetMap["textAlign"] = false;
            }
            return _super.prototype.$setTextAlign.call(this, value);
        };
        Label.prototype.$setVerticalAlign = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["verticalAlign"];
                this.$styleSetMap["verticalAlign"] = false;
            }
            return _super.prototype.$setVerticalAlign.call(this, value);
        };
        Label.prototype.$setLineSpacing = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["lineSpacing"];
                this.$styleSetMap["lineSpacing"] = false;
            }
            return _super.prototype.$setLineSpacing.call(this, value);
        };
        Label.prototype.$setTextColor = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["textColor"];
                this.$styleSetMap["textColor"] = false;
            }
            return _super.prototype.$setTextColor.call(this, value);
        };
        Label.prototype.$setWordWrap = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["wordWrap"];
                this.$styleSetMap["wordWrap"] = false;
            }
            _super.prototype.$setWordWrap.call(this, value);
        };
        Label.prototype.$setDisplayAsPassword = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["displayAsPassword"];
                this.$styleSetMap["displayAsPassword"] = false;
            }
            return _super.prototype.$setDisplayAsPassword.call(this, value);
        };
        Label.prototype.$setStrokeColor = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["strokeColor"];
                this.$styleSetMap["strokeColor"] = false;
            }
            return _super.prototype.$setStrokeColor.call(this, value);
        };
        Label.prototype.$setStroke = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["stroke"];
                this.$styleSetMap["stroke"] = false;
            }
            return _super.prototype.$setStroke.call(this, value);
        };
        Label.prototype.$setMaxChars = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["maxChars"];
                this.$styleSetMap["maxChars"] = false;
            }
            return _super.prototype.$setMaxChars.call(this, value);
        };
        Label.prototype.$setMultiline = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["multiline"];
                this.$styleSetMap["multiline"] = false;
            }
            return _super.prototype.$setMultiline.call(this, value);
        };
        Label.prototype.$setBorder = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["border"];
                this.$styleSetMap["border"] = false;
            }
            _super.prototype.$setBorder.call(this, value);
        };
        Label.prototype.$setBorderColor = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["borderColor"];
                this.$styleSetMap["borderColor"] = false;
            }
            _super.prototype.$setBorderColor.call(this, value);
        };
        Label.prototype.$setBackground = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["background"];
                this.$styleSetMap["background"] = false;
            }
            _super.prototype.$setBackground.call(this, value);
        };
        Label.prototype.$setBackgroundColor = function (value) {
            if (!this.$changeFromStyle) {
                delete this.$revertStyle["backgroundColor"];
                this.$styleSetMap["backgroundColor"] = false;
            }
            _super.prototype.$setBackgroundColor.call(this, value);
        };
        /**
         * @private
         *
         */
        Label.prototype.$invalidateContentBounds = function () {
            _super.prototype.$invalidateContentBounds.call(this);
            this.invalidateSize();
        };
        /**
         * @private
         *
         * @param value
         */
        Label.prototype.$setWidth = function (value) {
            var result1 = _super.prototype.$setWidth.call(this, value);
            var result2 = UIImpl.prototype.$setWidth.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        Label.prototype.$setHeight = function (value) {
            var result1 = _super.prototype.$setHeight.call(this, value);
            var result2 = UIImpl.prototype.$setHeight.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        Label.prototype.$setText = function (value) {
            var result = _super.prototype.$setText.call(this, value);
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "text");
            return result;
        };
        /**
         * @copy eui.UIComponent#createChildren
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.createChildren = function () {
        };
        /**
         * @copy eui.UIComponent#childrenCreated
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.childrenCreated = function () {
        };
        /**
         * @copy eui.UIComponent#commitProperties
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.commitProperties = function () {
        };
        /**
         * @copy eui.UIComponent#measure
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.measure = function () {
            var values = this.$UIComponent;
            var textValues = this.$TextField;
            var oldWidth = textValues[3 /* textFieldWidth */];
            var availableWidth = NaN;
            if (!isNaN(this._widthConstraint)) {
                availableWidth = this._widthConstraint;
                this._widthConstraint = NaN;
            }
            else if (!isNaN(values[8 /* explicitWidth */])) {
                availableWidth = values[8 /* explicitWidth */];
            }
            else if (values[13 /* maxWidth */] != 100000) {
                availableWidth = values[13 /* maxWidth */];
            }
            _super.prototype.$setWidth.call(this, availableWidth);
            this.setMeasuredSize(this.textWidth, this.textHeight);
            _super.prototype.$setWidth.call(this, oldWidth);
        };
        /**
         * @copy eui.UIComponent#updateDisplayList
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.$setWidth.call(this, unscaledWidth);
            _super.prototype.$setHeight.call(this, unscaledHeight);
        };
        /**
         * @copy eui.UIComponent#invalidateParentLayout
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
            UIImpl.prototype.setLayoutBoundsSize.call(this, layoutWidth, layoutHeight);
            if (isNaN(layoutWidth) || layoutWidth === this._widthConstraint || layoutWidth == 0) {
                this._widthConstraint = layoutWidth;
                return;
            }
            this._widthConstraint = layoutWidth;
            var values = this.$UIComponent;
            if (!isNaN(values[9 /* explicitHeight */])) {
                return;
            }
            if (layoutWidth == values[16 /* measuredWidth */]) {
                return;
            }
            this.invalidateSize();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Label.prototype.getPreferredBounds = function (bounds) {
        };
        return Label;
    }(egret.TextField));
    eui.Label = Label;
    __reflect(Label.prototype, "eui.Label", ["eui.UIComponent", "egret.DisplayObject", "eui.IDisplayText"]);
    eui.sys.implementUIComponent(Label, egret.TextField);
    eui.registerBindable(Label.prototype, "text");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The List control displays a vertical or horizontal list of items.
     * The user can select one or more items from the list, depending
     * on the value of the <code>allowMultipleSelection</code> property.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ListExample.ts
     * @language en_US
     */
    /**
     * List ๆงไปถๅฏๆพ็คบๅ็ดๆๆฐดๅนณ็้กน็ฎๅ่กจใ็จๆทๅฏไปฅๆนๆฎ <code>allowMultipleSelection</code> ๅฑๆง็ๅผไปๅ่กจไธญ้ๆฉไธไธชๆๅคไธช้กน็ฎใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ListExample.ts
     * @language zh_CN
     */
    var List = (function (_super) {
        __extends(List, _super);
        function List() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            /**
             * whether are allowed to multiple selection.
             * If <code>true</code> tap an unselected item will be selected,
             * and tap the item again will cancel selection.
             *
             * @default false
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฏๅฆๅ่ฎธๅๆถ้ไธญๅค้กน,่ฎพ็ฝฎไธบ <code>true</code> ๆถ๏ผ่งฆๆธๆไธๆช้ไธญ็้กนๅ็คบๅจ๏ผๅฐไผ่ฎพ็ฝฎ่ฏฅ้กน้ไธญ๏ผๅๆฌกๆไธๅฐไผๅๆถ้ไธญใ
             * ๅฏไปฅ่ฎพ็ฝฎๅค้กนไธบ้ไธญ็ถๆใ
             *
             * @default false
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.allowMultipleSelection = false;
            /**
             * @private
             */
            _this._selectedIndices = [];
            /**
             * @private
             * ๆฏๅฆๆฏๆๆ็็ดขๅผ
             */
            _this.isValidIndex = function (item, index, v) {
                return _this.$dataProvider && (item >= 0) && (item < _this.$dataProvider.length) && item % 1 == 0;
            };
            return _this;
        }
        Object.defineProperty(List.prototype, "selectedIndices", {
            /**
             * An Array of numbers representing the indices of the currently selected
             * item or items.
             *
             * @default []
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝๅ้ไธญ็ไธไธชๆๅคไธช้กน็ฎ็็ดขๅผๅ่กจใ
             *
             * @default []
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (this._proposedSelectedIndices)
                    return this._proposedSelectedIndices;
                return this._selectedIndices;
            },
            set: function (value) {
                this.setSelectedIndices(value, false);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(List.prototype, "selectedIndex", {
            /**
             * @inheritDoc
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this._proposedSelectedIndices) {
                    if (this._proposedSelectedIndices.length > 0)
                        return this._proposedSelectedIndices[0];
                    return -1;
                }
                return this.$getSelectedIndex();
            },
            set: function (value) {
                this.setSelectedIndex(value);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(List.prototype, "selectedItems", {
            /**
             * An Array representing the currently selected data items.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กจ็คบๅฝๅ้ๅฎๆฐๆฎ้กน็ๅ่กจ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var result = [];
                var list = this.selectedIndices;
                if (list) {
                    var count = list.length;
                    for (var i = 0; i < count; i++) {
                        result[i] = this.$dataProvider.getItemAt(list[i]);
                    }
                }
                return result;
            },
            set: function (value) {
                var indices = [];
                if (value) {
                    var count = value.length;
                    for (var i = 0; i < count; i++) {
                        var index = this.$dataProvider.getItemIndex(value[i]);
                        if (index != -1) {
                            indices.splice(0, 0, index);
                        }
                        if (index == -1) {
                            indices = [];
                            break;
                        }
                    }
                }
                this.setSelectedIndices(indices, false);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Specify whether the selectedIndices changed programmatically or due to
         * user interaction.
         *
         * @param value An array of numbers representing the indices of the selected
         * @param dispatchChangeEvent whether dispatched a change event.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎๅคไธช้ไธญ้กนใ
         *
         * @param value ้ไธญ้กน็ดขๅผ็ๆฐ็ป
         * @param dispatchChangeEvent ๆฏๅฆๆดพๅchangedไบไปถ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        List.prototype.setSelectedIndices = function (value, dispatchChangeEvent) {
            var values = this.$ListBase;
            if (dispatchChangeEvent)
                values[4 /* dispatchChangeAfterSelection */] =
                    (values[4 /* dispatchChangeAfterSelection */] || dispatchChangeEvent);
            if (value)
                this._proposedSelectedIndices = value;
            else
                this._proposedSelectedIndices = [];
            this.invalidateProperties();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        List.prototype.commitProperties = function () {
            _super.prototype.commitProperties.call(this);
            if (this._proposedSelectedIndices) {
                this.commitSelection();
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        List.prototype.commitSelection = function (dispatchChangedEvents) {
            if (dispatchChangedEvents === void 0) {
                dispatchChangedEvents = true;
            }
            var values = this.$ListBase;
            var oldSelectedIndex = values[3 /* selectedIndex */];
            if (this._proposedSelectedIndices) {
                this._proposedSelectedIndices = this._proposedSelectedIndices.filter(this.isValidIndex);
                if (!this.allowMultipleSelection && this._proposedSelectedIndices.length > 0) {
                    var temp = [];
                    temp.push(this._proposedSelectedIndices[0]);
                    this._proposedSelectedIndices = temp;
                }
                if (this._proposedSelectedIndices.length > 0) {
                    values[2 /* proposedSelectedIndex */] = this._proposedSelectedIndices[0];
                }
                else {
                    values[2 /* proposedSelectedIndex */] = -1;
                }
            }
            var retVal = _super.prototype.commitSelection.call(this, false);
            if (!retVal) {
                this._proposedSelectedIndices = null;
                return false;
            }
            var selectedIndex = this.$getSelectedIndex();
            if (selectedIndex > eui.ListBase.NO_SELECTION) {
                if (this._proposedSelectedIndices) {
                    if (this._proposedSelectedIndices.indexOf(selectedIndex) == -1)
                        this._proposedSelectedIndices.push(selectedIndex);
                }
                else {
                    this._proposedSelectedIndices = [selectedIndex];
                }
            }
            if (this._proposedSelectedIndices) {
                if (this._proposedSelectedIndices.indexOf(oldSelectedIndex) != -1)
                    this.itemSelected(oldSelectedIndex, true);
                this.commitMultipleSelection();
            }
            if (dispatchChangedEvents && retVal) {
                if (values[4 /* dispatchChangeAfterSelection */]) {
                    this.dispatchEventWith(egret.Event.CHANGE);
                    values[4 /* dispatchChangeAfterSelection */] = false;
                }
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedIndex");
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedItem");
            }
            return retVal;
        };
        /**
         * Given a new selection interval, figure out which
         * items are newly added/removed from the selection interval and update
         * selection properties and view accordingly.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไป็ปๅฎ็้ๆฉๅบ้ดไธญๆพๅบๆฐๅขๆ่็งป้ค็้กน๏ผๅนถๆดๆฐๅฑๆงใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        List.prototype.commitMultipleSelection = function () {
            var removedItems = [];
            var addedItems = [];
            var i;
            var count;
            var selectedIndices = this._selectedIndices;
            var proposedSelectedIndices = this._proposedSelectedIndices;
            if (selectedIndices.length > 0 && proposedSelectedIndices.length > 0) {
                count = proposedSelectedIndices.length;
                for (i = 0; i < count; i++) {
                    if (selectedIndices.indexOf(proposedSelectedIndices[i]) == -1)
                        addedItems.push(proposedSelectedIndices[i]);
                }
                count = selectedIndices.length;
                for (i = 0; i < count; i++) {
                    if (proposedSelectedIndices.indexOf(selectedIndices[i]) == -1)
                        removedItems.push(selectedIndices[i]);
                }
            }
            else if (selectedIndices.length > 0) {
                removedItems = selectedIndices;
            }
            else if (proposedSelectedIndices.length > 0) {
                addedItems = proposedSelectedIndices;
            }
            this._selectedIndices = proposedSelectedIndices;
            if (removedItems.length > 0) {
                count = removedItems.length;
                for (i = 0; i < count; i++) {
                    this.itemSelected(removedItems[i], false);
                }
            }
            if (addedItems.length > 0) {
                count = addedItems.length;
                for (i = 0; i < count; i++) {
                    this.itemSelected(addedItems[i], true);
                }
            }
            this._proposedSelectedIndices = null;
        };
        /**
         * @private
         *
         * @param index
         * @returns
         */
        List.prototype.$isItemIndexSelected = function (index) {
            if (this.allowMultipleSelection)
                return this._selectedIndices.indexOf(index) != -1;
            return _super.prototype.$isItemIndexSelected.call(this, index);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        List.prototype.dataProviderRefreshed = function () {
            if (this.allowMultipleSelection) {
                return;
            }
            _super.prototype.dataProviderRefreshed.call(this);
        };
        /**
         * @private
         * ่ฎก็ฎๅฝๅ็้ไธญ้กนๅ่กจ
         */
        List.prototype.calculateSelectedIndices = function (index) {
            var interval = [];
            var selectedIndices = this._selectedIndices;
            var length = selectedIndices.length;
            if (length > 0) {
                if (length == 1 && (selectedIndices[0] == index)) {
                    if (!this.$ListBase[0 /* requireSelection */]) {
                        return interval;
                    }
                    interval.splice(0, 0, selectedIndices[0]);
                    return interval;
                }
                else {
                    var found = false;
                    for (var i = 0; i < length; i++) {
                        if (selectedIndices[i] == index) {
                            found = true;
                        }
                        else if (selectedIndices[i] != index) {
                            interval.splice(0, 0, selectedIndices[i]);
                        }
                    }
                    if (!found) {
                        interval.splice(0, 0, index);
                    }
                    return interval;
                }
            }
            else {
                interval.splice(0, 0, index);
                return interval;
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        List.prototype.onRendererTouchEnd = function (event) {
            if (this.allowMultipleSelection) {
                var itemRenderer = (event.currentTarget);
                var touchDownItemRenderer = this.$ListBase[7 /* touchDownItemRenderer */];
                if (itemRenderer != touchDownItemRenderer)
                    return;
                this.setSelectedIndices(this.calculateSelectedIndices(itemRenderer.itemIndex), true);
                eui.ItemTapEvent.dispatchItemTapEvent(this, eui.ItemTapEvent.ITEM_TAP, itemRenderer);
            }
            else {
                _super.prototype.onRendererTouchEnd.call(this, event);
            }
        };
        return List;
    }(eui.ListBase));
    eui.List = List;
    __reflect(List.prototype, "eui.List");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The Panel class defines a container that includes a title bar,
     * a closeButton, a moveArea, and a content area for its children.
     *
     * @event eui.UIEvent.CLOSING Dispatched when the close button is taped
     * you can use <code>event.preventDefault()</code> to prevent close.
     *
     * @defaultProperty elementsContent
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/PanelExample.ts
     * @language en_US
     */
    /**
     * Panel ็ฑปๅฎไนไธไธชๅฎนๅจ๏ผ่ฏฅๅฎนๅจไธบๅถๅญไปฃๆไพๆ้ขๆใๅณ้ญๆ้ฎใๅฏ็งปๅจๅบๅๅๅๅฎนๅบๅใ
     *
     * @event eui.UIEvent.CLOSING ้ขๆฟๅณๅฐๅณ้ญไบไปถ๏ผๅจๅณ้ญๆ้ฎ่ขซ็นๅปๅๆๅบ๏ผ
     * ็ๅฌๆญคไบไปถๅนถ่ฐ็จ<code>event.preventDefault()</code>่ฝๅค้ปๆญข้ขๆฟ่ขซๅณ้ญใ
     *
     * @defaultProperty elementsContent
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/PanelExample.ts
     * @language zh_CN
     */
    var Panel = (function (_super) {
        __extends(Panel, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Panel() {
            var _this = _super.call(this) || this;
            /**
             * The skin part that defines the appearance of the close button.
             * When taped, the close button dispatches a <code>closing</code> event.
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅณ้ญๆ้ฎ
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.closeButton = null;
            /**
             * The area where the user must drag to move the window.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฏ็งปๅจๅบๅ
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.moveArea = null;
            /**
             * The skin part that defines the appearance of the
             * title text in the container.
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ้ขๆพ็คบๅฏน่ฑก
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.titleDisplay = null;
            /**
             * @private
             */
            _this._title = "";
            /**
             * @private
             * ่งฆๆธๆไธๆถ็ๅ็งป้
             */
            _this.offsetPointX = 0;
            /**
             * @private
             */
            _this.offsetPointY = 0;
            _this.addEventListener(egret.TouchEvent.TOUCH_BEGIN, _this.onWindowTouchBegin, _this, false, 100);
            return _this;
        }
        /**
         * @private
         * ๅจ็ชไฝไธๆไธๆถๅ็ฝฎ็ชๅฃ
         */
        Panel.prototype.onWindowTouchBegin = function (event) {
            this.$parent.addChild(this);
        };
        Object.defineProperty(Panel.prototype, "elementsContent", {
            /**
             * write-only property,This property is Usually invoked in resolving an EXML for adding multiple children quickly.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅชๅๅฑๆง๏ผๆญคๅฑๆง้ๅธธๅจ EXML ็่งฃๆๅจไธญ่ฐ็จ๏ผไพฟไบๅฟซ้ๆทปๅๅคไธชๅญ้กนใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (value) {
                if (value) {
                    var length_25 = value.length;
                    for (var i = 0; i < length_25; i++) {
                        this.addChild(value[i]);
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Panel.prototype, "title", {
            /**
             * Title or caption displayed in the title bar.
             *
             * @default ""
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ้ขๆไธญๆพ็คบ็ๆ้ขใ
             *
             * @default ""
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._title;
            },
            set: function (value) {
                this._title = value;
                if (this.titleDisplay)
                    this.titleDisplay.text = this.title;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Panel.prototype.partAdded = function (partName, instance) {
            _super.prototype.partAdded.call(this, partName, instance);
            if (instance == this.titleDisplay) {
                this.titleDisplay.text = this._title;
            }
            else if (instance == this.moveArea) {
                this.moveArea.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTouchBegin, this);
            }
            else if (instance == this.closeButton) {
                this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP, this.onCloseButtonClick, this);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Panel.prototype.partRemoved = function (partName, instance) {
            _super.prototype.partRemoved.call(this, partName, instance);
            if (instance == this.moveArea) {
                this.moveArea.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTouchBegin, this);
            }
            else if (instance == this.closeButton) {
                this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP, this.onCloseButtonClick, this);
            }
        };
        /**
         * Dispatch the "closing" event when the closeButton is clicked.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฝ closeButton ่ขซ็นๅปๆถๆดพๅ โclosingโ ไบไปถ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Panel.prototype.onCloseButtonClick = function (event) {
            if (eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CLOSING, true, true)) {
                this.close();
            }
        };
        /**
         * Close the panel and remove from the parent container.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅณ้ญ้ขๆฟ๏ผไป็ถ็บงๅฎนๅจ็งป้ค่ช่บซใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Panel.prototype.close = function () {
            if (!this.$parent) {
                return;
            }
            this.$parent.removeChild(this);
        };
        /**
         * Called when the user starts dragging a Panel.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅฏ็งปๅจๅบๅๆไธ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Panel.prototype.onTouchBegin = function (event) {
            this.$includeInLayout = false;
            this.offsetPointX = this.x - event.$stageX;
            this.offsetPointY = this.y - event.$stageY;
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            this.$stage.addEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEnd, this);
        };
        /**
         * Called when the user drags a Panel.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่งฆๆธๆๆฝๆถ็็งปๅจไบไปถ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Panel.prototype.onTouchMove = function (event) {
            this.x = event.$stageX + this.offsetPointX;
            this.y = event.$stageY + this.offsetPointY;
        };
        /**
         * Called when the user releases the Panel.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจ่ๅฐไธๅผน่ตทไบไปถ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Panel.prototype.onTouchEnd = function (event) {
            var stage = event.$currentTarget;
            stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEnd, this);
        };
        return Panel;
    }(eui.Component));
    eui.Panel = Panel;
    __reflect(Panel.prototype, "eui.Panel");
    eui.registerProperty(Panel, "elementsContent", "Array", true);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ProgressBar control provides a visual representation of the progress of a task over time.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ProgressBarExample.ts
     * @language en_US
     */
    /**
     * ProgressBar ๆงไปถไธบ้ๆถ้ด่ๅ็ไปปๅก่ฟๅบฆๆไพไบๅฝข่ฑกๅ็่กจ็คบใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ProgressBarExample.ts
     * @language zh_CN
     */
    var ProgressBar = (function (_super) {
        __extends(ProgressBar, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ProgressBar() {
            var _this = _super.call(this) || this;
            /**
             * this hightlight component of the progressbar.
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฟๅบฆ้ซไบฎๆพ็คบๅฏน่ฑกใ
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.thumb = null;
            /**
             * the label of the progressbar.
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฟๅบฆๆกๆๆฌ
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.labelDisplay = null;
            /**
             * @private
             */
            _this._labelFunction = null;
            /**
             * @private
             */
            _this._slideDuration = 500;
            /**
             * @private
             */
            _this._direction = eui.Direction.LTR;
            /**
             * @private
             * ๅจ็ปๆญๆพ็ปๆๆถ่ฆๅฐ่พพ็valueใ
             */
            _this.slideToValue = 0;
            /**
             * @private
             */
            _this.animationValue = 0;
            /**
             * @private
             */
            _this.thumbInitX = 0;
            /**
             * @private
             */
            _this.thumbInitY = 0;
            _this.animation = new eui.sys.Animation(_this.animationUpdateHandler, _this);
            return _this;
        }
        Object.defineProperty(ProgressBar.prototype, "labelFunction", {
            /**
             * a text format callback functionใexample๏ผ
             * <code>labelFunction(value:Number,maximum:Number):String;</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฟๅบฆๆกๆๆฌๆผๅผๅๅ่ฐๅฝๆฐใ็คบไพ๏ผ
             * <code>labelFunction(value:Number,maximum:Number):String;</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._labelFunction;
            },
            set: function (value) {
                if (this._labelFunction == value)
                    return;
                this._labelFunction = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Convert the current value to display text
         *
         * @param value the current value
         * @param maximum the maximum value
         *
         * @return a converted text
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๅฝๅvalue่ฝฌๆขๆๆๆฌ
         *
         * @param value ๅฝๅๅผ
         * @param maximum ๆๅคงๅผ
         *
         * @return ่ฝฌๆขๅ็ๆๆฌ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ProgressBar.prototype.valueToLabel = function (value, maximum) {
            if (this.labelFunction != null) {
                return this._labelFunction(value, maximum);
            }
            return value + " / " + maximum;
        };
        Object.defineProperty(ProgressBar.prototype, "slideDuration", {
            /**
             * Duration in milliseconds for a sliding animation
             * when the value changing. If the vlaue is 0, no animation will be done.
             *
             * @default 500
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * valueๆนๅๆถๆดๆฐ่งๅพ็็ผๅจๅจ็ปๆถ้ด(ๆฏซ็งไธบๅไฝ)ใ่ฎพ็ฝฎไธบ0ๅไธๆง่ก็ผๅจใ
             *
             * @default 500
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._slideDuration;
            },
            set: function (value) {
                value = +value | 0;
                if (this._slideDuration === value)
                    return;
                this._slideDuration = value;
                if (this.animation.isPlaying) {
                    this.animation.stop();
                    this.setValue(this.slideToValue);
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ProgressBar.prototype, "direction", {
            /**
             * Direction in which the fill of the ProgressBar expands toward completion.
             * you should use the <code>Direction</code> class constants to set the property.
             *
             * @default Direction.LTR
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ProgressBar ๅกซๅๅจ้ๆญฅๅฎๆ่ฟ็จไธญๆฉๅฑ็ๆนๅใไฝฟ็จ <code>Direction</code> ็ฑปๅฎไน็ๅธธ้ใ
             *
             * @default Direction.LTR
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._direction;
            },
            set: function (value) {
                if (this._direction == value)
                    return;
                if (this.thumb)
                    this.thumb.x = this.thumbInitX;
                if (this.thumb)
                    this.thumb.y = this.thumbInitY;
                this._direction = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param newValue
         */
        ProgressBar.prototype.$setValue = function (newValue) {
            if (this.value === newValue)
                return false;
            var values = this.$Range;
            var result = _super.prototype.$setValue.call(this, newValue);
            if (this._slideDuration > 0 && this.$stage) {
                this.validateProperties(); //ๆๅคงๅผๆๅฐๅผๅ็ๆนๅๆถ่ฆ็ซๅณๅบ็จ๏ผ้ฒๆญขๅฝๅ่ตทๅงๅผไธๆญฃ็กฎใ
                var animation = this.animation;
                if (animation.isPlaying) {
                    this.animationValue = this.slideToValue;
                    this.invalidateDisplayList();
                    animation.stop();
                }
                this.slideToValue = this.nearestValidValue(newValue, values[7 /* snapInterval */]);
                if (this.slideToValue === this.animationValue)
                    return result;
                var duration = this._slideDuration *
                    (Math.abs(this.animationValue - this.slideToValue) / (values[0 /* maximum */] - values[2 /* minimum */]));
                animation.duration = duration === Infinity ? 0 : duration;
                animation.from = this.animationValue;
                animation.to = this.slideToValue;
                animation.play();
            }
            else {
                this.animationValue = this.value;
            }
            return result;
        };
        /**
         * @private
         * ๅจ็ปๆญๆพๆดๆฐๆฐๅผ
         */
        ProgressBar.prototype.animationUpdateHandler = function (animation) {
            var values = this.$Range;
            var value = this.nearestValidValue(animation.currentValue, values[7 /* snapInterval */]);
            this.animationValue = Math.min(values[0 /* maximum */], Math.max(values[2 /* minimum */], value));
            this.invalidateDisplayList();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ProgressBar.prototype.partAdded = function (partName, instance) {
            _super.prototype.partAdded.call(this, partName, instance);
            if (instance === this.thumb) {
                if (this.thumb.x)
                    this.thumbInitX = this.thumb.x;
                if (this.thumb.y)
                    this.thumbInitY = this.thumb.y;
                this.thumb.addEventListener(egret.Event.RESIZE, this.onThumbResize, this);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ProgressBar.prototype.partRemoved = function (partName, instance) {
            _super.prototype.partRemoved.call(this, partName, instance);
            if (instance === this.thumb) {
                this.thumb.removeEventListener(egret.Event.RESIZE, this.onThumbResize, this);
            }
        };
        /**
         * @private
         * thumb็ไฝ็ฝฎๆๅฐบๅฏธๅ็ๆนๅ
         */
        ProgressBar.prototype.onThumbResize = function (event) {
            this.updateSkinDisplayList();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ProgressBar.prototype.updateSkinDisplayList = function () {
            var currentValue = this.animation.isPlaying ? this.animationValue : this.value;
            var maxValue = this.maximum;
            var thumb = this.thumb;
            if (thumb) {
                var thumbWidth = thumb.width;
                var thumbHeight = thumb.height;
                var clipWidth = Math.round((currentValue / maxValue) * thumbWidth);
                if (clipWidth < 0 || clipWidth === Infinity)
                    clipWidth = 0;
                var clipHeight = Math.round((currentValue / maxValue) * thumbHeight);
                if (clipHeight < 0 || clipHeight === Infinity)
                    clipHeight = 0;
                var rect = thumb.$scrollRect;
                if (!rect) {
                    rect = egret.$TempRectangle;
                }
                rect.setTo(0, 0, thumbWidth, thumbHeight);
                var thumbPosX = thumb.x - rect.x;
                var thumbPosY = thumb.y - rect.y;
                switch (this._direction) {
                    case eui.Direction.LTR:
                        rect.width = clipWidth;
                        thumb.x = thumbPosX;
                        break;
                    case eui.Direction.RTL:
                        rect.width = clipWidth;
                        rect.x = thumbWidth - clipWidth;
                        thumb.x = rect.x;
                        break;
                    case eui.Direction.TTB:
                        rect.height = clipHeight;
                        thumb.y = thumbPosY;
                        break;
                    case eui.Direction.BTT:
                        rect.height = clipHeight;
                        rect.y = thumbHeight - clipHeight;
                        thumb.y = rect.y;
                        break;
                }
                thumb.scrollRect = rect;
            }
            if (this.labelDisplay) {
                this.labelDisplay.text = this.valueToLabel(currentValue, maxValue);
            }
        };
        return ProgressBar;
    }(eui.Range));
    eui.ProgressBar = ProgressBar;
    __reflect(ProgressBar.prototype, "eui.ProgressBar");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * @private
     * ๅญๅจๆนๆฎgroupName่ชๅจๅๅปบ็RadioButtonGroupๅ่กจ
     */
    var automaticRadioButtonGroups = {};
    /**
     * The RadioButton component allows the user make a single choice
     * within a set of mutually exclusive choices.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/RadioButtonExample.ts
     * @language en_US
     */
    /**
     * RadioButton ็ปไปถไฝฟ็จๆทๅฏๅจไธ็ปไบ็ธๆๆฅ็้ๆฉไธญๅๅบไธ็ง้ๆฉ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/RadioButtonExample.ts
     * @language zh_CN
     */
    var RadioButton = (function (_super) {
        __extends(RadioButton, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function RadioButton() {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ๅจRadioButtonGroupไธญ็็ดขๅผ
             */
            _this.$indexNumber = 0;
            /**
             * @private
             * ๆๅฑ็RadioButtonGroup
             */
            _this.$radioButtonGroup = null;
            /**
             * @private
             */
            _this._group = null;
            /**
             * @private
             */
            _this.groupChanged = false;
            /**
             * @private
             */
            _this._groupName = "radioGroup";
            /**
             * @private
             */
            _this._value = null;
            _this.groupName = "radioGroup";
            return _this;
        }
        Object.defineProperty(RadioButton.prototype, "enabled", {
            /**
             * The RadioButton component is enabled if the
             * RadioButtonGroup is enabled and the RadioButton itself is enabled.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฆๆ RadioButtonGroup ๅฏ็จไธ RadioButton ๆฌ่บซไนๅฏ็จ๏ผๅ RadioButton ็ปไปถๅฏ็จใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (!this.$Component[3 /* enabled */]) {
                    return false;
                }
                return !this.$radioButtonGroup ||
                    this.$radioButtonGroup.$enabled;
            },
            set: function (value) {
                this.$setEnabled(value);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RadioButton.prototype, "group", {
            /**
             * The RadioButtonGroup component to which this RadioButton belongs.
             * If this property is not set,
             * a unique RadioButtonGroup is created automatically based on the groupName property.
             *
             * @see eui.RadioButton#groupName
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญค RadioButton ๆๅฑ็ RadioButtonGroup ็ปไปถใ
             * ่ฅไธ่ฎพ็ฝฎๆญคๅฑๆง๏ผๅๆนๆฎgroupNameๅฑๆง่ชๅจๅๅปบไธไธชๅฏไธ็RadioButtonGroupใ
             *
             * @see eui.RadioButton#groupName
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (!this._group && this._groupName) {
                    var g = automaticRadioButtonGroups[this._groupName];
                    if (!g) {
                        g = new eui.RadioButtonGroup();
                        g.$name = this._groupName;
                        automaticRadioButtonGroups[this._groupName] = g;
                    }
                    this._group = g;
                }
                return this._group;
            },
            set: function (value) {
                if (this._group == value)
                    return;
                if (this.$radioButtonGroup)
                    this.$radioButtonGroup.$removeInstance(this, false);
                this._group = value;
                this._groupName = value ? this.group.$name : "radioGroup";
                this.groupChanged = true;
                this.invalidateProperties();
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RadioButton.prototype, "groupName", {
            /**
             * Specifies the name of the group to which this RadioButton component belongs
             *
             * @default โradioGroupโ
             *
             * @see eui.RadioButton#group
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * RadioButton ็ปไปถๆๅฑ็็ป็ๅ็งฐ
             *
             * @default โradioGroupโ
             *
             * @see eui.RadioButton#group
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._groupName;
            },
            set: function (value) {
                if (!value || value == "")
                    return;
                this._groupName = value;
                if (this.$radioButtonGroup)
                    this.$radioButtonGroup.$removeInstance(this, false);
                this._group = null;
                this.groupChanged = true;
                this.invalidateProperties();
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param value
         */
        RadioButton.prototype.$setSelected = function (value) {
            var result = _super.prototype.$setSelected.call(this, value);
            this.invalidateDisplayList();
            return result;
        };
        Object.defineProperty(RadioButton.prototype, "value", {
            /**
             * Optional user-defined value
             * that is associated with a RadioButton component.
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ไธ RadioButton ็ปไปถๅณ่็ๅฏ้็จๆทๅฎไนๅผใ
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._value;
            },
            set: function (value) {
                if (this._value == value)
                    return;
                this._value = value;
                if (this.$selected && this.group) {
                    eui.PropertyEvent.dispatchPropertyEvent(this.group, eui.PropertyEvent.PROPERTY_CHANGE, "selectedValue");
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        RadioButton.prototype.commitProperties = function () {
            if (this.groupChanged) {
                this.addToGroup();
                this.groupChanged = false;
            }
            _super.prototype.commitProperties.call(this);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        RadioButton.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            if (this.group) {
                if (this.$selected)
                    this._group.$setSelection(this, false);
                else if (this.group.selection == this)
                    this._group.$setSelection(null, false);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        RadioButton.prototype.buttonReleased = function () {
            if (!this.enabled || this.selected)
                return;
            if (!this.$radioButtonGroup)
                this.addToGroup();
            _super.prototype.buttonReleased.call(this);
            this.group.$setSelection(this, true);
        };
        /**
         * @private
         * ๆทปๆญคๅ้ๆ้ฎๅๅฐ็ป
         */
        RadioButton.prototype.addToGroup = function () {
            var g = this.group;
            if (g)
                g.$addInstance(this);
            return g;
        };
        return RadioButton;
    }(eui.ToggleButton));
    eui.RadioButton = RadioButton;
    __reflect(RadioButton.prototype, "eui.RadioButton");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var groupCount = 0;
    /**
     * @private
     * ๆพ็คบๅ่กจๆทฑๅบฆๆๅบ
     */
    function breadthOrderCompare(a, b) {
        var aParent = a.parent;
        var bParent = b.parent;
        if (!aParent || !bParent)
            return 0;
        var aNestLevel = a.$nestLevel;
        var bNestLevel = b.$nestLevel;
        var aIndex = 0;
        var bIndex = 0;
        if (aParent == bParent) {
            aIndex = aParent.getChildIndex(a);
            bIndex = bParent.getChildIndex(b);
        }
        if (aNestLevel > bNestLevel || aIndex > bIndex)
            return 1;
        if (aNestLevel < bNestLevel || bIndex > aIndex)
            return -1;
        if (a == b)
            return 0;
        return breadthOrderCompare(aParent, bParent);
    }
    /**
     * The RadioButtonGroup component defines a group of RadioButton components
     * that act as a single mutually exclusive component; therefore,
     * a user can select only one RadioButton component at a time.
     *
     * @event egret.Event.CHANGE Dispatched when the value of the selected RadioButton component in
     * this group changes.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/RadioButtonGroupExample.ts
     * @language en_US
     */
    /**
     * RadioButtonGroup ็ปไปถๅฎไนไธ็ป RadioButton ็ปไปถ๏ผ่ฟไบ็ปไปถ็ธไบๆๆฅ๏ผๅๆญค๏ผ็จๆทๆฏๆฌกๅช่ฝ้ๆฉไธไธช RadioButton ็ปไปถ
     *
     * @event egret.Event.CHANGE ๆญค็ปไธญๆ้ RadioButton ็ปไปถ็ๅผๆดๆนๆถๅๆดพใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/RadioButtonGroupExample.ts
     * @language zh_CN
     */
    var RadioButtonGroup = (function (_super) {
        __extends(RadioButtonGroup, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function RadioButtonGroup() {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ็ปๅ
             */
            _this.$name = null;
            /**
             * @private
             * ๅ้ๆ้ฎๅ่กจ
             */
            _this.radioButtons = [];
            /**
             * @private
             */
            _this.$enabled = true;
            /**
             * @private
             */
            _this._selectedValue = null;
            /**
             * @private
             */
            _this._selection = null;
            _this.$name = "_radioButtonGroup" + groupCount++;
            return _this;
        }
        /**
         * Returns the RadioButton component at the specified index.
         *
         * @param index The 0-based index of the RadioButton in the
         * RadioButtonGroup.
         *
         * @return The specified RadioButton component if index is between
         * 0 and <code>numRadioButtons</code> - 1.  Returns
         * <code>null</code> if the index is invalid.
         *
         * @see eui.RadioButtonGroup#numRadioButtons
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฟๅๆๅฎ็ดขๅผๅค็ RadioButton ็ปไปถใ
         *
         * @param index RadioButtonGroup ไธญ็ RadioButton ็ไป้ถๅผๅง็็ดขๅผใ
         *
         * @return ๅฝ็ดขๅผไฝไบ 0 ๅ <code>numRadioButtons</code> ไน้ดๆถ๏ผๆๅฎ็ RadioButton ็ปไปถไธบ 1ใ
         * ๅฆๆ็ดขๅผๆๆ๏ผๅ่ฟๅ <code>null</code>ใ
         *
         * @see eui.RadioButtonGroup#numRadioButtons
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        RadioButtonGroup.prototype.getRadioButtonAt = function (index) {
            return this.radioButtons[index];
        };
        Object.defineProperty(RadioButtonGroup.prototype, "enabled", {
            /**
             * Determines whether selection is allowed.  Note that the value returned
             * only reflects the value that was explicitly set on the
             * <code>RadioButtonGroup</code> and does not reflect any values explicitly
             * set on the individual RadioButtons.
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็กฎๅฎๆฏๅฆๅ่ฎธ้ๆฉใ่ฏทๆณจๆ๏ผ่ฟๅ็ๅผไปๅๆๅฏน <code>RadioButtonGroup</code> ๆพๅผ่ฎพ็ฝฎ็ๅผ๏ผ
             * ่ไธๅๆๅฏนๅไธช RadioButton ๆพๅผ่ฎพ็ฝฎ็ไปปไฝๅผใ
             *
             * @default true
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$enabled;
            },
            set: function (value) {
                value = !!value;
                if (this.$enabled === value)
                    return;
                this.$enabled = value;
                var buttons = this.radioButtons;
                var length = buttons.length;
                for (var i = 0; i < length; i++)
                    buttons[i].invalidateState();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RadioButtonGroup.prototype, "numRadioButtons", {
            /**
             * The number of RadioButtons that belong to this RadioButtonGroup.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             *  ๅฑไบๆญค RadioButtonGroup ็ RadioButton ๆฐใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.radioButtons.length;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RadioButtonGroup.prototype, "selectedValue", {
            /**
             * The <code>value</code> property of the selected
             * RadioButton component in the group, if it has been set,
             * otherwise, the <code>label</code> property of the selected RadioButton.
             * If no RadioButton is selected, this property is <code>null</code>.
             *
             * <p>If you set <code>selectedValue</code>, selects the
             * first RadioButton component whose <code>value</code> or
             * <code>label</code> property matches this value.</p>
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ปไธญๆ้ RadioButton ็ปไปถ็ <code>value</code> ๅฑๆง๏ผๅฆๆๆช่ฎพ็ฝฎ๏ผ๏ผ
             * ๅฆๅไธบๆ้ RadioButton ็ปไปถ็ <code>label</code> ๅฑๆงใ
             * ๅฆๆๆช้ๆฉไปปไฝ RadioButton๏ผๅๆญคๅฑๆงไธบ <code>null</code>ใ
             *
             * <p>ๅฆๆ่ฎพ็ฝฎไบ <code>selectedValue</code>๏ผๅไผ้ๆฉ <code>value</code> ๆ <code>label</code> ๅฑๆง
             * ไธๆญคๅผๅน้็็ฌฌไธไธช RadioButton ็ปไปถใ</p>
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                if (this.selection) {
                    return this.selection.value != null ?
                        this.selection.value :
                        this.selection.label;
                }
                return null;
            },
            set: function (value) {
                this._selectedValue = value;
                if (value == null) {
                    this.$setSelection(null, false);
                    return;
                }
                var n = this.numRadioButtons;
                for (var i = 0; i < n; i++) {
                    var radioButton = this.radioButtons[i];
                    if (radioButton.value == value ||
                        radioButton.label == value) {
                        this.changeSelection(i, false);
                        this._selectedValue = null;
                        eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedValue");
                        break;
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(RadioButtonGroup.prototype, "selection", {
            /**
             * Contains a reference to the currently selected
             * RadioButton component in the group.This property is valid only
             * when the target RadioButton is displayed on the display list
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝๅ่ขซ้ไธญ็ๅ้ๆ้ฎๅผ็จใๆญคๅฑๆงไปๅฝ็ฎๆRadioButtonๅจๆพ็คบๅ่กจๆถๆๆใ
             *
             * @default null
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._selection;
            },
            set: function (value) {
                if (this._selection == value)
                    return;
                this.$setSelection(value, false);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ๆทปๅๅ้ๆ้ฎๅฐ็ปๅ
         */
        RadioButtonGroup.prototype.$addInstance = function (instance) {
            instance.addEventListener(egret.Event.REMOVED_FROM_STAGE, this.removedHandler, this);
            var buttons = this.radioButtons;
            buttons.push(instance);
            buttons.sort(breadthOrderCompare);
            var length = buttons.length;
            for (var i = 0; i < length; i++) {
                buttons[i].$indexNumber = i;
            }
            if (this._selectedValue)
                this.selectedValue = this._selectedValue;
            if (instance.selected == true)
                this.selection = instance;
            instance.$radioButtonGroup = this;
            instance.invalidateState();
        };
        /**
         * @private
         * ไป็ป้็งป้คๅ้ๆ้ฎ
         */
        RadioButtonGroup.prototype.$removeInstance = function (instance, addListener) {
            if (instance) {
                var foundInstance = false;
                var buttons = this.radioButtons;
                var length_26 = buttons.length;
                for (var i = 0; i < length_26; i++) {
                    var rb = buttons[i];
                    if (foundInstance) {
                        rb.$indexNumber = rb.$indexNumber - 1;
                    }
                    else if (rb == instance) {
                        if (addListener)
                            instance.addEventListener(egret.Event.ADDED_TO_STAGE, this.addedHandler, this);
                        if (instance == this._selection)
                            this._selection = null;
                        instance.$radioButtonGroup = null;
                        instance.invalidateState();
                        this.radioButtons.splice(i, 1);
                        foundInstance = true;
                        i--;
                        length_26--;
                    }
                }
            }
        };
        /**
         * @private
         * ่ฎพ็ฝฎ้ไธญ็ๅ้ๆ้ฎ
         */
        RadioButtonGroup.prototype.$setSelection = function (value, fireChange) {
            if (this._selection == value)
                return false;
            if (!value) {
                if (this._selection) {
                    this._selection.selected = false;
                    this._selection = null;
                    if (fireChange)
                        this.dispatchEventWith(egret.Event.CHANGE);
                }
            }
            else {
                var n = this.numRadioButtons;
                for (var i = 0; i < n; i++) {
                    if (value == this.getRadioButtonAt(i)) {
                        this.changeSelection(i, fireChange);
                        break;
                    }
                }
            }
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedValue");
            return true;
        };
        /**
         * @private
         * ๆนๅ้ไธญ้กน
         */
        RadioButtonGroup.prototype.changeSelection = function (index, fireChange) {
            var rb = this.getRadioButtonAt(index);
            if (rb && rb != this._selection) {
                if (this._selection)
                    this._selection.selected = false;
                this._selection = rb;
                this._selection.selected = true;
                if (fireChange)
                    this.dispatchEventWith(egret.Event.CHANGE);
            }
        };
        /**
         * @private
         * ๅ้ๆ้ฎๆทปๅๅฐๆพ็คบๅ่กจ
         */
        RadioButtonGroup.prototype.addedHandler = function (event) {
            var rb = event.target;
            if (rb == event.currentTarget) {
                rb.removeEventListener(egret.Event.ADDED_TO_STAGE, this.addedHandler, this);
                this.$addInstance(rb);
            }
        };
        /**
         * @private
         * ๅ้ๆ้ฎไปๆพ็คบๅ่กจ็งป้ค
         */
        RadioButtonGroup.prototype.removedHandler = function (event) {
            var rb = event.target;
            if (rb == event.currentTarget) {
                rb.removeEventListener(egret.Event.REMOVED_FROM_STAGE, this.removedHandler, this);
                this.$removeInstance(rb, true);
            }
        };
        return RadioButtonGroup;
    }(egret.EventDispatcher));
    eui.RadioButtonGroup = RadioButtonGroup;
    __reflect(RadioButtonGroup.prototype, "eui.RadioButtonGroup");
    eui.registerBindable(RadioButtonGroup.prototype, "selectedValue");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The Rect component is a rectangular shape. It can be touched.
     * @version Egret 2.5.5
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * Rect ็ปไปถ็ฉๅฝข็ปๅพๅ็ดใๆญค็ปไปถๅฏๅๅบ้ผๆไบไปถใ
     * @version Egret 2.5.5
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var Rect = (function (_super) {
        __extends(Rect, _super);
        function Rect(width, height, fillColor) {
            var _this = _super.call(this) || this;
            _this.$fillColor = 0x000000;
            _this.$fillAlpha = 1;
            _this.$strokeColor = 0x444444;
            _this.$strokeAlpha = 1;
            _this.$strokeWeight = 0;
            _this.$ellipseWidth = 0;
            _this.$ellipseHeight = 0;
            _this.touchChildren = false;
            _this.$graphics = new egret.Graphics();
            _this.$graphics.$setTarget(_this);
            _this.width = width;
            _this.height = height;
            _this.fillColor = fillColor;
            return _this;
        }
        Object.defineProperty(Rect.prototype, "graphics", {
            get: function () {
                return this.$graphics;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Rect.prototype.$measureContentBounds = function (bounds) {
            if (this.$graphics) {
                bounds.setTo(0, 0, this.width, this.height);
            }
        };
        Object.defineProperty(Rect.prototype, "fillColor", {
            /**
             * Fill color
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅกซๅ้ข่ฒ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$fillColor;
            },
            set: function (value) {
                if (value == undefined || this.$fillColor == value)
                    return;
                this.$fillColor = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "fillAlpha", {
            /**
             * Fill alpha
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅกซๅ้ๆๅบฆ,้ป่ฎคๅผไธบ1ใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$fillAlpha;
            },
            set: function (value) {
                if (this.$fillAlpha == value)
                    return;
                this.$fillAlpha = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "strokeColor", {
            /**
             * The line's color inside the rect border. Caution: when the strokeWeight is 0, a line is not drawn
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่พนๆก้ข่ฒ,ๆณจๆ๏ผๅฝ strokeWeight ไธบ 0 ๆถ๏ผไธๆพ็คบ่พนๆกใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$strokeColor;
            },
            set: function (value) {
                if (this.$strokeColor == value)
                    return;
                this.$strokeColor = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "strokeAlpha", {
            /**
             * The line's alpha inside the rect border. Caution: when the strokeWeight is 0, a line is not drawn
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่พนๆก้ๆๅบฆ,ๆณจๆ๏ผๅฝ strokeWeight ไธบ0ๆถ๏ผไธๆพ็คบ่พนๆกใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$strokeAlpha;
            },
            set: function (value) {
                if (this.$strokeAlpha == value)
                    return;
                this.$strokeAlpha = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "strokeWeight", {
            /**
             * The line's thickness inside the rect border. Caution: when the strokeWeight is 0, a line is not drawn
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่พนๆก็ฒ็ป(ๅ็ด),ๆณจๆ๏ผๅฝ strokeWeight ไธบ 0 ๆถ๏ผไธๆพ็คบ่พนๆกใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$strokeWeight;
            },
            set: function (value) {
                if (this.$strokeWeight == value)
                    return;
                this.$strokeWeight = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "ellipseWidth", {
            /**
             * Width used to draw an ellipse with rounded corners (in pixels).
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็จไบ็ปๅถๅ่ง็ๆคญๅ็ๅฎฝๅบฆ(ไปฅๅ็ดไธบๅไฝ)
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$ellipseWidth;
            },
            set: function (value) {
                if (this.$ellipseWidth == value)
                    return;
                this.$ellipseWidth = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Rect.prototype, "ellipseHeight", {
            /**
             * Height used to draw an ellipse with rounded corners (in pixels). If no value is specified, the default value matches the value of the ellipseWidth parameter.
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็จไบ็ปๅถๅ่ง็ๆคญๅ็้ซๅบฆ (ไปฅๅ็ดไธบๅไฝ)ใๅฆๆๆชๆๅฎๅผ๏ผๅ้ป่ฎคๅผไธไธบ ellipseWidth ๅๆฐๆไพ็ๅผ็ธๅน้ใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$ellipseHeight;
            },
            set: function (value) {
                if (this.$ellipseHeight == value)
                    return;
                this.$ellipseHeight = value;
                this.invalidateDisplayList();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @copy eui.UIComponent#updateDisplayList
         *
         * @version Egret 2.5.5
         * @version eui 1.0
         * @platform Web,Native
         */
        Rect.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            var g = this.graphics;
            g.clear();
            if (this.$strokeWeight > 0) {
                g.beginFill(this.$fillColor, 0);
                g.lineStyle(this.$strokeWeight, this.$strokeColor, this.$strokeAlpha, true, "normal", "square", "miter");
                if (this.$ellipseWidth == 0 && this.$ellipseHeight == 0) {
                    g.drawRect(this.$strokeWeight / 2, this.$strokeWeight / 2, unscaledWidth - this.$strokeWeight, unscaledHeight - this.$strokeWeight);
                }
                else {
                    g.drawRoundRect(this.$strokeWeight / 2, this.$strokeWeight / 2, unscaledWidth - this.$strokeWeight, unscaledHeight - this.$strokeWeight, this.$ellipseWidth, this.$ellipseHeight);
                }
                g.endFill();
            }
            g.beginFill(this.$fillColor, this.$fillAlpha);
            g.lineStyle(this.$strokeWeight, this.$strokeColor, 0, true, "normal", "square", "miter");
            if (this.$ellipseWidth == 0 && this.$ellipseHeight == 0) {
                g.drawRect(this.$strokeWeight, this.$strokeWeight, unscaledWidth - this.$strokeWeight * 2, unscaledHeight - this.$strokeWeight * 2);
            }
            else {
                g.drawRoundRect(this.$strokeWeight, this.$strokeWeight, unscaledWidth - this.$strokeWeight * 2, unscaledHeight - this.$strokeWeight * 2, this.$ellipseWidth, this.$ellipseHeight);
            }
            g.endFill();
            this.$invalidateContentBounds();
        };
        return Rect;
    }(eui.Component));
    eui.Rect = Rect;
    __reflect(Rect.prototype, "eui.Rect");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var scrollerThrowEvent;
    /**
     * The Scroller component displays a single scrollable component,
     * called a viewport, and horizontal and vertical scroll bars.
     * The viewport must implement the IViewport interface.
     * <p>The Group components implement the IViewport interface
     * and can be used as the children of the Scroller control,
     * as the following example shows:</p>
     * <pre>
     *       <s:Scroller width="100" height="100">
     *           <s:Group>
     *               <s:Image width="300" height="400" source="assets/logo.jpg"/>
     *           </s:Group>
     *       </s:Scroller>
     * </pre>
     * <p>The size of the Image control is set larger than that of its parent Group container.
     * By default, the child extends past the boundaries of the parent container.
     * Rather than allow the child to extend past the boundaries of the parent container,
     * the Scroller specifies to clip the child to the boundaries and display scroll bars.</p>
     *
     * @event eui.UIEvent.CHANGE_START Dispatched when the scroll position is going to change
     * @event eui.UIEvent.CHANGE_END Dispatched when the scroll position changed complete
     * @event egret.Event.CHANGE Dispatched when the scroll position is changing
     * @event egret.TouchEvent.TOUCH_CANCEL canceled the touch
     *
     * @defaultProperty viewport
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ScrollerExample.ts
     * @language en_US
     */
    /**
     * Scroller ็ปไปถๆพ็คบไธไธช็งฐไธบ่งๅ็ๅไธชๅฏๆปๅจ็ปไปถ๏ผไปฅๅๆฐดๅนณๆปๅจๆกๅๅ็ดๆปๅจๆกใ่ฏฅ่งๅๅฟ้กปๅฎ็ฐ IViewport ๆฅๅฃใ
     * <p>Group ็ปไปถๅฎ็ฐ IViewport ๆฅๅฃ๏ผไธๅฏไปฅ็จไฝ Scroller ๆงไปถ็ๅญไปฃ๏ผๅฆไธไพๆ็คบ๏ผ</p>
     * <pre>
     *       <s:Scroller width="100" height="100">
     *           <s:Group>
     *               <s:Image width="300" height="400" source="assets/logo.jpg"/>
     *           </s:Group>
     *       </s:Scroller>
     * </pre>
     * Image ๆงไปถ็ๅคงๅฐๆฏๅถ็ถ Group ๅฎนๅจ่ฎพ็ฝฎๅพๅคงใ้ป่ฎคๆๅตไธ๏ผๅญไปฃ่ถ่ฟ็ถๅฎนๅจ็่พน็ใ
     * Scroller ไผๆๅฎๅฐๅญไปฃๅชๅๅฐ่พน็ๅนถๆพ็คบๆปๅจๆก๏ผ่ไธๆฏ่ฎฉๅญไปฃ่ถ่ฟ็ถๅฎนๅจ็่พน็ใ
     *
     * @event eui.UIEvent.CHANGE_START ๆปๅจไฝ็ฝฎๆนๅๅผๅง
     * @event eui.UIEvent.CHANGE_END ๆปๅจไฝ็ฝฎๆนๅ็ปๆ
     * @event egret.Event.CHANGE ๆปๅจไฝ็ฝฎๆนๅ็ๆถๅ
     * @event egret.TouchEvent.TOUCH_CANCEL ๅๆถ่งฆๆธไบไปถ
     *
     * @defaultProperty viewport
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ScrollerExample.ts
     * @language zh_CN
     */
    var Scroller = (function (_super) {
        __extends(Scroller, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Scroller() {
            var _this = _super.call(this) || this;
            _this.$bounces = true;
            /**
             * the horizontal scroll bar
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฐดๅนณๆปๅจๆก
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.horizontalScrollBar = null;
            /**
             * the vertical scroll bar
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅ็ดๆปๅจๆก
             *
             * @skinPart
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.verticalScrollBar = null;
            var touchScrollH = new eui.sys.TouchScroll(_this.horizontalUpdateHandler, _this.horizontalEndHandler, _this);
            var touchScrollV = new eui.sys.TouchScroll(_this.verticalUpdateHandler, _this.verticalEndHanlder, _this);
            _this.$Scroller = {
                0: "auto",
                1: "auto",
                2: null,
                3: 0,
                4: 0,
                5: false,
                6: false,
                7: false,
                8: touchScrollH,
                9: touchScrollV,
                10: null,
                11: false,
                12: false //touchCancle
            };
            return _this;
        }
        Object.defineProperty(Scroller.prototype, "bounces", {
            /**
             * Whether to enable rebound, rebound When enabled, ScrollView contents allowed to continue to drag the border after arriving at the end user drag operation, and then bounce back boundary position
             * @default true
             * @version Egret 2.5.6
             * @language en_US
             */
            /**
             * ๆฏๅฆๅฏ็จๅๅผน๏ผๅฝๅฏ็จๅๅผนๅ๏ผScrollViewไธญๅๅฎนๅจๅฐ่พพ่พน็ๅๅ่ฎธ็ปง็ปญๆๅจ๏ผๅจ็จๆทๆๅจๆไฝ็ปๆๅ๏ผๅๅๅผนๅ่พน็ไฝ็ฝฎ
             * @default true
             * @version Egret 2.5.6
             * @language zh_CN
             */
            get: function () {
                return this.$bounces;
            },
            set: function (value) {
                this.$bounces = !!value;
                var touchScrollH = this.$Scroller[8 /* touchScrollH */];
                if (touchScrollH) {
                    touchScrollH.$bounces = this.$bounces;
                }
                var touchScrollV = this.$Scroller[9 /* touchScrollV */];
                if (touchScrollV) {
                    touchScrollV.$bounces = this.$bounces;
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Scroller.prototype, "throwSpeed", {
            get: function () {
                return this.$Scroller[8 /* touchScrollH */].$scrollFactor;
            },
            /**
             * Adjust the speed to get out of the slide end.When equal to 0,the scroll animation will not be play.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฐ่ๆปๅจ็ปๆๆถๆปๅบ็้ๅบฆใ็ญไบ0ๆถ๏ผๆฒกๆๆปๅจๅจ็ป
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (val) {
                val = +val;
                if (val < 0)
                    val = 0;
                this.$Scroller[8 /* touchScrollH */].$scrollFactor = val;
                this.$Scroller[9 /* touchScrollV */].$scrollFactor = val;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        Scroller.prototype.$getThrowInfo = function (currentPos, toPos) {
            if (!scrollerThrowEvent) {
                scrollerThrowEvent = new eui.ScrollerThrowEvent(eui.ScrollerThrowEvent.THROW, false, false, currentPos, toPos);
            }
            else {
                scrollerThrowEvent.currentPos = currentPos;
                scrollerThrowEvent.toPos = toPos;
            }
            return scrollerThrowEvent;
        };
        Object.defineProperty(Scroller.prototype, "scrollPolicyV", {
            /**
             * Indicates under what conditions the scroller can be moved and the vertical scroll bar is displayed.
             * <p><code>ScrollPolicy.ON</code> - the scroller can be moved, and the scroll bar is displayed when it's move.</p>
             * <p><code>ScrollPolicy.OFF</code> - the scroller can not be moved, the scroll bar is never displayed.</p>
             * <p><code>ScrollPolicy.AUTO</code> - the scroller can not be moved when
             *  the viewport's contentHeight is larger than its height. the scroll bar is displayed when it's move.
             *
             * @default ScrollPolicy.AUTO
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ็คบๅจๅชไบๆกไปถๅฏไปฅๆปๅจๅนถไธๆพ็คบๅ็ดๆปๅจๆกใ
             * <p><code>ScrollPolicy.ON</code> - ๅฏไปฅๆปๅจ๏ผๆปๅจๆถๆพ็คบๆปๅจๆกใ</p>
             * <p><code>ScrollPolicy.OFF</code> - ไธๅฏไปฅๆปๅจๅนถไธไธๆพ็คบๆปๅจๆกใ</p>
             * <p><code>ScrollPolicy.AUTO</code> - ๅฝ่งๅ็ contentHeight ๅคงไบๅถ่ช่บซ็้ซๅบฆๆถๅฏไปฅๆปๅจ๏ผๆปๅจๆถๆพ็คบๆปๅจๆกใ</p>
             *
             * @default ScrollPolicy.AUTO
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Scroller[0 /* scrollPolicyV */];
            },
            set: function (value) {
                var values = this.$Scroller;
                if (values[0 /* scrollPolicyV */] == value) {
                    return;
                }
                values[0 /* scrollPolicyV */] = value;
                this.checkScrollPolicy();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Scroller.prototype, "scrollPolicyH", {
            /**
             * Indicates under what conditions the scroller can be moved and the horizontal scroll bar is displayed.
             * <p><code>ScrollPolicy.ON</code> - the scroller can be moved, and the scroll bar is displayed when it's move.</p>
             * <p><code>ScrollPolicy.OFF</code> - the scroller can not be moved, the scroll bar is never displayed.</p>
             * <p><code>ScrollPolicy.AUTO</code> - the can not be moved  when
             *  the viewport's contentWidth is larger than its width. the scroll bar is displayed when it's move.
             *
             * @default ScrollPolicy.AUTO
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆ็คบๅจๅชไบๆกไปถไธๅฏไปฅๆปๅจๅนถไธๆพ็คบๆฐดๅนณๆปๅจๆกใ
             * <p><code>ScrollPolicy.ON</code> - ๅฏไปฅๆปๅจ๏ผๆปๅจๆถๆพ็คบๆปๅจๆกใ</p>
             * <p><code>ScrollPolicy.OFF</code> - ไธๅฏไปฅๆปๅจๅนถไธไธๆพ็คบๆปๅจๆกใ</p>
             * <p><code>ScrollPolicy.AUTO</code> - ๅฝ่งๅ็ contentWidth ๅคงไบๅถ่ช่บซ็ๅฎฝๅบฆๆถๅฏไปฅๆปๅจ๏ผๆปๅจๆถๆพ็คบๆปๅจๆกใ</p>
             *
             * @default ScrollPolicy.AUTO
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Scroller[1 /* scrollPolicyH */];
            },
            set: function (value) {
                var values = this.$Scroller;
                if (values[1 /* scrollPolicyH */] == value) {
                    return;
                }
                values[1 /* scrollPolicyH */] = value;
                this.checkScrollPolicy();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Stop the scroller animation
         * @version Egret 3.0.2
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๆญขๆปๅจ็ๅจ็ป
         *
         * @version Egret 3.0.2
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Scroller.prototype.stopAnimation = function () {
            var values = this.$Scroller;
            var scrollV = values[9 /* touchScrollV */];
            var scrollH = values[8 /* touchScrollH */];
            if (scrollV.animation.isPlaying) {
                eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
            }
            else if (scrollH.animation.isPlaying) {
                eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
            }
            scrollV.stop();
            scrollH.stop();
            var verticalBar = this.verticalScrollBar;
            var horizontalBar = this.horizontalScrollBar;
            if (verticalBar && verticalBar.autoVisibility) {
                verticalBar.visible = false;
            }
            if (horizontalBar && horizontalBar.autoVisibility) {
                horizontalBar.visible = false;
            }
        };
        Object.defineProperty(Scroller.prototype, "viewport", {
            /**
             * The viewport component to be scrolled.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๆปๅจ็่งๅ็ปไปถใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$Scroller[10 /* viewport */];
            },
            set: function (value) {
                var values = this.$Scroller;
                if (value == values[10 /* viewport */])
                    return;
                this.uninstallViewport();
                values[10 /* viewport */] = value;
                values[11 /* viewprotRemovedEvent */] = false;
                this.installViewport();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ๅฎ่ฃๅนถๅๅงๅ่งๅ็ปไปถ
         */
        Scroller.prototype.installViewport = function () {
            var viewport = this.viewport;
            if (viewport) {
                this.addChildAt(viewport, 0);
                viewport.scrollEnabled = true;
                viewport.addEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTouchBeginCapture, this, true);
                viewport.addEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEndCapture, this, true);
                viewport.addEventListener(egret.TouchEvent.TOUCH_TAP, this.onTouchTapCapture, this, true);
                viewport.addEventListener(egret.Event.REMOVED, this.onViewPortRemove, this);
            }
            if (this.horizontalScrollBar) {
                this.horizontalScrollBar.viewport = viewport;
            }
            if (this.verticalScrollBar) {
                this.verticalScrollBar.viewport = viewport;
            }
        };
        /**
         * @private
         * ๅธ่ฝฝ่งๅ็ปไปถ
         */
        Scroller.prototype.uninstallViewport = function () {
            if (this.horizontalScrollBar) {
                this.horizontalScrollBar.viewport = null;
            }
            if (this.verticalScrollBar) {
                this.verticalScrollBar.viewport = null;
            }
            var viewport = this.viewport;
            if (viewport) {
                viewport.scrollEnabled = false;
                viewport.removeEventListener(egret.TouchEvent.TOUCH_BEGIN, this.onTouchBeginCapture, this, true);
                viewport.removeEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEndCapture, this, true);
                viewport.removeEventListener(egret.TouchEvent.TOUCH_TAP, this.onTouchTapCapture, this, true);
                viewport.removeEventListener(egret.Event.REMOVED, this.onViewPortRemove, this);
                if (this.$Scroller[11 /* viewprotRemovedEvent */] == false) {
                    this.removeChild(viewport);
                }
            }
        };
        Scroller.prototype.onViewPortRemove = function (event) {
            if (event.target == this.viewport) {
                this.$Scroller[11 /* viewprotRemovedEvent */] = true;
                this.viewport = null;
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Scroller.prototype.setSkin = function (skin) {
            _super.prototype.setSkin.call(this, skin);
            var viewport = this.viewport;
            if (viewport) {
                this.addChildAt(viewport, 0);
            }
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.onTouchBeginCapture = function (event) {
            this.$Scroller[12 /* touchCancle */] = false;
            var canScroll = this.checkScrollPolicy();
            if (!canScroll) {
                return;
            }
            this.onTouchBegin(event);
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.onTouchEndCapture = function (event) {
            if (this.$Scroller[12 /* touchCancle */]) {
                event.$bubbles = false;
                this.dispatchBubbleEvent(event);
                event.$bubbles = true;
                event.stopPropagation();
                this.onTouchEnd(event);
            }
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.onTouchTapCapture = function (event) {
            if (this.$Scroller[12 /* touchCancle */]) {
                event.$bubbles = false;
                this.dispatchBubbleEvent(event);
                event.$bubbles = true;
                event.stopPropagation();
            }
        };
        /**
         * @private
         * ๆฃๆฅๅฝๅๆปๅจ็ญ็ฅ๏ผ่ฅๆไธไธชๆนๅๅฏไปฅๆปๅจ๏ผ่ฟๅtrueใ
         */
        Scroller.prototype.checkScrollPolicy = function () {
            var values = this.$Scroller;
            var viewport = values[10 /* viewport */];
            if (!viewport) {
                return false;
            }
            var hCanScroll;
            var uiValues = viewport.$UIComponent;
            switch (values[1 /* scrollPolicyH */]) {
                case "auto":
                    if (viewport.contentWidth > uiValues[10 /* width */] || viewport.scrollH !== 0) {
                        hCanScroll = true;
                    }
                    else {
                        hCanScroll = false;
                    }
                    break;
                case "on":
                    hCanScroll = true;
                    break;
                case "off":
                    hCanScroll = false;
                    break;
            }
            values[6 /* horizontalCanScroll */] = hCanScroll;
            var vCanScroll;
            switch (values[0 /* scrollPolicyV */]) {
                case "auto":
                    if (viewport.contentHeight > uiValues[11 /* height */] || viewport.scrollV !== 0) {
                        vCanScroll = true;
                    }
                    else {
                        vCanScroll = false;
                    }
                    break;
                case "on":
                    vCanScroll = true;
                    break;
                case "off":
                    vCanScroll = false;
                    break;
            }
            values[7 /* verticalCanScroll */] = vCanScroll;
            return hCanScroll || vCanScroll;
        };
        /**
         * @private
         *
         * @param event
         */
        Scroller.prototype.onTouchBegin = function (event) {
            if (event.isDefaultPrevented()) {
                return;
            }
            if (!this.checkScrollPolicy()) {
                return;
            }
            this.downTarget = event.target;
            var values = this.$Scroller;
            this.stopAnimation();
            values[3 /* touchStartX */] = event.$stageX;
            values[4 /* touchStartY */] = event.$stageY;
            if (values[6 /* horizontalCanScroll */]) {
                values[8 /* touchScrollH */].start(event.$stageX);
            }
            if (values[7 /* verticalCanScroll */]) {
                values[9 /* touchScrollV */].start(event.$stageY);
            }
            var stage = this.$stage;
            this.addEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            stage.addEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEnd, this, true);
            this.addEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancel, this);
            this.addEventListener(egret.Event.REMOVED_FROM_STAGE, this.onRemoveListeners, this);
            this.tempStage = stage;
        };
        /**
         * @private
         *
         * @param event
         */
        Scroller.prototype.onTouchMove = function (event) {
            if (event.isDefaultPrevented()) {
                return;
            }
            var values = this.$Scroller;
            if (!values[5 /* touchMoved */]) {
                var outX = void 0;
                if (Math.abs(values[3 /* touchStartX */] - event.$stageX) < Scroller.scrollThreshold) {
                    outX = false;
                }
                else {
                    outX = true;
                }
                var outY = void 0;
                if (Math.abs(values[4 /* touchStartY */] - event.$stageY) < Scroller.scrollThreshold) {
                    outY = false;
                }
                else {
                    outY = true;
                }
                if (!outX && !outY) {
                    return;
                }
                if (!outY && outX && values[1 /* scrollPolicyH */] == 'off') {
                    return;
                }
                if (!outX && outY && values[0 /* scrollPolicyV */] == 'off') {
                    return;
                }
                values[12 /* touchCancle */] = true;
                values[5 /* touchMoved */] = true;
                this.dispatchCancelEvent(event);
                var horizontalBar = this.horizontalScrollBar;
                var verticalBar = this.verticalScrollBar;
                if (horizontalBar && horizontalBar.autoVisibility && values[6 /* horizontalCanScroll */]) {
                    horizontalBar.visible = true;
                }
                if (verticalBar && verticalBar.autoVisibility && values[7 /* verticalCanScroll */]) {
                    verticalBar.visible = true;
                }
                if (values[2 /* autoHideTimer */]) {
                    values[2 /* autoHideTimer */].reset();
                }
                eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_START);
                this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            }
            event.preventDefault();
            var viewport = values[10 /* viewport */];
            var uiValues = viewport.$UIComponent;
            if (values[6 /* horizontalCanScroll */]) {
                values[8 /* touchScrollH */].update(event.$stageX, viewport.contentWidth - uiValues[10 /* width */], viewport.scrollH);
            }
            if (values[7 /* verticalCanScroll */]) {
                values[9 /* touchScrollV */].update(event.$stageY, viewport.contentHeight - uiValues[11 /* height */], viewport.scrollV);
            }
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.onTouchCancel = function (event) {
            if (!this.$Scroller[5 /* touchMoved */]) {
                this.onRemoveListeners();
            }
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.dispatchBubbleEvent = function (event) {
            var viewport = this.$Scroller[10 /* viewport */];
            if (!viewport) {
                return;
            }
            var cancelEvent = egret.Event.create(egret.TouchEvent, event.type, event.bubbles, event.cancelable);
            cancelEvent.$initTo(event.$stageX, event.$stageY, event.touchPointID);
            var target = this.downTarget;
            cancelEvent.$setTarget(target);
            var list = this.$getPropagationList(target);
            var length = list.length;
            var targetIndex = list.length * 0.5;
            var startIndex = -1;
            for (var i = 0; i < length; i++) {
                if (list[i] === viewport) {
                    startIndex = i;
                    break;
                }
            }
            list.splice(0, list.length - startIndex + 1);
            targetIndex = 0;
            this.$dispatchPropagationEvent(cancelEvent, list, targetIndex);
            egret.Event.release(cancelEvent);
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.dispatchCancelEvent = function (event) {
            var viewport = this.$Scroller[10 /* viewport */];
            if (!viewport) {
                return;
            }
            var cancelEvent = egret.Event.create(egret.TouchEvent, egret.TouchEvent.TOUCH_CANCEL, event.bubbles, event.cancelable);
            cancelEvent.$initTo(event.$stageX, event.$stageY, event.touchPointID);
            var target = this.downTarget;
            cancelEvent.$setTarget(target);
            var list = this.$getPropagationList(target);
            var length = list.length;
            var targetIndex = list.length * 0.5;
            var startIndex = -1;
            for (var i = 0; i < length; i++) {
                if (list[i] === viewport) {
                    startIndex = i;
                    break;
                }
            }
            list.splice(0, startIndex + 1 - 2);
            list.splice(list.length - 1 - startIndex + 2, startIndex + 1 - 2);
            targetIndex -= startIndex + 1;
            this.$dispatchPropagationEvent(cancelEvent, list, targetIndex);
            egret.Event.release(cancelEvent);
        };
        /**
         * @private
         * @param event
         */
        Scroller.prototype.onTouchEnd = function (event) {
            var values = this.$Scroller;
            values[5 /* touchMoved */] = false;
            this.onRemoveListeners();
            var viewport = values[10 /* viewport */];
            var uiValues = viewport.$UIComponent;
            if (values[8 /* touchScrollH */].isStarted()) {
                values[8 /* touchScrollH */].finish(viewport.scrollH, viewport.contentWidth - uiValues[10 /* width */]);
            }
            if (values[9 /* touchScrollV */].isStarted()) {
                values[9 /* touchScrollV */].finish(viewport.scrollV, viewport.contentHeight - uiValues[11 /* height */]);
            }
        };
        /**
         * @private
         */
        Scroller.prototype.onRemoveListeners = function () {
            var stage = this.tempStage || this.$stage;
            this.removeEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            stage.removeEventListener(egret.TouchEvent.TOUCH_END, this.onTouchEnd, this, true);
            stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE, this.onTouchMove, this);
            this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL, this.onTouchCancel, this);
            this.removeEventListener(egret.Event.REMOVED_FROM_STAGE, this.onRemoveListeners, this);
        };
        /**
         * @private
         *
         * @param scrollPos
         */
        Scroller.prototype.horizontalUpdateHandler = function (scrollPos) {
            this.$Scroller[10 /* viewport */].scrollH = scrollPos;
            this.dispatchEventWith(egret.Event.CHANGE);
        };
        /**
         * @private
         *
         * @param scrollPos
         */
        Scroller.prototype.verticalUpdateHandler = function (scrollPos) {
            this.$Scroller[10 /* viewport */].scrollV = scrollPos;
            this.dispatchEventWith(egret.Event.CHANGE);
        };
        /**
         * @private
         *
         */
        Scroller.prototype.horizontalEndHandler = function () {
            if (!this.$Scroller[9 /* touchScrollV */].isPlaying()) {
                this.onChangeEnd();
            }
        };
        /**
         * @private
         *
         */
        Scroller.prototype.verticalEndHanlder = function () {
            if (!this.$Scroller[8 /* touchScrollH */].isPlaying()) {
                this.onChangeEnd();
            }
        };
        /**
         * @private
         *
         */
        Scroller.prototype.onChangeEnd = function () {
            var values = this.$Scroller;
            var horizontalBar = this.horizontalScrollBar;
            var verticalBar = this.verticalScrollBar;
            if (horizontalBar && horizontalBar.visible || verticalBar && verticalBar.visible) {
                if (!values[2 /* autoHideTimer */]) {
                    values[2 /* autoHideTimer */] = new egret.Timer(200, 1);
                    values[2 /* autoHideTimer */].addEventListener(egret.TimerEvent.TIMER_COMPLETE, this.onAutoHideTimer, this);
                }
                values[2 /* autoHideTimer */].reset();
                values[2 /* autoHideTimer */].start();
            }
            eui.UIEvent.dispatchUIEvent(this, eui.UIEvent.CHANGE_END);
        };
        /**
         * @private
         *
         * @param event
         */
        Scroller.prototype.onAutoHideTimer = function (event) {
            var horizontalBar = this.horizontalScrollBar;
            var verticalBar = this.verticalScrollBar;
            if (horizontalBar && horizontalBar.autoVisibility) {
                horizontalBar.visible = false;
            }
            if (verticalBar && verticalBar.autoVisibility) {
                verticalBar.visible = false;
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Scroller.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            var viewport = this.viewport;
            if (viewport) {
                //ๅฟ้กปๅ่ฐ็จsetLayoutBoundsSize()๏ผๅไธบๅฐบๅฏธๆนๅไผๅฝฑๅๅธๅฑไฝ็ฝฎใ
                viewport.setLayoutBoundsSize(unscaledWidth, unscaledHeight);
                viewport.setLayoutBoundsPosition(0, 0);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        Scroller.prototype.partAdded = function (partName, instance) {
            _super.prototype.partAdded.call(this, partName, instance);
            if (instance == this.horizontalScrollBar) {
                this.horizontalScrollBar.touchChildren = false;
                this.horizontalScrollBar.touchEnabled = false;
                this.horizontalScrollBar.viewport = this.viewport;
                if (this.horizontalScrollBar.autoVisibility) {
                    this.horizontalScrollBar.visible = false;
                }
            }
            else if (instance == this.verticalScrollBar) {
                this.verticalScrollBar.touchChildren = false;
                this.verticalScrollBar.touchEnabled = false;
                this.verticalScrollBar.viewport = this.viewport;
                if (this.verticalScrollBar.autoVisibility) {
                    this.verticalScrollBar.visible = false;
                }
            }
        };
        /**
         * The threshold value(in pixels) trigger the rolling.
         * when the touch points deviate from the initial touch point than this value will trigger the rolling.
         *
         * @default 5
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅผๅง่งฆๅๆปๅจ็้ๅผ๏ผไปฅๅ็ดไธบๅไฝ๏ผ๏ผๅฝ่งฆๆธ็นๅ็ฆปๅๅง่งฆๆธ็น็่ท็ฆป่ถ่ฟ่ฟไธชๅผๆถๆไผ่งฆๅๆปๅจใ
         *
         * @default 5
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Scroller.scrollThreshold = 5;
        return Scroller;
    }(eui.Component));
    eui.Scroller = Scroller;
    __reflect(Scroller.prototype, "eui.Scroller");
    eui.registerProperty(Scroller, "viewport", "eui.IViewport", true);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The Skin class defines the base class for all skins.
     * You typically don't need to manually create the instance of this class.
     * It can be created by resolving a EXML.<p/>
     *
     * @example You typically write the skin classes in EXML, as the followiong example shows:<p/>
     * <pre>
     *      <?xml version="1.0" encoding="utf-8"?>
     *      <s:Skin xmlns:s="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing">
     *          <states>
     *              <!-- Specify the states controlled by this skin. -->
     *          </states>
     *          <!-- Define skin. -->
     *      </s:Skin>
     * </pre>
     *
     * @defaultProperty elementsContent
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/SkinExample.ts
     * @language en_US
     */
    /**
     * ็ฎ่คๅบ็ฑปใ้ๅธธๆๅตไธ๏ผๆจไธ้่ฆๆๅจๅๅปบ่ฟไธช็ฑป็ๅฎไพ๏ผ่ๆฏ้่ฟ่งฃๆEXMLๆไปถๅ่ชๅจ็ๆใ<p/>
     *
     * @example ้ๅธธๆจๅฏไปฅๆ็งๅฆไธๆนๅผๅEXMLไปฃ็๏ผ<p/>
     * <pre>
     *      <?xml version="1.0" encoding="utf-8"?>
     *      <s:Skin xmlns:s="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing">
     *          <states>
     *              <!-- Specify the states controlled by this skin. -->
     *          </states>
     *          <!-- Define skin. -->
     *      </s:Skin>
     * </pre>
     *
     * @defaultProperty elementsContent
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/SkinExample.ts
     * @language zh_CN
     */
    var Skin = (function (_super) {
        __extends(Skin, _super);
        function Skin() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            /**
             * The maximum recommended width of the component to be considered.
             * This property can only affect measure result of host component.
             *
             * @default 100000
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่ค็ๆๅคงๅฎฝๅบฆใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default 100000
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.maxWidth = 100000;
            /**
             * The minimum recommended width of the component to be considered.
             * This property can only affect measure result of host component.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่ค็ๆๅฐๅฎฝๅบฆ,ๆญคๅฑๆง่ฎพ็ฝฎไธบๅคงไบmaxWidth็ๅผๆถๆๆใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.minWidth = 0;
            /**
             * The maximum recommended height of the component to be considered.
             * This property can only affect measure result of host component.
             *
             * @default 100000
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่ค็ๆๅคง้ซๅบฆใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default 100000
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.maxHeight = 100000;
            /**
             * The minimum recommended height of the component to be considered.
             * This property can only affect measure result of host component.
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่ค็ๆๅฐ้ซๅบฆ,ๆญคๅฑๆง่ฎพ็ฝฎไธบๅคงไบmaxHeight็ๅผๆถๆๆใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.minHeight = 0;
            /**
             * Number that specifies the explicit width of the skin.
             * This property can only affect measure result of host component.
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่คๆพๅผ่ฎพ็ฝฎๅฎฝๅบฆ,่ฎพ็ฝฎไธบ NaN ่กจ็คบไธๆพๅผ่ฎพ็ฝฎใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.width = NaN;
            /**
             * Number that specifies the explicit height of the skin.
             * This property can only affect measure result of host component.
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ็ฎ่คๆพๅผ่ฎพ็ฝฎ้ซๅบฆ,่ฎพ็ฝฎไธบ NaN ่กจ็คบไธๆพๅผ่ฎพ็ฝฎใไปๅฝฑๅไธปๆบ็ปไปถ็ๆต้็ปๆใ
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.height = NaN;
            /**
             * @private
             */
            _this.$elementsContent = [];
            /**
             * @private
             */
            _this._hostComponent = null;
            /**
             * @private
             */
            _this.$stateValues = new eui.sys.StateValues();
            return _this;
        }
        Object.defineProperty(Skin.prototype, "elementsContent", {
            set: function (value) {
                this.$elementsContent = value;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Skin.prototype, "hostComponent", {
            /**
             * The host component which the skin will be attached.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญค็ฎ่ค้ๅๅฐ็ไธปๆบ็ปไปถ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._hostComponent;
            },
            set: function (value) {
                if (this._hostComponent == value)
                    return;
                if (this._hostComponent) {
                    this._hostComponent.removeEventListener(egret.Event.ADDED_TO_STAGE, this.onAddedToStage, this);
                }
                this._hostComponent = value;
                var values = this.$stateValues;
                values.parent = value;
                if (value) {
                    this.commitCurrentState();
                    if (!this.$stateValues.intialized) {
                        if (value.$stage) {
                            this.initializeStates(value.$stage);
                        }
                        else {
                            value.once(egret.Event.ADDED_TO_STAGE, this.onAddedToStage, this);
                        }
                    }
                }
                eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "hostComponent");
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         *
         * @param event
         */
        Skin.prototype.onAddedToStage = function (event) {
            this.initializeStates(this._hostComponent.$stage);
        };
        return Skin;
    }(egret.EventDispatcher));
    eui.Skin = Skin;
    __reflect(Skin.prototype, "eui.Skin");
    eui.sys.mixin(Skin, eui.sys.StateClient);
    eui.registerProperty(Skin, "elementsContent", "Array", true);
    eui.registerProperty(Skin, "states", "State[]");
    eui.registerBindable(Skin.prototype, "hostComponent");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The TabBar class displays a set of identical tabs.
     * One tab can be selected at a time, and the first tab is selected by default.
     * <p>The set of tabs is defined by the <code>dataProvider</code> property.
     * The appearance of each tab is defined by the <code>ItemRenderer</code> class.</p>
     * <p>You can use the TabBar control to set the active child of a ViewStack container,
     * as the following example shows:</p>
     * <pre>
     *       <s:TabBar dataProvider="{viewStack}"/>
     *       <s:ViewStack id="viewStack">
     *          <s:Group name="tab1"/>
     *          <s:Group name="tab2"/>
     *          <s:Group name="tab3"/>
     *       </s:ViewStack>
     * </pre>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/TabBarExample.ts
     * @language en_US
     */
    /**
     * TabBar ็ฑปๆพ็คบไธ็ป็ธๅ็้้กนๅกใไธๆฌกๅฏไปฅ้ๆฉไธไธช้้กนๅก๏ผไธ้ป่ฎคๆๅตไธ้ๆฉ็ฌฌไธไธช้้กนๅกใ
     * <p>่ฏฅ็ป้้กนๅก็ฑ <code>dataProvider</code> ๅฑๆงๅฎไนใ
     * ๆฏไธช้้กนๅก็ๅค่ง็ฑ <code>ItemRenderer</code> ๅฎไนใ</p>
     * <p>ๅฏไปฅไฝฟ็จ TabBar ๆงไปถ่ฎพ็ฝฎ ViewStack ๅฎนๅจ็ๆดปๅจๅญไปฃ๏ผๅฆไธไพๆ็คบ๏ผ</p>
     * <pre>
     *       <s:TabBar dataProvider="{viewStack}"/>
     *       <s:ViewStack id="viewStack">
     *          <s:Group name="tab1"/>
     *          <s:Group name="tab2"/>
     *          <s:Group name="tab3"/>
     *       </s:ViewStack>
     * </pre>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/TabBarExample.ts
     * @language zh_CN
     */
    var TabBar = (function (_super) {
        __extends(TabBar, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function TabBar() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.indexBeingUpdated = false;
            _this.requireSelection = true;
            _this.useVirtualLayout = false;
            return _this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        TabBar.prototype.createChildren = function () {
            if (!this.$layout) {
                var layout = new eui.HorizontalLayout();
                layout.gap = 0;
                layout.horizontalAlign = eui.JustifyAlign.JUSTIFY;
                layout.verticalAlign = eui.JustifyAlign.CONTENT_JUSTIFY;
                this.$setLayout(layout);
            }
            _super.prototype.createChildren.call(this);
        };
        /**
         * @private
         *
         * @param value
         */
        TabBar.prototype.$setDataProvider = function (value) {
            var dp = this.$dataProvider;
            if (dp && dp instanceof eui.ViewStack) {
                dp.removeEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.onViewStackIndexChange, this);
                this.removeEventListener(egret.Event.CHANGE, this.onIndexChanged, this);
            }
            if (value && value instanceof eui.ViewStack) {
                value.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.onViewStackIndexChange, this);
                this.addEventListener(egret.Event.CHANGE, this.onIndexChanged, this);
            }
            return _super.prototype.$setDataProvider.call(this, value);
        };
        /**
         * @private
         * ่งฆๆธ็นๅป็้ไธญ้กนๆนๅ
         */
        TabBar.prototype.onIndexChanged = function (event) {
            this.indexBeingUpdated = true;
            (this.$dataProvider).selectedIndex = this.selectedIndex;
            this.indexBeingUpdated = false;
        };
        /**
         * @private
         * ViewStack้ไธญ้กนๅ็ๆนๅ
         */
        TabBar.prototype.onViewStackIndexChange = function (event) {
            if (event.property == "selectedIndex" && !this.indexBeingUpdated) {
                this.setSelectedIndex((this.$dataProvider).selectedIndex, false);
            }
        };
        return TabBar;
    }(eui.ListBase));
    eui.TabBar = TabBar;
    __reflect(TabBar.prototype, "eui.TabBar");
})(eui || (eui = {}));
var eui;
(function (eui) {
    var FocusEvent = egret.FocusEvent;
    /**
     *
     */
    /**
     * The TextInput is a textfield input component, the user can input and edit the text.
     *
     * @version Egret 2.5.7
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/TextInputExample.ts
     * @language en_US
     */
    /**
     * TextInput ๆฏไธไธชๆๆฌ่พๅฅๆงไปถ๏ผไพ็จๆท่พๅฅๅ็ผ่พ็ปไธๆผๅผๆๆฌ
     *
     * @version Egret 2.5.7
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/TextInputExample.ts
     * @language zh_CN
     */
    var TextInput = (function (_super) {
        __extends(TextInput, _super);
        function TextInput() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.isFocus = false;
            _this.$TextInput = {
                0: null,
                1: null,
                2: null,
                3: null,
                4: null,
                5: null,
                6: "",
                7: null,
                8: egret.TextFieldInputType.TEXT //inputType
            };
            return _this;
        }
        Object.defineProperty(TextInput.prototype, "prompt", {
            /**
             * @copy eui.EditableText#prompt
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.promptDisplay) {
                    return this.promptDisplay.text;
                }
                return this.$TextInput[0 /* prompt */];
            },
            /**
             * @copy eui.EditableText#prompt
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[0 /* prompt */] = value;
                if (this.promptDisplay) {
                    this.promptDisplay.text = value;
                }
                this.invalidateProperties();
                this.invalidateState();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "displayAsPassword", {
            /**
             * @copy egret.TextField#displayAsPassword
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.displayAsPassword;
                }
                var v = this.$TextInput[1 /* displayAsPassword */];
                return v ? v : false;
            },
            /**
             * @copy egret.TextField#displayAsPassword
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[1 /* displayAsPassword */] = value;
                if (this.textDisplay) {
                    this.textDisplay.displayAsPassword = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "inputType", {
            /**
             * @copy egret.TextField#inputType
             *
             * @version Egret 3.1.6
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.inputType;
                }
                return this.$TextInput[8 /* inputType */];
            },
            /**
             * @copy egret.TextField#inputType
             *
             * @version Egret 3.1.6
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[8 /* inputType */] = value;
                if (this.textDisplay) {
                    this.textDisplay.inputType = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "textColor", {
            /**
             * @copy egret.TextField#textColor
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.textColor;
                }
                return this.$TextInput[2 /* textColor */];
            },
            /**
             * @copy egret.TextField#textColor
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[2 /* textColor */] = value;
                if (this.textDisplay) {
                    this.textDisplay.textColor = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "maxChars", {
            /**
             * @copy egret.TextField#maxChars
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.maxChars;
                }
                var v = this.$TextInput[3 /* maxChars */];
                return v ? v : 0;
            },
            /**
             * @copy egret.TextField#maxChars
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[3 /* maxChars */] = value;
                if (this.textDisplay) {
                    this.textDisplay.maxChars = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "maxWidth", {
            /**
             * @inheritDoc
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.maxWidth;
                }
                var v = this.$TextInput[4 /* maxWidth */];
                return v ? v : 100000;
            },
            /**
             * @inheritDoc
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[4 /* maxWidth */] = value;
                if (this.textDisplay) {
                    this.textDisplay.maxWidth = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "maxHeight", {
            /**
             * @inheritDoc
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    //return this.textDisplay.maxHeight;
                }
                var v = this.$TextInput[5 /* maxHeight */];
                return v ? v : 100000;
            },
            /**
             * @inheritDoc
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[5 /* maxHeight */] = value;
                if (this.textDisplay) {
                    this.textDisplay.maxHeight = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "text", {
            /**
             * @copy egret.TextField#text
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.text;
                }
                return this.$TextInput[6 /* text */];
            },
            /**
             * @copy egret.TextField#text
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[6 /* text */] = value;
                if (this.textDisplay) {
                    this.textDisplay.text = value;
                }
                this.invalidateProperties();
                this.invalidateState();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TextInput.prototype, "restrict", {
            /**
             * @copy egret.TextField#restrict
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                if (this.textDisplay) {
                    return this.textDisplay.restrict;
                }
                return this.$TextInput[7 /* restrict */];
            },
            /**
             * @copy egret.TextField#restrict
             *
             * @version Egret 2.5.7
             * @version eui 1.0
             * @platform Web,Native
             */
            set: function (value) {
                this.$TextInput[7 /* restrict */] = value;
                if (this.textDisplay) {
                    this.textDisplay.restrict = value;
                }
                this.invalidateProperties();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ็ฆ็น็งปๅฅ
         */
        TextInput.prototype.focusInHandler = function (event) {
            this.isFocus = true;
            this.invalidateState();
        };
        /**
         * @private
         * ็ฆ็น็งปๅบ
         */
        TextInput.prototype.focusOutHandler = function (event) {
            this.isFocus = false;
            this.invalidateState();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.5.7
         * @version eui 1.0
         * @platform Web,Native
         */
        TextInput.prototype.getCurrentState = function () {
            var skin = this.skin;
            if (this.prompt && !this.isFocus && !this.text) {
                if (this.enabled && skin.hasState("normalWithPrompt")) {
                    return "normalWithPrompt";
                }
                else if (!this.enabled && skin.hasState("disabledWithPrompt")) {
                    return "disabledWithPrompt";
                }
            }
            else {
                if (this.enabled) {
                    return "normal";
                }
                else {
                    return "disabled";
                }
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.5.7
         * @version eui 1.0
         * @platform Web,Native
         */
        TextInput.prototype.partAdded = function (partName, instance) {
            _super.prototype.partAdded.call(this, partName, instance);
            var values = this.$TextInput;
            if (instance == this.textDisplay) {
                this.textDisplayAdded();
                if (this.textDisplay instanceof eui.EditableText) {
                    this.textDisplay.addEventListener(FocusEvent.FOCUS_IN, this.focusInHandler, this);
                    this.textDisplay.addEventListener(FocusEvent.FOCUS_OUT, this.focusOutHandler, this);
                }
            }
            else if (instance == this.promptDisplay) {
                if (values[0 /* prompt */]) {
                    this.promptDisplay.text = values[0 /* prompt */];
                }
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.5.7
         * @version eui 1.0
         * @platform Web,Native
         */
        TextInput.prototype.partRemoved = function (partName, instance) {
            _super.prototype.partRemoved.call(this, partName, instance);
            if (instance == this.textDisplay) {
                this.textDisplayRemoved();
                if (this.textDisplay instanceof eui.EditableText) {
                    this.textDisplay.removeEventListener(FocusEvent.FOCUS_IN, this.focusInHandler, this);
                    this.textDisplay.removeEventListener(FocusEvent.FOCUS_OUT, this.focusOutHandler, this);
                }
            }
            else if (instance == this.promptDisplay) {
                this.$TextInput[0 /* prompt */] = this.promptDisplay.text;
            }
        };
        /**
         * @private
         */
        TextInput.prototype.textDisplayAdded = function () {
            var values = this.$TextInput;
            if (values[1 /* displayAsPassword */]) {
                this.textDisplay.displayAsPassword = values[1 /* displayAsPassword */];
            }
            if (values[2 /* textColor */]) {
                this.textDisplay.textColor = values[2 /* textColor */];
            }
            if (values[3 /* maxChars */]) {
                this.textDisplay.maxChars = values[3 /* maxChars */];
            }
            if (values[4 /* maxWidth */]) {
                this.textDisplay.maxWidth = values[4 /* maxWidth */];
            }
            if (values[5 /* maxHeight */]) {
                this.textDisplay.maxHeight = values[5 /* maxHeight */];
            }
            if (values[6 /* text */]) {
                this.textDisplay.text = values[6 /* text */];
            }
            if (values[7 /* restrict */]) {
                this.textDisplay.restrict = values[7 /* restrict */];
            }
            if (values[8 /* inputType */]) {
                this.textDisplay.inputType = values[8 /* inputType */];
            }
        };
        /**
         * @private
         */
        TextInput.prototype.textDisplayRemoved = function () {
            var values = this.$TextInput;
            values[1 /* displayAsPassword */] = this.textDisplay.displayAsPassword;
            values[2 /* textColor */] = this.textDisplay.textColor;
            values[3 /* maxChars */] = this.textDisplay.maxChars;
            values[4 /* maxWidth */] = this.textDisplay.maxWidth;
            values[5 /* maxHeight */] = this.textDisplay.maxHeight;
            values[6 /* text */] = this.textDisplay.text;
            values[7 /* restrict */] = this.textDisplay.restrict;
            values[8 /* inputType */] = this.textDisplay.inputType;
        };
        return TextInput;
    }(eui.Component));
    eui.TextInput = TextInput;
    __reflect(TextInput.prototype, "eui.TextInput");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The CheckBox component consists of an optional label and a small box
     * that can contain a check mark or not.<p/>
     *
     * When a user clicks a CheckBox component or its associated text,
     * the CheckBox component sets its <code>selected</code> property
     * to <code>true</code> for checked, and to <code>false</code> for unchecked.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/CheckboxExample.ts
     * @language en_US
     */
    /**
     * CheckBox ็ปไปถๅๅซไธไธชๅฏ้ๆ็ญพๅไธไธชๅฐๆนๆก๏ผ่ฏฅๆนๆกๅๅฏไปฅๅๅซ/ไธๅๅซๅค้ๆ่ฎฐใ<p/>
     * ็จๆทๅๅป CheckBox ็ปไปถๆๅถๅณ่ๆๆฌๆถ๏ผCheckBox ็ปไปถไผๅฐๅถ selected ๅฑๆง่ฎพ็ฝฎไธบ true๏ผ่กจ็คบ้ไธญ๏ผๆ false๏ผ่กจ็คบๅๆถ้ไธญ๏ผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/components/CheckboxExample.ts
     * @language zh_CN
     */
    var CheckBox = (function (_super) {
        __extends(CheckBox, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชCheckBox
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function CheckBox() {
            return _super.call(this) || this;
        }
        return CheckBox;
    }(eui.ToggleButton));
    eui.CheckBox = CheckBox;
    __reflect(CheckBox.prototype, "eui.CheckBox");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ToggleSwitch control defines an on-off control.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ToggleSwitchExample.ts
     * @language en_US
     */
    /**
     * ToggleSwitch ่กจ็คบไธไธชๅผๅณ็ปไปถใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ToggleSwitchExample.ts
     * @language zh_CN
     */
    var ToggleSwitch = (function (_super) {
        __extends(ToggleSwitch, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ToggleSwitch() {
            return _super.call(this) || this;
        }
        return ToggleSwitch;
    }(eui.ToggleButton));
    eui.ToggleSwitch = ToggleSwitch;
    __reflect(ToggleSwitch.prototype, "eui.ToggleSwitch");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The UILayer class is the subclass of the Group class.It not only has the standard function of the Group class,but also
     * can keep its size the same to the stage size (Stage.stageWidth,Stage.stageHeight).Its size will changes as the stage size changes.
     * like any normal container class,you can create multiple instance of the UILayer class,but it is usually used as the root of the UI display list.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * UILayer ๆฏ Group ็ๅญ็ฑป๏ผๅฎ้คไบๅทๆๅฎนๅจ็ๆๆๆๅๅ่ฝ๏ผ่ฟ่ฝๅค่ชๅจไฟๆ่ช่บซๅฐบๅฏธๅง็ปไธ่ๅฐๅฐบๅฏธ็ธๅ๏ผStage.stageWidth,Stage.stageHeight๏ผใ
     * ๅฝ่ๅฐๅฐบๅฏธๅ็ๆนๅๆถ๏ผๅฎไผ่ท้่ๅฐๅฐบๅฏธๆนๅใUILayer ่ทๆฎ้ๅฎนๅจไธๆท๏ผๅ่ฎธๅๅปบๅคไธชๅฎไพ๏ผไฝ้ๅธธ้ฝๅฐๅฎไฝไธบUIๆพ็คบๅ่กจ็ๆน่็นไฝฟ็จใ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var UILayer = (function (_super) {
        __extends(UILayer, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function UILayer() {
            var _this = _super.call(this) || this;
            _this.addEventListener(egret.Event.ADDED_TO_STAGE, _this.onAddToStage, _this);
            _this.addEventListener(egret.Event.REMOVED_FROM_STAGE, _this.onRemoveFromStage, _this);
            return _this;
        }
        /**
         * @private
         * ๆทปๅๅฐ่ๅฐ
         */
        UILayer.prototype.onAddToStage = function (event) {
            this.$stage.addEventListener(egret.Event.RESIZE, this.onResize, this);
            this.onResize();
        };
        /**
         * @private
         * ไป่ๅฐ็งป้ค
         */
        UILayer.prototype.onRemoveFromStage = function (event) {
            this.$stage.removeEventListener(egret.Event.RESIZE, this.onResize, this);
        };
        /**
         * @private
         * ่ๅฐๅฐบๅฏธๆนๅ
         */
        UILayer.prototype.onResize = function (event) {
            var stage = this.$stage;
            this.$setWidth(stage.$stageWidth);
            this.$setHeight(stage.$stageHeight);
        };
        return UILayer;
    }(eui.Group));
    eui.UILayer = UILayer;
    __reflect(UILayer.prototype, "eui.UILayer");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The VScrollBar (vertical scrollbar) control lets you control
     * the portion of data that is displayed when there is too much data
     * to fit vertically in a display area.
     *
     * <p>Although you can use the VScrollBar control as a stand-alone control,
     * you usually combine it as part of another group of components to
     * provide scrolling functionality.</p>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/VScrollBarExample.ts
     * @language en_US
     */
    /**
     * VScrollBar๏ผๅ็ด ScrollBar๏ผๆงไปถๅฏไปฅๅจๅๆฐๆฎๅคชๅค่ไธ่ฝๅจๆพ็คบๅบๅไธญไปฅๅ็ดๆนๅๅฎๅจๆพ็คบๆถๆงๅถๆพ็คบ็ๆฐๆฎ้จๅใ
     * <p>่ฝ็ถ VScrollBar ๆงไปถๅฏไปฅๅ็ฌไฝฟ็จ๏ผไฝ้ๅธธๅฐๅฎไธๅถไป็ปไปถไธ่ตทไฝฟ็จๆฅๆไพๆปๅจๅ่ฝใ</p>
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/VScrollBarExample.ts
     * @language zh_CN
     */
    var VScrollBar = (function (_super) {
        __extends(VScrollBar, _super);
        function VScrollBar() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VScrollBar.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            var thumb = this.thumb;
            var viewport = this.$viewport;
            if (!thumb || !viewport) {
                return;
            }
            var bounds = egret.$TempRectangle;
            thumb.getPreferredBounds(bounds);
            var thumbHeight = bounds.height;
            var thumbX = bounds.x;
            var vsp = viewport.scrollV;
            var contentHeight = viewport.contentHeight;
            var height = viewport.height;
            if (vsp <= 0) {
                var scaleHeight = thumbHeight * (1 - (-vsp) / (height * 0.5));
                scaleHeight = Math.max(5, Math.round(scaleHeight));
                thumb.setLayoutBoundsSize(NaN, scaleHeight);
                thumb.setLayoutBoundsPosition(thumbX, 0);
            }
            else if (vsp >= contentHeight - height) {
                var scaleHeight = thumbHeight * (1 - (vsp - contentHeight + height) / (height * 0.5));
                scaleHeight = Math.max(5, Math.round(scaleHeight));
                thumb.setLayoutBoundsSize(NaN, scaleHeight);
                thumb.setLayoutBoundsPosition(thumbX, unscaledHeight - scaleHeight);
            }
            else {
                var thumbY = (unscaledHeight - thumbHeight) * vsp / (contentHeight - height);
                thumb.setLayoutBoundsSize(NaN, NaN);
                thumb.setLayoutBoundsPosition(thumbX, thumbY);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VScrollBar.prototype.onPropertyChanged = function (event) {
            switch (event.property) {
                case "scrollV":
                case "contentHeight":
                    this.invalidateDisplayList();
                    break;
            }
        };
        return VScrollBar;
    }(eui.ScrollBarBase));
    eui.VScrollBar = VScrollBar;
    __reflect(VScrollBar.prototype, "eui.VScrollBar");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The VSlider (vertical slider) control lets users select a value
     * by moving a slider thumb between the end points of the slider track.
     * The current value of the slider is determined by the relative location of the thumb between
     * the end points of the slider, corresponding to the slider's minimum and maximum values.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/VSliderExample.ts
     * @language en_US
     */
    /**
     * ไฝฟ็จ VSlider๏ผๅ็ดๆปๅ๏ผๆงไปถ๏ผ็จๆทๅฏ้่ฟๅจๆปๅ่ฝจ้็็ซฏ็นไน้ด็งปๅจๆปๅๆฅ้ๆฉๅผใ
     * ๆปๅ็ๅฝๅๅผ็ฑๆปๅ็ซฏ็น๏ผๅฏนๅบไบๆปๅ็ๆๅฐๅผๅๆๅคงๅผ๏ผไน้ดๆปๅ็็ธๅฏนไฝ็ฝฎ็กฎๅฎใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/VSliderExample.ts
     * @language zh_CN
     */
    var VSlider = (function (_super) {
        __extends(VSlider, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function VSlider() {
            return _super.call(this) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VSlider.prototype.pointToValue = function (x, y) {
            if (!this.thumb || !this.track)
                return 0;
            var values = this.$Range;
            var range = values[0 /* maximum */] - values[2 /* minimum */];
            var thumbRange = this.getThumbRange();
            return values[2 /* minimum */] + ((thumbRange != 0) ? ((thumbRange - y) / thumbRange) * range : 0);
        };
        /**
         * @private
         *
         * @returns
         */
        VSlider.prototype.getThumbRange = function () {
            var bounds = egret.$TempRectangle;
            this.track.getLayoutBounds(bounds);
            var thumbRange = bounds.height;
            this.thumb.getLayoutBounds(bounds);
            return thumbRange - bounds.height;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VSlider.prototype.updateSkinDisplayList = function () {
            if (!this.thumb || !this.track)
                return;
            var values = this.$Range;
            var thumbRange = this.getThumbRange();
            var range = values[0 /* maximum */] - values[2 /* minimum */];
            var thumbPosTrackY = (range > 0) ? thumbRange - (((this.pendingValue - values[2 /* minimum */]) / range) * thumbRange) : 0;
            var thumbPos = this.track.localToGlobal(0, thumbPosTrackY, egret.$TempPoint);
            var thumbPosX = thumbPos.x;
            var thumbPosY = thumbPos.y;
            var thumbPosParentY = this.thumb.$parent.globalToLocal(thumbPosX, thumbPosY, egret.$TempPoint).y;
            var bounds = egret.$TempRectangle;
            var thumbHeight = bounds.height;
            this.thumb.getLayoutBounds(bounds);
            this.thumb.setLayoutBoundsPosition(bounds.x, Math.round(thumbPosParentY));
            if (this.trackHighlight) {
                var trackHighlightY = this.trackHighlight.$parent.globalToLocal(thumbPosX, thumbPosY, egret.$TempPoint).y;
                this.trackHighlight.y = Math.round(trackHighlightY + thumbHeight);
                this.trackHighlight.height = Math.round(thumbRange - trackHighlightY);
            }
        };
        return VSlider;
    }(eui.SliderBase));
    eui.VSlider = VSlider;
    __reflect(VSlider.prototype, "eui.VSlider");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * An ViewStack navigator container consists of a collection of child
     * containers stacked on top of each other, where only one child
     * at a time is visible.
     * When a different child container is selected, it seems to replace
     * the old one because it appears in the same location.
     * However, the old child container still exists; it is just invisible.
     *
     * @event eui.CollectionEvent.COLLECTION_CHANGE Dispatched when the ICollection has been updated in some way.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ViewStackExample.ts
     * @language en_US
     */
    /**
     * ViewStack ๅฏผ่ชๅจๅฎนๅจ็ฑไธ็ปๅฝผๆญคไธไธๅๅ็ๅญๅฎนๅจ็ปๆ๏ผๅถไธญไธๆฌกๅชๅฏไปฅๆพ็คบไธไธชๅญๅฎนๅจใ
     * ้ๆฉๅฆไธไธชๅญๅฎนๅจๅ๏ผๅฎๅฐๆพ็คบๅจๅๆฅๅญๅฎนๅจ็ไฝ็ฝฎๅค๏ผๆไปฅ็่ตทๆฅๅฅฝๅๆญคๅญๅฎนๅจๆฟๆขไบๅๆฅ็ๅญๅฎนๅจใ
     * ไฝๆฏ๏ผๅๆฅ็ๅญๅฎนๅจไป็ถๅญๅจ๏ผๅชไธ่ฟๅฎ็ฐๅจๅคไบไธๅฏ่ง็ถๆใ
     *
     * @event eui.CollectionEvent.COLLECTION_CHANGE ไปฅๆ็งๆนๅผๆดๆฐ ICollection ๅๅๆดพใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/components/ViewStackExample.ts
     * @language zh_CN
     */
    var ViewStack = (function (_super) {
        __extends(ViewStack, _super);
        /**
         * Constructor.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ViewStack() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this._selectedChild = null;
            /**
             * @private
             * ๅจๅฑๆงๆไบคๅ็ผๅญ้ไธญ้กน็ดขๅผ
             */
            _this.proposedSelectedIndex = eui.ListBase.NO_PROPOSED_SELECTION;
            /**
             * @private
             */
            _this._selectedIndex = -1;
            return _this;
        }
        Object.defineProperty(ViewStack.prototype, "layout", {
            /**
             * The layout object for this container.
             * This object is responsible for the measurement and layout of
             * the visual elements in the container.
             *
             * @default eui.BasicLayout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญคๅฎนๅจ็ layout ๅฏน่ฑกใๆญคๅฏน่ฑก่ด่ดฃๅฎนๅจไธญๅฏ่งๅ็ด็ๆต้ๅๅธๅฑใ
             *
             * @default eui.BasicLayout
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$layout;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ViewStack.prototype, "selectedChild", {
            /**
             * A reference to the currently visible child container.
             * The default is a reference to the first child.
             * If there are no children, this property is <code>null</code>.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฏนๅฝๅๅฏ่งๅญๅฎนๅจ็ๅผ็จใ้ป่ฎค่ฎพ็ฝฎไธบๅฏน็ฌฌไธไธชๅญๅฎนๅจ็ๅผ็จใๅฆๆๆฒกๆๅญ้กน๏ผๅๆญคๅฑๆงไธบ <code>null</code>ใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                var index = this.selectedIndex;
                if (index >= 0 && index < this.numChildren)
                    return this.getChildAt(index);
                return null;
            },
            set: function (value) {
                var index = this.getChildIndex(value);
                if (index >= 0 && index < this.numChildren)
                    this.setSelectedIndex(index);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ViewStack.prototype, "selectedIndex", {
            /**
             * The zero-based index of the currently visible child container.
             * Child indexes are in the range 0, 1, 2, ..., n - 1,
             * where <code>n</code> is the number of children.
             * The default value is 0, corresponding to the first child.
             * If there are no children, the value of this property is <code>-1</code>.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝๅๅฏ่งๅญๅฎนๅจ็ไป้ถๅผๅง็็ดขๅผใๅญ็ดขๅผ็่ๅดๆฏ 0ใ1ใ2ใ...ใn - 1๏ผๅถไธญ <code>n</code> ๆฏๅญ้กน็ๆฐ็ฎใ
             * ้ป่ฎคๅผๆฏ 0๏ผๅฏนๅบไบ็ฌฌไธไธชๅญ้กนใๅฆๆไธๅญๅจๅญๅฎนๅจ๏ผๅๆญคๅฑๆง็ๅผไธบ -1ใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.proposedSelectedIndex != eui.ListBase.NO_PROPOSED_SELECTION ? this.proposedSelectedIndex : this._selectedIndex;
            },
            set: function (value) {
                value = +value | 0;
                this.setSelectedIndex(value);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ่ฎพ็ฝฎ้ไธญ้กน็ดขๅผ
         */
        ViewStack.prototype.setSelectedIndex = function (value) {
            if (value == this.selectedIndex) {
                return;
            }
            this.proposedSelectedIndex = value;
            this.invalidateProperties();
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "selectedIndex");
        };
        /**
         * @private
         * ไธไธชๅญ้กน่ขซๆทปๅๅฐๅฎนๅจๅ๏ผๆญคๆนๆณไธไปๅจๆไฝaddChild()ๆถไผ่ขซๅ่ฐ๏ผๅจๆไฝsetChildIndex()ๆswapChildrenๆถไนไผๅ่ฐใ
         * ๅฝๅญ้กน็ดขๅผๅ็ๆนๅๆถ๏ผไผๅ่งฆๅ$childRemoved()ๆนๆณ๏ผ็ถๅ่งฆๅ$childAdded()ๆนๆณใ
         */
        ViewStack.prototype.$childAdded = function (child, index) {
            _super.prototype.$childAdded.call(this, child, index);
            this.showOrHide(child, false);
            var selectedIndex = this.selectedIndex;
            if (selectedIndex == -1) {
                this.setSelectedIndex(index);
            }
            else if (index <= this.selectedIndex && this.$stage) {
                this.setSelectedIndex(selectedIndex + 1);
            }
            eui.CollectionEvent.dispatchCollectionEvent(this, eui.CollectionEvent.COLLECTION_CHANGE, eui.CollectionEventKind.ADD, index, -1, [child.name]);
        };
        /**
         * @private
         * ไธไธชๅญ้กนไปๅฎนๅจๅ็งป้ค๏ผๆญคๆนๆณไธไปๅจๆไฝremoveChild()ๆถไผ่ขซๅ่ฐ๏ผๅจๆไฝsetChildIndex()ๆswapChildrenๆถไนไผๅ่ฐใ
         * ๅฝๅญ้กน็ดขๅผๅ็ๆนๅๆถ๏ผไผๅ่งฆๅ$childRemoved()ๆนๆณ๏ผ็ถๅ่งฆๅ$childAdded()ๆนๆณใ
         */
        ViewStack.prototype.$childRemoved = function (child, index) {
            _super.prototype.$childRemoved.call(this, child, index);
            this.showOrHide(child, true);
            var selectedIndex = this.selectedIndex;
            if (index == selectedIndex) {
                if (this.numChildren > 0) {
                    if (index == 0) {
                        this.proposedSelectedIndex = 0;
                        this.invalidateProperties();
                    }
                    else
                        this.setSelectedIndex(0);
                }
                else
                    this.setSelectedIndex(-1);
            }
            else if (index < selectedIndex) {
                this.setSelectedIndex(selectedIndex - 1);
            }
            eui.CollectionEvent.dispatchCollectionEvent(this, eui.CollectionEvent.COLLECTION_CHANGE, eui.CollectionEventKind.REMOVE, index, -1, [child.name]);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ViewStack.prototype.commitProperties = function () {
            _super.prototype.commitProperties.call(this);
            if (this.proposedSelectedIndex != eui.ListBase.NO_PROPOSED_SELECTION) {
                this.commitSelection(this.proposedSelectedIndex);
                this.proposedSelectedIndex = eui.ListBase.NO_PROPOSED_SELECTION;
            }
        };
        /**
         * @private
         *
         * @param newIndex
         */
        ViewStack.prototype.commitSelection = function (newIndex) {
            if (newIndex >= 0 && newIndex < this.numChildren) {
                this._selectedIndex = newIndex;
                if (this._selectedChild) {
                    this.showOrHide(this._selectedChild, false);
                }
                this._selectedChild = this.getElementAt(this._selectedIndex);
                this.showOrHide(this._selectedChild, true);
            }
            else {
                this._selectedChild = null;
                this._selectedIndex = -1;
            }
            this.invalidateSize();
            this.invalidateDisplayList();
        };
        /**
         * @private
         *
         * @param child
         * @param visible
         */
        ViewStack.prototype.showOrHide = function (child, visible) {
            if (egret.is(child, "eui.UIComponent")) {
                child.includeInLayout = visible;
            }
            child.visible = visible;
        };
        Object.defineProperty(ViewStack.prototype, "length", {
            /**
             * number of children
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅญ้กนๆฐ้
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$children.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ViewStack.prototype.getItemAt = function (index) {
            var element = this.$children[index];
            return element ? element.name : "";
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ViewStack.prototype.getItemIndex = function (item) {
            var list = this.$children;
            var length = list.length;
            for (var i = 0; i < length; i++) {
                if (list[i].name == item) {
                    return i;
                }
            }
            return -1;
        };
        return ViewStack;
    }(eui.Group));
    eui.ViewStack = ViewStack;
    __reflect(ViewStack.prototype, "eui.ViewStack", ["eui.ICollection", "egret.IEventDispatcher"]);
    eui.registerBindable(ViewStack.prototype, "selectedIndex");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         *
         * @param fraction
         * @returns
         */
        function sineInOut(fraction) {
            return -0.5 * (Math.cos(Math.PI * fraction) - 1);
        }
        /**
         * @private
         * ๆฐๅผ็ผๅจๅทฅๅท็ฑป
         */
        var Animation = (function () {
            /**
             * @private
             */
            function Animation(updateFunction, thisObject) {
                /**
                 * @private
                 * ๆญคๅจ็ป็็ผๅจ่กไธบใ่ฎพ็ฝฎไธบnullๆๅณ็ไธไฝฟ็จ็ผๅจ๏ผ้ป่ฎคๅผไธบ sineInOut
                 */
                this.easerFunction = sineInOut;
                /**
                 * @private
                 * ๆฏๅฆๆญฃๅจๆญๆพๅจ็ป๏ผไธๅๆฌๅปถ่ฟ็ญๅพๅๆๅ็้ถๆฎต
                 */
                this.isPlaying = false;
                /**
                 * @private
                 * ๅจ็ปๆ็ปญๆถ้ด,ๅไฝๆฏซ็ง๏ผ้ป่ฎคๅผ500
                 */
                this.duration = 500;
                /**
                 * @private
                 * ๅจ็ปๅฐๅฝๅๆถ้ดๅฏนๅบ็ๅผใ
                 */
                this.currentValue = 0;
                /**
                 * @private
                 * ่ตทๅงๅผ
                 */
                this.from = 0;
                /**
                 * @private
                 * ็ป็นๅผใ
                 */
                this.to = 0;
                /**
                 * @private
                 * ๅจ็ปๅฏๅจๆถๅป
                 */
                this.startTime = 0;
                /**
                 * @private
                 * ๅจ็ปๆญๆพ็ปๆๆถ็ๅ่ฐๅฝๆฐ
                 */
                this.endFunction = null;
                this.updateFunction = updateFunction;
                this.thisObject = thisObject;
            }
            /**
             * @private
             * ๅผๅงๆญฃๅๆญๆพๅจ็ป,ๆ่ฎบไฝๆถ่ฐ็จ้ฝ้ๆฐไป้ถๆถๅปๅผๅง๏ผ่ฅ่ฎพ็ฝฎไบๅปถ่ฟไผ้ฆๅ่ฟ่ก็ญๅพใ
             */
            Animation.prototype.play = function () {
                this.stop();
                this.start();
            };
            /**
             * @private
             * ๅผๅงๆญๆพๅจ็ป
             */
            Animation.prototype.start = function () {
                this.isPlaying = false;
                this.currentValue = 0;
                this.startTime = egret.getTimer();
                this.doInterval(this.startTime);
                egret.startTick(this.doInterval, this);
            };
            /**
             * @private
             * ๅๆญขๆญๆพๅจ็ป
             */
            Animation.prototype.stop = function () {
                this.isPlaying = false;
                this.startTime = 0;
                egret.stopTick(this.doInterval, this);
            };
            /**
             * @private
             * ่ฎก็ฎๅฝๅๅผๅนถ่ฟๅๅจ็ปๆฏๅฆ็ปๆ
             */
            Animation.prototype.doInterval = function (currentTime) {
                var runningTime = currentTime - this.startTime;
                if (!this.isPlaying) {
                    this.isPlaying = true;
                }
                var duration = this.duration;
                var fraction = duration == 0 ? 1 : Math.min(runningTime, duration) / duration;
                if (this.easerFunction) {
                    fraction = this.easerFunction(fraction);
                }
                this.currentValue = this.from + (this.to - this.from) * fraction;
                if (this.updateFunction)
                    this.updateFunction.call(this.thisObject, this);
                var isEnded = runningTime >= duration;
                if (isEnded) {
                    this.stop();
                }
                if (isEnded && this.endFunction) {
                    this.endFunction.call(this.thisObject, this);
                }
                return true;
            };
            return Animation;
        }());
        sys.Animation = Animation;
        __reflect(Animation.prototype, "eui.sys.Animation");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Default instance of interface <code>IThemeAdapter</code>.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ้ป่ฎค็IThemeAdapterๆฅๅฃๅฎ็ฐใ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var DefaultThemeAdapter = (function () {
        function DefaultThemeAdapter() {
        }
        /**
         * ่งฃๆไธป้ข
         * @param url ๅพ่งฃๆ็ไธป้ขurl
         * @param compFunc ่งฃๆๅฎๆๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผcompFunc(e:egret.Event):void;
         * @param errorFunc ่งฃๆๅคฑ่ดฅๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผerrorFunc():void;
         * @param thisObject ๅ่ฐ็thisๅผ็จ
         */
        DefaultThemeAdapter.prototype.getTheme = function (url, compFunc, errorFunc, thisObject) {
            function onGet(event) {
                var loader = (event.target);
                compFunc.call(thisObject, loader.response);
            }
            function onError(event) {
                errorFunc.call(thisObject);
            }
            var loader = new egret.HttpRequest();
            loader.addEventListener(egret.Event.COMPLETE, onGet, thisObject);
            loader.addEventListener(egret.IOErrorEvent.IO_ERROR, onError, thisObject);
            loader.responseType = egret.HttpResponseType.TEXT;
            loader.open(url);
            loader.send();
        };
        return DefaultThemeAdapter;
    }());
    eui.DefaultThemeAdapter = DefaultThemeAdapter;
    __reflect(DefaultThemeAdapter.prototype, "eui.DefaultThemeAdapter", ["eui.IThemeAdapter"]);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * @private
     */
    var listeners = "__listeners__";
    /**
     * @private
     */
    var bindables = "__bindables__";
    /**
     * @private
     */
    var bindableCount = 0;
    /**
     * @private
     *
     * @param host
     * @param property
     * @returns
     */
    function getPropertyDescriptor(host, property) {
        var data = Object.getOwnPropertyDescriptor(host, property);
        if (data) {
            return data;
        }
        var prototype = Object.getPrototypeOf(host);
        if (prototype) {
            return getPropertyDescriptor(prototype, property);
        }
        return null;
    }
    function notifyListener(host, property) {
        var list = host[listeners];
        var length = list.length;
        for (var i = 0; i < length; i += 2) {
            var listener = list[i];
            var target = list[i + 1];
            listener.call(target, property);
        }
    }
    /**
     * The Watcher class defines utility method that you can use with bindable properties.
     * These methods let you define an event handler that is executed whenever a bindable property is updated.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/binding/WatcherExample.ts
     * @language en_US
     */
    /**
     * Watcher ็ฑป่ฝๅค็่งๅฏ็ปๅฎๅฑๆง็ๆนๅ๏ผๆจๅฏไปฅๅฎไนไธไธชไบไปถๅค็ๅฝๆฐไฝไธบ Watcher ็ๅ่ฐๆนๆณ๏ผๅจๆฏๆฌกๅฏ็ปๅฎๅฑๆง็ๅผๆนๅๆถ้ฝๆง่กๆญคๅฝๆฐใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/binding/WatcherExample.ts
     * @language zh_CN
     */
    var Watcher = (function () {
        /**
         * Constructor.
         * Not for public use. This method is called only from the <code>watch()</code> method.
         * See the <code>watch()</code> method for parameter usage.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐ๏ผ้ๅฌๅผใๅช่ฝไป watch() ๆนๆณไธญ่ฐ็จๆญคๆนๆณใๆๅณๅๆฐ็จๆณ๏ผ่ฏทๅ้ watch() ๆนๆณใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Watcher(property, handler, thisObject, next) {
            /**
             * @private
             */
            this.isExecuting = false;
            this.property = property;
            this.handler = handler;
            this.next = next;
            this.thisObject = thisObject;
        }
        /**
         * Creates and starts a Watcher instance.
         * The Watcher can only watch the property of a Object which host is instance of egret.IEventDispatcher.
         * @param host The object that hosts the property or property chain to be watched.
         * You can use the use the <code>reset()</code> method to change the value of the <code>host</code> argument
         * after creating the Watcher instance.
         * The <code>host</code> maintains a list of <code>handlers</code> to invoke when <code>prop</code> changes.
         * @param chain A value specifying the property or chain to be watched.
         * For example, to watch the property <code>host.a.b.c</code>,
         * call the method as: <code>watch(host, ["a","b","c"], ...)</code>.
         * @param handler  An event handler function called when the value of the watched property
         * (or any property in a watched chain) is modified.
         * @param thisObject <code>this</code> object of which binding with handler
         * @returns he ChangeWatcher instance, if at least one property name has been specified to
         * the <code>chain</code> argument; null otherwise.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบๅนถๅฏๅจ Watcher ๅฎไพใๆณจๆ๏ผWatcher ๅช่ฝ็่ง host ไธบ egret.IEventDispatcher ๅฏน่ฑก็ๅฑๆงๆนๅใ่ฅๅฑๆง้พไธญๆไธชๅฑๆงๆๅฏนๅบ็ๅฎไพไธๆฏ egret.IEventDispatcher๏ผ
         * ๅๅฑๆง้พไธญๅจๅฎไนๅ็ๅฑๆงๆนๅๅฐๆๆณๆฃๆตๅฐใ
         * @param host ็จไบๆฟ่ฝฝ่ฆ็่ง็ๅฑๆงๆๅฑๆง้พ็ๅฏน่ฑกใ
         * ๅๅปบWatcherๅฎไพๅ๏ผๆจๅฏไปฅๅฉ็จ<code>reset()</code>ๆนๆณๆดๆน<code>host</code>ๅๆฐ็ๅผใ
         * ๅฝ<code>prop</code>ๆนๅ็ๆถๅ๏ผไผไฝฟๅพhostๅฏนๅบ็ไธ็ณปๅ<code>handlers</code>่ขซ่งฆๅใ
         * @param chain ็จไบๆๅฎ่ฆ็่ง็ๅฑๆง้พ็ๅผใไพๅฆ๏ผ่ฆ็่งๅฑๆง host.a.b.c๏ผ้ๆไปฅไธๅฝขๅผ่ฐ็จๆญคๆนๆณ๏ผwatchยฌ(host, ["a","b","c"], ...)ใ
         * @param handler ๅจ็่ง็็ฎๆๅฑๆง้พไธญไปปไฝๅฑๆง็ๅผๅ็ๆนๅๆถ่ฐ็จ็ไบไปถๅค็ๅฝๆฐใ
         * @param thisObject handler ๆนๆณ็ปๅฎ็thisๅฏน่ฑก
         * @returns ๅฆๆๅทฒไธบ chain ๅๆฐ่ณๅฐๆๅฎไบไธไธชๅฑๆงๅ็งฐ๏ผๅ่ฟๅ Watcher ๅฎไพ๏ผๅฆๅ่ฟๅ nullใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Watcher.watch = function (host, chain, handler, thisObject) {
            if (true) {
                if (!chain) {
                    egret.$error(1003, "chain");
                }
            }
            if (chain.length > 0) {
                var property = chain.shift();
                var next = Watcher.watch(null, chain, handler, thisObject);
                var watcher = new Watcher(property, handler, thisObject, next);
                watcher.reset(host);
                return watcher;
            }
            else {
                return null;
            }
        };
        /**
         * @private
         * ๆฃๆฅๅฑๆงๆฏๅฆๅฏไปฅ็ปๅฎใ่ฅ่ฟๆช็ปๅฎ๏ผๅฐ่ฏๆทปๅ็ปๅฎไบไปถใ่ฅๆฏๅช่ฏปๆๅชๅๅฑๆง๏ผ่ฟๅfalseใ
         */
        Watcher.checkBindable = function (host, property) {
            var list = host[bindables];
            if (list && list.indexOf(property) != -1) {
                return true;
            }
            var isEventDispatcher = egret.is(host, "egret.IEventDispatcher");
            if (!isEventDispatcher && !host[listeners]) {
                host[listeners] = [];
            }
            var data = getPropertyDescriptor(host, property);
            if (data && data.set && data.get) {
                var orgSet_1 = data.set;
                data.set = function (value) {
                    if (this[property] != value) {
                        orgSet_1.call(this, value);
                        if (isEventDispatcher) {
                            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, property);
                        }
                        else {
                            notifyListener(this, property);
                        }
                    }
                };
            }
            else if (!data || (!data.get && !data.set)) {
                bindableCount++;
                var newProp_1 = "_" + bindableCount + property;
                host[newProp_1] = data ? data.value : null;
                data = { enumerable: true, configurable: true };
                data.get = function () {
                    return this[newProp_1];
                };
                data.set = function (value) {
                    if (this[newProp_1] != value) {
                        this[newProp_1] = value;
                        if (isEventDispatcher) {
                            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, property);
                        }
                        else {
                            notifyListener(this, property);
                        }
                    }
                };
            }
            else {
                return false;
            }
            Object.defineProperty(host, property, data);
            eui.registerBindable(host, property);
        };
        /**
         * Detaches this Watcher instance, and its handler function, from the current host.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปๅฝๅๅฎฟไธปไธญๆญๅผๆญค Watcher ๅฎไพๅๅถๅค็ๅฝๆฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Watcher.prototype.unwatch = function () {
            this.reset(null);
            this.handler = null;
            if (this.next) {
                this.next.handler = null;
            }
        };
        /**
         * Retrieves the current value of the watched property or property chain, or null if the host object is null.
         * @example
         * <pre>
         * watch(obj, ["a","b","c"], ...).getValue() === obj.a.b.c
         * </pre>
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฃ็ดข่งๅฏ็ๅฑๆงๆๅฑๆง้พ็ๅฝๅๅผ๏ผๅฝๅฎฟไธปๅฏน่ฑกไธบ็ฉบๆถๆญคๅผไธบ็ฉบใ
         * @example
         * <pre>
         * watch(obj, ["a","b","c"], ...).getValue() === obj.a.b.c
         * </pre>
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Watcher.prototype.getValue = function () {
            if (this.next) {
                return this.next.getValue();
            }
            return this.getHostPropertyValue();
        };
        /**
         * Sets the handler function.s
         * @param handler The handler function. This argument must not be null.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎๅค็ๅฝๆฐใ
         * @param handler ๅค็ๅฝๆฐ๏ผๆญคๅๆฐๅฟ้กปไธบ้็ฉบใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Watcher.prototype.setHandler = function (handler, thisObject) {
            this.handler = handler;
            this.thisObject = thisObject;
            if (this.next) {
                this.next.setHandler(handler, thisObject);
            }
        };
        /**
         * Resets this ChangeWatcher instance to use a new host object.
         * You can call this method to reuse a watcher instance on a different host.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้็ฝฎๆญค Watcher ๅฎไพไฝฟ็จๆฐ็ๅฎฟไธปๅฏน่ฑกใ
         * ๆจๅฏไปฅ้่ฟ่ฏฅๆนๆณๅฎ็ฐไธไธชWatcherๅฎไพ็จไบไธๅ็ๅฎฟไธปใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Watcher.prototype.reset = function (newHost) {
            var oldHost = this.host;
            if (oldHost) {
                if (egret.is(oldHost, "egret.IEventDispatcher")) {
                    oldHost.removeEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.wrapHandler, this);
                }
                else {
                    var list = oldHost[listeners];
                    var index = list.indexOf(this);
                    list.splice(index - 1, 2);
                }
            }
            this.host = newHost;
            if (newHost) {
                Watcher.checkBindable(newHost, this.property);
                if (egret.is(newHost, "egret.IEventDispatcher")) {
                    newHost.addEventListener(eui.PropertyEvent.PROPERTY_CHANGE, this.wrapHandler, this, false, 100);
                }
                else {
                    var list = newHost[listeners];
                    list.push(this.onPropertyChange);
                    list.push(this);
                }
            }
            if (this.next)
                this.next.reset(this.getHostPropertyValue());
        };
        /**
         * @private
         *
         * @returns
         */
        Watcher.prototype.getHostPropertyValue = function () {
            return this.host ? this.host[this.property] : null;
        };
        /**
         * @private
         */
        Watcher.prototype.wrapHandler = function (event) {
            this.onPropertyChange(event.property);
        };
        /**
         * @private
         */
        Watcher.prototype.onPropertyChange = function (property) {
            if (property == this.property && !this.isExecuting) {
                try {
                    this.isExecuting = true;
                    if (this.next)
                        this.next.reset(this.getHostPropertyValue());
                    this.handler.call(this.thisObject, this.getValue());
                }
                finally {
                    this.isExecuting = false;
                }
            }
        };
        return Watcher;
    }());
    eui.Watcher = Watcher;
    __reflect(Watcher.prototype, "eui.Watcher");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    function joinValues(templates) {
        var first = templates[0];
        var value = first instanceof eui.Watcher ? first.getValue() : first;
        var length = templates.length;
        for (var i = 1; i < length; i++) {
            var item = templates[i];
            if (item instanceof eui.Watcher) {
                item = item.getValue();
            }
            value += item;
        }
        return value;
    }
    /**
     * The Binding class defines utility methods for performing data binding.
     * You can use the methods defined in this class to configure data bindings.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/binding/BindingExample.ts
     * @language en_US
     */
    /**
     * ็ปๅฎๅทฅๅท็ฑป๏ผ็จไบๆง่กๆฐๆฎ็ปๅฎ็จ็ๆนๆณ้ใๆจๅฏไปฅไฝฟ็จๆญค็ฑปไธญๅฎไน็ๆนๆณๆฅ้็ฝฎๆฐๆฎ็ปๅฎใ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/binding/BindingExample.ts
     * @language zh_CN
     */
    var Binding = (function () {
        function Binding() {
        }
        /**
         * Binds a property, <prop>prop</code> on the <code>target</code> Object, to a bindable property or peoperty chain.
         * @param host The object that hosts the property or property chain to be watched.
         * The <code>host</code> maintains a list of <code>targets</code> to update theirs <code>prop</code> when <code>chain</code> changes.
         * @param chain A value specifying the property or chain to be watched. For example, when watch the property <code>host.a.b.c</code>,
         * you need call the method like this: <code>indProperty(host, ["a","b","c"], ...)</code>
         * @param target The Object defining the property to be bound to <code>chain</code>.
         * @param prop The name of the public property defined in the <code>site</code> Object to be bound.
         * @returns A ChangeWatcher instance, if at least one property name has been specified
         * to the <code>chain</code> argument; null otherwise.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅฎไธไธชๅฏน่ฑก็ๅฑๆงๅผๅฐ่ฆ็่ง็ๅฏน่ฑกๅฑๆงไธใ
         * @param host ็จไบๆฟ่ฝฝ่ฆ็่ง็ๅฑๆงๆๅฑๆง้พ็ๅฏน่ฑกใ
         * ๅฝ <code>host</code>ไธ<code>chain</code>ๆๅฏนๅบ็ๅผๅ็ๆนๅๆถ๏ผ<code>target</code>ไธ็<code>prop</code>ๅฑๆงๅฐ่ขซ่ชๅจๆดๆฐใ
         * @param chain ็จไบๆๅฎ่ฆ็่ง็ๅฑๆง้พ็ๅผใไพๅฆ๏ผ่ฆ็่งๅฑๆง <code>host.a.b.c</code>๏ผ้ๆไปฅไธๅฝขๅผ่ฐ็จๆญคๆนๆณ๏ผ<code>bindProperty(host, ["a","b","c"], ...)ใ</code>
         * @param target ๆฌๆฌก็ปๅฎ่ฆๆดๆฐ็็ฎๆๅฏน่ฑกใ
         * @param prop ๆฌๆฌก็ปๅฎ่ฆๆดๆฐ็็ฎๆๅฑๆงๅ็งฐใ
         * @returns ๅฆๆๅทฒไธบ chain ๅๆฐ่ณๅฐๆๅฎไบไธไธชๅฑๆงๅ็งฐ๏ผๅ่ฟๅ Watcher ๅฎไพ๏ผๅฆๅ่ฟๅ nullใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Binding.bindProperty = function (host, chain, target, prop) {
            var watcher = eui.Watcher.watch(host, chain, null, null);
            if (watcher) {
                var assign = function (value) {
                    target[prop] = value;
                };
                watcher.setHandler(assign, null);
                assign(watcher.getValue());
            }
            return watcher;
        };
        /**
         * Binds a callback, <prop>handler</code> on the <code>target</code> Object, to a bindable property or peoperty chain.
         * Callback method to invoke with an argument of the current value of <code>chain</code> when that value changes.
         * @param host The object that hosts the property or property chain to be watched.
         * @param chain A value specifying the property or chain to be watched. For example, when watch the property <code>host.a.b.c</code>,
         * you need call the method like this: <code>indProperty(host, ["a","b","c"], ...)</code>
         * @param handler method to invoke with an argument of the current value of <code>chain</code> when that value changes.
         * @param thisObject <code>this</code> object of binding method
         * @returns A ChangeWatcher instance, if at least one property name has been  specified to the <code>chain</code> argument; null otherwise.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปๅฎไธไธชๅ่ฐๅฝๆฐๅฐ่ฆ็่ง็ๅฏน่ฑกๅฑๆงไธใๅฝ hostไธ chain ๆๅฏนๅบ็ๅผๅ็ๆนๅๆถ๏ผhandler ๆนๆณๅฐ่ขซ่ชๅจ่ฐ็จใ
         * @param host ็จไบๆฟ่ฝฝ่ฆ็่ง็ๅฑๆงๆๅฑๆง้พ็ๅฏน่ฑกใ
         * @param chain ็จไบๆๅฎ่ฆ็่ง็ๅฑๆง้พ็ๅผใไพๅฆ๏ผ่ฆ็่งๅฑๆง host.a.b.c๏ผ้ๆไปฅไธๅฝขๅผ่ฐ็จๆญคๆนๆณ๏ผbindSetter(host, ["a","b","c"], ...)ใ
         * @param handler ๅจ็่ง็็ฎๆๅฑๆง้พไธญไปปไฝๅฑๆง็ๅผๅ็ๆนๅๆถ่ฐ็จ็ไบไปถๅค็ๅฝๆฐใ
         * @param thisObject handler ๆนๆณ็ปๅฎ็thisๅฏน่ฑก
         * @returns ๅฆๆๅทฒไธบ chain ๅๆฐ่ณๅฐๆๅฎไบไธไธชๅฑๆงๅ็งฐ๏ผๅ่ฟๅ Watcher ๅฎไพ๏ผๅฆๅ่ฟๅ nullใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Binding.bindHandler = function (host, chain, handler, thisObject) {
            var watcher = eui.Watcher.watch(host, chain, handler, thisObject);
            if (watcher) {
                handler.call(thisObject, watcher.getValue());
            }
            return watcher;
        };
        Binding.$bindProperties = function (host, templates, chainIndex, target, prop) {
            if (templates.length == 1 && chainIndex.length == 1) {
                return Binding.bindProperty(host, templates[0].split("."), target, prop);
            }
            var assign = function () {
                target[prop] = joinValues(templates);
            };
            var length = chainIndex.length;
            var watcher;
            for (var i = 0; i < length; i++) {
                var index = chainIndex[i];
                var chain = templates[index].split(".");
                watcher = eui.Watcher.watch(host, chain, null, null);
                if (watcher) {
                    templates[index] = watcher;
                    watcher.setHandler(assign, null);
                }
            }
            assign();
            return watcher;
        };
        return Binding;
    }());
    eui.Binding = Binding;
    __reflect(Binding.prototype, "eui.Binding");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../utils/registerProperty.ts" />
/// <reference path="../utils/registerBindable.ts" />
var eui;
(function (eui) {
    /**
     * The ArrayCollection class is a wrapper class that exposes an <code>any[]</code> as a collection that can be
     * accessed and manipulated using the methods and properties of the <code>ICollection</code> interfaces.
     * ArrayCollection can notify the view to update item when data source changed.
     *
     * @event eui.CollectionEvent.COLLECTION_CHANGE Dispatched when the ArrayCollection has been updated in some way.
     *
     * @defaultProperty source
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/collections/ArrayCollectionExample.ts
     * @language en_US
     */
    /**
     * ArrayCollection ็ฑปๆฏๆฐ็ป็้ๅ็ฑปๆฐๆฎ็ปๆๅ่ฃๅจ๏ผๅฏไฝฟ็จ<code>ICollection</code>ๆฅๅฃ็ๆนๆณๅๅฑๆงๅฏนๅถ่ฟ่ก่ฎฟ้ฎๅๅค็ใ
     * ไฝฟ็จ่ฟ็งๆฐๆฎ็ปๆๅ่ฃๆฎ้ๆฐ็ป๏ผ่ฝๅจๆฐๆฎๆบๅ็ๆนๅ็ๆถๅไธปๅจ้็ฅ่งๅพๅทๆฐๅๆดๆฐๆฎ้กนใ
     *
     * @event eui.CollectionEvent.COLLECTION_CHANGE ๅฝ ArrayCollection ๆดๆฐ็็ๆถๅไผๆดพๅๆญคไบไปถใ
     *
     * @defaultProperty source
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample extension/eui/collections/ArrayCollectionExample.ts
     * @language zh_CN
     */
    var ArrayCollection = (function (_super) {
        __extends(ArrayCollection, _super);
        /**
         * Constructor. <p/>
         * Creates a new ArrayCollection using the specified source array.
         * If no array is specified an empty array will be used.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ<p/>
         * ็จๆๅฎ็ๅๅงๆฐ็ปๅๅปบไธไธช ArrayCollection ๅฎไพใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function ArrayCollection(source) {
            var _this = _super.call(this) || this;
            if (source) {
                _this._source = source;
            }
            else {
                _this._source = [];
            }
            return _this;
        }
        Object.defineProperty(ArrayCollection.prototype, "source", {
            /**
             * The source of data in the ArrayCollection.
             * The ArrayCollection object does not represent any changes that you make
             * directly to the source array. Always use the ICollection methods to view the collection.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆฐๆฎๆบ
             * ้ๅธธๆๅตไธ่ฏทไธ่ฆ็ดๆฅ่ฐ็จArray็ๆนๆณๆไฝๆฐๆฎๆบ๏ผๅฆๅๅฏนๅบ็่งๅพๆๆณๆถๅฐๆฐๆฎๆนๅ็้็ฅใ้ๅธธ้ฝๆฏ้่ฟICollection็ๆฅๅฃๆนๆณๆฅๆฅ็ๆฐๆฎใ
             * ่ฅๅฏนๆฐๆฎๆบ่ฟ่กไบไฟฎๆน๏ผ่ฏทๆๅจ่ฐ็จrefresh()ๆนๆณๅทๆฐๆฐๆฎใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._source;
            },
            set: function (value) {
                if (!value)
                    value = [];
                this._source = value;
                this.dispatchCoEvent(eui.CollectionEventKind.RESET);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Applies the sort and filter to the view.
         * The ArrayCollection does not detect source data changes automatically,
         * so you must call the <code>refresh()</code>
         * method to update the view after changing the source data.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๅฏนๆฐๆฎๆบ่ฟ่กๆๅบๆ่ฟๆปคๆไฝๅๅฏไปฅๆๅจ่ฐ็จๆญคๆนๆณๅทๆฐๆๆๆฐๆฎ,ไปฅๆดๆฐ่งๅพใ
         * ArrayCollection ไธไผ่ชๅจๆฃๅๅงๆฐๆฎ่ฟ่กไบๆนๅ,ๆไปฅไฝๅฟ้กป่ฐ็จ<code>refresh()</code>ๆนๆณๅปๆดๆฐๆพ็คบใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.refresh = function () {
            this.dispatchCoEvent(eui.CollectionEventKind.REFRESH);
        };
        Object.defineProperty(ArrayCollection.prototype, "length", {
            //--------------------------------------------------------------------------
            //
            // ICollectionๆฅๅฃๅฎ็ฐๆนๆณ
            //
            //--------------------------------------------------------------------------
            /**
             * @inheritDoc
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this._source.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * Adds the specified item to the end of the list.
         * Equivalent to <code>addItemAt(item, length)</code>.
         * @param item The item to add.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅ่กจๆซๅฐพๆทปๅๆๅฎ้กน็ฎใ็ญๆไบ <code>addItemAt(item, length)</code>ใ
         * @param item ่ฆ่ขซๆทปๅ็้กนใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.addItem = function (item) {
            this._source.push(item);
            this.dispatchCoEvent(eui.CollectionEventKind.ADD, this._source.length - 1, -1, [item]);
        };
        /**
         * Adds the item at the specified index.
         * The index of any item greater than the index of the added item is increased by one.
         * If the the specified index is less than zero or greater than the length
         * of the list, a Error which code is 1007 is thrown.
         * @param item The item to place at the index.
         * @param index The index at which to place the item.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅจๆๅฎ็็ดขๅผๅคๆทปๅ้กน็ฎใ
         * ไปปไฝๅคงไบๅทฒๆทปๅ้กน็ฎ็็ดขๅผ็้กน็ฎ็ดขๅผ้ฝไผๅขๅ 1ใ
         * ๅฆๆๆๅฎ็็ดขๅผๆฏ0ๅฐๆ่ๆฏๆๅคง้ฟๅบฆ่ฆๅคงใๅไผๆๅบ1007ๅผๅธธใ
         * @param item ่ฆๆทปๅ็้กน
         * @param index ่ฆๆทปๅ็ๆๅฎ็ดขๅผไฝ็ฝฎ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.addItemAt = function (item, index) {
            if (index < 0 || index > this._source.length) {
                true && egret.$error(1007);
            }
            this._source.splice(index, 0, item);
            this.dispatchCoEvent(eui.CollectionEventKind.ADD, index, -1, [item]);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ArrayCollection.prototype.getItemAt = function (index) {
            return this._source[index];
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ArrayCollection.prototype.getItemIndex = function (item) {
            var length = this._source.length;
            for (var i = 0; i < length; i++) {
                if (this._source[i] === item) {
                    return i;
                }
            }
            return -1;
        };
        /**
         * Notifies the view that an item has been updated.
         * @param item The item within the view that was updated.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้็ฅ่งๅพ๏ผๆไธช้กน็ฎ็ๅฑๆงๅทฒๆดๆฐใ
         * @param item ่งๅพไธญ้่ฆ่ขซๆดๆฐ็้กนใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.itemUpdated = function (item) {
            var index = this.getItemIndex(item);
            if (index != -1) {
                this.dispatchCoEvent(eui.CollectionEventKind.UPDATE, index, -1, [item]);
            }
        };
        /**
         * Removes all items from the list.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้คๅ่กจไธญ็ๆๆ้กน็ฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.removeAll = function () {
            var items = this._source.concat();
            this._source = [];
            this.dispatchCoEvent(eui.CollectionEventKind.REMOVE, 0, -1, items);
        };
        /**
         * Removes the item at the specified index and returns it.
         * Any items that were after this index are now one index earlier.
         * @param index The index from which to remove the item.
         * @return The item that was removed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้คๆๅฎ็ดขๅผๅค็้กน็ฎๅนถ่ฟๅ่ฏฅ้กน็ฎใๅๅไฝไบๆญค็ดขๅผไนๅ็ๆๆ้กน็ฎ็็ดขๅผ็ฐๅจ้ฝๅๅ็งปๅจไธไธชไฝ็ฝฎใ
         * @param index ่ฆ่ขซ็งป้ค็้กน็็ดขๅผใ
         * @return ่ขซ็งป้ค็้กนใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.removeItemAt = function (index) {
            if (index < 0 || index >= this._source.length) {
                true && egret.$error(1007);
                return;
            }
            var item = this._source.splice(index, 1)[0];
            this.dispatchCoEvent(eui.CollectionEventKind.REMOVE, index, -1, [item]);
            return item;
        };
        /**
         * Replaces the item at the specified index.
         * @param item The new item to be placed at the specified index.
         * @param index The index at which to place the item.
         * @return The item that was replaced, or <code>null</code> if none.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฟๆขๅจๆๅฎ็ดขๅผๅค็้กน็ฎ๏ผๅนถ่ฟๅ่ฏฅ้กน็ฎใ
         * @param item ่ฆๅจๆๅฎ็ดขๅผๆพ็ฝฎ็ๆฐ็้กนใ
         * @param index ่ฆ่ขซๆฟๆข็้กน็็ดขๅผไฝ็ฝฎใ
         * @return ่ขซๆฟๆข็้กน็ฎ๏ผๅฆๆๆฒกๆ่ฏฅ้กนๅ่ฟๅ<code>null</code> ใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.replaceItemAt = function (item, index) {
            if (index < 0 || index >= this._source.length) {
                true && egret.$error(1007);
                return;
            }
            var oldItem = this._source.splice(index, 1, item)[0];
            this.dispatchCoEvent(eui.CollectionEventKind.REPLACE, index, -1, [item], [oldItem]);
            return oldItem;
        };
        /**
         * Replaces all items with a new source data, this method can not reset the scroller position of view.
         * @param newSource new source data.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็จๆฐๆฐๆฎๆบๆฟๆขๅๅงๆฐๆฎๆบ๏ผๆญคๆนๆณไธ็ดๆฅ่ฎพ็ฝฎsourceไธๅ๏ผๅฎไธไผๅฏผ่ด็ฎๆ่งๅพ้็ฝฎๆปๅจไฝ็ฝฎใ
         * @param newSource ๆฐๆฐๆฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ArrayCollection.prototype.replaceAll = function (newSource) {
            if (!newSource)
                newSource = [];
            var newLength = newSource.length;
            var oldLength = this._source.length;
            for (var i = newLength; i < oldLength; i++) {
                this.removeItemAt(newLength);
            }
            for (var i = 0; i < newLength; i++) {
                if (i >= oldLength)
                    this.addItemAt(newSource[i], i);
                else
                    this.replaceItemAt(newSource[i], i);
            }
            this._source = newSource;
        };
        /**
         * @private
         * ๆๅบไบไปถ
         */
        ArrayCollection.prototype.dispatchCoEvent = function (kind, location, oldLocation, items, oldItems) {
            eui.CollectionEvent.dispatchCollectionEvent(this, eui.CollectionEvent.COLLECTION_CHANGE, kind, location, oldLocation, items, oldItems);
        };
        return ArrayCollection;
    }(egret.EventDispatcher));
    eui.ArrayCollection = ArrayCollection;
    __reflect(ArrayCollection.prototype, "eui.ArrayCollection", ["eui.ICollection", "egret.IEventDispatcher"]);
    eui.registerProperty(ArrayCollection, "source", "Array", true);
})(eui || (eui = {}));
var eui;
(function (eui) {
    var UIImpl = eui.sys.UIComponentImpl;
    /**
     * Editable text for displaying,
     * scrolling, selecting, and editing text.
     * @includeExample  extension/eui/components/EditablTextExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅฏ็ผ่พๆๆฌ๏ผ็จไบๆพ็คบใๆปๅจใ้ๆฉๅ็ผ่พๆๆฌใ
     * @includeExample  extension/eui/components/EditablTextExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var EditableText = (function (_super) {
        __extends(EditableText, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function EditableText() {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this._widthConstraint = NaN;
            /**
             * @private
             */
            _this.$isShowPrompt = false;
            /**
             * @private
             */
            _this.$promptColor = 0x666666;
            /**
             * @private
             */
            _this.$isFocusIn = false;
            _this.initializeUIValues();
            _this.type = egret.TextFieldType.INPUT;
            _this.$EditableText = {
                0: null,
                1: 0xffffff,
                2: false //asPassword
            };
            return _this;
        }
        /**
         * @private
         *
         */
        EditableText.prototype.$invalidateContentBounds = function () {
            _super.prototype.$invalidateContentBounds.call(this);
            this.invalidateSize();
        };
        /**
         * @private
         *
         * @param value
         */
        EditableText.prototype.$setWidth = function (value) {
            var result1 = _super.prototype.$setWidth.call(this, value);
            var result2 = UIImpl.prototype.$setWidth.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        EditableText.prototype.$setHeight = function (value) {
            var result1 = _super.prototype.$setHeight.call(this, value);
            var result2 = UIImpl.prototype.$setHeight.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        EditableText.prototype.$getText = function () {
            var value = _super.prototype.$getText.call(this);
            if (value == this.$EditableText[0 /* promptText */]) {
                value = "";
            }
            return value;
        };
        /**
         * @private
         *
         * @param value
         */
        EditableText.prototype.$setText = function (value) {
            var promptText = this.$EditableText[0 /* promptText */];
            if (promptText != value || promptText == null) {
                this.$isShowPrompt = false;
                this.textColor = this.$EditableText[1 /* textColorUser */];
                this.displayAsPassword = this.$EditableText[2 /* asPassword */];
            }
            if (!this.$isFocusIn) {
                if (value == "" || value == null) {
                    value = promptText;
                    this.$isShowPrompt = true;
                    _super.prototype.$setTextColor.call(this, this.$promptColor);
                    _super.prototype.$setDisplayAsPassword.call(this, false);
                }
            }
            var result = _super.prototype.$setText.call(this, value);
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "text");
            return result;
        };
        /**
         * @private
         *
         * @param stage
         * @param nestLevel
         */
        EditableText.prototype.$onAddToStage = function (stage, nestLevel) {
            eui.sys.UIComponentImpl.prototype["$onAddToStage"].call(this, stage, nestLevel);
            this.addEventListener(egret.FocusEvent.FOCUS_IN, this.onfocusIn, this);
            this.addEventListener(egret.FocusEvent.FOCUS_OUT, this.onfocusOut, this);
        };
        /**
         * @private
         *
         */
        EditableText.prototype.$onRemoveFromStage = function () {
            eui.sys.UIComponentImpl.prototype["$onRemoveFromStage"].call(this);
            this.removeEventListener(egret.FocusEvent.FOCUS_IN, this.onfocusIn, this);
            this.removeEventListener(egret.FocusEvent.FOCUS_OUT, this.onfocusOut, this);
        };
        Object.defineProperty(EditableText.prototype, "prompt", {
            /**
             * When the property of the text is empty, it will show the defalut string.
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅฝtextๅฑๆงไธบ็ฉบๅญ็ฌฆไธฒๆถ่ฆๆพ็คบ็ๆๆฌๅๅฎนใ
             * ๅๅๅปบๆๆฌๆงไปถๆถๅฐๆพ็คบๆ็คบๆๆฌใๆงไปถ่ทๅพ็ฆ็นๆถๆๆงไปถ็ text ๅฑๆงไธบ้็ฉบๅญ็ฌฆไธฒๆถ๏ผๆ็คบๆๆฌๅฐๆถๅคฑใ
             * ๆงไปถๅคฑๅป็ฆ็นๆถๆ็คบๆๆฌๅฐ้ๆฐๆพ็คบ๏ผไฝไปๅฝๆช่พๅฅๆๆฌๆถ๏ผๅฆๆๆๆฌๅญๆฎต็ๅผไธบ็ฉบๅญ็ฌฆไธฒ๏ผใ<p/>
             * ๅฏนไบๆๆฌๆงไปถ๏ผๅฆๆ็จๆท่พๅฅๆๆฌ๏ผไฝ้ๅๅๅฐๅถๅ้ค๏ผๅๆงไปถๅคฑๅป็ฆ็นๅ๏ผๆ็คบๆๆฌๅฐ้ๆฐๆพ็คบใ
             * ๆจ่ฟๅฏไปฅ้่ฟ็ผ็จๆนๅผๅฐๆๆฌๆงไปถ็ text ๅฑๆง่ฎพ็ฝฎไธบ็ฉบๅญ็ฌฆไธฒไฝฟๆ็คบๆๆฌ้ๆฐๆพ็คบใ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this.$EditableText[0 /* promptText */];
            },
            set: function (value) {
                var values = this.$EditableText;
                var promptText = values[0 /* promptText */];
                if (promptText == value)
                    return;
                values[0 /* promptText */] = value;
                var text = this.text;
                if (!text || text == promptText) {
                    this.showPromptText();
                }
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EditableText.prototype, "promptColor", {
            get: function () {
                return this.$promptColor;
            },
            /**
             * The color of the defalut string.
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ้ป่ฎคๆๆฌ็้ข่ฒ
             * @version Egret 2.5.5
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            set: function (value) {
                value = +value | 0;
                if (this.$promptColor != value) {
                    this.$promptColor = value;
                    var text = this.text;
                    if (!text || text == this.$EditableText[0 /* promptText */]) {
                        this.showPromptText();
                    }
                }
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         */
        EditableText.prototype.onfocusOut = function () {
            this.$isFocusIn = false;
            if (!this.text) {
                this.showPromptText();
            }
        };
        /**
         * @private
         */
        EditableText.prototype.onfocusIn = function () {
            this.$isFocusIn = true;
            this.$isShowPrompt = false;
            this.displayAsPassword = this.$EditableText[2 /* asPassword */];
            var values = this.$EditableText;
            var text = this.text;
            if (!text || text == values[0 /* promptText */]) {
                this.textColor = values[1 /* textColorUser */];
                this.text = "";
            }
        };
        /**
         * @private
         */
        EditableText.prototype.showPromptText = function () {
            var values = this.$EditableText;
            this.$isShowPrompt = true;
            _super.prototype.$setTextColor.call(this, this.$promptColor);
            _super.prototype.$setDisplayAsPassword.call(this, false);
            this.text = values[0 /* promptText */];
        };
        /**
         * @private
         */
        EditableText.prototype.$setTextColor = function (value) {
            value = +value | 0;
            this.$EditableText[1 /* textColorUser */] = value;
            if (!this.$isShowPrompt) {
                _super.prototype.$setTextColor.call(this, value);
            }
            return true;
        };
        /**
         * @private
         */
        EditableText.prototype.$setDisplayAsPassword = function (value) {
            this.$EditableText[2 /* asPassword */] = value;
            if (!this.$isShowPrompt) {
                _super.prototype.$setDisplayAsPassword.call(this, value);
            }
            return true;
        };
        /**
         * @copy eui.Component#createChildren()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.createChildren = function () {
            this.onfocusOut();
        };
        /**
         * @copy eui.Component#childrenCreated()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.childrenCreated = function () {
        };
        /**
         * @copy eui.Component#commitProperties()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.commitProperties = function () {
        };
        /**
         * @copy eui.Component#measure()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.measure = function () {
            var values = this.$UIComponent;
            var textValues = this.$TextField;
            var oldWidth = textValues[3 /* textFieldWidth */];
            var availableWidth = NaN;
            if (!isNaN(this._widthConstraint)) {
                availableWidth = this._widthConstraint;
                this._widthConstraint = NaN;
            }
            else if (!isNaN(values[8 /* explicitWidth */])) {
                availableWidth = values[8 /* explicitWidth */];
            }
            else if (values[13 /* maxWidth */] != 100000) {
                availableWidth = values[13 /* maxWidth */];
            }
            _super.prototype.$setWidth.call(this, availableWidth);
            this.setMeasuredSize(this.textWidth, this.textHeight);
            _super.prototype.$setWidth.call(this, oldWidth);
        };
        /**
         * @copy eui.Component#updateDisplayList()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.$setWidth.call(this, unscaledWidth);
            _super.prototype.$setHeight.call(this, unscaledHeight);
        };
        /**
         * @copy eui.Component#invalidateParentLayout()
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
            UIImpl.prototype.setLayoutBoundsSize.call(this, layoutWidth, layoutHeight);
            if (isNaN(layoutWidth) || layoutWidth === this._widthConstraint || layoutWidth == 0) {
                return;
            }
            var values = this.$UIComponent;
            if (!isNaN(values[9 /* explicitHeight */])) {
                return;
            }
            if (layoutWidth == values[16 /* measuredWidth */]) {
                return;
            }
            this._widthConstraint = layoutWidth;
            this.invalidateSize();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        EditableText.prototype.getPreferredBounds = function (bounds) {
        };
        return EditableText;
    }(egret.TextField));
    eui.EditableText = EditableText;
    __reflect(EditableText.prototype, "eui.EditableText", ["eui.UIComponent", "egret.DisplayObject", "eui.IDisplayText"]);
    eui.sys.implementUIComponent(EditableText, egret.TextField);
    eui.registerBindable(EditableText.prototype, "text");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         * ้่ฆ่ฎฐๅฝ็ๅๅฒ้ๅบฆ็ๆๅคงๆฌกๆฐใ
         */
        var MAX_VELOCITY_COUNT = 4;
        /**
         * @private
         * ่ฎฐๅฝ็ๅๅฒ้ๅบฆ็ๆ้ๅ่กจใ
         */
        var VELOCITY_WEIGHTS = [1, 1.33, 1.66, 2];
        /**
         * @private
         * ๅฝๅ้ๅบฆๆๅ็ๆ้ใ
         */
        var CURRENT_VELOCITY_WEIGHT = 2.33;
        /**
         * @private
         * ๆๅฐ็ๆนๅ้ๅบฆ๏ผ่งฃๅณๆตฎ็นๆฐ็ฒพๅบฆ้ฎ้ขใ
         */
        var MINIMUM_VELOCITY = 0.02;
        /**
         * @private
         * ๅฝๅฎนๅจ่ชๅจๆปๅจๆถ่ฆๅบ็จ็ๆฉๆฆ็ณปๆฐ
         */
        var FRICTION = 0.998;
        /**
         * @private
         * ๅฝๅฎนๅจ่ชๅจๆปๅจๆถๅนถไธๆปๅจไฝ็ฝฎ่ถๅบๅฎนๅจ่ๅดๆถ่ฆ้ขๅคๅบ็จ็ๆฉๆฆ็ณปๆฐ
         */
        var EXTRA_FRICTION = 0.95;
        /**
         * @private
         * ๆฉๆฆ็ณปๆฐ็่ช็ถๅฏนๆฐ
         */
        var FRICTION_LOG = Math.log(FRICTION);
        /**
         * @private
         *
         * @param ratio
         * @returns
         */
        function easeOut(ratio) {
            var invRatio = ratio - 1.0;
            return invRatio * invRatio * invRatio + 1;
        }
        /**
         * @private
         * ไธไธชๅทฅๅท็ฑป,็จไบๅฎนๅจ็ๆปๅฑๆๅจๆไฝ๏ผ่ฎก็ฎๅจไธๆฎตๆถ้ดๆ็ปญๆปๅจๅ้ๆพ๏ผๅบ่ฏฅ็ปง็ปญๆปๅจๅฐ็ๅผๅ็ผๅจๆถ้ดใ
         * ไฝฟ็จๆญคๅทฅๅท็ฑป๏ผๆจ้่ฆๅๅปบไธไธช ScrollThrown ๅฎไพ,ๅนถๅจๆปๅจๅ็ๆถ่ฐ็จstart()ๆนๆณ๏ผ็ถๅๅจ่งฆๆธ็งปๅจ่ฟ็จไธญ่ฐ็จupdate()ๆดๆฐๅฝๅ่ๅฐๅๆใ
         * ๅ้จๅฐไผๅฏๅจไธไธช่ฎกๆถๅจๅฎๆถๆนๆฎๅฝๅไฝ็ฝฎ่ฎก็ฎๅบ้ๅบฆๅผ๏ผๅนถ็ผๅญไธๆฅๆๅ4ไธชๅผใๅฝๅๆญขๆปๅจๆถ๏ผๅ่ฐ็จfinish()ๆนๆณ๏ผ
         * ๅฐ็ซๅณๅๆญข่ฎฐๅฝไฝ็งป๏ผๅนถๅฐ่ฎก็ฎๅบ็ๆ็ป็ปๆๅญๅจๅฐ Thrown.scrollTo ๅ Thrown.duration ๅฑๆงไธใ
         */
        var TouchScroll = (function () {
            /**
             * @private
             * ๅๅปบไธไธช TouchScroll ๅฎไพ
             * @param updateFunction ๆปๅจไฝ็ฝฎๆดๆฐๅ่ฐๅฝๆฐ
             */
            function TouchScroll(updateFunction, endFunction, target) {
                /**
                 * @private
                 * ๅฝๅๅฎนๅจๆปๅจๅค็ๅฏ่ฐ่็็ณปๅ
                 */
                this.$scrollFactor = 1.0;
                /**
                 * @private
                 */
                this.previousTime = 0;
                /**
                 * @private
                 */
                this.velocity = 0;
                /**
                 * @private
                 */
                this.previousVelocity = [];
                /**
                 * @private
                 */
                this.currentPosition = 0;
                /**
                 * @private
                 */
                this.previousPosition = 0;
                /**
                 * @private
                 */
                this.currentScrollPos = 0;
                /**
                 * @private
                 */
                this.maxScrollPos = 0;
                /**
                 * @private
                 * ่งฆๆธๆไธๆถ็ๅ็งป้
                 */
                this.offsetPoint = 0;
                this.$bounces = true;
                this.started = true;
                if (true && !updateFunction) {
                    egret.$error(1003, "updateFunction");
                }
                this.updateFunction = updateFunction;
                this.endFunction = endFunction;
                this.target = target;
                this.animation = new sys.Animation(this.onScrollingUpdate, this);
                this.animation.endFunction = this.finishScrolling;
                this.animation.easerFunction = easeOut;
            }
            /**
             * @private
             * ๆญฃๅจๆญๆพ็ผๅจๅจ็ป็ๆๅฟใ
             */
            TouchScroll.prototype.isPlaying = function () {
                return this.animation.isPlaying;
            };
            /**
             * @private
             * ๅฆๆๆญฃๅจๆง่ก็ผๅจๆปๅฑ๏ผๅๆญข็ผๅจใ
             */
            TouchScroll.prototype.stop = function () {
                this.animation.stop();
                egret.stopTick(this.onTick, this);
                this.started = false;
            };
            /**
             * @private
             * true่กจ็คบๅทฒ็ป่ฐ็จ่ฟstartๆนๆณใ
             */
            TouchScroll.prototype.isStarted = function () {
                return this.started;
            };
            /**
             * @private
             * ๅผๅง่ฎฐๅฝไฝ็งปๅๅใๆณจๆ๏ผๅฝไฝฟ็จๅฎๆฏๅ๏ผๅฟ้กป่ฐ็จ finish() ๆนๆณ็ปๆ่ฎฐๅฝ๏ผๅฆๅ่ฏฅๅฏน่ฑกๅฐๆๆณ่ขซๅๆถใ
             * @param touchPoint ่ตทๅง่งฆๆธไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผ้ๅธธๆฏstageXๆstageYใ
             */
            TouchScroll.prototype.start = function (touchPoint) {
                this.started = true;
                this.velocity = 0;
                this.previousVelocity.length = 0;
                this.previousTime = egret.getTimer();
                this.previousPosition = this.currentPosition = touchPoint;
                this.offsetPoint = touchPoint;
                egret.startTick(this.onTick, this);
            };
            /**
             * @private
             * ๆดๆฐๅฝๅ็งปๅจๅฐ็ไฝ็ฝฎ
             * @param touchPoint ๅฝๅ่งฆๆธไฝ็ฝฎ๏ผไปฅๅ็ดไธบๅไฝ๏ผ้ๅธธๆฏstageXๆstageYใ
             */
            TouchScroll.prototype.update = function (touchPoint, maxScrollValue, scrollValue) {
                maxScrollValue = Math.max(maxScrollValue, 0);
                this.currentPosition = touchPoint;
                this.maxScrollPos = maxScrollValue;
                var disMove = this.offsetPoint - touchPoint;
                var scrollPos = disMove + scrollValue;
                this.offsetPoint = touchPoint;
                if (scrollPos < 0) {
                    if (!this.$bounces) {
                        scrollPos = 0;
                    }
                    else {
                        scrollPos -= disMove * 0.5;
                    }
                }
                if (scrollPos > maxScrollValue) {
                    if (!this.$bounces) {
                        scrollPos = maxScrollValue;
                    }
                    else {
                        scrollPos -= disMove * 0.5;
                    }
                }
                this.currentScrollPos = scrollPos;
                this.updateFunction.call(this.target, scrollPos);
            };
            /**
             * @private
             * ๅๆญข่ฎฐๅฝไฝ็งปๅๅ๏ผๅนถ่ฎก็ฎๅบ็ฎๆๅผๅ็ปง็ปญ็ผๅจ็ๆถ้ดใ
             * @param currentScrollPos ๅฎนๅจๅฝๅ็ๆปๅจๅผใ
             * @param maxScrollPos ๅฎนๅจๅฏไปฅๆปๅจ็ๆๅคงๅผใๅฝ็ฎๆๅผไธๅจ 0~maxValueไน้ดๆถ๏ผๅฐไผๅบ็จๆดๅคง็ๆฉๆฆๅ๏ผไป่ๅฝฑๅ็ผๅจๆถ้ด็้ฟๅบฆใ
             */
            TouchScroll.prototype.finish = function (currentScrollPos, maxScrollPos) {
                egret.stopTick(this.onTick, this);
                this.started = false;
                var sum = this.velocity * CURRENT_VELOCITY_WEIGHT;
                var previousVelocityX = this.previousVelocity;
                var length = previousVelocityX.length;
                var totalWeight = CURRENT_VELOCITY_WEIGHT;
                for (var i = 0; i < length; i++) {
                    var weight = VELOCITY_WEIGHTS[i];
                    sum += previousVelocityX[0] * weight;
                    totalWeight += weight;
                }
                var pixelsPerMS = sum / totalWeight;
                var absPixelsPerMS = Math.abs(pixelsPerMS);
                var duration = 0;
                var posTo = 0;
                if (absPixelsPerMS > MINIMUM_VELOCITY) {
                    posTo = currentScrollPos + (pixelsPerMS - MINIMUM_VELOCITY) / FRICTION_LOG * 2 * this.$scrollFactor;
                    if (posTo < 0 || posTo > maxScrollPos) {
                        posTo = currentScrollPos;
                        while (Math.abs(pixelsPerMS) > MINIMUM_VELOCITY) {
                            posTo -= pixelsPerMS;
                            if (posTo < 0 || posTo > maxScrollPos) {
                                pixelsPerMS *= FRICTION * EXTRA_FRICTION;
                            }
                            else {
                                pixelsPerMS *= FRICTION;
                            }
                            duration++;
                        }
                    }
                    else {
                        duration = Math.log(MINIMUM_VELOCITY / absPixelsPerMS) / FRICTION_LOG;
                    }
                }
                else {
                    posTo = currentScrollPos;
                }
                if (this.target["$getThrowInfo"]) {
                    var event_1 = this.target["$getThrowInfo"](currentScrollPos, posTo);
                    posTo = event_1.toPos;
                }
                if (duration > 0) {
                    //ๅฆๆๅๆถไบๅๅผน,ไฟ่ฏๅจ็ปไนๅไธไผ่ถๅบ่พน็
                    if (!this.$bounces) {
                        if (posTo < 0) {
                            posTo = 0;
                        }
                        else if (posTo > maxScrollPos) {
                            posTo = maxScrollPos;
                        }
                    }
                    this.throwTo(posTo, duration);
                }
                else {
                    this.finishScrolling();
                }
            };
            /**
             * @private
             *
             * @param timeStamp
             * @returns
             */
            TouchScroll.prototype.onTick = function (timeStamp) {
                var timeOffset = timeStamp - this.previousTime;
                if (timeOffset > 10) {
                    var previousVelocity = this.previousVelocity;
                    if (previousVelocity.length >= MAX_VELOCITY_COUNT) {
                        previousVelocity.shift();
                    }
                    this.velocity = (this.currentPosition - this.previousPosition) / timeOffset;
                    previousVelocity.push(this.velocity);
                    this.previousTime = timeStamp;
                    this.previousPosition = this.currentPosition;
                }
                return true;
            };
            /**
             * @private
             *
             * @param animation
             */
            TouchScroll.prototype.finishScrolling = function (animation) {
                var hsp = this.currentScrollPos;
                var maxHsp = this.maxScrollPos;
                var hspTo = hsp;
                if (hsp < 0) {
                    hspTo = 0;
                }
                if (hsp > maxHsp) {
                    hspTo = maxHsp;
                }
                this.throwTo(hspTo, 300);
            };
            /**
             * @private
             * ็ผๅจๅฐๆฐดๅนณๆปๅจไฝ็ฝฎ
             */
            TouchScroll.prototype.throwTo = function (hspTo, duration) {
                if (duration === void 0) {
                    duration = 500;
                }
                var hsp = this.currentScrollPos;
                if (hsp == hspTo) {
                    this.endFunction.call(this.target);
                    return;
                }
                var animation = this.animation;
                animation.duration = duration;
                animation.from = hsp;
                animation.to = hspTo;
                animation.play();
            };
            /**
             * @private
             * ๆดๆฐๆฐดๅนณๆปๅจไฝ็ฝฎ
             */
            TouchScroll.prototype.onScrollingUpdate = function (animation) {
                this.currentScrollPos = animation.currentValue;
                this.updateFunction.call(this.target, animation.currentValue);
            };
            return TouchScroll;
        }());
        sys.TouchScroll = TouchScroll;
        __reflect(TouchScroll.prototype, "eui.sys.TouchScroll");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Defines values for setting the <code>direction</code> property
     * of the <code>ProgressBar</code> class.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/DirectionExample.ts
     * @language en_US
     */
    /**
     * ๅฎไน่ฟๅบฆๆก็ญๆงไปถๅข้ฟๆนๅ็ๅธธ้
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/DirectionExample.ts
     * @language zh_CN
     */
    var Direction = (function () {
        function Direction() {
        }
        /**
         * Specifies left-to-right direction.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐดๅนณไปๅทฆๅฐๅณๅข้ฟ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Direction.LTR = "ltr";
        /**
         * Specifies right-to-left direction.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฐดๅนณไปๅณๅฐๅทฆๅข้ฟ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Direction.RTL = "rtl";
        /**
         * Specifies top-to-bottom direction.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ซ็ดไปไธๅฐไธๅข้ฟ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Direction.TTB = "ttb";
        /**
         * Specifies bottom-to-top direction.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ซ็ดไปไธๅฐไธๅข้ฟ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Direction.BTT = "btt";
        return Direction;
    }());
    eui.Direction = Direction;
    __reflect(Direction.prototype, "eui.Direction");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Values for the <code>horizontalCanScroll</code> and
     * <code>verticalCanScroll</code> properties of the Scroller classes.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/ScrollPolicyExample.ts
     * @language en_US
     */
    /**
     * ๆปๅจๆกๆพ็คบ็ญ็ฅๅธธ้ใ
     * Scroller ็ฑป็ <code>horizontalCanScroll</code> ๅ <code>verticalCanScroll</code> ๅฑๆง็ๅผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/ScrollPolicyExample.ts
     * @language zh_CN
     */
    var ScrollPolicy = (function () {
        function ScrollPolicy() {
        }
        /**
         * Show the scrollbar if the children exceed the owner's dimension.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฆๆๅญ้กน่ถๅบ็ถ็บง็ๅฐบๅฏธ๏ผๅๅ่ฎธๆปๅจ๏ผๅไนไธๅ่ฎธๆปๅจใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ScrollPolicy.AUTO = "auto";
        /**
         * Never show the scrollbar.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไปไธๅ่ฎธๆปๅจใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ScrollPolicy.OFF = "off";
        /**
         * Always show the scrollbar.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆปๆฏๅ่ฎธๆปๅจใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ScrollPolicy.ON = "on";
        return ScrollPolicy;
    }());
    eui.ScrollPolicy = ScrollPolicy;
    __reflect(ScrollPolicy.prototype, "eui.ScrollPolicy");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Note: The skin name values in the skin theme are used as default values,which can not be changed while running.
     * You can change the skin of a component with the skinName property.
     * @event egret.Event.COMPLETE Dispatch when EXML used in this theme is loaded and parsed.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/ThemeExample.ts
     * @language en_US
     */
    /**
     * ็ฎ่คไธป้ขใๆณจๆ๏ผ็ฎ่คไธป้ขๆฏไธๆฌกๆง่ฎพ็ฝฎ็้ป่ฎคๅผ,ๅนถไธ่ฝ่ฟ่กๆถๅๆขๆๆ็ปไปถ้ป่ฎค็ฎ่คใๅๆขๅไธช็ฎ่คๆจๅฏไปฅ่ช่กๅฏนComponent.skinName่ตๅผๆฅไฟฎๆนใ
     * @event egret.Event.COMPLETE ๅฝไธป้ขๅณ่็EXMLๅ่ฝฝ่งฃๆๅฎๆๆถๆดพๅ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/core/ThemeExample.ts
     * @language zh_CN
     */
    var Theme = (function (_super) {
        __extends(Theme, _super);
        /**
         * Create an instance of Theme
         * @param configURL the external theme path. if null, you need to register the default skin name with
         * mapSkin() manually.
         * @param stage current stage.
         * If null, you need to register with egret.registerImplementation("eui.Theme",theme)
         * manually.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชไธป้ขๅฎไพ
         * @param configURL ่ฆๅ่ฝฝๅนถ่งฃๆ็ๅค้จไธป้ข้็ฝฎๆไปถ่ทฏๅพใ่ฅไผๅฅ null๏ผๅฐไธ่ฟ่ก้็ฝฎๆไปถๅ่ฝฝ๏ผ
         * ไนๅ้่ฆๅจๅค้จไปฅไปฃ็ๆนๅผๆๅจ่ฐ็จ mapSkin() ๆนๆณๅฎๆๆฏๆก้ป่ฎค็ฎ่คๅ็ๆณจๅใ
         * @param stage ๅฝๅ่ๅฐๅผ็จใ
         * ่ฅไผๅฅnull๏ผ้่ฆๅจๅค้จๆๅจ่ฐ็จ egret.registerImplementation("eui.Theme",theme) ๆฅๅฎๆไธป้ข็ๆณจๅใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function Theme(configURL, stage) {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this.delayList = [];
            /**
             * @private
             */
            _this.skinMap = {};
            /**
             * @private
             * styles ้็ฝฎไฟกๆฏ
             */
            _this.$styles = {};
            _this.initialized = !configURL;
            if (stage) {
                egret.registerImplementation("eui.Theme", _this);
            }
            _this.$configURL = configURL;
            _this.load(configURL);
            return _this;
        }
        /**
         * @private
         *
         * @param url
         */
        Theme.prototype.load = function (url) {
            var _this = this;
            eui.getTheme(url, function (data) { return _this.onConfigLoaded(data); });
        };
        /**
         * @private
         *
         * @param str
         */
        Theme.prototype.onConfigLoaded = function (str) {
            var data;
            if (typeof str == "string") {
                try {
                    data = JSON.parse(str);
                }
                catch (e) {
                    egret.$error(3000);
                }
            }
            else {
                data = str;
            }
            if (data && data.skins) {
                var skinMap = this.skinMap;
                var skins = data.skins;
                var keys = Object.keys(skins);
                var length_27 = keys.length;
                for (var i = 0; i < length_27; i++) {
                    var key = keys[i];
                    if (!skinMap[key]) {
                        this.mapSkin(key, skins[key]);
                    }
                }
            }
            if (data.styles) {
                this.$styles = data.styles;
            }
            if (!data.exmls || data.exmls.length == 0) {
                this.onLoaded();
            }
            else if (data.exmls[0]['gjs']) {
                data.exmls.forEach(function (exml) { return EXML.$parseURLContentAsJs(exml.path, exml.gjs, exml.className); });
                this.onLoaded();
            }
            else if (data.exmls[0]['content']) {
                data.exmls.forEach(function (exml) { return EXML.$parseURLContent(exml.path, exml.content); });
                this.onLoaded();
            }
            else {
                EXML.$loadAll(data.exmls, this.onLoaded, this, true);
            }
        };
        Theme.prototype.onLoaded = function (classes, urls) {
            this.initialized = true;
            this.handleDelayList();
            this.dispatchEventWith(egret.Event.COMPLETE);
        };
        /**
         * @private
         *
         */
        Theme.prototype.handleDelayList = function () {
            var list = this.delayList;
            var length = list.length;
            for (var i = 0; i < length; i++) {
                var client = list[i];
                if (!client.$Component[5 /* skinNameExplicitlySet */]) {
                    var skinName = this.getSkinName(client);
                    if (skinName) {
                        client.$Component[1 /* skinName */] = skinName;
                        client.$parseSkinName();
                    }
                }
            }
            list.length = 0;
        };
        /**
         * According to the host component to get the default skin name.
         * Search rules are as follows:
         * <li>1. Use the <code>hostComponentKey</code> of client to search.</li>
         * <li>2. Use the class name of client to search.</li>
         * <li>3. Use the parent class name of client to search.</li>
         * <li>4. Repeat step 3 until find the skin name or the parent is <code>eui.Component</code>.</li>
         * @param client the component need to get the default skin.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆนๆฎไธปๆบ็ปไปถ๏ผ่ทๅๅฏนๅบ็้ป่ฎค็ฎ่คๅใๆฅ่ฏข่งๅๅฆไธ๏ผ
         * <li>1.ไฝฟ็จclient็hostComponentKeyไฝไธบ้ฎๆฅ่ฏข้ป่ฎค็ฎ่คๅใ</li>
         * <li>2.ไฝฟ็จclient็็ฑปๅไฝไธบ้ฎๆฅ่ฏข้ป่ฎค็ฎ่คๅใ</li>
         * <li>3.ไฝฟ็จclient็็ถ็ฑปๅไฝไธบ้ฎๆฅ่ฏข้ป่ฎค็ฎ่คๅใ</li>
         * <li>4.ไธๆญ้ๅค3็ดๅฐๆฅ่ฏขๅฐ็ฎ่คๅๆ็ถ็ฑปไธบeui.Componentๆถๅๆญขใ</li>
         * @param client ่ฆ่ทๅ้ป่ฎค็ฎ่ค็็ปไปถใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Theme.prototype.getSkinName = function (client) {
            if (!this.initialized) {
                if (this.delayList.indexOf(client) == -1) {
                    this.delayList.push(client);
                }
                return "";
            }
            var skinMap = this.skinMap;
            var skinName = skinMap[client.hostComponentKey];
            if (!skinName) {
                skinName = this.findSkinName(client);
            }
            return skinName;
        };
        /**
         * @private
         */
        Theme.prototype.findSkinName = function (prototype) {
            if (!prototype) {
                return "";
            }
            var key = prototype["__class__"];
            if (key === void 0) {
                return "";
            }
            var skinName = this.skinMap[key];
            if (skinName || key == "eui.Component") {
                return skinName;
            }
            return this.findSkinName(Object.getPrototypeOf(prototype));
        };
        /**
         * Map a default skin for the specified host component.
         * @param hostComponentKey the name of host component, such as "eui.Button".
         * @param skinName the name of skin, such as "app.MyButtonSkin".
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธบๆๅฎ็ไธปๆบ็ปไปถๆๅฐไธไธช้ป่ฎค็ฎ่คใ
         * @param hostComponentKey ไธปๆบ็ปไปถๅ็งฐ๏ผไพๅฆ๏ผโeui.Buttonโใ
         * @param skinName ็ฎ่คๅ็งฐ ไพๅฆ๏ผ"app.MyButtonSkin"ใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        Theme.prototype.mapSkin = function (hostComponentKey, skinName) {
            if (true) {
                if (!hostComponentKey) {
                    egret.$error(1003, "hostComponentKey");
                }
                if (!skinName) {
                    egret.$error(1003, "skinName");
                }
            }
            this.skinMap[hostComponentKey] = skinName;
        };
        Theme.prototype.$getStyleConfig = function (style) {
            return this.$styles[style];
        };
        return Theme;
    }(egret.EventDispatcher));
    eui.Theme = Theme;
    __reflect(Theme.prototype, "eui.Theme");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The eui.CollectionEvent class represents an event that is
     * dispatched when the associated collection changes.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/CollectionEventExample.ts
     * @language en_US
     */
    /**
     * ้ๅ็ฑปๅๆฐๆฎๆนๅไบไปถ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/CollectionEventExample.ts
     * @language zh_CN
     */
    var CollectionEvent = (function (_super) {
        __extends(CollectionEvent, _super);
        /**
         * Constructor.
         *
         * @param type The event type; indicates the action that triggered the event.
         * @param bubbles Specifies whether the event can bubble
         * up the display list hierarchy.
         * @param cancelable Specifies whether the behavior
         * associated with the event can be prevented.
         * @param kind Indicates the kind of event that occured.
         * The parameter value can be one of the values in the CollectionEventKind
         * class, or <code>null</code>, which indicates that the kind is unknown.
         * @param location When the <code>kind</code> is
         * <code>CollectionEventKind.ADD</code>,
         * <code>CollectionEventKind.REMOVE</code>,
         * <code>CollectionEventKind.REPLACE</code>,or
         * <code>CollectionEventKind.UPDATE</code>
         * this value indicates at what location the item(s) specified
         * in the <code>items property</code> can be found
         * within the target collection.
         * @param oldLocation this value indicates
         * the old location within the target collection
         * of the item(s) specified in the <code>items</code> property.
         * @param items Array of objects with information about the items
         * affected by the event.
         * @param oldItems When the <code>kine</code> is <code>CollectionEventKind.REPLACE</code> the value represents
         * a list of items before replaced.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช CollectionEvent ๅฎไพ
         *
         * @param type ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param bubbles ๆๅฎ่ฏฅไบไปถๆฏๅฆๅฏไปฅๅจๆพ็คบๅ่กจๅฑๆฌก็ปๆๅพๅฐๅๆณกๅค็ใ
         * @param cancelable ๆๅฎๆฏๅฆๅฏไปฅ้ฒๆญขไธไบไปถ็ธๅณ่็่กไธบใ
         * @param kind ๆ็คบๅ็็ไบไปถ็ฑปๅใๆญคๅฑๆงๅผๅฏไปฅๆฏ CollectionEventKind ็ฑปไธญ็ไธไธชๅผ๏ผไนๅฏไปฅๆฏ null๏ผ็จไบๆ็คบ็ฑปๅๆช็ฅใ
         * @param location ๅฆๆ kind ๅผไธบ <code>CollectionEventKind.ADD</code>,
         * <code>CollectionEventKind.REMOVE</code>,
         * <code>CollectionEventKind.REPLACE</code>,ๆ
         * <code>CollectionEventKind.UPDATE</code>
         * ๅๆญคๅฑๆงไธบ items ๅฑๆงไธญๆๅฎ็้กน็ฎ้ๅไธญ้ถๅทๅ็ด็็็ดขๅผใ
         * @param oldLocation ๆญคๅผๆ็คบ <code>items</code> ๅฑๆงไธญๆๅฎ็้กน็ฎๅจ็ฎๆ้ๅไธญ็ๅไฝ็ฝฎใ
         * @param items ๅไบไปถๅฝฑๅ็้กน็ฎ็ๅ่กจใ
         * @param oldItems ไปๅฝkind็ๅผไธบCollectionEventKind.REPLACEๆถ๏ผ่กจ็คบๆฟๆขๅ็้กน็ฎๅ่กจใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function CollectionEvent(type, bubbles, cancelable, kind, location, oldLocation, items, oldItems) {
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            _this.$initTo(kind, location, oldLocation, items, oldItems);
            return _this;
        }
        /**
         * @private
         *
         * @param kind
         * @param location
         * @param oldLocation
         * @param items
         * @param oldItems
         */
        CollectionEvent.prototype.$initTo = function (kind, location, oldLocation, items, oldItems) {
            this.kind = kind;
            this.location = +location | 0;
            this.oldLocation = +oldLocation | 0;
            this.items = items || [];
            this.oldItems = oldItems || [];
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        CollectionEvent.prototype.clean = function () {
            _super.prototype.clean.call(this);
            this.items = this.oldItems = null;
        };
        /**
         * Dispatch an event with specified EventDispatcher. The dispatched event will be cached in the object pool,
         * for the next cycle of reuse.
         *
         * @param target the target of event dispatcher.
         * @param eventType The event type; indicates the action that triggered the event.
         * @param kind Indicates the kind of event that occured.
         * The parameter value can be one of the values in the CollectionEventKind
         * class, or <code>null</code>, which indicates that the kind is unknown.
         * @param location When the <code>kind</code> is
         * <code>CollectionEventKind.ADD</code>,
         * <code>CollectionEventKind.REMOVE</code>,
         * <code>CollectionEventKind.REPLACE</code>,or
         * <code>CollectionEventKind.UPDATE</code>
         * this value indicates at what location the item(s) specified
         * in the <code>items property</code> can be found
         * within the target collection.
         * @param oldLocation this value indicates
         * the old location within the target collection
         * of the item(s) specified in the <code>items</code> property.
         * @param items Array of objects with information about the items
         * affected by the event.
         * @param oldItems When the <code>kine</code> is <code>CollectionEventKind.REPLACE</code> the value represents
         * a list of items before replaced.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         *
         * @param target ไบไปถๆดพๅ็ฎๆใ
         * @param eventType ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param kind ๆ็คบๅ็็ไบไปถ็ฑปๅใๆญคๅฑๆงๅผๅฏไปฅๆฏ CollectionEventKind ็ฑปไธญ็ไธไธชๅผ๏ผไนๅฏไปฅๆฏ null๏ผ็จไบๆ็คบ็ฑปๅๆช็ฅใ
         * @param location ๅฆๆ kind ๅผไธบ <code>CollectionEventKind.ADD</code>,
         * <code>CollectionEventKind.REMOVE</code>,
         * <code>CollectionEventKind.REPLACE</code>,ๆ
         * <code>CollectionEventKind.UPDATE</code>
         * ๅๆญคๅฑๆงไธบ items ๅฑๆงไธญๆๅฎ็้กน็ฎ้ๅไธญ้ถๅทๅ็ด็็็ดขๅผใ
         * @param oldLocation ๆญคๅผๆ็คบ <code>items</code> ๅฑๆงไธญๆๅฎ็้กน็ฎๅจ็ฎๆ้ๅไธญ็ๅไฝ็ฝฎใ
         * @param items ๅไบไปถๅฝฑๅ็้กน็ฎ็ๅ่กจใ
         * @param oldItems ไปๅฝkind็ๅผไธบCollectionEventKind.REPLACEๆถ๏ผ่กจ็คบๆฟๆขๅ็้กน็ฎๅ่กจใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEvent.dispatchCollectionEvent = function (target, eventType, kind, location, oldLocation, items, oldItems) {
            if (!target.hasEventListener(eventType)) {
                return true;
            }
            var event = egret.Event.create(CollectionEvent, eventType);
            event.$initTo(kind, location, oldLocation, items, oldItems);
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Dispatched when a collection has changed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๅ็ฑปๆฐๆฎๅ็ๆนๅ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEvent.COLLECTION_CHANGE = "collectionChange";
        return CollectionEvent;
    }(egret.Event));
    eui.CollectionEvent = CollectionEvent;
    __reflect(CollectionEvent.prototype, "eui.CollectionEvent");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The CollectionEventKind class contains constants for the valid values
     * of the <code>CollectionEvent</code> class <code>kind</code> property.
     * These constants indicate the kind of change that was made to the collection.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅฎไน <code>CollectionEvent</code> ็ฑป <code>kind</code> ๅฑๆง็ๆๆๅผ็ๅธธ้ใ
     * ่ฟไบๅธธ้ๆ็คบๅฏน้ๅ่ฟ่ก็ๆดๆน็ฑปๅใ

     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var CollectionEventKind = (function () {
        function CollectionEventKind() {
        }
        /**
         * Indicates that the collection added an item or items.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบ้ๅๆทปๅไบไธไธชๆๅคไธช้กน็ฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.ADD = "add";
        /**
         * Indicates that the collection applied a sort, a filter, or both.
         * This change can potentially be easier to handle than a RESET.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบ้ๅๅบ็จไบๆๅบๆ/ๅ็ญ้ใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.REFRESH = "refresh";
        /**
         * Indicates that the collection removed an item or items.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบ้ๅๅ้คไบไธไธชๆๅคไธช้กน็ฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.REMOVE = "remove";
        /**
         * Indicates that the item at the position identified by the
         * CollectionEvent <code>location</code> property has been replaced.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบๅทฒๆฟๆข็ฑ CollectionEvent.location ๅฑๆง็กฎๅฎ็ไฝ็ฝฎๅค็้กน็ฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.REPLACE = "replace";
        /**
         * Indicates that the collection has changed so drastically that
         * a reset is required.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบ้ๅๅทฒๅฝปๅบๆดๆน๏ผ้่ฆ่ฟ่ก้็ฝฎใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.RESET = "reset";
        /**
         * Indicates that one or more items were updated within the collection.
         * The affected item(s)
         * are stored in the <code>CollectionEvent.items</code> property.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ็คบ้ๅไธญไธไธชๆๅคไธช้กน็ฎ่ฟ่กไบๆดๆฐใๅๅฝฑๅ็้กน็ฎๅฐๅญๅจๅจ  CollectionEvent.items ๅฑๆงไธญใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        CollectionEventKind.UPDATE = "update";
        return CollectionEventKind;
    }());
    eui.CollectionEventKind = CollectionEventKind;
    __reflect(CollectionEventKind.prototype, "eui.CollectionEventKind");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * Represents events that are dispatched when a item has been touched.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/ItemTapEventExample.ts
     * @language en_US
     */
    /**
     * ๅ่กจ้กน่งฆ็ขฐไบไปถ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/ItemTapEventExample.ts
     * @language zh_CN
     */
    var ItemTapEvent = (function (_super) {
        __extends(ItemTapEvent, _super);
        function ItemTapEvent() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            /**
             * The item in the data provider of the associated item.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งฆๅ่งฆๆธไบไปถ็้กนๅ็คบๅจๆฐๆฎๆบ้กนใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.item = null;
            /**
             * The item renderer in the list of the associated item.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งฆๅ่งฆๆธไบไปถ็้กนๅ็คบๅจใ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.itemRenderer = null;
            /**
             * The index of the associated navigation item.
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่งฆๅ่งฆๆธไบไปถ็้กน็ดขๅผ
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            _this.itemIndex = -1;
            return _this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        ItemTapEvent.prototype.clean = function () {
            _super.prototype.clean.call(this);
            this.item = this.itemRenderer = null;
        };
        /**
         * Dispatch an event with specified EventDispatcher. The dispatched event will be cached in the object pool,
         * for the next cycle of reuse.
         *
         * @param target the target of event dispatcher.
         * @param eventType The event type; indicates the action that triggered the event.
         * @param itemRenderer The item renderer in the list of the associated item.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็ EventDispatcher ๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         *
         * @param target ไบไปถๆดพๅ็ฎๆ
         * @param eventType ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param itemRenderer ่งฆๅ่งฆๆธไบไปถ็้กนๅ็คบๅจใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ItemTapEvent.dispatchItemTapEvent = function (target, eventType, itemRenderer) {
            if (!target.hasEventListener(eventType)) {
                return true;
            }
            var event = egret.Event.create(ItemTapEvent, eventType);
            event.item = itemRenderer.data;
            event.itemIndex = itemRenderer.itemIndex;
            event.itemRenderer = itemRenderer;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * The type of the event object for an <code>itemTap</code> event.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * <code>itemTap</code> ไบไปถ็ๅฏน่ฑก็ฑปๅใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ItemTapEvent.ITEM_TAP = "itemTap";
        return ItemTapEvent;
    }(egret.Event));
    eui.ItemTapEvent = ItemTapEvent;
    __reflect(ItemTapEvent.prototype, "eui.ItemTapEvent");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The PropertyChangeEvent class represents the event object
     * passed to the event listener when one of the properties of
     * an object has changed, and provides information about the change.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/PropertyEventExample.ts
     * @language en_US
     */
    /**
     * ๅฏน่ฑก็ไธไธชๅฑๆงๅ็ๆดๆนๆถไผ้ๅฐไบไปถไพฆๅฌๅจ็ไบไปถใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/PropertyEventExample.ts
     * @language zh_CN
     */
    var PropertyEvent = (function (_super) {
        __extends(PropertyEvent, _super);
        /**
         * Constructor.
         *
         * @param type The event type; indicates the action that triggered the event.
         * @param bubbles Specifies whether the event can bubble
         * up the display list hierarchy.
         * @param cancelable Specifies whether the behavior
         * associated with the event can be prevented.
         * @param property Name of the property that changed.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชๅฑๆงๆนๅไบไปถใ
         *
         * @param type ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param bubbles ๆๅฎ่ฏฅไบไปถๆฏๅฆๅฏไปฅๅจๆพ็คบๅ่กจๅฑๆฌก็ปๆๅพๅฐๅๆณกๅค็ใ
         * @param cancelable ๆๅฎๆฏๅฆๅฏไปฅ้ฒๆญขไธไบไปถ็ธๅณ่็่กไธบใ
         * @param property ๅ็ๆนๅ็ๅฑๆงๅ็งฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function PropertyEvent(type, bubbles, cancelable, property) {
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            _this.property = property;
            return _this;
        }
        /**
         * Dispatch an event with specified EventDispatcher. The dispatched event will be cached in the object pool,
         * for the next cycle of reuse.
         *
         * @param target the target of event dispatcher.
         * @param eventType The event type; indicates the action that triggered the event.
         * @param property Name of the property that changed.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็ EventDispatcher ๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         *
         * @param target ไบไปถๆดพๅ็ฎๆ
         * @param eventType ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param property ๅ็ๆนๅ็ๅฑๆงๅ็งฐใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        PropertyEvent.dispatchPropertyEvent = function (target, eventType, property) {
            if (!target.hasEventListener(eventType)) {
                return true;
            }
            var event = egret.Event.create(PropertyEvent, eventType);
            event.property = property;
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * Dispatch when a property changed.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฑๆงๆนๅใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        PropertyEvent.PROPERTY_CHANGE = "propertyChange";
        return PropertyEvent;
    }(egret.Event));
    eui.PropertyEvent = PropertyEvent;
    __reflect(PropertyEvent.prototype, "eui.PropertyEvent");
})(eui || (eui = {}));
var eui;
(function (eui) {
    /**
     * @private
     */
    var ScrollerThrowEvent = (function (_super) {
        __extends(ScrollerThrowEvent, _super);
        /**
         * ๅจ็ปไฟกๆฏ๏ผๅฏ่ฐ่ๆไฟฎๆน
         */
        //public tween;
        function ScrollerThrowEvent(type, bubbles, cancelable, currentPos, toPos) {
            var _this = _super.call(this, type, bubbles, cancelable) || this;
            currentPos = +currentPos;
            toPos = +toPos;
            _this.currentPos = currentPos;
            _this.toPos = toPos;
            return _this;
        }
        ScrollerThrowEvent.THROW = "throw";
        return ScrollerThrowEvent;
    }(egret.Event));
    eui.ScrollerThrowEvent = ScrollerThrowEvent;
    __reflect(ScrollerThrowEvent.prototype, "eui.ScrollerThrowEvent");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The UIEvent class represents the event object passed to
     * the event listener for many UI events.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/UIEventExample.ts
     * @language en_US
     */
    /**
     * UIไบไปถ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/events/UIEventExample.ts
     * @language zh_CN
     */
    var UIEvent = (function (_super) {
        __extends(UIEvent, _super);
        /**
         * Constructor.
         *
         * @param type The event type; indicates the action that triggered the event.
         * @param bubbles Specifies whether the event can bubble
         * up the display list hierarchy.
         * @param cancelable Specifies whether the behavior
         * associated with the event can be prevented.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธช UIEvent ๅฎไพ
         *
         * @param type ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param bubbles ๆๅฎ่ฏฅไบไปถๆฏๅฆๅฏไปฅๅจๆพ็คบๅ่กจๅฑๆฌก็ปๆๅพๅฐๅๆณกๅค็ใ
         * @param cancelable ๆๅฎๆฏๅฆๅฏไปฅ้ฒๆญขไธไบไปถ็ธๅณ่็่กไธบใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function UIEvent(type, bubbles, cancelable) {
            return _super.call(this, type, bubbles, cancelable) || this;
        }
        /**
         * Dispatch an event with specified EventDispatcher. The dispatched event will be cached in the object pool,
         * for the next cycle of reuse.
         *
         * @param target the target of event dispatcher.
         * @param eventType The event type; indicates the action that triggered the event.
         * @param bubbles  Determines whether the Event object participates in the bubbling stage of the event flow. The default value is false.
         * @param cancelable Determines whether the Event object can be canceled. The default values is false.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไฝฟ็จๆๅฎ็EventDispatcherๅฏน่ฑกๆฅๆๅบไบไปถๅฏน่ฑกใๆๅบ็ๅฏน่ฑกๅฐไผ็ผๅญๅจๅฏน่ฑกๆฑไธ๏ผไพไธๆฌกๅพช็ฏๅค็จใ
         *
         * @param target ไบไปถๆดพๅ็ฎๆใ
         * @param eventType ไบไปถ็ฑปๅ๏ผๆ็คบ่งฆๅไบไปถ็ๅจไฝใ
         * @param bubbles  ็กฎๅฎ Event ๅฏน่ฑกๆฏๅฆๅไธไบไปถๆต็ๅๆณก้ถๆฎตใ้ป่ฎคๅผไธบ falseใ
         * @param cancelable ็กฎๅฎๆฏๅฆๅฏไปฅๅๆถ Event ๅฏน่ฑกใ้ป่ฎคๅผไธบ falseใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.dispatchUIEvent = function (target, eventType, bubbles, cancelable) {
            if (!target.hasEventListener(eventType)) {
                return true;
            }
            var event = egret.Event.create(UIEvent, eventType, bubbles, cancelable);
            var result = target.dispatchEvent(event);
            egret.Event.release(event);
            return result;
        };
        /**
         * creation complete of component.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปไปถๅๅปบๅฎๆ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.CREATION_COMPLETE = "creationComplete";
        /**
         * the ending of change.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆนๅ็ปๆ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.CHANGE_END = "changeEnd";
        /**
         * The beginning of change.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆนๅๅผๅง
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.CHANGE_START = "changeStart";
        /**
         * Before close the panel.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅณๅฐๅณ้ญ้ขๆฟไบไปถ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.CLOSING = "closing";
        /**
         * The coordinates of the UI components changed in it's parent.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * UI็ปไปถๅจ็ถ็บงๅฎนๅจไธญ็ๅๆๅ็ๆนๅไบไปถ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        UIEvent.MOVE = "move";
        return UIEvent;
    }(egret.Event));
    eui.UIEvent = UIEvent;
    __reflect(UIEvent.prototype, "eui.UIEvent");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        var STATE = "eui.State";
        var ADD_ITEMS = "eui.AddItems";
        var SET_PROPERTY = "eui.SetProperty";
        var SET_STATEPROPERTY = "eui.SetStateProperty";
        var BINDING_PROPERTIES = "eui.Binding.$bindProperties";
        /**
         * @private
         * ไปฃ็็ๆๅทฅๅทๅบ็ฑป
         */
        var CodeBase = (function () {
            function CodeBase() {
                /**
                 * @private
                 */
                this.indent = 0;
            }
            /**
             * @private
             *
             * @returns
             */
            CodeBase.prototype.toCode = function () {
                return "";
            };
            /**
             * @private
             * ่ทๅ็ผฉ่ฟๅญ็ฌฆไธฒ
             */
            CodeBase.prototype.getIndent = function (indent) {
                if (indent === void 0)
                    indent = this.indent;
                var str = "";
                for (var i = 0; i < indent; i++) {
                    str += "	";
                }
                return str;
            };
            return CodeBase;
        }());
        sys.CodeBase = CodeBase;
        __reflect(CodeBase.prototype, "eui.sys.CodeBase");
        /**
         * @private
         */
        var EXClass = (function (_super) {
            __extends(EXClass, _super);
            function EXClass() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 * ็ฑปๅ,ไธๅๆฌๆจกๅๅ
                 */
                _this.className = "";
                /**
                 * @private
                 * ็ถ็ฑป็ฑปๅ,ๅๆฌๅฎๆดๆจกๅๅ
                 */
                _this.superClass = "";
                /**
                 * @private
                 * ๅ้จ็ฑปๅบๅ
                 */
                _this.innerClassBlock = [];
                /**
                 * @private
                 * ๅ้ๅฎไนๅบๅ
                 */
                _this.variableBlock = [];
                /**
                 * @private
                 * ๅฝๆฐๅฎไนๅบๅ
                 */
                _this.functionBlock = [];
                return _this;
            }
            /**
             * @private
             * ๆทปๅไธไธชๅ้จ็ฑป
             */
            EXClass.prototype.addInnerClass = function (clazz) {
                if (this.innerClassBlock.indexOf(clazz) == -1) {
                    this.innerClassBlock.push(clazz);
                }
            };
            /**
             * @private
             * ๆทปๅๅ้
             */
            EXClass.prototype.addVariable = function (variableItem) {
                if (this.variableBlock.indexOf(variableItem) == -1) {
                    this.variableBlock.push(variableItem);
                }
            };
            /**
             * @private
             * ๆนๆฎๅ้ๅ่ทๅๅ้ๅฎไน
             */
            EXClass.prototype.getVariableByName = function (name) {
                var list = this.variableBlock;
                var length = list.length;
                for (var i = 0; i < length; i++) {
                    var item = list[i];
                    if (item.name == name) {
                        return item;
                    }
                }
                return null;
            };
            /**
             * @private
             * ๆทปๅๅฝๆฐ
             */
            EXClass.prototype.addFunction = function (functionItem) {
                if (this.functionBlock.indexOf(functionItem) == -1) {
                    this.functionBlock.push(functionItem);
                }
            };
            /**
             * @private
             * ๆนๆฎๅฝๆฐๅ่ฟๅๅฝๆฐๅฎไนๅ
             */
            EXClass.prototype.getFuncByName = function (name) {
                var list = this.functionBlock;
                var length = list.length;
                for (var i = 0; i < length; i++) {
                    var item = list[i];
                    if (item.name == name) {
                        return item;
                    }
                }
                return null;
            };
            /**
             * @private
             *
             * @returns
             */
            EXClass.prototype.toCode = function () {
                var indent = this.indent;
                var indentStr = this.getIndent(indent);
                var indent1Str = this.getIndent(indent + 1);
                var indent2Str = this.getIndent(indent + 2);
                //ๆๅฐ็ฑป่ตทๅงๅ
                var returnStr = indentStr + "(function (";
                if (this.superClass) {
                    returnStr += "_super) {\n" + indent1Str + "__extends(" + this.className + ", _super);\n";
                }
                else {
                    returnStr += ") {\n";
                }
                //ๆๅฐๅ้จ็ฑปๅ่กจ
                var innerClasses = this.innerClassBlock;
                var length = innerClasses.length;
                for (var i = 0; i < length; i++) {
                    var clazz = innerClasses[i];
                    clazz.indent = indent + 1;
                    returnStr += indent1Str + "var " + clazz.className + " = " + clazz.toCode() + "\n\n";
                }
                returnStr += indent1Str + "function " + this.className + "() {\n";
                if (this.superClass) {
                    returnStr += indent2Str + "_super.call(this);\n";
                }
                //ๆๅฐๅ้ๅ่กจ
                var variables = this.variableBlock;
                length = variables.length;
                for (var i = 0; i < length; i++) {
                    var variable = variables[i];
                    if (variable.defaultValue) {
                        returnStr += indent2Str + variable.toCode() + "\n";
                    }
                }
                //ๆๅฐๆ้ๅฝๆฐ
                if (this.constructCode) {
                    var codes = this.constructCode.toCode().split("\n");
                    length = codes.length;
                    for (var i = 0; i < length; i++) {
                        var code = codes[i];
                        returnStr += indent2Str + code + "\n";
                    }
                }
                returnStr += indent1Str + "}\n";
                returnStr += indent1Str + "var _proto = " + this.className + ".prototype;\n\n";
                //ๆๅฐๅฝๆฐๅ่กจ
                var functions = this.functionBlock;
                length = functions.length;
                for (var i = 0; i < length; i++) {
                    var functionItem = functions[i];
                    functionItem.indent = indent + 1;
                    returnStr += functionItem.toCode() + "\n";
                }
                //ๆๅฐ็ฑป็ปๅฐพ
                returnStr += indent1Str + "return " + this.className + ";\n" + indentStr;
                if (this.superClass) {
                    returnStr += "})(" + this.superClass + ");";
                }
                else {
                    returnStr += "})();";
                }
                return returnStr;
            };
            return EXClass;
        }(CodeBase));
        sys.EXClass = EXClass;
        __reflect(EXClass.prototype, "eui.sys.EXClass");
        /**
         * @private
         */
        var EXCodeBlock = (function (_super) {
            __extends(EXCodeBlock, _super);
            function EXCodeBlock() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 */
                _this.lines = [];
                return _this;
            }
            /**
             * @private
             * ๆทปๅๅ้ๅฃฐๆ่ฏญๅฅ
             * @param name ๅ้ๅ
             * @param value ๅ้ๅๅงๅผ
             */
            EXCodeBlock.prototype.addVar = function (name, value) {
                var valueStr = value ? " = " + value : "";
                this.addCodeLine("var " + name + valueStr + ";");
            };
            /**
             * @private
             * ๆทปๅ่ตๅผ่ฏญๅฅ
             * @param target ่ฆ่ตๅผ็็ฎๆ
             * @param value ๅผ
             * @param prop ็ฎๆ็ๅฑๆง(็จโ.โ่ฎฟ้ฎ)๏ผไธๅกซๅๆฏๅฏน็ฎๆ่ตๅผ
             */
            EXCodeBlock.prototype.addAssignment = function (target, value, prop) {
                var propStr = prop ? "." + prop : "";
                this.addCodeLine(target + propStr + " = " + value + ";");
            };
            /**
             * @private
             * ๆทปๅ่ฟๅๅผ่ฏญๅฅ
             */
            EXCodeBlock.prototype.addReturn = function (data) {
                this.addCodeLine("return " + data + ";");
            };
            /**
             * @private
             * ๆทปๅไธๆก็ฉบ่ก
             */
            EXCodeBlock.prototype.addEmptyLine = function () {
                this.addCodeLine("");
            };
            /**
             * @private
             * ๅผๅงๆทปๅif่ฏญๅฅๅ,่ชๅจ่ฐ็จstartBlock();
             */
            EXCodeBlock.prototype.startIf = function (expression) {
                this.addCodeLine("if(" + expression + ")");
                this.startBlock();
            };
            /**
             * @private
             * ๅผๅงelse่ฏญๅฅๅ,่ชๅจ่ฐ็จstartBlock();
             */
            EXCodeBlock.prototype.startElse = function () {
                this.addCodeLine("else");
                this.startBlock();
            };
            /**
             * @private
             * ๅผๅงelse if่ฏญๅฅๅ,่ชๅจ่ฐ็จstartBlock();
             */
            EXCodeBlock.prototype.startElseIf = function (expression) {
                this.addCodeLine("else if(" + expression + ")");
                this.startBlock();
            };
            /**
             * @private
             * ๆทปๅไธไธชๅทฆๅคงๆฌๅท๏ผๅผๅงๆฐ็่ฏญๅฅๅ
             */
            EXCodeBlock.prototype.startBlock = function () {
                this.addCodeLine("{");
                this.indent++;
            };
            /**
             * @private
             * ๆทปๅไธไธชๅณๅคงๆฌๅท,็ปๆๅฝๅ็่ฏญๅฅๅ
             */
            EXCodeBlock.prototype.endBlock = function () {
                this.indent--;
                this.addCodeLine("}");
            };
            /**
             * @private
             * ๆทปๅๆง่กๅฝๆฐ่ฏญๅฅๅ
             * @param functionName ่ฆๆง่ก็ๅฝๆฐๅ็งฐ
             * @param args ๅฝๆฐๅๆฐๅ่กจ
             */
            EXCodeBlock.prototype.doFunction = function (functionName, args) {
                var argsStr = args.join(",");
                this.addCodeLine(functionName + "(" + argsStr + ")");
            };
            /**
             * @private
             * ๆทปๅไธ่กไปฃ็
             */
            EXCodeBlock.prototype.addCodeLine = function (code) {
                this.lines.push(this.getIndent() + code);
            };
            /**
             * @private
             * ๆทปๅไธ่กไปฃ็ๅฐๆๅฎ่ก
             */
            EXCodeBlock.prototype.addCodeLineAt = function (code, index) {
                this.lines.splice(index, 0, this.getIndent() + code);
            };
            /**
             * @private
             * ๆฏๅฆๅญๅจๆ่กไปฃ็ๅๅฎน
             */
            EXCodeBlock.prototype.containsCodeLine = function (code) {
                return this.lines.indexOf(code) != -1;
            };
            /**
             * @private
             * ๅจ็ปๅฐพ่ฟฝๅๅฆไธไธชไปฃ็ๅ็ๅๅฎน
             */
            EXCodeBlock.prototype.concat = function (cb) {
                this.lines = this.lines.concat(cb.lines);
            };
            /**
             * @private
             *
             * @returns
             */
            EXCodeBlock.prototype.toCode = function () {
                return this.lines.join("\n");
            };
            return EXCodeBlock;
        }(CodeBase));
        sys.EXCodeBlock = EXCodeBlock;
        __reflect(EXCodeBlock.prototype, "eui.sys.EXCodeBlock");
        /**
         * @private
         */
        var EXFunction = (function (_super) {
            __extends(EXFunction, _super);
            function EXFunction() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * @private
                 * ไปฃ็ๅ
                 */
                _this.codeBlock = null;
                /**
                 * @private
                 */
                _this.isGet = false;
                /**
                 * @private
                 * ๅฝๆฐๅ
                 */
                _this.name = "";
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXFunction.prototype.toCode = function () {
                var indentStr = this.getIndent();
                var indent1Str = this.getIndent(this.indent + 1);
                var codeIndent;
                var returnStr = indentStr;
                if (this.isGet) {
                    codeIndent = this.getIndent(this.indent + 2);
                    returnStr += 'Object.defineProperty(_proto, "skinParts", {\n';
                    returnStr += indent1Str + "get: function () {\n";
                }
                else {
                    codeIndent = indent1Str;
                    returnStr += "_proto." + this.name + " = function () {\n";
                }
                if (this.codeBlock) {
                    var lines = this.codeBlock.toCode().split("\n");
                    var length_28 = lines.length;
                    for (var i = 0; i < length_28; i++) {
                        var line = lines[i];
                        returnStr += codeIndent + line + "\n";
                    }
                }
                if (this.isGet) {
                    returnStr += indent1Str + "},\n" + indent1Str + "enumerable: true,\n" +
                        indent1Str + "configurable: true\n" + indentStr + "});";
                }
                else {
                    returnStr += indentStr + "};";
                }
                return returnStr;
            };
            return EXFunction;
        }(CodeBase));
        sys.EXFunction = EXFunction;
        __reflect(EXFunction.prototype, "eui.sys.EXFunction");
        /**
         * @private
         */
        var EXVariable = (function (_super) {
            __extends(EXVariable, _super);
            /**
             * @private
             */
            function EXVariable(name, defaultValue) {
                var _this = _super.call(this) || this;
                _this.indent = 2;
                _this.name = name;
                _this.defaultValue = defaultValue;
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXVariable.prototype.toCode = function () {
                if (!this.defaultValue) {
                    return "";
                }
                return "this." + this.name + " = " + this.defaultValue + ";";
            };
            return EXVariable;
        }(CodeBase));
        sys.EXVariable = EXVariable;
        __reflect(EXVariable.prototype, "eui.sys.EXVariable");
        /**
         * @private
         */
        var EXState = (function (_super) {
            __extends(EXState, _super);
            /**
             * @private
             */
            function EXState(name, stateGroups) {
                var _this = _super.call(this) || this;
                /**
                 * @private
                 * ่งๅพ็ถๆๅ็งฐ
                 */
                _this.name = "";
                /**
                 * @private
                 */
                _this.stateGroups = [];
                /**
                 * @private
                 */
                _this.addItems = [];
                /**
                 * @private
                 */
                _this.setProperty = [];
                _this.name = name;
                if (stateGroups)
                    _this.stateGroups = stateGroups;
                return _this;
            }
            /**
             * @private
             * ๆทปๅไธไธช่ฆ็
             */
            EXState.prototype.addOverride = function (item) {
                if (item instanceof EXAddItems)
                    this.addItems.push(item);
                else
                    this.setProperty.push(item);
            };
            /**
             * @private
             *
             * @returns
             */
            EXState.prototype.toCode = function () {
                var indentStr = this.getIndent(1);
                var returnStr = "new " + STATE + " (\"" + this.name + "\",\n" + indentStr + "[\n";
                var index = 0;
                var isFirst = true;
                var overrides = this.addItems.concat(this.setProperty);
                while (index < overrides.length) {
                    if (isFirst)
                        isFirst = false;
                    else
                        returnStr += ",\n";
                    var item = overrides[index];
                    var codes = item.toCode().split("\n");
                    var length_29 = codes.length;
                    for (var i = 0; i < length_29; i++) {
                        var code = codes[i];
                        codes[i] = indentStr + indentStr + code;
                    }
                    returnStr += codes.join("\n");
                    index++;
                }
                returnStr += "\n" + indentStr + "])";
                return returnStr;
            };
            return EXState;
        }(CodeBase));
        sys.EXState = EXState;
        __reflect(EXState.prototype, "eui.sys.EXState");
        /**
         * @private
         */
        var EXAddItems = (function (_super) {
            __extends(EXAddItems, _super);
            /**
             * @private
             */
            function EXAddItems(target, property, position, relativeTo) {
                var _this = _super.call(this) || this;
                _this.target = target;
                _this.property = property;
                _this.position = position;
                _this.relativeTo = relativeTo;
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXAddItems.prototype.toCode = function () {
                var returnStr = "new " + ADD_ITEMS + "(\"" + this.target + "\",\"" + this.property + "\"," + this.position + ",\"" + this.relativeTo + "\")";
                return returnStr;
            };
            return EXAddItems;
        }(CodeBase));
        sys.EXAddItems = EXAddItems;
        __reflect(EXAddItems.prototype, "eui.sys.EXAddItems");
        /**
         * @private
         */
        var EXSetProperty = (function (_super) {
            __extends(EXSetProperty, _super);
            /**
             * @private
             */
            function EXSetProperty(target, name, value) {
                var _this = _super.call(this) || this;
                _this.target = target;
                _this.name = name;
                _this.value = value;
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXSetProperty.prototype.toCode = function () {
                return "new " + SET_PROPERTY + "(\"" + this.target + "\",\"" + this.name + "\"," + this.value + ")";
            };
            return EXSetProperty;
        }(CodeBase));
        sys.EXSetProperty = EXSetProperty;
        __reflect(EXSetProperty.prototype, "eui.sys.EXSetProperty");
        /**
         * @private
         */
        var EXSetStateProperty = (function (_super) {
            __extends(EXSetStateProperty, _super);
            /**
             * @private
             */
            function EXSetStateProperty(target, property, templates, chainIndex) {
                var _this = _super.call(this) || this;
                if (target) {
                    target = "this." + target;
                }
                else {
                    target = "this";
                }
                _this.target = target;
                _this.property = property;
                _this.templates = templates;
                _this.chainIndex = chainIndex;
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXSetStateProperty.prototype.toCode = function () {
                var expression = this.templates.join(",");
                var chain = this.chainIndex.join(",");
                return "new " + SET_STATEPROPERTY + "(this, [" + expression + "]," + "[" + chain + "]," +
                    this.target + ",\"" + this.property + "\")";
            };
            return EXSetStateProperty;
        }(CodeBase));
        sys.EXSetStateProperty = EXSetStateProperty;
        __reflect(EXSetStateProperty.prototype, "eui.sys.EXSetStateProperty");
        /**
         * @private
         */
        var EXBinding = (function (_super) {
            __extends(EXBinding, _super);
            /**
             * @private
             */
            function EXBinding(target, property, templates, chainIndex) {
                var _this = _super.call(this) || this;
                _this.target = target;
                _this.property = property;
                _this.templates = templates;
                _this.chainIndex = chainIndex;
                return _this;
            }
            /**
             * @private
             *
             * @returns
             */
            EXBinding.prototype.toCode = function () {
                var expression = this.templates.join(",");
                var chain = this.chainIndex.join(",");
                return BINDING_PROPERTIES + "(this, [" + expression + "]," + "[" + chain + "]," +
                    this.target + ",\"" + this.property + "\")";
            };
            return EXBinding;
        }(CodeBase));
        sys.EXBinding = EXBinding;
        __reflect(EXBinding.prototype, "eui.sys.EXBinding");
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="../core/UIComponent.ts" />
var eui;
(function (eui) {
    var UIImpl = eui.sys.UIComponentImpl;
    /**
     * BitmapLabel is one line or multiline uneditable BitmapText
     * @version Egret 2.5.3
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * BitmapLabel ็ปไปถๆฏไธ่กๆๅค่กไธๅฏ็ผ่พ็ไฝๅพๆๆฌ
     * @version Egret 2.5.3
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var BitmapLabel = (function (_super) {
        __extends(BitmapLabel, _super);
        function BitmapLabel(text) {
            var _this = _super.call(this) || this;
            _this.$createChildrenCalled = false;
            _this.$fontChanged = false;
            /**
             * @private
             */
            _this._widthConstraint = NaN;
            /**
             * @private
             */
            _this._heightConstraint = NaN;
            _this.initializeUIValues();
            _this.text = text;
            return _this;
        }
        /**
         * @private
         *
         */
        BitmapLabel.prototype.$invalidateContentBounds = function () {
            _super.prototype.$invalidateContentBounds.call(this);
            this.invalidateSize();
        };
        /**
         * @private
         *
         * @param value
         */
        BitmapLabel.prototype.$setWidth = function (value) {
            var result1 = _super.prototype.$setWidth.call(this, value);
            var result2 = UIImpl.prototype.$setWidth.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        BitmapLabel.prototype.$setHeight = function (value) {
            var result1 = _super.prototype.$setHeight.call(this, value);
            var result2 = UIImpl.prototype.$setHeight.call(this, value);
            return result1 && result2;
        };
        /**
         * @private
         *
         * @param value
         */
        BitmapLabel.prototype.$setText = function (value) {
            var result = _super.prototype.$setText.call(this, value);
            eui.PropertyEvent.dispatchPropertyEvent(this, eui.PropertyEvent.PROPERTY_CHANGE, "text");
            return result;
        };
        BitmapLabel.prototype.$setFont = function (value) {
            var values = this.$BitmapText;
            if (this.$font == value) {
                return false;
            }
            this.$font = value;
            if (this.$createChildrenCalled) {
                this.$parseFont();
            }
            else {
                this.$fontChanged = true;
            }
            this.$BitmapText[6 /* fontStringChanged */] = true;
            return true;
        };
        /**
         * ่งฃๆsource
         */
        BitmapLabel.prototype.$parseFont = function () {
            var _this = this;
            this.$fontChanged = false;
            var font = this.$font;
            if (typeof font == "string") {
                eui.getAssets(font, function (bitmapFont) {
                    _this.$setFontData(bitmapFont);
                });
            }
            else {
                this.$setFontData(font);
            }
        };
        BitmapLabel.prototype.$setFontData = function (value) {
            if (value == this.$BitmapText[5 /* font */]) {
                return false;
            }
            this.$BitmapText[5 /* font */] = value;
            this.$invalidateContentBounds();
            return true;
        };
        /**
         * @copy eui.UIComponent#createChildren
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.createChildren = function () {
            if (this.$fontChanged) {
                this.$parseFont();
            }
            this.$createChildrenCalled = true;
        };
        /**
         * @copy eui.UIComponent#childrenCreated
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.childrenCreated = function () {
        };
        /**
         * @copy eui.UIComponent#commitProperties
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.commitProperties = function () {
        };
        /**
         * @copy eui.UIComponent#measure
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.measure = function () {
            var values = this.$UIComponent;
            var textValues = this.$BitmapText;
            var oldWidth = textValues[0 /* textFieldWidth */];
            var oldHeight = textValues[1 /* textFieldHeight */];
            var availableWidth = NaN;
            if (!isNaN(this._widthConstraint)) {
                availableWidth = this._widthConstraint;
                this._widthConstraint = NaN;
            }
            else if (!isNaN(values[8 /* explicitWidth */])) {
                availableWidth = values[8 /* explicitWidth */];
            }
            else if (values[13 /* maxWidth */] != 100000) {
                availableWidth = values[13 /* maxWidth */];
            }
            _super.prototype.$setWidth.call(this, availableWidth);
            var availableHeight = NaN;
            if (!isNaN(this._heightConstraint)) {
                availableHeight = this._heightConstraint;
                this._heightConstraint = NaN;
            }
            else if (!isNaN(values[9 /* explicitHeight */])) {
                availableHeight = values[9 /* explicitHeight */];
            }
            else if (values[15 /* maxHeight */] != 100000) {
                availableHeight = values[15 /* maxHeight */];
            }
            _super.prototype.$setHeight.call(this, availableHeight);
            this.setMeasuredSize(this.textWidth, this.textHeight);
            _super.prototype.$setWidth.call(this, oldWidth);
            _super.prototype.$setHeight.call(this, oldHeight);
        };
        /**
         * @copy eui.UIComponent#updateDisplayList
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.$setWidth.call(this, unscaledWidth);
            _super.prototype.$setHeight.call(this, unscaledHeight);
        };
        /**
         * @copy eui.UIComponent#invalidateParentLayout
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.invalidateParentLayout = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.setMeasuredSize = function (width, height) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.invalidateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.validateProperties = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.invalidateSize = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.validateSize = function (recursive) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.invalidateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.validateDisplayList = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.validateNow = function () {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.setLayoutBoundsSize = function (layoutWidth, layoutHeight) {
            UIImpl.prototype.setLayoutBoundsSize.call(this, layoutWidth, layoutHeight);
            if (isNaN(layoutWidth) || layoutWidth === this._widthConstraint || layoutWidth == 0) {
                return;
            }
            var values = this.$UIComponent;
            if (!isNaN(values[9 /* explicitHeight */])) {
                return;
            }
            if (layoutWidth == values[16 /* measuredWidth */]) {
                return;
            }
            this._widthConstraint = layoutWidth;
            this._heightConstraint = layoutHeight;
            this.invalidateSize();
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.setLayoutBoundsPosition = function (x, y) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.getLayoutBounds = function (bounds) {
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BitmapLabel.prototype.getPreferredBounds = function (bounds) {
        };
        return BitmapLabel;
    }(egret.BitmapText));
    eui.BitmapLabel = BitmapLabel;
    __reflect(BitmapLabel.prototype, "eui.BitmapLabel", ["eui.UIComponent", "egret.DisplayObject", "eui.IDisplayText"]);
    eui.sys.implementUIComponent(BitmapLabel, egret.BitmapText);
    eui.registerBindable(BitmapLabel.prototype, "text");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
/// <reference path="EXMLParser.ts" />
var EXML;
(function (EXML) {
    var parser = new eui.sys.EXMLParser();
    var requestPool = [];
    var callBackMap = {};
    var parsedClasses = {};
    var $prefixURL = "";
    Object.defineProperty(EXML, "prefixURL", {
        get: function () { return $prefixURL; },
        set: function (value) { $prefixURL = value; },
        enumerable: true,
        configurable: true
    });
    /**
     * Parsing a text of EXML file for a definition of class. You can declare the <code>class</code> property in the root
     * node of the EXML to register to the global as a class name.
     *
     * It will be fail to register and output a warning if the specified name already exists. You can get a definition
     * of a class through <code>egret.getDefinitionByName(className)</code>.
     *
     * @param text the text of a EXML file.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่งฃๆไธไธช EXML ๆไปถ็ๆๆฌๅๅฎนไธบไธไธช็ฑปๅฎไนใๆจๅฏไปฅๅจ EXML ๆไปถ็ๆน่็นไธๅฃฐๆ class ๅฑๆงไฝไธบ่ฆๆณจๅๅฐๅจๅฑ็็ฑปๅใ
     * ่ฅๆๅฎ็็ฑปๅๅทฒ็ปๅญๅจ๏ผๅฐไผๆณจๅๅคฑ่ดฅ๏ผๅนถ่พๅบไธไธช่ญฆๅใๆณจๅๆๅๅ๏ผๆจไนๅฏไปฅ้่ฟ egret.getDefinitionByName(className) ๆนๆณ่ทๅ่ฟไธช EXML ๆไปถๅฏนๅบ็็ฑปๅฎไนใ
     *
     * @param text ่ฆ่งฃๆ็ EXML ๆไปถๅๅฎนใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    function parse(text) {
        return parser.parse(text);
    }
    EXML.parse = parse;
    /**
     * Load and parse an external EXML file for a class definition. You can declare the <code>class</code> property in the root
     * node of the EXML to register to the global as a class name.
     *
     * It will be fail to register and output a warning if the specified name already exists. You can get a definition
     * of a class through <code>egret.getDefinitionByName(className)</code>.
     *
     * @param url the path of an EXML file
     * @param callBack method to invoke with an argument of the result when load and parse completed or failed. The argument will be
     * <code>undefined</code> if load or parse failed.
     * @param thisObject <code>this</code> object of callBack
     * @param useCache use cached EXML
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ๅ่ฝฝๅนถ่งฃๆไธไธชๅค้จ็ EXML ๆไปถไธบไธไธช็ฑปๅฎไนใๆจๅฏไปฅๅจ EXML ๆไปถ็ๆน่็นไธๅฃฐๆ class ๅฑๆงไฝไธบ่ฆๆณจๅๅฐๅจๅฑ็็ฑปๅใ
     * ่ฅๆๅฎ็็ฑปๅๅทฒ็ปๅญๅจ๏ผๅฐไผๆณจๅๅคฑ่ดฅ๏ผๅนถ่พๅบไธไธช่ญฆๅใๆณจๅๆๅๅ๏ผๆจไนๅฏไปฅ้่ฟ egret.getDefinitionByName(className) ๆนๆณ่ทๅ่ฟไธช EXML ๆไปถๅฏนๅบ็็ฑปๅฎไนใ
     *
     * @param url ่ฆๅ่ฝฝ็ EXML ๆไปถ่ทฏๅพ
     * @param callBack ๅ่ฝฝๅนถ่งฃๆๅฎๆๅ็ๅ่ฐๅฝๆฐ๏ผๆ่ฎบๅ่ฝฝๆๅ่ฟๆฏๅคฑ่ดฅ๏ผๆญคๅฝๆฐๅไผ่ขซๅ่ฐใๅคฑ่ดฅๆถๅฐไผๅฅ undefined ไฝไธบๅ่ฐๅฝๆฐๅๆฐใ
     * @param thisObject ๅ่ฐๅฝๆฐ็ this ๅผ็จใ
     * @param useCache ไฝฟ็จ็ผๅญ็EXML
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    function load(url, callBack, thisObject, useCache) {
        if (useCache === void 0) {
            useCache = false;
        }
        if (true) {
            if (!url) {
                egret.$error(1003, "url");
            }
        }
        if (useCache && (url in parsedClasses)) {
            callBack && callBack.call(thisObject, parsedClasses[url], url);
            return;
        }
        var list = callBackMap[url];
        if (list) {
            list.push([callBack, thisObject]);
            return;
        }
        callBackMap[url] = [[callBack, thisObject]];
        request(url, $parseURLContent);
    }
    EXML.load = load;
    /**
     * @private
     */
    function $loadAll(urls, callBack, thisObject, useCache) {
        if (useCache === void 0) {
            useCache = false;
        }
        if (!urls || urls.length == 0) {
            callBack && callBack.call(thisObject, [], urls);
            return;
        }
        var exmlContents = [];
        urls.forEach(function (url) {
            var loaded = function (url, text) {
                exmlContents[url] = text;
                exmlContents.push(url);
                if (exmlContents.length == urls.length)
                    onLoadAllFinished(urls, exmlContents, callBack, thisObject);
            };
            if (useCache && (url in parsedClasses)) {
                loaded(url, "");
                return;
            }
            request(url, loaded);
        });
    }
    EXML.$loadAll = $loadAll;
    /**
     * @private
     */
    function onLoadAllFinished(urls, exmlContents, callBack, thisObject) {
        var clazzes = [];
        urls.forEach(function (url, i) {
            if ((url in parsedClasses) && !exmlContents[url]) {
                clazzes[i] = parsedClasses[url];
                return;
            }
            var text = exmlContents[url];
            var clazz = $parseURLContent(url, text);
            clazzes[i] = clazz;
        });
        callBack && callBack.call(thisObject, clazzes, urls);
    }
    /**
     * @private
     * @param url
     * @param text
     */
    function $parseURLContentAsJs(url, text, className) {
        var clazz = null;
        if (text) {
            clazz = parser.$parseCode(text, className);
        }
        if (url) {
            parsedClasses[url] = clazz;
            var list = callBackMap[url];
            delete callBackMap[url];
            var length_30 = list ? list.length : 0;
            for (var i = 0; i < length_30; i++) {
                var arr = list[i];
                if (arr[0] && arr[1])
                    arr[0].call(arr[1], clazz, url);
            }
        }
        return clazz;
    }
    EXML.$parseURLContentAsJs = $parseURLContentAsJs;
    /**
     * @private
     */
    function $parseURLContent(url, text) {
        var clazz = null;
        if (text) {
            try {
                clazz = parse(text);
            }
            catch (e) {
                console.error(url + "\n" + e.message);
            }
        }
        if (url) {
            parsedClasses[url] = clazz;
            var list = callBackMap[url];
            delete callBackMap[url];
            var length_31 = list ? list.length : 0;
            for (var i = 0; i < length_31; i++) {
                var arr = list[i];
                if (arr[0] && arr[1])
                    arr[0].call(arr[1], clazz, url);
            }
        }
        return clazz;
    }
    EXML.$parseURLContent = $parseURLContent;
    /**
     * @private
     */
    function request(url, callback) {
        var openUrl = url;
        if (url.indexOf("://") == -1) {
            openUrl = $prefixURL + url;
        }
        var onConfigLoaded = function (str) {
            if (!str) {
                str = "";
            }
            callback(url, str);
        };
        eui.getTheme(openUrl, onConfigLoaded);
    }
})(EXML || (EXML = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        /**
         * @private
         * EUI ๅฝๅ็ฉบ้ด
         */
        sys.NS_S = "http://ns.egret.com/eui";
        /**
         * @private
         * Wingๅฝๅ็ฉบ้ด
         */
        sys.NS_W = "http://ns.egret.com/wing";
        var coreClasses = ["Point", "Matrix", "Rectangle"];
        var basicTypes = ["Array", "boolean", "string", "number"];
        var MODULE_NAME = "eui.";
        var hashCount = 0;
        var properties = {};
        /**
         * @private
         */
        var EXMLConfig = (function () {
            function EXMLConfig() {
            }
            /**
             * @private
             */
            EXMLConfig.prototype.$describe = function (instance) {
                if (!instance) {
                    return null;
                }
                var prototype = Object.getPrototypeOf(instance);
                if (!prototype) {
                    return null;
                }
                var info;
                if (prototype.hasOwnProperty("__hashCode__")) {
                    info = properties[prototype.__hashCode__];
                    if (info) {
                        return info;
                    }
                }
                var superProto = Object.getPrototypeOf(prototype);
                if (!superProto) {
                    return null;
                }
                var superInstance = getInstanceOf(superProto.constructor);
                var superInfo = this.$describe(superInstance);
                if (superInfo) {
                    var factory = function () {
                    };
                    factory.prototype = superInfo;
                    info = new factory();
                }
                else {
                    info = {};
                }
                if (true) {
                    info.__class__ = prototype.constructor.name;
                }
                var keys = Object.keys(prototype).concat(Object.keys(instance));
                var length = keys.length;
                var meta = instance.__meta__;
                for (var i = 0; i < length; i++) {
                    var key = keys[i];
                    if (key == "constructor" || key.charAt(0) == "_" || key.charAt(0) == "$") {
                        continue;
                    }
                    var resultType = void 0;
                    if (meta && meta[key]) {
                        resultType = meta[key];
                    }
                    else if (isArray(instance[key])) {
                        resultType = "Array";
                    }
                    else {
                        resultType = typeof instance[key];
                        if (resultType == "function") {
                            continue;
                        }
                        if (basicTypes.indexOf(resultType) == -1) {
                            resultType = "any";
                        }
                    }
                    info[key] = resultType;
                }
                if (Object.getPrototypeOf(superProto)) {
                    prototype.__hashCode__ = hashCount++;
                    properties[prototype.__hashCode__] = info;
                }
                return info;
            };
            /**
             * @private
             * ๆนๆฎ็ฑป็็ญๅIDๅๅฝๅ็ฉบ้ด่ทๅๅฎๆด็ฑปๅ(ไปฅ"."ๅ้)
             * @param id ็ฑป็็ญๅID
             * @param ns ๅฝๅ็ฉบ้ด
             */
            EXMLConfig.prototype.getClassNameById = function (id, ns) {
                if (ns == sys.NS_S) {
                    if (id == "Object") {
                        return id;
                    }
                    if (coreClasses.indexOf(id) != -1) {
                        return "egret." + id;
                    }
                }
                var name = "";
                if (basicTypes.indexOf(id) != -1) {
                    return id;
                }
                if (ns == sys.NS_W) {
                }
                else if (!ns || ns == sys.NS_S) {
                    name = MODULE_NAME + id;
                }
                else {
                    name = ns.substring(0, ns.length - 1) + id;
                }
                if (!getPrototypeOf(name)) {
                    name = "";
                }
                return name;
            };
            /**
             * @private
             * ๆนๆฎID่ทๅๅฏนๅบ็้ป่ฎคๅฑๆง
             * @param id ็ฑป็็ญๅID
             * @param ns ๅฝๅ็ฉบ้ด
             * @return ้ป่ฎคๅฑๆงๅ
             */
            EXMLConfig.prototype.getDefaultPropById = function (id, ns) {
                var className = this.getClassNameById(id, ns);
                var prototype = getPrototypeOf(className);
                var property;
                if (prototype) {
                    property = prototype.__defaultProperty__;
                }
                return property ? property : "";
            };
            /**
             * @private
             * ่ทๅๆๅฎๅฑๆง็็ฑปๅ,่ฟๅๅบๆฌๆฐๆฎ็ฑปๅ๏ผ"boolean","string","number","any"ใ
             * @param property ๅฑๆงๅ
             * @param className ่ฆๆฅ่ฏข็ๅฎๆด็ฑปๅ
             */
            EXMLConfig.prototype.getPropertyType = function (property, className) {
                if (className == "Object") {
                    return "any";
                }
                var resultType = "";
                var prototype = getPrototypeOf(className);
                if (prototype) {
                    if (!prototype.hasOwnProperty("__hashCode__")) {
                        var clazz = egret.getDefinitionByName(className);
                        var instance = getInstanceOf(clazz);
                        if (!instance) {
                            if (true) {
                                egret.$warn(2104, className);
                            }
                            return resultType;
                        }
                        this.$describe(instance);
                    }
                    var info = properties[prototype.__hashCode__];
                    if (info) {
                        resultType = info[property];
                    }
                }
                return resultType;
            };
            return EXMLConfig;
        }());
        sys.EXMLConfig = EXMLConfig;
        __reflect(EXMLConfig.prototype, "eui.sys.EXMLConfig");
        /**
         * @private
         * ๅคๆญไธไธชๅฏน่ฑกๆฏๆฐ็ป
         */
        function isArray(o) {
            return Object.prototype.toString.call(o) === '[object Array]';
        }
        /**
         * @private
         * ่ทๅไธไธช็ฑปๅๅฏนๅบ็prototypeๅผ็จ
         */
        function getPrototypeOf(className) {
            var clazz = egret.getDefinitionByName(className);
            if (!clazz) {
                return null;
            }
            return clazz.prototype;
        }
        /**
         * @private
         * ๅๅปบไธไธช็ฑปๅๅฏนๅบ็ๅฎไพ
         */
        function getInstanceOf(clazz) {
            if (!clazz) {
                return null;
            }
            var instance;
            if (true) {
                try {
                    instance = new clazz();
                }
                catch (e) {
                    egret.error(e);
                    return null;
                }
            }
            else {
                instance = new clazz();
            }
            return instance;
        }
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present; Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms; with or without
//  modification; are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice; this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice; this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES; INCLUDING; BUT NOT LIMITED TO; THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT; INDIRECT;
//  INCIDENTAL; SPECIAL; EXEMPLARY; OR CONSEQUENTIAL DAMAGES (INCLUDING; BUT NOT
//  LIMITED TO; PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE; DATA;
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY; WHETHER IN CONTRACT; STRICT LIABILITY; OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE;
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["en_US"] = egret.$locale_strings["en_US"] || {};
    var locale_strings = egret.$locale_strings["en_US"];
    //2000-2999
    locale_strings[2001] = "EXML parsing error {0}: EXML file can't be found ";
    locale_strings[2002] = "EXML parsing error : invalid XML file:\n{0}";
    locale_strings[2003] = "EXML parsing error {0}: the class definitions corresponding to nodes can't be found  \n {1}";
    locale_strings[2004] = "EXML parsing error {0}: nodes cannot contain id property with the same name \n {1}";
    locale_strings[2005] = "EXML parsing error {0}: property with the name of '{1}' does not exist on the node, or the property does not have a default value: \n {2}";
    locale_strings[2006] = "EXML parsing error {0}: undefined view state name: '{1}' \n {2}";
    locale_strings[2007] = "EXML parsing error {0}: only UIComponent objects within the container can use the includeIn and excludeFrom properties\n {1}";
    locale_strings[2008] = "EXML parsing error {0}: fail to assign values of '{1}' class to property: '{2}' \n {3}";
    locale_strings[2009] = "EXML parsing error {0}: only one ID can be referenced in the node property value '{}' label; and complex expression is not allowed to use \n {1}";
    locale_strings[2010] = "EXML parsing error {0}: ID referenced by property: '{1}':  '{2}' does not exist \n {3}";
    locale_strings[2011] = "EXML parsing error {0}: fail to assign more than one child nodes to the same property: '{1}' \n {2}";
    locale_strings[2012] = "EXML parsing error {0}: no default property exists on the node; and you must explicitly declare the property name that the child node  is assigned to \n {1}";
    locale_strings[2013] = "EXML parsing error {0}: view state grammar is not allowed to use on property nodes of Array class \n {1} ";
    locale_strings[2014] = "EXML parsing error {0}: assigning the skin class itself to the node property is not allowed \n {1}";
    locale_strings[2015] = "EXML parsing error {0}: class definition referenced by node: {1} does not exist \n {2}";
    locale_strings[2016] = "EXML parsing error {0}: format error of 'scale9Grid' property value on the node: {1}";
    locale_strings[2017] = "EXML parsing error {0}: namespace prefix missing on the node: {1}";
    locale_strings[2018] = "EXML parsing error {0}: format error of 'skinName' property value on the node: {1}";
    locale_strings[2019] = "EXML parsing error {0}: the containerโs child item must be visible nodes: {1}";
    locale_strings[2020] = "EXML parsing error {0}: for child nodes in w: Declarations, the includeIn and excludeFrom properties are not allowed to use \n {1}";
    locale_strings[2021] = "Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.";
    locale_strings[2022] = "EXML parsing error: there contains illegal characters in the id `{0}`";
    locale_strings[2101] = "EXML parsing warnning : fail to register the class property : {0},there is already a class with the same name in the global,please try to rename the class name for the exml. \n {1}";
    locale_strings[2102] = "EXML parsing warnning {0}: no child node can be found on the property code \n {1}";
    locale_strings[2103] = "EXML parsing warnning {0}: the same property '{1}' on the node is assigned multiple times \n {2}";
    locale_strings[2104] = "EXML parsing warnning, Instantiate class {0} error๏ผthe parameters of its constructor method must be empty.";
    locale_strings[2201] = "BasicLayout doesn't support virtualization.";
    locale_strings[2202] = "parse skinName error๏ผthe parsing result of skinName must be a instance of eui.Skin.";
    locale_strings[2203] = "Could not find the skin class '{0}'ใ";
    locale_strings[2301] = "parse source failed๏ผcould not find asset from URL๏ผ{0} .";
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present; Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms; with or without
//  modification; are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice; this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice; this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES; INCLUDING; BUT NOT LIMITED TO; THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT; INDIRECT;
//  INCIDENTAL; SPECIAL; EXEMPLARY; OR CONSEQUENTIAL DAMAGES (INCLUDING; BUT NOT
//  LIMITED TO; PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE; DATA;
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY; WHETHER IN CONTRACT; STRICT LIABILITY; OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE;
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    egret.$locale_strings = egret.$locale_strings || {};
    egret.$locale_strings["zh_CN"] = egret.$locale_strings["zh_CN"] || {};
    var locale_strings = egret.$locale_strings["zh_CN"];
    //2000-2999
    //EXMLๆฅ้ไฟกๆฏ
    locale_strings[2001] = "EXML่งฃๆ้่ฏฏ {0}: ๆพไธๅฐEXMLๆไปถ";
    locale_strings[2002] = "EXML่งฃๆ้่ฏฏ: ไธๆฏๆๆ็XMLๆไปถ:\n{0}";
    locale_strings[2003] = "EXML่งฃๆ้่ฏฏ {0}: ๆๆณๆพๅฐ่็นๆๅฏนๅบ็็ฑปๅฎไน\n{1}";
    locale_strings[2004] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธ่ฝๅซๆๅๅ็idๅฑๆง\n{1}";
    locale_strings[2005] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธไธๅญๅจๅไธบ'{1}'็ๅฑๆง๏ผๆ่่ฏฅๅฑๆงๆฒกๆๅๅงๅผ:\n{2}";
    locale_strings[2006] = "EXML่งฃๆ้่ฏฏ {0}: ๆชๅฎไน็่งๅพ็ถๆๅ็งฐ:'{1}'\n{2}";
    locale_strings[2007] = "EXML่งฃๆ้่ฏฏ {0}: ๅชๆๅคไบๅฎนๅจๅ็ UIComponent ๅฏน่ฑกๅฏไปฅไฝฟ็จincludeInๅexcludeFromๅฑๆง\n{1}";
    locale_strings[2008] = "EXML่งฃๆ้่ฏฏ {0}: ๆๆณๅฐ'{1}'็ฑปๅ็ๅผ่ต็ปๅฑๆง:'{2}'\n{3}";
    locale_strings[2009] = "EXML่งฃๆ้่ฏฏ {0}: ๅจ่็นๅฑๆงๅผ็โ{}โๆ็ญพๅๅช่ฝๅผ็จไธไธชID๏ผไธๅ่ฎธไฝฟ็จๅคๆ่กจ่พพๅผ\n{1}";
    locale_strings[2010] = "EXML่งฃๆ้่ฏฏ {0}: ๅฑๆง:'{1}'ๆๅผ็จ็ID: '{2}'ไธๅญๅจ\n{3}";
    locale_strings[2011] = "EXML่งฃๆ้่ฏฏ {0}: ๆๆณๅฐๅคไธชๅญ่็น่ตๅผ็ปๅไธไธชๅฑๆง:'{1}'\n{2}";
    locale_strings[2012] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธไธๅญๅจ้ป่ฎคๅฑๆง๏ผๅฟ้กปๆพๅผๅฃฐๆๅญ่็น่ฆ่ตๅผๅฐ็ๅฑๆงๅ\n{1}";
    locale_strings[2013] = "EXML่งฃๆ้่ฏฏ {0}: ็ฑปๅไธบArray็ๅฑๆง่็นไธไธๅ่ฎธไฝฟ็จ่งๅพ็ถๆ่ฏญๆณ\n{1}";
    locale_strings[2014] = "EXML่งฃๆ้่ฏฏ {0}: ไธๅ่ฎธๅฐ็ฎ่ค็ฑป่ช่บซ่ตๅผ็ป่็นๅฑๆง\n{1}";
    locale_strings[2015] = "EXML่งฃๆ้่ฏฏ {0}: ่็นๅผ็จ็็ฑปๅฎไน:{1}ไธๅญๅจ\n{2}";
    locale_strings[2016] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธ'scale9Grid'ๅฑๆงๅผ็ๆผๅผ้่ฏฏ:{1}";
    locale_strings[2017] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธ็ผบๅฐๅฝๅ็ฉบ้ดๅ็ผ:{1}";
    locale_strings[2018] = "EXML่งฃๆ้่ฏฏ {0}: ่็นไธ'skinName'ๅฑๆงๅผ็ๆผๅผ้่ฏฏ:{1}";
    locale_strings[2019] = "EXML่งฃๆ้่ฏฏ {0}: ๅฎนๅจ็ๅญ้กนๅฟ้กปๆฏๅฏ่ง่็น:{1}";
    locale_strings[2020] = "EXML่งฃๆ้่ฏฏ {0}: ๅจw:Declarationsๅ็ๅญ่็น๏ผไธๅ่ฎธไฝฟ็จincludeInๅexcludeFromๅฑๆง\n{1}";
    locale_strings[2021] = "{0} ไธญๅญๅจ็ผ่ฏ้่ฏฏ๏ผๅฑๆงๅ : {1}๏ผๅฑๆงๅผ : {2}";
    locale_strings[2022] = "EXML่งฃๆ้่ฏฏ: id `{0}` ไธญๅซๆ้ๆณๅญ็ฌฆ";
    //EXML่ญฆๅไฟกๆฏ
    locale_strings[2101] = "EXML่งฃๆ่ญฆๅ: ๅจEXMLๆน่็นไธๅฃฐๆ็ class ๅฑๆง: {0} ๆณจๅๅคฑ่ดฅ๏ผๆๅฏนๅบ็็ฑปๅทฒ็ปๅญๅจ๏ผ่ฏทๅฐ่ฏ้ๅฝๅ่ฆๆณจๅ็็ฑปๅใ\n{1}";
    locale_strings[2102] = "EXML่งฃๆ่ญฆๅ {0}: ๅจๅฑๆง่็นไธๆพไธๅฐไปปไฝๅญ่็น\n{1}";
    locale_strings[2103] = "EXML่งฃๆ่ญฆๅ {0}: ่็นไธ็ๅไธไธชๅฑๆง'{1}'่ขซๅคๆฌก่ตๅผ\n{2}";
    locale_strings[2104] = "EXML่งฃๆ่ญฆๅ๏ผๆๆณ็ดๆฅๅฎไพๅ่ชๅฎไน็ปไปถ๏ผ{0} ๏ผๅจEXMLไธญไฝฟ็จ็่ชๅฎไน็ปไปถๅฟ้กป่ฆ่ฝ็ดๆฅ่ขซๅฎไพๅ๏ผๅฆๅๅฏ่ฝๅฏผ่ดๅ็ปญEXML่งฃๆๆฅ้ใ";
    //EUI ๆฅ้ไธ่ญฆๅไฟกๆฏ
    locale_strings[2201] = "BasicLayout ไธๆฏๆ่ๆๅใ";
    locale_strings[2202] = "็ฎ่ค่งฃๆๅบ้๏ผๅฑๆง skinName ็ๅผๅฟ้กป่ฆ่ฝๅค่งฃๆไธบไธไธช eui.Skin ็ๅฎไพใ";
    locale_strings[2203] = "ๆพไธๅฐๆๅฎ็็ฎ่ค็ฑป '{0}'ใ";
    locale_strings[2301] = "็ดๆ่งฃๆๅคฑ่ดฅ๏ผๆพไธๅฐURL๏ผ{0} ๆๅฏนๅบ็่ตๆบใ";
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The BasicLayout class arranges the layout elements according to their individual settings,
     * independent of each-other. BasicLayout, also called absolute layout, requires that you
     * explicitly position each container child.
     * You can use the <code>x</code> and <code>y</code> properties of the child,
     * or constraints to position each child.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/BasicLayoutExample.ts
     * @language en_US
     */
    /**
     * BasicLayout ็ฑปๆนๆฎๅถๅไธช่ฎพ็ฝฎๅฝผๆญค็ฌ็ซๅฐๆๅๅธๅฑๅ็ดใ
     * BasicLayout๏ผไน็งฐไธบ็ปๅฏนๅธๅฑ๏ผ่ฆๆฑๆพๅผๅฎไฝๆฏไธชๅฎนๅจๅญไปฃใ
     * ๅฏไปฅไฝฟ็จๅญไปฃ็ <code>x</code> ๅ <code>y</code> ๅฑๆง๏ผๆไฝฟ็จ็บฆๆๆฅๅฎไฝๆฏไธชๅญไปฃใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/BasicLayoutExample.ts
     * @language zh_CN
     */
    var BasicLayout = (function (_super) {
        __extends(BasicLayout, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function BasicLayout() {
            return _super.call(this) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BasicLayout.prototype.measure = function () {
            _super.prototype.measure.call(this);
            eui.sys.measure(this.$target);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        BasicLayout.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            var target = this.$target;
            var pos = eui.sys.updateDisplayList(target, unscaledWidth, unscaledHeight);
            target.setContentSize(Math.ceil(pos.x), Math.ceil(pos.y));
        };
        return BasicLayout;
    }(eui.LayoutBase));
    eui.BasicLayout = BasicLayout;
    __reflect(BasicLayout.prototype, "eui.BasicLayout");
    if (true) {
        Object.defineProperty(BasicLayout.prototype, "useVirtualLayout", {
            /**
             * ๆญคๅธๅฑไธๆฏๆ่ๆๅธๅฑ๏ผ่ฎพ็ฝฎ่ฟไธชๅฑๆงๆๆ
             */
            get: function () {
                return this.$useVirtualLayout;
            },
            set: function (value) {
                egret.$error(2201);
            },
            enumerable: true,
            configurable: true
        });
    }
})(eui || (eui = {}));
(function (eui) {
    var sys;
    (function (sys) {
        var UIComponentClass = "eui.UIComponent";
        /**
         * @private
         * @param value ่ฆๆผๅผๅ็็ธๅฏนๅผ
         * @param total ๅจๆญคๅผๆนๅไธ็ๆป้ฟๅบฆ
         */
        function formatRelative(value, total) {
            if (!value || typeof value == "number") {
                return value;
            }
            var str = value;
            var index = str.indexOf("%");
            if (index == -1) {
                return +str;
            }
            var percent = +str.substring(0, index);
            return percent * 0.01 * total;
        }
        /**
         * @private
         * ไธไธชๅทฅๅทๆนๆณ๏ผไฝฟ็จBasicLayout่งๅๆต้็ฎๆๅฏน่ฑกใ
         */
        function measure(target) {
            if (!target) {
                return;
            }
            var width = 0;
            var height = 0;
            var bounds = egret.$TempRectangle;
            var count = target.numChildren;
            for (var i = 0; i < count; i++) {
                var layoutElement = (target.getChildAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                var values = layoutElement.$UIComponent;
                var hCenter = +values[4 /* horizontalCenter */];
                var vCenter = +values[5 /* verticalCenter */];
                var left = +values[0 /* left */];
                var right = +values[1 /* right */];
                var top_1 = +values[2 /* top */];
                var bottom = +values[3 /* bottom */];
                var extX = void 0;
                var extY = void 0;
                layoutElement.getPreferredBounds(bounds);
                if (!isNaN(left) && !isNaN(right)) {
                    extX = left + right;
                }
                else if (!isNaN(hCenter)) {
                    extX = Math.abs(hCenter) * 2;
                }
                else if (!isNaN(left) || !isNaN(right)) {
                    extX = isNaN(left) ? 0 : left;
                    extX += isNaN(right) ? 0 : right;
                }
                else {
                    extX = bounds.x;
                }
                if (!isNaN(top_1) && !isNaN(bottom)) {
                    extY = top_1 + bottom;
                }
                else if (!isNaN(vCenter)) {
                    extY = Math.abs(vCenter) * 2;
                }
                else if (!isNaN(top_1) || !isNaN(bottom)) {
                    extY = isNaN(top_1) ? 0 : top_1;
                    extY += isNaN(bottom) ? 0 : bottom;
                }
                else {
                    extY = bounds.y;
                }
                var preferredWidth = bounds.width;
                var preferredHeight = bounds.height;
                width = Math.ceil(Math.max(width, extX + preferredWidth));
                height = Math.ceil(Math.max(height, extY + preferredHeight));
            }
            target.setMeasuredSize(width, height);
        }
        sys.measure = measure;
        /**
         * @private
         * ไธไธชๅทฅๅทๆนๆณ๏ผไฝฟ็จBasicLayout่งๅๅธๅฑ็ฎๆๅฏน่ฑกใ
         */
        function updateDisplayList(target, unscaledWidth, unscaledHeight) {
            if (!target)
                return;
            var count = target.numChildren;
            var maxX = 0;
            var maxY = 0;
            var bounds = egret.$TempRectangle;
            for (var i = 0; i < count; i++) {
                var layoutElement = (target.getChildAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                var values = layoutElement.$UIComponent;
                var hCenter = formatRelative(values[4 /* horizontalCenter */], unscaledWidth * 0.5);
                var vCenter = formatRelative(values[5 /* verticalCenter */], unscaledHeight * 0.5);
                var left = formatRelative(values[0 /* left */], unscaledWidth);
                var right = formatRelative(values[1 /* right */], unscaledWidth);
                var top_2 = formatRelative(values[2 /* top */], unscaledHeight);
                var bottom = formatRelative(values[3 /* bottom */], unscaledHeight);
                var percentWidth = values[6 /* percentWidth */];
                var percentHeight = values[7 /* percentHeight */];
                var childWidth = NaN;
                var childHeight = NaN;
                if (!isNaN(left) && !isNaN(right)) {
                    childWidth = unscaledWidth - right - left;
                }
                else if (!isNaN(percentWidth)) {
                    childWidth = Math.round(unscaledWidth * Math.min(percentWidth * 0.01, 1));
                }
                if (!isNaN(top_2) && !isNaN(bottom)) {
                    childHeight = unscaledHeight - bottom - top_2;
                }
                else if (!isNaN(percentHeight)) {
                    childHeight = Math.round(unscaledHeight * Math.min(percentHeight * 0.01, 1));
                }
                layoutElement.setLayoutBoundsSize(childWidth, childHeight);
                layoutElement.getLayoutBounds(bounds);
                var elementWidth = bounds.width;
                var elementHeight = bounds.height;
                var childX = NaN;
                var childY = NaN;
                if (!isNaN(hCenter))
                    childX = Math.round((unscaledWidth - elementWidth) / 2 + hCenter);
                else if (!isNaN(left))
                    childX = left;
                else if (!isNaN(right))
                    childX = unscaledWidth - elementWidth - right;
                else
                    childX = bounds.x;
                if (!isNaN(vCenter))
                    childY = Math.round((unscaledHeight - elementHeight) / 2 + vCenter);
                else if (!isNaN(top_2))
                    childY = top_2;
                else if (!isNaN(bottom))
                    childY = unscaledHeight - elementHeight - bottom;
                else
                    childY = bounds.y;
                layoutElement.setLayoutBoundsPosition(childX, childY);
                maxX = Math.max(maxX, childX + elementWidth);
                maxY = Math.max(maxY, childY + elementHeight);
            }
            return egret.$TempPoint.setTo(maxX, maxY);
        }
        sys.updateDisplayList = updateDisplayList;
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The ColumnAlign class defines the possible values for the
     * <code>columnAlign</code> property of the TileLayout class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/ColumnAlignExample.ts
     * @language en_US
     */
    /**
     * ColumnAlign ็ฑปไธบ TileLayout ็ฑป็ <code>columnAlign</code> ๅฑๆงๅฎไนๅฏ่ฝ็ๅผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/ColumnAlignExample.ts
     * @language zh_CN
     */
    var ColumnAlign = (function () {
        function ColumnAlign() {
        }
        /**
         * Do not justify the rows.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธๅฐ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ColumnAlign.LEFT = "left";
        /**
         * Justify the rows by increasing the vertical gap.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟๅขๅคงๆฐดๅนณ้ด้ๅฐ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ColumnAlign.JUSTIFY_USING_GAP = "justifyUsingGap";
        /**
         * Justify the rows by increasing the row height.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟๅขๅคง่ก้ซๅบฆๅฐ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        ColumnAlign.JUSTIFY_USING_WIDTH = "justifyUsingWidth";
        return ColumnAlign;
    }());
    eui.ColumnAlign = ColumnAlign;
    __reflect(ColumnAlign.prototype, "eui.ColumnAlign");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var UIComponentClass = "eui.UIComponent";
    /**
     * The HorizontalLayout class arranges the layout elements in a horizontal sequence,
     * left to right, with optional gaps between the elements and optional padding
     * around the elements.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/HorizontalLayoutExample.ts
     * @language en_US
     */
    /**
     * HorizontalLayout ็ฑปๆๆฐดๅนณ้กบๅบไปๅทฆๅฐๅณๆๅๅธๅฑๅ็ด๏ผๅจๅ็ดๅๅด็ปๅ็ด็ๅฏ้ๅกซๅไน้ดๅธฆๆๅฏ้้ด้ใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/HorizontalLayoutExample.ts
     * @language zh_CN
     */
    var HorizontalLayout = (function (_super) {
        __extends(HorizontalLayout, _super);
        function HorizontalLayout() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.measureReal = function () {
            var target = this.$target;
            var count = target.numElements;
            var numElements = count;
            var measuredWidth = 0;
            var measuredHeight = 0;
            var bounds = egret.$TempRectangle;
            for (var i = 0; i < count; i++) {
                var layoutElement = (target.getElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    numElements--;
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                measuredWidth += bounds.width;
                measuredHeight = Math.max(measuredHeight, bounds.height);
            }
            measuredWidth += (numElements - 1) * this.$gap;
            var hPadding = this.$paddingLeft + this.$paddingRight;
            var vPadding = this.$paddingTop + this.$paddingBottom;
            target.setMeasuredSize(measuredWidth + hPadding, measuredHeight + vPadding);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.measureVirtual = function () {
            var target = this.$target;
            var typicalWidth = this.$typicalWidth;
            var measuredWidth = this.getElementTotalSize();
            var measuredHeight = Math.max(this.maxElementSize, this.$typicalHeight);
            var bounds = egret.$TempRectangle;
            var endIndex = this.endIndex;
            var elementSizeTable = this.elementSizeTable;
            for (var index = this.startIndex; index < endIndex; index++) {
                var layoutElement = (target.getElementAt(index));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                measuredWidth += bounds.width;
                measuredWidth -= isNaN(elementSizeTable[index]) ? typicalWidth : elementSizeTable[index];
                measuredHeight = Math.max(measuredHeight, bounds.height);
            }
            var hPadding = this.$paddingLeft + this.$paddingRight;
            var vPadding = this.$paddingTop + this.$paddingBottom;
            target.setMeasuredSize(measuredWidth + hPadding, measuredHeight + vPadding);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.updateDisplayListReal = function (width, height) {
            var target = this.$target;
            var paddingL = this.$paddingLeft;
            var paddingR = this.$paddingRight;
            var paddingT = this.$paddingTop;
            var paddingB = this.$paddingBottom;
            var gap = this.$gap;
            var targetWidth = Math.max(0, width - paddingL - paddingR);
            var targetHeight = Math.max(0, height - paddingT - paddingB);
            var hJustify = this.$horizontalAlign == eui.JustifyAlign.JUSTIFY;
            var vJustify = this.$verticalAlign == eui.JustifyAlign.JUSTIFY || this.$verticalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var vAlign = 0;
            if (!vJustify) {
                if (this.$verticalAlign == egret.VerticalAlign.MIDDLE) {
                    vAlign = 0.5;
                }
                else if (this.$verticalAlign == egret.VerticalAlign.BOTTOM) {
                    vAlign = 1;
                }
            }
            var count = target.numElements;
            var numElements = count;
            var x = paddingL;
            var y = paddingT;
            var i;
            var layoutElement;
            var totalPreferredWidth = 0;
            var totalPercentWidth = 0;
            var childInfoArray = [];
            var childInfo;
            var widthToDistribute = targetWidth;
            var maxElementHeight = this.maxElementSize;
            var bounds = egret.$TempRectangle;
            for (i = 0; i < count; i++) {
                var layoutElement_1 = (target.getElementAt(i));
                if (!egret.is(layoutElement_1, UIComponentClass) || !layoutElement_1.$includeInLayout) {
                    numElements--;
                    continue;
                }
                layoutElement_1.getPreferredBounds(bounds);
                maxElementHeight = Math.max(maxElementHeight, bounds.height);
                if (hJustify) {
                    totalPreferredWidth += bounds.width;
                }
                else {
                    var values = layoutElement_1.$UIComponent;
                    if (!isNaN(values[6 /* percentWidth */])) {
                        totalPercentWidth += values[6 /* percentWidth */];
                        childInfo = new eui.sys.ChildInfo();
                        childInfo.layoutElement = layoutElement_1;
                        childInfo.percent = values[6 /* percentWidth */];
                        childInfo.min = values[12 /* minWidth */];
                        childInfo.max = values[13 /* maxWidth */];
                        childInfoArray.push(childInfo);
                    }
                    else {
                        widthToDistribute -= bounds.width;
                    }
                }
            }
            widthToDistribute -= gap * (numElements - 1);
            widthToDistribute = widthToDistribute > 0 ? widthToDistribute : 0;
            var excessSpace = targetWidth - totalPreferredWidth - gap * (numElements - 1);
            var averageWidth;
            var largeChildrenCount = numElements;
            var widthDic = {};
            if (hJustify) {
                if (excessSpace < 0) {
                    averageWidth = widthToDistribute / numElements;
                    for (i = 0; i < count; i++) {
                        layoutElement = (target.getElementAt(i));
                        if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                            continue;
                        }
                        layoutElement.getPreferredBounds(bounds);
                        if (bounds.width <= averageWidth) {
                            widthToDistribute -= bounds.width;
                            largeChildrenCount--;
                            continue;
                        }
                    }
                    widthToDistribute = widthToDistribute > 0 ? widthToDistribute : 0;
                }
            }
            else {
                if (totalPercentWidth > 0) {
                    this.flexChildrenProportionally(targetWidth, widthToDistribute, totalPercentWidth, childInfoArray);
                    var roundOff_1 = 0;
                    var length_32 = childInfoArray.length;
                    for (i = 0; i < length_32; i++) {
                        childInfo = childInfoArray[i];
                        var childSize = Math.round(childInfo.size + roundOff_1);
                        roundOff_1 += childInfo.size - childSize;
                        widthDic[childInfo.layoutElement.$hashCode] = childSize;
                        widthToDistribute -= childSize;
                    }
                    widthToDistribute = widthToDistribute > 0 ? widthToDistribute : 0;
                }
            }
            if (this.$horizontalAlign == egret.HorizontalAlign.CENTER) {
                x = paddingL + widthToDistribute * 0.5;
            }
            else if (this.$horizontalAlign == egret.HorizontalAlign.RIGHT) {
                x = paddingL + widthToDistribute;
            }
            var maxX = paddingL;
            var maxY = paddingT;
            var dx = 0;
            var dy = 0;
            var justifyHeight = Math.ceil(targetHeight);
            if (this.$verticalAlign == eui.JustifyAlign.CONTENT_JUSTIFY)
                justifyHeight = Math.ceil(Math.max(targetHeight, maxElementHeight));
            var roundOff = 0;
            var layoutElementWidth;
            var childWidth;
            for (i = 0; i < count; i++) {
                var exceesHeight = 0;
                layoutElement = (target.getElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                layoutElementWidth = NaN;
                if (hJustify) {
                    childWidth = NaN;
                    if (excessSpace > 0) {
                        childWidth = widthToDistribute * bounds.width / totalPreferredWidth;
                    }
                    else if (excessSpace < 0 && bounds.width > averageWidth) {
                        childWidth = widthToDistribute / largeChildrenCount;
                    }
                    if (!isNaN(childWidth)) {
                        layoutElementWidth = Math.round(childWidth + roundOff);
                        roundOff += childWidth - layoutElementWidth;
                    }
                }
                else {
                    layoutElementWidth = widthDic[layoutElement.$hashCode];
                }
                if (vJustify) {
                    y = paddingT;
                    layoutElement.setLayoutBoundsSize(layoutElementWidth, justifyHeight);
                    layoutElement.getLayoutBounds(bounds);
                }
                else {
                    var layoutElementHeight = NaN;
                    var values = layoutElement.$UIComponent;
                    if (!isNaN(layoutElement.percentHeight)) {
                        var percent = Math.min(100, values[7 /* percentHeight */]);
                        layoutElementHeight = Math.round(targetHeight * percent * 0.01);
                    }
                    layoutElement.setLayoutBoundsSize(layoutElementWidth, layoutElementHeight);
                    layoutElement.getLayoutBounds(bounds);
                    exceesHeight = (targetHeight - bounds.height) * vAlign;
                    exceesHeight = exceesHeight > 0 ? exceesHeight : 0;
                    y = paddingT + exceesHeight;
                }
                layoutElement.setLayoutBoundsPosition(Math.round(x), Math.round(y));
                dx = Math.ceil(bounds.width);
                dy = Math.ceil(bounds.height);
                maxX = Math.max(maxX, x + dx);
                maxY = Math.max(maxY, y + dy);
                x += dx + gap;
            }
            this.maxElementSize = maxElementHeight;
            target.setContentSize(maxX + paddingR, maxY + paddingB);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.updateDisplayListVirtual = function (width, height) {
            var target = this.$target;
            if (this.indexInViewCalculated)
                this.indexInViewCalculated = false;
            else
                this.getIndexInView();
            var paddingR = this.$paddingRight;
            var paddingT = this.$paddingTop;
            var paddingB = this.$paddingBottom;
            var gap = this.$gap;
            var contentWidth;
            var numElements = target.numElements;
            if (this.startIndex == -1 || this.endIndex == -1) {
                contentWidth = this.getStartPosition(numElements) - gap + paddingR;
                target.setContentSize(contentWidth, target.contentHeight);
                return;
            }
            var endIndex = this.endIndex;
            target.setVirtualElementIndicesInView(this.startIndex, endIndex);
            //่ทๅๅ็ดๅธๅฑๅๆฐ
            var justify = this.$verticalAlign == eui.JustifyAlign.JUSTIFY || this.$verticalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var contentJustify = this.$verticalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var vAlign = 0;
            if (!justify) {
                if (this.$verticalAlign == egret.VerticalAlign.MIDDLE) {
                    vAlign = 0.5;
                }
                else if (this.$verticalAlign == egret.VerticalAlign.BOTTOM) {
                    vAlign = 1;
                }
            }
            var bounds = egret.$TempRectangle;
            var targetHeight = Math.max(0, height - paddingT - paddingB);
            var justifyHeight = Math.ceil(targetHeight);
            var layoutElement;
            var typicalHeight = this.$typicalHeight;
            var typicalWidth = this.$typicalWidth;
            var maxElementHeight = this.maxElementSize;
            var oldMaxH = Math.max(typicalHeight, this.maxElementSize);
            if (contentJustify) {
                for (var index = this.startIndex; index <= endIndex; index++) {
                    layoutElement = (target.getVirtualElementAt(index));
                    if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                        continue;
                    }
                    layoutElement.getPreferredBounds(bounds);
                    maxElementHeight = Math.max(maxElementHeight, bounds.height);
                }
                justifyHeight = Math.ceil(Math.max(targetHeight, maxElementHeight));
            }
            var x = 0;
            var y = 0;
            var contentHeight = 0;
            var oldElementSize;
            var needInvalidateSize = false;
            var elementSizeTable = this.elementSizeTable;
            //ๅฏนๅฏ่งๅบๅ่ฟ่กๅธๅฑ
            for (var i = this.startIndex; i <= endIndex; i++) {
                var exceesHeight = 0;
                layoutElement = (target.getVirtualElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                if (!contentJustify) {
                    maxElementHeight = Math.max(maxElementHeight, bounds.height);
                }
                if (justify) {
                    y = paddingT;
                    layoutElement.setLayoutBoundsSize(NaN, justifyHeight);
                    layoutElement.getLayoutBounds(bounds);
                }
                else {
                    layoutElement.getLayoutBounds(bounds);
                    exceesHeight = (targetHeight - bounds.height) * vAlign;
                    exceesHeight = exceesHeight > 0 ? exceesHeight : 0;
                    y = paddingT + exceesHeight;
                }
                contentHeight = Math.max(contentHeight, bounds.height);
                if (!needInvalidateSize) {
                    oldElementSize = isNaN(elementSizeTable[i]) ? typicalWidth : elementSizeTable[i];
                    if (oldElementSize != bounds.width)
                        needInvalidateSize = true;
                }
                elementSizeTable[i] = bounds.width;
                x = this.getStartPosition(i);
                layoutElement.setLayoutBoundsPosition(Math.round(x), Math.round(y));
            }
            contentHeight += paddingT + paddingB;
            contentWidth = this.getStartPosition(numElements) - gap + paddingR;
            this.maxElementSize = maxElementHeight;
            target.setContentSize(contentWidth, contentHeight);
            if (needInvalidateSize || oldMaxH < this.maxElementSize) {
                target.invalidateSize();
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.getStartPosition = function (index) {
            if (!this.$useVirtualLayout) {
                if (this.$target) {
                    var element = this.$target.getElementAt(index);
                    if (element) {
                        return element.x;
                    }
                }
            }
            var typicalWidth = this.$typicalWidth;
            var startPos = this.$paddingLeft;
            var gap = this.$gap;
            var elementSizeTable = this.elementSizeTable;
            for (var i = 0; i < index; i++) {
                var w = elementSizeTable[i];
                if (isNaN(w)) {
                    w = typicalWidth;
                }
                startPos += w + gap;
            }
            return startPos;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.getElementSize = function (index) {
            if (this.$useVirtualLayout) {
                var size = this.elementSizeTable[index];
                if (isNaN(size)) {
                    size = this.$typicalWidth;
                }
                return size;
            }
            if (this.$target) {
                return this.$target.getElementAt(index).width;
            }
            return 0;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.getElementTotalSize = function () {
            var typicalWidth = this.$typicalWidth;
            var gap = this.$gap;
            var totalSize = 0;
            var length = this.$target.numElements;
            var elementSizeTable = this.elementSizeTable;
            for (var i = 0; i < length; i++) {
                var w = elementSizeTable[i];
                if (isNaN(w)) {
                    w = typicalWidth;
                }
                totalSize += w + gap;
            }
            totalSize -= gap;
            return totalSize;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.elementAdded = function (index) {
            if (!this.useVirtualLayout)
                return;
            _super.prototype.elementAdded.call(this, index);
            this.elementSizeTable.splice(index, 0, this.$typicalWidth);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HorizontalLayout.prototype.getIndexInView = function () {
            var target = this.$target;
            if (!target || target.numElements == 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var values = target.$UIComponent;
            if (values[10 /* width */] <= 0 || values[11 /* height */] <= 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var numElements = target.numElements;
            var contentWidth = this.getStartPosition(numElements - 1) +
                this.elementSizeTable[numElements - 1] + this.$paddingRight;
            var minVisibleX = target.scrollH;
            if (minVisibleX > contentWidth - this.$paddingRight) {
                this.startIndex = -1;
                this.endIndex = -1;
                return false;
            }
            var maxVisibleX = target.scrollH + values[10 /* width */];
            if (maxVisibleX < this.$paddingLeft) {
                this.startIndex = -1;
                this.endIndex = -1;
                return false;
            }
            var oldStartIndex = this.startIndex;
            var oldEndIndex = this.endIndex;
            this.startIndex = this.findIndexAt(minVisibleX, 0, numElements - 1);
            if (this.startIndex == -1)
                this.startIndex = 0;
            this.endIndex = this.findIndexAt(maxVisibleX, 0, numElements - 1);
            if (this.endIndex == -1)
                this.endIndex = numElements - 1;
            return oldStartIndex != this.startIndex || oldEndIndex != this.endIndex;
        };
        return HorizontalLayout;
    }(eui.LinearLayoutBase));
    eui.HorizontalLayout = HorizontalLayout;
    __reflect(HorizontalLayout.prototype, "eui.HorizontalLayout");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The JustifyAlign class defines the possible values for the
     * <code>horizontalAlign</code> ๅ <code>verticalAlign</code> property of
     * Layout class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/JustifyAlignExample.ts
     * @language en_US
     */
    /**
     * JustifyAlign ๅฎไนๅธๅฑ็ฑปไธญ horizontalAlign ไธ verticalAlign ๅฑๆง้่ฆ็ไธค็ซฏๅฏน้ฝๅธธ้ๅผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/JustifyAlignExample.ts
     * @language zh_CN
     */
    var JustifyAlign = (function () {
        function JustifyAlign() {
        }
        /**
         * Justify the children with respect to the container.
         * This uniformly sizes all children to be the same size as the
         * container.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ธๅฏนไบๅฎนๅจๅฏน้ฝๅญไปฃใ่ฟไผๅฐๆๆๅญไปฃ็ๅคงๅฐ็ปไธ่ฐๆดไธบไธๅฎนๅจ็ธๅ็ๅฐบๅฏธใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        JustifyAlign.JUSTIFY = "justify";
        /**
         * Content justify the children width/height respect to the container.
         * This uniformly sizes all children to be the content width/height of the container.
         * The content width/height of the container is the size of the largest child.
         * If all children are smaller than the width/height of the container, then
         * all the children will be sized to the width/height of the container.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ธๅฏนไบๅฎนๅจๅฏนๅญไปฃ่ฟ่กๅๅฎนๅฏน้ฝใ่ฟไผๅฐๆๆๅญไปฃ็ๅคงๅฐ็ปไธ่ฐๆดไธบๅฎนๅจ็ๅๅฎนๅฎฝๅบฆ/้ซๅบฆใ
         * ๅฎนๅจ็ๅๅฎนๅฎฝๅบฆ/้ซๅบฆๆฏๆๅคงๅญไปฃ็ๅคงๅฐใๅฆๆๆๆๅญไปฃ้ฝๅฐไบๅฎนๅจ็ๅฎฝๅบฆ/้ซๅบฆ๏ผๅไผๅฐๆๆๅญไปฃ็ๅคงๅฐ่ฐๆดไธบๅฎนๅจ็ๅฎฝๅบฆ/้ซๅบฆใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        JustifyAlign.CONTENT_JUSTIFY = "contentJustify";
        return JustifyAlign;
    }());
    eui.JustifyAlign = JustifyAlign;
    __reflect(JustifyAlign.prototype, "eui.JustifyAlign");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The RowAlign class defines the possible values for the
     * <code>rowAlign</code> property of the TileLayout class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/RowAlignExample.ts
     * @language en_US
     */
    /**
     * RowAlign ็ฑปไธบ TileLayout ็ฑป็ <code>rowAlign</code> ๅฑๆงๅฎไนๅฏ่ฝ็ๅผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/RowAlignExample.ts
     * @language zh_CN
     */
    var RowAlign = (function () {
        function RowAlign() {
        }
        /**
         * Do not justify the rows.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ไธ่ฟ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        RowAlign.TOP = "top";
        /**
         * Justify the rows by increasing the vertical gap.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟๅขๅคงๅ็ด้ด้ๅฐ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        RowAlign.JUSTIFY_USING_GAP = "justifyUsingGap";
        /**
         * Justify the rows by increasing the row height.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่ฟๅขๅคง่ก้ซๅบฆๅฐ่กไธค็ซฏๅฏน้ฝใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        RowAlign.JUSTIFY_USING_HEIGHT = "justifyUsingHeight";
        return RowAlign;
    }());
    eui.RowAlign = RowAlign;
    __reflect(RowAlign.prototype, "eui.RowAlign");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var UIComponentClass = "eui.UIComponent";
    /**
     * The TileLayout class arranges layout elements in columns and rows
     * of equally-sized cells.
     * The TileLayout class uses a number of properties that control orientation,
     * count, size, gap and justification of the columns and the rows
     * as well as element alignment within the cells.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/TileLayoutExample.ts
     * @language en_US
     */
    /**
     * TileLayout ็ฑปๅจๅๅๆผๅคงๅฐ็ธ็ญ็ๅๅ่กไธญๆๅๅธๅฑๅ็ดใ
     * TileLayout ็ฑปไฝฟ็จ่ฎธๅคๅฑๆงๆฅๆงๅถๅๅ่ก็ๆนๅใ่ฎกๆฐใๅคงๅฐใ้ด้ๅไธค็ซฏๅฏน้ฝไปฅๅๅๅๆผๅ็ๅ็ดๅฏน้ฝใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/TileLayoutExample.ts
     * @language zh_CN
     */
    var TileLayout = (function (_super) {
        __extends(TileLayout, _super);
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆ้ๅฝๆฐใ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function TileLayout() {
            var _this = _super.call(this) || this;
            /**
             * @private
             * ๆ่ฎฐhorizontalGap่ขซๆพๅผๆๅฎ่ฟ
             */
            _this.explicitHorizontalGap = NaN;
            /**
             * @private
             */
            _this._horizontalGap = 6;
            /**
             * @private
             * ๆ่ฎฐverticalGap่ขซๆพๅผๆๅฎ่ฟ
             */
            _this.explicitVerticalGap = NaN;
            /**
             * @private
             */
            _this._verticalGap = 6;
            /**
             * @private
             */
            _this._columnCount = -1;
            /**
             * @private
             */
            _this._requestedColumnCount = 0;
            /**
             * @private
             */
            _this._rowCount = -1;
            /**
             * @private
             */
            _this._requestedRowCount = 0;
            /**
             * @private
             * ๅค้จๆพๅผๆๅฎ็ๅๅฎฝ
             */
            _this.explicitColumnWidth = NaN;
            /**
             * @private
             */
            _this._columnWidth = NaN;
            /**
             * @private
             * ๅค้จๆพๅผๆๅฎ็่ก้ซ
             */
            _this.explicitRowHeight = NaN;
            /**
             * @private
             */
            _this._rowHeight = NaN;
            /**
             * @private
             */
            _this._paddingLeft = 0;
            /**
             * @private
             */
            _this._paddingRight = 0;
            /**
             * @private
             */
            _this._paddingTop = 0;
            /**
             * @private
             */
            _this._paddingBottom = 0;
            /**
             * @private
             */
            _this._horizontalAlign = eui.JustifyAlign.JUSTIFY;
            /**
             * @private
             */
            _this._verticalAlign = eui.JustifyAlign.JUSTIFY;
            /**
             * @private
             */
            _this._columnAlign = eui.ColumnAlign.LEFT;
            /**
             * @private
             */
            _this._rowAlign = eui.RowAlign.TOP;
            /**
             * @private
             */
            _this._orientation = eui.TileOrientation.ROWS;
            /**
             * @private
             * ็ผๅญ็ๆๅคงๅญๅฏน่ฑกๅฎฝๅบฆ
             */
            _this.maxElementWidth = 0;
            /**
             * @private
             * ็ผๅญ็ๆๅคงๅญๅฏน่ฑก้ซๅบฆ
             */
            _this.maxElementHeight = 0;
            /**
             * @private
             * ๅฝๅ่งๅพไธญ็็ฌฌไธไธชๅ็ด็ดขๅผ
             */
            _this.startIndex = -1;
            /**
             * @private
             * ๅฝๅ่งๅพไธญ็ๆๅไธไธชๅ็ด็็ดขๅผ
             */
            _this.endIndex = -1;
            /**
             * @private
             * ่งๅพ็็ฌฌไธไธชๅๆๅไธไธชๅ็ด็็ดขๅผๅผๅทฒ็ป่ฎก็ฎๅฅฝ็ๆๅฟ
             */
            _this.indexInViewCalculated = false;
            return _this;
        }
        Object.defineProperty(TileLayout.prototype, "horizontalGap", {
            /**
             * Horizontal space between columns, in pixels.
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅไน้ด็ๆฐดๅนณ็ฉบ้ด๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._horizontalGap;
            },
            set: function (value) {
                value = +value;
                if (value === this._horizontalGap)
                    return;
                this.explicitHorizontalGap = value;
                this._horizontalGap = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "verticalGap", {
            /**
             * Vertical space between rows, in pixels.
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่กไน้ด็ๅ็ด็ฉบ้ด๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             *
             * @default 6
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._verticalGap;
            },
            set: function (value) {
                value = +value;
                if (value === this._verticalGap)
                    return;
                this.explicitVerticalGap = value;
                this._verticalGap = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "columnCount", {
            /**
             * Contain the actual column count.
             *
             * @default -1
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             *  ๅฎ้ๅ่ฎกๆฐใ
             *
             * @default -1
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._columnCount;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "requestedColumnCount", {
            /**
             * Number of columns to be displayed.
             * <p>Set to 0 to allow the TileLayout to determine
             * the column count automatically.</p>
             * <p>If the <code>orientation</code> property is set to <code>TileOrientation.ROWS</code>,
             * then setting this property has no effect
             * In this case, the <code>rowCount</code> is explicitly set, and the
             * container width is explicitly set. </p>
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๆพ็คบ็ๅๆฐใ
             * <p>่ฎพ็ฝฎไธบ 0 ไผๅ่ฎธ TileLayout ่ชๅจ็กฎๅฎๅ่ฎกๆฐใ</p>
             * <p>ๅฆๆๅฐ <code>orientation</code> ๅฑๆง่ฎพ็ฝฎไธบ <code>TileOrientation.ROWS</code>๏ผ
             * ๅ่ฎพ็ฝฎๆญคๅฑๆงไธไผไบง็ไปปไฝๆๆใ่ฟ็งๆๅตไธ๏ผไผๆพๅผ่ฎพ็ฝฎ code>rowCount</code>๏ผๅนถๆพๅผ่ฎพ็ฝฎๅฎนๅจๅฎฝๅบฆใ</p>
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._requestedColumnCount;
            },
            set: function (value) {
                value = +value || 0;
                if (this._requestedColumnCount === value)
                    return;
                this._requestedColumnCount = value;
                this._columnCount = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "rowCount", {
            /**
             * The row count.
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             *  ่ก่ฎกๆฐใ
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._rowCount;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "requestedRowCount", {
            /**
             * Number of rows to be displayed.
             * <p>Set to 0 to remove explicit override and allow the TileLayout to determine
             * the row count automatically.</p>
             * <p>If the <code>orientation</code> property is set to
             * <code>TileOrientation.COLUMNS</code>, setting this property has no effect.
             * in this case, <code>columnCount</code> is explicitly set, and the
             * container height is explicitly set.</p>
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ฆๆพ็คบ็่กๆฐใ
             * <code>่ฎพ็ฝฎไธบ -1 ไผๅ้คๆพๅผ่ฆ็ๅนถๅ่ฎธ TileLayout ่ชๅจ็กฎๅฎ่ก่ฎกๆฐใ</code>
             * <code>ๅฆๆๅฐ <code>orientation</code> ๅฑๆง่ฎพ็ฝฎไธบ <code>TileOrientation.COLUMNS</code>๏ผ
             * ๅ่ฎพ็ฝฎๆญคๅฑๆงไธไผไบง็ไปปไฝๆๆใ่ฟ็งๆๅตไธ๏ผไผๆพๅผ่ฎพ็ฝฎ <code>columnCount</code>๏ผๅนถๆพๅผ่ฎพ็ฝฎๅฎนๅจ้ซๅบฆใ</code>
             *
             * @default 0
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._requestedRowCount;
            },
            set: function (value) {
                value = +value || 0;
                if (this._requestedRowCount == value)
                    return;
                this._requestedRowCount = value;
                this._rowCount = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "columnWidth", {
            /**
             * Contain the actual column width, in pixels.
             * <p>If not explicitly set, the column width is
             * determined from the width of the widest element. </p>
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅๅซๅฎ้ๅๅฎฝ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * <p>่ฅๆชๆพๅผ่ฎพ็ฝฎ๏ผๅไปๆนๆฎๆๅฎฝ็ๅ็ด็ๅฎฝๅบฆ็กฎๅฎๅๅฎฝๅบฆใ</p>
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._columnWidth;
            },
            set: function (value) {
                value = +value;
                if (value === this._columnWidth)
                    return;
                this.explicitColumnWidth = value;
                this._columnWidth = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "rowHeight", {
            /**
             * The row height, in pixels.
             * <p>If not explicitly set, the row height is
             * determined from the maximum of elements' height.</p>
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ่ก้ซ๏ผไปฅๅ็ดไธบๅไฝ๏ผใ
             * <p>ๅฆๆๆชๆพๅผ่ฎพ็ฝฎ๏ผๅไปๅ็ด็้ซๅบฆ็ๆๅคงๅผ็กฎๅฎ่ก้ซๅบฆใ<p>
             *
             * @default NaN
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._rowHeight;
            },
            set: function (value) {
                value = +value;
                if (value === this._rowHeight)
                    return;
                this.explicitRowHeight = value;
                this._rowHeight = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "paddingLeft", {
            /**
             * @copy eui.LinearLayoutBase#paddingLeft
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this._paddingLeft;
            },
            set: function (value) {
                value = +value || 0;
                if (this._paddingLeft == value)
                    return;
                this._paddingLeft = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "paddingRight", {
            /**
             * @copy eui.LinearLayoutBase#paddingRight
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this._paddingRight;
            },
            set: function (value) {
                value = +value || 0;
                if (this._paddingRight === value)
                    return;
                this._paddingRight = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "paddingTop", {
            /**
             * @copy eui.LinearLayoutBase#paddingTop
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this._paddingTop;
            },
            set: function (value) {
                value = +value || 0;
                if (this._paddingTop == value)
                    return;
                this._paddingTop = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "paddingBottom", {
            /**
             * @copy eui.LinearLayoutBase#paddingBottom
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             */
            get: function () {
                return this._paddingBottom;
            },
            set: function (value) {
                value = +value || 0;
                if (this._paddingBottom === value)
                    return;
                this._paddingBottom = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "horizontalAlign", {
            /**
             * Specifies how to align the elements within the cells in the horizontal direction.
             * Supported values are
             * HorizontalAlign.LEFTใHorizontalAlign.CENTERใ
             * HorizontalAlign.RIGHTใJustifyAlign.JUSTIFYใ
             *
             * @default <code>JustifyAlign.JUSTIFY</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฎๅฆไฝๅจๆฐดๅนณๆนๅไธๅฏน้ฝๅๅๆผๅ็ๅ็ดใๆฏๆ็ๅผๆ
             * HorizontalAlign.LEFTใHorizontalAlign.CENTERใ
             * HorizontalAlign.RIGHTใJustifyAlign.JUSTIFYใ
             *
             * @default <code>JustifyAlign.JUSTIFY</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._horizontalAlign;
            },
            set: function (value) {
                if (this._horizontalAlign == value)
                    return;
                this._horizontalAlign = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "verticalAlign", {
            /**
             * ๆๅฎๅฆไฝๅจๅ็ดๆนๅไธๅฏน้ฝๅๅๆผๅ็ๅ็ดใ
             * ๆฏๆ็ๅผๆ VerticalAlign.TOPใVerticalAlign.MIDDLEใ
             * VerticalAlign.BOTTOMใJustifyAlign.JUSTIFYใ
             * ้ป่ฎคๅผ๏ผJustifyAlign.JUSTIFYใ
             *
             * @default <code>eui.JustifyAlign.JUSTIFY</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * Specifies how to align the elements within the cells in the vertical direction.
             * Supported values are
             * VerticalAlign.TOPใVerticalAlign.MIDDLEใ
             * VerticalAlign.BOTTOMใJustifyAlign.JUSTIFYใ
             *
             * @default <code>eui.JustifyAlign.JUSTIFY</code>
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._verticalAlign;
            },
            set: function (value) {
                if (this._verticalAlign == value)
                    return;
                this._verticalAlign = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "columnAlign", {
            /**
             * Specifies how to justify the fully visible columns to the container width.
             *
             * <p>When set to <code>ColumnAlign.LEFT</code> it turns column justification off.
             *  There may be partially visible columns or whitespace between the last column and
             *  the right edge of the container.  This is the default value.</p>
             *
             * <p>When set to <code>ColumnAlign.JUSTIFY_USING_GAP</code> the <code>horizontalGap</code>
             * actual value increases so that
             * the last fully visible column right edge aligns with the container's right edge.
             * In case there is only a single fully visible column, the <code>horizontalGap</code> actual value
             * increases so that it pushes any partially visible column beyond the right edge
             * of the container.
             * Note that explicitly setting the <code>horizontalGap</code> property does not turn off
             * justification. It only determines the initial gap value.
             * Justification may increases it.</p>
             *
             * <p>When set to <code>ColumnAlign.JUSTIFY_USING_WIDTH</code> the <code>columnWidth</code>
             * actual value increases so that
             * the last fully visible column right edge aligns with the container's right edge.
             * Note that explicitly setting the <code>columnWidth</code> property does not turn off justification.
             * It only determines the initial column width value.
             * Justification may increases it.</p>
             *
             * @default ColumnAlign.LEFT
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฎๅฆไฝๅฐๅฎๅจๅฏ่งๅไธๅฎนๅจๅฎฝๅบฆๅฏน้ฝใ
             *
             * <p>่ฎพ็ฝฎไธบ <code>ColumnAlign.LEFT</code> ๆถ๏ผๅฎไผๅณ้ญๅไธค็ซฏๅฏน้ฝใ
             * ๅจๅฎนๅจ็ๆๅไธๅๅๅณ่พน็ผไน้ดๅฏ่ฝๅญๅจ้จๅๅฏ่ง็ๅๆ็ฉบ็ฝใ่ฟๆฏ้ป่ฎคๅผใ</p>
             *
             * <p>่ฎพ็ฝฎไธบ <code>ColumnAlign.JUSTIFY_USING_GAP</code> ๆถ๏ผ<code>horizontalGap</code> ็ๅฎ้ๅผๅฐๅขๅคง๏ผ
             * ่ฟๆทๆๅไธไธชๅฎๅจๅฏ่งๅๅณ่พน็ผไผไธๅฎนๅจ็ๅณ่พน็ผๅฏน้ฝใไปๅญๅจไธไธชๅฎๅจๅฏ่งๅๆถ๏ผ
             * <code>horizontalGap</code> ็ๅฎ้ๅผๅฐๅขๅคง๏ผ่ฟๆทๅฎไผๅฐไปปไฝ้จๅๅฏ่งๅๆจๅฐๅฎนๅจ็ๅณ่พน็ผไนๅคใ
             * ่ฏทๆณจๆๆพๅผ่ฎพ็ฝฎ <code>horizontalGap</code> ๅฑๆงไธไผๅณ้ญไธค็ซฏๅฏน้ฝใๅฎไป็กฎๅฎๅๅง้ด้ๅผใไธค็ซฏๅฏน้ฝๅฏ่ฝไผๅขๅคงๅฎใ</p>
             *
             * <p>่ฎพ็ฝฎไธบ <code>ColumnAlign.JUSTIFY_USING_WIDTH</code> ๆถ๏ผ<code>columnWidth</code> ็ๅฎ้ๅผๅฐๅขๅคง๏ผ
             * ่ฟๆทๆๅไธไธชๅฎๅจๅฏ่งๅๅณ่พน็ผไผไธๅฎนๅจ็ๅณ่พน็ผๅฏน้ฝใ่ฏทๆณจๆๆพๅผ่ฎพ็ฝฎ <code>columnWidth</code> ๅฑๆงไธไผๅณ้ญไธค็ซฏๅฏน้ฝใ
             * ๅฎไป็กฎๅฎๅๅงๅๅฎฝๅบฆๅผใไธค็ซฏๅฏน้ฝๅฏ่ฝไผๅขๅคงๅฎใ</p>
             *
             * @default ColumnAlign.LEFT
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._columnAlign;
            },
            set: function (value) {
                if (this._columnAlign == value)
                    return;
                this._columnAlign = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "rowAlign", {
            /**
             * Specifies how to justify the fully visible rows to the container height.
             *
             * <p>When set to <code>RowAlign.TOP</code> it turns column justification off.
             * There might be partially visible rows or whitespace between the last row and
             * the bottom edge of the container.  This is the default value.</p>
             *
             * <p>When set to <code>RowAlign.JUSTIFY_USING_GAP</code> the <code>verticalGap</code>
             * actual value increases so that
             * the last fully visible row bottom edge aligns with the container's bottom edge.
             * In case there is only a single fully visible row, the value of <code>verticalGap</code>
             * increases so that it pushes any partially visible row beyond the bottom edge
             * of the container.  Note that explicitly setting the <code>verticalGap</code> does not turn off
             * justification, but just determines the initial gap value.
             * Justification can then increases it.</p>
             *
             * <p>When set to <code>RowAlign.JUSTIFY_USING_HEIGHT</code> the <code>rowHeight</code>
             * actual value increases so that
             * the last fully visible row bottom edge aligns with the container's bottom edge.  Note that
             * explicitly setting the <code>rowHeight</code> does not turn off justification, but
             * determines the initial row height value.
             * Justification can then increase it.</p>
             *
             * @default RowAlign.TOP
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฎๅฆไฝๅฐๅฎๅจๅฏ่ง่กไธๅฎนๅจ้ซๅบฆๅฏน้ฝใ
             *
             * <p>่ฎพ็ฝฎไธบ <code>RowAlign.TOP</code> ๆถ๏ผๅฎไผๅณ้ญๅไธค็ซฏๅฏน้ฝใ
             * ๅจๅฎนๅจ็ๆๅไธ่กๅๅบ่พน็ผไน้ดๅฏ่ฝๅญๅจ้จๅๅฏ่ง็่กๆ็ฉบ็ฝใ่ฟๆฏ้ป่ฎคๅผใ</p>
             *
             * <p>่ฎพ็ฝฎไธบ <code>RowAlign.JUSTIFY_USING_GAP</code> ๆถ๏ผ<code>verticalGap</code> ็ๅฎ้ๅผไผๅขๅคง๏ผ
             * ่ฟๆทๆๅไธไธชๅฎๅจๅฏ่ง่กๅบ่พน็ผไผไธๅฎนๅจ็ๅบ่พน็ผๅฏน้ฝใไปๅญๅจไธไธชๅฎๅจๅฏ่ง่กๆถ๏ผ<code>verticalGap</code> ็ๅผไผๅขๅคง๏ผ
             * ่ฟๆทๅฎไผๅฐไปปไฝ้จๅๅฏ่ง่กๆจๅฐๅฎนๅจ็ๅบ่พน็ผไนๅคใ่ฏทๆณจๆ๏ผๆพๅผ่ฎพ็ฝฎ <code>verticalGap</code>
             * ไธไผๅณ้ญไธค็ซฏๅฏน้ฝ๏ผ่ๅชๆฏ็กฎๅฎๅๅง้ด้ๅผใไธค็ซฏๅฏน้ฝๆฅ็ๅฏไปฅๅขๅคงๅฎใ</p>
             *
             * <p>่ฎพ็ฝฎไธบ <code>RowAlign.JUSTIFY_USING_HEIGHT</code> ๆถ๏ผ<code>rowHeight</code> ็ๅฎ้ๅผไผๅขๅคง๏ผ
             * ่ฟๆทๆๅไธไธชๅฎๅจๅฏ่ง่กๅบ่พน็ผไผไธๅฎนๅจ็ๅบ่พน็ผๅฏน้ฝใ่ฏทๆณจๆ๏ผๆพๅผ่ฎพ็ฝฎ <code>rowHeight</code>
             * ไธไผๅณ้ญไธค็ซฏๅฏน้ฝ๏ผ่ๅชๆฏ็กฎๅฎๅๅง่ก้ซๅบฆๅผใไธค็ซฏๅฏน้ฝๆฅ็ๅฏไปฅๅขๅคงๅฎใ</p>
             *
             * @default RowAlign.TOP
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._rowAlign;
            },
            set: function (value) {
                if (this._rowAlign == value)
                    return;
                this._rowAlign = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(TileLayout.prototype, "orientation", {
            /**
             * Specifies whether elements are arranged row by row or
             * column by column.
             *
             * @default TileOrientation.ROWS
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅฎๆฏ้่ก่ฟๆฏ้ๅๆๅๅ็ดใ
             *
             * @default TileOrientation.ROWS
             *
             * @version Egret 2.4
             * @version eui 1.0
             * @platform Web,Native
             * @language zh_CN
             */
            get: function () {
                return this._orientation;
            },
            set: function (value) {
                if (this._orientation == value)
                    return;
                this._orientation = value;
                this.invalidateTargetLayout();
            },
            enumerable: true,
            configurable: true
        });
        /**
         * @private
         * ๆ่ฎฐ็ฎๆๅฎนๅจ็ๅฐบๅฏธๅๆพ็คบๅ่กจๅคฑๆ
         */
        TileLayout.prototype.invalidateTargetLayout = function () {
            var target = this.$target;
            if (target) {
                target.invalidateSize();
                target.invalidateDisplayList();
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        TileLayout.prototype.measure = function () {
            var target = this.$target;
            if (!target)
                return;
            var savedColumnCount = this._columnCount;
            var savedRowCount = this._rowCount;
            var savedColumnWidth = this._columnWidth;
            var savedRowHeight = this._rowHeight;
            var measuredWidth = 0;
            var measuredHeight = 0;
            var values = target.$UIComponent;
            this.calculateRowAndColumn(values[8 /* explicitWidth */], values[9 /* explicitHeight */]);
            var columnCount = this._requestedColumnCount > 0 ? this._requestedColumnCount : this._columnCount;
            var rowCount = this._requestedRowCount > 0 ? this._requestedRowCount : this._rowCount;
            var horizontalGap = isNaN(this._horizontalGap) ? 0 : this._horizontalGap;
            var verticalGap = isNaN(this._verticalGap) ? 0 : this._verticalGap;
            if (columnCount > 0) {
                measuredWidth = columnCount * (this._columnWidth + horizontalGap) - horizontalGap;
            }
            if (rowCount > 0) {
                measuredHeight = rowCount * (this._rowHeight + verticalGap) - verticalGap;
            }
            var hPadding = this._paddingLeft + this._paddingRight;
            var vPadding = this._paddingTop + this._paddingBottom;
            target.setMeasuredSize(measuredWidth + hPadding, measuredHeight + vPadding);
            this._columnCount = savedColumnCount;
            this._rowCount = savedRowCount;
            this._columnWidth = savedColumnWidth;
            this._rowHeight = savedRowHeight;
        };
        /**
         * @private
         * ่ฎก็ฎ่กๅๅ็ๅฐบๅฏธๅๆฐ้
         */
        TileLayout.prototype.calculateRowAndColumn = function (explicitWidth, explicitHeight) {
            var target = this.$target;
            var horizontalGap = isNaN(this._horizontalGap) ? 0 : this._horizontalGap;
            var verticalGap = isNaN(this._verticalGap) ? 0 : this._verticalGap;
            this._rowCount = this._columnCount = -1;
            var numElements = target.numElements;
            var count = numElements;
            for (var index = 0; index < count; index++) {
                var layoutElement = (target.getElementAt(index));
                if (layoutElement && (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout)) {
                    numElements--;
                    continue;
                }
            }
            if (numElements == 0) {
                this._rowCount = this._columnCount = 0;
                return;
            }
            if (isNaN(this.explicitColumnWidth) || isNaN(this.explicitRowHeight))
                this.updateMaxElementSize();
            if (isNaN(this.explicitColumnWidth)) {
                this._columnWidth = this.maxElementWidth;
            }
            else {
                this._columnWidth = this.explicitColumnWidth;
            }
            if (isNaN(this.explicitRowHeight)) {
                this._rowHeight = this.maxElementHeight;
            }
            else {
                this._rowHeight = this.explicitRowHeight;
            }
            var itemWidth = this._columnWidth + horizontalGap;
            //้ฒๆญขๅบ็ฐ้คๆฐไธบ้ถ็ๆๅต
            if (itemWidth <= 0)
                itemWidth = 1;
            var itemHeight = this._rowHeight + verticalGap;
            if (itemHeight <= 0)
                itemHeight = 1;
            var orientedByColumns = (this._orientation == eui.TileOrientation.COLUMNS);
            var widthHasSet = !isNaN(explicitWidth);
            var heightHasSet = !isNaN(explicitHeight);
            var paddingL = this._paddingLeft;
            var paddingR = this._paddingRight;
            var paddingT = this._paddingTop;
            var paddingB = this._paddingBottom;
            if (this._requestedColumnCount > 0 || this._requestedRowCount > 0) {
                if (this._requestedRowCount > 0)
                    this._rowCount = Math.min(this._requestedRowCount, numElements);
                if (this._requestedColumnCount > 0)
                    this._columnCount = Math.min(this._requestedColumnCount, numElements);
            }
            else if (!widthHasSet && !heightHasSet) {
                var side = Math.sqrt(numElements * itemWidth * itemHeight);
                if (orientedByColumns) {
                    this._rowCount = Math.max(1, Math.round(side / itemHeight));
                }
                else {
                    this._columnCount = Math.max(1, Math.round(side / itemWidth));
                }
            }
            else if (widthHasSet && (!heightHasSet || !orientedByColumns)) {
                var targetWidth = Math.max(0, explicitWidth - paddingL - paddingR);
                this._columnCount = Math.floor((targetWidth + horizontalGap) / itemWidth);
                this._columnCount = Math.max(1, Math.min(this._columnCount, numElements));
            }
            else {
                var targetHeight = Math.max(0, explicitHeight - paddingT - paddingB);
                this._rowCount = Math.floor((targetHeight + verticalGap) / itemHeight);
                this._rowCount = Math.max(1, Math.min(this._rowCount, numElements));
            }
            if (this._rowCount == -1)
                this._rowCount = Math.max(1, Math.ceil(numElements / this._columnCount));
            if (this._columnCount == -1)
                this._columnCount = Math.max(1, Math.ceil(numElements / this._rowCount));
            if (this._requestedColumnCount > 0 && this._requestedRowCount > 0) {
                if (this._orientation == eui.TileOrientation.ROWS)
                    this._rowCount = Math.max(1, Math.ceil(numElements / this._requestedColumnCount));
                else
                    this._columnCount = Math.max(1, Math.ceil(numElements / this._requestedRowCount));
            }
        };
        /**
         * @private
         * ๆดๆฐๆๅคงๅญๅฏน่ฑกๅฐบๅฏธ
         */
        TileLayout.prototype.updateMaxElementSize = function () {
            if (!this.$target)
                return;
            if (this.$useVirtualLayout) {
                this.maxElementWidth = Math.max(this.maxElementWidth, this.$typicalWidth);
                this.maxElementHeight = Math.max(this.maxElementHeight, this.$typicalHeight);
                this.doUpdateMaxElementSize(this.startIndex, this.endIndex);
            }
            else {
                this.doUpdateMaxElementSize(0, this.$target.numElements - 1);
            }
        };
        /**
         * @private
         * ๆดๆฐ่ๆๅธๅฑ็ๆๅคงๅญๅฏน่ฑกๅฐบๅฏธ
         */
        TileLayout.prototype.doUpdateMaxElementSize = function (startIndex, endIndex) {
            var maxElementWidth = this.maxElementWidth;
            var maxElementHeight = this.maxElementHeight;
            var bounds = egret.$TempRectangle;
            var target = this.$target;
            if ((startIndex != -1) && (endIndex != -1)) {
                for (var index = startIndex; index <= endIndex; index++) {
                    var elt = target.getVirtualElementAt(index);
                    if (!egret.is(elt, UIComponentClass) || !elt.$includeInLayout) {
                        continue;
                    }
                    elt.getPreferredBounds(bounds);
                    maxElementWidth = Math.max(maxElementWidth, bounds.width);
                    maxElementHeight = Math.max(maxElementHeight, bounds.height);
                }
            }
            this.maxElementWidth = maxElementWidth;
            this.maxElementHeight = maxElementHeight;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        TileLayout.prototype.clearVirtualLayoutCache = function () {
            _super.prototype.clearVirtualLayoutCache.call(this);
            this.maxElementWidth = 0;
            this.maxElementHeight = 0;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        TileLayout.prototype.scrollPositionChanged = function () {
            if (this.$useVirtualLayout) {
                var changed = this.getIndexInView();
                if (changed) {
                    this.indexInViewCalculated = true;
                    this.$target.invalidateDisplayList();
                }
            }
        };
        /**
         * @private
         * ่ทๅ่งๅพไธญ็ฌฌไธไธชๅๆๅไธไธชๅ็ด็็ดขๅผ,่ฟๅๆฏๅฆๅ็ๆนๅ
         */
        TileLayout.prototype.getIndexInView = function () {
            if (!this.$target || this.$target.numElements == 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var target = this.$target;
            var numElements = target.numElements;
            if (!this.$useVirtualLayout) {
                this.startIndex = 0;
                this.endIndex = numElements - 1;
                return false;
            }
            var values = target.$UIComponent;
            if (values[10 /* width */] == 0 || values[11 /* height */] == 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var oldStartIndex = this.startIndex;
            var oldEndIndex = this.endIndex;
            var paddingL = this._paddingLeft;
            var paddingT = this._paddingTop;
            var horizontalGap = isNaN(this._horizontalGap) ? 0 : this._horizontalGap;
            var verticalGap = isNaN(this._verticalGap) ? 0 : this._verticalGap;
            if (this._orientation == eui.TileOrientation.COLUMNS) {
                var itemWidth = this._columnWidth + horizontalGap;
                if (itemWidth <= 0) {
                    this.startIndex = 0;
                    this.endIndex = numElements - 1;
                    return false;
                }
                var minVisibleX = target.scrollH;
                var maxVisibleX = minVisibleX + values[10 /* width */];
                var startColumn = Math.floor((minVisibleX - paddingL) / itemWidth);
                if (startColumn < 0)
                    startColumn = 0;
                var endColumn = Math.ceil((maxVisibleX - paddingL) / itemWidth);
                if (endColumn < 0)
                    endColumn = 0;
                this.startIndex = Math.min(numElements - 1, Math.max(0, startColumn * this._rowCount));
                this.endIndex = Math.min(numElements - 1, Math.max(0, endColumn * this._rowCount - 1));
            }
            else {
                var itemHeight = this._rowHeight + verticalGap;
                if (itemHeight <= 0) {
                    this.startIndex = 0;
                    this.endIndex = numElements - 1;
                    return false;
                }
                var minVisibleY = target.scrollV;
                var maxVisibleY = minVisibleY + values[11 /* height */];
                var startRow = Math.floor((minVisibleY - paddingT) / itemHeight);
                if (startRow < 0)
                    startRow = 0;
                var endRow = Math.ceil((maxVisibleY - paddingT) / itemHeight);
                if (endRow < 0)
                    endRow = 0;
                this.startIndex = Math.min(numElements - 1, Math.max(0, startRow * this._columnCount));
                this.endIndex = Math.min(numElements - 1, Math.max(0, endRow * this._columnCount - 1));
            }
            return this.startIndex != oldStartIndex || this.endIndex != oldEndIndex;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        TileLayout.prototype.updateDisplayList = function (width, height) {
            _super.prototype.updateDisplayList.call(this, width, height);
            if (!this.$target)
                return;
            var target = this.$target;
            var paddingL = this._paddingLeft;
            var paddingR = this._paddingRight;
            var paddingT = this._paddingTop;
            var paddingB = this._paddingBottom;
            if (this.indexInViewCalculated) {
                this.indexInViewCalculated = false;
            }
            else {
                this.calculateRowAndColumn(width, height);
                if (this._rowCount == 0 || this._columnCount == 0) {
                    target.setContentSize(paddingL + paddingR, paddingT + paddingB);
                    return;
                }
                this.adjustForJustify(width, height);
                this.getIndexInView();
            }
            if (this.$useVirtualLayout) {
                this.calculateRowAndColumn(width, height);
                this.adjustForJustify(width, height);
            }
            if (this.startIndex == -1 || this.endIndex == -1) {
                target.setContentSize(0, 0);
                return;
            }
            var endIndex = this.endIndex;
            target.setVirtualElementIndicesInView(this.startIndex, endIndex);
            var elt;
            var x;
            var y;
            var columnIndex;
            var rowIndex;
            var orientedByColumns = (this._orientation == eui.TileOrientation.COLUMNS);
            var index = this.startIndex;
            var horizontalGap = isNaN(this._horizontalGap) ? 0 : this._horizontalGap;
            var verticalGap = isNaN(this._verticalGap) ? 0 : this._verticalGap;
            var rowCount = this._rowCount;
            var columnCount = this._columnCount;
            var columnWidth = this._columnWidth;
            var rowHeight = this._rowHeight;
            for (var i = this.startIndex; i <= endIndex; i++) {
                if (this.$useVirtualLayout) {
                    elt = (this.target.getVirtualElementAt(i));
                }
                else {
                    elt = (this.target.getElementAt(i));
                }
                if (!egret.is(elt, UIComponentClass) || !elt.$includeInLayout) {
                    continue;
                }
                if (orientedByColumns) {
                    columnIndex = Math.ceil((index + 1) / rowCount) - 1;
                    rowIndex = Math.ceil((index + 1) % rowCount) - 1;
                    if (rowIndex == -1)
                        rowIndex = rowCount - 1;
                }
                else {
                    columnIndex = Math.ceil((index + 1) % columnCount) - 1;
                    if (columnIndex == -1)
                        columnIndex = columnCount - 1;
                    rowIndex = Math.ceil((index + 1) / columnCount) - 1;
                }
                switch (this._horizontalAlign) {
                    case egret.HorizontalAlign.RIGHT:
                        x = width - (columnIndex + 1) * (columnWidth + horizontalGap) + horizontalGap - paddingR;
                        break;
                    case egret.HorizontalAlign.CENTER:
                        x = width / 2 - (columnCount * columnWidth + (columnCount - 1) * horizontalGap) / 2 + columnIndex * (columnWidth + horizontalGap);
                        break;
                    case egret.HorizontalAlign.LEFT:
                        x = columnIndex * (columnWidth + horizontalGap) + paddingL;
                        break;
                    default:
                        x = columnIndex * (columnWidth + horizontalGap) + paddingL;
                }
                switch (this._verticalAlign) {
                    case egret.VerticalAlign.TOP:
                        y = rowIndex * (rowHeight + verticalGap) + paddingT;
                        break;
                    case egret.VerticalAlign.BOTTOM:
                        y = height - (rowIndex + 1) * (rowHeight + verticalGap) + verticalGap - paddingB;
                        break;
                    case egret.VerticalAlign.MIDDLE:
                        y = height / 2 - (rowCount * rowHeight + (rowCount - 1) * verticalGap) / 2 + rowIndex * (rowHeight + verticalGap);
                        break;
                    default:
                        y = rowIndex * (rowHeight + verticalGap) + paddingT;
                }
                this.sizeAndPositionElement(elt, x, y, columnWidth, rowHeight);
                index++;
            }
            var hPadding = paddingL + paddingR;
            var vPadding = paddingT + paddingB;
            var contentWidth = (columnWidth + horizontalGap) * columnCount - horizontalGap;
            var contentHeight = (rowHeight + verticalGap) * rowCount - verticalGap;
            target.setContentSize(contentWidth + hPadding, contentHeight + vPadding);
        };
        /**
         * @private
         * ไธบๅไธชๅ็ดๅธๅฑ
         */
        TileLayout.prototype.sizeAndPositionElement = function (element, cellX, cellY, cellWidth, cellHeight) {
            var elementWidth = NaN;
            var elementHeight = NaN;
            var values = element.$UIComponent;
            if (this._horizontalAlign == eui.JustifyAlign.JUSTIFY)
                elementWidth = cellWidth;
            else if (!isNaN(values[6 /* percentWidth */]))
                elementWidth = cellWidth * values[6 /* percentWidth */] * 0.01;
            if (this._verticalAlign == eui.JustifyAlign.JUSTIFY)
                elementHeight = cellHeight;
            else if (!isNaN(values[7 /* percentHeight */]))
                elementHeight = cellHeight * values[7 /* percentHeight */] * 0.01;
            element.setLayoutBoundsSize(Math.round(elementWidth), Math.round(elementHeight));
            var x = cellX;
            var bounds = egret.$TempRectangle;
            element.getLayoutBounds(bounds);
            switch (this._horizontalAlign) {
                case egret.HorizontalAlign.RIGHT:
                    x += cellWidth - bounds.width;
                    break;
                case egret.HorizontalAlign.CENTER:
                    x = cellX + (cellWidth - bounds.width) / 2;
                    break;
            }
            var y = cellY;
            switch (this._verticalAlign) {
                case egret.VerticalAlign.BOTTOM:
                    y += cellHeight - bounds.height;
                    break;
                case egret.VerticalAlign.MIDDLE:
                    y += (cellHeight - bounds.height) / 2;
                    break;
            }
            element.setLayoutBoundsPosition(Math.round(x), Math.round(y));
        };
        /**
         * @private
         * ไธบไธค็ซฏๅฏน้ฝ่ฐๆด้ด้ๆๆผๅญๅฐบๅฏธ
         */
        TileLayout.prototype.adjustForJustify = function (width, height) {
            var paddingL = this._paddingLeft;
            var paddingR = this._paddingRight;
            var paddingT = this._paddingTop;
            var paddingB = this._paddingBottom;
            var targetWidth = Math.max(0, width - paddingL - paddingR);
            var targetHeight = Math.max(0, height - paddingT - paddingB);
            if (!isNaN(this.explicitVerticalGap))
                this._verticalGap = this.explicitVerticalGap;
            if (!isNaN(this.explicitHorizontalGap))
                this._horizontalGap = this.explicitHorizontalGap;
            this._verticalGap = isNaN(this._verticalGap) ? 0 : this._verticalGap;
            this._horizontalGap = isNaN(this._horizontalGap) ? 0 : this._horizontalGap;
            var offsetY = targetHeight - this._rowHeight * this._rowCount;
            var offsetX = targetWidth - this._columnWidth * this._columnCount;
            var gapCount;
            if (offsetY > 0) {
                if (this._rowAlign == eui.RowAlign.JUSTIFY_USING_GAP) {
                    gapCount = Math.max(1, this._rowCount - 1);
                    this._verticalGap = offsetY / gapCount;
                }
                else if (this._rowAlign == eui.RowAlign.JUSTIFY_USING_HEIGHT) {
                    if (this._rowCount > 0) {
                        this._rowHeight += (offsetY - (this._rowCount - 1) * this._verticalGap) / this._rowCount;
                    }
                }
            }
            if (offsetX > 0) {
                if (this._columnAlign == eui.ColumnAlign.JUSTIFY_USING_GAP) {
                    gapCount = Math.max(1, this._columnCount - 1);
                    this._horizontalGap = offsetX / gapCount;
                }
                else if (this._columnAlign == eui.ColumnAlign.JUSTIFY_USING_WIDTH) {
                    if (this._columnCount > 0) {
                        this._columnWidth += (offsetX - (this._columnCount - 1) * this._horizontalGap) / this._columnCount;
                    }
                }
            }
        };
        return TileLayout;
    }(eui.LayoutBase));
    eui.TileLayout = TileLayout;
    __reflect(TileLayout.prototype, "eui.TileLayout");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The TileOrientation class defines the possible values for the
     * <code>orientation</code> property of the TileLayout class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/TileOrientationExample.ts
     * @language en_US
     */
    /**
     * TileOrientation ็ฑปไธบ TileLayout ็ฑป็ <code>orientation</code> ๅฑๆงๅฎไนๅฏ่ฝ็ๅผใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/TileOrientationExample.ts
     * @language zh_CN
     */
    var TileOrientation = (function () {
        function TileOrientation() {
        }
        /**
         * Arranges elements row by row.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้่กๆๅๅ็ดใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        TileOrientation.ROWS = "rows";
        /**
         * Arranges elements column by column.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ้ๅๆๅๅ็ดใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        TileOrientation.COLUMNS = "columns";
        return TileOrientation;
    }());
    eui.TileOrientation = TileOrientation;
    __reflect(TileOrientation.prototype, "eui.TileOrientation");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var UIComponentClass = "eui.UIComponent";
    /**
     * The VerticalLayout class arranges the layout elements in a vertical sequence,
     * top to bottom, with optional gaps between the elements and optional padding
     * around the sequence of elements.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/VerticalLayoutExample.ts
     * @language en_US
     */
    /**
     * VerticalLayout ็ฑปๆๅ็ด้กบๅบไปไธๅไธๆๅๅธๅฑๅ็ด๏ผๅจๅ็ดๅๅด็ปๅ็ด้กบๅบ็ๅฏ้ๅกซๅไน้ดๅธฆๆๅฏ้้ด้ใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @includeExample  extension/eui/layout/VerticalLayoutExample.ts
     * @language zh_CN
     */
    var VerticalLayout = (function (_super) {
        __extends(VerticalLayout, _super);
        function VerticalLayout() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.measureReal = function () {
            var target = this.$target;
            var count = target.numElements;
            var numElements = count;
            var measuredWidth = 0;
            var measuredHeight = 0;
            var bounds = egret.$TempRectangle;
            for (var i = 0; i < count; i++) {
                var layoutElement = (target.getElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    numElements--;
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                measuredHeight += bounds.height;
                measuredWidth = Math.max(measuredWidth, bounds.width);
            }
            measuredHeight += (numElements - 1) * this.$gap;
            var hPadding = this.$paddingLeft + this.$paddingRight;
            var vPadding = this.$paddingTop + this.$paddingBottom;
            target.setMeasuredSize(measuredWidth + hPadding, measuredHeight + vPadding);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.measureVirtual = function () {
            var target = this.$target;
            var typicalHeight = this.$typicalHeight;
            var measuredHeight = this.getElementTotalSize();
            var measuredWidth = Math.max(this.maxElementSize, this.$typicalWidth);
            var bounds = egret.$TempRectangle;
            var endIndex = this.endIndex;
            var elementSizeTable = this.elementSizeTable;
            for (var index = this.startIndex; index < endIndex; index++) {
                var layoutElement = (target.getElementAt(index));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                measuredHeight += bounds.height;
                measuredHeight -= isNaN(elementSizeTable[index]) ? typicalHeight : elementSizeTable[index];
                measuredWidth = Math.max(measuredWidth, bounds.width);
            }
            var hPadding = this.$paddingLeft + this.$paddingRight;
            var vPadding = this.$paddingTop + this.$paddingBottom;
            target.setMeasuredSize(measuredWidth + hPadding, measuredHeight + vPadding);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.updateDisplayListReal = function (width, height) {
            var target = this.$target;
            var paddingL = this.$paddingLeft;
            var paddingR = this.$paddingRight;
            var paddingT = this.$paddingTop;
            var paddingB = this.$paddingBottom;
            var gap = this.$gap;
            var targetWidth = Math.max(0, width - paddingL - paddingR);
            var targetHeight = Math.max(0, height - paddingT - paddingB);
            var vJustify = this.$verticalAlign == eui.JustifyAlign.JUSTIFY;
            var hJustify = this.$horizontalAlign == eui.JustifyAlign.JUSTIFY || this.$horizontalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var hAlign = 0;
            if (!hJustify) {
                if (this.$horizontalAlign == egret.HorizontalAlign.CENTER) {
                    hAlign = 0.5;
                }
                else if (this.$horizontalAlign == egret.HorizontalAlign.RIGHT) {
                    hAlign = 1;
                }
            }
            var count = target.numElements;
            var numElements = count;
            var x = paddingL;
            var y = paddingT;
            var i;
            var layoutElement;
            var totalPreferredHeight = 0;
            var totalPercentHeight = 0;
            var childInfoArray = [];
            var childInfo;
            var heightToDistribute = targetHeight;
            var maxElementWidth = this.maxElementSize;
            var bounds = egret.$TempRectangle;
            for (i = 0; i < count; i++) {
                var layoutElement_2 = (target.getElementAt(i));
                if (!egret.is(layoutElement_2, UIComponentClass) || !layoutElement_2.$includeInLayout) {
                    numElements--;
                    continue;
                }
                layoutElement_2.getPreferredBounds(bounds);
                maxElementWidth = Math.max(maxElementWidth, bounds.width);
                if (vJustify) {
                    totalPreferredHeight += bounds.height;
                }
                else {
                    var values = layoutElement_2.$UIComponent;
                    if (!isNaN(values[7 /* percentHeight */])) {
                        totalPercentHeight += values[7 /* percentHeight */];
                        childInfo = new eui.sys.ChildInfo();
                        childInfo.layoutElement = layoutElement_2;
                        childInfo.percent = values[7 /* percentHeight */];
                        childInfo.min = values[14 /* minHeight */];
                        childInfo.max = values[15 /* maxHeight */];
                        childInfoArray.push(childInfo);
                    }
                    else {
                        heightToDistribute -= bounds.height;
                    }
                }
            }
            heightToDistribute -= gap * (numElements - 1);
            heightToDistribute = heightToDistribute > 0 ? heightToDistribute : 0;
            var excessSpace = targetHeight - totalPreferredHeight - gap * (numElements - 1);
            var averageHeight;
            var largeChildrenCount = numElements;
            var heightDic = {};
            if (vJustify) {
                if (excessSpace < 0) {
                    averageHeight = heightToDistribute / numElements;
                    for (i = 0; i < count; i++) {
                        layoutElement = (target.getElementAt(i));
                        if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                            continue;
                        }
                        layoutElement.getPreferredBounds(bounds);
                        if (bounds.height <= averageHeight) {
                            heightToDistribute -= bounds.height;
                            largeChildrenCount--;
                            continue;
                        }
                    }
                    heightToDistribute = heightToDistribute > 0 ? heightToDistribute : 0;
                }
            }
            else {
                if (totalPercentHeight > 0) {
                    this.flexChildrenProportionally(targetHeight, heightToDistribute, totalPercentHeight, childInfoArray);
                    var roundOff_2 = 0;
                    var length_33 = childInfoArray.length;
                    for (i = 0; i < length_33; i++) {
                        childInfo = childInfoArray[i];
                        var childSize = Math.round(childInfo.size + roundOff_2);
                        roundOff_2 += childInfo.size - childSize;
                        heightDic[childInfo.layoutElement.$hashCode] = childSize;
                        heightToDistribute -= childSize;
                    }
                    heightToDistribute = heightToDistribute > 0 ? heightToDistribute : 0;
                }
            }
            if (this.$verticalAlign == egret.VerticalAlign.MIDDLE) {
                y = paddingT + heightToDistribute * 0.5;
            }
            else if (this.$verticalAlign == egret.VerticalAlign.BOTTOM) {
                y = paddingT + heightToDistribute;
            }
            var maxX = paddingL;
            var maxY = paddingT;
            var dx = 0;
            var dy = 0;
            var justifyWidth = Math.ceil(targetWidth);
            if (this.$horizontalAlign == eui.JustifyAlign.CONTENT_JUSTIFY)
                justifyWidth = Math.ceil(Math.max(targetWidth, maxElementWidth));
            var roundOff = 0;
            var layoutElementHeight;
            var childHeight;
            for (i = 0; i < count; i++) {
                var exceesWidth = 0;
                layoutElement = (target.getElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                layoutElementHeight = NaN;
                if (vJustify) {
                    childHeight = NaN;
                    if (excessSpace > 0) {
                        childHeight = heightToDistribute * bounds.height / totalPreferredHeight;
                    }
                    else if (excessSpace < 0 && bounds.height > averageHeight) {
                        childHeight = heightToDistribute / largeChildrenCount;
                    }
                    if (!isNaN(childHeight)) {
                        layoutElementHeight = Math.round(childHeight + roundOff);
                        roundOff += childHeight - layoutElementHeight;
                    }
                }
                else {
                    layoutElementHeight = heightDic[layoutElement.$hashCode];
                }
                if (hJustify) {
                    x = paddingL;
                    layoutElement.setLayoutBoundsSize(justifyWidth, layoutElementHeight);
                    layoutElement.getLayoutBounds(bounds);
                }
                else {
                    var layoutElementWidth = NaN;
                    var values = layoutElement.$UIComponent;
                    if (!isNaN(values[6 /* percentWidth */])) {
                        var percent = Math.min(100, values[6 /* percentWidth */]);
                        layoutElementWidth = Math.round(targetWidth * percent * 0.01);
                    }
                    layoutElement.setLayoutBoundsSize(layoutElementWidth, layoutElementHeight);
                    layoutElement.getLayoutBounds(bounds);
                    exceesWidth = (targetWidth - bounds.width) * hAlign;
                    exceesWidth = exceesWidth > 0 ? exceesWidth : 0;
                    x = paddingL + exceesWidth;
                }
                layoutElement.setLayoutBoundsPosition(Math.round(x), Math.round(y));
                dx = Math.ceil(bounds.width);
                dy = Math.ceil(bounds.height);
                maxX = Math.max(maxX, x + dx);
                maxY = Math.max(maxY, y + dy);
                y += dy + gap;
            }
            this.maxElementSize = maxElementWidth;
            target.setContentSize(maxX + paddingR, maxY + paddingB);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.updateDisplayListVirtual = function (width, height) {
            var target = this.$target;
            if (this.indexInViewCalculated)
                this.indexInViewCalculated = false;
            else
                this.getIndexInView();
            var paddingB = this.$paddingBottom;
            var paddingL = this.$paddingLeft;
            var paddingR = this.$paddingRight;
            var gap = this.$gap;
            var contentHeight;
            var numElements = target.numElements;
            if (this.startIndex == -1 || this.endIndex == -1) {
                contentHeight = this.getStartPosition(numElements) - gap + paddingB;
                target.setContentSize(target.contentWidth, contentHeight);
                return;
            }
            var endIndex = this.endIndex;
            target.setVirtualElementIndicesInView(this.startIndex, endIndex);
            //่ทๅๅ็ดๅธๅฑๅๆฐ
            var justify = this.$horizontalAlign == eui.JustifyAlign.JUSTIFY || this.$horizontalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var contentJustify = this.$horizontalAlign == eui.JustifyAlign.CONTENT_JUSTIFY;
            var hAlign = 0;
            if (!justify) {
                if (this.$horizontalAlign == egret.HorizontalAlign.CENTER) {
                    hAlign = 0.5;
                }
                else if (this.$horizontalAlign == egret.HorizontalAlign.RIGHT) {
                    hAlign = 1;
                }
            }
            var bounds = egret.$TempRectangle;
            var targetWidth = Math.max(0, width - paddingL - paddingR);
            var justifyWidth = Math.ceil(targetWidth);
            var layoutElement;
            var typicalHeight = this.$typicalHeight;
            var typicalWidth = this.$typicalWidth;
            var maxElementWidth = this.maxElementSize;
            var oldMaxW = Math.max(typicalWidth, this.maxElementSize);
            if (contentJustify) {
                for (var index = this.startIndex; index <= endIndex; index++) {
                    layoutElement = (target.getVirtualElementAt(index));
                    if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                        continue;
                    }
                    layoutElement.getPreferredBounds(bounds);
                    maxElementWidth = Math.max(maxElementWidth, bounds.width);
                }
                justifyWidth = Math.ceil(Math.max(targetWidth, maxElementWidth));
            }
            var x = 0;
            var y = 0;
            var contentWidth = 0;
            var oldElementSize;
            var needInvalidateSize = false;
            var elementSizeTable = this.elementSizeTable;
            //ๅฏนๅฏ่งๅบๅ่ฟ่กๅธๅฑ
            for (var i = this.startIndex; i <= endIndex; i++) {
                var exceesWidth = 0;
                layoutElement = (target.getVirtualElementAt(i));
                if (!egret.is(layoutElement, UIComponentClass) || !layoutElement.$includeInLayout) {
                    continue;
                }
                layoutElement.getPreferredBounds(bounds);
                if (!contentJustify) {
                    maxElementWidth = Math.max(maxElementWidth, bounds.width);
                }
                if (justify) {
                    x = paddingL;
                    layoutElement.setLayoutBoundsSize(justifyWidth, NaN);
                    layoutElement.getLayoutBounds(bounds);
                }
                else {
                    layoutElement.getLayoutBounds(bounds);
                    exceesWidth = (targetWidth - bounds.width) * hAlign;
                    exceesWidth = exceesWidth > 0 ? exceesWidth : 0;
                    x = paddingL + exceesWidth;
                }
                contentWidth = Math.max(contentWidth, bounds.width);
                if (!needInvalidateSize) {
                    oldElementSize = isNaN(elementSizeTable[i]) ? typicalHeight : elementSizeTable[i];
                    if (oldElementSize != bounds.height)
                        needInvalidateSize = true;
                }
                elementSizeTable[i] = bounds.height;
                y = this.getStartPosition(i);
                layoutElement.setLayoutBoundsPosition(Math.round(x), Math.round(y));
            }
            contentWidth += paddingL + paddingR;
            contentHeight = this.getStartPosition(numElements) - gap + paddingB;
            this.maxElementSize = maxElementWidth;
            target.setContentSize(contentWidth, contentHeight);
            if (needInvalidateSize || oldMaxW < this.maxElementSize) {
                target.invalidateSize();
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.getStartPosition = function (index) {
            if (!this.$useVirtualLayout) {
                if (this.$target) {
                    var element = this.$target.getElementAt(index);
                    if (element) {
                        return element.y;
                    }
                }
            }
            var typicalHeight = this.$typicalHeight;
            var startPos = this.$paddingTop;
            var gap = this.$gap;
            var elementSizeTable = this.elementSizeTable;
            for (var i = 0; i < index; i++) {
                var h = elementSizeTable[i];
                if (isNaN(h)) {
                    h = typicalHeight;
                }
                startPos += h + gap;
            }
            return startPos;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.getElementSize = function (index) {
            if (this.$useVirtualLayout) {
                var size = this.elementSizeTable[index];
                if (isNaN(size)) {
                    size = this.$typicalHeight;
                }
                return size;
            }
            if (this.$target) {
                return this.$target.getElementAt(index).height;
            }
            return 0;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.getElementTotalSize = function () {
            var typicalHeight = this.$typicalHeight;
            var gap = this.$gap;
            var totalSize = 0;
            var length = this.$target.numElements;
            var elementSizeTable = this.elementSizeTable;
            for (var i = 0; i < length; i++) {
                var h = elementSizeTable[i];
                if (isNaN(h)) {
                    h = typicalHeight;
                }
                totalSize += h + gap;
            }
            totalSize -= gap;
            return totalSize;
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.elementAdded = function (index) {
            if (!this.$useVirtualLayout)
                return;
            _super.prototype.elementAdded.call(this, index);
            this.elementSizeTable.splice(index, 0, this.$typicalHeight);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        VerticalLayout.prototype.getIndexInView = function () {
            var target = this.$target;
            if (!target || target.numElements == 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var values = target.$UIComponent;
            if (values[10 /* width */] == 0 || values[11 /* height */] == 0) {
                this.startIndex = this.endIndex = -1;
                return false;
            }
            var numElements = target.numElements;
            var contentHeight = this.getStartPosition(numElements - 1) +
                this.elementSizeTable[numElements - 1] + this.$paddingBottom;
            var minVisibleY = target.scrollV;
            if (minVisibleY > contentHeight - this.$paddingBottom) {
                this.startIndex = -1;
                this.endIndex = -1;
                return false;
            }
            var maxVisibleY = target.scrollV + values[11 /* height */];
            if (maxVisibleY < this.$paddingTop) {
                this.startIndex = -1;
                this.endIndex = -1;
                return false;
            }
            var oldStartIndex = this.startIndex;
            var oldEndIndex = this.endIndex;
            this.startIndex = this.findIndexAt(minVisibleY, 0, numElements - 1);
            if (this.startIndex == -1)
                this.startIndex = 0;
            this.endIndex = this.findIndexAt(maxVisibleY, 0, numElements - 1);
            if (this.endIndex == -1)
                this.endIndex = numElements - 1;
            return oldStartIndex != this.startIndex || oldEndIndex != this.endIndex;
        };
        return VerticalLayout;
    }(eui.LinearLayoutBase));
    eui.VerticalLayout = VerticalLayout;
    __reflect(VerticalLayout.prototype, "eui.VerticalLayout");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The HScrollBar (horizontal scrollbar) control lets you control
     * the portion of data that is displayed when there is too much data
     * to fit horizontally in a display area.
     *
     * <p>Although you can use the HScrollBar control as a stand-alone control,
     * you usually combine it as part of another group of components to
     * provide scrolling functionality.</p>
     *
     * @includeExample  extension/eui/components/HScrollBarExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * HScrollBar๏ผๆฐดๅนณ ScrollBar๏ผๆงไปถๅฏไปฅๅจๅๆฐๆฎๅคชๅค่ไธ่ฝๅจๆพ็คบๅบๅไธญไปฅๆฐดๅนณๆนๅๅฎๅจๆพ็คบๆถๆงๅถๆพ็คบ็ๆฐๆฎ้จๅใ
     * <p>่ฝ็ถ HScrollBar ๆงไปถๅฏไปฅๅ็ฌไฝฟ็จ๏ผไฝ้ๅธธๅฐๅฎไธๅถไป็ปไปถไธ่ตทไฝฟ็จๆฅๆไพๆปๅจๅ่ฝใ</p>
     *
     * @includeExample  extension/eui/components/HScrollBarExample.ts
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var HScrollBar = (function (_super) {
        __extends(HScrollBar, _super);
        function HScrollBar() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HScrollBar.prototype.updateDisplayList = function (unscaledWidth, unscaledHeight) {
            _super.prototype.updateDisplayList.call(this, unscaledWidth, unscaledHeight);
            var thumb = this.thumb;
            var viewport = this.$viewport;
            if (!thumb || !viewport) {
                return;
            }
            var bounds = egret.$TempRectangle;
            thumb.getPreferredBounds(bounds);
            var thumbWidth = bounds.width;
            var thumbY = bounds.y;
            var hsp = viewport.scrollH;
            var contentWidth = viewport.contentWidth;
            var width = viewport.width;
            if (hsp <= 0) {
                var scaleWidth = thumbWidth * (1 - (-hsp) / (width * 0.5));
                scaleWidth = Math.max(5, Math.round(scaleWidth));
                thumb.setLayoutBoundsSize(scaleWidth, NaN);
                thumb.setLayoutBoundsPosition(0, thumbY);
            }
            else if (hsp >= contentWidth - width) {
                var scaleWidth = thumbWidth * (1 - (hsp - contentWidth + width) / (width * 0.5));
                scaleWidth = Math.max(5, Math.round(scaleWidth));
                thumb.setLayoutBoundsSize(scaleWidth, NaN);
                thumb.setLayoutBoundsPosition(unscaledWidth - scaleWidth, thumbY);
            }
            else {
                var thumbX = (unscaledWidth - thumbWidth) * hsp / (contentWidth - width);
                thumb.setLayoutBoundsSize(NaN, NaN);
                thumb.setLayoutBoundsPosition(thumbX, thumbY);
            }
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        HScrollBar.prototype.onPropertyChanged = function (event) {
            switch (event.property) {
                case "scrollH":
                case "contentWidth":
                    this.invalidateDisplayList();
                    break;
            }
        };
        return HScrollBar;
    }(eui.ScrollBarBase));
    eui.HScrollBar = HScrollBar;
    __reflect(HScrollBar.prototype, "eui.HScrollBar");
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The operation of adding a state to view.
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ่งๅพๆทปๅ็ถๆๆพ็คบๅ็ดๆไฝ
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var AddItems = (function () {
        /**
         * Constructor.
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชAddItemsๅฎไพ
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function AddItems(target, propertyName, position, relativeTo) {
            this.target = target;
            this.propertyName = propertyName;
            this.position = position;
            this.relativeTo = relativeTo;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        AddItems.prototype.apply = function (host, parent) {
            var index;
            var relative = host[this.relativeTo];
            var target = host[this.target];
            var container = this.propertyName ? host[this.propertyName] : parent;
            if (!target || !container)
                return;
            switch (this.position) {
                case 0 /* FIRST */:
                    index = 0;
                    break;
                case 1 /* LAST */:
                    index = -1;
                    break;
                case 2 /* BEFORE */:
                    index = container.getChildIndex(relative);
                    break;
                case 3 /* AFTER */:
                    index = container.getChildIndex(relative) + 1;
                    break;
            }
            if (index == -1) {
                index = container.numChildren;
            }
            if (egret.is(container, "eui.Component")) {
                container.$Component[8 /* skin */].$elementsContent.push(target);
            }
            container.addChildAt(target, index);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        AddItems.prototype.remove = function (host, parent) {
            var container = this.propertyName ? host[this.propertyName] : parent;
            var target = host[this.target];
            if (!target || !container)
                return;
            if (target.$parent === container) {
                container.removeChild(target);
            }
            if (egret.is(container, "eui.Component")) {
                var arr = container.$Component[8 /* skin */].$elementsContent;
                var idx = arr.indexOf(target);
                if (idx > -1) {
                    arr.splice(idx, 1);
                }
            }
        };
        return AddItems;
    }());
    eui.AddItems = AddItems;
    __reflect(AddItems.prototype, "eui.AddItems", ["eui.IOverride"]);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The SetProperty class specifies a property value that is in effect only
     * during the parent view state.
     * You use this class in the <code>overrides</code> property of the State class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * SetProperty ็ฑปๆๅฎๅชๅจ็ถ่งๅพ็ถๆๆ้ดๆๆ็ๅฑๆงๅผใๅฏไปฅๅจ State ็ฑป็ overrides ๅฑๆงไธญไฝฟ็จ่ฏฅ็ฑปใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var SetProperty = (function () {
        /**
         * Constructor.
         *
         * @param target The object whose property is being set.
         * By default, EUI uses the immediate parent of the State object.
         * @param name The property to set.
         * @param value The value of the property in the view state.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชSetPropertyๅฎไพใ
         *
         * @param target ่ฆ่ฎพ็ฝฎๅถๅฑๆง็ๅฏน่ฑกใ้ป่ฎคๆๅตไธ๏ผEUI ไฝฟ็จ State ๅฏน่ฑก็็ดๆฅ็ถ็บงใ
         * @param name ่ฆ่ฎพ็ฝฎ็ๅฑๆงใ
         * @param value ่งๅพ็ถๆไธญ็ๅฑๆงๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function SetProperty(target, name, value) {
            this.target = target;
            this.name = name;
            this.value = value;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        SetProperty.prototype.apply = function (host, parent) {
            var obj = this.target ? host[this.target] : host;
            if (!obj)
                return;
            this.oldValue = obj[this.name];
            this.setPropertyValue(obj, this.name, this.value, this.oldValue);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         */
        SetProperty.prototype.remove = function (host, parent) {
            var obj = this.target ? host[this.target] : host;
            if (!obj)
                return;
            this.setPropertyValue(obj, this.name, this.oldValue, this.oldValue);
            this.oldValue = null;
        };
        /**
         * @private
         * ่ฎพ็ฝฎๅฑๆงๅผ
         */
        SetProperty.prototype.setPropertyValue = function (obj, name, value, valueForType) {
            if (value === undefined || value === null)
                obj[name] = value;
            else if (typeof (valueForType) == "number")
                obj[name] = +value;
            else if (typeof (valueForType) == "boolean")
                obj[name] = this.toBoolean(value);
            else
                obj[name] = value;
        };
        /**
         * @private
         * ่ฝฌๆBooleanๅผ
         */
        SetProperty.prototype.toBoolean = function (value) {
            if (typeof (value) == "string")
                return value.toLowerCase() == "true";
            return value != false;
        };
        return SetProperty;
    }());
    eui.SetProperty = SetProperty;
    __reflect(SetProperty.prototype, "eui.SetProperty", ["eui.IOverride"]);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    /**
     * The SetProperty class specifies a property value that is in effect only
     * during the parent view state.
     * You use this class in the <code>overrides</code> property of the State class.
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language en_US
     */
    /**
     * SetProperty ็ฑปๆๅฎๅชๅจ็ถ่งๅพ็ถๆๆ้ดๆๆ็ๅฑๆงๅผใๅฏไปฅๅจ State ็ฑป็ overrides ๅฑๆงไธญไฝฟ็จ่ฏฅ็ฑปใ
     *
     * @version Egret 2.4
     * @version eui 1.0
     * @platform Web,Native
     * @language zh_CN
     */
    var SetStateProperty = (function () {
        /**
         * Constructor.
         *
         * @param target The object whose property is being set.
         * By default, EUI uses the immediate parent of the State object.
         * @param name The property to set.
         * @param value The value of the property in the view state.
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅๅปบไธไธชSetPropertyๅฎไพใ
         *
         * @param target ่ฆ่ฎพ็ฝฎๅถๅฑๆง็ๅฏน่ฑกใ้ป่ฎคๆๅตไธ๏ผEUI ไฝฟ็จ State ๅฏน่ฑก็็ดๆฅ็ถ็บงใ
         * @param name ่ฆ่ฎพ็ฝฎ็ๅฑๆงใ
         * @param value ่งๅพ็ถๆไธญ็ๅฑๆงๅผใ
         *
         * @version Egret 2.4
         * @version eui 1.0
         * @platform Web,Native
         * @language zh_CN
         */
        function SetStateProperty(host, templates, chainIndex, target, prop) {
            this.host = host;
            this.templates = templates;
            this.chainIndex = chainIndex;
            this.target = target;
            this.prop = prop;
        }
        /**
         * @inheritDoc
         *
         * @version Egret 3.0
         * @version eui 1.0
         * @platform Web,Native
         */
        SetStateProperty.prototype.apply = function (host, parent) {
            if (!this.target) {
                return;
            }
            var nextOldValue = this.target[this.prop];
            if (this.oldValue) {
                this.setPropertyValue(this.target, this.prop, this.oldValue, this.oldValue);
            }
            if (nextOldValue) {
                this.oldValue = nextOldValue;
            }
            eui.Binding.$bindProperties(this.host, this.templates.concat(), this.chainIndex.concat(), this.target, this.prop);
        };
        /**
         * @inheritDoc
         *
         * @version Egret 3.0
         * @version eui 1.0
         * @platform Web,Native
         */
        SetStateProperty.prototype.remove = function (host, parent) {
            if (!this.target) {
                return;
            }
            var oldValue = this.oldValue;
            if (this.target[this.prop]) {
                this.oldValue = this.target[this.prop];
            }
            if (oldValue) {
                this.setPropertyValue(this.target, this.prop, oldValue, oldValue);
            }
        };
        /**
         * @private
         * ่ฎพ็ฝฎๅฑๆงๅผ
         */
        SetStateProperty.prototype.setPropertyValue = function (obj, name, value, valueForType) {
            if (value === undefined || value === null)
                obj[name] = value;
            else if (typeof (valueForType) == "number")
                obj[name] = +value;
            else if (typeof (valueForType) == "boolean")
                obj[name] = this.toBoolean(value);
            else
                obj[name] = value;
        };
        /**
         * @private
         * ่ฝฌๆBooleanๅผ
         */
        SetStateProperty.prototype.toBoolean = function (value) {
            if (typeof (value) == "string")
                return value.toLowerCase() == "true";
            return value != false;
        };
        return SetStateProperty;
    }());
    eui.SetStateProperty = SetStateProperty;
    __reflect(SetStateProperty.prototype, "eui.SetStateProperty", ["eui.IOverride"]);
})(eui || (eui = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var eui;
(function (eui) {
    var sys;
    (function (sys) {
        var SOLUTION_TOLERANCE = 0.1;
        var MIN_MAX_TOLERANCE = 0.1;
        /**
         * @private
         */
        var MatrixUtil = (function () {
            function MatrixUtil() {
            }
            /**
             * @private
             */
            MatrixUtil.fitBounds = function (width, height, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, minWidth, minHeight, maxWidth, maxHeight) {
                if (isNaN(width) && isNaN(height))
                    return egret.Point.create(preferredWidth, preferredHeight);
                var newMinWidth = (minWidth < MIN_MAX_TOLERANCE) ? 0 : minWidth - MIN_MAX_TOLERANCE;
                var newMinHeight = (minHeight < MIN_MAX_TOLERANCE) ? 0 : minHeight - MIN_MAX_TOLERANCE;
                var newMaxWidth = maxWidth + MIN_MAX_TOLERANCE;
                var newMaxHeight = maxHeight + MIN_MAX_TOLERANCE;
                var actualSize;
                if (!isNaN(width) && !isNaN(height)) {
                    actualSize = calcUBoundsToFitTBounds(width, height, matrix, newMinWidth, newMinHeight, newMaxWidth, newMaxHeight);
                    if (!actualSize) {
                        var actualSize1 = void 0;
                        actualSize1 = fitTBoundsWidth(width, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, newMinWidth, newMinHeight, newMaxWidth, newMaxHeight);
                        if (actualSize1) {
                            var fitHeight = transformSize(actualSize1.x, actualSize1.y, matrix).height;
                            if (fitHeight - SOLUTION_TOLERANCE > height) {
                                egret.Point.release(actualSize1);
                                actualSize1 = null;
                            }
                        }
                        var actualSize2 = void 0;
                        actualSize2 = fitTBoundsHeight(height, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, newMinWidth, newMinHeight, newMaxWidth, newMaxHeight);
                        if (actualSize2) {
                            var fitWidth = transformSize(actualSize2.x, actualSize2.y, matrix).width;
                            if (fitWidth - SOLUTION_TOLERANCE > width) {
                                egret.Point.release(actualSize2);
                                actualSize2 = null;
                            }
                        }
                        if (actualSize1 && actualSize2) {
                            actualSize = ((actualSize1.x * actualSize1.y) > (actualSize2.x * actualSize2.y)) ? actualSize1 : actualSize2;
                        }
                        else if (actualSize1) {
                            actualSize = actualSize1;
                        }
                        else {
                            actualSize = actualSize2;
                        }
                        egret.Point.release(actualSize1);
                        egret.Point.release(actualSize2);
                    }
                    return actualSize;
                }
                else if (!isNaN(width)) {
                    return fitTBoundsWidth(width, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, newMinWidth, newMinHeight, newMaxWidth, newMaxHeight);
                }
                else {
                    return fitTBoundsHeight(height, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, newMinWidth, newMinHeight, newMaxWidth, newMaxHeight);
                }
            };
            return MatrixUtil;
        }());
        sys.MatrixUtil = MatrixUtil;
        __reflect(MatrixUtil.prototype, "eui.sys.MatrixUtil");
        /**
         * @private
         */
        function fitTBoundsWidth(width, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, minWidth, minHeight, maxWidth, maxHeight) {
            var actualSize;
            if (!isNaN(explicitWidth) && isNaN(explicitHeight)) {
                actualSize = calcUBoundsToFitTBoundsWidth(width, matrix, explicitWidth, preferredHeight, explicitWidth, minHeight, explicitWidth, maxHeight);
                if (actualSize)
                    return actualSize;
            }
            else if (isNaN(explicitWidth) && !isNaN(explicitHeight)) {
                actualSize = calcUBoundsToFitTBoundsWidth(width, matrix, preferredWidth, explicitHeight, minWidth, explicitHeight, maxWidth, explicitHeight);
                if (actualSize)
                    return actualSize;
            }
            actualSize = calcUBoundsToFitTBoundsWidth(width, matrix, preferredWidth, preferredHeight, minWidth, minHeight, maxWidth, maxHeight);
            return actualSize;
        }
        /**
         * @private
         */
        function fitTBoundsHeight(height, matrix, explicitWidth, explicitHeight, preferredWidth, preferredHeight, minWidth, minHeight, maxWidth, maxHeight) {
            var actualSize;
            if (!isNaN(explicitWidth) && isNaN(explicitHeight)) {
                actualSize = calcUBoundsToFitTBoundsHeight(height, matrix, explicitWidth, preferredHeight, explicitWidth, minHeight, explicitWidth, maxHeight);
                if (actualSize)
                    return actualSize;
            }
            else if (isNaN(explicitWidth) && !isNaN(explicitHeight)) {
                actualSize = calcUBoundsToFitTBoundsHeight(height, matrix, preferredWidth, explicitHeight, minWidth, explicitHeight, maxWidth, explicitHeight);
                if (actualSize)
                    return actualSize;
            }
            actualSize = calcUBoundsToFitTBoundsHeight(height, matrix, preferredWidth, preferredHeight, minWidth, minHeight, maxWidth, maxHeight);
            return actualSize;
        }
        /**
         * @private
         */
        function calcUBoundsToFitTBoundsHeight(h, matrix, preferredX, preferredY, minX, minY, maxX, maxY) {
            var b = matrix.b;
            var d = matrix.d;
            if (-1.0e-9 < b && b < +1.0e-9)
                b = 0;
            if (-1.0e-9 < d && d < +1.0e-9)
                d = 0;
            if (b == 0 && d == 0)
                return null;
            if (b == 0 && d == 0)
                return null;
            if (b == 0)
                return egret.Point.create(preferredX, h / Math.abs(d));
            else if (d == 0)
                return egret.Point.create(h / Math.abs(b), preferredY);
            var d1 = (b * d >= 0) ? d : -d;
            var s;
            var x;
            var y;
            if (d1 != 0 && preferredX > 0) {
                var invD1 = 1 / d1;
                preferredX = Math.max(minX, Math.min(maxX, preferredX));
                x = preferredX;
                y = (h - b * x) * invD1;
                if (minY <= y && y <= maxY &&
                    b * x + d1 * y >= 0) {
                    s = egret.Point.create(x, y);
                }
                y = (-h - b * x) * invD1;
                if (minY <= y && y <= maxY &&
                    b * x + d1 * y < 0) {
                    if (!s || transformSize(s.x, s.y, matrix).width > transformSize(x, y, matrix).width) {
                        egret.Point.release(s);
                        s = egret.Point.create(x, y);
                    }
                }
            }
            if (b != 0 && preferredY > 0) {
                var invB = 1 / b;
                preferredY = Math.max(minY, Math.min(maxY, preferredY));
                y = preferredY;
                x = (h - d1 * y) * invB;
                if (minX <= x && x <= maxX &&
                    b * x + d1 * y >= 0) {
                    if (!s || transformSize(s.x, s.y, matrix).width > transformSize(x, y, matrix).width)
                        s = egret.Point.create(x, y);
                }
                x = (-h - d1 * y) * invB;
                if (minX <= x && x <= maxX &&
                    b * x + d1 * y < 0) {
                    if (!s || transformSize(s.x, s.y, matrix).width > transformSize(x, y, matrix).width) {
                        egret.Point.release(s);
                        s = egret.Point.create(x, y);
                    }
                }
            }
            if (s)
                return s;
            var a = matrix.a;
            var c = matrix.c;
            var c1 = (a * c >= 0) ? c : -c;
            return solveEquation(b, d1, h, minX, minY, maxX, maxY, a, c1);
        }
        /**
         * @private
         */
        function calcUBoundsToFitTBoundsWidth(w, matrix, preferredX, preferredY, minX, minY, maxX, maxY) {
            var a = matrix.a;
            var c = matrix.c;
            if (-1.0e-9 < a && a < +1.0e-9)
                a = 0;
            if (-1.0e-9 < c && c < +1.0e-9)
                c = 0;
            if (a == 0 && c == 0)
                return null;
            if (a == 0)
                return egret.Point.create(preferredX, w / Math.abs(c));
            else if (c == 0)
                return egret.Point.create(w / Math.abs(a), preferredY);
            var c1 = (a * c >= 0) ? c : -c;
            var s;
            var x;
            var y;
            if (c1 != 0 && preferredX > 0) {
                var invC1 = 1 / c1;
                preferredX = Math.max(minX, Math.min(maxX, preferredX));
                x = preferredX;
                y = (w - a * x) * invC1;
                if (minY <= y && y <= maxY &&
                    a * x + c1 * y >= 0) {
                    s = egret.Point.create(x, y);
                }
                y = (-w - a * x) * invC1;
                if (minY <= y && y <= maxY &&
                    a * x + c1 * y < 0) {
                    if (!s || transformSize(s.x, s.y, matrix).height > transformSize(x, y, matrix).height) {
                        egret.Point.release(s);
                        s = egret.Point.create(x, y);
                    }
                }
            }
            if (a != 0 && preferredY > 0) {
                var invA = 1 / a;
                preferredY = Math.max(minY, Math.min(maxY, preferredY));
                y = preferredY;
                x = (w - c1 * y) * invA;
                if (minX <= x && x <= maxX &&
                    a * x + c1 * y >= 0) {
                    if (!s || transformSize(s.x, s.y, matrix).height > transformSize(x, y, matrix).height) {
                        egret.Point.release(s);
                        s = egret.Point.create(x, y);
                    }
                }
                x = (-w - c1 * y) * invA;
                if (minX <= x && x <= maxX &&
                    a * x + c1 * y < 0) {
                    if (!s || transformSize(s.x, s.y, matrix).height > transformSize(x, y, matrix).height) {
                        egret.Point.release(s);
                        s = egret.Point.create(x, y);
                    }
                }
            }
            if (s)
                return s;
            var b = matrix.b;
            var d = matrix.d;
            var d1 = (b * d >= 0) ? d : -d;
            return solveEquation(a, c1, w, minX, minY, maxX, maxY, b, d1);
        }
        /**
         * @private
         */
        function solveEquation(a, c, w, minX, minY, maxX, maxY, b, d) {
            if (a == 0 || c == 0)
                return null;
            var x;
            var y;
            var A = (w - minX * a) / c;
            var B = (w - maxX * a) / c;
            var rangeMinY = Math.max(minY, Math.min(A, B));
            var rangeMaxY = Math.min(maxY, Math.max(A, B));
            var det = (b * c - a * d);
            if (rangeMinY <= rangeMaxY) {
                if (Math.abs(det) < 1.0e-9) {
                    y = w / (a + c);
                }
                else {
                    y = b * w / det;
                }
                y = Math.max(rangeMinY, Math.min(y, rangeMaxY));
                x = (w - c * y) / a;
                return egret.Point.create(x, y);
            }
            A = -(minX * a + w) / c;
            B = -(maxX * a + w) / c;
            rangeMinY = Math.max(minY, Math.min(A, B));
            rangeMaxY = Math.min(maxY, Math.max(A, B));
            if (rangeMinY <= rangeMaxY) {
                if (Math.abs(det) < 1.0e-9) {
                    y = -w / (a + c);
                }
                else {
                    y = -b * w / det;
                }
                y = Math.max(rangeMinY, Math.min(y, rangeMaxY));
                x = (-w - c * y) / a;
                return egret.Point.create(x, y);
            }
            return null;
        }
        /**
         * @private
         */
        function calcUBoundsToFitTBounds(w, h, matrix, minX, minY, maxX, maxY) {
            var a = matrix.a;
            var b = matrix.b;
            var c = matrix.c;
            var d = matrix.d;
            if (-1.0e-9 < a && a < +1.0e-9)
                a = 0;
            if (-1.0e-9 < b && b < +1.0e-9)
                b = 0;
            if (-1.0e-9 < c && c < +1.0e-9)
                c = 0;
            if (-1.0e-9 < d && d < +1.0e-9)
                d = 0;
            if (b == 0 && c == 0) {
                if (a == 0 || d == 0)
                    return null;
                return egret.Point.create(w / Math.abs(a), h / Math.abs(d));
            }
            if (a == 0 && d == 0) {
                if (b == 0 || c == 0)
                    return null;
                return egret.Point.create(h / Math.abs(b), w / Math.abs(c));
            }
            var c1 = (a * c >= 0) ? c : -c;
            var d1 = (b * d >= 0) ? d : -d;
            var det = a * d1 - b * c1;
            if (Math.abs(det) < 1.0e-9) {
                if (c1 == 0 || a == 0 || a == -c1)
                    return null;
                if (Math.abs(a * h - b * w) > 1.0e-9)
                    return null;
                return solveEquation(a, c1, w, minX, minX, maxX, maxY, b, d1);
            }
            var invDet = 1 / det;
            w *= invDet;
            h *= invDet;
            var s;
            s = solveSystem(a, c1, b, d1, w, h);
            if (s &&
                minX <= s.x && s.x <= maxX && minY <= s.y && s.y <= maxY &&
                a * s.x + c1 * s.x >= 0 &&
                b * s.x + d1 * s.y >= 0)
                return s;
            s = solveSystem(a, c1, b, d1, w, -h);
            if (s &&
                minX <= s.x && s.x <= maxX && minY <= s.y && s.y <= maxY &&
                a * s.x + c1 * s.x >= 0 &&
                b * s.x + d1 * s.y < 0)
                return s;
            s = solveSystem(a, c1, b, d1, -w, h);
            if (s &&
                minX <= s.x && s.x <= maxX && minY <= s.y && s.y <= maxY &&
                a * s.x + c1 * s.x < 0 &&
                b * s.x + d1 * s.y >= 0)
                return s;
            s = solveSystem(a, c1, b, d1, -w, -h);
            if (s &&
                minX <= s.x && s.x <= maxX && minY <= s.y && s.y <= maxY &&
                a * s.x + c1 * s.x < 0 &&
                b * s.x + d1 * s.y < 0)
                return s;
            egret.Point.release(s);
            return null;
        }
        /**
         * @private
         */
        function transformSize(width, height, matrix) {
            var bounds = egret.$TempRectangle.setTo(0, 0, width, height);
            matrix.$transformBounds(bounds);
            return bounds;
        }
        /**
         * @private
         */
        function solveSystem(a, c, b, d, mOverDet, nOverDet) {
            return egret.Point.create(d * mOverDet - c * nOverDet, a * nOverDet - b * mOverDet);
        }
    })(sys = eui.sys || (eui.sys = {}));
})(eui || (eui = {}));
var __reflect = (this && this.__reflect) || function (p, c, t) {
    p.__class__ = c, t ? t.push(c) : t = [c], p.__types__ = p.__types__ ? t.concat(p.__types__) : t;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b)
            if (b.hasOwnProperty(p))
                d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Easing function set. Different easing functions are used to make an animation proceed according to the corresponding equation
     * @see http://edn.egret.com/cn/index.php/article/index/id/53 Easing effect Demo
     * @version Egret 2.4
     * @platform Web,Native
     * @language en_US
     */
    /**
     * ็ผๅจๅฝๆฐ้ๅ๏ผไฝฟ็จไธๅ็็ผๅจๅฝๆฐไฝฟๅพๅจ็ปๆ็งๅฏนๅบ็ๆน็จ่ฟ่ก
     * @see http://edn.egret.com/cn/index.php/article/index/id/53 ็ผๅจๆๆๆผ็คบ
     * @version Egret 2.4
     * @platform Web,Native
     * @language zh_CN
     */
    var Ease = (function () {
        /**
         * @version Egret 2.4
         * @platform Web,Native
         */
        function Ease() {
            egret.$error(1014);
        }
        /**
         * get.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * getใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.get = function (amount) {
            if (amount < -1) {
                amount = -1;
            }
            if (amount > 1) {
                amount = 1;
            }
            return function (t) {
                if (amount == 0) {
                    return t;
                }
                if (amount < 0) {
                    return t * (t * -amount + 1 + amount);
                }
                return t * ((2 - t) * amount + (1 - amount));
            };
        };
        /**
         * get pow in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get pow inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getPowIn = function (pow) {
            return function (t) {
                return Math.pow(t, pow);
            };
        };
        /**
         * get pow out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get pow outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getPowOut = function (pow) {
            return function (t) {
                return 1 - Math.pow(1 - t, pow);
            };
        };
        /**
         * get pow in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get pow in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getPowInOut = function (pow) {
            return function (t) {
                if ((t *= 2) < 1)
                    return 0.5 * Math.pow(t, pow);
                return 1 - 0.5 * Math.abs(Math.pow(2 - t, pow));
            };
        };
        /**
         * sine in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * sine inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.sineIn = function (t) {
            return 1 - Math.cos(t * Math.PI / 2);
        };
        /**
         * sine out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * sine outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.sineOut = function (t) {
            return Math.sin(t * Math.PI / 2);
        };
        /**
         * sine in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * sine in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.sineInOut = function (t) {
            return -0.5 * (Math.cos(Math.PI * t) - 1);
        };
        /**
         * get back in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get back inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getBackIn = function (amount) {
            return function (t) {
                return t * t * ((amount + 1) * t - amount);
            };
        };
        /**
         * get back out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get back outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getBackOut = function (amount) {
            return function (t) {
                return (--t * t * ((amount + 1) * t + amount) + 1);
            };
        };
        /**
         * get back in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get back in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getBackInOut = function (amount) {
            amount *= 1.525;
            return function (t) {
                if ((t *= 2) < 1)
                    return 0.5 * (t * t * ((amount + 1) * t - amount));
                return 0.5 * ((t -= 2) * t * ((amount + 1) * t + amount) + 2);
            };
        };
        /**
         * circ in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * circ inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.circIn = function (t) {
            return -(Math.sqrt(1 - t * t) - 1);
        };
        /**
         * circ out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * circ outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.circOut = function (t) {
            return Math.sqrt(1 - (--t) * t);
        };
        /**
         * circ in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * circ in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.circInOut = function (t) {
            if ((t *= 2) < 1) {
                return -0.5 * (Math.sqrt(1 - t * t) - 1);
            }
            return 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);
        };
        /**
         * bounce in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * bounce inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.bounceIn = function (t) {
            return 1 - Ease.bounceOut(1 - t);
        };
        /**
         * bounce out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * bounce outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.bounceOut = function (t) {
            if (t < 1 / 2.75) {
                return (7.5625 * t * t);
            }
            else if (t < 2 / 2.75) {
                return (7.5625 * (t -= 1.5 / 2.75) * t + 0.75);
            }
            else if (t < 2.5 / 2.75) {
                return (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375);
            }
            else {
                return (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375);
            }
        };
        /**
         * bounce in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * bounce in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.bounceInOut = function (t) {
            if (t < 0.5)
                return Ease.bounceIn(t * 2) * .5;
            return Ease.bounceOut(t * 2 - 1) * 0.5 + 0.5;
        };
        /**
         * get elastic in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get elastic inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getElasticIn = function (amplitude, period) {
            var pi2 = Math.PI * 2;
            return function (t) {
                if (t == 0 || t == 1)
                    return t;
                var s = period / pi2 * Math.asin(1 / amplitude);
                return -(amplitude * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * pi2 / period));
            };
        };
        /**
         * get elastic out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get elastic outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getElasticOut = function (amplitude, period) {
            var pi2 = Math.PI * 2;
            return function (t) {
                if (t == 0 || t == 1)
                    return t;
                var s = period / pi2 * Math.asin(1 / amplitude);
                return (amplitude * Math.pow(2, -10 * t) * Math.sin((t - s) * pi2 / period) + 1);
            };
        };
        /**
         * get elastic in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * get elastic in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.getElasticInOut = function (amplitude, period) {
            var pi2 = Math.PI * 2;
            return function (t) {
                var s = period / pi2 * Math.asin(1 / amplitude);
                if ((t *= 2) < 1)
                    return -0.5 * (amplitude * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * pi2 / period));
                return amplitude * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - s) * pi2 / period) * 0.5 + 1;
            };
        };
        /**
         * quad in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quad inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quadIn = Ease.getPowIn(2);
        /**
         * quad out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quad outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quadOut = Ease.getPowOut(2);
        /**
         * quad in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quad in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quadInOut = Ease.getPowInOut(2);
        /**
         * cubic in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * cubic inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.cubicIn = Ease.getPowIn(3);
        /**
         * cubic out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * cubic outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.cubicOut = Ease.getPowOut(3);
        /**
         * cubic in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * cubic in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.cubicInOut = Ease.getPowInOut(3);
        /**
         * quart in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quart inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quartIn = Ease.getPowIn(4);
        /**
         * quart out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quart outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quartOut = Ease.getPowOut(4);
        /**
         * quart in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quart in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quartInOut = Ease.getPowInOut(4);
        /**
         * quint in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quint inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quintIn = Ease.getPowIn(5);
        /**
         * quint out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quint outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quintOut = Ease.getPowOut(5);
        /**
         * quint in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * quint in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.quintInOut = Ease.getPowInOut(5);
        /**
         * back in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * back inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.backIn = Ease.getBackIn(1.7);
        /**
         * back out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * back outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.backOut = Ease.getBackOut(1.7);
        /**
         * back in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * back in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.backInOut = Ease.getBackInOut(1.7);
        /**
         * elastic in.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * elastic inใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.elasticIn = Ease.getElasticIn(1, 0.3);
        /**
         * elastic out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * elastic outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.elasticOut = Ease.getElasticOut(1, 0.3);
        /**
         * elastic in out.See example.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * elastic in outใ่ฏทๆฅ็็คบไพ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Ease.elasticInOut = Ease.getElasticInOut(1, 0.3 * 1.5);
        return Ease;
    }());
    egret.Ease = Ease;
    __reflect(Ease.prototype, "egret.Ease");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    /**
     * Tween is the animation easing class of Egret
     * @see http://edn.egret.com/cn/docs/page/576 Tween ease animation
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/tween/Tween.ts
     * @language en_US
     */
    /**
     * TweenๆฏEgret็ๅจ็ป็ผๅจ็ฑป
     * @see http://edn.egret.com/cn/docs/page/576 Tween็ผๅจๅจ็ป
     * @version Egret 2.4
     * @platform Web,Native
     * @includeExample extension/tween/Tween.ts
     * @language zh_CN
     */
    var Tween = (function (_super) {
        __extends(Tween, _super);
        /**
         * ๅๅปบไธไธช egret.Tween ๅฏน่ฑก
         * @private
         * @version Egret 2.4
         * @platform Web,Native
         */
        function Tween(target, props, pluginData) {
            var _this = _super.call(this) || this;
            /**
             * @private
             */
            _this._target = null;
            /**
             * @private
             */
            _this._useTicks = false;
            /**
             * @private
             */
            _this.ignoreGlobalPause = false;
            /**
             * @private
             */
            _this.loop = false;
            /**
             * @private
             */
            _this.pluginData = null;
            /**
             * @private
             */
            _this._steps = null;
            /**
             * @private
             */
            _this.paused = false;
            /**
             * @private
             */
            _this.duration = 0;
            /**
             * @private
             */
            _this._prevPos = -1;
            /**
             * @private
             */
            _this.position = null;
            /**
             * @private
             */
            _this._prevPosition = 0;
            /**
             * @private
             */
            _this._stepPosition = 0;
            /**
             * @private
             */
            _this.passive = false;
            _this.initialize(target, props, pluginData);
            return _this;
        }
        /**
         * Activate an object and add a Tween animation to the object
         * @param target {any} The object to be activated
         * @param props {any} Parameters, support loop onChange onChangeObj
         * @param pluginData {any} Write realized
         * @param override {boolean} Whether to remove the object before adding a tween, the default value false
         * Not recommended, you can use Tween.removeTweens(target) instead.
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฟๆดปไธไธชๅฏน่ฑก๏ผๅฏนๅถๆทปๅ Tween ๅจ็ป
         * @param target {any} ่ฆๆฟๆดป Tween ็ๅฏน่ฑก
         * @param props {any} ๅๆฐ๏ผๆฏๆloop(ๅพช็ฏๆญๆพ) onChange(ๅๅๅฝๆฐ) onChangeObj(ๅๅๅฝๆฐไฝ็จๅ)
         * @param pluginData {any} ๆๆชๅฎ็ฐ
         * @param override {boolean} ๆฏๅฆ็งป้คๅฏน่ฑกไนๅๆทปๅ็tween๏ผ้ป่ฎคๅผfalseใ
         * ไธๅปบ่ฎฎไฝฟ็จ๏ผๅฏไฝฟ็จ Tween.removeTweens(target) ไปฃๆฟใ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.get = function (target, props, pluginData, override) {
            if (pluginData === void 0) {
                pluginData = null;
            }
            if (override === void 0) {
                override = false;
            }
            if (override) {
                Tween.removeTweens(target);
            }
            return new Tween(target, props, pluginData);
        };
        /**
         * Delete all Tween animations from an object
         * @param target The object whose Tween to be deleted
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้คไธไธชๅฏน่ฑกไธ็ๅจ้จ Tween ๅจ็ป
         * @param target  ้่ฆ็งป้ค Tween ็ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.removeTweens = function (target) {
            if (!target.tween_count) {
                return;
            }
            var tweens = Tween._tweens;
            for (var i = tweens.length - 1; i >= 0; i--) {
                if (tweens[i]._target == target) {
                    tweens[i].paused = true;
                    tweens.splice(i, 1);
                }
            }
            target.tween_count = 0;
        };
        /**
         * Pause all Tween animations of a certain object
         * @param target The object whose Tween to be paused
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๅๆไธชๅฏน่ฑก็ๆๆ Tween
         * @param target ่ฆๆๅ Tween ็ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.pauseTweens = function (target) {
            if (!target.tween_count) {
                return;
            }
            var tweens = egret.Tween._tweens;
            for (var i = tweens.length - 1; i >= 0; i--) {
                if (tweens[i]._target == target) {
                    tweens[i].paused = true;
                }
            }
        };
        /**
         * Resume playing all easing of a certain object
         * @param target The object whose Tween to be resumed
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ปง็ปญๆญๆพๆไธชๅฏน่ฑก็ๆๆ็ผๅจ
         * @param target ่ฆ็ปง็ปญๆญๆพ Tween ็ๅฏน่ฑก
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.resumeTweens = function (target) {
            if (!target.tween_count) {
                return;
            }
            var tweens = egret.Tween._tweens;
            for (var i = tweens.length - 1; i >= 0; i--) {
                if (tweens[i]._target == target) {
                    tweens[i].paused = false;
                }
            }
        };
        /**
         * @private
         *
         * @param delta
         * @param paused
         */
        Tween.tick = function (timeStamp, paused) {
            if (paused === void 0) {
                paused = false;
            }
            var delta = timeStamp - Tween._lastTime;
            Tween._lastTime = timeStamp;
            var tweens = Tween._tweens.concat();
            for (var i = tweens.length - 1; i >= 0; i--) {
                var tween_1 = tweens[i];
                if ((paused && !tween_1.ignoreGlobalPause) || tween_1.paused) {
                    continue;
                }
                tween_1.$tick(tween_1._useTicks ? 1 : delta);
            }
            return false;
        };
        /**
         * @private
         *
         * @param tween
         * @param value
         */
        Tween._register = function (tween, value) {
            var target = tween._target;
            var tweens = Tween._tweens;
            if (value) {
                if (target) {
                    target.tween_count = target.tween_count > 0 ? target.tween_count + 1 : 1;
                }
                tweens.push(tween);
                if (!Tween._inited) {
                    Tween._lastTime = egret.getTimer();
                    egret.ticker.$startTick(Tween.tick, null);
                    Tween._inited = true;
                }
            }
            else {
                if (target) {
                    target.tween_count--;
                }
                var i = tweens.length;
                while (i--) {
                    if (tweens[i] == tween) {
                        tweens.splice(i, 1);
                        return;
                    }
                }
            }
        };
        /**
         * Delete all Tween
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅ้คๆๆ Tween
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.removeAllTweens = function () {
            var tweens = Tween._tweens;
            for (var i = 0, l = tweens.length; i < l; i++) {
                var tween_2 = tweens[i];
                tween_2.paused = true;
                tween_2._target.tweenjs_count = 0;
            }
            tweens.length = 0;
        };
        /**
         * @private
         *
         * @param target
         * @param props
         * @param pluginData
         */
        Tween.prototype.initialize = function (target, props, pluginData) {
            this._target = target;
            if (props) {
                this._useTicks = props.useTicks;
                this.ignoreGlobalPause = props.ignoreGlobalPause;
                this.loop = props.loop;
                props.onChange && this.addEventListener("change", props.onChange, props.onChangeObj);
                if (props.override) {
                    Tween.removeTweens(target);
                }
            }
            this.pluginData = pluginData || {};
            this._curQueueProps = {};
            this._initQueueProps = {};
            this._steps = [];
            if (props && props.paused) {
                this.paused = true;
            }
            else {
                Tween._register(this, true);
            }
            if (props && props.position != null) {
                this.setPosition(props.position, Tween.NONE);
            }
        };
        /**
         * @private
         *
         * @param value
         * @param actionsMode
         * @returns
         */
        Tween.prototype.setPosition = function (value, actionsMode) {
            if (actionsMode === void 0) {
                actionsMode = 1;
            }
            if (value < 0) {
                value = 0;
            }
            //ๆญฃๅธธๅไฝ็ฝฎ
            var t = value;
            var end = false;
            if (t >= this.duration) {
                if (this.loop) {
                    var newTime = t % this.duration;
                    if (t > 0 && newTime === 0) {
                        t = this.duration;
                    }
                    else {
                        t = newTime;
                    }
                }
                else {
                    t = this.duration;
                    end = true;
                }
            }
            if (t == this._prevPos) {
                return end;
            }
            if (end) {
                this.setPaused(true);
            }
            var prevPos = this._prevPos;
            this.position = this._prevPos = t;
            this._prevPosition = value;
            if (this._target) {
                if (this._steps.length > 0) {
                    // ๆพๅฐๆฐ็tween
                    var l = this._steps.length;
                    var stepIndex = -1;
                    for (var i = 0; i < l; i++) {
                        if (this._steps[i].type == "step") {
                            stepIndex = i;
                            if (this._steps[i].t <= t && this._steps[i].t + this._steps[i].d >= t) {
                                break;
                            }
                        }
                    }
                    for (var i = 0; i < l; i++) {
                        if (this._steps[i].type == "action") {
                            //ๆง่กactions
                            if (actionsMode != 0) {
                                if (this._useTicks) {
                                    this._runAction(this._steps[i], t, t);
                                }
                                else if (actionsMode == 1 && t < prevPos) {
                                    if (prevPos != this.duration) {
                                        this._runAction(this._steps[i], prevPos, this.duration);
                                    }
                                    this._runAction(this._steps[i], 0, t, true);
                                }
                                else {
                                    this._runAction(this._steps[i], prevPos, t);
                                }
                            }
                        }
                        else if (this._steps[i].type == "step") {
                            if (stepIndex == i) {
                                var step = this._steps[stepIndex];
                                this._updateTargetProps(step, Math.min((this._stepPosition = t - step.t) / step.d, 1));
                            }
                        }
                    }
                }
            }
            this.dispatchEventWith("change");
            return end;
        };
        /**
         * @private
         *
         * @param startPos
         * @param endPos
         * @param includeStart
         */
        Tween.prototype._runAction = function (action, startPos, endPos, includeStart) {
            if (includeStart === void 0) {
                includeStart = false;
            }
            var sPos = startPos;
            var ePos = endPos;
            if (startPos > endPos) {
                //ๆๆๆ็ๅ็ฝฎ
                sPos = endPos;
                ePos = startPos;
            }
            var pos = action.t;
            if (pos == ePos || (pos > sPos && pos < ePos) || (includeStart && pos == startPos)) {
                action.f.apply(action.o, action.p);
            }
        };
        /**
         * @private
         *
         * @param step
         * @param ratio
         */
        Tween.prototype._updateTargetProps = function (step, ratio) {
            var p0, p1, v, v0, v1, arr;
            if (!step && ratio == 1) {
                this.passive = false;
                p0 = p1 = this._curQueueProps;
            }
            else {
                this.passive = !!step.v;
                //ไธๆดๆฐprops.
                if (this.passive) {
                    return;
                }
                //ไฝฟ็จease
                if (step.e) {
                    ratio = step.e(ratio, 0, 1, 1);
                }
                p0 = step.p0;
                p1 = step.p1;
            }
            for (var n in this._initQueueProps) {
                if ((v0 = p0[n]) == null) {
                    p0[n] = v0 = this._initQueueProps[n];
                }
                if ((v1 = p1[n]) == null) {
                    p1[n] = v1 = v0;
                }
                if (v0 == v1 || ratio == 0 || ratio == 1 || (typeof (v0) != "number")) {
                    v = ratio == 1 ? v1 : v0;
                }
                else {
                    v = v0 + (v1 - v0) * ratio;
                }
                var ignore = false;
                if (arr = Tween._plugins[n]) {
                    for (var i = 0, l = arr.length; i < l; i++) {
                        var v2 = arr[i].tween(this, n, v, p0, p1, ratio, !!step && p0 == p1, !step);
                        if (v2 == Tween.IGNORE) {
                            ignore = true;
                        }
                        else {
                            v = v2;
                        }
                    }
                }
                if (!ignore) {
                    this._target[n] = v;
                }
            }
        };
        /**
         * Whether setting is paused
         * @param value {boolean} Whether to pause
         * @returns Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่ฎพ็ฝฎๆฏๅฆๆๅ
         * @param value {boolean} ๆฏๅฆๆๅ
         * @returns Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.prototype.setPaused = function (value) {
            if (this.paused == value) {
                return this;
            }
            this.paused = value;
            Tween._register(this, !value);
            return this;
        };
        /**
         * @private
         *
         * @param props
         * @returns
         */
        Tween.prototype._cloneProps = function (props) {
            var o = {};
            for (var n in props) {
                o[n] = props[n];
            }
            return o;
        };
        /**
         * @private
         *
         * @param o
         * @returns
         */
        Tween.prototype._addStep = function (o) {
            if (o.d > 0) {
                o.type = "step";
                this._steps.push(o);
                o.t = this.duration;
                this.duration += o.d;
            }
            return this;
        };
        /**
         * @private
         *
         * @param o
         * @returns
         */
        Tween.prototype._appendQueueProps = function (o) {
            var arr, oldValue, i, l, injectProps;
            for (var n in o) {
                if (this._initQueueProps[n] === undefined) {
                    oldValue = this._target[n];
                    //่ฎพ็ฝฎplugins
                    if (arr = Tween._plugins[n]) {
                        for (i = 0, l = arr.length; i < l; i++) {
                            oldValue = arr[i].init(this, n, oldValue);
                        }
                    }
                    this._initQueueProps[n] = this._curQueueProps[n] = (oldValue === undefined) ? null : oldValue;
                }
                else {
                    oldValue = this._curQueueProps[n];
                }
            }
            for (var n in o) {
                oldValue = this._curQueueProps[n];
                if (arr = Tween._plugins[n]) {
                    injectProps = injectProps || {};
                    for (i = 0, l = arr.length; i < l; i++) {
                        if (arr[i].step) {
                            arr[i].step(this, n, oldValue, o[n], injectProps);
                        }
                    }
                }
                this._curQueueProps[n] = o[n];
            }
            if (injectProps) {
                this._appendQueueProps(injectProps);
            }
            return this._curQueueProps;
        };
        /**
         * @private
         *
         * @param o
         * @returns
         */
        Tween.prototype._addAction = function (o) {
            o.t = this.duration;
            o.type = "action";
            this._steps.push(o);
            return this;
        };
        /**
         * @private
         *
         * @param props
         * @param o
         */
        Tween.prototype._set = function (props, o) {
            for (var n in props) {
                o[n] = props[n];
            }
        };
        /**
         * Wait the specified milliseconds before the execution of the next animation
         * @param duration {number} Waiting time, in milliseconds
         * @param passive {boolean} Whether properties are updated during the waiting time
         * @returns Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ็ญๅพๆๅฎๆฏซ็งๅๆง่กไธไธไธชๅจ็ป
         * @param duration {number} ่ฆ็ญๅพ็ๆถ้ด๏ผไปฅๆฏซ็งไธบๅไฝ
         * @param passive {boolean} ็ญๅพๆ้ดๅฑๆงๆฏๅฆไผๆดๆฐ
         * @returns Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.prototype.wait = function (duration, passive) {
            if (duration == null || duration <= 0) {
                return this;
            }
            var o = this._cloneProps(this._curQueueProps);
            return this._addStep({ d: duration, p0: o, p1: o, v: passive });
        };
        /**
         * Modify the property of the specified object to a specified value
         * @param props {Object} Property set of an object
         * @param duration {number} Duration
         * @param ease {egret.Ease} Easing algorithm
         * @returns {egret.Tween} Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๅฐๆๅฎๅฏน่ฑก็ๅฑๆงไฟฎๆนไธบๆๅฎๅผ
         * @param props {Object} ๅฏน่ฑก็ๅฑๆง้ๅ
         * @param duration {number} ๆ็ปญๆถ้ด
         * @param ease {egret.Ease} ็ผๅจ็ฎๆณ
         * @returns {egret.Tween} Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.prototype.to = function (props, duration, ease) {
            if (ease === void 0) {
                ease = undefined;
            }
            if (isNaN(duration) || duration < 0) {
                duration = 0;
            }
            this._addStep({ d: duration || 0, p0: this._cloneProps(this._curQueueProps), e: ease, p1: this._cloneProps(this._appendQueueProps(props)) });
            //ๅๅฅไธๆญฅset๏ผ้ฒๆญขๆธธๆๆๅถๅก้กฟๆถๅ๏ผtoๅ้ข็callๅๅฐ็ๅฑๆงๅผไธๅฏน
            return this.set(props);
        };
        /**
         * Execute callback function
         * @param callback {Function} Callback method
         * @param thisObj {any} this action scope of the callback method
         * @param params {any[]} Parameter of the callback method
         * @returns {egret.Tween} Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @example
         * <pre>
         *  egret.Tween.get(display).call(function (a:number, b:string) {
         *      console.log("a: " + a); // the first parameter passed 233
         *      console.log("b: " + b); // the second parameter passed โhelloโ
         *  }, this, [233, "hello"]);
         * </pre>
         * @language en_US
         */
        /**
         * ๆง่กๅ่ฐๅฝๆฐ
         * @param callback {Function} ๅ่ฐๆนๆณ
         * @param thisObj {any} ๅ่ฐๆนๆณthisไฝ็จๅ
         * @param params {any[]} ๅ่ฐๆนๆณๅๆฐ
         * @returns {egret.Tween} Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @example
         * <pre>
         *  egret.Tween.get(display).call(function (a:number, b:string) {
         *      console.log("a: " + a); //ๅฏนๅบไผๅฅ็็ฌฌไธไธชๅๆฐ 233
         *      console.log("b: " + b); //ๅฏนๅบไผๅฅ็็ฌฌไบไธชๅๆฐ โhelloโ
         *  }, this, [233, "hello"]);
         * </pre>
         * @language zh_CN
         */
        Tween.prototype.call = function (callback, thisObj, params) {
            if (thisObj === void 0) {
                thisObj = undefined;
            }
            if (params === void 0) {
                params = undefined;
            }
            return this._addAction({ f: callback, p: params ? params : [], o: thisObj ? thisObj : this._target });
        };
        /**
         * Now modify the properties of the specified object to the specified value
         * @param props {Object} Property set of an object
         * @param target The object whose Tween to be resumed
         * @returns {egret.Tween} Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         */
        /**
         * ็ซๅณๅฐๆๅฎๅฏน่ฑก็ๅฑๆงไฟฎๆนไธบๆๅฎๅผ
         * @param props {Object} ๅฏน่ฑก็ๅฑๆง้ๅ
         * @param target ่ฆ็ปง็ปญๆญๆพ Tween ็ๅฏน่ฑก
         * @returns {egret.Tween} Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         */
        Tween.prototype.set = function (props, target) {
            if (target === void 0) {
                target = null;
            }
            //ๆดๆฐๅฝๅๆฐๆฎ๏ผไฟ่ฏ็ผๅจๆต็ๆง
            this._appendQueueProps(props);
            return this._addAction({ f: this._set, o: this, p: [props, target ? target : this._target] });
        };
        /**
         * Execute
         * @param tween {egret.Tween} The Tween object to be operated. Default: this
         * @returns {egret.Tween} Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆง่ก
         * @param tween {egret.Tween} ้่ฆๆไฝ็ Tween ๅฏน่ฑก๏ผ้ป่ฎคthis
         * @returns {egret.Tween} Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.prototype.play = function (tween) {
            if (!tween) {
                tween = this;
            }
            return this.call(tween.setPaused, tween, [false]);
        };
        /**
         * Pause
         * @param tween {egret.Tween} The Tween object to be operated. Default: this
         * @returns {egret.Tween} Tween object itself
         * @version Egret 2.4
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆๅ
         * @param tween {egret.Tween} ้่ฆๆไฝ็ Tween ๅฏน่ฑก๏ผ้ป่ฎคthis
         * @returns {egret.Tween} Tweenๅฏน่ฑกๆฌ่บซ
         * @version Egret 2.4
         * @platform Web,Native
         * @language zh_CN
         */
        Tween.prototype.pause = function (tween) {
            if (!tween) {
                tween = this;
            }
            return this.call(tween.setPaused, tween, [true]);
        };
        /**
         * @method egret.Tween#tick
         * @param delta {number}
         * @private
         * @version Egret 2.4
         * @platform Web,Native
         */
        Tween.prototype.$tick = function (delta) {
            if (this.paused) {
                return;
            }
            this.setPosition(this._prevPosition + delta);
        };
        /**
         * ไธๅ็นๆฎๅค็
         * @constant {number} egret.Tween.NONE
         * @private
         */
        Tween.NONE = 0;
        /**
         * ๅพช็ฏ
         * @constant {number} egret.Tween.LOOP
         * @private
         */
        Tween.LOOP = 1;
        /**
         * ๅๅบ
         * @constant {number} egret.Tween.REVERSE
         * @private
         */
        Tween.REVERSE = 2;
        /**
         * @private
         */
        Tween._tweens = [];
        /**
         * @private
         */
        Tween.IGNORE = {};
        /**
         * @private
         */
        Tween._plugins = {};
        /**
         * @private
         */
        Tween._inited = false;
        Tween._lastTime = 0;
        return Tween;
    }(egret.EventDispatcher));
    egret.Tween = Tween;
    __reflect(Tween.prototype, "egret.Tween");
})(egret || (egret = {}));
//////////////////////////////////////////////////////////////////////////////////////
//
//  Copyright (c) 2014-present, Egret Technology.
//  All rights reserved.
//  Redistribution and use in source and binary forms, with or without
//  modification, are permitted provided that the following conditions are met:
//
//     * Redistributions of source code must retain the above copyright
//       notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above copyright
//       notice, this list of conditions and the following disclaimer in the
//       documentation and/or other materials provided with the distribution.
//     * Neither the name of the Egret nor the
//       names of its contributors may be used to endorse or promote products
//       derived from this software without specific prior written permission.
//
//  THIS SOFTWARE IS PROVIDED BY EGRET AND CONTRIBUTORS "AS IS" AND ANY EXPRESS
//  OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
//  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
//  IN NO EVENT SHALL EGRET AND CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
//  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
//  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA,
//  OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
//  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
//  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
//  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//////////////////////////////////////////////////////////////////////////////////////
var egret;
(function (egret) {
    var tween;
    (function (tween) {
        /**
         * Abstract class, Indicate the base action.
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ๆฝ่ฑก็ฑป๏ผ่กจ็คบไธไธชๅบๆฌๅจไฝ
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        var BasePath = (function (_super) {
            __extends(BasePath, _super);
            function BasePath() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * the name of this action.
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๅจไฝ็ๅ็งฐ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.name = "";
                return _this;
            }
            return BasePath;
        }(egret.EventDispatcher));
        tween.BasePath = BasePath;
        __reflect(BasePath.prototype, "egret.tween.BasePath");
        /**
         * Indicate the to action. See <code>Tween.to</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบไธไธชtoๅจไฝ๏ผๅ่ง<code>Tween.to</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        var To = (function (_super) {
            __extends(To, _super);
            function To() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * Property set of an object
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๅฏน่ฑก็ๅฑๆง้ๅ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.props = undefined;
                /**
                 * Duration
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๆ็ปญๆถ้ด
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.duration = 500;
                /**
                 * Easing algorithm
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ็ผๅจ็ฎๆณ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.ease = undefined;
                return _this;
            }
            return To;
        }(BasePath));
        tween.To = To;
        __reflect(To.prototype, "egret.tween.To");
        /**
         * Indicate the wait action. See <code>Tween.wait</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบไธไธชwaitๅจไฝ๏ผๅ่ง<code>Tween.wait</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        var Wait = (function (_super) {
            __extends(Wait, _super);
            function Wait() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * Duration
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๆ็ปญๆถ้ด
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.duration = 500;
                /**
                 * Whether properties are updated during the waiting time
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ็ญๅพๆ้ดๅฑๆงๆฏๅฆไผๆดๆฐ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.passive = undefined;
                return _this;
            }
            return Wait;
        }(BasePath));
        tween.Wait = Wait;
        __reflect(Wait.prototype, "egret.tween.Wait");
        /**
         * Indicate the set action. See <code>Tween.set</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบไธไธชsetๅจไฝ๏ผๅ่ง<code>Tween.set</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        var Set = (function (_super) {
            __extends(Set, _super);
            function Set() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * Property set of an object
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๅฏน่ฑก็ๅฑๆง้ๅ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.props = undefined;
                return _this;
            }
            return Set;
        }(BasePath));
        tween.Set = Set;
        __reflect(Set.prototype, "egret.tween.Set");
        /**
         * Indicate the tick action. See <code>Tween.tick</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * ่กจ็คบไธไธชtickๅจไฝ๏ผๅ่ง<code>Tween.tick</code>
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        var Tick = (function (_super) {
            __extends(Tick, _super);
            function Tick() {
                var _this = _super !== null && _super.apply(this, arguments) || this;
                /**
                 * Delta time
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * ๅขๅ็ๆถ้ด
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                _this.delta = 0;
                return _this;
            }
            return Tick;
        }(BasePath));
        tween.Tick = Tick;
        __reflect(Tick.prototype, "egret.tween.Tick");
        function convertEase(ease) {
            if (typeof ease === 'function') {
                return ease;
            }
            else {
                var func = egret.Ease[ease];
                if (typeof func === 'function') {
                    return func;
                }
            }
            return null;
        }
        /**
         * TweenItem is a wrapper for Tween, which can set the behavior of Tween by setting attributes and adding Path.
         *
         * @event pathComplete Dispatched when some Path has complete.
         * @event complete Dispatched when all Paths has complete.
         *
         * @defaultProperty props
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language en_US
         */
        /**
         * TweenItemๆฏๅฏนTween็ๅ่ฃๅจ๏ผ่ฝ้่ฟ่ฎพ็ฝฎๅฑๆงๅๆทปๅPath็ๆนๅผ่ฎพ็ฝฎTween็่กไธบใ
         * ้ๅธธ็จไบไฝฟ็จๅจEXMLไธญๅฎไน็ปไปถ็ๅจ็ปใ
         *
         * @event pathComplete ๅฝๆไธชPathๆง่กๅฎๆฏๆถไผๆดพๅๆญคไบไปถใ
         * @event complete ๅฝๆๆPathๆง่กๅฎๆฏๆถไผๆดพๅๆญคไบไปถใ
         *
         * @defaultProperty props
         * @version Egret 3.1.8
         * @platform Web,Native
         * @language zh_CN
         */
        /**
         * Use in exml:
         * ```
         * 	<tween:TweenItem target="{this.button}">
         * 		<tween:props>
         * 			<e:Object loop="{true}"/>
         * 		</tween:props>
         * 		<tween:paths>
         * 			<e:Array>
         * 				<tween:To duration="500">
         * 					<tween:props>
         * 						<e:Object x="{100}" y="{200}" />
         * 					</tween:props>
         * 				</tween:To>
         * 				<tween:Wait duration="1000" />
         * 				<tween:To duration="1000">
         * 					<tween:props>
         * 						<e:Object x="{200}" y="{100}" />
         * 					</tween:props>
         * 				</tween:To>
         * 			</e:Array>
         * 		</tween:paths>
         * 	</tween:TweenItem>
         * ```
         */
        var TweenItem = (function (_super) {
            __extends(TweenItem, _super);
            function TweenItem() {
                var _this = _super.call(this) || this;
                _this.isStop = false;
                return _this;
            }
            Object.defineProperty(TweenItem.prototype, "props", {
                /**
                 * The Tween's props.
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * Tween็propsๅๆฐใ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                get: function () {
                    return this._props;
                },
                set: function (value) {
                    this._props = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(TweenItem.prototype, "target", {
                /**
                 * The Tween's target.
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * Tween็targetๅๆฐใ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                get: function () {
                    return this._target;
                },
                set: function (value) {
                    this._target = value;
                },
                enumerable: true,
                configurable: true
            });
            Object.defineProperty(TweenItem.prototype, "paths", {
                /**
                 * The Actions in Tween.
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * TweenItemไธญๆทปๅ็่กไธบใ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                get: function () {
                    return this._paths;
                },
                set: function (value) {
                    this._paths = value || [];
                },
                enumerable: true,
                configurable: true
            });
            /**
             * Play the Tween
             * @position The starting position, the default is from the last position to play
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญๆพTween
             * @position ๆญๆพ็่ตทๅงไฝ็ฝฎ, ้ป่ฎคไธบไปไธๆฌกไฝ็ฝฎ็ปง็ปญๆญๆพ
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenItem.prototype.play = function (position) {
                if (!this.tween) {
                    this.createTween(position);
                }
                else {
                    this.tween.setPaused(false);
                    if (this.isStop && position == undefined) {
                        position = 0;
                        this.isStop = false;
                    }
                    if (position !== undefined && position !== null) {
                        this.tween.setPosition(position);
                    }
                }
            };
            /**
             * Pause the Tween
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅTween
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenItem.prototype.pause = function () {
                if (this.tween) {
                    this.tween.setPaused(true);
                }
            };
            /**
             * Stop the Tween
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅๆญขTween
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenItem.prototype.stop = function () {
                this.pause();
                this.isStop = true;
            };
            TweenItem.prototype.createTween = function (position) {
                this.tween = egret.Tween.get(this._target, this._props);
                if (this._paths) {
                    this.applyPaths();
                }
                if (position !== undefined && position !== null) {
                    this.tween.setPosition(position);
                }
            };
            TweenItem.prototype.applyPaths = function () {
                for (var i = 0; i < this._paths.length; i++) {
                    var path = this._paths[i];
                    this.applyPath(path);
                }
            };
            TweenItem.prototype.applyPath = function (path) {
                var _this = this;
                if (path instanceof To) {
                    this.tween.to(path.props, path.duration, convertEase(path.ease));
                }
                else if (path instanceof Wait) {
                    this.tween.wait(path.duration, path.passive);
                }
                else if (path instanceof Set) {
                    this.tween.set(path.props);
                }
                else if (path instanceof Tick) {
                    this.tween.$tick(path.delta);
                }
                this.tween.call(function () { return _this.pathComplete(path); });
            };
            TweenItem.prototype.pathComplete = function (path) {
                path.dispatchEventWith('complete');
                this.dispatchEventWith('pathComplete', false, path);
                var index = this._paths.indexOf(path);
                if (index >= 0 && index === this._paths.length - 1) {
                    this.dispatchEventWith('complete');
                }
            };
            return TweenItem;
        }(egret.EventDispatcher));
        tween.TweenItem = TweenItem;
        __reflect(TweenItem.prototype, "egret.tween.TweenItem");
        registerProperty(TweenItem, 'paths', 'Array', true);
        /**
         * TweenGroup is a collection of TweenItem that can be played in parallel with each Item
         *
         * @event itemComplete Dispatched when some TweenItem has complete.
         * @event complete Dispatched when all TweenItems has complete.
         *
         * @version Egret 3.1.8
         * @platform Web,Native
         * @includeExample extension/tween/TweenWrapper.ts
         * @language en_US
         */
        /**
         * TweenGroupๆฏTweenItem็้ๅ๏ผๅฏไปฅๅนถ่กๆญๆพๆฏไธไธชItem
         * @version Egret 3.1.8
         * @platform Web,Native
         * @includeExample extension/tween/TweenWrapper.ts
         * @language zh_CN
         */
        var TweenGroup = (function (_super) {
            __extends(TweenGroup, _super);
            function TweenGroup() {
                var _this = _super.call(this) || this;
                _this.completeCount = 0;
                return _this;
            }
            Object.defineProperty(TweenGroup.prototype, "items", {
                /**
                 * The Array that TweenItems in TweenGroup.
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language en_US
                 */
                /**
                 * TweenGroup่ฆๆงๅถ็TweenItem้ๅใ
                 * @version Egret 3.1.8
                 * @platform Web,Native
                 * @language zh_CN
                 */
                get: function () {
                    return this._items;
                },
                set: function (value) {
                    this.completeCount = 0;
                    this.registerEvent(false);
                    this._items = value;
                    this.registerEvent(true);
                },
                enumerable: true,
                configurable: true
            });
            TweenGroup.prototype.registerEvent = function (add) {
                var _this = this;
                this._items && this._items.forEach(function (item) {
                    if (add) {
                        item.addEventListener('complete', _this.itemComplete, _this);
                    }
                    else {
                        item.removeEventListener('complete', _this.itemComplete, _this);
                    }
                });
            };
            /**
             * Play the all TweenItems
             * @time The starting position, the default is from the last position to playใIf use 0, the group will play from the start position.
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆญๆพๆๆ็TweenItem
             * @time ๆญๆพ็่ตทๅงไฝ็ฝฎ, ้ป่ฎคไธบไปไธๆฌกไฝ็ฝฎ็ปง็ปญๆญๆพใๅฆๆไธบ0๏ผๅไป่ตทๅงไฝ็ฝฎๅผๅงๆญๆพใ
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenGroup.prototype.play = function (time) {
                if (!this._items) {
                    return;
                }
                for (var i = 0; i < this._items.length; i++) {
                    var item = this._items[i];
                    item.play(time);
                }
            };
            /**
             * Pause the all TweenItems
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๆๅๆญๆพๆๆ็TweenItem
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenGroup.prototype.pause = function () {
                if (!this._items) {
                    return;
                }
                for (var i = 0; i < this._items.length; i++) {
                    var item = this._items[i];
                    item.pause();
                }
            };
            /**
             * Stop the all TweenItems
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language en_US
             */
            /**
             * ๅๆญขๆๆ็TweenItem
             * @version Egret 3.1.8
             * @platform Web,Native
             * @language zh_CN
             */
            TweenGroup.prototype.stop = function () {
                if (!this._items) {
                    return;
                }
                for (var i = 0; i < this._items.length; i++) {
                    var item = this._items[i];
                    item.stop();
                }
            };
            TweenGroup.prototype.itemComplete = function (e) {
                var item = e.currentTarget;
                this.completeCount++;
                this.dispatchEventWith('itemComplete', false, item);
                if (this.completeCount === this.items.length) {
                    this.dispatchEventWith('complete');
                    this.completeCount = 0;
                }
            };
            return TweenGroup;
        }(egret.EventDispatcher));
        tween.TweenGroup = TweenGroup;
        __reflect(TweenGroup.prototype, "egret.tween.TweenGroup");
        registerProperty(TweenGroup, 'items', 'Array', true);
        function registerProperty(classDefinition, property, type, asDefault) {
            var prototype = classDefinition.prototype;
            prototype.__meta__ = prototype.__meta__ || {};
            prototype.__meta__[property] = type;
            if (asDefault) {
                prototype.__defaultProperty__ = property;
            }
        }
    })(tween = egret.tween || (egret.tween = {}));
})(egret || (egret = {}));
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-06
 * @modify date 2017-09-06
 *
 * ่ฟไธชๆไปถ็ๅญๅจๆฏไธบไบๅฏน็ฐๆjsๅ่ฝๆ่กฅไธไฟฎbug็ญ
*/
/** ไฟฎๅคArray.findIndexไผ่ขซ้ๅๅฐ็้ฎ้ข */
if (Array.prototype.hasOwnProperty("findIndex")) {
    var desc = Object.getOwnPropertyDescriptor(Array.prototype, "findIndex");
    if (desc.enumerable) {
        desc.enumerable = false;
        Object.defineProperty(Array.prototype, "findIndex", desc);
    }
}
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-11
 * @modify date 2017-09-11
 *
 * ๅฏน่ฑกๅทฅๅท้
*/
define("src/trunk/utils/ObjectUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * populate properties
     * @param target        ็ฎๆobj
     * @param sources       ๆฅๆบobj
     */
    function extendObject(target) {
        var sources = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            sources[_i - 1] = arguments[_i];
        }
        sources.forEach(function (source) {
            if (!source)
                return;
            for (var propName in source) {
                if (source.hasOwnProperty(propName)) {
                    target[propName] = source[propName];
                }
            }
        });
        return target;
    }
    exports.extendObject = extendObject;
    /**
     * ๅคๅถๅฏน่ฑก
     * @param target ่ฆๅคๅถ็ๅฏน่ฑก
     * @param deep ๆฏๅฆๆทฑ่กจๅคๅถ๏ผ้ป่ฎคๆต่กจๅคๅถ
     * @returns {any} ๅคๅถๅ็ๅฏน่ฑก
     */
    function cloneObject(target, deep) {
        if (deep === void 0) { deep = false; }
        if (target == null)
            return null;
        var newObject = {};
        for (var key in target) {
            var value = target[key];
            if (deep && typeof value == "object") {
                // ๅฆๆๆฏๆทฑ่กจๅคๅถ๏ผๅ้่ฆ้ๅฝๅคๅถๅญๅฏน่ฑก
                value = cloneObject(value, true);
            }
            newObject[key] = value;
        }
        return newObject;
    }
    exports.cloneObject = cloneObject;
    /**
     * ็ๆไธไธช้ๆบID
     */
    function getGUID() {
        var s = [];
        var hexDigits = "0123456789abcdef";
        for (var i_1 = 0; i_1 < 36; i_1++) {
            s[i_1] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
        }
        s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
        s[19] = hexDigits.substr((parseInt(s[19]) & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
        s[8] = s[13] = s[18] = s[23] = "-";
        return s.join("");
    }
    exports.getGUID = getGUID;
    var _getAutoIncIdMap = {};
    /**
     * ็ๆ่ชๅขid๏ผไป0ๅผๅง๏ผ
     * @param type
     */
    function getAutoIncId(type) {
        var index = _getAutoIncIdMap[type] || 0;
        _getAutoIncIdMap[type] = index++;
        return type + "-" + index;
    }
    exports.getAutoIncId = getAutoIncId;
    /**
     * ๅคๆญๅฏน่ฑกๆฏๅฆไธบnullๆ่็ฉบๅฏน่ฑก
     * @param obj ่ฆๅคๆญ็ๅฏน่ฑก
     * @returns {boolean} ๆฏๅฆไธบnullๆ่็ฉบๅฏน่ฑก
     */
    function isEmpty(obj) {
        var result = true;
        for (var key in obj) {
            result = false;
            break;
        }
        return result;
    }
    exports.isEmpty = isEmpty;
    /**
     * ็งป้คdataไธญๅๅซ็็ฉบๅผ็จๆๆชๅฎไน
     * @param data ่ฆ่ขซ็งป้ค็ฉบๅผ็จๆๆชๅฎไน็ๅฏน่ฑก
     */
    function trimData(data) {
        for (var key in data) {
            if (data[key] == null) {
                delete data[key];
            }
        }
        return data;
    }
    exports.trimData = trimData;
    /**
     * ่ฎฉchild็ฑป็ปงๆฟ่ชparent็ฑป
     * @param child ๅญ็ฑป
     * @param parent ็ถ็ฑป
     */
    exports.extendsClass = (function () {
        var extendStatics = Object["setPrototypeOf"] ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return function (d, b) {
            extendStatics(d, b);
            function __() { this.constructor = d; }
            d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
        };
    })();
    var hash = 0;
    var hashTypes = ["object", "function"];
    /**
     * ่ทๅไธไธชๅฏน่ฑก็ๅฏน่ฑกๅๅธๅญ็ฌฆไธฒ
     *
     * @export
     * @param {*} target ไปปๆๅฏน่ฑก๏ผๅฏไปฅๆฏๅบ็ก็ฑปๅๆnull
     * @returns {string} ๅๅธๅผ
     */
    function getObjectHash(target) {
        if (target == null)
            return "__object_hash_0__";
        var key = "__object_hash__";
        var value;
        // ๅชๆๅฝๅๅฏน่ฑกไธๆkeyๆ็ฎ
        if (target.hasOwnProperty(key))
            value = target[key];
        // ๅฆๆๅทฒ็ปๆๅๅธๅผๅ็ดๆฅ่ฟๅ
        if (value)
            return value;
        // ๅฆๆๆฏๅบ็ก็ฑปๅๅ็ดๆฅ่ฟๅๅฏนๅบๅญ็ฌฆไธฒ
        var type = typeof target;
        if (hashTypes.indexOf(type) < 0)
            return type + ":" + target;
        // ๅฆๆๆฏๅคๆ็ฑปๅๅ่ฟๅ่ฎก็ฎ็ๅๅธๅผๅนถๆไธๆ็ญพ
        var value = "__object_hash_" + (++hash) + "__";
        Object.defineProperty(target, key, {
            configurable: true,
            enumerable: false,
            writable: false,
            value: value
        });
        return value;
    }
    exports.getObjectHash = getObjectHash;
    /**
     * ่ทๅๅคไธชๅฏน่ฑก็ๅๅธๅญ็ฌฆไธฒ๏ผไผๅฏนๆฏไธชๅฏน่ฑก่ฐ็จgetObjectHash็ๆๅไธชๅๅธๅผ๏ผๅนถ็จ|่ฟๆฅ
     *
     * @export
     * @param {...any[]} targets ๅธๆ่ทๅๅๅธๅผ็ๅฏน่ฑกๅ่กจ
     * @returns {string} ๅคไธชๅฏน่ฑกๅฑๅไฝ็จไธ็ๅๅธๅผ
     */
    function getObjectHashs() {
        var targets = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            targets[_i] = arguments[_i];
        }
        var values = targets.map(function (target) { return getObjectHash(target); });
        return values.join("|");
    }
    exports.getObjectHashs = getObjectHashs;
});
define("src/trunk/utils/Dictionary", ["require", "exports", "src/trunk/utils/ObjectUtil"], function (require, exports, ObjectUtil_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-15
     * @modify date 2017-09-15
     *
     * ๅญๅธ๏ผๆฏๆkeyไธบไปปๆ็ฑปๅ็ๅฏน่ฑก
    */
    var Dictionary = /** @class */ (function () {
        function Dictionary() {
            this._keyDict = {};
            this._valueDict = {};
        }
        Object.defineProperty(Dictionary.prototype, "size", {
            /**
             * ่ทๅๅญๅธๅ็ๅ็ดๆฐ้
             *
             * @readonly
             * @type {number}
             * @memberof Dictionary
             */
            get: function () {
                var size = 0;
                for (var hash in this._keyDict)
                    size++;
                return size;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ฎพ็ฝฎไธไธช้ฎๅผๅฏน
         *
         * @param {K} key ้ฎ
         * @param {V} value ๅผ
         * @memberof Dictionary
         */
        Dictionary.prototype.set = function (key, value) {
            var hash = ObjectUtil_1.getObjectHash(key);
            this._keyDict[hash] = key;
            this._valueDict[hash] = value;
        };
        /**
         * ่ทๅไธไธชๅผ
         *
         * @param {K} key ้ฎ
         * @returns {V} ๅผ
         * @memberof Dictionary
         */
        Dictionary.prototype.get = function (key) {
            var hash = ObjectUtil_1.getObjectHash(key);
            return this._valueDict[hash];
        };
        /**
         * ๅ้คไธไธช้ฎๅผๅฏน
         *
         * @param {K} key ้ฎ
         * @memberof Dictionary
         */
        Dictionary.prototype.delete = function (key) {
            var hash = ObjectUtil_1.getObjectHash(key);
            delete this._keyDict[hash];
            delete this._valueDict[hash];
        };
        /**
         * ้ๅๅญๅธ
         *
         * @param {(key:K, value:V)=>void} callback ๆฏๆฌก้ๅ็ๅ่ฐ
         * @memberof Dictionary
         */
        Dictionary.prototype.forEach = function (callback) {
            for (var hash in this._keyDict) {
                var key = this._keyDict[hash];
                var value = this._valueDict[hash];
                callback(key, value);
            }
        };
        return Dictionary;
    }());
    exports.default = Dictionary;
});
/// <reference path="../../core/global/IConstructor.ts"/>
define("src/trunk/core/interfaces/IConstructor", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/command/Command", ["require", "exports", "src/trunk/core/Core"], function (require, exports, Core_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-01
     * @modify date 2017-09-01
     *
     * ๅๆธๅฝไปค็ฑป๏ผๅๆธๅฝไปคๅจๆณจๅไบๆถๆฏๅๅฏไปฅๅจๆถๆฏๆดพๅๆถ่ขซๆง่ก
    */
    var Command = /** @class */ (function () {
        function Command(msg) {
            this.msg = msg;
        }
        Command.prototype.dispatch = function (typeOrMsg) {
            var params = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                params[_i - 1] = arguments[_i];
            }
            Core_1.core.dispatch.apply(Core_1.core, [typeOrMsg].concat(params));
        };
        return Command;
    }());
    exports.default = Command;
});
define("src/trunk/core/command/ICommandConstructor", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/observable/IObservable", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/message/IMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/interfaces/IDisposable", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/message/Message", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * ๆถๆฏๅบ็ฑป
    */
    var Message = /** @class */ (function () {
        function Message(type) {
            this._type = type;
        }
        Object.defineProperty(Message.prototype, "type", {
            /**
             * ่ทๅๆถๆฏ็ฑปๅๅญ็ฌฆไธฒ
             *
             * @readonly
             * @type {string}
             * @memberof Message
             */
            get: function () {
                return this._type;
            },
            enumerable: true,
            configurable: true
        });
        return Message;
    }());
    exports.default = Message;
});
define("src/trunk/core/message/CommonMessage", ["require", "exports", "src/trunk/core/message/Message"], function (require, exports, Message_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-01
     * @modify date 2017-09-01
     *
     * ๆกๆถๅๆธ้็จๆถๆฏ
    */
    var CommonMessage = /** @class */ (function (_super) {
        __extends(CommonMessage, _super);
        /**
         * Creates an instance of Message.
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {...any[]} params ๅฏ่ฝ็ๆถๆฏๅๆฐๅ่กจ
         * @memberof Message
         */
        function CommonMessage(type) {
            var params = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                params[_i - 1] = arguments[_i];
            }
            var _this = _super.call(this, type) || this;
            _this.params = params;
            return _this;
        }
        return CommonMessage;
    }(Message_1.default));
    exports.default = CommonMessage;
});
define("src/trunk/core/message/CoreMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-13
     * @modify date 2017-09-13
     *
     * ๆธๅฟไบไปถ็ฑปๅ
    */
    var CoreMessage = /** @class */ (function () {
        function CoreMessage() {
        }
        /**
         * ไปปไฝๆถๆฏๆดพๅๅฐๆกๆถๅ้ฝไผๆดพๅ่ฟไธชๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof CoreMessage
         */
        CoreMessage.MESSAGE_DISPATCHED = "messageDispatched";
        return CoreMessage;
    }());
    exports.default = CoreMessage;
});
define("src/trunk/core/observable/Observable", ["require", "exports", "src/trunk/core/message/CommonMessage", "src/trunk/core/message/CoreMessage"], function (require, exports, CommonMessage_1, CoreMessage_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-31
     * @modify date 2017-10-31
     *
     * ๅฏ่งๅฏๆฅๅฃ็้ป่ฎคๅฎ็ฐๅฏน่ฑก๏ผไผๅฐๆถๅฐ็ๆถๆฏ้็ฅ็ปๆณจๅ็ๅ่ฐ
    */
    var Observable = /** @class */ (function () {
        function Observable() {
            this._listenerDict = {};
            this._commandDict = {};
            this._disposed = false;
        }
        Observable.prototype.handleMessages = function (msg) {
            var listeners1 = this._listenerDict[msg.type];
            var listeners2 = this._listenerDict[msg.constructor.toString()];
            var listeners = (listeners1 && listeners2 ? listeners1.concat(listeners2) : listeners1 || listeners2);
            if (listeners) {
                listeners = listeners.concat();
                for (var _i = 0, listeners_1 = listeners; _i < listeners_1.length; _i++) {
                    var temp = listeners_1[_i];
                    // ่ฐ็จๅค็ๅฝๆฐ
                    if (msg instanceof CommonMessage_1.default)
                        // ๅฆๆๆฏ้็จๆถๆฏ๏ผๅๅฐๅๆฐ็ปๆๅ่ฐ็จๅ่ฐ
                        (_a = temp.handler).call.apply(_a, [temp.thisArg].concat(msg.params));
                    else
                        // ๅฆๆๆฏๅถไปๆถๆฏ๏ผๅ็ดๆฅๅฐๆถๆฏไฝไผ็ปๅ่ฐ
                        temp.handler.call(temp.thisArg, msg);
                }
            }
            var _a;
        };
        Observable.prototype.doDispatch = function (msg) {
            // ่ฎพ็ฝฎๆๅฑๅๆธ
            Object.defineProperty(msg, "__observable", {
                configurable: true,
                enumerable: false,
                value: this,
                writable: false
            });
            // ่งฆๅๅฝไปค
            this.handleCommands(msg);
            // ่งฆๅ็จlistenๅฝขๅผ็ๅฌ็ๆถๆฏ
            this.handleMessages(msg);
        };
        /** dispatchๆนๆณๅฎ็ฐ */
        Observable.prototype.dispatch = function (typeOrMsg) {
            var params = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                params[_i - 1] = arguments[_i];
            }
            // ็ปไธๆถๆฏๅฏน่ฑก
            var msg = typeOrMsg;
            if (typeof typeOrMsg == "string") {
                msg = new CommonMessage_1.default(typeOrMsg);
                msg.params = params;
            }
            // ๆดพๅๆถๆฏ
            this.doDispatch(msg);
            // ้ขๅคๆดพๅไธไธช้็จไบไปถ
            this.doDispatch(new CommonMessage_1.default(CoreMessage_1.default.MESSAGE_DISPATCHED, msg));
        };
        /**
         * ็ๅฌๅๆธๆถๆฏ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Observable
         */
        Observable.prototype.listen = function (type, handler, thisArg) {
            type = (typeof type == "string" ? type : type.toString());
            var listeners = this._listenerDict[type];
            if (!listeners)
                this._listenerDict[type] = listeners = [];
            // ๆฃๆฅๅญๅจๆง
            for (var i = 0, len = listeners.length; i < len; i++) {
                var temp = listeners[i];
                // ๅฆๆๅทฒ็ปๅญๅจ็ๅฌๅ็ดๆฅ่ฟๅ
                if (temp.handler == handler && temp.thisArg == thisArg)
                    return;
            }
            // ๆทปๅ็ๅฌ
            listeners.push({ handler: handler, thisArg: thisArg });
        };
        /**
         * ็งป้คๅๆธๆถๆฏ็ๅฌ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Observable
         */
        Observable.prototype.unlisten = function (type, handler, thisArg) {
            type = (typeof type == "string" ? type : type.toString());
            var listeners = this._listenerDict[type];
            // ๆฃๆฅๅญๅจๆง
            if (listeners) {
                for (var i = 0, len = listeners.length; i < len; i++) {
                    var temp = listeners[i];
                    // ๅฆๆๅทฒ็ปๅญๅจ็ๅฌๅ็ดๆฅ่ฟๅ
                    if (temp.handler == handler && temp.thisArg == thisArg) {
                        listeners.splice(i, 1);
                        break;
                    }
                }
            }
        };
        Observable.prototype.handleCommands = function (msg) {
            var commands = this._commandDict[msg.type];
            if (commands) {
                commands = commands.concat();
                for (var _i = 0, commands_1 = commands; _i < commands_1.length; _i++) {
                    var cls = commands_1[_i];
                    // ๆง่กๅฝไปค
                    new cls(msg).exec();
                }
            }
        };
        /**
         * ๆณจๅๅฝไปคๅฐ็นๅฎๆถๆฏ็ฑปๅไธ๏ผๅฝ่ฟไธช็ฑปๅ็ๆถๆฏๆดพๅๅฐๆกๆถๅๆธๆถไผ่งฆๅCommand่ฟ่ก
         *
         * @param {string} type ่ฆๆณจๅ็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ๏ผๅฏไปฅๆฏๆนๆณๅฝขๅผ๏ผไนๅฏไปฅไฝฟ็ฑปๅฝขๅผ
         * @memberof Observable
         */
        Observable.prototype.mapCommand = function (type, cmd) {
            var commands = this._commandDict[type];
            if (!commands)
                this._commandDict[type] = commands = [];
            if (commands.indexOf(cmd) < 0)
                commands.push(cmd);
        };
        /**
         * ๆณจ้ๅฝไปค
         *
         * @param {string} type ่ฆๆณจ้็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ
         * @returns {void}
         * @memberof Observable
         */
        Observable.prototype.unmapCommand = function (type, cmd) {
            var commands = this._commandDict[type];
            if (!commands)
                return;
            var index = commands.indexOf(cmd);
            if (index < 0)
                return;
            commands.splice(index, 1);
        };
        Object.defineProperty(Observable.prototype, "disposed", {
            /** ๆฏๅฆๅทฒ็ป่ขซ้ๆฏ */
            get: function () {
                return this._disposed;
            },
            enumerable: true,
            configurable: true
        });
        /** ้ๆฏ */
        Observable.prototype.dispose = function () {
            if (this._disposed)
                return;
            // ๆธ็ฉบๆๆๆถๆฏ็ๅฌ
            this._listenerDict = null;
            // ๆธ็ฉบๆๆๅฝไปค
            this._commandDict = null;
            // ๆ่ฎฐ้ๆฏ
            this._disposed = true;
        };
        return Observable;
    }());
    exports.default = Observable;
});
define("src/trunk/utils/ConstructUtil", ["require", "exports", "src/trunk/utils/ObjectUtil", "src/trunk/utils/Dictionary"], function (require, exports, ObjectUtil_2, Dictionary_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-13
     * @modify date 2017-09-13
     *
     * ่ฃ้ฅฐๅจๅทฅๅท้
    */
    var instanceDict = new Dictionary_1.default();
    function handleInstance(instance) {
        var cls = instance.constructor;
        cls = cls["__ori_constructor__"] || cls;
        var funcs = instanceDict.get(cls);
        if (funcs)
            for (var _i = 0, funcs_1 = funcs; _i < funcs_1.length; _i++) {
                var func = funcs_1[_i];
                func(instance);
            }
    }
    /**
     * ๅ่ฃไธไธช็ฑปๅ๏ผ็ๅฌ็ฑปๅ็ๅฎไพๅๆไฝ
     *
     * @export
     * @param {IConstructor} cls ่ฆ็ๅฌๆ้็็ฑปๅๆ้ๅจ
     * @returns {IConstructor} ๆฐ็ๆ้ๅฝๆฐ
     */
    function wrapConstruct(cls) {
        // ๅๅปบไธไธชๆฐ็ๆ้ๅฝๆฐ
        var func;
        eval('func = function ' + cls["name"] + '(){onConstruct.call(this, arguments)}');
        // ๅจๆ่ฎพ็ฝฎ็ปงๆฟ
        ObjectUtil_2.extendsClass(func, cls);
        // ไธบๆฐ็ๆ้ๅฝๆฐๆไธไธชๆ็ญพ๏ผ็จไปฅ่ฎฐๅฝๅๅง็ๆ้ๅฝๆฐ
        func["__ori_constructor__"] = cls;
        // ไธบๅๅงๆ้ๅฝๆฐไนๆไธไธชๆ็ญพ๏ผ็จไปฅ่ฎฐๅฝๆฐๆ้ๅฝๆฐ
        cls["__wrap_constructor__"] = func;
        // ่ฟๅๆฐ็ๆ้ๅฝๆฐ
        return func;
        function onConstruct(args) {
            // ๆขๅค__proto__
            this["__proto__"] = cls.prototype;
            // ่ฐ็จ็ถ็ฑปๆ้ๅฝๆฐๆ้ๅฎไพ
            cls.apply(this, args);
            // ่ฐ็จๅ่ฐ
            handleInstance(this);
        }
    }
    exports.wrapConstruct = wrapConstruct;
    /**
     * ๅฆๆไผๅฅ็็ฑปๆๅ่ฃ็ฑป๏ผๅ่ฟๅๅ่ฃ็ฑป๏ผๅฆๅ่ฟๅๅถๆฌ่บซ
     *
     * @export
     * @param {IConstructor} cls ่ฆ่ทๅๅ่ฃ็ฑป็็ฑปๆ้ๅฝๆฐ
     * @returns {IConstructor}
     */
    function getConstructor(cls) {
        return (cls["__wrap_constructor__"] || cls);
    }
    exports.getConstructor = getConstructor;
    /**
     * ็ๅฌ็ฑปๅ็ๅฎไพๅ
     *
     * @export
     * @param {IConstructor} cls ่ฆ็ๅฌๅฎไพๅ็็ฑป
     * @param {(instance?:any)=>void} handler ๅค็ๅฝๆฐ
     */
    function listenConstruct(cls, handler) {
        cls = cls["__ori_constructor__"] || cls;
        var list = instanceDict.get(cls);
        if (!list)
            instanceDict.set(cls, list = []);
        if (list.indexOf(handler) < 0)
            list.push(handler);
    }
    exports.listenConstruct = listenConstruct;
    /**
     * ็งป้คๅฎไพๅ็ๅฌ
     *
     * @export
     * @param {IConstructor} cls ่ฆ็งป้ค็ๅฌๅฎไพๅ็็ฑป
     * @param {(instance?:any)=>void} handler ๅค็ๅฝๆฐ
     */
    function unlistenConstruct(cls, handler) {
        cls = cls["__ori_constructor__"] || cls;
        var list = instanceDict.get(cls);
        if (list) {
            var index = list.indexOf(handler);
            if (index >= 0)
                list.splice(index, 1);
        }
    }
    exports.unlistenConstruct = unlistenConstruct;
    /**
     * ็ๅฌ็ฑปๅ้ๆฏ๏ผๅฆๆ่ฝๅค้ๆฏ็่ฏ๏ผ้่ฆ็ฑปๅๅทๆdisposeๆนๆณ๏ผ๏ผ่ฏฅ็ๅฌไธ้่ฆ็งป้ค
     *
     * @export
     * @param {IConstructor} cls ่ฆ็ๅฌ้ๆฏ็็ฑป
     * @param {(instance?:any)=>void} handler ๅค็ๅฝๆฐ
     */
    function listenDispose(cls, handler) {
        var dispose = cls.prototype.dispose;
        // ๅคๆญ็ฑปๅๆฏๅฆๅทๆdisposeๆนๆณ
        if (dispose) {
            // ๆฟๆขdisposeๆนๆณ
            cls.prototype.dispose = function () {
                // ่ฐ็จๅ่ฐ
                handler(this);
                // ่ฐ็จๅๅงdisposeๆนๆณๆง่ก้ๆฏ
                return dispose.apply(this, arguments);
            };
        }
    }
    exports.listenDispose = listenDispose;
});
define("src/trunk/core/injector/Injector", ["require", "exports", "src/trunk/core/Core", "src/trunk/utils/ConstructUtil", "src/trunk/core/message/Message"], function (require, exports, Core_2, ConstructUtil_1, Message_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-19
     * @modify date 2017-09-19
     *
     * Coreๆจก็ป็่ฃ้ฅฐๅจๆณจๅฅๆจกๅ
    */
    /** ็ๆ็ฑปๅๅฎไพๅนถๆณจๅฅ๏ผๅฏไปฅ่ฟ่ก็ฑปๅ่ฝฌๆขๆณจๅฅ๏ผๅณๆณจๅฅ็ฑปๅๅฏไปฅๅๆณจๅ็ฑปๅไธไธ่ด๏ผ้็จ@Injectable(AnotherClass)็ๅฝขๅผๅณๅฏ๏ผ */
    function Injectable() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (this === undefined) {
            // ไธ้่ฆ่ฝฌๆขๆณจๅ็ฑปๅ๏ผ็ดๆฅๆณจๅ
            Core_2.core.mapInject(args[0]);
        }
        else {
            // ้่ฆ่ฝฌๆขๆณจๅ็ฑปๅ๏ผ้่ฆ่ฟๅไธไธชClassDecorator
            return function (realCls) {
                for (var _i = 0, args_1 = args; _i < args_1.length; _i++) {
                    var cls = args_1[_i];
                    // ๆณจๅฅ็ฑปๅ
                    Core_2.core.mapInject(realCls, cls);
                }
                // ้่ฆ่ฝฌๆข็ไน่ฆ้ขๅคๅฐ่ช่บซๆณจๅฅไธไธช
                Core_2.core.mapInject(realCls);
            };
        }
    }
    exports.Injectable = Injectable;
    ;
    function Inject(target, key) {
        if (key) {
            var cls = Reflect.getMetadata("design:type", target, key);
            doInject(target.constructor, key, cls);
        }
        else {
            return function (prototype, propertyKey) {
                doInject(prototype.constructor, propertyKey, target);
            };
        }
    }
    exports.Inject = Inject;
    ;
    function doInject(cls, key, type) {
        // ็ๅฌๅฎไพๅ
        var target;
        ConstructUtil_1.listenConstruct(cls, function (instance) {
            Object.defineProperty(instance, key, {
                configurable: true,
                enumerable: true,
                get: function () { return target || (target = Core_2.core.getInject(type)); }
            });
        });
    }
    function MessageHandler(target, key) {
        if (key) {
            var defs = Reflect.getMetadata("design:paramtypes", target, key);
            var resClass = defs[0];
            if (!(resClass.prototype instanceof Message_2.default))
                throw new Error("@MessageHandler่ฃ้ฅฐๅจ่ฃ้ฅฐ็ๆนๆณ็้ฆไธชๅๆฐๅฟ้กปๆฏMessage");
            doMessageHandler(target.constructor, key, resClass);
        }
        else {
            return function (prototype, propertyKey, descriptor) {
                doMessageHandler(prototype.constructor, propertyKey, target);
            };
        }
    }
    exports.MessageHandler = MessageHandler;
    ;
    function doMessageHandler(cls, key, type) {
        // ็ๅฌๅฎไพๅ
        ConstructUtil_1.listenConstruct(cls, function (instance) {
            Core_2.core.listen(type, instance[key], instance);
        });
        // ็ๅฌ้ๆฏ
        ConstructUtil_1.listenDispose(cls, function (instance) {
            Core_2.core.unlisten(type, instance[key], instance);
        });
    }
});
/// <reference path="../libs/Reflect.d.ts"/>
/// <reference path="./global/Patch.ts"/>
define("src/trunk/core/Core", ["require", "exports", "src/trunk/utils/Dictionary", "src/trunk/core/observable/Observable"], function (require, exports, Dictionary_2, Observable_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * ๆธๅฟไธไธๆๅฏน่ฑก๏ผ่ด่ดฃๅๆธๆถๆฏๆถๆฏ่ฝฌๅใๅฏน่ฑกๆณจๅฅ็ญๆธๅฟๅ่ฝ็ๅฎ็ฐ
     *
     * @export
     * @class Core
     */
    var Core = /** @class */ (function () {
        function Core() {
            /*********************** ไธ้ขๆฏๅๆธๆถๆฏ็ณป็ป ***********************/
            this._observable = new Observable_1.default();
            /*********************** ไธ้ขๆฏไพ่ตๆณจๅฅ็ณป็ป ***********************/
            /**
             * ่ฎฐๅฝๅทฒ็ปๆณจๅฅ่ฟ็ๅฏน่ฑกๅไพ
             *
             * @private
             * @type {Dictionary<Function, any>}
             * @memberof Core
             */
            this._injectDict = new Dictionary_2.default();
            /**
             * ๆณจๅฅๅญ็ฌฆไธฒ็ฑปๅๅญๅธ๏ผ่ฎฐๅฝๆณจๅฅๅญ็ฌฆไธฒๅ็ฑปๅๆ้ๅฝๆฐ็ๆๅฐ
             *
             * @private
             * @type {Dictionary<any, IConstructor>}
             * @memberof Core
             */
            this._injectStrDict = new Dictionary_2.default();
            // ่ฟ่กๅไพๅคๆญ
            if (Core._instance)
                throw new Error("ๅทฒ็ๆ่ฟCoreๅฎไพ๏ผไธๅ่ฎธๅคๆฌก็ๆ");
            // ่ตๅผๅไพ
            Core._instance = this;
            // ๆณจๅฅ่ช่บซ
            this.mapInjectValue(this);
        }
        Object.defineProperty(Core.prototype, "observable", {
            /**
             * ๅฐIObservableๆด้ฒๅบๆฅ
             *
             * @readonly
             * @type {IObservable}
             * @memberof Core
             */
            get: function () {
                return this._observable;
            },
            enumerable: true,
            configurable: true
        });
        /** dispatchๆนๆณๅฎ็ฐ */
        Core.prototype.dispatch = function () {
            var params = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                params[_i] = arguments[_i];
            }
            this._observable.dispatch.apply(this._observable, params);
        };
        /**
         * ็ๅฌๅๆธๆถๆฏ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Core
         */
        Core.prototype.listen = function (type, handler, thisArg) {
            this._observable.listen(type, handler, thisArg);
        };
        /**
         * ็งป้คๅๆธๆถๆฏ็ๅฌ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Core
         */
        Core.prototype.unlisten = function (type, handler, thisArg) {
            this._observable.unlisten(type, handler, thisArg);
        };
        /**
         * ๆณจๅๅฝไปคๅฐ็นๅฎๆถๆฏ็ฑปๅไธ๏ผๅฝ่ฟไธช็ฑปๅ็ๆถๆฏๆดพๅๅฐๆกๆถๅๆธๆถไผ่งฆๅCommand่ฟ่ก
         *
         * @param {string} type ่ฆๆณจๅ็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ๏ผๅฏไปฅๆฏๆนๆณๅฝขๅผ๏ผไนๅฏไปฅไฝฟ็ฑปๅฝขๅผ
         * @memberof Core
         */
        Core.prototype.mapCommand = function (type, cmd) {
            this._observable.mapCommand(type, cmd);
        };
        /**
         * ๆณจ้ๅฝไปค
         *
         * @param {string} type ่ฆๆณจ้็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ
         * @returns {void}
         * @memberof Core
         */
        Core.prototype.unmapCommand = function (type, cmd) {
            this._observable.unmapCommand(type, cmd);
        };
        /**
         * ๆทปๅไธไธช็ฑปๅๆณจๅฅ๏ผไผ็ซๅณ็ๆไธไธชๅฎไพๅนถๆณจๅฅๅฐๆกๆถๅๆธไธญ
         *
         * @param {IConstructor} target ่ฆๆณจๅฅ็็ฑปๅ๏ผๆณจๆไธๆฏๅฎไพ๏ผ
         * @param {*} [type] ๅฆๆๆไพ่ฏฅๅๆฐ๏ผๅไฝฟ็จ่ฏฅ็ฑปๅไปฃๆฟๆณจๅฅ็ฑปๅ็key๏ผๅฆๅไฝฟ็จๆณจๅฅ็ฑปๅ่ช่บซไฝไธบkey
         * @memberof Core
         */
        Core.prototype.mapInject = function (target, type) {
            // ๅฆๆๅทฒ็ปๆณจๅฅ่ฟไบ๏ผๅไฝฟ็จๅทฒ็ปๆณจๅฅ็ๅไพๅๆฌกๆณจๅฅ
            var oriTarget = target["__ori_constructor__"] || target;
            var value = this._injectDict.get(oriTarget) || new target();
            this.mapInjectValue(value, type);
        };
        /**
         * ๆณจๅฅไธไธชๅฏน่ฑกๅฎไพ
         *
         * @param {*} value ่ฆๆณจๅฅ็ๅฏน่ฑกๅฎไพ
         * @param {*} [type] ๅฆๆๆไพ่ฏฅๅๆฐ๏ผๅไฝฟ็จ่ฏฅ็ฑปๅไปฃๆฟๆณจๅฅ็ฑปๅ็key๏ผๅฆๅไฝฟ็จๆณจๅฅๅฎไพ็ๆ้ๅฝๆฐไฝไธบkey
         * @memberof Core
         */
        Core.prototype.mapInjectValue = function (value, type) {
            // ๅฆๆๆฏๅญ็ฌฆไธฒๅ่ฎฐๅฝ็ฑปๅๆ้ๅฝๆฐๆๅฐ
            if (!(type instanceof Function) || !type.prototype)
                type = this._injectStrDict[type] = value.constructor;
            // ่ฎฐๅฝๅทฒๆณจๅฅ็ๅไพ
            this._injectDict.set(value.constructor, value);
            // ๅผๅงๆณจๅฅ
            Reflect.defineMetadata("design:type", value, type || value.constructor);
        };
        /**
         * ็งป้ค็ฑปๅๆณจๅฅ
         *
         * @param {*} type ่ฆ็งป้คๆณจๅฅ็็ฑปๅ
         * @memberof Core
         */
        Core.prototype.unmapInject = function (type) {
            // ๅฆๆๆฏๅญ็ฌฆไธฒๅ่ฎฐๅฝ็ฑปๅๆ้ๅฝๆฐๆๅฐ
            if (!(type instanceof Function) || !type.prototype)
                type = this._injectStrDict[type];
            Reflect.deleteMetadata("design:type", type);
        };
        /**
         * ่ทๅๆณจๅฅ็ๅฏน่ฑกๅฎไพ
         *
         * @param {*} type ๆณจๅฅๅฏน่ฑก็็ฑปๅ
         * @returns {*} ๆณจๅฅ็ๅฏน่ฑกๅฎไพ
         * @memberof Core
         */
        Core.prototype.getInject = function (type) {
            if (!(type instanceof Function) || !type.prototype)
                type = this._injectStrDict[type];
            if (type) {
                // ้่ฆ็จๅๅง็ๆ้ๅฝๆฐๅ
                type = type["__ori_constructor__"] || type;
                return Reflect.getMetadata("design:type", type);
            }
        };
        return Core;
    }());
    exports.default = Core;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.core = new Core();
});
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-01
 * @modify date 2017-11-01
 *
 * Cookieๅทฅๅท
*/
define("src/trunk/utils/CookieUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * ่ทๅcookieๅผ
     *
     * @export
     * @param {string} name cookieๅ็งฐ
     * @returns {string} cookieๅผ
     */
    function getCookie(name) {
        if (document.cookie.length > 0) {
            var start = document.cookie.indexOf(name + "=");
            if (start != -1) {
                start = start + name.length + 1;
                var end = document.cookie.indexOf(";", start);
                if (end == -1)
                    end = document.cookie.length;
                return decodeURIComponent(document.cookie.substring(start, end));
            }
        }
        return "";
    }
    exports.getCookie = getCookie;
    /**
     * ่ทๅcookieๅผ
     *
     * @export
     * @param {string} name cookieๅ็งฐ
     * @param {*} value cookieๅผ
     * @param {number} [expire] ๆๆๆๆถ้ฟ๏ผๆฏซ็ง๏ผ
     */
    function setCookie(name, value, expire) {
        var exstr = "";
        if (expire != null) {
            var exdate = new Date();
            exdate.setMilliseconds(exdate.getMilliseconds() + expire);
            exstr = ";expires=" + exdate.toUTCString();
        }
        document.cookie = name + "=" + encodeURIComponent(value) + exstr;
    }
    exports.setCookie = setCookie;
});
define("src/trunk/engine/bridge/IHasBridge", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/panel/IPanelPolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/core/interfaces/IOpenClose", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/panel/IPanel", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/panel/IPromptPanel", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ้็จๅผน็ช็ๅ็งๆฅๅฃ
    */
    var ButtonType;
    (function (ButtonType) {
        ButtonType[ButtonType["normal"] = 0] = "normal";
        ButtonType[ButtonType["important"] = 1] = "important";
    })(ButtonType = exports.ButtonType || (exports.ButtonType = {}));
});
define("src/trunk/engine/scene/IScene", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/scene/IScenePolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/module/IModuleObservable", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/module/IModuleConstructor", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/module/IModuleDependent", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/mediator/IModuleMediator", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/net/IRequestPolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/net/DataType", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-11
     * @modify date 2017-09-11
     *
     * ่ฏทๆฑๆ่ฟๅๆฐๆฎ็ปๆไฝ
    */
    var DataType = /** @class */ (function () {
        function DataType() {
        }
        /**
         * ่งฃๆๅ็ซฏ่ฟๅ็JSONๅฏน่ฑก๏ผ็ๆ็ปๆไฝ
         *
         * @param {any} data ๅ็ซฏ่ฟๅ็JSONๅฏน่ฑก
         * @returns {DataType} ็ปๆไฝๅฏน่ฑก
         * @memberof DataType
         */
        DataType.prototype.parse = function (data) {
            this.__rawData = this.doParse(data);
            return this;
        };
        return DataType;
    }());
    exports.default = DataType;
});
define("src/trunk/engine/net/ResponseData", ["require", "exports", "src/trunk/engine/net/DataType"], function (require, exports, DataType_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var ResponseData = /** @class */ (function (_super) {
        __extends(ResponseData, _super);
        function ResponseData() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ResponseData;
    }(DataType_1.default));
    exports.default = ResponseData;
});
define("src/trunk/engine/net/RequestData", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var RequestData = /** @class */ (function () {
        function RequestData() {
            /**
             * ็จๆทๅๆฐ๏ผๅฏไปฅไฟๅญไปปๆๅๆฐๅฐMessageไธญ๏ผ่ฏฅๅๆฐไธญ็ๆฐๆฎไธไผ่ขซๅ้
             *
             * @type {*}
             * @memberof RequestData
             */
            this.__userData = {};
        }
        Object.defineProperty(RequestData.prototype, "type", {
            /**
             * ่ทๅ่ฏทๆฑๆถๆฏ็ฑปๅๅญ็ฌฆไธฒ
             *
             * @readonly
             * @type {string}
             * @memberof RequestData
             */
            get: function () {
                return this.__params.type;
            },
            enumerable: true,
            configurable: true
        });
        return RequestData;
    }());
    exports.default = RequestData;
    /** ๅฏผๅบๅฌๅฑๆถๆฏๅๆฐๅฏน่ฑก */
    exports.commonData = {};
});
define("src/trunk/engine/module/IModule", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/mediator/IMediator", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/mask/IMaskData", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/mask/MaskManager", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/Core", "src/trunk/engine/bridge/BridgeManager"], function (require, exports, Injector_1, Core_3, BridgeManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-25
     * @modify date 2017-10-25
     *
     * ้ฎ็ฝฉ็ฎก็ๅจ
    */
    var MaskManager = /** @class */ (function () {
        function MaskManager() {
            this._entityDict = {};
            this._loadingMaskDict = {};
        }
        MaskManager.prototype.getLoadingMaskCount = function () {
            var count = 0;
            for (var key in this._loadingMaskDict) {
                var temp = this._loadingMaskDict[key];
                if (temp > 0)
                    count += temp;
            }
            return count;
        };
        MaskManager.prototype.plusLoadingMaskCount = function (key) {
            var count = this._loadingMaskDict[key] || 0;
            if (count < 0)
                count = 0;
            this._loadingMaskDict[key] = ++count;
            return count;
        };
        MaskManager.prototype.minusLoadingMaskCount = function (key) {
            var count = this._loadingMaskDict[key] || 0;
            count--;
            if (count < 0)
                count = 0;
            this._loadingMaskDict[key] = count;
            if (count == 0)
                delete this._loadingMaskDict[key];
            return count;
        };
        /**
         * ๅๅงๅMaskUtil
         * @param type ๆๅฑ่กจ็ฐๅฑๆกฅ
         * @param entity ้ฎ็ฝฉๅฎไฝ
         */
        MaskManager.prototype.registerMask = function (type, entity) {
            this._entityDict[type] = entity;
        };
        /**
         * ๆพ็คบ้ฎ็ฝฉ
         */
        MaskManager.prototype.showMask = function (alpha) {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // ่ฐ็จๅ่ฐ
                entity.maskData.onShowMask && entity.maskData.onShowMask();
                // ๆพ็คบ้ฎ็ฝฉ
                entity.showMask(alpha);
            }
        };
        /**
         * ้่้ฎ็ฝฉ
         */
        MaskManager.prototype.hideMask = function () {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // ้่้ฎ็ฝฉ
                entity.hideMask();
                // ่ฐ็จๅ่ฐ
                entity.maskData.onHideMask && entity.maskData.onHideMask();
            }
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบ้ฎ็ฝฉ*/
        MaskManager.prototype.isShowingMask = function () {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null)
                return entity.isShowingMask();
            return false;
        };
        /**
         * ๆพ็คบๅ่ฝฝๅพ
         */
        MaskManager.prototype.showLoading = function (alpha, key) {
            if (key === void 0) { key = null; }
            // ่ฅๅฝๅไฝๆฒกๆloadingๅๆพ็คบloading
            if (this.getLoadingMaskCount() == 0) {
                var type = BridgeManager_1.bridgeManager.currentBridge.type;
                var entity = this._entityDict[type];
                if (entity != null) {
                    // ่ฐ็จๅ่ฐ
                    entity.maskData.onShowLoading && entity.maskData.onShowLoading(entity.loadingSkin);
                    // ๆพ็คบ้ฎ็ฝฉ
                    entity.showLoading(alpha);
                }
            }
            // ๅข่ฎกๆฐ
            this.plusLoadingMaskCount(key);
        };
        /**
         * ้่ๅ่ฝฝๅพ
         */
        MaskManager.prototype.hideLoading = function (key) {
            if (key === void 0) { key = null; }
            // ๅ่ฎกๆฐ
            this.minusLoadingMaskCount(key);
            if (this.getLoadingMaskCount() == 0) {
                // ็งป้คloading
                var type = BridgeManager_1.bridgeManager.currentBridge.type;
                var entity = this._entityDict[type];
                if (entity != null) {
                    // ้่้ฎ็ฝฉ
                    entity.hideLoading();
                    // ่ฐ็จๅ่ฐ
                    entity.maskData.onHideLoading && entity.maskData.onHideLoading(entity.loadingSkin);
                }
            }
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบloading*/
        MaskManager.prototype.isShowingLoading = function () {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null)
                return entity.isShowingLoading();
            return false;
        };
        /** ๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskManager.prototype.showModalMask = function (popup, alpha) {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // ่ฐ็จๅ่ฐ
                entity.maskData.onShowModalMask && entity.maskData.onShowModalMask(popup);
                // ๆพ็คบ้ฎ็ฝฉ
                entity.showModalMask(popup, alpha);
            }
        };
        /** ้่ๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskManager.prototype.hideModalMask = function (popup) {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null) {
                // ้่้ฎ็ฝฉ
                entity.hideModalMask(popup);
                // ่ฐ็จๅ่ฐ
                entity.maskData.onHideModalMask && entity.maskData.onHideModalMask(popup);
            }
        };
        /** ๅฝๅๆฏๅฆๅจๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskManager.prototype.isShowingModalMask = function (popup) {
            var type = BridgeManager_1.bridgeManager.currentBridge.type;
            var entity = this._entityDict[type];
            if (entity != null)
                return entity.isShowingModalMask(popup);
            return false;
        };
        MaskManager = __decorate([
            Injector_1.Injectable
        ], MaskManager);
        return MaskManager;
    }());
    exports.default = MaskManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.maskManager = Core_3.core.getInject(MaskManager);
});
define("src/trunk/engine/bridge/IBridge", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/bridge/BridgeMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ่กจ็ฐๅฑๆถๆฏ
    */
    var BridgeMessage = /** @class */ (function () {
        function BridgeMessage() {
        }
        /**
         * ๅๅงๅ่กจ็ฐๅฑๅฎไพๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof ViewMessage
         */
        BridgeMessage.BRIDGE_BEFORE_INIT = "bridgeBeforeInit";
        /**
         * ๅๅงๅ่กจ็ฐๅฑๅฎไพๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof ViewMessage
         */
        BridgeMessage.BRIDGE_AFTER_INIT = "bridgeAfterInit";
        /**
         * ๆๆ่กจ็ฐๅฑๅฎไพ้ฝๅๅงๅๅฎๆฏ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof ViewMessage
         */
        BridgeMessage.BRIDGE_ALL_INIT = "bridgeAllInit";
        return BridgeMessage;
    }());
    exports.default = BridgeMessage;
});
define("src/trunk/engine/panel/NonePanelPolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ๆไปปไฝๅจ็ป็ๅผนๅบ็ญ็ฅ๏ผๅฏๅบ็จไบไปปไฝๆพ็คบๅฑๅฎ็ฐ
    */
    var NonePanelPolicy = /** @class */ (function () {
        function NonePanelPolicy() {
        }
        NonePanelPolicy.prototype.pop = function (panel, callback, from) {
            setTimeout(callback, 0);
        };
        NonePanelPolicy.prototype.drop = function (panel, callback, from) {
            setTimeout(callback, 0);
        };
        return NonePanelPolicy;
    }());
    exports.NonePanelPolicy = NonePanelPolicy;
    /** ้ป่ฎคๅฏผๅบๅฎไพ */
    exports.default = new NonePanelPolicy();
});
define("src/trunk/engine/panel/PanelMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ๅผน็ช็ธๅณ็ๆถๆฏ
    */
    var PanelMessage = /** @class */ (function () {
        function PanelMessage() {
        }
        /**
         * ๆๅผๅผน็ชๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof PanelMessage
         */
        PanelMessage.PANEL_BEFORE_POP = "panelBeforePop";
        /**
         * ๆๅผๅผน็ชๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof PanelMessage
         */
        PanelMessage.PANEL_AFTER_POP = "panelAfterPop";
        /**
         * ๅณ้ญๅผน็ชๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof PanelMessage
         */
        PanelMessage.PANEL_BEFORE_DROP = "panelBeforeDrop";
        /**
         * ๅณ้ญๅผน็ชๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof PanelMessage
         */
        PanelMessage.PANEL_AFTER_DROP = "panelAfterDrop";
        return PanelMessage;
    }());
    exports.default = PanelMessage;
});
define("src/trunk/engine/system/System", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector"], function (require, exports, Core_4, Injector_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ็จๆฅ่ฎฐๅฝ็จๅบ่ฟ่กๆถ้ด๏ผๅนถไธๆไพๅปถ่ฟๅ่ฐๆ้ข็ๅ่ฐๅ่ฝ
    */
    var System = /** @class */ (function () {
        function System() {
            // ่ฟ้ๅฐ่ฏไธไธTS็Tuple็ฑปๅโโRaykid
            this._nextFrameList = [];
            this._timer = 0;
            var self = this;
            if (requestAnimationFrame instanceof Function) {
                requestAnimationFrame(onRequestAnimationFrame);
            }
            else {
                // ๅฆๆไธๆฏๆrequestAnimationFrameๅๆน็จsetTimeout่ฎกๆถ๏ผๅปถ่ฟๆถ้ด1000/60ๆฏซ็ง
                var startTime = Date.now();
                setInterval(function () {
                    var curTime = Date.now();
                    // ่ตๅผtimer
                    self._timer = curTime - startTime;
                    // ่ฐ็จtickๆนๆณ
                    self.tick();
                }, 1000 / 60);
            }
            function onRequestAnimationFrame(timer) {
                // ่ตๅผtimer๏ผ่ฟไธชๆนๆณ้ๆๆณ่ทๅthis๏ผๅๆญค้่ฆ้่ฟๆณจๅฅ็้ๆๅฑๆงๅๅฐ่ช่บซๅฎไพ
                self._timer = timer;
                // ่ฐ็จtickๆนๆณ
                self.tick();
                // ่ฎกๅไธไธๆฌกๆง่ก
                requestAnimationFrame(onRequestAnimationFrame);
            }
        }
        /**
         * ่ทๅไป็จๅบ่ฟ่กๅฐๅฝๅๆ็ป่ฟ็ๆฏซ็งๆฐ
         *
         * @returns {number} ๆฏซ็งๆฐ
         * @memberof System
         */
        System.prototype.getTimer = function () {
            return this._timer;
        };
        System.prototype.tick = function () {
            // ่ฐ็จไธไธๅธงๅ่ฐ
            for (var i = 0, len = this._nextFrameList.length; i < len; i++) {
                var data = this._nextFrameList.shift();
                data[0].apply(data[1], data[2]);
            }
        };
        /**
         * ๅจไธไธๅธงๆง่กๆไธชๆนๆณ
         *
         * @param {Function} handler ๅธๆๅจไธไธๅธงๆง่ก็ๆไธชๆนๆณ
         * @param {*} [thisArg] thisๆๅ
         * @param {...any[]} args ๆนๆณๅๆฐๅ่กจ
         * @returns {ICancelable} ๅฏๅๆถ็ๅฅๆ
         * @memberof System
         */
        System.prototype.nextFrame = function (handler, thisArg) {
            var _this = this;
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            var data = [handler, thisArg, args];
            this._nextFrameList.push(data);
            return {
                cancel: function () {
                    var index = _this._nextFrameList.indexOf(data);
                    if (index >= 0)
                        _this._nextFrameList.splice(index, 1);
                }
            };
        };
        /**
         * ๆฏๅธงๆง่กๆไธชๆนๆณ๏ผ็ดๅฐๅๆถไฝ็ฝฎ
         *
         * @param {Function} handler ๆฏๅธงๆง่ก็ๆไธชๆนๆณ
         * @param {*} [thisArg] thisๆๅ
         * @param {...any[]} args ๆนๆณๅๆฐๅ่กจ
         * @returns {ICancelable} ๅฏๅๆถ็ๅฅๆ
         * @memberof System
         */
        System.prototype.enterFrame = function (handler, thisArg) {
            var args = [];
            for (var _i = 2; _i < arguments.length; _i++) {
                args[_i - 2] = arguments[_i];
            }
            var self = this;
            var cancelable = this.nextFrame.apply(this, [wrapHandler, thisArg].concat(args));
            return {
                cancel: function () {
                    cancelable.cancel();
                }
            };
            function wrapHandler() {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                // ่ฐ็จๅ่ฐ
                handler.apply(this, args);
                // ๆง่กไธไธๅธง
                cancelable = self.nextFrame.apply(self, [wrapHandler, this].concat(args));
            }
        };
        /**
         * ่ฎพ็ฝฎๅปถ่ฟๅ่ฐ
         *
         * @param {number} duration ๅปถ่ฟๆฏซ็งๅผ
         * @param {Function} handler ๅ่ฐๅฝๆฐ
         * @param {*} [thisArg] thisๆๅ
         * @param {...any[]} args ่ฆไผ้็ๅๆฐ
         * @returns {ICancelable} ๅฏๅๆถ็ๅฅๆ
         * @memberof System
         */
        System.prototype.setTimeout = function (duration, handler, thisArg) {
            var args = [];
            for (var _i = 3; _i < arguments.length; _i++) {
                args[_i - 3] = arguments[_i];
            }
            var startTimer = this._timer;
            // ๅฏๅจ่ฎกๆถๅจ
            var nextFrame = this.nextFrame(tick, this);
            function tick() {
                var delta = this._timer - startTimer;
                if (delta >= duration) {
                    nextFrame = null;
                    handler.apply(thisArg, args);
                }
                else {
                    nextFrame = this.nextFrame(tick, this);
                }
            }
            return {
                cancel: function () {
                    nextFrame && nextFrame.cancel();
                    nextFrame = null;
                }
            };
        };
        /**
         * ่ฎพ็ฝฎๅปถๆถ้ด้
         *
         * @param {number} duration ๅปถ่ฟๆฏซ็งๅผ
         * @param {Function} handler ๅ่ฐๅฝๆฐ
         * @param {*} [thisArg] thisๆๅ
         * @param {...any[]} args ่ฆไผ้็ๅๆฐ
         * @returns {ICancelable} ๅฏๅๆถ็ๅฅๆ
         * @memberof System
         */
        System.prototype.setInterval = function (duration, handler, thisArg) {
            var args = [];
            for (var _i = 3; _i < arguments.length; _i++) {
                args[_i - 3] = arguments[_i];
            }
            var timeout = this.setTimeout(duration, onTimeout, this);
            function onTimeout() {
                // ่งฆๅๅ่ฐ
                handler.apply(thisArg, args);
                // ็ปง็ปญไธไธๆฌก
                timeout = this.setTimeout(duration, onTimeout, this);
            }
            return {
                cancel: function () {
                    timeout && timeout.cancel();
                    timeout = null;
                }
            };
        };
        System = __decorate([
            Injector_2.Injectable,
            __metadata("design:paramtypes", [])
        ], System);
        return System;
    }());
    exports.default = System;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.system = Core_4.core.getInject(System);
});
define("src/trunk/engine/panel/PanelManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/panel/NonePanelPolicy", "src/trunk/engine/panel/PanelMessage", "src/trunk/engine/panel/IPromptPanel", "src/trunk/engine/bridge/BridgeManager", "src/trunk/engine/mask/MaskManager"], function (require, exports, Core_5, Injector_3, NonePanelPolicy_1, PanelMessage_1, IPromptPanel_1, BridgeManager_2, MaskManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ๅผน็ช็ฎก็ๅจ๏ผๅๅซๅผนๅบๅผน็ชใๅณ้ญๅผน็ชใๅผน็ช็ฎก็็ญๅ่ฝ
    */
    var PanelManager = /** @class */ (function () {
        function PanelManager() {
            this._panels = [];
            /************************ ไธ้ขๆฏ้็จๅผน็ช็้ป่พ ************************/
            this._promptDict = {};
        }
        /**
         * ่ทๅๅฝๅๆพ็คบ็ๅผน็ชๆฐ็ป๏ผๅฏๆฌ๏ผ
         *
         * @param {IConstructor} [cls] ๅผน็ช็ฑปๅ๏ผๅฆๆไผ้่ฏฅๅๆฐๅๅช่ฟๅ่ฏฅ็ฑปๅ็ๅทฒๆๅผๅผน็ช๏ผๅฆๅๅฐ่ฟๅๆๆๅทฒๆๅผ็ๅผน็ช
         * @returns {IPanel[]} ๅทฒๆๅผๅผน็ชๆฐ็ป
         * @memberof PanelManager
         */
        PanelManager.prototype.getOpened = function (cls) {
            if (!cls)
                return this._panels.concat();
            else
                return this._panels.filter(function (panel) { return panel.constructor == cls; });
        };
        /**
         * ่ทๅๅผน็ชๆฏๅฆๅทฒๅผๅฏ
         *
         * @param {IPanel} panel ๅผน็ชๅฏน่ฑก
         * @returns {boolean} ๆฏๅฆๅทฒ็ปๅผๅฏ
         * @memberof PanelManager
         */
        PanelManager.prototype.isOpened = function (panel) {
            return (this._panels.indexOf(panel) >= 0);
        };
        /**
         * ๆๅผไธไธชๅผน็ช
         *
         * @param {IPanel} panel ่ฆๆๅผ็ๅผน็ช
         * @param {*} [data] ๆฐๆฎ
         * @param {boolean} [isModal=true] ๆฏๅฆๆจกๆๅผนๅบ
         * @param {{x:number, y:number}} [from] ๅผนๅบ่ตท็นไฝ็ฝฎ
         * @returns {IPanel} ่ฟๅๅผน็ชๅฏน่ฑก
         * @memberof PanelManager
         */
        PanelManager.prototype.pop = function (panel, data, isModal, from) {
            if (isModal === void 0) { isModal = true; }
            if (this._panels.indexOf(panel) < 0) {
                // ๆฐๆฎๅ่ก
                this._panels.push(panel);
                // ๅผน็ชๆๅจ็่กจ็ฐๅฑๅฟ้กป่ฆๆพ็คบ
                panel.bridge.htmlWrapper.style.display = "";
                // ่ฐ็จๆฅๅฃ
                panel.__open(data, isModal, from);
                // ่ทๅ็ญ็ฅ
                var policy = panel.policy || panel.bridge.defaultPanelPolicy || NonePanelPolicy_1.default;
                // ่ฐ็จๅ่ฐ
                panel.onBeforePop(data, isModal, from);
                // ๆดพๅๆถๆฏ
                Core_5.core.dispatch(PanelMessage_1.default.PANEL_BEFORE_POP, panel, isModal, from);
                // ่ฐ็จๅๅคๆฅๅฃ
                policy.prepare && policy.prepare(panel);
                // ๆทปๅๆพ็คบ
                var bridge = panel.bridge;
                bridge.addChild(bridge.panelLayer, panel.skin);
                // ่ฐ็จ็ญ็ฅๆฅๅฃ
                policy.pop(panel, function () {
                    // ่ฐ็จๅ่ฐ
                    panel.onAfterPop(data, isModal, from);
                    // ๆดพๅๆถๆฏ
                    Core_5.core.dispatch(PanelMessage_1.default.PANEL_AFTER_POP, panel, isModal, from);
                }, from);
                // ๅฆๆๆฏๆจกๆๅผนๅบ๏ผๅ้่ฆ้ฎ็ฝฉๅฑ
                if (isModal)
                    MaskManager_1.maskManager.showModalMask(panel);
            }
            return panel;
        };
        /**
         * ๅณ้ญไธไธชๅผน็ช
         *
         * @param {IPanel} panel ่ฆๅณ้ญ็ๅผน็ช
         * @param {*} [data] ๆฐๆฎ
         * @param {{x:number, y:number}} [to] ๅณ้ญ็ป็นไฝ็ฝฎ
         * @returns {IPanel} ่ฟๅๅผน็ชๅฏน่ฑก
         * @memberof PanelManager
         */
        PanelManager.prototype.drop = function (panel, data, to) {
            var index = this._panels.indexOf(panel);
            if (index >= 0) {
                // ๆฐๆฎๅ่ก
                this._panels.splice(index, 1);
                // ่ทๅ็ญ็ฅ
                var policy = panel.policy || panel.bridge.defaultPanelPolicy || NonePanelPolicy_1.default;
                // ่ฐ็จๅ่ฐ
                panel.onBeforeDrop(data, to);
                // ๆดพๅๆถๆฏ
                Core_5.core.dispatch(PanelMessage_1.default.PANEL_BEFORE_DROP, panel, to);
                // ่ฐ็จ็ญ็ฅๆฅๅฃ
                policy.drop(panel, function () {
                    // ่ฐ็จๅ่ฐ
                    panel.onAfterDrop(data, to);
                    // ๆดพๅๆถๆฏ
                    Core_5.core.dispatch(PanelMessage_1.default.PANEL_AFTER_DROP, panel, to);
                    // ็งป้คๆพ็คบ
                    var bridge = panel.bridge;
                    bridge.removeChild(bridge.panelLayer, panel.skin);
                    // ่ฐ็จๆฅๅฃ
                    panel.__close(data, to);
                }, to);
                // ็งป้ค้ฎ็ฝฉ
                MaskManager_1.maskManager.hideModalMask(panel);
            }
            return panel;
        };
        /**
         * ๆณจๅ้็จๅผน็ช
         *
         * @param {string} type ้็จๅผน็ช่ฆๆณจๅๅฐ็่กจ็ฐๅฑ็ฑปๅ
         * @param {IPromptPanelConstructor} prompt ้็จๅผน็ช็ฑปๅ
         * @memberof PanelManager
         */
        PanelManager.prototype.registerPrompt = function (type, prompt) {
            this._promptDict[type] = prompt;
        };
        /**
         * ๅๆถๆณจๅ้็จๅผน็ช
         *
         * @param {string} type ่ฆๅๆถๆณจๅ้็จๅผน็ช็่กจ็ฐๅฑ็ฑปๅ
         * @memberof PanelManager
         */
        PanelManager.prototype.unregisterPrompt = function (type) {
            delete this._promptDict[type];
        };
        /**
         * @private
         */
        PanelManager.prototype.prompt = function (msgOrParams) {
            var handlers = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                handlers[_i - 1] = arguments[_i];
            }
            var params;
            if (typeof msgOrParams == "string") {
                params = {
                    msg: msgOrParams,
                    handlers: handlers
                };
            }
            else {
                params = msgOrParams;
            }
            // ๅๅฐๅฝๅๅบๆฏ็็ฑปๅ
            var curBridge = BridgeManager_2.bridgeManager.currentBridge;
            var type = curBridge && curBridge.type;
            // ็จๅบๆฏ็ฑปๅๅๅฐๅผน็ชๅฏน่ฑก
            var promptCls = this._promptDict[type];
            if (promptCls == null) {
                // ๆฒกๆๆพๅฐๅฝๅๆจกๅ็ฑปๅๅณ่็้็จๅผน็ช็ฑปๅ๏ผๆน็จ็ณป็ปๅผน็ชๅๅไธไธ
                alert(params.msg);
                return;
            }
            // ๅขๅ้ป่ฎคๅผ
            for (var i in params.handlers) {
                var handler = params.handlers[i];
                if (handler.text == null)
                    handler.text = handler.data;
                if (handler.buttonType == null)
                    handler.buttonType = IPromptPanel_1.ButtonType.normal;
            }
            // ๅฎไพๅ
            var prompt = new promptCls();
            // ๆพ็คบๅผน็ช
            this.pop(prompt);
            // ๆดๆฐๅผน็ช
            prompt.update(params);
            // ่ฟๅๅผน็ช
            return prompt;
        };
        /**
         * ๆพ็คบ่ญฆๅ็ชๅฃ๏ผๅชๆไธไธช็กฎๅฎๆ้ฎ๏ผ
         *
         * @param {(string|IPromptParams)} msgOrParams ่ฆๆพ็คบ็ๆๆฌ๏ผๆ่ๅผน็ชๆฐๆฎ
         * @param {()=>void} [okHandler] ็กฎๅฎๆ้ฎ็นๅปๅ่ฐ
         * @returns {IPromptPanel} ่ฟๅๅผน็ชๅฎไฝ
         * @memberof PanelManager
         */
        PanelManager.prototype.alert = function (msgOrParams, okHandler) {
            var params;
            if (typeof msgOrParams == "string") {
                params = { msg: msgOrParams };
            }
            else {
                params = msgOrParams;
            }
            params.handlers = [
                { data: "็กฎๅฎ", handler: okHandler, buttonType: IPromptPanel_1.ButtonType.important }
            ];
            return this.prompt(params);
        };
        /**
         * ๆพ็คบ็กฎ่ฎค็ชๅฃ๏ผๆไธไธช็กฎๅฎๆ้ฎๅไธไธชๅๆถๆ้ฎ๏ผ
         *
         * @param {(string|IPromptParams)} msgOrParams ่ฆๆพ็คบ็ๆๆฌ๏ผๆ่ๅผน็ชๆฐๆฎ
         * @param {()=>void} [okHandler] ็กฎๅฎๆ้ฎ็นๅปๅ่ฐ
         * @param {()=>void} [cancelHandler] ๅๆถๆ้ฎ็นๅปๅ่ฐ
         * @returns {IPromptPanel} ่ฟๅๅผน็ชๅฎไฝ
         * @memberof PanelManager
         */
        PanelManager.prototype.confirm = function (msgOrParams, okHandler, cancelHandler) {
            var params;
            if (typeof msgOrParams == "string") {
                params = { msg: msgOrParams };
            }
            else {
                params = msgOrParams;
            }
            params.handlers = [
                { data: "ๅๆถ", handler: cancelHandler, buttonType: IPromptPanel_1.ButtonType.normal },
                { data: "็กฎๅฎ", handler: okHandler, buttonType: IPromptPanel_1.ButtonType.important }
            ];
            return this.prompt(params);
        };
        PanelManager = __decorate([
            Injector_3.Injectable
        ], PanelManager);
        return PanelManager;
    }());
    exports.default = PanelManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.panelManager = Core_5.core.getInject(PanelManager);
});
define("src/trunk/engine/net/NetMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-11
     * @modify date 2017-09-11
     *
     * ้่ฎฏ็ธๅณ็ๆถๆฏ
    */
    var NetMessage = /** @class */ (function () {
        function NetMessage() {
        }
        /**
         * ๅ้็ฝ็ป่ฏทๆฑๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof NetMessage
         */
        NetMessage.NET_REQUEST = "netRequest";
        /**
         * ๆฅๅ็ฝ็ป่ฟๅๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof NetMessage
         */
        NetMessage.NET_RESPONSE = "netResponse";
        /**
         * ็ฝ็ป่ฏทๆฑ้่ฏฏๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof NetMessage
         */
        NetMessage.NET_ERROR = "netError";
        return NetMessage;
    }());
    exports.default = NetMessage;
});
define("src/trunk/engine/net/NetUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-09
     * @modify date 2017-10-09
     *
     * ็ฝ็ปๅทฅๅท้๏ผๆกๆถๅ้จไฝฟ็จ
    */
    function handleObj(obj) {
        if (obj instanceof Array)
            return packArray(obj);
        else if (obj.pack instanceof Function)
            return obj.pack();
        else if (typeof obj == "object")
            return packMap(obj);
        else
            obj;
    }
    function packArray(arr) {
        if (arr == null)
            return null;
        var result = arr.map(handleObj);
        return result;
    }
    exports.packArray = packArray;
    function parseArray(arr, cls) {
        if (arr == null)
            return [];
        // ไธๆฏๆไบ็ปดๆฐ็ปๅตๅฅ
        var result = [];
        for (var i = 0, len = arr.length; i < len; i++) {
            var value = arr[i];
            if (cls == null) {
                // ๅญๅฏน่ฑกๆฏไธชๅบ็ก็ฑปๅ
                result.push(value);
            }
            else {
                // ๅญๅฏน่ฑกๆฏไธช่ชๅฎไน็ฑปๅ
                result.push(new cls().parse(value));
            }
        }
        return result;
    }
    exports.parseArray = parseArray;
    function packMap(map) {
        if (map == null)
            return null;
        var result = {};
        for (var key in map) {
            var obj = map[key];
            result[key] = handleObj(obj);
        }
        return result;
    }
    exports.packMap = packMap;
    function parseMap(map, cls) {
        if (map == null)
            return {};
        // ไธๆฏๆไบ็ปดๆฐ็ปๅตๅฅ
        var result = {};
        for (var key in map) {
            var value = map[key];
            if (cls == null) {
                // ๅญๅฏน่ฑกๆฏไธชๅบ็ก็ฑปๅ
                result[key] = value;
            }
            else {
                // ๅญๅฏน่ฑกๆฏไธช่ชๅฎไน็ฑปๅ
                result[key] = new cls().parse(value);
            }
        }
        return result;
    }
    exports.parseMap = parseMap;
});
define("src/trunk/engine/net/NetManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/core/message/CoreMessage", "src/trunk/utils/ObjectUtil", "src/trunk/engine/net/RequestData", "src/trunk/engine/net/NetMessage", "src/trunk/engine/mask/MaskManager"], function (require, exports, Core_6, Injector_4, CoreMessage_2, ObjectUtil_3, RequestData_1, NetMessage_1, MaskManager_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var NetManager = /** @class */ (function () {
        function NetManager() {
            this._responseDict = {};
            this._responseListeners = {};
            this.listenRequest(Core_6.core);
        }
        NetManager.prototype.onMsgDispatched = function (msg) {
            var observable = this;
            // ๅฆๆๆถๆฏๆฏ้่ฎฏๆถๆฏๅๅๅค็
            if (msg instanceof RequestData_1.default) {
                // ๆทปๅ้ฎ็ฝฉ
                MaskManager_2.maskManager.showLoading(null, "net");
                // ๆๅฎๆถๆฏๅๆฐ่ฟๆฅไธๅฌๅฑๅๆฐไฝไธบๅๆฐ
                ObjectUtil_3.extendObject(msg.__params.data, RequestData_1.commonData);
                // ๅ้ๆถๆฏ
                msg.__policy.sendRequest(msg);
                // ๆดพๅ็ณป็ปๆถๆฏ
                observable.dispatch(NetMessage_1.default.NET_REQUEST, msg);
            }
        };
        /**
         * ๆทปๅๅๆธๆถๆฏ็ๅฌ๏ผ้ๅฐ้่ฎฏๆถๆฏๅๅ้ๅฐๅ็ซฏ๏ผๆฅๅฐ่ฟๅๅผๅไผๅฐๅถๅ้ๅฐๆๅฎๅๆธ้
         *
         * @param {IObservable} observable ๅๆธ
         * @memberof NetManager
         */
        NetManager.prototype.listenRequest = function (observable) {
            observable.listen(CoreMessage_2.default.MESSAGE_DISPATCHED, this.onMsgDispatched, observable);
        };
        /**
         * ๆณจๅไธไธช่ฟๅ็ปๆไฝ
         *
         * @param {string} type ่ฟๅ็ฑปๅ
         * @param {IResponseDataConstructor} cls ่ฟๅ็ปๆไฝๆ้ๅจ
         * @memberof NetManager
         */
        NetManager.prototype.registerResponse = function (cls) {
            this._responseDict[cls.type] = cls;
        };
        /**
         * ๆทปๅไธไธช้่ฎฏ่ฟๅ็ๅฌ
         *
         * @param {(IResponseDataConstructor|string)} clsOrType ่ฆ็ๅฌ็่ฟๅ็ปๆๆ้ๅจๆ่็ฑปๅๅญ็ฌฆไธฒ
         * @param {ResponseHandler} handler ๅ่ฐๅฝๆฐ
         * @param {*} [thisArg] thisๆๅ
         * @param {boolean} [once=false] ๆฏๅฆไธๆฌกๆง็ๅฌ
         * @param {IObservable} [observable] ่ฆๅ้ๅฐ็ๅๆธ
         * @memberof NetManager
         */
        NetManager.prototype.listenResponse = function (clsOrType, handler, thisArg, once, observable) {
            if (once === void 0) { once = false; }
            if (!observable)
                observable = Core_6.core.observable;
            var type = (typeof clsOrType == "string" ? clsOrType : clsOrType.type);
            var listeners = this._responseListeners[type];
            if (!listeners)
                this._responseListeners[type] = listeners = [];
            for (var _i = 0, listeners_2 = listeners; _i < listeners_2.length; _i++) {
                var listener = listeners_2[_i];
                if (handler == listener[0] && thisArg == listener[1] && once == listener[2])
                    return;
            }
            listeners.push([handler, thisArg, once, observable]);
        };
        /**
         * ็งป้คไธไธช้่ฎฏ่ฟๅ็ๅฌ
         *
         * @param {(IResponseDataConstructor|string)} clsOrType ่ฆ็งป้ค็ๅฌ็่ฟๅ็ปๆๆ้ๅจๆ่็ฑปๅๅญ็ฌฆไธฒ
         * @param {ResponseHandler} handler ๅ่ฐๅฝๆฐ
         * @param {*} [thisArg] thisๆๅ
         * @param {boolean} [once=false] ๆฏๅฆไธๆฌกๆง็ๅฌ
         * @param {IObservable} [observable] ่ฆๅ้ๅฐ็ๅๆธ
         * @memberof NetManager
         */
        NetManager.prototype.unlistenResponse = function (clsOrType, handler, thisArg, once, observable) {
            if (once === void 0) { once = false; }
            if (!observable)
                observable = Core_6.core.observable;
            var type = (typeof clsOrType == "string" ? clsOrType : clsOrType.type);
            var listeners = this._responseListeners[type];
            if (listeners) {
                for (var i = 0, len = listeners.length; i < len; i++) {
                    var listener = listeners[i];
                    if (handler == listener[0] && thisArg == listener[1] && once == listener[2] && observable == listener[3]) {
                        listeners.splice(i, 1);
                        break;
                    }
                }
            }
        };
        /**
         * ๅ้ๅคๆก่ฏทๆฑ๏ผๅนถไธ็ญๅพ่ฟๅ็ปๆ๏ผๅฆๆๆ็่ฏ๏ผ๏ผ่ฐ็จๅ่ฐ
         *
         * @param {RequestData[]} [requests ่ฆๅ้็่ฏทๆฑๅ่กจ
         * @param {(responses?:ResponseData[])=>void} [handler] ๆถๅฐ่ฟๅ็ปๆๅ็ๅ่ฐๅฝๆฐ
         * @param {*} [thisArg] thisๆๅ
         * @param {IObservable} [observable] ่ฆๅ้ๅฐ็ๅๆธ
         * @memberof NetManager
         */
        NetManager.prototype.sendMultiRequests = function (requests, handler, thisArg, observable) {
            var responses = [];
            var leftResCount = 0;
            if (!observable)
                observable = Core_6.core.observable;
            for (var _i = 0, _a = requests || []; _i < _a.length; _i++) {
                var request = _a[_i];
                var response = request.__params.response;
                if (response) {
                    // ็ๅฌไธๆฌกๆง่ฟๅ
                    this.listenResponse(response, onResponse, this, true);
                    // ่ฎฐๅฝ่ฟๅ็ๅฌ
                    responses.push(response);
                    // ่ฎฐๅฝๆฐ้
                    leftResCount++;
                }
                // ๅ้่ฏทๆฑ
                observable.dispatch(request);
            }
            // ๆต่ฏๅ่ฐ
            testCallback();
            function onResponse(response) {
                for (var key in responses) {
                    var temp = responses[key];
                    if (temp == response.constructor) {
                        responses[key] = response;
                        leftResCount--;
                        // ๆต่ฏๅ่ฐ
                        testCallback();
                        break;
                    }
                }
            }
            function testCallback() {
                // ๅคๆญๆฏๅฆๅจ้จๆฟๆขๅฎๆฏ
                if (leftResCount <= 0) {
                    handler && handler.call(thisArg, responses);
                }
            }
        };
        /** ่ฟ้ๅฏผๅบไธๅธๆ็จๆทไฝฟ็จ็ๆนๆณ๏ผไพๆกๆถๅไฝฟ็จ */
        NetManager.prototype.__onResponse = function (type, result, request) {
            // ็งป้ค้ฎ็ฝฉ
            MaskManager_2.maskManager.hideLoading("net");
            // ่งฃๆ็ปๆ
            var cls = this._responseDict[type];
            if (cls) {
                var response = new cls();
                // ่ฎพ็ฝฎ้ๅฏน่ฏทๆฑๅๅ้ๅๆธ
                var observable = Core_6.core.observable;
                if (request) {
                    response.__params.request = request;
                    // ๅฆๆๆ้ๅฏน่ฏทๆฑ๏ผๅๅฐ่ฟๅๅผๅ้ๅฐ่ฏทๆฑๆๅจ็ๅๆธ้
                    observable = request.__observable;
                }
                // ๆง่ก่งฃๆ
                response.parse(result);
                // ๆดพๅไบไปถ
                observable.dispatch(NetMessage_1.default.NET_RESPONSE, response, request);
                // ่งฆๅไบไปถๅฝขๅผ็ๅฌ
                var listeners = this._responseListeners[type];
                if (listeners) {
                    listeners = listeners.concat();
                    for (var _i = 0, listeners_3 = listeners; _i < listeners_3.length; _i++) {
                        var listener = listeners_3[_i];
                        if (listener[3] == observable) {
                            // ๅฟ้กปๆฏๅๆธๆถๆฏๆ่ฝ่งฆๅๅ่ฐ
                            listener[0].call(listener[1], response, request);
                            // ๅฆๆๆฏไธๆฌกๆง็ๅฌๅ็งป้คไน
                            if (listener[2])
                                this.unlistenResponse(type, listener[0], listener[1], listener[2], listener[3]);
                        }
                    }
                }
            }
            else {
                console.warn("ๆฒกๆๆพๅฐ่ฟๅ็ปๆไฝๅฎไน๏ผ" + type);
            }
        };
        NetManager.prototype.__onError = function (err, request) {
            // ็งป้ค้ฎ็ฝฉ
            MaskManager_2.maskManager.hideLoading("net");
            // ๅฆๆๆ้ๅฏน่ฏทๆฑ๏ผๅๅฐ่ฟๅๅผๅ้ๅฐ่ฏทๆฑๆๅจ็ๅๆธ้
            var observable = request ? request.__observable : Core_6.core;
            // ๆดพๅไบไปถ
            observable.dispatch(NetMessage_1.default.NET_ERROR, err, request);
        };
        NetManager = __decorate([
            Injector_4.Injectable,
            __metadata("design:paramtypes", [])
        ], NetManager);
        return NetManager;
    }());
    exports.default = NetManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.netManager = Core_6.core.getInject(NetManager);
});
define("src/trunk/engine/module/ModuleMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * ๆจกๅๆถๆฏ
    */
    var ModuleMessage = /** @class */ (function () {
        function ModuleMessage() {
        }
        /**
         * ๅๆขๆจกๅๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof ModuleMessage
         */
        ModuleMessage.MODULE_CHANGE = "moduleChange";
        /**
         * ๅ่ฝฝๆจกๅๅคฑ่ดฅๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof ModuleMessage
         */
        ModuleMessage.MODULE_LOAD_ASSETS_ERROR = "moduleLoadAssetsError";
        return ModuleMessage;
    }());
    exports.default = ModuleMessage;
});
define("src/trunk/utils/URLUtil", ["require", "exports", "src/trunk/utils/ObjectUtil"], function (require, exports, ObjectUtil_4) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * ่งๆดurl
     * @param url
     */
    function trimURL(url) {
        // ๅป้คๅคไฝ็"/"
        url = url.replace(/([^:/])(\/)+/g, "$1/");
        if (url.charAt(0) == "/")
            url = url.substr(1);
        // ๅค็"/./"
        var index;
        while ((index = url.indexOf("/./")) >= 0) {
            url = url.replace("/./", "/");
        }
        // ๅค็"/xx/../"
        var reg = /\/[^\/\.]+?\/\.\.\//;
        while (reg.test(url)) {
            url = url.replace(reg, "/");
        }
        return url;
    }
    exports.trimURL = trimURL;
    /**
     * ๆฃๆฅURLๆฏๅฆๆฏ็ปๅฏน่ทฏๅพ๏ผๅทๆๅ่ฎฎๅคด๏ผ
     * @param url ่ฆๅคๆญ็URL
     * @returns {any} ๆฏๅฆๆฏ็ปๅฏน่ทฏๅพ
     */
    function isAbsolutePath(url) {
        if (url == null)
            return false;
        return (url.indexOf("://") >= 0);
    }
    exports.isAbsolutePath = isAbsolutePath;
    /**
     * ๅฆๆurlๆprotocol๏ผไฝฟๅถไธๅฝๅๅๅ็protocol็ปไธ๏ผๅฆๅไผ่ทจๅ
     * @param url ่ฆ็ปไธprotocol็url
     */
    function validateProtocol(url) {
        if (url == null)
            return null;
        var index = url.indexOf("://");
        if (index < 0)
            return url;
        var protocol = url.substring(0, index);
        // ่ฐๆดhttpๅhttps
        if (protocol == "http" || protocol == "https") {
            return window.location.protocol + url.substr(index + 1);
        }
        // ่ฐๆดwsๅwss
        if (protocol == "ws" || protocol == "wss") {
            if (window.location.protocol == "https:")
                protocol = "wss";
            else
                protocol = "ws";
            return protocol + url.substr(index);
        }
        // ไธ้่ฆ่ฐๆด
        return url;
    }
    exports.validateProtocol = validateProtocol;
    /**
     * ๆฟๆขurlไธญ็host
     * @param url       url
     * @param host      ่ฆๆฟๆข็host
     * @param forced    ๆฏๅฆๅผบๅถๆฟๆข๏ผ้ป่ฎคfalse๏ผ
     */
    function wrapHost(url, host, forced) {
        if (forced === void 0) { forced = false; }
        host = host || window.location.origin;
        var re = /^(?:[^\/]+):\/{2,}(?:[^\/]+)\//;
        var arr = url.match(re);
        if (arr && arr.length > 0) {
            if (forced) {
                url = url.substr(arr[0].length);
                url = host + "/" + url;
            }
        }
        else {
            url = host + "/" + url;
        }
        // ๅๆณๅไธไธprotocol
        url = validateProtocol(url);
        // ๆๅ่งๆดไธไธurl
        url = trimURL(url);
        return url;
    }
    exports.wrapHost = wrapHost;
    /**
     * ๅฐ็ธๅฏนไบๅฝๅ้กต้ข็็ธๅฏน่ทฏๅพๅ่ฃๆ็ปๅฏน่ทฏๅพ
     * @param relativePath ็ธๅฏนไบๅฝๅ้กต้ข็็ธๅฏน่ทฏๅพ
     * @param host ไผ้่ฏฅๅๆฐไผ็จ่ฏฅhostๆฟๆขๅฝๅhost
     */
    function wrapAbsolutePath(relativePath, host) {
        // ่ทๅๅฝๅ้กต้ข็url
        var curPath = getPath(window.location.href);
        var url = trimURL(curPath + "/" + relativePath);
        if (host != null) {
            url = wrapHost(url, host, true);
        }
        return url;
    }
    exports.wrapAbsolutePath = wrapAbsolutePath;
    /**
     * ่ทๅURL็host+pathname้จๅ๏ผๅณ้ฎๅท(?)ไปฅๅ็้จๅ
     *
     */
    function getHostAndPathname(url) {
        if (url == null)
            throw new Error("urlไธ่ฝไธบ็ฉบ");
        // ๅปๆgetๅๆฐๅhash
        url = url.split("#")[0].split("?")[0];
        // ๅปๆๅคไฝ็/
        url = trimURL(url);
        return url;
    }
    exports.getHostAndPathname = getHostAndPathname;
    /**
     * ่ทๅURL่ทฏๅพ๏ผๆไปถๅๅ็้จๅ๏ผ
     * @param url ่ฆๅๆ็URL
     */
    function getPath(url) {
        // ้ฆๅๅปๆๅคไฝ็/
        url = getHostAndPathname(url);
        // ็ถๅ่ทๅๅฐ่ทฏๅพ
        var urlArr = url.split("/");
        urlArr.pop();
        return urlArr.join("/") + "/";
    }
    exports.getPath = getPath;
    /**
     * ่ทๅURL็ๆไปถๅ
     * @param url ่ฆๅๆ็URL
     */
    function getName(url) {
        // ๅๅปๆgetๅๆฐๅhash
        url = url.split("#")[0].split("?")[0];
        // ็ถๅ่ทๅๅฐๆไปถๅ
        var urlArr = url.split("/");
        var fileName = urlArr[urlArr.length - 1];
        return fileName;
    }
    exports.getName = getName;
    /**
     * ่งฃๆURL
     * @param url ่ฆ่ขซ่งฃๆ็URLๅญ็ฌฆไธฒ
     * @returns {any} ่งฃๆๅ็URLLocation็ปๆไฝ
     */
    function parseUrl(url) {
        var regExp = /(([^:]+:)\/\/(([^:\/\?#]+)(:(\d+))?))(\/[^?#]*)?(\?[^#]*)?(#.*)?/;
        var match = regExp.exec(url);
        if (match) {
            return {
                href: match[0] || "",
                origin: match[1] || "",
                protocol: match[2] || "",
                host: match[3] || "",
                hostname: match[4] || "",
                port: match[6] || "",
                pathname: match[7] || "",
                search: match[8] || "",
                hash: (match[9] == "#" ? "" : match[9]) || ""
            };
        }
        else {
            throw new Error("ไผๅฅparseUrlๆนๆณ็ๅๆฐไธๆฏไธไธชๅฎๆด็URL๏ผ" + url);
        }
    }
    exports.parseUrl = parseUrl;
    /**
     * ่งฃๆurlๆฅ่ฏขๅๆฐ
     * @TODO ๆทปๅๅฏนjquery็ผ็ๆนๅผ็ๆฏๆ
     * @param url url
     */
    function getQueryParams(url) {
        var index = url.indexOf("#");
        if (index >= 0) {
            url = url.substring(0, index);
        }
        index = url.indexOf("?");
        if (index < 0)
            return {};
        var queryString = url.substring(index + 1);
        var params = {};
        var kvs = queryString.split("&");
        kvs.forEach(function (kv) {
            var pair = kv.split("=", 2);
            if (pair.length !== 2 || !pair[0]) {
                console.log("[URLUtil] invalid query params: " + kv);
                return;
            }
            var name = decodeURIComponent(pair[0]);
            var value = decodeURIComponent(pair[1]);
            params[name] = value;
        });
        return params;
    }
    exports.getQueryParams = getQueryParams;
    /**
     * ๅฐๅๆฐ่ฟๆฅๅฐๆๅฎURLๅ้ข
     * @param url url
     * @param params ไธไธชmap๏ผๅๅซ่ฆ่ฟๆฅ็ๅๆฐ
     * @return string ่ฟๆฅๅ็URLๅฐๅ
     */
    function joinQueryParams(url, params) {
        if (url == null)
            throw new Error("urlไธ่ฝไธบ็ฉบ");
        var oriParams = getQueryParams(url);
        var targetParams = ObjectUtil_4.extendObject(oriParams, params);
        var hash = parseUrl(url).hash;
        url = getHostAndPathname(url);
        var isFirst = true;
        for (var key in targetParams) {
            if (isFirst) {
                url += "?" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
                isFirst = false;
            }
            else {
                url += "&" + encodeURIComponent(key) + "=" + encodeURIComponent(targetParams[key]);
            }
        }
        // ๅไธhash
        url += hash;
        return url;
    }
    exports.joinQueryParams = joinQueryParams;
    /**
     * ๅฐๅๆฐ้พๆฅๅฐURL็hashๅ้ข
     * @param url ๅฆๆไผๅฅ็urlๆฒกๆๆณจๆhashๆจกๅ๏ผๅไธไผ่ฟ่กๆไฝ
     * @param params ไธไธชmap๏ผๅๅซ่ฆ่ฟๆฅ็ๅๆฐ
     */
    function joinHashParams(url, params) {
        if (url == null)
            throw new Error("urlไธ่ฝไธบ็ฉบ");
        var hash = parseUrl(url).hash;
        if (hash == null || hash == "")
            return url;
        for (var key in params) {
            var value = params[key];
            if (value && typeof value != "string")
                value = value.toString();
            hash += ((hash.indexOf("?") < 0 ? "?" : "&") + encodeURIComponent(key) + "=" + encodeURIComponent(value));
        }
        return (url.split("#")[0] + hash);
    }
    exports.joinHashParams = joinHashParams;
});
define("src/trunk/engine/env/Environment", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/utils/URLUtil"], function (require, exports, Core_7, Injector_5, URLUtil_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ็ฏๅขๅๆฐ
    */
    var Environment = /** @class */ (function () {
        function Environment() {
        }
        Object.defineProperty(Environment.prototype, "env", {
            /**
             * ่ทๅๅฝๅ็ฏๅขๅญ็ฌฆไธฒ
             *
             * @readonly
             * @type {string}
             * @memberof Environment
             */
            get: function () {
                return this._env;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Environment.prototype, "hostsDict", {
            /**
             * ่ทๅๅๅๅญๅธ
             *
             * @readonly
             * @type {{[env:string]:string[]}}
             * @memberof Environment
             */
            get: function () {
                return this._hostsDict;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅๅฝๅ็ฏๅขไธๆ็ดขๅผๅค็ๆถๆฏๅๅ
         *
         * @param {number} [index=0] ๅๅๅญๅธ็ดขๅผ๏ผ้ป่ฎคๆฏ0
         * @returns {string} ๅๅๅญ็ฌฆไธฒ๏ผๅฆๆๅไธๅฐๅไฝฟ็จๅฝๅๅๅ
         * @memberof Environment
         */
        Environment.prototype.getHost = function (index) {
            if (index === void 0) { index = 0; }
            var hosts = this._hostsDict[this._env];
            if (!hosts)
                return window.location.origin;
            return (hosts[index] || window.location.origin);
        };
        Object.defineProperty(Environment.prototype, "cdnsDict", {
            /**
             * ่ทๅCDNๅญๅธ
             *
             * @readonly
             * @type {{[env:string]:string[]}}
             * @memberof Environment
             */
            get: function () {
                return this._cdnsDict;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Environment.prototype, "curCDNHost", {
            /**
             * ่ทๅๅฝๅไฝฟ็จ็CDNๅๅ
             *
             * @readonly
             * @type {string}
             * @memberof Environment
             */
            get: function () {
                var cdns = this._cdnsDict[this._env];
                if (!cdns)
                    return window.location.origin;
                return (cdns[this._curCDNIndex] || window.location.origin);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๅๆขไธไธไธชCDN
         *
         * @returns {boolean} ๆฏๅฆๅทฒ็ปๅฐ่พพCDNๅ่กจ็็ป็น๏ผๅๅฐไบ่ตท็น
         * @memberof Environment
         */
        Environment.prototype.nextCDN = function () {
            var cdns = this._cdnsDict[this._env];
            if (!cdns)
                return true;
            this._curCDNIndex++;
            if (this._curCDNIndex >= cdns.length) {
                this._curCDNIndex = 0;
                return true;
            }
            return false;
        };
        /**
         * ๅๅงๅEnvironmentๅฏน่ฑก๏ผๅไธบ่ฏฅๅฏน่ฑกไฟๅญ็ๆฐๆฎๅบๆฌๆฅ่ช้กน็ฎๅๅงๅๆฐ๏ผๆไปฅๅฟ้กปๆinitializeๆนๆณ
         *
         * @param {string} [env] ๅฝๅๆๅฑ็ฏๅขๅญ็ฌฆไธฒ
         * @param {{[env:string]:string[]}} [hostsDict] hostๆฐ็ปๅญๅธ
         * @param {{[env:string]:string[]}} [cdnsDict] cdnๆฐ็ปๅญๅธ
         * @memberof Environment
         */
        Environment.prototype.initialize = function (env, hostsDict, cdnsDict) {
            this._env = env || "dev";
            this._hostsDict = hostsDict || {};
            this._cdnsDict = cdnsDict || {};
            this._curCDNIndex = 0;
        };
        /**
         * ่ฎฉurl็ๅๅๅๆๆถๆฏๅๅ
         *
         * @param {string} url ่ฆ่ฝฌๅ็url
         * @param {number} [index=0] host็ดขๅผ๏ผ้ป่ฎค0
         * @returns {string} ่ฝฌๅๅ็url
         * @memberof Environment
         */
        Environment.prototype.toHostURL = function (url, index) {
            if (index === void 0) { index = 0; }
            // ๅไธdomain
            url = URLUtil_1.wrapHost(url, this.getHost(index));
            // ่ฟๅurl
            return url;
        };
        /**
         * ่ฎฉurl็ๅๅๅๆCDNๅๅ
         *
         * @param {string} url ่ฆ่ฝฌๅ็url
         * @param {boolean} [forced=false] ๆฏๅฆๅผบๅถๆฟๆขhost
         * @param {boolean} [infix=true] ๆฏๅฆๅๅฅ่ทฏๅพไธญ็ผ๏ผๅณhostไนๅ๏ผindex.htmlไนๅ็้จๅ๏ผ้ป่ฎคๅๅฅ
         * @returns {string} ่ฝฌๅๅ็url
         * @memberof Environment
         */
        Environment.prototype.toCDNHostURL = function (url, forced, infix) {
            if (forced === void 0) { forced = false; }
            if (infix === void 0) { infix = true; }
            if (infix) {
                // ็ป็ปไธญ็ผ
                var midnameIndex = window.location.pathname.lastIndexOf("/");
                var midname = window.location.pathname.substring(0, midnameIndex + 1);
                return URLUtil_1.wrapHost(url, this.curCDNHost + "/" + midname, forced);
            }
            else {
                // ๅชๆฟๆขๅๅ
                return URLUtil_1.wrapHost(url, this.curCDNHost, forced);
            }
        };
        Environment = __decorate([
            Injector_5.Injectable
        ], Environment);
        return Environment;
    }());
    exports.default = Environment;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.environment = Core_7.core.getInject(Environment);
});
define("src/trunk/utils/HTTPUtil", ["require", "exports", "src/trunk/engine/env/Environment", "src/trunk/utils/URLUtil", "src/trunk/utils/ObjectUtil"], function (require, exports, Environment_1, URLUtil_2, ObjectUtil_5) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * ๅ้ไธไธชๆๅคไธชHTTP่ฏทๆฑ
     *
     * @export
     * @param {IHTTPRequestParams} params ่ฏทๆฑๅๆฐ
     */
    function load(params) {
        // ้็ฉบๅคๆญ
        if (!params.url) {
            // ๆๅๅ่ฐ
            params.onResponse && params.onResponse();
            return;
        }
        // ๆฐ็ปๅคๆญ
        if (params.url instanceof Array) {
            // ไธๆฌก่ฏทๆฑๅคไธชๅฐๅ๏ผ้่ฆๅไธไธช้ๅๅ่ฝฝ๏ผ็ถๅไธๆฌกๆงๅ่ฐ
            var urls = params.url;
            var results = [];
            var newParams = ObjectUtil_5.cloneObject(params);
            newParams.onResponse = function (result) {
                results.push(result);
                loadNext();
            };
            var loadNext = function () {
                if (urls.length <= 0) {
                    // ๆๅๅ่ฐ
                    params.onResponse && params.onResponse(results);
                    return;
                }
                newParams.url = urls.shift();
                load(newParams);
            };
            loadNext();
            return;
        }
        // ไธๆฌก่ฏทๆฑไธไธชๅฐๅ
        var retryTimes = params.retryTimes || 2;
        var timeout = params.timeout || 10000;
        var method = params.method || "GET";
        var timeoutId = 0;
        var data = params.data || {};
        // ๅๅฐurl
        var url = params.url;
        if (params.useCDN) {
            // ๅฆๆไฝฟ็จCDNๅๆน็จcdnๅๅ
            url = Environment_1.environment.toCDNHostURL(url);
        }
        else {
            // ๅๆณๅไธไธprotocol
            url = URLUtil_2.validateProtocol(url);
            // ่งๆดไธไธurl
            url = URLUtil_2.trimURL(url);
        }
        // ็ๆๅนถๅๅงๅxhr
        var xhr = (window["XMLHttpRequest"] ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP"));
        if (params.responseType)
            xhr.responseType = params.responseType;
        xhr.onreadystatechange = onReadyStateChange;
        // ๅ้
        send();
        function send() {
            var sendData = null;
            // ๆนๆฎๅ้ๆนๅผ็ป็ปๆฐๆฎๆผๅผ
            switch (method) {
                case "POST":
                    // POST็ฎๅ่งๅฎไธบJSONๆผๅผๅ้
                    sendData = JSON.stringify(data);
                    break;
                case "GET":
                    // ๅฐๆฐๆฎๆทปๅๅฐurlไธ
                    url = URLUtil_2.joinQueryParams(url, data);
                    break;
                default:
                    throw new Error("ๆไธๆฏๆ็HTTP Method๏ผ" + method);
            }
            // ๆๅผXHR
            xhr.open(method, url, true);
            // ๆทปๅ่ชๅฎไน่ฏทๆฑๅคด
            for (var key in params.headerDict) {
                xhr.setRequestHeader(key, params.headerDict[key]);
            }
            // ๅผๅงๅ้
            xhr.send(sendData);
        }
        function onReadyStateChange() {
            switch (xhr.readyState) {
                case 2:// ๅทฒ็ปๅ้๏ผๅผๅง่ฎกๆถ
                    timeoutId = setTimeout(abortAndRetry, timeout);
                    break;
                case 4:// ๆฅๆถๅฎๆฏ
                    // ๅๆญข่ฎกๆถ
                    timeoutId && clearTimeout(timeoutId);
                    timeoutId = 0;
                    if (xhr.status == 200) {
                        // ๆๅๅ่ฐ
                        params.onResponse && params.onResponse(xhr.response);
                    }
                    else if (retryTimes > 0) {
                        // ๆฒกๆ่ถ่ฟ้่ฏไธ้ๅ้่ฏ
                        abortAndRetry();
                    }
                    else {
                        // ๅบ้๏ผๅฆๆไฝฟ็จCDNๅ่ฝๅๅฐ่ฏๅๆข
                        if (params.useCDN && !Environment_1.environment.nextCDN()) {
                            // ่ฟๆฒกๅๆขๅฎ๏ผ้ๆฐๅ่ฝฝ
                            load(params);
                        }
                        else {
                            // ๅๆขๅฎไบ่ฟๅคฑ่ดฅ๏ผๅๆฑๆฅ้่ฏฏ
                            var err = new Error(xhr.status + " " + xhr.statusText);
                            params.onError && params.onError(err);
                        }
                    }
                    break;
            }
        }
        function abortAndRetry() {
            // ้่ฏๆฌกๆฐ้ๅ
            retryTimes--;
            // ไธญๆญขxhr
            xhr.abort();
            // ๆทปๅๆถ้ดๆณไฝไธบ้ๆบ็ๆฌๅท
            url = URLUtil_2.joinQueryParams(url, { _r: Date.now() });
            // ้ๆฐๅ้
            send();
        }
    }
    exports.load = load;
});
define("src/trunk/engine/version/Version", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/utils/URLUtil"], function (require, exports, Core_8, Injector_6, URLUtil_3) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ็ฎก็ๆไปถๅๅธ็ๆฌๅท
    */
    var Version = /** @class */ (function () {
        function Version() {
            this._hashDict = {};
        }
        /**
         * ๅๅงๅๅๅธ็ๆฌๅทฅๅท
         *
         * @param {()=>void} handler ๅ่ฐ
         * @memberof Version
         */
        Version.prototype.initialize = function (handler) {
            var _this = this;
            if (window["__Olympus_Version_hashDict__"]) {
                // ไนๅๅจๅชๅ่ฝฝ่ฟ๏ผๆ้ๅๆฌกๅ่ฝฝ๏ผ็ดๆฅไฝฟ็จ
                this._hashDict = window["__Olympus_Version_hashDict__"];
                handler();
            }
            else {
                // ๅปๅ่ฝฝversion.cfg
                var request = null;
                if (window["XMLHttpRequest"]) {
                    // code for IE7+, Firefox, Chrome, Opera, Safari
                    request = new XMLHttpRequest();
                }
                else if (window["ActiveXObject"]) {
                    // code for IE6, IE5
                    request = new ActiveXObject("Microsoft.XMLHTTP");
                }
                // ๆณจๅๅ่ฐๅฝๆฐ
                request.onreadystatechange = function (evt) {
                    var request = evt.target;
                    //ๅคๆญๅฏน่ฑก็ถๆๆฏไบคไบๅฎๆ๏ผๆฅๆถๆๅกๅจ่ฟๅ็ๆฐๆฎ
                    if (request.readyState == 4) {
                        if (request.status == 200) {
                            var fileName = request["fileName"];
                            var responseText = request.responseText;
                            var lines = responseText.split("\n");
                            for (var i in lines) {
                                var line = lines[i];
                                var arr = line.split("  ");
                                if (arr.length == 2) {
                                    var key = arr[1].substr(2);
                                    var value = arr[0];
                                    _this._hashDict[key] = value;
                                }
                            }
                            // ๅจwindowไธๆไธไปฝ
                            window["__Olympus_Version_hashDict__"] = _this._hashDict;
                        }
                        handler();
                    }
                };
                // ่ฎพ็ฝฎ่ฟๆฅไฟกๆฏ
                request.open("GET", "version.cfg?v=" + new Date().getTime(), true);
                // ๅ้ๆฐๆฎ๏ผๅผๅงๅๆๅกๅจ่ฟ่กไบคไบ
                request.send();
            }
        };
        /**
         * ่ทๅๆไปถๅๅธๅผ๏ผๅฆๆๆฒกๆๆไปถๅๅธๅผๅ่ฟๅnull
         *
         * @param {string} url ๆไปถ็URL
         * @returns {string} ๆไปถ็ๅๅธๅผ๏ผๆ่null
         * @memberof Version
         */
        Version.prototype.getHash = function (url) {
            url = URLUtil_3.trimURL(url);
            var result = null;
            for (var path in this._hashDict) {
                if (url.indexOf(path) >= 0) {
                    result = this._hashDict[path];
                    break;
                }
            }
            return result;
        };
        /**
         * ๅฐurl่ฝฌๆขไธบๅๅธ็ๆฌurl
         *
         * @param {string} url ๅๅงurl
         * @returns {string} ๅๅธ็ๆฌurl
         * @memberof Version
         */
        Version.prototype.wrapHashUrl = function (url) {
            var hash = this.getHash(url);
            if (hash != null) {
                url = this.joinVersion(url, hash);
            }
            return url;
        };
        /**
         * ๆทปๅ-r_XXXๅฝขๅผ็ๆฌๅท
         *
         * @param {string} url
         * @param {string} version ็ๆฌๅท๏ผไปฅๆฐๅญๅๅฐๅๅญๆฏ็ปๆ
         * @returns {string} ๅ็ๆฌๅทๅ็url๏ผๅฆๆๆฒกๆๆฅๅฐ็ๆฌๅทๅ่ฟๅๅๅงurl
         * @memberof Version
         */
        Version.prototype.joinVersion = function (url, version) {
            if (version == null)
                return url;
            // ๅปๆversionไธญ็้ๆณๅญ็ฌฆ
            version = version.replace(/[^0-9a-z]+/ig, "");
            // ๆๅฅ็ๆฌๅท
            var reg = /(([a-zA-Z]+:\/+[^\/\?#]+\/)?[^\?#]+)\.([^\?]+)(\?.+)?/;
            var result = reg.exec(url);
            if (result != null) {
                url = result[1] + "-r_" + version + "." + result[3] + (result[4] || "");
            }
            return url;
        };
        /**
         * ็งป้ค-r_XXXๅฝขๅผ็ๆฌๅท
         *
         * @param {string} url url
         * @returns {string} ็งป้ค็ๆฌๅทๅ็url
         * @memberof Version
         */
        Version.prototype.removeVersion = function (url) {
            // ๅปๆ-r_XXX็ๆฌๅท๏ผๅฆๆๆ
            url = url.replace(/\-r_[a-z0-9]+\./ig, ".");
            return url;
        };
        Version = __decorate([
            Injector_6.Injectable
        ], Version);
        return Version;
    }());
    exports.default = Version;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.version = Core_8.core.getInject(Version);
});
define("src/trunk/engine/assets/AssetsManager", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/Core", "src/trunk/utils/HTTPUtil", "src/trunk/engine/version/Version"], function (require, exports, Injector_7, Core_9, HTTPUtil_1, Version_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-26
     * @modify date 2017-10-26
     *
     * ่ตๆบ็ฎก็ๅจ
    */
    var AssetsManager = /** @class */ (function () {
        function AssetsManager() {
            this._keyDict = {};
            this._assetsDict = {};
        }
        /**
         * @private
         */
        AssetsManager.prototype.configPath = function (arg1, arg2) {
            if (typeof arg1 == "string") {
                this._keyDict[arg1] = arg2;
            }
            else {
                for (var key in arg1) {
                    this._keyDict[key] = arg1[key];
                }
            }
        };
        /**
         * ่ทๅ่ตๆบ๏ผๅๆญฅ็๏ผไธๅฆๆๆพไธๅฐ่ตๆบๅนถไธไผ่งฆๅๅ่ฝฝ
         *
         * @param {string} keyOrPath ่ตๆบ็็ญๅ็งฐๆ่ทฏๅพ
         * @returns {*}
         * @memberof AssetsManager
         */
        AssetsManager.prototype.getAssets = function (keyOrPath) {
            var path = this._keyDict[keyOrPath] || keyOrPath;
            return this._assetsDict[path];
        };
        /**
         * ๅ่ฝฝ่ตๆบ๏ผๅฆๆๅทฒๅ่ฝฝ่ฟๅๅๆญฅๅ่ฐ๏ผๅฆๆๆชๅ่ฝฝๅๅ่ฝฝๅๅผๆญฅๅ่ฐ
         *
         * @param {string|string[]} keyOrPath ่ตๆบ็ญๅ็งฐๆ่ตๆบ่ทฏๅพ
         * @param {(assets?:any|any[])=>void} complete ๅฎๆๅ่ฐ๏ผๅฆๆๅ่ฝฝๅคฑ่ดฅๅๅๆฐๆฏไธชErrorๅฏน่ฑก
         * @param {XMLHttpRequestResponseType} [responseType] ๅ่ฝฝ็ฑปๅ
         * @returns {void}
         * @memberof AssetsManager
         */
        AssetsManager.prototype.loadAssets = function (keyOrPath, complete, responseType) {
            var _this = this;
            // ้็ฉบๅคๆญ
            if (!keyOrPath) {
                complete();
                return;
            }
            // ่ทๅ่ทฏๅพ
            if (keyOrPath instanceof Array) {
                // ๆฏไธชๆฐ็ป๏ผ่ฝฌๆขๆๅไธๅ็งฐๆๅฏน่ฑก
                var results = [];
                var onGetOne = function (result) {
                    // ่ฎฐๅฝ็ปๆ
                    results.push(result);
                    // ่ทๅไธไธไธช
                    getOne();
                };
                var getOne = function () {
                    if (keyOrPath.length <= 0)
                        complete(results);
                    else
                        _this.loadAssets(keyOrPath.shift(), onGetOne);
                };
                getOne();
            }
            else {
                // ๆฏๅไธๅ็งฐๆๅฏน่ฑก
                var path = this._keyDict[keyOrPath] || keyOrPath;
                // ่ทๅๅผ
                var value = this._assetsDict[path];
                if (value instanceof Array) {
                    // ๆญฃๅจๅ่ฝฝไธญ๏ผ็ญๅพไน
                    value.push(complete);
                }
                else if (value) {
                    // ๅทฒ็ปๅ่ฝฝ่ฟไบ๏ผ็ดๆฅ่ฟๅ
                    complete(value);
                }
                else {
                    // ๆฒกๆๅฐฑๅปๅ่ฝฝ
                    this._assetsDict[path] = value = [complete];
                    HTTPUtil_1.load({
                        url: Version_1.version.wrapHashUrl(path),
                        useCDN: true,
                        responseType: responseType,
                        onResponse: function (result) {
                            // ่ฎฐๅฝ็ปๆ
                            _this._assetsDict[path] = result;
                            // ้็ฅๅไธชๅ่ฐ
                            for (var _i = 0, value_1 = value; _i < value_1.length; _i++) {
                                var handler = value_1[_i];
                                handler(result);
                            }
                        },
                        onError: function (err) {
                            // ็งป้ค็ปๆ
                            delete _this._assetsDict[path];
                            // ้็ฅๅไธชๅ่ฐ
                            for (var _i = 0, value_2 = value; _i < value_2.length; _i++) {
                                var handler = value_2[_i];
                                handler(err);
                            }
                        }
                    });
                }
            }
        };
        AssetsManager = __decorate([
            Injector_7.Injectable
        ], AssetsManager);
        return AssetsManager;
    }());
    exports.default = AssetsManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.assetsManager = Core_9.core.getInject(AssetsManager);
});
define("src/trunk/engine/env/Shell", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/Core"], function (require, exports, Injector_8, Core_10) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-23
     * @modify date 2017-10-23
     *
     * ๅคๅฃณๆฅๅฃ๏ผ่ฏฅ็ฑปๆขไฝไธบๅคๅฃณๆฅๅฃ็ๆณจๅฅๅบ็ฑป๏ผไนไฝไธบๆๅๆต่งๅจ็ๅฎ็ฐไฝฟ็จ
    */
    var Shell = /** @class */ (function () {
        function Shell() {
        }
        Object.defineProperty(Shell.prototype, "type", {
            /**
             * ่ทๅๅฝๅๅคๅฃณ็ฑปๅ
             *
             * @readonly
             * @type {string}
             * @memberof Shell
             */
            get: function () {
                return "web";
            },
            enumerable: true,
            configurable: true
        });
        /*************************** ไธ้ขๆฏ้กต้ข่ทณ่ฝฌๆฅๅฃ ***************************/
        /**
         * ๅทๆฐ้กต้ข
         *
         * @param {{
         *         forcedReload?:boolean, // false่กจ็คบๅ่ฎธไป็ผๅญๅ๏ผtrue่กจ็คบๅผบๅถไปๆๅกๅจๅ๏ผ้ป่ฎคๆฏfalse
         *         url?:string, // ไผ้ๅไฝฟ็จๆฐURLๅทๆฐ้กต้ข
         *         replace?:boolean // ๅฆๆๆๆฐurl๏ผๅ่กจ็คบๆฏๅฆ่ฆๆฟๆขๅฝๅๆต่งๅๅฒ
         *     }} [params]
         * @memberof Shell
         */
        Shell.prototype.reload = function (params) {
            if (!params)
                window.location.reload();
            else if (!params.url)
                window.location.reload(params.forcedReload);
            else if (!params.replace)
                window.location.href = params.url;
            else
                window.location.replace(params.url);
        };
        /**
         * ๆๅผไธไธชๆฐ้กต้ข
         *
         * @param {{
         *         url?:string, // ๆฐ้กต้ขๅฐๅ๏ผไธไผๅไธๆดๆฐๅฐๅ
         *         name?:string, // ็ปๆฐ้กต้ขๅฝๅ๏ผๆๅฏผ่ชๅฐๅทฒๆ้กต้ข
         *         replace?:boolean, // ๆฏๅฆๆฟๆขๅฝๅๆต่งๅๅฒๆก็ฎ๏ผ้ป่ฎคfalse
         *         features:{[key:string]:any} // ๅถไปๅฏ่ฝ็ๅๆฐ
         *     }} [params]
         * @memberof Shell
         */
        Shell.prototype.open = function (params) {
            if (!params) {
                window.open();
            }
            else {
                var features = undefined;
                if (params.features) {
                    features = [];
                    for (var key in params.features) {
                        features.push(key + "=" + params.features[key]);
                    }
                }
                window.open(params.url, params.name, features && features.join(","), params.replace);
            }
        };
        /**
         * ๅณ้ญ็ชๅฃ
         *
         * @memberof Shell
         */
        Shell.prototype.close = function () {
            window.close();
        };
        /*************************** ไธ้ขๆฏๆฌๅฐๅญๅจๆฅๅฃ ***************************/
        /**
         * ่ทๅๆฌๅฐๅญๅจ
         *
         * @param {string} key ่ฆ่ทๅๅผ็้ฎ
         * @returns {string} ่ทๅ็ๅผ
         * @memberof Shell
         */
        Shell.prototype.localStorageGet = function (key) {
            return window.localStorage.getItem(key);
        };
        /**
         * ่ฎพ็ฝฎๆฌๅฐๅญๅจ
         *
         * @param {string} key ่ฆ่ฎพ็ฝฎ็้ฎ
         * @param {string} value ่ฆ่ฎพ็ฝฎ็ๅผ
         * @memberof Shell
         */
        Shell.prototype.localStorageSet = function (key, value) {
            window.localStorage.setItem(key, value);
        };
        /**
         * ็งป้คๆฌๅฐๅญๅจ
         *
         * @param {string} key ่ฆ็งป้ค็้ฎ
         * @memberof Shell
         */
        Shell.prototype.localStorageRemove = function (key) {
            window.localStorage.removeItem(key);
        };
        /**
         * ๆธ็ฉบๆฌๅฐๅญๅจ
         *
         * @memberof Shell
         */
        Shell.prototype.localStorageClear = function () {
            window.localStorage.clear();
        };
        Shell = __decorate([
            Injector_8.Injectable
        ], Shell);
        return Shell;
    }());
    exports.default = Shell;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.shell = Core_10.core.getInject(Shell);
});
define("src/trunk/engine/audio/IAudio", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/audio/AudioMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-30
     * @modify date 2017-10-30
     *
     * ้ณ้ขๆถๆฏ
    */
    var AudioMessage = /** @class */ (function () {
        function AudioMessage() {
        }
        /**
         * ้ณ้ขๆญๆพๅผๅงไบไปถ
         *
         * @static
         * @type {string}
         * @memberof AudioMessage
         */
        AudioMessage.AUDIO_PLAY_STARTED = "audioPlayStarted";
        /**
         * ้ณ้ขๆญๆพๅๆญขไบไปถ
         *
         * @static
         * @type {string}
         * @memberof AudioMessage
         */
        AudioMessage.AUDIO_PLAY_STOPPED = "audioPlayStopped";
        /**
         * ้ณ้ขๆญๆพๅฎๆฏไบไปถ
         *
         * @static
         * @type {string}
         * @memberof AudioMessage
         */
        AudioMessage.AUDIO_PLAY_ENDED = "audioPlayEnded";
        /**
         * ้ณ้ขๆญๆพ่ฟๅบฆไบไปถ
         *
         * @static
         * @type {string}
         * @memberof AudioMessage
         */
        AudioMessage.AUDIO_PLAY_PROGRESS = "audioPlayProgress";
        return AudioMessage;
    }());
    exports.default = AudioMessage;
});
define("src/trunk/engine/audio/AudioTagImpl", ["require", "exports", "src/trunk/core/Core", "src/trunk/engine/audio/AudioMessage", "src/trunk/engine/env/Environment"], function (require, exports, Core_11, AudioMessage_1, Environment_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-30
     * @modify date 2017-10-30
     *
     * ไฝฟ็จAudioๆ็ญพๅฎ็ฐIAudioๆฅๅฃ็ๅฎ็ฐ็ฑป
    */
    var AudioTagImpl = /** @class */ (function () {
        function AudioTagImpl() {
            this._audioCache = {};
        }
        /**
         * ๅ่ฝฝ้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.load = function (url) {
            var _this = this;
            var toUrl = Environment_2.environment.toCDNHostURL(url);
            // ๅฐ่ฏ่ทๅ็ผๅญๆฐๆฎ
            var data = this._audioCache[toUrl];
            // ๅฆๆๆฒกๆ็ผๅญๆๅปๅ่ฝฝ
            if (!data) {
                // ไฝฟ็จAudioๆ็ญพๅ่ฝฝ
                var node = document.createElement("audio");
                node.src = toUrl;
                // ไฟๅญๆฐๆฎ
                this._audioCache[toUrl] = data = { node: node, status: AudioStatus.LOADING, playParams: null };
                // ็ๅฌๅ่ฝฝ
                node.onloadeddata = function () {
                    // ่ฎฐๅฝๅ่ฝฝๅฎๆฏ
                    data.status = AudioStatus.PAUSED;
                    // ๅฆๆ่ชๅจๆญๆพๅๆญๆพ
                    if (data.playParams)
                        _this.play(data.playParams);
                };
                node.onended = function () {
                    // ๆดพๅๆญๆพๅฎๆฏไบไปถ
                    Core_11.core.dispatch(AudioMessage_1.default.AUDIO_PLAY_ENDED, url);
                };
            }
        };
        /**
         * ๆญๆพ้ณ้ข๏ผๅฆๆ้ณ้ขๆฒกๆๅ่ฝฝๅๅๅ่ฝฝๅๆญๆพ
         *
         * @param {AudioPlayParams} params ้ณ้ขๆญๆพๅๆฐ
         * @returns {void}
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.play = function (params) {
            var toUrl = Environment_2.environment.toCDNHostURL(params.url);
            // ๅฐ่ฏ่ทๅ็ผๅญๆฐๆฎ
            var data = this._audioCache[toUrl];
            if (!data) {
                // ๆฒกๆๅ่ฝฝ่ฟ๏ผๅผๅงๅ่ฝฝ้ณ้ข
                this.load(params.url);
                // ่ฎพ็ฝฎๆญๆพๅๆฐ
                this._audioCache[toUrl].playParams = params;
            }
            else {
                switch (data.status) {
                    case AudioStatus.LOADING:
                        // ๆญฃๅจๅ่ฝฝไธญ๏ผๆฟๆข่ชๅจๆญๆพๅๆฐ
                        data.playParams = params;
                        break;
                    case AudioStatus.PLAYING:
                        // ๆญฃๅจๆญๆพ๏ผๅณ้ญๅๅๆญๆพ
                        this.stop(params.url);
                        this.play(params);
                        break;
                    case AudioStatus.PAUSED:
                        // ๅทฒ็ปๅ่ฝฝๅฎๆฏ๏ผๆๅไธญ๏ผ็ดๆฅๆญๆพ
                        if (params.stopOthers)
                            this.stopAll();
                        if (params.loop != null)
                            data.node.loop = params.loop;
                        if (params.time != null)
                            data.node.currentTime = params.time * 0.001;
                        // ็ๅฌๆญๆพ่ฟๅบฆ
                        data.node.ontimeupdate = function (evt) {
                            // ๅชๆๆญๆพ็ถๆๅฏไปฅๆดพๅPROGRESSไบไปถ
                            if (data.status == AudioStatus.PLAYING) {
                                // ๆไปฌ่งๅฎไฝฟ็จๆฏซ็งๅผไฝไธบๅไฝ
                                var curTime = data.node.currentTime * 1000;
                                var totalTime = data.node.duration * 1000;
                                // ๆดพๅๆญๆพ่ฟๅบฆไบไปถ
                                Core_11.core.dispatch(AudioMessage_1.default.AUDIO_PLAY_PROGRESS, curTime, totalTime);
                            }
                        };
                        // ๅผๅงๆญๆพ
                        data.node.play();
                        // ่ฎพ็ฝฎ็ถๆ
                        data.status = AudioStatus.PLAYING;
                        // ๆดพๅๆญๆพๅผๅงไบไปถ
                        Core_11.core.dispatch(AudioMessage_1.default.AUDIO_PLAY_STARTED, params.url);
                        break;
                }
            }
        };
        AudioTagImpl.prototype._doStop = function (url, time) {
            var toUrl = Environment_2.environment.toCDNHostURL(url);
            var data = this._audioCache[toUrl];
            if (data) {
                data.node.autoplay = false;
                data.node.pause();
                // ่ฎพ็ฝฎๅๆญขๆถ้ด
                if (time != null)
                    data.node.currentTime = time * 0.001;
                // ่ฎพ็ฝฎ็ถๆ
                data.status = AudioStatus.PAUSED;
                // ๆดพๅๆญๆพๅๆญขไบไปถ
                Core_11.core.dispatch(AudioMessage_1.default.AUDIO_PLAY_STOPPED, url);
            }
        };
        /**
         * ๆๅ้ณ้ข๏ผไธไผ้็ฝฎ่ฟๅบฆ๏ผ
         *
         * @param {string} url ้ณ้ขURL
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.pause = function (url) {
            this._doStop(url);
        };
        /**
         * ๅๆญข้ณ้ข๏ผไผ้็ฝฎ่ฟๅบฆ๏ผ
         *
         * @param {string} url ้ณ้ขURL
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.stop = function (url) {
            this._doStop(url, 0);
        };
        /**
         * ๅๆญขๆๆ้ณ้ข
         *
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.stopAll = function () {
            for (var url in this._audioCache) {
                this.stop(url);
            }
        };
        /**
         * ่ทณ่ฝฌ้ณ้ข่ฟๅบฆ
         *
         * @param {string} url ้ณ้ขURL
         * @param {number} time ่ฆ่ทณ่ฝฌๅฐ็้ณ้ขไฝ็ฝฎ๏ผๆฏซ็งๅผ
         * @memberof AudioTagImpl
         */
        AudioTagImpl.prototype.seek = function (url, time) {
            var data = this._audioCache[url];
            if (data)
                data.node.currentTime = time * 0.001;
        };
        return AudioTagImpl;
    }());
    exports.default = AudioTagImpl;
    var AudioStatus;
    (function (AudioStatus) {
        /**
         * ๅ่ฝฝไธญ
         */
        AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
        /**
         * ๅทฒๆๅ
         */
        AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
        /**
         * ๆญๆพไธญ
         */
        AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
    })(AudioStatus || (AudioStatus = {}));
});
define("src/trunk/engine/audio/AudioContextImpl", ["require", "exports", "src/trunk/engine/assets/AssetsManager", "src/trunk/core/Core", "src/trunk/engine/audio/AudioMessage", "src/trunk/engine/env/Environment", "src/trunk/engine/system/System"], function (require, exports, AssetsManager_1, Core_12, AudioMessage_2, Environment_3, System_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-30
     * @modify date 2017-10-30
     *
     * ไฝฟ็จAudioContextๅฎ็ฐIAudioๆฅๅฃ็ๅฎ็ฐ็ฑป
    */
    var AudioContextImpl = /** @class */ (function () {
        function AudioContextImpl() {
            var _this = this;
            this._inited = false;
            this._audioCache = {};
            this._context = new (window["AudioContext"] || window["webkitAudioContext"])();
            var onInit = function () {
                window.removeEventListener("touchstart", onInit);
                window.removeEventListener("mousedown", onInit);
                // ็ๆไธไธช็ฉบ็้ณ้ข๏ผๆญๆพๅนถๅๆญข๏ผ็จไปฅ่งฃ้ค้ๅถ
                var source = _this._context.createBufferSource();
                source.buffer = _this._context.createBuffer(1, 1, 44100);
                source.connect(_this._context.destination);
                source.start();
                source.stop();
                // ่ฎพ็ฝฎๆ่ฏ็ฌฆ
                _this._inited = true;
                // ๅฆๆๅฝๅๆๆญฃๅจๆญๆพ็้ณ้ข๏ผๅจ้จๅๆญๆพไธๆฌก
                for (var url in _this._audioCache) {
                    var data = _this._audioCache[url];
                    if (data.status == AudioStatus.PLAYING) {
                        // ๅๆญขๆญๆพ
                        _this.stop(data.playParams.url);
                        // ้ๆฐๆญๆพ
                        _this.play(data.playParams);
                    }
                }
            };
            window.addEventListener("touchstart", onInit);
            window.addEventListener("mousedown", onInit);
        }
        /**
         * ๅ่ฝฝ้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.load = function (url) {
            var _this = this;
            var toUrl = Environment_3.environment.toCDNHostURL(url);
            // ๅฐ่ฏ่ทๅ็ผๅญๆฐๆฎ
            var data = this._audioCache[toUrl];
            // ๅฆๆๆฒกๆ็ผๅญๆๅปๅ่ฝฝ
            if (!data) {
                // ไฝฟ็จAudioContextๅ่ฝฝ
                this._audioCache[toUrl] = data = { buffer: null, status: AudioStatus.LOADING, playParams: null, progress: null };
                // ๅผๅงๅ่ฝฝ
                AssetsManager_1.assetsManager.loadAssets(toUrl, function (result) {
                    if (result instanceof ArrayBuffer) {
                        _this._context.decodeAudioData(result, function (buffer) {
                            data.buffer = buffer;
                            // ่ฎพ็ฝฎ็ถๆ
                            data.status = AudioStatus.PAUSED;
                            // ๅฆๆ่ชๅจๆญๆพๅๆญๆพ
                            if (data.playParams)
                                _this.play(data.playParams);
                        });
                    }
                }, "arraybuffer");
            }
        };
        /**
         * ๆญๆพ้ณ้ข๏ผๅฆๆ้ณ้ขๆฒกๆๅ่ฝฝๅๅๅ่ฝฝๅๆญๆพ
         *
         * @param {AudioPlayParams} params ้ณ้ขๆญๆพๅๆฐ
         * @returns {void}
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.play = function (params) {
            var _this = this;
            var toUrl = Environment_3.environment.toCDNHostURL(params.url);
            // ๅฐ่ฏ่ทๅ็ผๅญๆฐๆฎ
            var data = this._audioCache[toUrl];
            if (!data) {
                // ๆฒกๆๅ่ฝฝ่ฟ๏ผๅผๅงๅ่ฝฝ้ณ้ข
                this.load(params.url);
                // ่ฎพ็ฝฎๆญๆพๅๆฐ
                this._audioCache[toUrl].playParams = params;
            }
            else {
                switch (data.status) {
                    case AudioStatus.LOADING:
                        // ๆญฃๅจๅ่ฝฝไธญ๏ผๆฟๆข่ชๅจๆญๆพๅๆฐ
                        data.playParams = params;
                        break;
                    case AudioStatus.PLAYING:
                        // ๆญฃๅจๆญๆพ๏ผๅณ้ญๅๅๆญๆพ
                        this.stop(params.url);
                        this.play(params);
                        break;
                    case AudioStatus.PAUSED:
                        // ่ฎพ็ฝฎ็ถๆ
                        data.status = AudioStatus.PLAYING;
                        // ๅทฒ็ปๅ่ฝฝๅฎๆฏ๏ผ็ดๆฅๆญๆพ
                        if (this._inited) {
                            data.node = this._context.createBufferSource();
                            data.node.buffer = data.buffer;
                            if (params.loop != null)
                                data.node.loop = params.loop;
                            data.node.connect(this._context.destination);
                            // ็ๅฌๆญๆพๅฎๆฏ
                            data.node.onended = function () {
                                var data = _this._audioCache[toUrl];
                                if (data) {
                                    // ๅๆญขๆญๆพ
                                    _this.stop(params.url);
                                    // ๆดพๅๆญๆพๅฎๆฏไบไปถ
                                    Core_12.core.dispatch(AudioMessage_2.default.AUDIO_PLAY_ENDED, params.url);
                                }
                            };
                            // ๅผๅงๆญๆพ๏ผไผๅๅๅๆฐไธญ็ๆถ้ด๏ผๆฒกๆๅฐฑๅ้ป่ฎคๅผๅงๆถ้ด
                            var playTime;
                            if (params && params.time != null)
                                playTime = params.time * 0.001;
                            else
                                playTime = data.playTime;
                            delete data.playTime;
                            data.node.start(playTime);
                            // ๅผๅงๆญๆพ่ฟๅบฆ็ๆต
                            var lastTime = this._context.currentTime;
                            var curTime = playTime || 0;
                            data.progress = System_1.system.enterFrame(function () {
                                var nowTime = _this._context.currentTime;
                                var deltaTime = nowTime - lastTime;
                                lastTime = nowTime;
                                if (data.status == AudioStatus.PLAYING) {
                                    curTime += deltaTime * 1000;
                                    var totalTime = data.node.buffer.duration * 1000;
                                    Core_12.core.dispatch(AudioMessage_2.default.AUDIO_PLAY_PROGRESS, curTime, totalTime);
                                }
                            });
                            // ๆดพๅๆญๆพๅผๅงไบไปถ
                            Core_12.core.dispatch(AudioMessage_2.default.AUDIO_PLAY_STARTED, params.url);
                        }
                        break;
                }
            }
        };
        AudioContextImpl.prototype._doStop = function (url, time) {
            var toUrl = Environment_3.environment.toCDNHostURL(url);
            var data = this._audioCache[toUrl];
            if (data) {
                // ่ฎพ็ฝฎ็ถๆ
                data.status = AudioStatus.PAUSED;
                // ๅๆถ่ฟๅบฆ็ๆต
                if (data.progress)
                    data.progress.cancel();
                // ็ปๆๆญๆพ
                if (data.node) {
                    data.node.stop(time);
                    // ๆดพๅๆญๆพๅๆญขไบไปถ
                    Core_12.core.dispatch(AudioMessage_2.default.AUDIO_PLAY_STOPPED, url);
                }
            }
        };
        /**
         * ๆๅ้ณ้ข๏ผไธไผ้็ฝฎ่ฟๅบฆ๏ผ
         *
         * @param {string} url ้ณ้ขURL
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.pause = function (url) {
            this._doStop(url);
        };
        /**
         * ๅๆญข้ณ้ข๏ผไผ้็ฝฎ่ฟๅบฆ๏ผ
         *
         * @param {string} url ้ณ้ขURL
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.stop = function (url) {
            this._doStop(url, 0);
        };
        /**
         * ๅๆญขๆๆ้ณ้ข
         *
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.stopAll = function () {
            for (var url in this._audioCache) {
                this.stop(url);
            }
        };
        /**
         * ่ทณ่ฝฌ้ณ้ข่ฟๅบฆ
         *
         * @param {string} url ้ณ้ขURL
         * @param {number} time ่ฆ่ทณ่ฝฌๅฐ็้ณ้ขไฝ็ฝฎ๏ผๆฏซ็งๅผ
         * @memberof AudioContextImpl
         */
        AudioContextImpl.prototype.seek = function (url, time) {
            var toUrl = Environment_3.environment.toCDNHostURL(url);
            var data = this._audioCache[toUrl];
            if (data) {
                var params = data.playParams;
                if (data.status == AudioStatus.PLAYING) {
                    // ๅๆญข้ๆฐๆญๆพ
                    this.stop(url);
                    params.time = time;
                    this.play(params);
                }
                else {
                    data.playTime = time;
                }
            }
        };
        return AudioContextImpl;
    }());
    exports.default = AudioContextImpl;
    var AudioStatus;
    (function (AudioStatus) {
        /**
         * ๅ่ฝฝไธญ
         */
        AudioStatus[AudioStatus["LOADING"] = 0] = "LOADING";
        /**
         * ๅทฒๆๅ
         */
        AudioStatus[AudioStatus["PAUSED"] = 1] = "PAUSED";
        /**
         * ๆญๆพไธญ
         */
        AudioStatus[AudioStatus["PLAYING"] = 2] = "PLAYING";
    })(AudioStatus || (AudioStatus = {}));
});
define("src/trunk/engine/audio/AudioManager", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/Core", "src/trunk/engine/audio/AudioTagImpl", "src/trunk/engine/audio/AudioContextImpl"], function (require, exports, Injector_9, Core_13, AudioTagImpl_1, AudioContextImpl_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-30
     * @modify date 2017-10-30
     *
     * ้ณ้ข็ฎก็ๅจ๏ผ้ณ้ขๆฅๅฃ่ขซๅผบ่กๅไธบไธค้จๅ๏ผSoundๅMusicใ
     * Sound๏ผไฝฟ็จAudioๆ็ญพๆญๆพ๏ผๅฏไปฅ่ทจๅๆญๆพไฝๅฏ่ฝไผ่ขซๆไบๆต่งๅจ้ๅถ๏ผๅฟ้กปๅจ็นๅปไบไปถๅค็ๅฝๆฐไธญๆญๆพ
     * Music๏ผไฝฟ็จAudioContextๆญๆพ๏ผๅฏไปฅไธๅฎ็จๅบฆไธ่ถ่ฟ็นๅปไบไปถๆฃๆฅ๏ผไฝๆๆณ่ทจๅๆญๆพ๏ผ้ๅๆญๆพ่ๆฏ้ณไน
    */
    var AudioManager = /** @class */ (function () {
        function AudioManager() {
            this._soundImpl = new AudioTagImpl_1.default();
            this._musicImpl = new AudioContextImpl_1.default();
        }
        /**
         * ๆณจๅSound้ณ้ขๅฎ็ฐๅฏน่ฑก
         *
         * @param {IAudio} soundImpl Sound้ณ้ขๅฎ็ฐๅฏน่ฑก
         * @memberof AudioManager
         */
        AudioManager.prototype.registerSoundImpl = function (soundImpl) {
            this._soundImpl = soundImpl;
        };
        /**
         * ๅ่ฝฝSound้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.loadSound = function (url) {
            this._soundImpl.load(url);
        };
        /**
         * ๆญๆพSound้ณ้ข๏ผๅฆๆๆฒกๆๅ่ฝฝๅไผๅ่กๅ่ฝฝ
         *
         * @param {AudioPlayParams} params ้ณ้ขๆญๆพๅๆฐ
         * @memberof AudioManager
         */
        AudioManager.prototype.playSound = function (params) {
            // ๅๆญขๅถไป้ณ้ข
            if (params.stopOthers) {
                this.stopAllSound();
                this.stopAllMusics();
            }
            this._soundImpl.play(params);
        };
        /**
         * ่ทณ่ฝฌSound้ณ้ข่ฟๅบฆ
         *
         * @param {string} url ้ณ้ขURL
         * @param {number} time ่ฆ่ทณ่ฝฌๅฐ็้ณ้ขไฝ็ฝฎ๏ผๆฏซ็งๅผ
         * @memberof AudioManager
         */
        AudioManager.prototype.seekSound = function (url, time) {
            this._soundImpl.seek(url, time);
        };
        /**
         * ๅๆญขSound้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.stopSound = function (url) {
            this._soundImpl.stop(url);
        };
        /**
         * ๆๅSound้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.pauseSound = function (url) {
            this._soundImpl.pause(url);
        };
        /**
         * ๅๆญขๆๆSound้ณ้ข
         *
         * @memberof AudioManager
         */
        AudioManager.prototype.stopAllSound = function () {
            this._soundImpl.stopAll();
        };
        /**
         * ๆณจๅMusic้ณ้ขๅฎ็ฐๅฏน่ฑก
         *
         * @param {IAudio} musicImpl Music้ณ้ขๅฎ็ฐๅฏน่ฑก
         * @memberof AudioManager
         */
        AudioManager.prototype.registerMusicImpl = function (musicImpl) {
            this._musicImpl = musicImpl;
        };
        /**
         * ๅ่ฝฝMusic้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.loadMusic = function (url) {
            this._musicImpl.load(url);
        };
        /**
         * ๆญๆพMusic้ณ้ข๏ผๅฆๆๆฒกๆๅ่ฝฝๅไผๅ่กๅ่ฝฝ
         *
         * @param {AudioPlayParams} [params] ้ณ้ขๅๆฐ
         * @memberof AudioManager
         */
        AudioManager.prototype.playMusic = function (params) {
            // ๅๆญขๅถไป้ณ้ข
            if (params.stopOthers) {
                this.stopAllSound();
                this.stopAllMusics();
            }
            this._musicImpl.play(params);
        };
        /**
         * ่ทณ่ฝฌMusic้ณ้ข่ฟๅบฆ
         *
         * @param {string} url ้ณ้ขURL
         * @param {number} time ่ฆ่ทณ่ฝฌๅฐ็้ณ้ขไฝ็ฝฎ๏ผๆฏซ็งๅผ
         * @memberof AudioManager
         */
        AudioManager.prototype.seekMusic = function (url, time) {
            this._musicImpl.seek(url, time);
        };
        /**
         * ๅๆญขMusic้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.stopMusic = function (url) {
            this._musicImpl.stop(url);
        };
        /**
         * ๆๅMusic้ณ้ข
         *
         * @param {string} url ้ณ้ขๅฐๅ
         * @memberof AudioManager
         */
        AudioManager.prototype.pauseMusic = function (url) {
            this._musicImpl.pause(url);
        };
        /**
         * ๅๆญขๆๆMusic้ณ้ข
         *
         * @memberof AudioManager
         */
        AudioManager.prototype.stopAllMusics = function () {
            this._musicImpl.stopAll();
        };
        AudioManager = __decorate([
            Injector_9.Injectable
        ], AudioManager);
        return AudioManager;
    }());
    exports.default = AudioManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.audioManager = Core_13.core.getInject(AudioManager);
});
define("src/trunk/engine/module/ModuleManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/net/NetManager", "src/trunk/engine/module/ModuleMessage", "src/trunk/engine/env/Environment", "src/trunk/engine/mask/MaskManager", "src/trunk/engine/assets/AssetsManager", "src/trunk/engine/audio/AudioManager", "src/trunk/engine/version/Version"], function (require, exports, Core_14, Injector_10, NetManager_1, ModuleMessage_1, Environment_4, MaskManager_3, AssetsManager_2, AudioManager_1, Version_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-14
     * @modify date 2017-09-15
     *
     * ๆจกๅ็ฎก็ๅจ๏ผ็ฎก็ๆจกๅ็ธๅณ็ๆๆๆไฝใๆจกๅๅทๆๅฏไธๆง๏ผๅไธๆถ้ดไธๅฏไปฅๆๅผไธคไธช็ธๅๆจกๅ๏ผๅฆๆๆๅผๅไผ้ๅๅฐๅๅ็ๆจกๅๅค
    */
    var ModuleManager = /** @class */ (function () {
        function ModuleManager() {
            this._moduleDict = {};
            this._moduleStack = [];
            this._openCache = [];
            this._opening = false;
        }
        Object.defineProperty(ModuleManager.prototype, "opening", {
            /**
             * ่ทๅๆฏๅฆๆๆจกๅๆญฃๅจๆๅผไธญ
             *
             * @readonly
             * @type {boolean}
             * @memberof ModuleManager
             */
            get: function () {
                return this._opening;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ModuleManager.prototype, "currentModule", {
            /**
             * ่ทๅๅฝๅๆจกๅ
             *
             * @readonly
             * @type {IModuleConstructor|undefined}
             * @memberof ModuleManager
             */
            get: function () {
                var curData = this.getCurrent();
                return (curData && curData[0]);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ModuleManager.prototype, "currentModuleInstance", {
            /**
             * ่ทๅๅฝๅๆจกๅ็ๅฎไพ
             *
             * @readonly
             * @type {(IModule|undefined)}
             * @memberof ModuleManager
             */
            get: function () {
                var curData = this.getCurrent();
                return (curData && curData[1]);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(ModuleManager.prototype, "activeCount", {
            /**
             * ่ทๅๆดปๅจๆจกๅๆฐ้
             *
             * @readonly
             * @type {number}
             * @memberof ModuleManager
             */
            get: function () {
                return this._moduleStack.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅๆจกๅๅจๆไธญ็็ดขๅผ
         *
         * @param {IModuleConstructor} cls ๆจกๅ็ฑปๅ
         * @returns {number} ็ดขๅผๅผ
         * @memberof ModuleManager
         */
        ModuleManager.prototype.getIndex = function (cls) {
            for (var i = 0, len = this._moduleStack.length; i < len; i++) {
                if (this._moduleStack[i][0] == cls)
                    return i;
            }
            return -1;
        };
        /**
         * ่ทๅ็ดขๅผๅคๆจกๅ็ฑปๅ
         *
         * @param {number} index ๆจกๅ็ดขๅผๅผ
         * @returns {IModuleConstructor} ๆจกๅ็ฑปๅ
         * @memberof ModuleManager
         */
        ModuleManager.prototype.getModule = function (index) {
            var data = this._moduleStack[index];
            return data && data[0];
        };
        ModuleManager.prototype.getAfter = function (cls) {
            var result = [];
            for (var _i = 0, _a = this._moduleStack; _i < _a.length; _i++) {
                var module = _a[_i];
                if (module[0] == cls)
                    return result;
                result.push(module);
            }
            return null;
        };
        ModuleManager.prototype.getCurrent = function () {
            return this._moduleStack[0];
        };
        ModuleManager.prototype.registerModule = function (cls) {
            this._moduleDict[cls["name"]] = cls;
        };
        /**
         * ่ทๅๆจกๅๆฏๅฆๅผๅฏไธญ
         *
         * @param {IModuleConstructor} cls ่ฆๅคๆญ็ๆจกๅ็ฑปๅ
         * @returns {boolean} ๆฏๅฆๅผๅฏ
         * @memberof ModuleManager
         */
        ModuleManager.prototype.isOpened = function (cls) {
            return (this._moduleStack.filter(function (temp) { return temp[0] == cls; }).length > 0);
        };
        ModuleManager.prototype.activateModule = function (module, from, data) {
            if (module) {
                // ่ฐ็จonActivateๆฅๅฃ
                module.onActivate(from, data);
                // ๆญๆพ่ๆฏ้ณไน
                var bgMusic = module.bgMusic;
                if (bgMusic) {
                    // ไฝฟ็จMusic้ณ้ขๆญๆพ
                    AudioManager_1.audioManager.playMusic({ url: bgMusic, loop: true, stopOthers: true });
                }
            }
        };
        ModuleManager.prototype.deactivateModule = function (module, to, data) {
            if (module) {
                // ่ฐ็จonDeactivateๆฅๅฃ
                module.onDeactivate(to, data);
            }
        };
        /**
         * ๆๅผๆจกๅ
         *
         * @param {IModuleConstructor|string} clsOrName ๆจกๅ็ฑปๅๆๅ็งฐ
         * @param {*} [data] ๅๆฐ
         * @param {boolean} [replace=false] ๆฏๅฆๆฟๆขๅฝๅๆจกๅ
         * @memberof ModuleManager
         */
        ModuleManager.prototype.open = function (clsOrName, data, replace) {
            var _this = this;
            if (replace === void 0) { replace = false; }
            // ๅฆๆๆฏๅญ็ฌฆไธฒๅ่ทๅๅผ็จ
            var cls = (typeof clsOrName == "string" ? this._moduleDict[clsOrName] : clsOrName);
            // ้็ฉบๅคๆญ
            if (!cls)
                return;
            // ๅคๆญๆฏๅฆๆญฃๅจๆๅผๆจกๅ
            if (this._opening) {
                this._openCache.push([cls, data, replace]);
                return;
            }
            this._opening = true;
            var after = this.getAfter(cls);
            if (!after) {
                // ๅฐๆชๆๅผ่ฟ๏ผๆญฃๅธธๅผๅฏๆจกๅ
                var target = new cls();
                // ่ตๅผๆๅผๅๆฐ
                target.data = data;
                // ็ๅฌ้่ฎฏๆถๆฏ
                NetManager_1.netManager.listenRequest(target.observable);
                // ๆฐๆฎๅ่ก
                this._moduleStack.unshift([cls, target]);
                // ่ฎฐไธไธชๆฏๅฆ้่ฆ้ฎ็ฝฉ็flag
                var maskFlag = true;
                // ๅ่ฝฝๆๆๅทฒๆ็ฎกไธญไป่็่ตๆบ
                var mediators = target.delegatedMediators.concat();
                var loadMediatorAssets = function (err) {
                    if (err) {
                        // ้่Loading
                        if (!maskFlag)
                            MaskManager_3.maskManager.hideLoading("module");
                        maskFlag = false;
                        // ๅๆญขๅ่ฝฝ๏ผ่ฐ็จๆจกๅๅ่ฝฝๅคฑ่ดฅๆฅๅฃ
                        target.onLoadAssets(err);
                    }
                    else if (mediators.length > 0) {
                        var mediator = mediators.shift();
                        mediator.loadAssets(loadMediatorAssets);
                    }
                    else {
                        // ้่Loading
                        if (!maskFlag)
                            MaskManager_3.maskManager.hideLoading("module");
                        maskFlag = false;
                        // ่ฐ็จonLoadAssetsๆฅๅฃ
                        target.onLoadAssets();
                        // ๅผๅงๅ่ฝฝcssๆไปถ๏ผcssๆไปถๅฟ้กป็จlinkๆ็ญพไปCDNๅ่ฝฝ๏ผๅไธบๅพ็้่ฆไปCDNๅ่ฝฝ
                        var cssFiles = target.listStyleFiles();
                        if (cssFiles) {
                            for (var _i = 0, cssFiles_1 = cssFiles; _i < cssFiles_1.length; _i++) {
                                var cssFile = cssFiles_1[_i];
                                var cssNode = document.createElement("link");
                                cssNode.rel = "stylesheet";
                                cssNode.type = "text/css";
                                cssNode.href = Environment_4.environment.toCDNHostURL(Version_2.version.wrapHashUrl(cssFile));
                                document.body.appendChild(cssNode);
                            }
                        }
                        // ๅผๅงๅ่ฝฝjsๆไปถ๏ผ่ฟ้jsๆไปถไฝฟ็จๅตๅฅhtml็ๆนๅผ๏ผไปฅไธบ่ฟๆทjsไธไผ่ทจๅ๏ผๆฅ้ไฟกๆฏๅฏไปฅๆถ้ๅฐ
                        AssetsManager_2.assetsManager.loadAssets(target.listJsFiles(), function (results) {
                            if (results instanceof Error) {
                                target.onLoadAssets(results);
                                return;
                            }
                            if (results) {
                                // ไฝฟ็จscriptๆ็ญพๅฐjsๆไปถๅๅฅhtmlไธญ
                                var jsNode = document.createElement("script");
                                jsNode.innerHTML = results.join("\n");
                                document.body.appendChild(jsNode);
                            }
                            // ๅ้ๆๆๆจกๅๆถๆฏ๏ผๆจกๅๆถๆฏ้ป่ฎคๅ้ๅจๅฑๅๆธ
                            var requests = target.listInitRequests();
                            NetManager_1.netManager.sendMultiRequests(requests, function (responses) {
                                var from = this.getCurrent();
                                var fromModule = from && from[1];
                                // ่ตๅผresponses
                                target.responses = responses;
                                // ่ฐ็จonOpenๆฅๅฃ
                                target.onOpen(data);
                                // ่ฐ็จonDeactivateๆฅๅฃ
                                this.deactivateModule(fromModule && fromModule, cls, data);
                                // ่ฐ็จonActivateๆฅๅฃ
                                this.activateModule(target, from && from[0], data);
                                // ๅฆๆreplaceๆฏtrue๏ผๅๅณๆไธไธไธชๆจกๅ
                                if (replace)
                                    this.close(from && from[0], data);
                                // ๆดพๅๆถๆฏ
                                Core_14.core.dispatch(ModuleMessage_1.default.MODULE_CHANGE, cls, from && from[0]);
                                // ๅณ้ญๆ่ฏ็ฌฆ
                                this._opening = false;
                                // ๅฆๆๆ็ผๅญ็ๆจกๅ้่ฆๆๅผๅๆๅผไน
                                if (this._openCache.length > 0)
                                    this.open.apply(this, this._openCache.shift());
                            }, _this);
                        });
                    }
                };
                loadMediatorAssets();
                // ๆพ็คบLoading
                if (maskFlag) {
                    MaskManager_3.maskManager.showLoading(null, "module");
                    maskFlag = false;
                }
            }
            else if (after.length > 0) {
                // ๅทฒ็ปๆๅผไธไธๆฏๅฝๅๆจกๅ๏ผๅๅณ้ญๅฝๅๆจกๅๅฐ็ฎๆๆจกๅไน้ด็ๆๆๆจกๅ
                for (var i = 1, len = after.length; i < len; i++) {
                    this.close(after[i][0], data);
                }
                // ๆๅๅณ้ญๅฝๅๆจกๅ๏ผไปฅๅฎ็ฐไปๅฝๅๆจกๅ็ดๆฅ่ทณๅๅฐ็ฎๆๆจกๅ
                this.close(after[0][0], data);
                // ๅณ้ญๆ่ฏ็ฌฆ
                this._opening = false;
            }
            else {
                // ๅณ้ญๆ่ฏ็ฌฆ
                this._opening = false;
            }
        };
        /**
         * ๅณ้ญๆจกๅ๏ผๅชๆๅณ้ญ็ๆฏๅฝๅๆจกๅๆถๆไผ่งฆๅonDeactivateๅonActivate๏ผๅฆๅๅชไผ่งฆๅonClose
         *
         * @param {IModuleConstructor|string} clsOrName ๆจกๅ็ฑปๅๆๅ็งฐ
         * @param {*} [data] ๅๆฐ
         * @memberof ModuleManager
         */
        ModuleManager.prototype.close = function (clsOrName, data) {
            // ๅฆๆๆฏๅญ็ฌฆไธฒๅ่ทๅๅผ็จ
            var cls = (typeof clsOrName == "string" ? this._moduleDict[clsOrName] : clsOrName);
            // ้็ฉบๅคๆญ
            if (!cls)
                return;
            // ๆฐ้ๅคๆญ๏ผไธ่ถณไธไธชๆจกๅๆถไธๅณ้ญ
            if (this.activeCount <= 1)
                return;
            // ๅญๅจๆงๅคๆญ
            var index = this.getIndex(cls);
            if (index < 0)
                return;
            // ๅๅฐ็ฎๆๆจกๅ
            var target = this._moduleStack[index][1];
            // ๅฆๆๆฏๅฝๅๆจกๅ๏ผๅ้่ฆ่ฐ็จonDeactivateๅonActivateๆฅๅฃ๏ผๅฆๅไธ็จ
            if (index == 0) {
                // ๆฐๆฎๅ่ก
                this._moduleStack.shift();
                // ่ทๅๅไธไธชๆจกๅ
                var to = this._moduleStack[0];
                var toModule = to && to[1];
                // ่ฐ็จonDeactivateๆฅๅฃ
                this.deactivateModule(target, to && to[0], data);
                // ่ฐ็จonCloseๆฅๅฃ
                target.onClose(data);
                // ่ฐ็จonActivateๆฅๅฃ
                this.activateModule(toModule && toModule, cls, data);
                // ๆดพๅๆถๆฏ
                Core_14.core.dispatch(ModuleMessage_1.default.MODULE_CHANGE, to && to[0], cls);
            }
            else {
                // ๆฐๆฎๅ่ก
                this._moduleStack.splice(index, 1);
                // ่ฐ็จonCloseๆฅๅฃ
                target.onClose(data);
            }
        };
        ModuleManager = __decorate([
            Injector_10.Injectable
        ], ModuleManager);
        return ModuleManager;
    }());
    exports.default = ModuleManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.moduleManager = Core_14.core.getInject(ModuleManager);
});
define("src/trunk/engine/bridge/BridgeManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/bridge/BridgeMessage", "src/trunk/engine/panel/PanelManager", "src/trunk/engine/module/ModuleManager", "src/trunk/engine/mask/MaskManager"], function (require, exports, Core_15, Injector_11, BridgeMessage_1, PanelManager_1, ModuleManager_1, MaskManager_4) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ็จๆฅ็ฎก็ๆๆ่กจ็ฐๅฑๅฏน่ฑก
    */
    var BridgeManager = /** @class */ (function () {
        function BridgeManager() {
            this._bridgeDict = {};
            this._bridgeList = [];
        }
        Object.defineProperty(BridgeManager.prototype, "currentBridge", {
            /**
             * ่ทๅๅฝๅ็่กจ็ฐๅฑๆกฅๅฎไพ๏ผ่งๅๆฏๅๅฝๅๆจกๅ็็ฌฌไธไธชๆฅๆbridgeๅฑๆง็Mediator็bridge๏ผ
             *
             * @readonly
             * @type {IBridge}
             * @memberof BridgeManager
             */
            get: function () {
                // ๅ็จๅฝๅๆจกๅ็้ฆไธชๆฅๆbridge็Mediator็bridge
                var curModule = ModuleManager_1.moduleManager.currentModuleInstance;
                if (curModule) {
                    var bridge;
                    var mediators = curModule.delegatedMediators;
                    for (var _i = 0, mediators_1 = mediators; _i < mediators_1.length; _i++) {
                        var mediator = mediators_1[_i];
                        if (mediator.bridge)
                            return mediator.bridge;
                    }
                }
                // ๆฒกๆพๅฐ๏ผๅ็จ็ฌฌไธไธชๆกฅไปฃๆฟ
                return (this._bridgeList[0] && this._bridgeList[0][0]);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅ่กจ็ฐๅฑๆกฅๅฎไพ
         *
         * @param {string} type ่กจ็ฐๅฑ็ฑปๅ
         * @returns {IBridge} ่กจ็ฐๅฑๆกฅๅฎไพ
         * @memberof BridgeManager
         */
        BridgeManager.prototype.getBridge = function (type) {
            var data = this._bridgeDict[type];
            return (data && data[0]);
        };
        /**
         * ้่ฟ็ปๅบไธไธชๆพ็คบๅฏน่ฑก็ฎ่คๅฎไพๆฅ่ทๅๅ้็่กจ็ฐๅฑๆกฅๅฎไพ
         *
         * @param {*} skin ็ฎ่คๅฎไพ
         * @returns {IBridge|null} ็ฎ่คๆๅฑ่กจ็ฐๅฑๆกฅๅฎไพ
         * @memberof BridgeManager
         */
        BridgeManager.prototype.getBridgeBySkin = function (skin) {
            if (skin) {
                // ้ๅๆๆๅทฒๆณจๅ็่กจ็ฐๅฑๆกฅ่ฟ่กๅคๆญ
                for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
                    var data = _a[_i];
                    var bridge = data[0];
                    if (bridge.isMySkin(skin))
                        return bridge;
                }
            }
            return null;
        };
        /**
         * ๆณจๅไธไธช่กจ็ฐๅฑๆกฅๅฎไพๅฐๆกๆถไธญ
         *
         * @param {...IBridge[]} bridges ่ฆๆณจๅ็ๆๆ่กจ็ฐๅฑๆกฅ
         * @memberof BridgeManager
         */
        BridgeManager.prototype.registerBridge = function () {
            var _this = this;
            var bridges = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                bridges[_i] = arguments[_i];
            }
            // ่ฟ่กDOMๅๅงๅๅคๆญ
            if (!document.body) {
                var onLoad = function (evt) {
                    window.removeEventListener("load", onLoad);
                    // ้ๆฐ่ฐ็จๆณจๅๆนๆณ
                    _this.registerBridge.apply(_this, bridges);
                };
                window.addEventListener("load", onLoad);
                return;
            }
            // ่ฟ่กๅๅงๅ
            if (bridges.length > 0) {
                var self = this;
                // ่ฎฐๅฝ
                for (var _a = 0, bridges_1 = bridges; _a < bridges_1.length; _a++) {
                    var bridge = bridges_1[_a];
                    var type = bridge.type;
                    if (!this._bridgeDict[type]) {
                        var data = [bridge, false];
                        this._bridgeDict[type] = data;
                        this._bridgeList.push(data);
                    }
                }
                // ๅผๅงๅๅงๅ
                for (var _b = 0, bridges_2 = bridges; _b < bridges_2.length; _b++) {
                    var bridge = bridges_2[_b];
                    // ๆดพๅๆถๆฏ
                    Core_15.core.dispatch(BridgeMessage_1.default.BRIDGE_BEFORE_INIT, bridge);
                    // ๅๅงๅMask
                    MaskManager_4.maskManager.registerMask(bridge.type, bridge.maskEntity);
                    // ๆณจๅ้็จๆ็คบๆก
                    PanelManager_1.panelManager.registerPrompt(bridge.type, bridge.promptClass);
                    // ๅๅงๅ่ฏฅ่กจ็ฐๅฑๅฎไพ
                    if (bridge.init)
                        bridge.init(afterInitBridge);
                    else
                        afterInitBridge(bridge);
                }
            }
            else {
                this.testAllInit();
            }
            function afterInitBridge(bridge) {
                // ๅ้่่กจ็ฐๅฑๆกฅ็htmlWrapper
                bridge.htmlWrapper.style.display = "none";
                // ๆดพๅๆถๆฏ
                Core_15.core.dispatch(BridgeMessage_1.default.BRIDGE_AFTER_INIT, bridge);
                // ่ฎพ็ฝฎๅๅงๅๅฎๆฏๅฑๆง
                var data = self._bridgeDict[bridge.type];
                data[1] = true;
                // ๆต่ฏๆฏๅฆๅจ้จๅๅงๅๅฎๆฏ
                self.testAllInit();
            }
        };
        BridgeManager.prototype.testAllInit = function () {
            var allInited = true;
            for (var _i = 0, _a = this._bridgeList; _i < _a.length; _i++) {
                var data = _a[_i];
                allInited = allInited && data[1];
            }
            if (allInited)
                Core_15.core.dispatch(BridgeMessage_1.default.BRIDGE_ALL_INIT);
        };
        BridgeManager = __decorate([
            Injector_11.Injectable
        ], BridgeManager);
        return BridgeManager;
    }());
    exports.default = BridgeManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.bridgeManager = Core_15.core.getInject(BridgeManager);
});
define("src/trunk/engine/platform/IPlatform", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/platform/WebPlatform", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ็ฝ้กตๅนณๅฐๆฅๅฃๅฎ็ฐ็ฑป๏ผไนๆฏๅนณๅฐๆฅๅฃ็้ป่ฎค็ฑป
    */
    var WebPlatform = /** @class */ (function () {
        function WebPlatform() {
        }
        WebPlatform.prototype.reload = function () {
            window.location.reload(true);
        };
        return WebPlatform;
    }());
    exports.default = WebPlatform;
});
define("src/trunk/engine/platform/PlatformManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/platform/WebPlatform"], function (require, exports, Core_16, Injector_12, WebPlatform_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ๅนณๅฐๆฅๅฃ็ฎก็ๅจ๏ผ้่ฟๆกฅๆฅๆจกๅผ็ปไธไธๅๅนณๅฐ็ไธๅๆฅๅฃ๏ผไป่ๅฎ็ฐๅฏนๆกๆถๅถไปๆจกๅ้ๆๅ
    */
    var PlatformManager = /** @class */ (function () {
        function PlatformManager() {
            /**
             * ๅนณๅฐๆฅๅฃๅฎ็ฐๅฏน่ฑก๏ผ้ป่ฎคๆฏๆฎ้็ฝ้กตๅนณๅฐ๏ผไนๅฏไปฅๆนๆฎ้่ฆๅฎๅถ
             *
             * @type {IPlatform}
             * @memberof PlatformManager
             */
            this.platform = new WebPlatform_1.default();
        }
        /**
         * ๅทๆฐๅฝๅ้กต้ข
         *
         * @memberof PlatformManager
         */
        PlatformManager.prototype.reload = function () {
            this.platform.reload();
        };
        PlatformManager = __decorate([
            Injector_12.Injectable
        ], PlatformManager);
        return PlatformManager;
    }());
    exports.default = PlatformManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.platformManager = Core_16.core.getInject(PlatformManager);
});
define("src/trunk/engine/model/Model", ["require", "exports", "src/trunk/core/Core"], function (require, exports, Core_17) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-14
     * @modify date 2017-09-14
     *
     * Model็ๅบ็ฑป๏ผไนๅฏไปฅไธ็ปงๆฟ่ฏฅๅบ็ฑป๏ผๅไธบModelๆฏๅพ้ๆ็ไธ่ฅฟ
    */
    var Model = /** @class */ (function () {
        function Model() {
        }
        Model.prototype.dispatch = function () {
            var params = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                params[_i] = arguments[_i];
            }
            Core_17.core.dispatch.apply(Core_17.core, params);
        };
        /**
         * ็ๅฌๅๆธๆถๆฏ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Model
         */
        Model.prototype.listen = function (type, handler, thisArg) {
            Core_17.core.listen(type, handler, thisArg);
        };
        /**
         * ็งป้คๅๆธๆถๆฏ็ๅฌ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof Model
         */
        Model.prototype.unlisten = function (type, handler, thisArg) {
            Core_17.core.unlisten(type, handler, thisArg);
        };
        /**
         * ๆณจๅๅฝไปคๅฐ็นๅฎๆถๆฏ็ฑปๅไธ๏ผๅฝ่ฟไธช็ฑปๅ็ๆถๆฏๆดพๅๅฐๆกๆถๅๆธๆถไผ่งฆๅCommand่ฟ่ก
         *
         * @param {string} type ่ฆๆณจๅ็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ๏ผๅฏไปฅๆฏๆนๆณๅฝขๅผ๏ผไนๅฏไปฅไฝฟ็ฑปๅฝขๅผ
         * @memberof Model
         */
        Model.prototype.mapCommand = function (type, cmd) {
            Core_17.core.mapCommand(type, cmd);
        };
        /**
         * ๆณจ้ๅฝไปค
         *
         * @param {string} type ่ฆๆณจ้็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ
         * @returns {void}
         * @memberof Model
         */
        Model.prototype.unmapCommand = function (type, cmd) {
            Core_17.core.unmapCommand(type, cmd);
        };
        return Model;
    }());
    exports.default = Model;
});
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-11-06
 * @modify date 2017-11-06
 *
 * ็ปๅฎๅทฅๅท็ฑป
*/
define("src/trunk/engine/bind/Utils", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    function wrapEvalFuncExp(exp, scopeCount) {
        var argList = [];
        var expStr = exp;
        for (var i = 0; i < scopeCount; i++) {
            argList.push("s" + i);
            expStr = "with(s" + i + "||{}){" + expStr + "}";
        }
        return Function(argList.join(","), expStr);
    }
    /**
     * ๅๅปบไธไธชๆง่กๆนๆณ๏ผ็จไบๆชๆฅๆง่ก
     *
     * @export
     * @param {string} exp ่กจ่พพๅผ
     * @param {number} [scopeCount=0] ๆ้็ๅ็ๆฐ้
     * @returns {(...scopes:any[])=>void} ๅๅปบ็ๆนๆณ
     */
    function createRunFunc(exp, scopeCount) {
        if (scopeCount === void 0) { scopeCount = 0; }
        var func;
        try {
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        catch (err) {
            // ๅฏ่ฝๆฏๆไบ็ๆฌ็่งฃ้ๅจไธ่ฎค่ฏๆจกๆฟๅญ็ฌฆไธฒ๏ผๅฐๆจกๆฟๅญ็ฌฆไธฒๅๆๆฎ้ๅญ็ฌฆไธฒ
            var sepStr = (exp.indexOf('"') < 0 ? '"' : "'");
            // ๅฐexpไธญ็ยทๆฟๆขไธบ'
            var reg = /([^\\]?)`/g;
            exp = exp.replace(reg, "$1" + sepStr);
            // ๅฐexpไธญ${...}ๆฟๆขไธบ" + ... + "็ๅฝขๅผ
            reg = /\$\{(.*?)\}/g;
            exp = exp.replace(reg, sepStr + "+($1)+" + sepStr);
            // ้ๆฐ็ๆๆนๆณๅนถ่ฟๅ
            func = wrapEvalFuncExp(exp, scopeCount);
        }
        return func;
    }
    exports.createRunFunc = createRunFunc;
    /**
     * ็ดๆฅๆง่ก่กจ่พพๅผ๏ผไธๆฑๅผใ่ฏฅๆนๆณๅฏไปฅๆง่กๅคๆก่ฏญๅฅ
     *
     * @export
     * @param {string} exp ่กจ่พพๅผ
     * @param {*} [thisArg] thisๆๅ
     * @param {...any[]} scopes ่กจ่พพๅผ็ไฝ็จๅๅ่กจ
     */
    function runExp(exp, thisArg) {
        var scopes = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            scopes[_i - 2] = arguments[_i];
        }
        createRunFunc(exp, scopes.length).apply(thisArg, scopes);
    }
    exports.runExp = runExp;
    /**
     * ๅๅปบไธไธช่กจ่พพๅผๆฑๅผๆนๆณ๏ผ็จไบๆชๆฅๆง่ก
     *
     * @export
     * @param {string} exp ่กจ่พพๅผ
     * @param {number} [scopeCount=0] ๆ้็ๅ็ๆฐ้
     * @returns {(...scopes:any[])=>any} ๅๅปบ็ๆนๆณ
     */
    function createEvalFunc(exp, scopeCount) {
        if (scopeCount === void 0) { scopeCount = 0; }
        return createRunFunc("return " + exp, scopeCount);
    }
    exports.createEvalFunc = createEvalFunc;
    /**
     * ่กจ่พพๅผๆฑๅผ๏ผๆๆณๆง่กๅคๆก่ฏญๅฅ
     *
     * @export
     * @param {string} exp ่กจ่พพๅผ
     * @param {*} [thisArg] thisๆๅ
     * @param {...any[]} scopes ่กจ่พพๅผ็ไฝ็จๅๅ่กจ
     * @returns {*} ่ฟๅๅผ
     */
    function evalExp(exp, thisArg) {
        var scopes = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            scopes[_i - 2] = arguments[_i];
        }
        return createEvalFunc(exp, scopes.length).apply(thisArg, scopes);
    }
    exports.evalExp = evalExp;
});
define("src/trunk/engine/bind/Bind", ["require", "exports", "src/trunk/engine/bind/Watcher", "src/trunk/utils/ObjectUtil"], function (require, exports, Watcher_1, ObjectUtil_6) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-11-06
     * @modify date 2017-11-06
     *
     * ไธไธช็ปๅฎ
    */
    var Bind = /** @class */ (function () {
        function Bind(mediator) {
            this._watcherDict = {};
            this._mediator = mediator;
        }
        Object.defineProperty(Bind.prototype, "mediator", {
            /**
             * ่ทๅๅทฒ็ปๅฎ็ไธญไป่ๅฎไพ
             *
             * @readonly
             * @type {IMediator}
             * @memberof Bind
             */
            get: function () {
                return this._mediator;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๅๅปบไธไธช่งๅฏ่๏ผๅจๆฐๅผๅๆดๆถไผ้็ฅๅ่ฐ่ฟ่กๆดๆฐ
         *
         * @param {*} target ไฝ็จ็ฎๆ๏ผๆ่กจ่พพๅผๆๅจ็ๆพ็คบๅฏน่ฑก
         * @param {string} exp ่กจ่พพๅผ
         * @param {*} scope ไฝ็จๅ
         * @param {WatcherCallback} callback ่ฎข้ๅจๅ่ฐ
         * @returns {IWatcher} ่ฟๅ่งๅฏ่ๆฌ่บซ
         * @memberof Bind
         */
        Bind.prototype.createWatcher = function (target, exp, scope, callback) {
            var key = ObjectUtil_6.getObjectHashs(target, exp, scope);
            var watcher = this._watcherDict[key];
            if (!watcher)
                this._watcherDict[key] = watcher = new Watcher_1.default(this, target, exp, scope, callback);
            return watcher;
        };
        return Bind;
    }());
    exports.default = Bind;
});
define("src/trunk/engine/bind/Watcher", ["require", "exports", "src/trunk/engine/bind/Utils"], function (require, exports, Utils_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-11-06
     * @modify date 2017-11-06
     *
     * ๆฐๆฎๆดๆฐ่ฎข้่๏ผๅฝไพ่ต็ๆฐๆฎๆๆดๆฐๆถไผ่งฆๅcallback้็ฅๅค้ข
    */
    var Watcher = /** @class */ (function () {
        function Watcher(bind, target, exp, scope, callback) {
            this._disposed = false;
            // ่ฎฐๅฝBindๅฎไพ
            this._bind = bind;
            // ่ฎฐๅฝไฝ็จ็ฎๆใ่กจ่พพๅผๅไฝ็จๅ
            this._target = target;
            this._exp = exp;
            this._scope = scope;
            // ๅฐ่กจ่พพๅผๅไฝ็จๅ่งฃๆไธบไธไธชFunction
            this._expFunc = Utils_1.createEvalFunc(exp, 2);
            // ่ฎฐๅฝๅ่ฐๅฝๆฐ
            this._callback = callback;
            // ่ฟ่ก้ฆๆฌกๆดๆฐ
            this.update();
        }
        /**
         * ่ทๅๅฐ่กจ่พพๅผๅฝๅๆๆฐๅผ
         * @returns {any} ๆๆฐๅผ
         */
        Watcher.prototype.getValue = function () {
            if (this._disposed)
                return null;
            var value = null;
            // ่ฎฐๅฝ่ช่บซ
            Watcher.updating = this;
            // ่ฎพ็ฝฎ้็จๅฑๆง
            var commonScope = {
                $this: this._bind.mediator,
                $bridge: this._bind.mediator.bridge,
                $target: this._target
            };
            // ่กจ่พพๅผๆฑๅผ
            try {
                value = this._expFunc.call(this._scope, commonScope, this._scope);
            }
            catch (err) {
                // ่พๅบ้่ฏฏๆฅๅฟ
                console.warn("่กจ่พพๅผๆฑๅผ้่ฏฏ\nerr: " + err.toString() + "\nexp๏ผ" + this._exp + "๏ผscope๏ผ" + JSON.stringify(this._scope));
            }
            // ็งป้ค้็จๅฑๆง
            delete this._scope["$root"];
            delete this._scope["$target"];
            // ็งป้ค่ช่บซ่ฎฐๅฝ
            Watcher.updating = null;
            return value;
        };
        /**
         * ๅฝไพ่ต็ๆฐๆฎๆๆดๆฐๆถ่ฐ็จ่ฏฅๆนๆณ
         * @param extra ๅฏ่ฝ็้ขๅคๆฐๆฎ
         */
        Watcher.prototype.update = function (extra) {
            if (this._disposed)
                return;
            var value = this.getValue();
            if (!Watcher.isEqual(value, this._value)) {
                this._callback && this._callback(value, this._value, extra);
                this._value = Watcher.deepCopy(value);
            }
        };
        /** ้ๆฏ่ฎข้่ */
        Watcher.prototype.dispose = function () {
            if (this._disposed)
                return;
            this._value = null;
            this._target = null;
            this._exp = null;
            this._scope = null;
            this._expFunc = null;
            this._callback = null;
            this._disposed = true;
        };
        /**
         * ๆฏๅฆ็ธ็ญ๏ผๅๆฌๅบ็ก็ฑปๅๅๅฏน่ฑก/ๆฐ็ป็ๅฏนๆฏ
         */
        Watcher.isEqual = function (a, b) {
            return (a == b || (Watcher.isObject(a) && Watcher.isObject(b)
                ? JSON.stringify(a) == JSON.stringify(b)
                : false));
        };
        /**
         * ๆฏๅฆไธบๅฏน่ฑก(ๅๆฌๆฐ็ปใๆญฃๅ็ญ)
         */
        Watcher.isObject = function (obj) {
            return (obj && typeof obj == "object");
        };
        /**
         * ๅคๅถๅฏน่ฑก๏ผ่ฅไธบๅฏน่ฑกๅๆทฑๅบฆๅคๅถ
         */
        Watcher.deepCopy = function (from) {
            if (Watcher.isObject(from)) {
                // ๅคๆ็ฑปๅๅฏน่ฑก๏ผๅๅญ็ฌฆไธฒๅ๏ผๅๅฏน่ฑกๅ
                return JSON.parse(JSON.stringify(from));
            }
            else {
                // ๅบๆฌ็ฑปๅๅฏน่ฑก๏ผ็ดๆฅ่ฟๅไน
                return from;
            }
        };
        /** ่ฎฐๅฝๅฝๅๆญฃๅจๆง่กupdateๆนๆณ็Watcherๅผ็จ */
        Watcher.updating = null;
        Watcher._uid = 0;
        return Watcher;
    }());
    exports.default = Watcher;
});
define("src/trunk/engine/bind/Dep", ["require", "exports", "src/trunk/utils/Dictionary"], function (require, exports, Dictionary_3) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-11-06
     * @modify date 2017-11-06
     *
     * ๅฎไนไธไธชไพ่ต๏ผไธไธช่งๅฏ่ๅฎ็ฐ
    */
    var Dep = /** @class */ (function () {
        function Dep() {
            this._map = new Dictionary_3.default();
        }
        /**
         * ๆทปๅๆฐๆฎๅๆด่ฎข้่
         * @param watcher ๆฐๆฎๅๆด่ฎข้่
         */
        Dep.prototype.watch = function (watcher) {
            this._map.set(watcher, watcher);
        };
        /**
         * ๆฐๆฎๅๆด๏ผ้็ฅๆๆ่ฎข้่
         * @param extra ๅฏ่ฝ็้ขๅคๆฐๆฎ
         */
        Dep.prototype.notify = function (extra) {
            this._map.forEach(function (watcher) {
                watcher.update(extra);
            });
        };
        return Dep;
    }());
    exports.default = Dep;
});
define("src/trunk/engine/bind/Mutator", ["require", "exports", "src/trunk/utils/ObjectUtil", "src/trunk/engine/bind/Dep", "src/trunk/engine/bind/Watcher"], function (require, exports, ObjectUtil_7, Dep_1, Watcher_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-11-06
     * @modify date 2017-11-06
     *
     * ๅๅผๅจ๏ผๅฐViewModelๅๅผไธบๅทๆไพ่ตๅ่ฝ็ๅฝขๅผ๏ผไนๅฏไปฅ่ฎคไธบๆฏ็ผ่ฏ่ฟ็จ
    */
    // ่ฎฐๅฝๆฐ็ปไธญไผ้ๆๆฐๆฎๆดๆฐ็ๆๆๆนๆณๅ
    var _arrMethods = [
        "push",
        "pop",
        "unshift",
        "shift",
        "splice",
        "sort",
        "reverse"
    ];
    /**
     * ๅฐ็จๆทไผ่ฟๆฅ็ๆฐๆฎโๅๅผโๆไธบๅทๆๆช่ทๆฐๆฎๅๆด่ฝๅ็ๆฐๆฎ
     * @param data ๅๅงๆฐๆฎ
     * @returns {any} ๅๅผๅ็ๆฐๆฎ
     */
    function mutate(data) {
        // ๅฆๆๆฏ็ฎๅ็ฑปๅ๏ผๅๅฅไนไธๅ
        if (!data || typeof data != "object")
            return data;
        // ้ๅฝๅๅผๆๆๅ้จๅ้
        for (var key in data) {
            mutateObject(data, key, data[key]);
        }
        return data;
    }
    exports.mutate = mutate;
    function mutateObject(data, key, value) {
        var depKey = ObjectUtil_7.getObjectHashs(data, key);
        // ๅฏนๆฏไธชๅคๆ็ฑปๅๅฏน่ฑก้ฝ่ฆๆไธไธชๅฏนๅบ็ไพ่ตๅ่กจ
        var dep = data[depKey];
        if (!dep) {
            dep = new Dep_1.default();
            // ๅๅผ่ฟ็จ
            Object.defineProperty(data, key, {
                enumerable: true,
                configurable: false,
                get: function () {
                    // ๅฆๆWatcher.updatingไธๆฏnull๏ผ่ฏดๆๅฝๅๆญฃๅจๆง่ก่กจ่พพๅผ๏ผ้ฃไน่ทๅ็ๅ้่ช็ถๆฏๅถ้่ฆไพ่ต็
                    var watcher = Watcher_2.default.updating;
                    if (watcher)
                        dep.watch(watcher);
                    // ๅฉ็จ้ญๅไฟๅญๅๅงๅผ
                    return value;
                },
                set: function (v) {
                    if (v == value)
                        return;
                    value = v;
                    // ๅฆๆๆฏๆฐ็ปๅฐฑ่ตฐไธ้จ็ๆฐ็ปๅๅผๆนๆณ๏ผๅฆๅ้ๅฝๅๅผๅฏน่ฑก
                    if (Array.isArray(v))
                        mutateArray(v, dep);
                    else
                        mutate(v);
                    // ่งฆๅ้็ฅ
                    dep.notify();
                }
            });
            // ๆไธไธชๆ่ฎฐ่กจ็คบๅทฒ็ปๅๅผ่ฟไบ
            Object.defineProperty(data, depKey, {
                value: dep,
                writable: false,
                enumerable: false,
                configurable: false
            });
        }
        // ้ๅฝๅญๅฑๆง
        mutate(value);
    }
    function mutateArray(arr, dep) {
        // ๅๅผๅฝๅๆฐ็ป
        arr["__proto__"] = defineReactiveArray(dep);
        // ้ๅๅฝๅๆฐ็ป๏ผๅฐๅๅฎนๅฏน่ฑกๅจ้จๅๅผ
        for (var i = 0, len = arr.length; i < len; i++) {
            mutate(arr[i]);
        }
    }
    function defineReactiveArray(dep) {
        var proto = Array.prototype;
        var result = Object.create(proto);
        // ้ๅๆๆๆนๆณ๏ผไธไธชไธไธชๅฐๅๅผ
        _arrMethods.forEach(function (method) {
            // ๅฉ็จ้ญๅ่ฎฐๅฝไธไธชๅๅงๆนๆณ
            var oriMethod = proto[method];
            // ๅผๅงๅๅผ
            Object.defineProperty(result, method, {
                value: function () {
                    var args = [];
                    for (var _i = 0; _i < arguments.length; _i++) {
                        args[_i] = arguments[_i];
                    }
                    // ้ฆๅ่ฐ็จๅๅงๆนๆณ๏ผ่ทๅ่ฟๅๅผ
                    var result = oriMethod.apply(this, args);
                    // ๆฐ็ปๆๅฅ้กน
                    var inserted;
                    switch (method) {
                        case "push":
                        case "unshift":
                            inserted = args;
                            break;
                        case "splice":
                            inserted = args.slice(2);
                            break;
                    }
                    // ็่งๆฐ็ปๆๅฅ้กน๏ผ่ไธๆฏ้ๆฐ็่งๆดไธชๆฐ็ป
                    if (inserted && inserted.length) {
                        mutateArray(inserted, dep);
                    }
                    // ่งฆๅๆดๆฐ
                    dep.notify({ method: args });
                    // ่ฟๅๅผ
                    return result;
                }
            });
        });
        // ๆไพๆฟๆขๆฐ็ป่ฎพ็ฝฎ็ๆนๆณ๏ผๅไธบ็ดๆฅ่ฎพ็ฝฎๆฐ็ปไธๆ็ๆนๅผๆๆณๅๅผ
        Object.defineProperty(result, "$set", {
            value: function (index, value) {
                // ่ถๅบๆฐ็ป้ฟๅบฆ้ป่ฎค่ฟฝๅๅฐๆๅ
                if (index >= this.length)
                    index = this.length;
                return this.splice(index, 1, value)[0];
            }
        });
        // ๆไพๆฟๆขๆฐ็ป็งป้ค็ๆนๆณ๏ผๅไธบ็ดๆฅ็งป้ค็ๆนๅผๆๆณๅๅผ
        Object.defineProperty(result, "$remove", {
            value: function (item) {
                var index = this.indexOf(item);
                if (index > -1)
                    return this.splice(index, 1);
                return null;
            }
        });
        return result;
    }
});
define("src/trunk/engine/bind/BindManager", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/Core", "src/trunk/utils/Dictionary", "src/trunk/engine/bind/Bind", "src/trunk/engine/bind/Utils", "src/trunk/engine/net/NetManager"], function (require, exports, Injector_13, Core_18, Dictionary_4, Bind_1, Utils_2, NetManager_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-11-06
     * @modify date 2017-11-06
     *
     * ็ปๅฎ็ฎก็ๅจ๏ผๅฏไปฅๅฐๆฐๆฎๅๆพ็คบๅฏน่ฑก็ปๅฎๅฐไธ่ตท๏ผMVVMไนฆๅ็้ข
    */
    var BindManager = /** @class */ (function () {
        function BindManager() {
            this._bindDict = new Dictionary_4.default();
        }
        /**
         * ็ปๅฎๆฐๆฎๅฐUIไธ
         *
         * @param {IMediator} mediator ไธญไป่
         * @returns {Bind} ่ฟๅ็ปๅฎๅฎไพ
         * @memberof BindManager
         */
        BindManager.prototype.bind = function (mediator) {
            var bindData = this._bindDict.get(mediator);
            if (!bindData) {
                this._bindDict.set(mediator, bindData = {
                    bind: new Bind_1.default(mediator),
                    callbacks: []
                });
            }
            // ้ๆฐ็ปๅฎๆๆ
            for (var _i = 0, _a = bindData.callbacks; _i < _a.length; _i++) {
                var callback = _a[_i];
                callback();
            }
            // ่ฟๅBindๅฏน่ฑก
            return bindData.bind;
        };
        /**
         * ็งป้ค็ปๅฎ
         *
         * @param {IMediator} mediator
         * @returns {Bind}
         * @memberof BindManager
         */
        BindManager.prototype.unbind = function (mediator) {
            var bindData = this._bindDict.get(mediator);
            if (bindData)
                this._bindDict.delete(mediator);
            return bindData && bindData.bind;
        };
        BindManager.prototype.search = function (values, ui, callback) {
            for (var key in values) {
                var value = values[key];
                var index = key.indexOf(".");
                if (index >= 0) {
                    // ๆฏ่กจ่พพๅผๅฏปๅ๏ผ้ๅฝๅฏปๅ
                    var newValue = {};
                    newValue[key.substr(index + 1)] = value;
                    this.search(newValue, ui[key.substring(0, index)], callback);
                }
                else if (typeof value != "string") {
                    // ๆฏๅญๅฏน่ฑกๅฏปๅ๏ผ้ๅฝๅฏปๅ
                    this.search(value, ui[key], callback);
                }
                else {
                    // ๆฏ่กจ่พพๅผ๏ผ่ฐ็จๅ่ฐ
                    callback(ui, key, value);
                }
            }
        };
        BindManager.prototype.delaySearch = function (mediator, values, ui, callback) {
            var _this = this;
            var handler = function () {
                // ๅคๆญๆฐๆฎๆฏๅฆๅๆณ
                if (!mediator.viewModel)
                    return;
                // ๅผๅง็ปๅฎ
                _this.search(values, ui, callback);
            };
            // ๆทปๅ็ปๅฎๆฐๆฎ
            var bindData = this._bindDict.get(mediator);
            if (bindData.callbacks.indexOf(handler) < 0)
                bindData.callbacks.push(handler);
            // ็ซๅณ่ฐ็จไธๆฌก
            handler();
        };
        /**
         * ็ปๅฎๅฑๆงๅผ
         *
         * @param {IMediator} mediator ไธญไป่
         * @param {{[name:string]:string}} uiDict uiๅฑๆงๅญๅธ
         * @param {*} ui ็ปๅฎๅฐ็uiๅฎไฝๅฏน่ฑก
         * @memberof BindManager
         */
        BindManager.prototype.bindValue = function (mediator, uiDict, ui) {
            var bindData = this._bindDict.get(mediator);
            this.delaySearch(mediator, uiDict, ui, function (ui, key, exp) {
                bindData.bind.createWatcher(ui, exp, mediator.viewModel, function (value) {
                    ui[key] = value;
                });
            });
        };
        /**
         * ็ปๅฎไบไปถ
         *
         * @param {IMediator} mediator ไธญไป่
         * @param {{[type:string]:string}} evtDict ไบไปถๅญๅธ
         * @param {*} ui ็ปๅฎๅฐ็uiๅฎไฝๅฏน่ฑก
         * @memberof BindManager
         */
        BindManager.prototype.bindOn = function (mediator, evtDict, ui) {
            this.delaySearch(mediator, evtDict, ui, function (ui, key, exp) {
                var handler = mediator.viewModel[exp];
                var commonScope = {
                    $this: mediator,
                    $bridge: mediator.bridge,
                    $target: ui
                };
                // ๅฆๆๅไธๅฐhandler๏ผๅๆexpๅฝๅไธไธชๆง่ก่กจ่พพๅผๅค็๏ผๅค้ขๅไธๅฑๆนๆณ
                if (!handler) {
                    var func = Utils_2.createRunFunc(exp, 2);
                    handler = function () {
                        func.call(this, mediator.viewModel, commonScope);
                    };
                }
                mediator.bridge.mapListener(ui, key, handler, mediator.viewModel);
            });
        };
        BindManager.prototype.replaceDisplay = function (bridge, ori, cur) {
            var parent = bridge.getParent(ori);
            if (parent) {
                // oriๆ็ถ็บง๏ผ่ฎฐๅฝๅถๅฝๅ็ดขๅผ
                var index = bridge.getChildIndex(parent, ori);
                // ็งป้คori
                bridge.removeChild(parent, ori);
                // ๆพ็คบcur
                bridge.addChildAt(parent, cur, index);
            }
        };
        /**
         * ็ปๅฎๆพ็คบ
         *
         * @param {IMediator} mediator ไธญไป่
         * @param {{[name:string]:string}} uiDict ๅคๆญๅญๅธ
         * @param {*} ui ็ปๅฎๅฐ็uiๅฎไฝๅฏน่ฑก
         * @memberof BindManager
         */
        BindManager.prototype.bindIf = function (mediator, uiDict, ui) {
            var _this = this;
            var bindData = this._bindDict.get(mediator);
            var replacer = mediator.bridge.createEmptyDisplay();
            this.delaySearch(mediator, uiDict, ui, function (ui, key, exp) {
                // ๅฏปๅๅฐๆๅฎ็ฎๆ
                ui = ui[key] || ui;
                // ็ปๅฎ่กจ่พพๅผ
                bindData.bind.createWatcher(ui, exp, mediator.viewModel, function (value) {
                    // ๅฆๆ่กจ่พพๅผไธบtrueๅๆพ็คบui๏ผๅฆๅ็งป้คui
                    if (value)
                        _this.replaceDisplay(mediator.bridge, replacer, ui);
                    else
                        _this.replaceDisplay(mediator.bridge, ui, replacer);
                });
            });
        };
        /**
         * ็ปๅฎๅจๅฑMessage
         *
         * @param {IMediator} mediator ไธญไป่
         * @param {IConstructor|string} type ็ปๅฎ็ๆถๆฏ็ฑปๅๅญ็ฌฆไธฒ
         * @param {{[name:string]:string}} uiDict ui่กจ่พพๅผๅญๅธ
         * @param {*} ui ็ปๅฎๅฐ็uiๅฎไฝๅฏน่ฑก
         * @param {IObservable} [observable] ็ปๅฎ็ๆถๆฏๅๆธ๏ผ้ป่ฎคๆฏcore
         * @memberof BindManager
         */
        BindManager.prototype.bindMessage = function (mediator, type, uiDict, ui, observable) {
            var _this = this;
            if (!observable)
                observable = Core_18.core.observable;
            var bindData = this._bindDict.get(mediator);
            var handler = function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                if (mediator.disposed) {
                    // mediatorๅทฒ้ๆฏ๏ผๅๆถ็ๅฌ
                    observable.unlisten(type, handler);
                }
                else {
                    var msg;
                    if (args.length == 1 && typeof args[0] == "object" && args[0].type)
                        msg = args[0];
                    else
                        msg = { $arguments: args };
                    _this.search(uiDict, ui, function (ui, key, exp) {
                        // ่ฎพ็ฝฎ้็จๅฑๆง
                        var commonScope = {
                            $this: mediator,
                            $bridge: mediator.bridge,
                            $target: ui
                        };
                        ui[key] = Utils_2.evalExp(exp, mediator.viewModel, msg, mediator.viewModel, commonScope);
                    });
                }
            };
            // ๆทปๅ็ๅฌ
            observable.listen(type, handler);
        };
        /**
         * ็ปๅฎๅจๅฑResponse
         *
         * @param {IMediator} mediator ไธญไป่
         * @param {IResponseDataConstructor|string} type ็ปๅฎ็้่ฎฏๆถๆฏ็ฑปๅ
         * @param {{[name:string]:string}} uiDict ui่กจ่พพๅผๅญๅธ
         * @param {*} ui ็ปๅฎๅฐ็uiๅฎไฝๅฏน่ฑก
         * @param {IObservable} [observable] ็ปๅฎ็ๆถๆฏๅๆธ๏ผ้ป่ฎคๆฏcore
         * @memberof BindManager
         */
        BindManager.prototype.bindResponse = function (mediator, type, uiDict, ui, observable) {
            var _this = this;
            if (!observable)
                observable = Core_18.core.observable;
            var bindData = this._bindDict.get(mediator);
            var handler = function (response) {
                if (mediator.disposed) {
                    // mediatorๅทฒ้ๆฏ๏ผๅๆถ็ๅฌ
                    NetManager_2.netManager.unlistenResponse(type, handler, null, null, observable);
                }
                else {
                    _this.search(uiDict, ui, function (ui, key, exp) {
                        // ่ฎพ็ฝฎ้็จๅฑๆง
                        var commonScope = {
                            $this: mediator,
                            $bridge: mediator.bridge,
                            $target: ui
                        };
                        ui[key] = Utils_2.evalExp(exp, mediator.viewModel, response, mediator.viewModel, commonScope);
                    });
                }
            };
            // ๆทปๅ็ๅฌ
            NetManager_2.netManager.listenResponse(type, handler, null, null, observable);
            // ๅฆๆmediatorๆไพ่ต็ๆจกๅๆๅๅงๅๆถๆฏ๏ผๅ่ฆ้ขๅค่งฆๅๅๅงๅๆถๆฏ็็ปๅฎ
            if (mediator["dependModuleInstance"]) {
                for (var _i = 0, _a = mediator["dependModuleInstance"].responses; _i < _a.length; _i++) {
                    var response = _a[_i];
                    handler(response);
                }
            }
        };
        BindManager = __decorate([
            Injector_13.Injectable
        ], BindManager);
        return BindManager;
    }());
    exports.default = BindManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.bindManager = Core_18.core.getInject(BindManager);
});
define("src/trunk/engine/mediator/Mediator", ["require", "exports", "src/trunk/core/Core", "src/trunk/engine/bind/Mutator", "src/trunk/engine/bind/BindManager"], function (require, exports, Core_19, Mutator_1, BindManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-04
     * @modify date 2017-09-04
     *
     * ็ปไปถ็้ขไธญไป่ๅบ็ฑป
    */
    var Mediator = /** @class */ (function () {
        function Mediator(skin) {
            this._disposed = false;
            this._listeners = [];
            if (skin)
                this.skin = skin;
            // ๅๅงๅ็ปๅฎ
            this.viewModel = {};
        }
        Object.defineProperty(Mediator.prototype, "viewModel", {
            /**
             * ่ทๅๆ่ฎพ็ฝฎViewModel
             *
             * @type {*}
             * @memberof Mediator
             */
            get: function () {
                return this._viewModel;
            },
            set: function (value) {
                // ่ฎพ็ฝฎ็ๆถๅ่ฟ่กไธๆฌกๅๅผ
                this._viewModel = Mutator_1.mutate(value);
                // ๆดๆฐ็ปๅฎ
                BindManager_1.bindManager.bind(this);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Mediator.prototype, "disposed", {
            /**
             * ่ทๅไธญไป่ๆฏๅฆๅทฒ่ขซ้ๆฏ
             *
             * @readonly
             * @type {boolean}
             * @memberof Mediator
             */
            get: function () {
                return this._disposed;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Mediator.prototype, "dependModuleInstance", {
            /**
             * ๆๅฑ็ๆจกๅๅผ็จ๏ผ้่ฆ้ๅ@DelegateMediatorไฝฟ็จ
             *
             * @readonly
             * @type {IModule}
             * @memberof IMediator
             */
            get: function () {
                return this._dependModuleInstance;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Mediator.prototype, "dependModule", {
            /**
             * ๆๅฑ็ๆจกๅ็ฑปๅ๏ผ้่ฆ้ๅ@DelegateMediatorไฝฟ็จ
             *
             * @readonly
             * @type {IModuleConstructor}
             * @memberof IMediator
             */
            get: function () {
                return this._dependModule;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Mediator.prototype, "data", {
            /**
             * ๆๅผๆถไผ้็dataๅฏน่ฑก
             *
             * @readonly
             * @type {*}
             * @memberof Mediator
             */
            get: function () {
                return this._data;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๅๅบไธญไป่ๆ้็่ตๆบๆฐ็ป๏ผๅฏ้ๅ
         * ไฝๅฆๆMediatorๆฒกๆ่ขซๆ็ฎกๅจModuleไธญๅ่ฏฅๆนๆณไธๅบ่ฏฅ่ขซ้ๅ๏ผๅฆๅๅฏ่ฝไผๆ้ฎ้ข
         *
         * @returns {string[]} ่ตๆบๆฐ็ป๏ผ่ฏทๆนๆฎ่ฏฅMediatorๆๆไฝ็ๆธฒๆๆจก็ป็้ๆฑ็ปๅบ่ตๆบๅฐๅๆ็ปๅ
         * @memberof Mediator
         */
        Mediator.prototype.listAssets = function () {
            return null;
        };
        /**
         * ๅ่ฝฝไปlistAssetsไธญ่ทๅๅฐ็ๆๆ่ตๆบ
         *
         * @param {(err?:Error)=>void} handler ๅ่ฝฝๅฎๆฏๅ็ๅ่ฐ๏ผๅฆๆๅบ้ๅไผ็ปๅบerrๅๆฐ
         * @returns {void}
         * @memberof Mediator
         */
        Mediator.prototype.loadAssets = function (handler) {
            var self = this;
            this.bridge.loadAssets(this.listAssets(), this, function (err) {
                // ่ฐ็จonLoadAssetsๆฅๅฃ
                self.onLoadAssets(err);
                // ่ฐ็จๅ่ฐ
                handler(err);
            });
        };
        /**
         * ๅฝๆ้่ตๆบๅ่ฝฝๅฎๆฏๅ่ฐ็จ
         *
         * @param {Error} [err] ๅ่ฝฝๅบ้ไผ็ปๅบ้่ฏฏๅฏน่ฑก๏ผๆฒก้ๅไธ็ป
         * @memberof Mediator
         */
        Mediator.prototype.onLoadAssets = function (err) {
        };
        /**
         * ๆๅผ๏ผไธบไบๅฎ็ฐIOpenCloseๆฅๅฃ
         *
         * @param {*} [data]
         * @returns {*}
         * @memberof Mediator
         */
        Mediator.prototype.open = function (data) {
            this._data = data;
            this.onOpen(data);
            return this;
        };
        /**
         * ๅณ้ญ๏ผไธบไบๅฎ็ฐIOpenCloseๆฅๅฃ
         *
         * @param {*} [data]
         * @returns {*}
         * @memberof Mediator
         */
        Mediator.prototype.close = function (data) {
            this.onClose(data);
            this.dispose();
            return this;
        };
        /**
         * ๅฝๆๅผๆถ่ฐ็จ
         *
         * @param {*} [data] ๅฏ่ฝ็ๆๅผๅๆฐ
         * @memberof Mediator
         */
        Mediator.prototype.onOpen = function (data) {
            // ๅฏ้ๅ
        };
        /**
         * ๅฝๅณ้ญๆถ่ฐ็จ
         *
         * @param {*} [data] ๅฏ่ฝ็ๅณ้ญๅๆฐ
         * @memberof Mediator
         */
        Mediator.prototype.onClose = function (data) {
            // ๅฏ้ๅ
        };
        /**
         * ็ๅฌไบไปถ๏ผไป่ฟไธชๆนๆณ็ๅฌ็ไบไปถไผๅจไธญไป่้ๆฏๆถ่ขซ่ชๅจ็งป้ค็ๅฌ
         *
         * @param {*} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {Function} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof Mediator
         */
        Mediator.prototype.mapListener = function (target, type, handler, thisArg) {
            for (var i = 0, len = this._listeners.length; i < len; i++) {
                var data = this._listeners[i];
                if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                    // ๅทฒ็ปๅญๅจไธๆท็็ๅฌ๏ผไธๅ็ๅฌ
                    return;
                }
            }
            // ่ฎฐๅฝ็ๅฌ
            this._listeners.push({ target: target, type: type, handler: handler, thisArg: thisArg });
            // ่ฐ็จๆกฅๆฅๅฃ
            this.bridge.mapListener(target, type, handler, thisArg);
        };
        /**
         * ๆณจ้็ๅฌไบไปถ
         *
         * @param {*} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {Function} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof Mediator
         */
        Mediator.prototype.unmapListener = function (target, type, handler, thisArg) {
            for (var i = 0, len = this._listeners.length; i < len; i++) {
                var data = this._listeners[i];
                if (data.target == target && data.type == type && data.handler == handler && data.thisArg == thisArg) {
                    // ่ฐ็จๆกฅๆฅๅฃ
                    this.bridge.unmapListener(target, type, handler, thisArg);
                    // ็งป้ค่ฎฐๅฝ
                    this._listeners.splice(i, 1);
                    break;
                }
            }
        };
        /**
         * ๆณจ้ๆๆๆณจๅๅจๅฝๅไธญไป่ไธ็ไบไปถ็ๅฌ
         *
         * @memberof Mediator
         */
        Mediator.prototype.unmapAllListeners = function () {
            for (var i = 0, len = this._listeners.length; i < len; i++) {
                var data = this._listeners.pop();
                // ่ฐ็จๆกฅๆฅๅฃ
                this.bridge.unmapListener(data.target, data.type, data.handler, data.thisArg);
            }
        };
        Mediator.prototype.dispatch = function (typeOrMsg) {
            var params = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                params[_i - 1] = arguments[_i];
            }
            Core_19.core.dispatch.apply(Core_19.core, [typeOrMsg].concat(params));
        };
        Object.defineProperty(Mediator.prototype, "observable", {
            /*********************** ไธ้ขๆฏๆจกๅๆถๆฏ็ณป็ป ***********************/
            /**
             * ๆด้ฒIObservable
             *
             * @readonly
             * @type {IObservable}
             * @memberof Mediator
             */
            get: function () {
                return this._dependModuleInstance && this._dependModuleInstance.observable;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ็ๅฌๆถๆฏ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof IModuleObservable
         */
        Mediator.prototype.listenModule = function (type, handler, thisArg) {
            this._dependModuleInstance && this._dependModuleInstance.listenModule(type, handler, thisArg);
        };
        /**
         * ็งป้คๆถๆฏ็ๅฌ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof IModuleObservable
         */
        Mediator.prototype.unlistenModule = function (type, handler, thisArg) {
            this._dependModuleInstance && this._dependModuleInstance.unlistenModule(type, handler, thisArg);
        };
        /**
         * ๆณจๅๅฝไปคๅฐ็นๅฎๆถๆฏ็ฑปๅไธ๏ผๅฝ่ฟไธช็ฑปๅ็ๆถๆฏๆดพๅๅฐๆกๆถๅๆธๆถไผ่งฆๅCommand่ฟ่ก
         *
         * @param {string} type ่ฆๆณจๅ็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ๏ผๅฏไปฅๆฏๆนๆณๅฝขๅผ๏ผไนๅฏไปฅไฝฟ็ฑปๅฝขๅผ
         * @memberof IModuleObservable
         */
        Mediator.prototype.mapCommandModule = function (type, cmd) {
            this._dependModuleInstance && this._dependModuleInstance.mapCommandModule(type, cmd);
        };
        /**
         * ๆณจ้ๅฝไปค
         *
         * @param {string} type ่ฆๆณจ้็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ
         * @returns {void}
         * @memberof IModuleObservable
         */
        Mediator.prototype.unmapCommandModule = function (type, cmd) {
            this._dependModuleInstance && this._dependModuleInstance.unmapCommandModule(type, cmd);
        };
        /** dispatchModuleๆนๆณๅฎ็ฐ */
        Mediator.prototype.dispatchModule = function () {
            var params = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                params[_i] = arguments[_i];
            }
            this._dependModuleInstance && this._dependModuleInstance.dispatchModule.apply(this._dependModuleInstance, params);
        };
        /**
         * ้ๆฏไธญไป่
         *
         * @memberof Mediator
         */
        Mediator.prototype.dispose = function () {
            if (this._disposed)
                return;
            // ็งป้คๆพ็คบ
            if (this.skin && this.bridge) {
                var parent = this.bridge.getParent(this.skin);
                if (parent)
                    this.bridge.removeChild(parent, this.skin);
            }
            // ๆณจ้ไบไปถ็ๅฌ
            this.unmapAllListeners();
            // ็งป้ค่กจ็ฐๅฑๆกฅ
            this.bridge = null;
            // ็งป้ค็ปๅฎ
            BindManager_1.bindManager.unbind(this);
            // ็งป้คViewModel
            this._viewModel = null;
            // ็งป้ค็ฎ่ค
            this.skin = null;
            // ่ฎพ็ฝฎๅทฒ่ขซ้ๆฏ
            this._disposed = true;
        };
        return Mediator;
    }());
    exports.default = Mediator;
});
define("src/trunk/engine/panel/PanelMediator", ["require", "exports", "src/trunk/engine/mediator/Mediator", "src/trunk/engine/panel/PanelManager"], function (require, exports, Mediator_1, PanelManager_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * ๅฎ็ฐไบIPanelๆฅๅฃ็ๅผน็ชไธญไป่ๅบ็ฑป
    */
    var PanelMediator = /** @class */ (function (_super) {
        __extends(PanelMediator, _super);
        function PanelMediator(skin, policy) {
            var _this = _super.call(this, skin) || this;
            _this.policy = policy;
            return _this;
        }
        /**
         * ๅผนๅบๅฝๅๅผน็ช๏ผ็ญๅไบ่ฐ็จPanelManager.popๆนๆณ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @param {boolean} [isModel] ๆฏๅฆๆจกๆๅผนๅบ๏ผๅๆนUIๆๆณไบคไบ๏ผ
         * @param {{x:number, y:number}} [from] ๅผนๅบ็นๅๆ
         * @returns {IPanel} ๅผน็ชๆฌไฝ
         * @memberof PanelMediator
         */
        PanelMediator.prototype.open = function (data, isModel, from) {
            return PanelManager_2.panelManager.pop(this, data, isModel, from);
        };
        /**
         * ๅผนๅบๅฝๅๅผน็ช๏ผๅช่ฝ็ฑPanelManager่ฐ็จ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @param {boolean} [isModel] ๆฏๅฆๆจกๆๅผนๅบ๏ผๅๆนUIๆๆณไบคไบ๏ผ
         * @param {{x:number, y:number}} [from] ๅผนๅบ็นๅๆ
         * @memberof PanelMediator
         */
        PanelMediator.prototype.__open = function (data, isModel, from) {
            _super.prototype.open.call(this, data);
        };
        /**
         * ๅณ้ญๅฝๅๅผน็ช๏ผ็ญๅไบ่ฐ็จPanelManager.dropๆนๆณ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @param {{x:number, y:number}} [to] ๅณ้ญ็นๅๆ
         * @returns {IPanel} ๅผน็ชๆฌไฝ
         * @memberof PanelMediator
         */
        PanelMediator.prototype.close = function (data, to) {
            return PanelManager_2.panelManager.drop(this, data, to);
        };
        /**
         * ๅณ้ญๅฝๅๅผน็ช๏ผๅช่ฝ็ฑPanelManager่ฐ็จ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @param {{x:number, y:number}} [to] ๅณ้ญ็นๅๆ
         * @memberof PanelMediator
         */
        PanelMediator.prototype.__close = function (data, to) {
            _super.prototype.close.call(this, data);
        };
        /** ๅจๅผนๅบๅ่ฐ็จ็ๆนๆณ */
        PanelMediator.prototype.onBeforePop = function (data, isModel, from) {
            // ๅฏ้ๅ
        };
        /** ๅจๅผนๅบๅ่ฐ็จ็ๆนๆณ */
        PanelMediator.prototype.onAfterPop = function (data, isModel, from) {
            // ๅฏ้ๅ
        };
        /** ๅจๅณ้ญๅ่ฐ็จ็ๆนๆณ */
        PanelMediator.prototype.onBeforeDrop = function (data, to) {
            // ๅฏ้ๅ
        };
        /** ๅจๅณ้ญๅ่ฐ็จ็ๆนๆณ */
        PanelMediator.prototype.onAfterDrop = function (data, to) {
            // ๅฏ้ๅ
        };
        return PanelMediator;
    }(Mediator_1.default));
    exports.default = PanelMediator;
});
define("src/trunk/engine/scene/NoneScenePolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-08
     * @modify date 2017-09-08
     *
     * ๆไปปไฝๅจ็ป็ๅบๆฏ็ญ็ฅ๏ผๅฏๅบ็จไบไปปไฝๆพ็คบๅฑๅฎ็ฐ
    */
    var NoneScenePolicy = /** @class */ (function () {
        function NoneScenePolicy() {
        }
        /**
         * ๅๅคๅๆขๅบๆฏๆถ่ฐๅบฆ
         * @param from ๅๅบ็ๅบๆฏ
         * @param to ๅๅฅ็ๅบๆฏ
         */
        NoneScenePolicy.prototype.prepareSwitch = function (from, to) {
            // ่ฟไธช็ญ็ฅ้ๅฅไนไธ็จๅๅค
        };
        /**
         * ๅๆขๅบๆฏๆถ่ฐๅบฆ
         * @param from ๅๅบ็ๅบๆฏ
         * @param to ๅๅฅ็ๅบๆฏ
         * @param callback ๅๆขๅฎๆฏ็ๅ่ฐๆนๆณ
         */
        NoneScenePolicy.prototype.switch = function (from, to, callback) {
            // ็ดๆฅๅปถ่ฟๅฐไธไธๅธงๅ่ฐ๏ผไธ่ฝๅๆญฅๅ่ฐ๏ผๅฆๅๅฏ่ฝไผๅบ้ฎ้ข๏ผ
            setTimeout(callback, 0);
        };
        return NoneScenePolicy;
    }());
    exports.NoneScenePolicy = NoneScenePolicy;
    /** ้ป่ฎคๅฏผๅบๅฎไพ */
    exports.default = new NoneScenePolicy();
});
define("src/trunk/engine/scene/SceneMessage", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-08
     * @modify date 2017-09-08
     *
     * ๅบๆฏ็ธๅณ็ๆถๆฏ
    */
    var SceneMessage = /** @class */ (function () {
        function SceneMessage() {
        }
        /**
         * ๅๆขๅบๆฏๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof SceneMessage
         */
        SceneMessage.SCENE_BEFORE_CHANGE = "sceneBeforeChange";
        /**
         * ๅๆขๅบๆฏๅ็ๆถๆฏ
         *
         * @static
         * @type {string}
         * @memberof SceneMessage
         */
        SceneMessage.SCENE_AFTER_CHANGE = "sceneAfterChange";
        return SceneMessage;
    }());
    exports.default = SceneMessage;
});
define("src/trunk/utils/SyncUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-08
     * @modify date 2017-09-08
     *
     * ๅๆญฅๅทฅๅท้๏ผ็จไบๅฏนๅคไธช
    */
    var _cache = {};
    /**
     * ๅคๆญๆฏๅฆๆญฃๅจ่ฟ่กๆไฝ
     *
     * @export
     * @param {string} name ้ๅๅ
     * @returns {boolean} ้ๅๆฏๅฆๆญฃๅจๆไฝ
     */
    function isOperating(name) {
        var ctx = _cache[name];
        return (ctx != null && ctx.operating);
    }
    exports.isOperating = isOperating;
    /**
     * ๅผๅงๅๆญฅๆไฝ๏ผๆๆไผ้ไบ็ธๅname็ๆไฝไผ่ขซไปฅ้ๅๆนๅผ้กบๅบๆง่ก
     *
     * @export
     * @param name ไธไธช้ๅ็ๅๅญ
     * @param {Function} fn ่ฆๆง่ก็ๆนๆณ
     * @param {*} [thisArg] ๆนๆณthisๅฏน่ฑก
     * @param {...any[]} [args] ๆนๆณๅๆฐ
     */
    function wait(name, fn, thisArg) {
        var args = [];
        for (var _i = 3; _i < arguments.length; _i++) {
            args[_i - 3] = arguments[_i];
        }
        var ctx = _cache[name];
        if (ctx == null) {
            _cache[name] = ctx = { operating: false, datas: [] };
        }
        if (ctx.operating) {
            // ้ๅๆญฃๅจๆง่ก๏ผๆจๅฅ็ผๅญ
            ctx.datas.push({ fn: fn, thisArg: thisArg, args: args });
        }
        else {
            // ้ๅๆฒกๆๅจๆง่ก๏ผ็ดๆฅๆง่ก
            ctx.operating = true;
            fn.apply(thisArg, args);
        }
    }
    exports.wait = wait;
    /**
     * ๅฎๆไธๆญฅๆไฝๅนถๅค้ๅ็ปญๆไฝ
     *
     * @export
     * @param {string} name ้ๅๅๅญ
     * @returns {void}
     */
    function notify(name) {
        var ctx = _cache[name];
        if (ctx == null || ctx.datas.length <= 0) {
            // ้ๅๆง่กๅฎไบ๏ผ็ดๆฅ็ปๆ
            ctx.operating = false;
            return;
        }
        var data = ctx.datas.shift();
        data.fn.apply(data.thisArg, data.args);
    }
    exports.notify = notify;
});
define("src/trunk/engine/scene/SceneManager", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/scene/NoneScenePolicy", "src/trunk/engine/scene/SceneMessage", "src/trunk/utils/SyncUtil"], function (require, exports, Core_20, Injector_14, NoneScenePolicy_1, SceneMessage_1, SyncUtil_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-08
     * @modify date 2017-09-08
     *
     * ๅผน็ช็ฎก็ๅจ๏ผๅๅซๅๆขๅบๆฏใpushๅบๆฏใpopๅบๆฏๅ่ฝ
    */
    var SYNC_NAME = "SceneManager_sync";
    var ChangeType;
    (function (ChangeType) {
        ChangeType[ChangeType["Switch"] = 0] = "Switch";
        ChangeType[ChangeType["Push"] = 1] = "Push";
        ChangeType[ChangeType["Pop"] = 2] = "Pop";
    })(ChangeType || (ChangeType = {}));
    var SceneManager = /** @class */ (function () {
        function SceneManager() {
            this._sceneStack = [];
        }
        Object.defineProperty(SceneManager.prototype, "currentScene", {
            /**
             * ่ทๅๅฝๅๅบๆฏ
             *
             * @readonly
             * @type {IScene}
             * @memberof SceneManager
             */
            get: function () {
                return this._sceneStack[0];
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(SceneManager.prototype, "activeCount", {
            /**
             * ่ทๅๆดปๅจๅบๆฏไธชๆฐ
             *
             * @readonly
             * @type {number}
             * @memberof SceneManager
             */
            get: function () {
                return this._sceneStack.length;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅๅบๆฏๆฏๅฆๅทฒ็ปๅผๅฏ
         *
         * @param {IScene} scene ๅบๆฏๅฏน่ฑก
         * @returns {boolean} ๆฏๅฆๅทฒ็ปๅผๅฏ
         * @memberof SceneManager
         */
        SceneManager.prototype.isOpened = function (scene) {
            return (this._sceneStack.indexOf(scene) >= 0);
        };
        /**
         * ๅๆขๅบๆฏ๏ผๆฟๆขๅฝๅๅบๆฏ๏ผๅฝๅๅบๆฏไผ่ขซ้ๆฏ
         *
         * @param {IScene} scene ่ฆๅๆขๅฐ็ๅบๆฏ
         * @param {*} [data] ่ฆๆบๅธฆ็ปไธไธไธชๅบๆฏ็ๆฐๆฎ
         * @returns {IScene} ๅบๆฏๆฌไฝ
         * @memberof SceneManager
         */
        SceneManager.prototype.switch = function (scene, data) {
            var _this = this;
            // ้็ฉบๅคๆญ
            if (scene == null)
                return;
            // ๅฆๆๅๅฅ็ๆฏ็ฌฌไธไธชๅบๆฏ๏ผๅๆน็จpushๆไฝ
            if (this.activeCount == 0)
                return this.push(scene, data);
            // ๅๆญฅๆง่ก
            SyncUtil_1.wait(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || NoneScenePolicy_1.default, ChangeType.Switch, function () {
                var lastScene = _this._sceneStack[0];
                // ๆฐๆฎๅ่ก
                _this._sceneStack[0] = scene;
                // ่ฐ็จๆฅๅฃ
                lastScene && lastScene.__close(data);
                scene.__open(data);
            });
            return scene;
        };
        /**
         * ๆจๅฅๅบๆฏ๏ผๅฝๅๅบๆฏไธไผ้ๆฏ๏ผ่ๆฏ่ฟๅฅๅบๆฏๆไฟๅญ๏ผไปฅๅๅฏไปฅ้่ฟpopScene้ๆฐๅฑ็ฐ
         *
         * @param {IScene} scene ่ฆๆจๅฅ็ๅบๆฏ
         * @param {*} [data] ่ฆๆบๅธฆ็ปไธไธไธชๅบๆฏ็ๆฐๆฎ
         * @returns {IScene} ๅบๆฏๆฌไฝ
         * @memberof SceneManager
         */
        SceneManager.prototype.push = function (scene, data) {
            var _this = this;
            // ้็ฉบๅคๆญ
            if (scene == null)
                return scene;
            // ๅๆญฅๆง่ก
            SyncUtil_1.wait(SYNC_NAME, this.doChange, this, this.currentScene, scene, data, scene.policy || scene.bridge.defaultScenePolicy || NoneScenePolicy_1.default, ChangeType.Push, function () {
                // ๆฐๆฎๅ่ก
                _this._sceneStack.unshift(scene);
                // ่ฐ็จๆฅๅฃ
                scene.__open(data);
            });
            return scene;
        };
        /**
         * ๅผนๅบๅบๆฏ๏ผๅฝๅๅบๆฏไผ่ขซ้ๆฏ๏ผๅฝๅไฝไบๆ้กถ็ๅบๆฏไผ้ๆฐๆพ็คบ
         *
         * @param {IScene} scene ่ฆๅๆขๅบ็ๅบๆฏ๏ผๅฆๆไผๅฅ็ๅบๆฏไธๆฏๅฝๅๅบๆฏๅไป็งป้คๆๅฎๅบๆฏ๏ผไธไผ่ฟ่กๅๆขๆไฝ
         * @param {*} [data] ่ฆๆบๅธฆ็ปไธไธไธชๅบๆฏ็ๆฐๆฎ
         * @returns {IScene} ๅบๆฏๆฌไฝ
         * @memberof SceneManager
         */
        SceneManager.prototype.pop = function (scene, data) {
            // ้็ฉบๅคๆญ
            if (scene == null)
                return scene;
            // ๅๆญฅๆง่ก
            SyncUtil_1.wait(SYNC_NAME, this.doPop, this, scene, data);
            return scene;
        };
        SceneManager.prototype.doPop = function (scene, data) {
            var _this = this;
            // ๅฆๆๆฒกๆ่ถณๅค็ๅบๆฏๅจๅคๅไปไน้ฝไธๅ
            if (this.activeCount <= 1) {
                console.log("ๅบๆฏๆไธญ็ๅบๆฏๆฐ้ไธ่ถณ๏ผๆๆณๆง่กpopๆไฝ");
                // ๅฎๆๆญฅ้ชค
                SyncUtil_1.notify(SYNC_NAME);
                return;
            }
            // ้ช่ฏๆฏๅฆๆฏๅฝๅๅบๆฏ๏ผไธๆฏๅ็ดๆฅ็งป้ค๏ผไธไฝฟ็จPolicy
            var to = this._sceneStack[1];
            var policy = scene.policy || scene.bridge.defaultScenePolicy || NoneScenePolicy_1.default;
            if (this._sceneStack.indexOf(scene) != 0) {
                to = null;
                policy = NoneScenePolicy_1.default;
            }
            // ๆง่กๅๆข
            this.doChange(scene, to, data, policy, ChangeType.Pop, function () {
                // ๆฐๆฎๅ่ก
                _this._sceneStack.splice(_this._sceneStack.indexOf(scene), 1);
            }, function () {
                // ่ฐ็จๆฅๅฃ
                scene.__close(data);
            });
        };
        SceneManager.prototype.doChange = function (from, to, data, policy, type, begin, complete) {
            // ๅฆๆfromๅtoๆไธไธชไธบnullๅpolicyไธบnone
            if (!from || !to)
                policy = NoneScenePolicy_1.default;
            // toๆๅฎ็ๅบๆฏๅฟ้กป่ฆๆพ็คบ
            if (to)
                to.bridge.htmlWrapper.style.display = "";
            // ๅฆๆ่ฆไบคๆฟ็ไธคไธชๅบๆฏไธๆฏๅไธไธช็ฑปๅ็ๅบๆฏ๏ผๅๅๆขHTMLWrapperๆพ็คบ๏ผไธPolicyไน้็จๆๅๆข็ญ็ฅ
            if (from && to && to.bridge.type != from.bridge.type) {
                from.bridge.htmlWrapper.style.display = "none";
                policy = NoneScenePolicy_1.default;
            }
            // ่ฐ็จๅ่ฐ
            begin && begin();
            // ่ทๅๆฅๅฃๅผ็จ
            var prepareFunc;
            var doFunc;
            switch (type) {
                case ChangeType.Switch:
                    prepareFunc = policy.prepareSwitch;
                    doFunc = policy.switch;
                    break;
                case ChangeType.Push:
                    prepareFunc = policy.preparePush || policy.prepareSwitch;
                    doFunc = policy.push || policy.switch;
                    break;
                case ChangeType.Pop:
                    prepareFunc = policy.preparePop || policy.prepareSwitch;
                    doFunc = policy.pop || policy.switch;
                    break;
            }
            // ๅ็ฝฎๅค็
            from && from.onBeforeOut(to, data);
            to && to.onBeforeIn(from, data);
            // ๆดพๅไบไปถ
            Core_20.core.dispatch(SceneMessage_1.default.SCENE_BEFORE_CHANGE, to, from);
            // ่ฐ็จๅๅคๆฅๅฃ
            prepareFunc && prepareFunc.call(policy, from, to);
            // ๆทปๅๆพ็คบ
            to && to.bridge.addChild(to.bridge.sceneLayer, to.skin);
            // ่ฐ็จๅๆขๆฅๅฃ
            doFunc.call(policy, from, to, function () {
                // ็งป้คๆพ็คบ
                from && from.bridge.removeChild(from.bridge.sceneLayer, from.skin);
                // ่ฐ็จๅ่ฐ
                complete && complete();
                // ๅ็ฝฎๅค็
                from && from.onAfterOut(to, data);
                to && to.onAfterIn(from, data);
                // ๆดพๅไบไปถ
                Core_20.core.dispatch(SceneMessage_1.default.SCENE_AFTER_CHANGE, to, from);
                // ๅฎๆๆญฅ้ชค
                SyncUtil_1.notify(SYNC_NAME);
            });
        };
        SceneManager = __decorate([
            Injector_14.Injectable
        ], SceneManager);
        return SceneManager;
    }());
    exports.default = SceneManager;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.sceneManager = Core_20.core.getInject(SceneManager);
});
define("src/trunk/engine/scene/SceneMediator", ["require", "exports", "src/trunk/engine/mediator/Mediator", "src/trunk/engine/scene/SceneManager"], function (require, exports, Mediator_2, SceneManager_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-08
     * @modify date 2017-09-08
     *
     * ๅฎ็ฐไบISceneๆฅๅฃ็ๅบๆฏไธญไป่ๅบ็ฑป
    */
    var SceneMediator = /** @class */ (function (_super) {
        __extends(SceneMediator, _super);
        function SceneMediator(skin, policy) {
            var _this = _super.call(this, skin) || this;
            _this.policy = policy;
            return _this;
        }
        /**
         * ๆๅผๅฝๅๅบๆฏ๏ผ็ธๅฝไบ่ฐ็จSceneManager.pushๆนๆณ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @returns {IScene} ๅบๆฏๆฌไฝ
         * @memberof SceneMediator
         */
        SceneMediator.prototype.open = function (data) {
            return SceneManager_1.sceneManager.push(this, data);
        };
        /**
         * ๆๅผๅฝๅๅบๆฏ๏ผๅช่ฝ็ฑSceneManager่ฐ็จ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @memberof SceneMediator
         */
        SceneMediator.prototype.__open = function (data) {
            _super.prototype.open.call(this, data);
        };
        /**
         * ๅณ้ญๅฝๅๅบๆฏ๏ผ็ธๅฝไบ่ฐ็จSceneManager.popๆนๆณ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @returns {IScene} ๅบๆฏๆฌไฝ
         * @memberof SceneMediator
         */
        SceneMediator.prototype.close = function (data) {
            return SceneManager_1.sceneManager.pop(this, data);
        };
        /**
         * ๅณ้ญๅฝๅๅบๆฏ๏ผๅช่ฝ็ฑSceneManager่ฐ็จ๏ผ
         *
         * @param {*} [data] ๆฐๆฎ
         * @memberof SceneMediator
         */
        SceneMediator.prototype.__close = function (data) {
            _super.prototype.close.call(this, data);
        };
        /**
         * ๅๅฅๅบๆฏๅผๅงๅ่ฐ็จ
         * @param fromScene ไปๅชไธชๅบๆฏๅๅฅ
         * @param data ๅๅบๆฏๆถๅฏ่ฝ็ๅๆฐ
         */
        SceneMediator.prototype.onBeforeIn = function (fromScene, data) {
            // ๅฏ้ๅ
        };
        /**
         * ๅๅฅๅบๆฏๅผๅงๅ่ฐ็จ
         * @param fromScene ไปๅชไธชๅบๆฏๅๅฅ
         * @param data ๅๅบๆฏๆถๅฏ่ฝ็ๅๆฐ
         */
        SceneMediator.prototype.onAfterIn = function (fromScene, data) {
            // ๅฏ้ๅ
        };
        /**
         * ๅๅบๅบๆฏๅผๅงๅ่ฐ็จ
         * @param toScene ่ฆๅๅฅๅฐๅชไธชๅบๆฏ
         * @param data ๅๅบๆฏๆถๅฏ่ฝ็ๅๆฐ
         */
        SceneMediator.prototype.onBeforeOut = function (toScene, data) {
            // ๅฏ้ๅ
        };
        /**
         * ๅๅบๅบๆฏๅผๅงๅ่ฐ็จ
         * @param toScene ่ฆๅๅฅๅฐๅชไธชๅบๆฏ
         * @param data ๅๅบๆฏๆถๅฏ่ฝ็ๅๆฐ
         */
        SceneMediator.prototype.onAfterOut = function (toScene, data) {
            // ๅฏ้ๅ
        };
        return SceneMediator;
    }(Mediator_2.default));
    exports.default = SceneMediator;
});
define("src/trunk/engine/module/Module", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/observable/Observable", "src/trunk/utils/Dictionary", "src/trunk/engine/module/ModuleManager", "src/trunk/utils/ConstructUtil"], function (require, exports, Core_21, Observable_2, Dictionary_5, ModuleManager_2, ConstructUtil_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-14
     * @modify date 2017-09-14
     *
     * ๆจกๅๅบ็ฑป
    */
    var Module = /** @class */ (function () {
        function Module() {
            this._disposed = false;
            this._mediators = [];
            this._disposeDict = new Dictionary_5.default();
            /*********************** ไธ้ขๆฏๆจกๅๆถๆฏ็ณป็ป ***********************/
            this._observable = new Observable_2.default();
        }
        Object.defineProperty(Module.prototype, "disposed", {
            /**
             * ่ทๅๆฏๅฆๅทฒ่ขซ้ๆฏ
             *
             * @readonly
             * @type {boolean}
             * @memberof Module
             */
            get: function () {
                return this._disposed;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Module.prototype, "bgMusic", {
            /**
             * ่ทๅ่ๆฏ้ณไนURL
             *
             * @readonly
             * @type {string}
             * @memberof Module
             */
            get: function () {
                return null;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Module.prototype, "dependModuleInstance", {
            /**
             * ๆๅฑ็ๆจกๅๅผ็จ
             *
             * @readonly
             * @type {IModule}
             * @memberof IMediator
             */
            get: function () {
                return this;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Module.prototype, "dependModule", {
            /**
             * ๆๅฑ็ๆจกๅ็ฑปๅ
             *
             * @readonly
             * @type {IModuleConstructor}
             * @memberof IMediator
             */
            get: function () {
                return ConstructUtil_2.getConstructor(this.constructor);
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Module.prototype, "delegatedMediators", {
            /**
             * ่ทๅๆๆๅทฒๆ็ฎก็ไธญไป่
             *
             * @returns {IModuleMediator[]} ๅทฒๆ็ฎก็ไธญไป่
             * @memberof Module
             */
            get: function () {
                return this._mediators;
            },
            enumerable: true,
            configurable: true
        });
        Module.prototype.disposeMediator = function (mediator) {
            // ๅๆถๆ็ฎก
            this.undelegateMediator(mediator);
            // ่ฐ็จๅๅง้ๆฏๆนๆณ
            mediator.dispose();
            // ๅฆๆๆๆๅทฒๆ็ฎก็ไธญไป่้ฝๅทฒ็ป่ขซ้ๆฏ๏ผๅ้ๆฏๅฝๅๆจกๅ
            if (this._mediators.length <= 0)
                this.dispose();
        };
        ;
        /**
         * ๆ็ฎกไธญไป่
         *
         * @param {IModuleMediator} mediator ไธญไป่
         * @memberof Module
         */
        Module.prototype.delegateMediator = function (mediator) {
            if (this._mediators.indexOf(mediator) < 0) {
                // ๆ็ฎกๆฐ็ไธญไป่
                this._mediators.push(mediator);
                // ็ฏกๆนdisposeๆนๆณ๏ผไปฅ็ๅฌๅถdispose
                if (mediator.hasOwnProperty("dispose"))
                    this._disposeDict.set(mediator, mediator.dispose);
                mediator.dispose = this.disposeMediator.bind(this, mediator);
            }
        };
        /**
         * ๅๆถๆ็ฎกไธญไป่
         *
         * @param {IModuleMediator} mediator ไธญไป่
         * @memberof Module
         */
        Module.prototype.undelegateMediator = function (mediator) {
            var index = this._mediators.indexOf(mediator);
            if (index >= 0) {
                // ๅๆถๆ็ฎกไธญไป่
                this._mediators.splice(index, 1);
                // ๆขๅคdisposeๆนๆณ๏ผๅๆถ็ๅฌdispose
                var oriDispose = this._disposeDict.get(mediator);
                if (oriDispose)
                    mediator.dispose = oriDispose;
                else
                    delete mediator.dispose;
                this._disposeDict.delete(mediator);
            }
        };
        /**
         * ๅคๆญๆๅฎไธญไป่ๆฏๅฆๅๅซๅจ่ฏฅๆจกๅ้
         *
         * @param {IModuleMediator} mediator ่ฆๅคๆญ็ไธญไป่
         * @returns {boolean} ๆฏๅฆๅๅซๅจ่ฏฅๆจกๅ้
         * @memberof Module
         */
        Module.prototype.constainsMediator = function (mediator) {
            return (this._mediators.indexOf(mediator) >= 0);
        };
        /**
         * ๅๅบๆจกๅๆ้CSS่ตๆบURL๏ผๅฏไปฅ้ๅ
         *
         * @returns {string[]} CSS่ตๆบๅ่กจ
         * @memberof Module
         */
        Module.prototype.listStyleFiles = function () {
            return null;
        };
        /**
         * ๅๅบๆจกๅๆ้JS่ตๆบURL๏ผๅฏไปฅ้ๅ
         *
         * @returns {string[]} js่ตๆบๅ่กจ
         * @memberof Module
         */
        Module.prototype.listJsFiles = function () {
            return null;
        };
        /**
         * ๅๅบๆจกๅๅๅงๅ่ฏทๆฑ๏ผๅฏไปฅ้ๅ
         *
         * @returns {RequestData[]} ๆจกๅ็ๅๅงๅ่ฏทๆฑๅ่กจ
         * @memberof Module
         */
        Module.prototype.listInitRequests = function () {
            return null;
        };
        /**
         * ๅฝๆจกๅ่ตๆบๅ่ฝฝๅฎๆฏๅ่ฐ็จ
         *
         * @param {Error} [err] ไปปไฝไธไธชMediator่ตๆบๅ่ฝฝๅบ้ไผ็ปๅบ่ฏฅ้่ฏฏๅฏน่ฑก๏ผๆฒก้ๅไธ็ป
         * @memberof Module
         */
        Module.prototype.onLoadAssets = function (err) {
        };
        /**
         * ๆๅผๆจกๅๆถ่ฐ็จ๏ผๅฏไปฅ้ๅ
         *
         * @param {*} [data] ไผ้็ปๆจกๅ็ๆฐๆฎ
         * @memberof Module
         */
        Module.prototype.onOpen = function (data) {
            // ่ฐ็จๆๆๅทฒๆ็ฎกไธญไป่็openๆนๆณ
            for (var _i = 0, _a = this._mediators; _i < _a.length; _i++) {
                var mediator = _a[_i];
                mediator.open(data);
            }
        };
        /**
         * ๅณ้ญๆจกๅๆถ่ฐ็จ๏ผๅฏไปฅ้ๅ
         *
         * @param {*} [data] ไผ้็ปๆจกๅ็ๆฐๆฎ
         * @memberof Module
         */
        Module.prototype.onClose = function (data) {
            // ่ฐ็จๆๆๅทฒๆ็ฎกไธญไป่็closeๆนๆณ
            for (var _i = 0, _a = this._mediators.concat(); _i < _a.length; _i++) {
                var mediator = _a[_i];
                mediator.close(data);
            }
        };
        /**
         * ๆจกๅๅๆขๅฐๅๅฐๆถ่ฐ็จ๏ผopenไนๅๆ่ๅถไปๆจกๅ่ขซๅณ้ญๆถ๏ผ๏ผๅฏไปฅ้ๅ
         *
         * @param {IModuleConstructor|undefined} from ไปๅชไธชๆจกๅๅๆข่ฟๆฅ
         * @param {*} [data] ไผ้็ปๆจกๅ็ๆฐๆฎ
         * @memberof Module
         */
        Module.prototype.onActivate = function (from, data) {
        };
        /**
         * ๆจกๅๅๆขๅฐๅๅฐๆฏ่ฐ็จ๏ผcloseไนๅๆ่ๅถไปๆจกๅๆๅผๆถ๏ผ๏ผๅฏไปฅ้ๅ
         *
         * @param {IModuleConstructor|undefined} to ่ฆๅๆขๅฐๅชไธชๆจกๅ
         * @param {*} [data] ไผ้็ปๆจกๅ็ๆฐๆฎ
         * @memberof Module
         */
        Module.prototype.onDeactivate = function (to, data) {
        };
        Module.prototype.dispatch = function (typeOrMsg) {
            var params = [];
            for (var _i = 1; _i < arguments.length; _i++) {
                params[_i - 1] = arguments[_i];
            }
            Core_21.core.dispatch.apply(Core_21.core, [typeOrMsg].concat(params));
        };
        Object.defineProperty(Module.prototype, "observable", {
            /**
             * ๆด้ฒIObservableๆฅๅฃ
             *
             * @readonly
             * @type {IObservable}
             * @memberof Module
             */
            get: function () {
                return this._observable;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ็ๅฌๆถๆฏ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof IModuleObservable
         */
        Module.prototype.listenModule = function (type, handler, thisArg) {
            this._observable.listen(type, handler, thisArg);
        };
        /**
         * ็งป้คๆถๆฏ็ๅฌ
         *
         * @param {string} type ๆถๆฏ็ฑปๅ
         * @param {Function} handler ๆถๆฏๅค็ๅฝๆฐ
         * @param {*} [thisArg] ๆถๆฏthisๆๅ
         * @memberof IModuleObservable
         */
        Module.prototype.unlistenModule = function (type, handler, thisArg) {
            this._observable.unlisten(type, handler, thisArg);
        };
        /**
         * ๆณจๅๅฝไปคๅฐ็นๅฎๆถๆฏ็ฑปๅไธ๏ผๅฝ่ฟไธช็ฑปๅ็ๆถๆฏๆดพๅๅฐๆกๆถๅๆธๆถไผ่งฆๅCommand่ฟ่ก
         *
         * @param {string} type ่ฆๆณจๅ็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ๏ผๅฏไปฅๆฏๆนๆณๅฝขๅผ๏ผไนๅฏไปฅไฝฟ็ฑปๅฝขๅผ
         * @memberof IModuleObservable
         */
        Module.prototype.mapCommandModule = function (type, cmd) {
            this._observable.mapCommand(type, cmd);
        };
        /**
         * ๆณจ้ๅฝไปค
         *
         * @param {string} type ่ฆๆณจ้็ๆถๆฏ็ฑปๅ
         * @param {(ICommandConstructor)} cmd ๅฝไปคๅค็ๅจ
         * @returns {void}
         * @memberof IModuleObservable
         */
        Module.prototype.unmapCommandModule = function (type, cmd) {
            this._observable.unmapCommand(type, cmd);
        };
        /** dispatchModuleๆนๆณๅฎ็ฐ */
        Module.prototype.dispatchModule = function () {
            var params = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                params[_i] = arguments[_i];
            }
            this._observable.dispatch.apply(this._observable, params);
        };
        /**
         * ้ๆฏๆจกๅ๏ผๅฏไปฅ้ๅ
         *
         * @memberof Module
         */
        Module.prototype.dispose = function () {
            if (this._disposed)
                return;
            // ๅณ้ญ่ช่บซ
            var cls = ConstructUtil_2.getConstructor(this.constructor);
            ModuleManager_2.moduleManager.close(cls);
            // ๅฆๆๆฒกๅณไธๅไธ้ๆฏ
            if (ModuleManager_2.moduleManager.isOpened(cls))
                return;
            // ๅฐๆๆๅทฒๆ็ฎก็ไธญไป่้ๆฏ
            for (var i = 0, len = this._mediators.length; i < len; i++) {
                var mediator = this._mediators.pop();
                this.undelegateMediator(mediator);
                mediator.dispose();
            }
            // ้ๆฏObservableๅฎไพ
            this._observable.dispose();
            this._observable = null;
            // ่ฎฐๅฝ
            this._disposed = true;
        };
        return Module;
    }());
    exports.default = Module;
});
define("src/trunk/engine/env/Explorer", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector"], function (require, exports, Core_22, Injector_15) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-05
     * @modify date 2017-09-05
     *
     * Explorer็ฑป่ฎฐๅฝๆต่งๅจ็ธๅณๆฐๆฎ
    */
    /**
     * ๆต่งๅจ็ฑปๅๆไธพ
     *
     * @enum {number}
     */
    var ExplorerType;
    (function (ExplorerType) {
        ExplorerType[ExplorerType["IE"] = 0] = "IE";
        ExplorerType[ExplorerType["EDGE"] = 1] = "EDGE";
        ExplorerType[ExplorerType["OPERA"] = 2] = "OPERA";
        ExplorerType[ExplorerType["FIREFOX"] = 3] = "FIREFOX";
        ExplorerType[ExplorerType["SAFARI"] = 4] = "SAFARI";
        ExplorerType[ExplorerType["CHROME"] = 5] = "CHROME";
        ExplorerType[ExplorerType["OTHERS"] = 6] = "OTHERS";
    })(ExplorerType = exports.ExplorerType || (exports.ExplorerType = {}));
    var Explorer = /** @class */ (function () {
        function Explorer() {
            //ๅๅพๆต่งๅจ็userAgentๅญ็ฌฆไธฒ
            var userAgent = navigator.userAgent;
            // ๅคๆญๆต่งๅจ็ฑปๅ
            var regExp;
            var result;
            if (window["ActiveXObject"] != null) {
                // IEๆต่งๅจ
                this._type = ExplorerType.IE;
                // ่ทๅIE็ๆฌๅท
                regExp = new RegExp("MSIE ([^ ;\\)]+);");
                result = regExp.exec(userAgent);
                if (result != null) {
                    // ๆฏIE8ไปฅๅ
                    this._version = result[1];
                }
                else {
                    // ๆฏIE9ไปฅๅ
                    regExp = new RegExp("rv:([^ ;\\)]+)");
                    result = regExp.exec(userAgent);
                    this._version = result[1];
                }
            }
            else if (userAgent.indexOf("Edge") > -1) {
                // Edgeๆต่งๅจ
                this._type = ExplorerType.EDGE;
                // ่ทๅEdge็ๆฌๅท
                regExp = new RegExp("Edge/([^ ;\\)]+)");
                result = regExp.exec(userAgent);
                this._version = result[1];
            }
            else if (userAgent.indexOf("Firefox") > -1) {
                // Firefoxๆต่งๅจ
                this._type = ExplorerType.FIREFOX;
                // ่ทๅFirefox็ๆฌๅท
                regExp = new RegExp("Firefox/([^ ;\\)]+)");
                result = regExp.exec(userAgent);
                this._version = result[1];
            }
            else if (userAgent.indexOf("Opera") > -1) {
                // Operaๆต่งๅจ
                this._type = ExplorerType.OPERA;
                // ่ทๅOpera็ๆฌๅท
                regExp = new RegExp("OPR/([^ ;\\)]+)");
                result = regExp.exec(userAgent);
                this._version = result[1];
            }
            else if (userAgent.indexOf("Chrome") > -1) {
                // Chromeๆต่งๅจ
                this._type = ExplorerType.CHROME;
                // ่ทๅCrhome็ๆฌๅท
                regExp = new RegExp("Chrome/([^ ;\\)]+)");
                result = regExp.exec(userAgent);
                this._version = result[1];
            }
            else if (userAgent.indexOf("Safari") > -1) {
                // Safariๆต่งๅจ
                this._type = ExplorerType.SAFARI;
                // ่ทๅSafari็ๆฌๅท
                regExp = new RegExp("Safari/([^ ;\\)]+)");
                result = regExp.exec(userAgent);
                this._version = result[1];
            }
            else {
                // ๅถไปๆต่งๅจ
                this._type = ExplorerType.OTHERS;
                // ้ๆ่ฎพ็ฝฎไธไธช็ๆฌๅท
                this._version = "0.0";
            }
            // ่ตๅผ็ฑปๅๅญ็ฌฆไธฒ
            this._typeStr = ExplorerType[this._type];
            // ่ตๅผๅคง็ๆฌๅท
            this._bigVersion = this._version.split(".")[0];
        }
        Object.defineProperty(Explorer.prototype, "type", {
            /**
             * ่ทๅๆต่งๅจ็ฑปๅๆไธพๅผ
             *
             * @readonly
             * @type {ExplorerType}
             * @memberof Explorer
             */
            get: function () {
                return this._type;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Explorer.prototype, "typeStr", {
            /**
             * ่ทๅๆต่งๅจ็ฑปๅๅญ็ฌฆไธฒ
             *
             * @readonly
             * @type {string}
             * @memberof Explorer
             */
            get: function () {
                return this._typeStr;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Explorer.prototype, "version", {
            /**
             * ่ทๅๆต่งๅจ็ๆฌ
             *
             * @readonly
             * @type {string}
             * @memberof Explorer
             */
            get: function () {
                return this._version;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Explorer.prototype, "bigVersion", {
            /**
             * ่ทๅๆต่งๅจๅคง็ๆฌ
             *
             * @readonly
             * @type {string}
             * @memberof Explorer
             */
            get: function () {
                return this._bigVersion;
            },
            enumerable: true,
            configurable: true
        });
        Explorer = __decorate([
            Injector_15.Injectable,
            __metadata("design:paramtypes", [])
        ], Explorer);
        return Explorer;
    }());
    exports.default = Explorer;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.explorer = Core_22.core.getInject(Explorer);
});
define("src/trunk/engine/env/WindowExternal", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector"], function (require, exports, Core_23, Injector_16) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-05
     * @modify date 2017-09-05
     *
     * External็ฑปไธบwindow.externalๅๆฐๅญๅธๅ่ฃ็ฑป
    */
    var WindowExternal = /** @class */ (function () {
        function WindowExternal() {
            this._params = {};
            // ๅค็window.external
            try {
                if (!(window.external && typeof window.external === "object")) {
                    window.external = {};
                }
            }
            catch (err) {
                window.external = {};
            }
            this._params = window.external;
        }
        Object.defineProperty(WindowExternal.prototype, "params", {
            /**
             * ่ทๅๅจ้จwindow.externalๅๆฐ
             *
             * @readonly
             * @type {{[key:string]:string}}
             * @memberof WindowExternal
             */
            get: function () {
                return this._params;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅwindow.externalไธญ็ๅๆฐ
         *
         * @param {string} key ๅๆฐๅ
         * @returns {*} ๅๆฐๅผ
         * @memberof External
         */
        WindowExternal.prototype.getParam = function (key) {
            return this._params[key];
        };
        WindowExternal = __decorate([
            Injector_16.Injectable,
            __metadata("design:paramtypes", [])
        ], WindowExternal);
        return WindowExternal;
    }());
    exports.default = WindowExternal;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.windowExternal = Core_23.core.getInject(WindowExternal);
});
define("src/trunk/engine/env/Hash", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector"], function (require, exports, Core_24, Injector_17) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * Hash็ฑปๆฏๅฐๅ่ทฏ็ฑ๏ผ็ฝ้กตๅๅธ๏ผ็ฎก็ๅจ๏ผ่งๅฎๅๅธๆผๅผไธบ๏ผ#[ๆจกๅๅ]?[ๅๆฐๅ]=[ๅๆฐๅผ]&[ๅๆฐๅ]=[ๅๆฐๅผ]&...
    */
    var Hash = /** @class */ (function () {
        function Hash() {
            this._params = {};
            this._direct = false;
            this._keepHash = false;
            this._hash = window.location.hash;
            var reg = /#([^\?&]+)(\?([^\?&=]+=[^\?&=]+)(&([^\?&=]+=[^\?&=]+))*)?/;
            var result = reg.exec(this._hash);
            if (result) {
                // ่งฃๆๆจกๅๅ็งฐ
                this._moduleName = result[1];
                // ่งฃๆๆจกๅๅๆฐ
                var paramsStr = result[2];
                if (paramsStr != null) {
                    paramsStr = paramsStr.substr(1);
                    var params = paramsStr.split("&");
                    for (var i = 0, len = params.length; i < len; i++) {
                        var pair = params[i];
                        if (pair != null) {
                            var temp = pair.split("=");
                            // ้ฎๅๅผ้ฝ่ฆๅไธๆฌกURL่งฃ็
                            var key = decodeURIComponent(temp[0]);
                            var value = decodeURIComponent(temp[1]);
                            this._params[key] = value;
                        }
                    }
                }
                // ๅค็directๅๆฐ
                this._direct = (this._params.direct == "true");
                delete this._params.direct;
                // ๅค็keepHashๅๆฐ
                this._keepHash = (this._params.keepHash == "true");
                delete this._params.keepHash;
                // ๅฆๆkeepHashไธๆฏtrue๏ผๅ็งป้คๅๅธๅผ
                if (!this._keepHash)
                    window.location.hash = "";
            }
        }
        Object.defineProperty(Hash.prototype, "hash", {
            /**
             * ่ทๅๅๅง็ๅๅธๅญ็ฌฆไธฒ
             *
             * @readonly
             * @type {string}
             * @memberof Hash
             */
            get: function () {
                return this._hash;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Hash.prototype, "moduleName", {
            /**
             * ่ทๅๆจกๅๅ
             *
             * @readonly
             * @type {string}
             * @memberof Hash
             */
            get: function () {
                return this._moduleName;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Hash.prototype, "params", {
            /**
             * ่ทๅไผ้็ปๆจกๅ็ๅๆฐ
             *
             * @readonly
             * @type {{[key:string]:string}}
             * @memberof Hash
             */
            get: function () {
                return this._params;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Hash.prototype, "direct", {
            /**
             * ่ทๅๆฏๅฆ็ดๆฅ่ทณ่ฝฌๆจกๅ
             *
             * @readonly
             * @type {boolean}
             * @memberof Hash
             */
            get: function () {
                return this._direct;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(Hash.prototype, "keepHash", {
            /**
             * ่ทๅๆฏๅฆไฟๆๅๅธๅผ
             *
             * @readonly
             * @type {boolean}
             * @memberof Hash
             */
            get: function () {
                return this._keepHash;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅๆๅฎๅๅธๅๆฐ
         *
         * @param {string} key ๅๆฐๅ
         * @returns {string} ๅๆฐๅผ
         * @memberof Hash
         */
        Hash.prototype.getParam = function (key) {
            return this._params[key];
        };
        Hash = __decorate([
            Injector_17.Injectable,
            __metadata("design:paramtypes", [])
        ], Hash);
        return Hash;
    }());
    exports.default = Hash;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.hash = Core_24.core.getInject(Hash);
});
define("src/trunk/engine/env/Query", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector"], function (require, exports, Core_25, Injector_18) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-05
     * @modify date 2017-09-05
     *
     * Query็ฑป่ฎฐๅฝ้่ฟGETๅๆฐไผ้็ปๆกๆถ็ๅๆฐๅญๅธ
    */
    var Query = /** @class */ (function () {
        function Query() {
            this._params = {};
            var query = window.location.search.substr(1);
            var vars = query.split('&');
            for (var i = 0, len = vars.length; i < len; i++) {
                var pair = vars[i].split('=', 2);
                if (pair.length != 2 || !pair[0])
                    continue;
                var name = pair[0];
                var value = pair[1];
                name = decodeURIComponent(name);
                value = decodeURIComponent(value);
                // decode twice for ios
                name = decodeURIComponent(name);
                value = decodeURIComponent(value);
                this._params[name] = value;
            }
        }
        Object.defineProperty(Query.prototype, "params", {
            /**
             * ่ทๅๅจ้จQueryๅๆฐ
             *
             * @readonly
             * @type {{[key:string]:string}}
             * @memberof Query
             */
            get: function () {
                return this._params;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ่ทๅGETๅๆฐ
         *
         * @param {string} key ๅๆฐkey
         * @returns {string} ๅๆฐๅผ
         * @memberof Query
         */
        Query.prototype.getParam = function (key) {
            return this._params[key];
        };
        Query = __decorate([
            Injector_18.Injectable,
            __metadata("design:paramtypes", [])
        ], Query);
        return Query;
    }());
    exports.default = Query;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.query = Core_25.core.getInject(Query);
});
define("src/trunk/engine/net/policies/HTTPRequestPolicy", ["require", "exports", "src/trunk/utils/HTTPUtil", "src/trunk/engine/env/Environment", "src/trunk/engine/net/NetManager", "src/trunk/utils/ObjectUtil"], function (require, exports, HTTPUtil_2, Environment_5, NetManager_3, ObjectUtil_8) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-11
     * @modify date 2017-09-11
     *
     * HTTP่ฏทๆฑ็ญ็ฅ
    */
    var HTTPRequestPolicy = /** @class */ (function () {
        function HTTPRequestPolicy() {
        }
        /**
         * ๅ้่ฏทๆฑ้ป่พ
         *
         * @param {RequestData} request ่ฏทๆฑๆฐๆฎ
         * @memberof HTTPRequestPolicy
         */
        HTTPRequestPolicy.prototype.sendRequest = function (request) {
            // ๅๅฐๅๆฐ
            var params = request.__params;
            // ไฟฎๆนๆฐๆฎ
            var httpParams = ObjectUtil_8.extendObject({
                url: Environment_5.environment.toHostURL(params.path, params.hostIndex),
                onResponse: function (result) { return NetManager_3.netManager.__onResponse(request.__params.response.type, result, request); },
                onError: function (err) { return NetManager_3.netManager.__onError(err, request); },
                headerDict: {}
            }, params);
            // ajax่ฏทๆฑ้ฝ็ปไธ่ฎพ็ฝฎwithCredentials
            httpParams.headerDict["withCredentials"] = "true";
            // ๅ้
            HTTPUtil_2.load(httpParams);
        };
        return HTTPRequestPolicy;
    }());
    exports.HTTPRequestPolicy = HTTPRequestPolicy;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅฎไพ */
    exports.default = new HTTPRequestPolicy();
});
define("src/trunk/engine/plugin/IPlugin", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
});
define("src/trunk/engine/injector/Injector", ["require", "exports", "src/trunk/core/injector/Injector", "src/trunk/core/message/Message", "src/trunk/utils/ConstructUtil", "src/trunk/engine/net/ResponseData", "src/trunk/engine/net/NetManager", "src/trunk/engine/bridge/BridgeManager", "src/trunk/engine/mediator/Mediator", "src/trunk/engine/module/ModuleManager", "src/trunk/utils/Dictionary", "src/trunk/engine/bind/BindManager"], function (require, exports, Injector_19, Message_3, ConstructUtil_3, ResponseData_1, NetManager_4, BridgeManager_3, Mediator_3, ModuleManager_3, Dictionary_6, BindManager_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-19
     * @modify date 2017-09-19
     *
     * ่ด่ดฃๆณจๅฅ็ๆจกๅ
    */
    /** ๅฎไนๆฐๆฎๆจกๅ๏ผๆฏๆๅฎไพๆณจๅฅ๏ผๅนถไธ่ช่บซไนไผ่ขซๆณจๅฅ */
    function ModelClass() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        // ่ฝฌ่ฐInjectableๆนๆณ
        if (this === undefined) {
            var cls = ConstructUtil_3.wrapConstruct(args[0]);
            Injector_19.Injectable.call(this, cls);
            return cls;
        }
        else {
            var result = Injector_19.Injectable.apply(this, args);
            return function (realCls) {
                realCls = ConstructUtil_3.wrapConstruct(realCls);
                result.call(this, realCls);
                return realCls;
            };
        }
    }
    exports.ModelClass = ModelClass;
    /** ๅฎไน็้ขไธญไป่๏ผๆฏๆๅฎไพๆณจๅฅ๏ผๅนถๅฏๆนๆฎๆ่ตๆพ็คบๅฏน่ฑก่ชๅจ่ฐๆดๆไฝฟ็จ็่กจ็ฐๅฑๆกฅ */
    function MediatorClass(cls) {
        // ๅคๆญไธไธMediatorๆฏๅฆๆdisposeๆนๆณ๏ผๆฒกๆ็่ฏๅผนไธไธช่ญฆๅ
        if (!cls.prototype.dispose)
            console.warn("Mediator[" + cls["name"] + "]ไธๅทๆdisposeๆนๆณ๏ผๅฏ่ฝไผ้ๆๅๅญ้ฎ้ข๏ผ่ฏท่ฎฉ่ฏฅMediatorๅฎ็ฐIDisposableๆฅๅฃ");
        // ็ๅฌๅฎไพๅ
        ConstructUtil_3.listenConstruct(cls, function (instance) {
            // ๆฟๆขsetSkinๆนๆณ
            var $skin;
            Object.defineProperty(instance, "skin", {
                configurable: true,
                enumerable: true,
                get: function () {
                    return $skin;
                },
                set: function (value) {
                    // ่ฎฐๅฝๅผ
                    $skin = value;
                    // ๆนๆฎskin็ฑปๅ้ๅ่กจ็ฐๅฑๆกฅ
                    this.bridge = BridgeManager_3.bridgeManager.getBridgeBySkin(value);
                }
            });
        });
        return ConstructUtil_3.wrapConstruct(cls);
    }
    exports.MediatorClass = MediatorClass;
    /** ๅฎไนๆจกๅ๏ผๆฏๆๅฎไพๆณจๅฅ */
    function ModuleClass(cls) {
        // ๅคๆญไธไธModuleๆฏๅฆๆdisposeๆนๆณ๏ผๆฒกๆ็่ฏๅผนไธไธช่ญฆๅ
        if (!cls.prototype.dispose)
            console.warn("Module[" + cls["name"] + "]ไธๅทๆdisposeๆนๆณ๏ผๅฏ่ฝไผ้ๆๅๅญ้ฎ้ข๏ผ่ฏท่ฎฉ่ฏฅModuleๅฎ็ฐIDisposableๆฅๅฃ");
        // ๅ่ฃ็ฑป
        var wrapperCls = ConstructUtil_3.wrapConstruct(cls);
        // ๆณจๅๆจกๅ
        ModuleManager_3.moduleManager.registerModule(wrapperCls);
        // ่ฟๅๅ่ฃ็ฑป
        return wrapperCls;
    }
    exports.ModuleClass = ModuleClass;
    function ModuleMessageHandler(target, key) {
        if (key) {
            var defs = Reflect.getMetadata("design:paramtypes", target, key);
            var resClass = defs[0];
            if (!(resClass.prototype instanceof Message_3.default))
                throw new Error("@ModuleMessageHandler่ฃ้ฅฐๅจ่ฃ้ฅฐ็ๆนๆณ็้ฆไธชๅๆฐๅฟ้กปๆฏMessage");
            doModuleMessageHandler(target.constructor, key, resClass);
        }
        else {
            return function (prototype, propertyKey, descriptor) {
                doModuleMessageHandler(prototype.constructor, propertyKey, target);
            };
        }
    }
    exports.ModuleMessageHandler = ModuleMessageHandler;
    ;
    function doModuleMessageHandler(cls, key, type) {
        // ็ๅฌๅฎไพๅ
        ConstructUtil_3.listenConstruct(cls, function (instance) {
            if (instance instanceof Mediator_3.default) {
                // ๅฆๆๆฏMediator๏ผๅ้่ฆ็ญๅฐ่ขซๆ็ฎกๅๅๆง่กๆณจๅ
                addDelegateHandler(instance, function () {
                    instance.dependModuleInstance.listenModule(type, instance[key], instance);
                });
            }
            else {
                var module = instance.dependModuleInstance;
                module && module.listenModule(type, instance[key], instance);
            }
        });
        // ็ๅฌ้ๆฏ
        ConstructUtil_3.listenDispose(cls, function (instance) {
            var module = instance.dependModuleInstance;
            module && module.unlistenModule(type, instance[key], instance);
        });
    }
    function ResponseHandler(target, key) {
        if (key) {
            var defs = Reflect.getMetadata("design:paramtypes", target, key);
            var resClass = defs[0];
            if (!(resClass.prototype instanceof ResponseData_1.default))
                throw new Error("ๆๅๆฐ@ResponseHandler่ฃ้ฅฐๅจ่ฃ้ฅฐ็ๆนๆณ็้ฆไธชๅๆฐๅฟ้กปๆฏResponseData");
            doResponseHandler(target.constructor, key, defs[0]);
        }
        else {
            return function (prototype, propertyKey, descriptor) {
                doResponseHandler(prototype.constructor, propertyKey, target);
            };
        }
    }
    exports.ResponseHandler = ResponseHandler;
    function doResponseHandler(cls, key, type) {
        // ็ๅฌๅฎไพๅ
        ConstructUtil_3.listenConstruct(cls, function (instance) {
            NetManager_4.netManager.listenResponse(type, instance[key], instance);
        });
        // ็ๅฌ้ๆฏ
        ConstructUtil_3.listenDispose(cls, function (instance) {
            NetManager_4.netManager.unlistenResponse(type, instance[key], instance);
        });
    }
    var delegateHandlerDict = new Dictionary_6.default();
    function addDelegateHandler(instance, handler) {
        if (!instance)
            return;
        var handlers = delegateHandlerDict.get(instance);
        if (!handlers)
            delegateHandlerDict.set(instance, handlers = []);
        if (handlers.indexOf(handler) < 0)
            handlers.push(handler);
    }
    /** ๅจModuleๅๆ็ฎกMediator */
    function DelegateMediator(prototype, propertyKey) {
        if (prototype.delegateMediator instanceof Function && prototype.undelegateMediator instanceof Function) {
            // ็ๅฌๅฎไพๅ
            ConstructUtil_3.listenConstruct(prototype.constructor, function (instance) {
                // ๅฎไพๅ
                var mediator = instance[propertyKey];
                if (mediator === undefined) {
                    var cls = Reflect.getMetadata("design:type", prototype, propertyKey);
                    instance[propertyKey] = mediator = new cls();
                }
                // ่ตๅผๆๅฑๆจกๅ
                mediator["_dependModuleInstance"] = instance;
                mediator["_dependModule"] = ConstructUtil_3.getConstructor(prototype.constructor);
                // ๆง่กๅ่ฐ
                var handlers = delegateHandlerDict.get(mediator);
                if (handlers) {
                    for (var _i = 0, handlers_1 = handlers; _i < handlers_1.length; _i++) {
                        var handler = handlers_1[_i];
                        handler(mediator);
                    }
                    // ็งป้ค่ฎฐๅฝ
                    delegateHandlerDict.delete(mediator);
                }
            });
            // ็ๅฌ้ๆฏ
            ConstructUtil_3.listenDispose(prototype.constructor, function (instance) {
                var mediator = instance[propertyKey];
                if (mediator) {
                    // ็งป้คๆๅฑๆจกๅ
                    mediator["_dependModuleInstance"] = undefined;
                    mediator["_dependModule"] = undefined;
                    // ็งป้คๅฎไพ
                    instance[propertyKey] = undefined;
                }
            });
            // ็ฏกๆนๅฑๆง
            var mediator;
            return {
                configurable: true,
                enumerable: true,
                get: function () {
                    return mediator;
                },
                set: function (value) {
                    if (value == mediator)
                        return;
                    // ๅๆถๆ็ฎกไธญไป่
                    if (mediator) {
                        this.undelegateMediator(mediator);
                    }
                    // ่ฎพ็ฝฎไธญไป่
                    mediator = value;
                    // ๆ็ฎกๆฐ็ไธญไป่
                    if (mediator) {
                        this.delegateMediator(mediator);
                    }
                }
            };
        }
    }
    exports.DelegateMediator = DelegateMediator;
    function listenOnOpen(prototype, propertyKey, before, after) {
        ConstructUtil_3.listenConstruct(prototype.constructor, function (mediator) {
            // ็ฏกๆนonOpenๆนๆณ
            var oriFunc = mediator.hasOwnProperty("onOpen") ? mediator.onOpen : null;
            mediator.onOpen = function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                // ่ฐ็จๅ่ฐ
                before && before(mediator);
                // ๆขๅคๅๅงๆนๆณ
                if (oriFunc)
                    mediator.onOpen = oriFunc;
                else
                    delete mediator.onOpen;
                // ่ฐ็จๅๅงๆนๆณ
                mediator.onOpen.apply(this, args);
                // ่ฐ็จๅ่ฐ
                after && after(mediator);
            };
        });
    }
    /**
     * @private
     */
    function BindValue(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                // ็ป็ปๅๆฐๅญๅธ
                var uiDict;
                if (typeof arg1 == "string") {
                    uiDict = {};
                    uiDict[arg1] = arg2;
                }
                else {
                    uiDict = arg1;
                }
                BindManager_2.bindManager.bindValue(mediator, uiDict, mediator[propertyKey]);
            });
        };
    }
    exports.BindValue = BindValue;
    /**
     * @private
     */
    function BindOn(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                // ็ป็ปๅๆฐๅญๅธ
                var evtDict;
                if (typeof arg1 == "string") {
                    evtDict = {};
                    evtDict[arg1] = arg2;
                }
                else {
                    evtDict = arg1;
                }
                BindManager_2.bindManager.bindOn(mediator, evtDict, mediator[propertyKey]);
            });
        };
    }
    exports.BindOn = BindOn;
    /**
     * @private
     */
    function BindIf(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                // ็ป็ปๅๆฐๅญๅธ
                var uiDict;
                if (typeof arg1 == "string") {
                    uiDict = {};
                    if (arg2)
                        uiDict[arg1] = arg2; // ๆnameๅฏปๅ
                    else
                        uiDict["$target"] = arg1; // ๆฒกๆnameๅฏปๅ๏ผ็ดๆฅ็ปๅฎ่กจ่พพๅผ
                }
                else {
                    uiDict = arg1;
                }
                BindManager_2.bindManager.bindIf(mediator, uiDict, mediator[propertyKey]);
            });
        };
    }
    exports.BindIf = BindIf;
    /**
     * @private
     */
    function BindMessage(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                if (typeof arg1 == "string" || arg1 instanceof Function) {
                    // ๆฏ็ฑปๅๆนๅผ
                    BindManager_2.bindManager.bindMessage(mediator, arg1, arg2, mediator[propertyKey]);
                }
                else {
                    // ๆฏๅญๅธๆนๅผ
                    for (var type in arg1) {
                        BindManager_2.bindManager.bindMessage(mediator, type, arg1[type], mediator[propertyKey]);
                    }
                }
            });
        };
    }
    exports.BindMessage = BindMessage;
    /**
     * @private
     */
    function BindModuleMessage(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                if (typeof arg1 == "string" || arg1 instanceof Function) {
                    // ๆฏ็ฑปๅๆนๅผ
                    BindManager_2.bindManager.bindMessage(mediator, arg1, arg2, mediator[propertyKey], mediator.observable);
                }
                else {
                    // ๆฏๅญๅธๆนๅผ
                    for (var type in arg1) {
                        BindManager_2.bindManager.bindMessage(mediator, type, arg1[type], mediator[propertyKey], mediator.observable);
                    }
                }
            });
        };
    }
    exports.BindModuleMessage = BindModuleMessage;
    /**
     * @private
     */
    function BindResponse(arg1, arg2) {
        return function (prototype, propertyKey) {
            // Response้่ฆๅจonOpenไนๅๆง่ก๏ผๅไธบๅฏ่ฝๆๅๅงๅๆถๆฏ้่ฆ็ปๅฎ๏ผ่ฆๅจonOpenๅๆไบviewModelๅ้ฆๆฌกๆดๆฐๆพ็คบ
            listenOnOpen(prototype, propertyKey, null, function (mediator) {
                if (typeof arg1 == "string" || arg1 instanceof Function) {
                    // ๆฏ็ฑปๅๆนๅผ
                    BindManager_2.bindManager.bindResponse(mediator, arg1, arg2, mediator[propertyKey]);
                }
                else {
                    // ๆฏๅญๅธๆนๅผ
                    for (var type in arg1) {
                        BindManager_2.bindManager.bindResponse(mediator, type, arg1[type], mediator[propertyKey]);
                    }
                }
            });
        };
    }
    exports.BindResponse = BindResponse;
    /**
     * @private
     */
    function BindModuleResponse(arg1, arg2) {
        return function (prototype, propertyKey) {
            listenOnOpen(prototype, propertyKey, function (mediator) {
                if (typeof arg1 == "string" || arg1 instanceof Function) {
                    // ๆฏ็ฑปๅๆนๅผ
                    BindManager_2.bindManager.bindResponse(mediator, arg1, arg2, mediator[propertyKey], mediator.observable);
                }
                else {
                    // ๆฏๅญๅธๆนๅผ
                    for (var type in arg1) {
                        BindManager_2.bindManager.bindResponse(mediator, type, arg1[type], mediator[propertyKey], mediator.observable);
                    }
                }
            });
        };
    }
    exports.BindModuleResponse = BindModuleResponse;
});
define("src/trunk/engine/Engine", ["require", "exports", "src/trunk/core/Core", "src/trunk/core/injector/Injector", "src/trunk/engine/bridge/BridgeManager", "src/trunk/engine/bridge/BridgeMessage", "src/trunk/engine/module/ModuleManager", "src/trunk/engine/assets/AssetsManager", "src/trunk/engine/env/Environment", "src/trunk/engine/env/Hash", "src/trunk/engine/version/Version", "src/trunk/engine/module/ModuleMessage"], function (require, exports, Core_26, Injector_20, BridgeManager_4, BridgeMessage_2, ModuleManager_4, AssetsManager_3, Environment_6, Hash_1, Version_3, ModuleMessage_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-06
     * @modify date 2017-09-06
     *
     * Engineๆจก็ปๆฏๅผๅๆกๆถ็ๅผๆ้จๅ๏ผๅๆฌไธๅกๆจกๅ็ณป็ปใๅบ็จ็จๅบๅฏๅจๅๅๅงๅใๅผน็ชๅๅบๆฏ็ฎก็ๅจ็ญไธ้กน็ฎๅผๅ็ธๅณ็้ป่พ้ฝๅจ่ฟไธชๆจก็ปไธญ
     * ่ฟไธชๆจก็ป็้ป่พ้ฝ้ซๅบฆ้ๆๅจๅญๆจก็ปไธญไบ๏ผๅๆญคไนๅชๆฏๆถ้็ธๅณๅญๆจก็ป
    */
    var Engine = /** @class */ (function () {
        function Engine() {
        }
        /**
         * ๅๅงๅEngine
         *
         * @param {IInitParams} params ๅๅงๅๅๆฐ
         * @memberof Engine
         */
        Engine.prototype.initialize = function (params) {
            var self = this;
            if (document.readyState == "loading")
                document.addEventListener("readystatechange", doInitialize);
            else
                doInitialize();
            function doInitialize() {
                // ็งป้คไบไปถ
                if (this == document)
                    document.removeEventListener("readystatechange", doInitialize);
                // ่ฆๅคๆญdocumentๆฏๅฆๅๅงๅๅฎๆฏ
                self._initParams = params;
                // ๅ่ฝฝ้กต
                self._loadElement = (typeof params.loadElement == "string" ? document.querySelector(params.loadElement) : params.loadElement);
                // ็ๅฌ้่ฏฏไบไปถ
                if (params.onError)
                    self.listenError(params.onError);
                // ๅๅงๅ็ฏๅขๅๆฐ
                Environment_6.environment.initialize(params.env, params.hostsDict, params.cdnsDict);
                // ๅๅงๅ็ๆฌๅทๅทฅๅท
                Version_3.version.initialize(function () {
                    // ็ๅฌBridgeๅๅงๅๅฎๆฏไบไปถ๏ผๆพ็คบ็ฌฌไธไธชๆจกๅ
                    Core_26.core.listen(BridgeMessage_2.default.BRIDGE_ALL_INIT, self.onAllBridgesInit, self);
                    // ๆณจๅๅนถๅๅงๅ่กจ็ฐๅฑๆกฅๅฎไพ
                    BridgeManager_4.bridgeManager.registerBridge.apply(BridgeManager_4.bridgeManager, params.bridges);
                });
            }
        };
        /**
         * ๆทปๅ้่ฏฏ็ๅฌๅฝๆฐ
         *
         * @param {(evt?:ErrorEvent)=>void} handler ้่ฏฏ็ๅฌๅฝๆฐ
         * @memberof Engine
         */
        Engine.prototype.listenError = function (handler) {
            if (handler)
                window.addEventListener("error", handler);
        };
        Engine.prototype.onAllBridgesInit = function () {
            // ๆณจ้็ๅฌ
            Core_26.core.unlisten(BridgeMessage_2.default.BRIDGE_ALL_INIT, this.onAllBridgesInit, this);
            // ๅๅงๅๆไปถ
            if (this._initParams.plugins) {
                for (var _i = 0, _a = this._initParams.plugins; _i < _a.length; _i++) {
                    var plugin = _a[_i];
                    plugin.initPlugin();
                }
            }
            // ๆณจๅ็ญๅ็งฐ
            AssetsManager_3.assetsManager.configPath(this._initParams.pathDict);
            // ๅผๅง้ขๅ่ฝฝ่ฟ็จ
            var preloads = this._initParams.preloads;
            if (preloads) {
                // ๅปๅ่ฝฝ
                AssetsManager_3.assetsManager.loadAssets(preloads, this.onPreloadOK.bind(this));
            }
            else {
                // ๆฒกๆ้ขๅ่ฝฝ๏ผ็ดๆฅๅฎๆ
                this.onPreloadOK();
            }
        };
        Engine.prototype.onPreloadOK = function () {
            // ่ฐ็จๅ่ฐ
            this._initParams.onInited && this._initParams.onInited();
            // ็ๅฌ้ฆไธชๆจกๅๅผๅฏ
            Core_26.core.listen(ModuleMessage_2.default.MODULE_CHANGE, this.onModuleChange, this);
            // ๆๅผ้ฆไธชๆจกๅ
            ModuleManager_4.moduleManager.open(this._initParams.firstModule);
            // ๅฆๆๆๅๅธๆจกๅๅๆๅผไน
            if (Hash_1.hash.moduleName)
                ModuleManager_4.moduleManager.open(Hash_1.hash.moduleName, Hash_1.hash.params, Hash_1.hash.direct);
        };
        Engine.prototype.onModuleChange = function (from) {
            // ๆณจ้็ๅฌ
            Core_26.core.unlisten(ModuleMessage_2.default.MODULE_CHANGE, this.onModuleChange, this);
            // ็งป้คloadElementๆพ็คบ
            if (this._loadElement) {
                var parent = this._loadElement.parentElement;
                parent && parent.removeChild(this._loadElement);
            }
        };
        Engine = __decorate([
            Injector_20.Injectable
        ], Engine);
        return Engine;
    }());
    exports.default = Engine;
    /** ๅ้ขๅคๅฏผๅบไธไธชๅไพ */
    exports.engine = Core_26.core.getInject(Engine);
});
/// <amd-module name="Olympus"/>
define("Olympus", ["require", "exports", "src/trunk/engine/Engine"], function (require, exports, Engine_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * Olympusๆกๆถไพฟๆทๅฏๅจไธๆกๆถๅค่งๆจกๅ
    */
    var Olympus = /** @class */ (function () {
        function Olympus() {
        }
        /**
         * ๅฏๅจOlympusๆกๆถ
         *
         * @static
         * @param {IInitParams} params ๅฏๅจๅๆฐ
         * @memberof Olympus
         */
        Olympus.startup = function (params) {
            // ๅๅงๅๅผๆๆจกๅ
            Engine_1.engine.initialize(params);
        };
        return Olympus;
    }());
    exports.default = Olympus;
});
define("src/branches/dom/mask/MaskEntity", ["require", "exports", "src/trunk/engine/bridge/BridgeManager", "DOMBridge"], function (require, exports, BridgeManager_5, DOMBridge_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-25
     * @modify date 2017-10-25
     *
     * DOM้ฎ็ฝฉๅฎ็ฐ
    */
    var MaskEntityImpl = /** @class */ (function () {
        function MaskEntityImpl(params) {
            this._showing = false;
            if (params) {
                if (typeof params.loadingSkin == "string") {
                    var temp = document.createElement("div");
                    temp.innerHTML = params.loadingSkin;
                    params.loadingSkin = temp;
                }
                this.loadingSkin = params.loadingSkin;
            }
            this.maskData = params || {};
        }
        /**
         * ๆพ็คบ้ฎ็ฝฉ
         */
        MaskEntityImpl.prototype.showMask = function (alpha) {
            // DOMๆกๆถไธ้่ฆ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
        };
        /**
         * ้่้ฎ็ฝฉ
         */
        MaskEntityImpl.prototype.hideMask = function () {
            // DOMๆกๆถไธ้่ฆ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบ้ฎ็ฝฉ*/
        MaskEntityImpl.prototype.isShowingMask = function () {
            // DOMๆกๆถไธ้่ฆ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
            return false;
        };
        /**
         * ๆพ็คบๅ่ฝฝๅพ
         */
        MaskEntityImpl.prototype.showLoading = function (alpha) {
            if (this.loadingSkin == null || this._showing)
                return;
            this._showing = true;
            // ๆพ็คบ
            var bridge = BridgeManager_5.bridgeManager.getBridge(DOMBridge_1.default.TYPE);
            bridge.addChild(bridge.maskLayer, this.loadingSkin);
        };
        /**
         * ้่ๅ่ฝฝๅพ
         */
        MaskEntityImpl.prototype.hideLoading = function () {
            if (this.loadingSkin == null || !this._showing)
                return;
            this._showing = false;
            // ้่
            var bridge = BridgeManager_5.bridgeManager.getBridge(DOMBridge_1.default.TYPE);
            bridge.removeChild(bridge.maskLayer, this.loadingSkin);
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบloading*/
        MaskEntityImpl.prototype.isShowingLoading = function () {
            return this._showing;
        };
        /** ๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
            // DOMๆกๆถไธ้่ฆๆจกๆ็ชๅฃ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
        };
        /** ้่ๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.hideModalMask = function (panel) {
            // DOMๆกๆถไธ้่ฆๆจกๆ็ชๅฃ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
        };
        /** ๅฝๅๆฏๅฆๅจๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
            // DOMๆกๆถไธ้่ฆๆจกๆ็ชๅฃ้ฎ็ฝฉ๏ผๅจ้จไพ่ตCSSๅฎ็ฐ
            return false;
        };
        return MaskEntityImpl;
    }());
    exports.default = MaskEntityImpl;
});
/// <amd-module name="DOMBridge"/>
define("DOMBridge", ["require", "exports", "src/trunk/utils/ObjectUtil", "src/trunk/engine/assets/AssetsManager", "src/branches/dom/mask/MaskEntity"], function (require, exports, ObjectUtil_9, AssetsManager_4, MaskEntity_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * ๅบไบDOM็่กจ็ฐๅฑๆกฅๅฎ็ฐ
    */
    var DOMBridge = /** @class */ (function () {
        function DOMBridge(params) {
            /**
             * ่ทๅ้ป่ฎคๅผน็ช็ญ็ฅ
             *
             * @type {IPanelPolicy}
             * @memberof EgretBridge
             */
            this.defaultPanelPolicy = null;
            /**
             * ่ทๅ้ป่ฎคๅบๆฏๅๆข็ญ็ฅ
             *
             * @type {IScenePolicy}
             * @memberof EgretBridge
             */
            this.defaultScenePolicy = null;
            this._listenerDict = {};
            this._initParams = params;
        }
        Object.defineProperty(DOMBridge.prototype, "type", {
            /**
             * ่ทๅ่กจ็ฐๅฑ็ฑปๅๅ็งฐ
             *
             * @readonly
             * @type {string}
             * @memberof DOMBridge
             */
            get: function () {
                return DOMBridge.TYPE;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "htmlWrapper", {
            /**
             * ่ทๅ่กจ็ฐๅฑHTMLๅ่ฃๅจ๏ผๅฏไปฅๅฏนๅถๆทๅผ่ฟ่ก่ชๅฎไน่ฐๆด
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "root", {
            /**
             * ่ทๅๆนๆพ็คบ่็น
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "stage", {
            /**
             * ่ทๅ่ๅฐๅผ็จ๏ผDOM็่ๅฐๆๅrootๆๅจ็Documentๅฏน่ฑก
             *
             * @readonly
             * @type {Document}
             * @memberof DOMBridge
             */
            get: function () {
                return this.root.ownerDocument;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "bgLayer", {
            /**
             * ่ทๅ่ๆฏๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "sceneLayer", {
            /**
             * ่ทๅๅบๆฏๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "frameLayer", {
            /**
             * ่ทๅๆกๆถๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "panelLayer", {
            /**
             * ่ทๅๅผน็ชๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "maskLayer", {
            /**
             * ่ทๅ้ฎ็ฝฉๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "topLayer", {
            /**
             * ่ทๅ้กถ็บงๅฎนๅจ
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "promptClass", {
            /**
             * ่ทๅ้็จๆ็คบๆก
             *
             * @readonly
             * @type {IPromptPanelConstructor}
             * @memberof DOMBridge
             */
            get: function () {
                return this._initParams.promptClass;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(DOMBridge.prototype, "maskEntity", {
            /**
             * ่ทๅ้ฎ็ฝฉๅฎไฝ
             *
             * @readonly
             * @type {IMaskEntity}
             * @memberof DOMBridge
             */
            get: function () {
                return new MaskEntity_1.default(this._initParams.maskData);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๅๅงๅ่กจ็ฐๅฑๆกฅ๏ผๅฏไปฅๆฒกๆ่ฏฅๆนๆณ๏ผๆฒกๆ่ฏฅๆนๆณๅ่กจ็คบ่ฏฅ่กจ็ฐๅฑๆ้ๅๅงๅ
         * @param {()=>void} complete ๅๅงๅๅฎๆฏๅ็ๅ่ฐ
         * @memberof DOMBridge
         */
        DOMBridge.prototype.init = function (complete) {
            // ๅฆๆๆฏๅ็งฐ๏ผๅ่ฝฌๅๆๅผ็จ
            if (typeof this._initParams.container == "string") {
                this._initParams.container = document.querySelector(this._initParams.container);
            }
            // ๅฆๆๆฏ็ฉบ๏ผๅ็ๆไธไธช
            if (!this._initParams.container) {
                this._initParams.container = document.createElement("div");
                document.body.appendChild(this._initParams.container);
            }
            // ่ฐ็จๅ่ฐ
            complete(this);
        };
        /**
         * ๅคๆญ็ฎ่คๆฏๅฆๆฏDOMๆพ็คบ่็น
         *
         * @param {*} skin ็ฎ่คๅฏน่ฑก
         * @returns {boolean} ๆฏๅฆๆฏDOMๆพ็คบ่็น
         * @memberof DOMBridge
         */
        DOMBridge.prototype.isMySkin = function (skin) {
            return (skin instanceof HTMLElement);
        };
        /**
         * ๅๅปบไธไธช็ฉบ็ๆพ็คบๅฏน่ฑก
         *
         * @returns {HTMLElement}
         * @memberof DOMBridge
         */
        DOMBridge.prototype.createEmptyDisplay = function () {
            return document.createElement("div");
        };
        /**
         * ๆทปๅๆพ็คบ
         *
         * @param {Element} parent ่ฆๆทปๅๅฐ็็ถๅฎนๅจ
         * @param {Element} target ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @return {Element} ่ฟๅ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.addChild = function (parent, target) {
            return parent.appendChild(target);
        };
        /**
         * ๆ็ดขๅผๆทปๅๆพ็คบ
         *
         * @param {Element} parent ่ฆๆทปๅๅฐ็็ถๅฎนๅจ
         * @param {Element} target ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @param {number} index ่ฆๆทปๅๅฐ็็ถ็บง็ดขๅผ
         * @return {Element} ่ฟๅ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.addChildAt = function (parent, target, index) {
            return parent.insertBefore(target, this.getChildAt(parent, index));
        };
        /**
         * ็งป้คๆพ็คบๅฏน่ฑก
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @param {Element} target ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @return {Element} ่ฟๅ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.removeChild = function (parent, target) {
            return parent.removeChild(target);
        };
        /**
         * ๆ็ดขๅผ็งป้คๆพ็คบ
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @param {number} index ็ดขๅผ
         * @return {Element} ่ฟๅ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.removeChildAt = function (parent, index) {
            return parent.removeChild(this.getChildAt(parent, index));
        };
        /**
         * ็งป้คๆๆๆพ็คบๅฏน่ฑก
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @memberof DOMBridge
         */
        DOMBridge.prototype.removeChildren = function (parent) {
            for (var i = 0, len = parent.children.length; i < len; i++) {
                parent.removeChild(parent.children.item(i));
            }
        };
        /**
         * ่ทๅ็ถๅฎนๅจ
         *
         * @param {Element} target ็ฎๆๅฏน่ฑก
         * @returns {Element} ็ถๅฎนๅจ
         * @memberof DOMBridge
         */
        DOMBridge.prototype.getParent = function (target) {
            return target.parentElement;
        };
        /**
         * ่ทๅๆๅฎ็ดขๅผๅค็ๆพ็คบๅฏน่ฑก
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @param {number} index ๆๅฎ็ถ็บง็ดขๅผ
         * @return {Element} ็ดขๅผๅค็ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.getChildAt = function (parent, index) {
            return parent.children.item(index);
        };
        /**
         * ่ทๅๆพ็คบ็ดขๅผ
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @param {Element} target ๅญๆพ็คบๅฏน่ฑก
         * @return {number} targetๅจparentไธญ็็ดขๅผ
         * @memberof DOMBridge
         */
        DOMBridge.prototype.getChildIndex = function (parent, target) {
            for (var i = 0, len = parent.children.length; i < len; i++) {
                if (target === parent.children.item(i))
                    return i;
            }
            return -1;
        };
        /**
         * ้่ฟๅ็งฐ่ทๅๆพ็คบๅฏน่ฑก
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @param {string} name ๅฏน่ฑกๅ็งฐ
         * @return {Element} ๆพ็คบๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.getChildByName = function (parent, name) {
            return parent.children.namedItem(name);
        };
        /**
         * ่ทๅๅญๆพ็คบๅฏน่ฑกๆฐ้
         *
         * @param {Element} parent ็ถๅฎนๅจ
         * @return {number} ๅญๆพ็คบๅฏน่ฑกๆฐ้
         * @memberof DOMBridge
         */
        DOMBridge.prototype.getChildCount = function (parent) {
            return parent.childElementCount;
        };
        /**
         * ๅ่ฝฝ่ตๆบ
         *
         * @param {string[]} assets ่ตๆบๆฐ็ป
         * @param {IMediator} mediator ่ตๆบๅ่กจ
         * @param {(err?:Error)=>void} handler ๅ่ฐๅฝๆฐ
         * @memberof DOMBridge
         */
        DOMBridge.prototype.loadAssets = function (assets, mediator, handler) {
            // ๅผๅงๅ่ฝฝ็ฎ่คๅ่กจ
            if (assets)
                assets = assets.concat();
            loadNext();
            function loadNext() {
                if (!assets || assets.length <= 0) {
                    // ่ฐ็จๅ่ฐ
                    handler();
                }
                else {
                    var skin = assets.shift();
                    AssetsManager_4.assetsManager.loadAssets(skin, function (result) {
                        if (result instanceof Error)
                            handler(result);
                        else
                            loadNext();
                    });
                }
            }
        };
        /**
         * ็ๅฌไบไปถ๏ผไป่ฟไธชๆนๆณ็ๅฌ็ไบไปถไผๅจไธญไป่้ๆฏๆถ่ขซ่ชๅจ็งป้ค็ๅฌ
         *
         * @param {EventTarget} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {(evt:Event)=>void} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.mapListener = function (target, type, handler, thisArg) {
            var key = ObjectUtil_9.getObjectHashs(target, type, handler, thisArg);
            // ๅคๆญๆฏๅฆๅทฒ็ปๅญๅจ่ฏฅ็ๅฌ๏ผๅฆๆๅญๅจๅไธๅ็ๅฌ
            if (this._listenerDict[key])
                return;
            // ็ๅฌ
            var listener = function (evt) {
                // ่ฐ็จๅ่ฐ
                handler.call(thisArg || this, evt);
            };
            target.addEventListener(type, listener);
            // ่ฎฐๅฝ็ๅฌ
            this._listenerDict[key] = listener;
        };
        /**
         * ๆณจ้็ๅฌไบไปถ
         *
         * @param {EventTarget} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {(evt:Event)=>void} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof DOMBridge
         */
        DOMBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
            var key = ObjectUtil_9.getObjectHashs(target, type, handler, thisArg);
            // ๅคๆญๆฏๅฆๅทฒ็ปๅญๅจ่ฏฅ็ๅฌ๏ผๅฆๆๅญๅจๅ็งป้ค็ๅฌ
            var listener = this._listenerDict[key];
            if (listener) {
                target.removeEventListener(type, listener);
                // ็งป้ค่ฎฐๅฝ
                delete this._listenerDict[key];
            }
        };
        /** ๆไพ้ๆ็ฑปๅๅธธ้ */
        DOMBridge.TYPE = "DOM";
        return DOMBridge;
    }());
    exports.default = DOMBridge;
});
define("src/branches/egret/RenderMode", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-19
     * @modify date 2017-09-19
     *
     * ๆธฒๆๆจกๅผๆไธพ
    */
    var RenderMode;
    (function (RenderMode) {
        RenderMode[RenderMode["AUTO"] = 0] = "AUTO";
        RenderMode[RenderMode["CANVAS"] = 1] = "CANVAS";
        RenderMode[RenderMode["WEBGL"] = 2] = "WEBGL";
    })(RenderMode || (RenderMode = {}));
    exports.default = RenderMode;
});
define("src/branches/egret/AssetsLoader", ["require", "exports", "src/trunk/engine/env/Environment", "src/trunk/engine/panel/PanelManager", "src/trunk/engine/platform/PlatformManager", "src/trunk/engine/version/Version"], function (require, exports, Environment_7, PanelManager_3, PlatformManager_1, Version_4) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var ResourceVersionController = /** @class */ (function (_super) {
        __extends(ResourceVersionController, _super);
        function ResourceVersionController() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        ResourceVersionController.prototype.getVirtualUrl = function (url) {
            // ๆทปๅimgDomain
            url = Environment_7.environment.toCDNHostURL(url);
            // ๆทปๅ็ๆฌๅท๏ผๆๅๅธๅผๅฐฑ็จๅๅธๅผๅ่ฝฝ๏ผๆฒกๆๅฐฑ็จ็ผ่ฏ็ๆฌๅทๅ่ฝฝ
            url = Version_4.version.wrapHashUrl(url);
            // ่ฟๅurl
            return url;
        };
        return ResourceVersionController;
    }(RES.VersionController));
    exports.ResourceVersionController = ResourceVersionController;
    // ่ฟ้็ดๆฅๆณจๅไธไธ
    RES.registerVersionController(new ResourceVersionController());
    var AssetsLoader = /** @class */ (function () {
        function AssetsLoader(handler) {
            this._retryDict = {};
            this._handler = handler;
        }
        AssetsLoader.prototype.loadGroups = function (groups) {
            // ่ฐ็จๅ่ฐ
            this._handler.start && this._handler.start();
            // ็ปๅๅฆๆๆฏ็ฉบๅญ็ฌฆไธฒๅไผๅฏผ่ดEgretไปไน้ฝไธๅนฒ๏ผๆไปฅ่ฆ็งป้ค็ฉบๅญ็ฌฆไธฒ็็ปๅ
            groups = groups && groups.filter(function (group) {
                if (typeof group == "string")
                    return (group != "");
                else
                    return (group.name != "");
            });
            // ๅผๅงๅ่ฝฝ
            var groupDict = {};
            var pgsDict;
            var len = groups ? groups.length : 0;
            if (len == 0) {
                this._handler.complete && this._handler.complete(groupDict);
            }
            else {
                RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                groups = groups.concat();
                pgsDict = {};
                for (var i in groups) {
                    var group = groups[i];
                    if (typeof group == "string") {
                        pgsDict[group] = 0;
                        RES.loadGroup(group);
                    }
                    else {
                        pgsDict[group.name] = 0;
                        RES.loadGroup(group.name, group.priority);
                    }
                }
            }
            function onProgress(evt) {
                // ๅกซๅ่ตๆบๅญๅธ
                var itemDict = groupDict[evt.groupName];
                if (!itemDict)
                    groupDict[evt.groupName] = itemDict = {};
                itemDict[evt.resItem.name] = evt.resItem;
                // ่ฎก็ฎๆป่ฟๅบฆ
                pgsDict[evt.groupName] = evt.itemsLoaded / evt.itemsTotal;
                var pgs = 0;
                for (var key in pgsDict) {
                    pgs += pgsDict[key];
                }
                pgs /= len;
                // ๅ่ฐ
                this._handler.progress && this._handler.progress(evt.resItem, pgs);
            }
            function onOneComplete(evt) {
                // ่ฐ็จๅไธๅฎๆฏๅ่ฐ
                this._handler.oneComplete && this._handler.oneComplete(groupDict[evt.groupName]);
                // ๆต่ฏๆฏๅฆๅจ้จๅฎๆฏ
                var index = groups.indexOf(evt.groupName);
                if (index >= 0) {
                    // ็งป้คๅ่ฝฝ็ปๅ
                    groups.splice(index, 1);
                    // ๅคๆญๆฏๅฆๅจ้จๅฎๆ
                    if (groups.length == 0) {
                        // ็งป้คไบไปถ็ๅฌ
                        RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS, onProgress, this);
                        RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE, onOneComplete, this);
                        RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR, onOneError, this);
                        // ่ฐ็จๅ่ฐ
                        this._handler.complete && this._handler.complete(groupDict);
                    }
                }
            }
            function onOneError(evt) {
                var groupName = evt.groupName;
                var retryTimes = this._retryDict[groupName];
                if (retryTimes == null)
                    retryTimes = 0;
                if (retryTimes < 3) {
                    this._retryDict[groupName] = ++retryTimes;
                    // ๆๅฐๆฅๅฟ
                    console.warn("ๅ่ฝฝๅคฑ่ดฅ๏ผ้่ฏ็ฌฌ" + retryTimes + "ๆฌก: " + groupName);
                    // ๆฒกๅฐๆๅคง้่ฏๆฌกๆฐ๏ผๅฐไธบurlๆทปๅไธไธช้ๆบๆถ้ดๆณ้ๆฐๅๅๅ่ฝฝ้ๅ
                    RES.loadGroup(evt.groupName);
                }
                else {
                    // ๆๅฐๆฅๅฟ
                    console.warn("ๅ่ฝฝๅคฑ่ดฅ3ๆฌก๏ผๆญฃๅจๅฐ่ฏๅๆขCDN...");
                    // ๅฐ่ฏๅๆขCDN
                    var allDone = Environment_7.environment.nextCDN();
                    if (!allDone) {
                        // ้ๆฐๅ่ฝฝ
                        RES.loadGroup(evt.groupName);
                    }
                    else {
                        // ่ฐ็จๆจกๆฟๆนๆณ
                        this._handler.oneError && this._handler.oneError(evt);
                        // ๅๆขCDNๅคฑ่ดฅไบ๏ผๅผนๅบๆ็คบ๏ผไฝฟ็จๆทๅฏไปฅๆๅจๅทๆฐ้กต้ข
                        PanelManager_3.panelManager.confirm("่ตๆบ็ปๅ่ฝฝๅคฑ่ดฅ[" + groupName + "]๏ผ็นๅป็กฎๅฎๅทๆฐ้กต้ข", function () {
                            PlatformManager_1.platformManager.reload();
                        });
                    }
                }
            }
        };
        return AssetsLoader;
    }());
    exports.default = AssetsLoader;
});
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-09-22
 * @modify date 2017-09-22
 *
 * Egret็ผๅจๅทฅๅท้๏ผ็จๆฅๅผฅ่กฅEgret็Tween็ไธ่ถณ
*/
define("src/branches/egret/utils/TweenUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    function tweenTo(target, props, duration, ease) {
        return egret.Tween.get(target).to(props, duration, ease);
    }
    exports.tweenTo = tweenTo;
    function tweenFrom(target, props, duration, ease) {
        // ๅฏนๆขๅๆฐ็ถๆ
        var toProps = {};
        for (var key in props) {
            toProps[key] = target[key];
            target[key] = props[key];
        }
        // ๅผๅง็ผๅจ
        return egret.Tween.get(target).to(toProps, duration, ease);
    }
    exports.tweenFrom = tweenFrom;
});
define("src/branches/egret/panel/BackPanelPolicy", ["require", "exports", "src/branches/egret/utils/TweenUtil"], function (require, exports, TweenUtil_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-22
     * @modify date 2017-09-22
     *
     * ๅๅผนๆๆ
    */
    var BackPanelPolicy = /** @class */ (function () {
        function BackPanelPolicy() {
        }
        /**
         * ๆพ็คบๆถ่ฐ็จ
         * @param panel ๅผนๅบๆกๅฏน่ฑก
         * @param callback ๅฎๆๅ่ฐ๏ผๅฟ้กป่ฐ็จ
         * @param from ๅจ็ป่ตทๅง็น
         */
        BackPanelPolicy.prototype.pop = function (panel, callback, from) {
            // ๅผๅงๅจ็ปๅผนๅบ
            var entity = panel.skin;
            egret.Tween.removeTweens(entity);
            // ๆขๅคไฝ็งฏ
            entity.scaleX = 1;
            entity.scaleY = 1;
            var fromX = 0;
            var fromY = 0;
            if (from != null) {
                fromX = from.x;
                fromY = from.y;
            }
            else {
                fromX = entity.stage.stageWidth * 0.5;
                fromY = entity.stage.stageHeight * 0.5;
            }
            // ๆดๆฐๅผนๅบๅไฝ็ฝฎ
            entity.x = fromX - entity.width * 0.5;
            entity.y = fromY - entity.height * 0.5;
            // ๅผๅง็ผๅจ
            TweenUtil_1.tweenFrom(entity, {
                x: fromX,
                y: fromY,
                scaleX: 0,
                scaleY: 0
            }, 300, egret.Ease.backOut).call(callback);
        };
        /**
         * ๅณ้ญๆถ่ฐ็จ
         * @param popup ๅผนๅบๆกๅฏน่ฑก
         * @param callback ๅฎๆๅ่ฐ๏ผๅฟ้กป่ฐ็จ
         * @param to ๅจ็ปๅฎ็ป็น
         */
        BackPanelPolicy.prototype.drop = function (panel, callback, to) {
            // ๅผๅงๅจ็ปๅณ้ญ
            var entity = panel.skin;
            egret.Tween.removeTweens(entity);
            var toX = 0;
            var toY = 0;
            if (to != null) {
                toX = to.x;
                toY = to.y;
            }
            else {
                toX = entity.x + entity.width * 0.5;
                toY = entity.y + entity.height * 0.5;
            }
            TweenUtil_1.tweenTo(entity, {
                x: toX,
                y: toY,
                scaleX: 0,
                scaleY: 0
            }, 300, egret.Ease.backIn).call(function () {
                // ๆขๅคไฝ็งฏ
                entity.scaleX = 1;
                entity.scaleY = 1;
                if (callback != null)
                    callback();
            });
        };
        return BackPanelPolicy;
    }());
    exports.default = BackPanelPolicy;
});
define("src/branches/egret/scene/FadeScenePolicy", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-22
     * @modify date 2017-09-22
     *
     * ๆทกๅฅๆทกๅบๅบๆฏๅๆข็ญ็ฅ
    */
    var FadeScenePolicy = /** @class */ (function () {
        function FadeScenePolicy() {
            this._tempSnapshot = new egret.Bitmap();
        }
        /**
         * ๅๅคๅๆขๅบๆฏๆถ่ฐๅบฆ
         * @param from ๅๅบ็ๅบๆฏ
         * @param to ๅๅฅ็ๅบๆฏ
         */
        FadeScenePolicy.prototype.prepareSwitch = function (from, to) {
            if (from != null) {
                var root = from.bridge.root;
                // ๆชๅๅฝๅๅฑๅน
                var texture = new egret.RenderTexture();
                texture.drawToTexture(root);
                this._tempSnapshot.texture = texture;
                this._tempSnapshot.alpha = 1;
                root.addChild(this._tempSnapshot);
                // ็งป้คfrom
                var fromDisplay = from.skin;
                if (fromDisplay.parent != null) {
                    fromDisplay.parent.removeChild(fromDisplay);
                }
            }
        };
        /**
         * ๅๆขๅบๆฏๆถ่ฐๅบฆ
         * @param from ๅๅบ็ๅบๆฏ
         * @param to ๅๅฅ็ๅบๆฏ
         * @param callback ๅๆขๅฎๆฏ็ๅ่ฐๆนๆณ
         */
        FadeScenePolicy.prototype.switch = function (from, to, callback) {
            if (from != null) {
                // ๅผๅงๆทกๅบ
                egret.Tween.removeTweens(this._tempSnapshot);
                egret.Tween.get(this._tempSnapshot).to({
                    alpha: 0
                }, 300).call(function () {
                    // ็งป้คๆชๅฑ
                    if (this._tempSnapshot.parent != null) {
                        this._tempSnapshot.parent.removeChild(this._tempSnapshot);
                    }
                    // ๅๆถ่ตๆบ
                    if (this._tempSnapshot.texture != null) {
                        this._tempSnapshot.texture.dispose();
                        this._tempSnapshot.texture = null;
                    }
                    // ่ฐ็จๅ่ฐ
                    callback();
                }, this);
            }
            else {
                // ็งป้คๆชๅฑ
                if (this._tempSnapshot.parent != null) {
                    this._tempSnapshot.parent.removeChild(this._tempSnapshot);
                }
                // ่ฐ็จๅ่ฐ
                callback();
            }
        };
        return FadeScenePolicy;
    }());
    exports.default = FadeScenePolicy;
});
/**
 * @author Raykid
 * @email initial_r@qq.com
 * @create date 2017-10-17
 * @modify date 2017-10-17
 *
 * UIๅทฅๅท้
*/
define("src/branches/egret/utils/UIUtil", ["require", "exports"], function (require, exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * ๅ่ฃEUI็DataGroup็ปไปถ๏ผไฝฟ็จไผๅฅ็ๅค็ๅฝๆฐๅค็ๆฏไธชๆธฒๆๅจๆดๆฐ็้ป่พ
     *
     * @export
     * @param {eui.DataGroup} group ่ขซๅ่ฃ็DataGroup็ปไปถ
     * @param {(data?:any, renderer?:any)=>void} rendererHandler ๆธฒๆๅจๅค็ๅฝๆฐ๏ผๆฏๆฌกๆฐๆฎๆดๆฐๆถไผ่ขซ่ฐ็จ
     */
    function wrapEUIList(group, rendererHandler) {
        group.itemRenderer = ItemRenderer.bind(null, group.itemRendererSkinName, rendererHandler);
    }
    exports.wrapEUIList = wrapEUIList;
    var ItemRenderer = /** @class */ (function (_super) {
        __extends(ItemRenderer, _super);
        function ItemRenderer(skinName, rendererHandler) {
            var _this = _super.call(this) || this;
            _this.skinName = skinName;
            _this._rendererHandler = rendererHandler;
            return _this;
        }
        ItemRenderer.prototype.dataChanged = function () {
            _super.prototype.dataChanged.call(this);
            this._rendererHandler(this.data, this);
        };
        return ItemRenderer;
    }(eui.ItemRenderer));
});
define("src/branches/egret/mask/MaskEntity", ["require", "exports", "src/trunk/engine/bridge/BridgeManager", "src/trunk/utils/Dictionary", "EgretBridge"], function (require, exports, BridgeManager_6, Dictionary_7, EgretBridge_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-25
     * @modify date 2017-10-25
     *
     * Egret้ฎ็ฝฉๅฎ็ฐ
    */
    var MaskEntityImpl = /** @class */ (function () {
        function MaskEntityImpl(params) {
            this._maskAlpha = 0.5;
            this._loadingAlpha = 0.5;
            this._modalPanelAlpha = 0.5;
            this._showingMask = false;
            this._showingLoading = false;
            if (params != null) {
                this._maskAlpha = (params.maskAlpha != null ? params.maskAlpha : 0.5);
                this._loadingAlpha = (params.loadingAlpha != null ? params.loadingAlpha : 0.5);
                this._modalPanelAlpha = (params.modalPanelAlpha != null ? params.modalPanelAlpha : 0.5);
                this._loadingSkinFactory = params.loadingSkinFactory;
            }
            this.maskData = params || {};
            this._mask = new egret.Shape();
            this._mask.touchEnabled = true;
            this._loadingMask = new egret.Shape();
            this._loadingMask.touchEnabled = true;
            this._modalPanelDict = new Dictionary_7.default();
            this._modalPanelList = [];
            this._modalPanelMask = new egret.Shape();
            this._modalPanelMask.touchEnabled = true;
        }
        Object.defineProperty(MaskEntityImpl.prototype, "loadingSkin", {
            get: function () {
                // ๅๅงๅ็ฎ่ค
                if (!this._loadingSkin && this._loadingSkinFactory)
                    this._loadingSkin = this._loadingSkinFactory();
                return this._loadingSkin;
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๆพ็คบ้ฎ็ฝฉ
         */
        MaskEntityImpl.prototype.showMask = function (alpha) {
            if (this._showingMask)
                return;
            this._showingMask = true;
            // ๆพ็คบ
            var bridge = BridgeManager_6.bridgeManager.getBridge(EgretBridge_1.default.TYPE);
            // ็ปๅถ้ฎ็ฝฉ
            if (alpha == null)
                alpha = this._maskAlpha;
            this._mask.graphics.clear();
            this._mask.graphics.beginFill(0, alpha);
            this._mask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
            this._mask.graphics.endFill();
            // ๆทปๅๆพ็คบ
            bridge.maskLayer.addChild(this._mask);
        };
        /**
         * ้่้ฎ็ฝฉ
         */
        MaskEntityImpl.prototype.hideMask = function () {
            if (!this._showingMask)
                return;
            this._showingMask = false;
            // ้่
            if (this._mask.parent != null)
                this._mask.parent.removeChild(this._mask);
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบ้ฎ็ฝฉ*/
        MaskEntityImpl.prototype.isShowingMask = function () {
            return this._showingMask;
        };
        /**
         * ๆพ็คบๅ่ฝฝๅพ
         */
        MaskEntityImpl.prototype.showLoading = function (alpha) {
            if (this._showingLoading)
                return;
            this._showingLoading = true;
            // ๆพ็คบ
            var bridge = BridgeManager_6.bridgeManager.getBridge(EgretBridge_1.default.TYPE);
            // ็ปๅถ้ฎ็ฝฉ
            if (alpha == null)
                alpha = this._loadingAlpha;
            this._loadingMask.graphics.clear();
            this._loadingMask.graphics.beginFill(0, alpha);
            this._loadingMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
            this._loadingMask.graphics.endFill();
            // ๆทปๅๆพ็คบ
            bridge.maskLayer.addChild(this._loadingMask);
            // ๆทปๅloading็ฎ่ค
            if (this.loadingSkin)
                bridge.maskLayer.addChild(this.loadingSkin);
        };
        /**
         * ้่ๅ่ฝฝๅพ
         */
        MaskEntityImpl.prototype.hideLoading = function () {
            if (!this._showingLoading)
                return;
            this._showingLoading = false;
            // ้่
            if (this._loadingMask.parent != null)
                this._loadingMask.parent.removeChild(this._loadingMask);
            if (this.loadingSkin != null && this.loadingSkin.parent != null)
                this.loadingSkin.parent.removeChild(this._loadingSkin);
        };
        /**ๅฝๅๆฏๅฆๅจๆพ็คบloading*/
        MaskEntityImpl.prototype.isShowingLoading = function () {
            return this._showingLoading;
        };
        /** ๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.showModalMask = function (panel, alpha) {
            if (this.isShowingModalMask(panel))
                return;
            this._modalPanelDict.set(panel, panel);
            this._modalPanelList.push(panel);
            // ๆพ็คบ
            var bridge = BridgeManager_6.bridgeManager.getBridge(EgretBridge_1.default.TYPE);
            // ็ปๅถ้ฎ็ฝฉ
            if (alpha == null)
                alpha = this._modalPanelAlpha;
            this._modalPanelMask.graphics.clear();
            this._modalPanelMask.graphics.beginFill(0, alpha);
            this._modalPanelMask.graphics.drawRect(0, 0, bridge.root.stage.stageWidth, bridge.root.stage.stageHeight);
            this._modalPanelMask.graphics.endFill();
            // ๆทปๅๆพ็คบ
            var entity = panel.skin;
            var parent = entity.parent;
            if (parent != null) {
                if (this._modalPanelMask.parent) {
                    this._modalPanelMask.parent.removeChild(this._modalPanelMask);
                }
                var index = parent.getChildIndex(entity);
                parent.addChildAt(this._modalPanelMask, index);
            }
        };
        /** ้่ๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.hideModalMask = function (panel) {
            if (!this.isShowingModalMask(panel))
                return;
            this._modalPanelDict.delete(panel);
            this._modalPanelList.splice(this._modalPanelList.indexOf(panel), 1);
            // ๅคๆญๆฏๅฆ่ฟ้่ฆMask
            if (this._modalPanelList.length <= 0) {
                // ้่
                if (this._modalPanelMask.parent != null)
                    this._modalPanelMask.parent.removeChild(this._modalPanelMask);
            }
            else {
                // ็งปๅจMask
                var entity = this._modalPanelList[this._modalPanelList.length - 1].skin;
                var parent = entity.parent;
                if (parent != null) {
                    if (this._modalPanelMask.parent) {
                        this._modalPanelMask.parent.removeChild(this._modalPanelMask);
                    }
                    var index = parent.getChildIndex(entity);
                    parent.addChildAt(this._modalPanelMask, index);
                }
            }
        };
        /** ๅฝๅๆฏๅฆๅจๆพ็คบๆจกๆ็ชๅฃ้ฎ็ฝฉ */
        MaskEntityImpl.prototype.isShowingModalMask = function (panel) {
            return (this._modalPanelDict.get(panel) != null);
        };
        return MaskEntityImpl;
    }());
    exports.default = MaskEntityImpl;
});
/// <amd-module name="EgretBridge"/>
define("EgretBridge", ["require", "exports", "src/trunk/core/Core", "src/trunk/engine/module/ModuleMessage", "src/branches/egret/RenderMode", "src/branches/egret/AssetsLoader", "src/branches/egret/panel/BackPanelPolicy", "src/branches/egret/scene/FadeScenePolicy", "src/branches/egret/mask/MaskEntity"], function (require, exports, Core_27, ModuleMessage_3, RenderMode_1, AssetsLoader_1, BackPanelPolicy_1, FadeScenePolicy_1, MaskEntity_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * Egret็่กจ็ฐๅฑๆกฅๅฎ็ฐ๏ผๅฝๅEgret็ๆฌ๏ผ5.0.7
    */
    var EgretBridge = /** @class */ (function () {
        function EgretBridge(params) {
            /**
             * ้ป่ฎคๅผน็ช็ญ็ฅ
             *
             * @type {IPanelPolicy}
             * @memberof EgretBridge
             */
            this.defaultPanelPolicy = new BackPanelPolicy_1.default();
            /**
             * ้ป่ฎคๅบๆฏๅๆข็ญ็ฅ
             *
             * @type {IScenePolicy}
             * @memberof EgretBridge
             */
            this.defaultScenePolicy = new FadeScenePolicy_1.default();
            this._initParams = params;
        }
        Object.defineProperty(EgretBridge.prototype, "type", {
            /**
             * ่ทๅ่กจ็ฐๅฑ็ฑปๅๅ็งฐ
             *
             * @readonly
             * @type {string}
             * @memberof EgretBridge
             */
            get: function () {
                return EgretBridge.TYPE;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "htmlWrapper", {
            /**
             * ่ทๅ่กจ็ฐๅฑHTMLๅ่ฃๅจ๏ผๅฏไปฅๅฏนๅถๆทๅผ่ฟ่ก่ชๅฎไน่ฐๆด
             *
             * @readonly
             * @type {HTMLElement}
             * @memberof EgretBridge
             */
            get: function () {
                return this._initParams.container;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "root", {
            /**
             * ่ทๅๆนๆพ็คบ่็น
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._root;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "stage", {
            /**
             * ่ทๅ่ๅฐๅผ็จ
             *
             * @readonly
             * @type {egret.Stage}
             * @memberof EgretBridge
             */
            get: function () {
                return this._stage;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "bgLayer", {
            /**
             * ่ทๅ่ๆฏๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._bgLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "sceneLayer", {
            /**
             * ่ทๅๅบๆฏๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._sceneLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "frameLayer", {
            /**
             * ่ทๅๆกๆถๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._frameLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "panelLayer", {
            /**
             * ่ทๅๅผน็ชๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._panelLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "maskLayer", {
            /**
             * ่ทๅ้ฎ็ฝฉๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._maskLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "topLayer", {
            /**
             * ่ทๅ้กถ็บงๅฎนๅจ
             *
             * @readonly
             * @type {egret.DisplayObjectContainer}
             * @memberof EgretBridge
             */
            get: function () {
                return this._topLayer;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "promptClass", {
            /**
             * ่ทๅ้็จๆ็คบๆก
             *
             * @readonly
             * @type {IPromptPanelConstructor}
             * @memberof EgretBridge
             */
            get: function () {
                return this._initParams.promptClass;
            },
            enumerable: true,
            configurable: true
        });
        Object.defineProperty(EgretBridge.prototype, "maskEntity", {
            /**
             * ่ทๅ้ฎ็ฝฉๅฎไฝ
             *
             * @readonly
             * @type {IMaskEntity}
             * @memberof EgretBridge
             */
            get: function () {
                return new MaskEntity_2.default(this._initParams.maskData);
            },
            enumerable: true,
            configurable: true
        });
        /**
         * ๅๅงๅ่กจ็ฐๅฑๆกฅ
         * @param {()=>void} complete ๅๅงๅๅฎๆฏๅ็ๅ่ฐ
         * @memberof EgretBridge
         */
        EgretBridge.prototype.init = function (complete) {
            // ็ๆhtmlๅbody็ๆทๅผ่็น
            var style = document.createElement("style");
            style.textContent = "\n            html, body {\n                -ms-touch-action: none;\n                background: " + egret.toColorString(this._initParams.backgroundColor || 0) + ";\n                padding: 0;\n                border: 0;\n                margin: 0;\n                height: 100%;\n            }\n        ";
            document.head.appendChild(style);
            // ็ปไธๅฎนๅจ
            if (typeof this._initParams.container == "string") {
                this._initParams.container = document.querySelector(this._initParams.container);
            }
            if (!this._initParams.container) {
                this._initParams.container = document.createElement("div");
                document.body.appendChild(this._initParams.container);
            }
            var container = this._initParams.container;
            // ๆๅปบๅฎนๅจๅๆฐ
            container.style.margin = "auto";
            container.style.width = "100%";
            container.style.height = "100%";
            container.className = "egret-player";
            container.setAttribute("data-entry-class", "__EgretRoot__");
            container.setAttribute("data-orientation", "auto");
            container.setAttribute("data-scale-mode", this._initParams.scaleMode || egret.StageScaleMode.FIXED_NARROW);
            container.setAttribute("data-frame-rate", (this._initParams.frameRate || 60) + "");
            container.setAttribute("data-content-width", this._initParams.width + "");
            container.setAttribute("data-content-height", this._initParams.height + "");
            container.setAttribute("data-show-paint-rect", (this._initParams.showPaintRect || false) + "");
            container.setAttribute("data-multi-fingered", (this._initParams.multiFingered || 2) + "");
            container.setAttribute("data-show-fps", (this._initParams.showFPS || false) + "");
            container.setAttribute("data-show-fps-style", this._initParams.showFPSStyle || "x:0,y:0,size:12,textColor:0xffffff,bgAlpha:0.9");
            container.setAttribute("data-show-log", (this._initParams.showLog || false) + "");
            // ๆๅปบ__EgretRoot__็ฑป๏ผไฝฟๅพEgretๅผๆๅฏไปฅ้่ฟwindowๅฏปๅ็ๆนๅผๆพๅฐ่ฏฅ็ฑป๏ผๅๆถๅๅฏไปฅ่ฎฉๅถๅฐๆงๅถๆ่ฝฌไบค็ปApplication
            var self = this;
            window["__EgretRoot__"] = function () {
                eui.UILayer.call(this);
                this.touchEnabled = false;
            };
            window["__EgretRoot__"].prototype = new eui.UILayer();
            window["__EgretRoot__"].prototype.$onAddToStage = function (stage, nestLevel) {
                // ่ฐ็จ็ถ็ฑปๆนๆณ
                eui.UILayer.prototype.$onAddToStage.call(this, stage, nestLevel);
                // ็งป้คๅผ็จ
                delete window["__EgretRoot__"];
                // ๅฐๆงๅถๆ็งปไบค็ปApplicationๅฏน่ฑก
                onRootInitialized(this);
            };
            // ๆนๆฎๆธฒๆๆจกๅผๅๅงๅEgretๅผๆ
            switch (this._initParams.renderMode) {
                case RenderMode_1.default.WEBGL:
                    initEgret("webgl");
                    break;
                case RenderMode_1.default.CANVAS:
                default:
                    initEgret("canvas");
                    break;
            }
            function initEgret(renderMode) {
                // ๅฏๅจEgretๅผๆ
                egret.runEgret({
                    renderMode: renderMode,
                    audioType: 0
                });
            }
            function onRootInitialized(root) {
                self._root = root;
                self._stage = root.stage;
                // ๅๅปบ่ๆฏๆพ็คบๅฑ
                self._bgLayer = new eui.UILayer();
                self._bgLayer.touchEnabled = false;
                root.addChild(self._bgLayer);
                // ๅๅปบๅบๆฏๆพ็คบๅฑ
                self._sceneLayer = new eui.UILayer();
                self._sceneLayer.touchEnabled = false;
                root.addChild(self._sceneLayer);
                // ๅๅปบๆกๆถๆพ็คบๅฑ
                self._frameLayer = new eui.UILayer();
                self._frameLayer.touchEnabled = false;
                root.addChild(self._frameLayer);
                // ๅๅปบๅผนๅบๅฑ
                self._panelLayer = new eui.UILayer();
                self._panelLayer.touchEnabled = false;
                root.addChild(self._panelLayer);
                // ๅๅปบ้ฎ็ฝฉๅฑ
                self._maskLayer = new eui.UILayer();
                self._maskLayer.touchEnabled = false;
                root.addChild(self._maskLayer);
                // ๅๅปบ้กถ็บงๆพ็คบๅฑ
                self._topLayer = new eui.UILayer();
                self._topLayer.touchEnabled = false;
                root.addChild(self._topLayer);
                // ่ฎพ็ฝฎ่ตๆบๅไธป้ข้้ๅจ
                egret.registerImplementation("eui.IAssetAdapter", new AssetAdapter());
                egret.registerImplementation("eui.IThemeAdapter", new ThemeAdapter(self._initParams));
                // ๅ่ฝฝ่ตๆบ้็ฝฎ
                RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
                RES.loadConfig(self._initParams.pathPrefix + "resource/default.res.json", self._initParams.pathPrefix + "resource/");
            }
            function onConfigComplete(evt) {
                RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE, onConfigComplete, self);
                // ๅ่ฝฝไธป้ข้็ฝฎ
                var theme = new eui.Theme(this._initParams.pathPrefix + "resource/default.thm.json", self._root.stage);
                theme.addEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
            }
            function onThemeLoadComplete(evt) {
                evt.target.removeEventListener(eui.UIEvent.COMPLETE, onThemeLoadComplete, self);
                // ๅ่ฝฝ้ขๅ่ฝฝ่ตๆบ็ป
                var preloadGroups = this._initParams.preloadGroups;
                self.loadAssets(preloadGroups, null, function (err) { return complete(self); });
            }
        };
        /**
         * ๅคๆญ็ฎ่คๆฏๅฆๆฏEgretๆพ็คบๅฏน่ฑก
         *
         * @param {*} skin ็ฎ่คๅฏน่ฑก
         * @returns {boolean} ๆฏๅฆๆฏEgretๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.isMySkin = function (skin) {
            return (skin instanceof egret.DisplayObject);
        };
        /**
         * ๅๅปบไธไธช็ฉบ็ๆพ็คบๅฏน่ฑก
         *
         * @returns {egret.Sprite}
         * @memberof EgretBridge
         */
        EgretBridge.prototype.createEmptyDisplay = function () {
            return new egret.Sprite();
        };
        /**
         * ๆทปๅๆพ็คบ
         *
         * @param {egret.DisplayObjectContainer} parent ่ฆๆทปๅๅฐ็็ถๅฎนๅจ
         * @param {egret.DisplayObject} target ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @return {egret.DisplayObject} ่ฟๅ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.addChild = function (parent, target) {
            if (parent && target)
                return parent.addChild(target);
            else
                return target;
        };
        /**
         * ๆ็ดขๅผๆทปๅๆพ็คบ
         *
         * @param {egret.DisplayObjectContainer} parent ่ฆๆทปๅๅฐ็็ถๅฎนๅจ
         * @param {egret.DisplayObject} target ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @param {number} index ่ฆๆทปๅๅฐ็็ถ็บง็ดขๅผ
         * @return {egret.DisplayObject} ่ฟๅ่ขซๆทปๅ็ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.addChildAt = function (parent, target, index) {
            if (parent && target)
                return parent.addChildAt(target, index);
            else
                return target;
        };
        /**
         * ็งป้คๆพ็คบๅฏน่ฑก
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @param {egret.DisplayObject} target ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @return {egret.DisplayObject} ่ฟๅ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.removeChild = function (parent, target) {
            if (parent && target && target.parent == parent)
                return parent.removeChild(target);
            else
                return target;
        };
        /**
         * ๆ็ดขๅผ็งป้คๆพ็คบ
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @param {number} index ็ดขๅผ
         * @return {egret.DisplayObject} ่ฟๅ่ขซ็งป้ค็ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.removeChildAt = function (parent, index) {
            return parent.removeChildAt(index);
        };
        /**
         * ็งป้คๆๆๆพ็คบๅฏน่ฑก
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @memberof EgretBridge
         */
        EgretBridge.prototype.removeChildren = function (parent) {
            parent.removeChildren();
        };
        /**
         * ่ทๅ็ถๅฎนๅจ
         *
         * @param {egret.DisplayObject} target ็ฎๆๅฏน่ฑก
         * @returns {egret.DisplayObjectContainer} ็ถๅฎนๅจ
         * @memberof EgretBridge
         */
        EgretBridge.prototype.getParent = function (target) {
            return target.parent;
        };
        /**
         * ่ทๅๆๅฎ็ดขๅผๅค็ๆพ็คบๅฏน่ฑก
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @param {number} index ๆๅฎ็ถ็บง็ดขๅผ
         * @return {egret.DisplayObject} ็ดขๅผๅค็ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.getChildAt = function (parent, index) {
            return parent.getChildAt(index);
        };
        /**
         * ่ทๅๆพ็คบ็ดขๅผ
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @param {egret.DisplayObject} target ๅญๆพ็คบๅฏน่ฑก
         * @return {number} targetๅจparentไธญ็็ดขๅผ
         * @memberof EgretBridge
         */
        EgretBridge.prototype.getChildIndex = function (parent, target) {
            return parent.getChildIndex(target);
        };
        /**
         * ้่ฟๅ็งฐ่ทๅๆพ็คบๅฏน่ฑก
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @param {string} name ๅฏน่ฑกๅ็งฐ
         * @return {egret.DisplayObject} ๆพ็คบๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.getChildByName = function (parent, name) {
            return parent.getChildByName(name);
        };
        /**
         * ่ทๅๅญๆพ็คบๅฏน่ฑกๆฐ้
         *
         * @param {egret.DisplayObjectContainer} parent ็ถๅฎนๅจ
         * @return {number} ๅญๆพ็คบๅฏน่ฑกๆฐ้
         * @memberof EgretBridge
         */
        EgretBridge.prototype.getChildCount = function (parent) {
            return parent.numChildren;
        };
        /**
         * ๅ่ฝฝ่ตๆบ
         *
         * @param {string[]} assets ่ตๆบๆฐ็ป
         * @param {IMediator} mediator ่ตๆบๅ่กจ
         * @param {(err?:Error)=>void} handler ๅ่ฐๅฝๆฐ
         * @memberof EgretBridge
         */
        EgretBridge.prototype.loadAssets = function (assets, mediator, handler) {
            var loader = new AssetsLoader_1.default({
                oneError: function (evt) {
                    // ่ฐ็จๅ่ฐ
                    handler(new Error("่ตๆบๅ่ฝฝๅคฑ่ดฅ"));
                    // ๆดพๅๅ่ฝฝ้่ฏฏไบไปถ
                    Core_27.core.dispatch(ModuleMessage_3.default.MODULE_LOAD_ASSETS_ERROR, evt);
                },
                complete: function (dict) {
                    // ่ฐ็จๅ่ฐ
                    handler();
                }
            });
            loader.loadGroups(assets);
        };
        /**
         * ็ๅฌไบไปถ๏ผไป่ฟไธชๆนๆณ็ๅฌ็ไบไปถไผๅจไธญไป่้ๆฏๆถ่ขซ่ชๅจ็งป้ค็ๅฌ
         *
         * @param {egret.EventDispatcher} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {Function} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.mapListener = function (target, type, handler, thisArg) {
            target.addEventListener(type, handler, thisArg);
        };
        /**
         * ๆณจ้็ๅฌไบไปถ
         *
         * @param {egret.EventDispatcher} target ไบไปถ็ฎๆๅฏน่ฑก
         * @param {string} type ไบไปถ็ฑปๅ
         * @param {Function} handler ไบไปถๅค็ๅฝๆฐ
         * @param {*} [thisArg] thisๆๅๅฏน่ฑก
         * @memberof EgretBridge
         */
        EgretBridge.prototype.unmapListener = function (target, type, handler, thisArg) {
            target.removeEventListener(type, handler, thisArg);
        };
        /** ๆไพ้ๆ็ฑปๅๅธธ้ */
        EgretBridge.TYPE = "Egret";
        return EgretBridge;
    }());
    exports.default = EgretBridge;
    var AssetAdapter = /** @class */ (function () {
        function AssetAdapter() {
        }
        /**
         * @language zh_CN
         * ่งฃๆ็ดๆ
         * @param source ๅพ่งฃๆ็ๆฐ็ดๆๆ่ฏ็ฌฆ
         * @param compFunc ่งฃๆๅฎๆๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผcallBack(content:any,source:string):void;
         * @param thisObject callBack็ this ๅผ็จ
         */
        AssetAdapter.prototype.getAsset = function (source, compFunc, thisObject) {
            if (RES.hasRes(source)) {
                var data = RES.getRes(source);
                if (data)
                    onGetRes(data);
                else
                    RES.getResAsync(source, onGetRes, this);
            }
            else {
                RES.getResByUrl(source, onGetRes, this, RES.ResourceItem.TYPE_IMAGE);
            }
            function onGetRes(data) {
                compFunc.call(thisObject, data, source);
            }
        };
        return AssetAdapter;
    }());
    var ThemeAdapter = /** @class */ (function () {
        function ThemeAdapter(initParams) {
            this._initParams = initParams;
        }
        /**
         * ่งฃๆไธป้ข
         * @param url ๅพ่งฃๆ็ไธป้ขurl
         * @param compFunc ่งฃๆๅฎๆๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผcompFunc(e:egret.Event):void;
         * @param errorFunc ่งฃๆๅคฑ่ดฅๅ่ฐๅฝๆฐ๏ผ็คบไพ๏ผerrorFunc():void;
         * @param thisObject ๅ่ฐ็thisๅผ็จ
         */
        ThemeAdapter.prototype.getTheme = function (url, compFunc, errorFunc, thisObject) {
            RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
            RES.getResByUrl(url, onGetRes, this, RES.ResourceItem.TYPE_TEXT);
            function onGetRes(e) {
                try {
                    // ้่ฆไธบๆๆไธป้ข่ตๆบๆทปๅ่ทฏๅพๅ็ผ
                    var data = JSON.parse(e);
                    for (var key in data.skins)
                        data.skins[key] = this._initParams.pathPrefix + data.skins[key];
                    for (var key in data.exmls) {
                        // ๅฆๆๅชๆฏURLๅ็ดๆฅๆทปๅๅ็ผ๏ผๅฆๅๆฏๅๅฎน้ๆๆนๅผ๏ผ้่ฆๅ็ฌไฟฎๆนpathๅฑๆง
                        var exml = data.exmls[key];
                        if (typeof exml == "string")
                            data.exmls[key] = this._initParams.pathPrefix + exml;
                        else
                            exml.path = this._initParams.pathPrefix + exml.path;
                    }
                    e = JSON.stringify(data);
                }
                catch (err) { }
                compFunc.call(thisObject, e);
            }
            function onError(e) {
                if (e.resItem.url == url) {
                    RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR, onError, null);
                    errorFunc.call(thisObject);
                }
            }
        };
        return ThemeAdapter;
    }());
});
define("test/utils/InitParamsUtil", ["require", "exports", "src/trunk/engine/env/WindowExternal", "src/trunk/engine/env/Query"], function (require, exports, WindowExternal_1, Query_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-21
     * @modify date 2017-09-21
     *
     * ๅๅงๅๆฐๅทฅๅท๏ผๅไปwindowExternalๅ๏ผๅไธๅฐๅไปquery้ๅ
    */
    function getParam(key) {
        return (WindowExternal_1.windowExternal.getParam(key) || Query_1.query.getParam(key));
    }
    exports.default = getParam;
});
define("src/branches/egret/utils/SkinUtil", ["require", "exports", "src/trunk/engine/scene/SceneMediator"], function (require, exports, SceneMediator_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-09
     * @modify date 2017-10-09
     *
     * Egret็ฎ่คๅทฅๅท้
    */
    function wrapSkin(mediator, skin) {
        var comp = new eui.Component();
        mediator.skin = comp;
        // ็ฏกๆนmediator็onOpenๆนๆณ๏ผๅไบonOpenๅฐ็ฎ่ค้ไธๅป
        var oriFunc = mediator.hasOwnProperty("onOpen") ? mediator.onOpen : null;
        mediator.onOpen = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            comp.skinName = skin;
            // ๅบๆฏ้่ฆๆไผธๅฐไธstageๅๅฎฝ้ซ
            if (mediator instanceof SceneMediator_1.default) {
                comp.width = mediator.bridge.root.stage.stageWidth;
                comp.height = mediator.bridge.root.stage.stageHeight;
            }
            // ่ฝฌๅuiๅผ็จ
            for (var _a = 0, _b = comp.skin.skinParts; _a < _b.length; _a++) {
                var name = _b[_a];
                mediator[name] = comp[name];
            }
            // ๆขๅคๅๅงๆนๆณ
            if (oriFunc)
                mediator.onOpen = oriFunc;
            else
                delete mediator.onOpen;
            // ่ฐ็จๅๅงๆนๆณ
            mediator.onOpen.apply(this, args);
        };
        return comp;
    }
    exports.wrapSkin = wrapSkin;
});
define("src/branches/egret/injector/Injector", ["require", "exports", "src/trunk/utils/ConstructUtil", "src/trunk/engine/injector/Injector", "src/trunk/engine/bridge/BridgeManager", "src/branches/egret/utils/SkinUtil", "EgretBridge"], function (require, exports, ConstructUtil_4, Injector_21, BridgeManager_7, SkinUtil_1, EgretBridge_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-09
     * @modify date 2017-10-09
     *
     * ่ด่ดฃๆณจๅฅ็ๆจกๅ
    */
    function EgretSkin(skin) {
        return function (cls) {
            // ็ๅฌ็ฑปๅๅฎไพๅ๏ผ่ฝฌๆข็ฎ่คๆผๅผ
            ConstructUtil_4.listenConstruct(cls, function (mediator) { return SkinUtil_1.wrapSkin(mediator, skin); });
        };
    }
    exports.EgretSkin = EgretSkin;
    function EgretMediatorClass(target) {
        if (target instanceof Function) {
            // ่ฐ็จMediatorClassๆนๆณ
            var cls = Injector_21.MediatorClass(target);
            // ็ๅฌ็ฑปๅๅฎไพๅ๏ผ่ตๅผ่กจ็ฐๅฑๆกฅ
            ConstructUtil_4.listenConstruct(cls, function (mediator) { return mediator.bridge = BridgeManager_7.bridgeManager.getBridge(EgretBridge_2.default.TYPE); });
            // ่ฟๅ็ปๆ็ฑปๅ
            return cls;
        }
        else {
            return function (cls) {
                // ่ฐ็จMediatorClassๆนๆณ
                cls = Injector_21.MediatorClass(cls);
                // ็ๅฌ็ฑปๅๅฎไพๅ๏ผ่ฝฌๆข็ฎ่คๆผๅผ
                ConstructUtil_4.listenConstruct(cls, function (mediator) { return SkinUtil_1.wrapSkin(mediator, target); });
                // ่ฟๅ็ปๆ็ฑปๅ
                return cls;
            };
        }
    }
    exports.EgretMediatorClass = EgretMediatorClass;
});
define("test/modules/SecondModule", ["require", "exports", "src/trunk/engine/module/Module", "src/trunk/engine/scene/SceneMediator", "src/branches/egret/injector/Injector", "src/trunk/engine/injector/Injector", "src/trunk/core/injector/Injector"], function (require, exports, Module_1, SceneMediator_2, Injector_22, Injector_23, Injector_24) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * ๆต่ฏ็ฌฌไบไธชๆจกๅ
    */
    var SecondMediator = /** @class */ (function (_super) {
        __extends(SecondMediator, _super);
        function SecondMediator() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SecondMediator.prototype.listAssets = function () {
            return ["preload"];
        };
        SecondMediator.prototype.onOpen = function () {
            var _this = this;
            this.mapListener(this.btn, egret.TouchEvent.TOUCH_TAP, function () {
                // moduleManager.close(SecondModule);
                _this.dispatchModule("FuckMsg", "Shit!!!");
            });
            this.viewModel = {
                onMsg: function (msg) {
                    // ่กจ่พพๅผ้ไฝฟ็จๅฝๆฐๅฏไปฅๅจๅฝๆฐ้ๆง่กๅคๆ้ป่พ๏ผๅนถไธๅทๆไปฃ็ๆ็คบ
                    console.log(msg);
                    return msg + " - 1";
                }
            };
            // ๆต่ฏ็ณป็ปๆถๆฏ
            this.dispatch("fuck", 123);
            // ๆต่ฏๆจกๅๆถๆฏ
            this.dispatchModule("fuck", 123);
        };
        __decorate([
            Injector_23.BindModuleMessage("FuckMsg", { label: "onMsg($arguments[0])" }),
            __metadata("design:type", Object)
        ], SecondMediator.prototype, "btn", void 0);
        SecondMediator = __decorate([
            Injector_22.EgretMediatorClass("Fuck2Skin")
        ], SecondMediator);
        return SecondMediator;
    }(SceneMediator_2.default));
    var SecondModule = /** @class */ (function (_super) {
        __extends(SecondModule, _super);
        function SecondModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SecondModule.prototype.onFuck = function (a) {
            console.log("message at SecondModule: " + a);
        };
        __decorate([
            Injector_23.DelegateMediator,
            __metadata("design:type", SecondMediator)
        ], SecondModule.prototype, "_mediator", void 0);
        __decorate([
            Injector_24.MessageHandler("fuck"),
            Injector_23.ModuleMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], SecondModule.prototype, "onFuck", null);
        SecondModule = __decorate([
            Injector_23.ModuleClass
        ], SecondModule);
        return SecondModule;
    }(Module_1.default));
    exports.default = SecondModule;
});
define("test/net/type/Test", ["require", "exports", "src/trunk/engine/net/DataType"], function (require, exports, DataType_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * ๆต่ฏ
    */
    var Test = /** @class */ (function (_super) {
        __extends(Test, _super);
        function Test() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Test.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.test = data.test;
        };
        Test.prototype.pack = function () {
            return {
                test: this.test
            };
        };
        return Test;
    }(DataType_2.default));
    exports.default = Test;
});
define("test/net/response/TestResponse", ["require", "exports", "src/trunk/engine/net/ResponseData", "src/trunk/engine/net/NetManager", "test/net/type/Test"], function (require, exports, ResponseData_2, NetManager_5, Test_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * ๆต่ฏ
    */
    var TestResponse = /** @class */ (function (_super) {
        __extends(TestResponse, _super);
        function TestResponse() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        Object.defineProperty(TestResponse.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    protocol: "http",
                    method: "GET"
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        TestResponse.prototype.doParse = function (data) {
            if (data == null)
                return;
            this.__params.success = data.success;
            this.test = new Test_1.default().parse(data.test);
        };
        TestResponse.prototype.pack = function () {
            return {
                test: this.test.pack()
            };
        };
        TestResponse.type = "Test";
        return TestResponse;
    }(ResponseData_2.default));
    exports.default = TestResponse;
    /** ๆณจๅ่ฟๅไฝ */
    NetManager_5.netManager.registerResponse(TestResponse);
});
define("test/net/request/TestRequest", ["require", "exports", "src/trunk/engine/net/RequestData", "src/trunk/engine/net/policies/HTTPRequestPolicy", "test/net/response/TestResponse"], function (require, exports, RequestData_2, HTTPRequestPolicy_1, TestResponse_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author TemplateGenerator
     * @email initial_r@qq.com
     * @modify date 10/9/2017
     *
     * ๆต่ฏ
    */
    var TestRequest = /** @class */ (function (_super) {
        __extends(TestRequest, _super);
        function TestRequest() {
            var _this = _super !== null && _super.apply(this, arguments) || this;
            _this.__policy = HTTPRequestPolicy_1.default;
            return _this;
        }
        Object.defineProperty(TestRequest.prototype, "__params", {
            get: function () {
                return {
                    type: "Test",
                    path: "/test",
                    protocol: "http",
                    response: TestResponse_1.default,
                    data: {
                        test: this.test // string - ๆต่ฏ
                    }
                };
            },
            enumerable: true,
            configurable: true
        });
        ;
        return TestRequest;
    }(RequestData_2.default));
    exports.default = TestRequest;
});
define("test/models/FuckModel", ["require", "exports", "src/trunk/engine/injector/Injector", "src/trunk/core/injector/Injector", "src/trunk/engine/env/Hash"], function (require, exports, Injector_25, Injector_26, Hash_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var IFuckModel = /** @class */ (function () {
        function IFuckModel() {
        }
        Object.defineProperty(IFuckModel.prototype, "fuck", {
            get: function () {
                return null;
            },
            enumerable: true,
            configurable: true
        });
        return IFuckModel;
    }());
    exports.IFuckModel = IFuckModel;
    var FuckModel = /** @class */ (function (_super) {
        __extends(FuckModel, _super);
        function FuckModel() {
            var _this = _super.call(this) || this;
            console.log("Fuck Model Constructed!");
            return _this;
        }
        Object.defineProperty(FuckModel.prototype, "fuck", {
            get: function () {
                return "Fuck you";
            },
            enumerable: true,
            configurable: true
        });
        __decorate([
            Injector_26.Inject,
            __metadata("design:type", Hash_2.default)
        ], FuckModel.prototype, "hash", void 0);
        FuckModel = __decorate([
            Injector_25.ModelClass(1, IFuckModel),
            __metadata("design:paramtypes", [])
        ], FuckModel);
        return FuckModel;
    }(IFuckModel));
    exports.default = FuckModel;
});
define("src/branches/dom/utils/SkinUtil", ["require", "exports", "src/trunk/engine/assets/AssetsManager"], function (require, exports, AssetsManager_5) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-10-26
     * @modify date 2017-10-26
     *
     * ไธบDOMๆไพ็ฎ่ค่ฝฌๆข็ๅทฅๅท้
    */
    /**
     * ไธบไธญไป่ๅ่ฃ็ฎ่ค
     *
     * @export
     * @param {IMediator} mediator ไธญไป่
     * @param {(HTMLElement|string|string[])} skin ็ฎ่ค๏ผๅฏไปฅๆฏHTMLElement๏ผไนๅฏไปฅๆฏ็ฎ่คๅญ็ฌฆไธฒ๏ผไนๅฏไปฅๆฏ็ฎ่คๆจกๆฟๅฐๅๆๅฐๅๆฐ็ป
     * @returns {HTMLElement} ็ฎ่ค็HTMLElementๅฝขๅผ๏ผๅฏ่ฝไผ็จๅๅๅกซๅๅๅฎน๏ผๅฆๆๆณๅจ็ฎ่คๅ่ฝฝๅฎๆฏๅๅๆฟๅฐ็ฎ่ค่ฏทไฝฟ็จcompleteๅๆฐ
     */
    function wrapSkin(mediator, skin) {
        var result;
        if (skin instanceof HTMLElement) {
            result = skin;
        }
        else {
            // ็ๆไธไธชไธดๆถ็div
            result = document.createElement("div");
            // ็ฏกๆนmediator็onOpenๆนๆณ๏ผๅไบonOpenๅฐ็ฎ่ค้ไธๅป
            var oriFunc = mediator.hasOwnProperty("onOpen") ? mediator.onOpen : null;
            mediator.onOpen = function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                if (skin instanceof Array) {
                    // ๆฏๆฐ็ป๏ผๅฐๆๆๅๅฎน่ฟๆฅ่ตทๆฅๅไธ่ตท่ตๅผ
                    skin = skin.map(getContent).join("");
                }
                // ่ตๅผ็ฎ่คๅๅฎน
                result.innerHTML = skin;
                // ไฝฟ็จๆญฃๅ่กจ่พพๅผๅฐๆฅๆid็่็น่ตๅผ็ปmediator
                var reg = /id=("([^"]+)"|'([^']+)')/g;
                var res;
                while (res = reg.exec(skin)) {
                    var id = res[2] || res[3];
                    mediator[id] = result.querySelector("#" + id);
                }
                // ๆขๅคๅๅงๆนๆณ
                if (oriFunc)
                    mediator.onOpen = oriFunc;
                else
                    delete mediator.onOpen;
                // ่ฐ็จๅๅงๆนๆณ
                mediator.onOpen.apply(this, args);
            };
        }
        // ่ตๅผ็ฎ่ค
        mediator.skin = result;
        // ๅๆญฅ่ฟๅ็ฎ่ค
        return result;
    }
    exports.wrapSkin = wrapSkin;
    function getContent(skin) {
        if (skin.indexOf("<") >= 0 && skin.indexOf(">") >= 0) {
            // ๆฏ็ฎ่คๅญ็ฌฆไธฒ๏ผ็ดๆฅ่ฟๅ
            return skin;
        }
        else {
            // ๆฏ็ฎ่ค่ทฏๅพๆ่ทฏๅพ็ญๅ็งฐ๏ผ่ทๅๅ่ฟๅ
            return AssetsManager_5.assetsManager.getAssets(skin);
        }
    }
});
define("src/branches/dom/injector/Injector", ["require", "exports", "src/trunk/utils/ConstructUtil", "src/trunk/engine/injector/Injector", "src/trunk/engine/bridge/BridgeManager", "src/branches/dom/utils/SkinUtil", "DOMBridge"], function (require, exports, ConstructUtil_5, Injector_27, BridgeManager_8, SkinUtil_2, DOMBridge_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    function DOMMediatorClass() {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        if (args[0] instanceof Function) {
            // ่ฐ็จMediatorClassๆนๆณ
            var cls = Injector_27.MediatorClass(args[0]);
            // ็ๅฌ็ฑปๅๅฎไพๅ๏ผ่ตๅผ่กจ็ฐๅฑๆกฅ
            ConstructUtil_5.listenConstruct(cls, function (mediator) { return mediator.bridge = BridgeManager_8.bridgeManager.getBridge(DOMBridge_2.default.TYPE); });
            // ่ฟๅ็ปๆ็ฑปๅ
            return cls;
        }
        else {
            return function (cls) {
                // ่ฐ็จMediatorClassๆนๆณ
                cls = Injector_27.MediatorClass(cls);
                // ็ๅฌ็ฑปๅๅฎไพๅ๏ผ่ฝฌๆข็ฎ่คๆผๅผ
                ConstructUtil_5.listenConstruct(cls, function (mediator) { return SkinUtil_2.wrapSkin(mediator, args); });
                // ่ฟๅ็ปๆ็ฑปๅ
                return cls;
            };
        }
    }
    exports.DOMMediatorClass = DOMMediatorClass;
});
define("test/modules/FirstModule", ["require", "exports", "src/trunk/engine/module/Module", "src/trunk/engine/module/ModuleManager", "src/trunk/core/injector/Injector", "src/trunk/engine/injector/Injector", "test/modules/SecondModule", "src/trunk/engine/module/ModuleMessage", "src/trunk/engine/scene/SceneMediator", "test/net/response/TestResponse", "test/net/request/TestRequest", "test/models/FuckModel", "src/branches/dom/injector/Injector", "src/trunk/engine/audio/AudioManager"], function (require, exports, Module_2, ModuleManager_5, Injector_28, Injector_29, SecondModule_1, ModuleMessage_4, SceneMediator_3, TestResponse_2, TestRequest_1, FuckModel_1, Injector_30, AudioManager_2) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-09-18
     * @modify date 2017-09-18
     *
     * ๆต่ฏ้ฆไธชๆจกๅ
    */
    var FirstMediator = /** @class */ (function (_super) {
        __extends(FirstMediator, _super);
        function FirstMediator() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        FirstMediator.prototype.listAssets = function () {
            return ["./modules/test.html"];
        };
        FirstMediator.prototype.onOpen = function () {
            var _this = this;
            // this.mapListener(this.btn, "click", function():void
            // {
            //     this.txt.textContent = "Fuck you!!!";
            //     this.moduleManager.open(SecondModule);
            // }, this);
            console.log(this.fuckModel1.fuck, this.fuckModel1 === this.fuckModel2, this.fuckModel1 === this.fuckModel3);
            this.viewModel = {
                fuckText: "fuck you",
                onClick: function () {
                    _this.viewModel.fuckText = "clicked";
                    _this.moduleManager.open(SecondModule_1.default);
                }
            };
            AudioManager_2.audioManager.playMusic({
                url: "./test.mp3"
            });
            setTimeout(function () {
                _this.viewModel.fuckText = "1234";
            }, 3000);
        };
        FirstMediator.prototype.onModuleChange = function (to, from) {
            if (to == FirstModule)
                console.log("change to first module!");
            else if (to == SecondModule_1.default)
                console.log("change to second module!");
        };
        FirstMediator.prototype.onResponse = function (res, req) {
            alert("123");
        };
        __decorate([
            Injector_28.Inject,
            __metadata("design:type", ModuleManager_5.default)
        ], FirstMediator.prototype, "moduleManager", void 0);
        __decorate([
            Injector_28.Inject,
            __metadata("design:type", FuckModel_1.default)
        ], FirstMediator.prototype, "fuckModel1", void 0);
        __decorate([
            Injector_28.Inject,
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], FirstMediator.prototype, "fuckModel2", void 0);
        __decorate([
            Injector_28.Inject(1),
            __metadata("design:type", FuckModel_1.IFuckModel)
        ], FirstMediator.prototype, "fuckModel3", void 0);
        __decorate([
            Injector_29.BindOn({ click: "onClick" }),
            Injector_29.BindIf({ "labelDisplay": "fuckText == '1234'" }),
            __metadata("design:type", Object)
        ], FirstMediator.prototype, "btn", void 0);
        __decorate([
            Injector_29.BindValue({ textContent: "fuckText + ' - 1'" }),
            __metadata("design:type", Object)
        ], FirstMediator.prototype, "txt", void 0);
        __decorate([
            Injector_28.MessageHandler(ModuleMessage_4.default.MODULE_CHANGE),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object, Object]),
            __metadata("design:returntype", void 0)
        ], FirstMediator.prototype, "onModuleChange", null);
        __decorate([
            Injector_29.ResponseHandler,
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [TestResponse_2.default, TestRequest_1.default]),
            __metadata("design:returntype", void 0)
        ], FirstMediator.prototype, "onResponse", null);
        FirstMediator = __decorate([
            Injector_30.DOMMediatorClass("./modules/test.html")
        ], FirstMediator);
        return FirstMediator;
    }(SceneMediator_3.default));
    var FirstModule = /** @class */ (function (_super) {
        __extends(FirstModule, _super);
        function FirstModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        FirstModule.prototype.listJsFiles = function () {
            return ["test1.js", "./test2.js"];
        };
        FirstModule.prototype.onFuck = function (a) {
            console.log("message at FirstModule: " + a);
        };
        __decorate([
            Injector_29.DelegateMediator,
            __metadata("design:type", FirstMediator)
        ], FirstModule.prototype, "_mediator", void 0);
        __decorate([
            Injector_28.MessageHandler("fuck"),
            Injector_29.ModuleMessageHandler("fuck"),
            __metadata("design:type", Function),
            __metadata("design:paramtypes", [Object]),
            __metadata("design:returntype", void 0)
        ], FirstModule.prototype, "onFuck", null);
        FirstModule = __decorate([
            Injector_29.ModuleClass
        ], FirstModule);
        return FirstModule;
    }(Module_2.default));
    exports.default = FirstModule;
});
/// <amd-module name="main"/>
define("main", ["require", "exports", "Olympus", "src/trunk/engine/env/Environment", "DOMBridge", "EgretBridge", "test/utils/InitParamsUtil", "test/modules/FirstModule"], function (require, exports, Olympus_1, Environment_8, DOMBridge_3, EgretBridge_3, InitParamsUtil_1, FirstModule_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    /**
     * @author Raykid
     * @email initial_r@qq.com
     * @create date 2017-08-31
     * @modify date 2017-09-01
     *
     * ๆต่ฏ้กน็ฎ
    */
    Olympus_1.default.startup({
        bridges: [
            new DOMBridge_3.default({
                container: "#rootDOM"
            }),
            new EgretBridge_3.default({
                width: 720,
                height: 1280,
                pathPrefix: "egret/",
                container: "#rootEgret",
                backgroundColor: 0,
            })
        ],
        firstModule: FirstModule_1.default,
        loadElement: "#loading",
        env: InitParamsUtil_1.default("server_type"),
        hostsDict: {
            dev: ["http://www.test.17zuoye.net/"],
            test: ["https://www.test.17zuoye.net/"],
            staging: ["https://www.staging.17zuoye.net/"],
            prod: ["https://www.17zuoye.com/"]
        },
        cdnsDict: {
            test: ["https://cdn-cnc.test.17zuoye.net/"],
            staging: ["https://cdn-cnc.staging.17zuoye.net/"],
            prod: ["https://cdn-cnc.17zuoye.com/"]
        },
        pathDict: {
            a: "test1.js",
            b: "test2.js"
        },
        preloads: ["a", "b"],
        onInited: function () {
            // bridgeManager.getBridge("Egret").defaultScenePolicy = none;
        }
    });
    console.log(Environment_8.environment.env, Environment_8.environment.getHost(), Environment_8.environment.curCDNHost);
});
//# sourceMappingURL=main.js.map